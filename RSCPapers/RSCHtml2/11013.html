<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:art="http://www.rsc.org/schema/rscart38" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:rsc="urn:rsc.org" xml:lang="en" lang="en"><head><!--Google Tag Manager--><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-56FZ7G');</script><!--End Google Tag Manager--><title>A bi-cyclic co-optimization method for sizing of electricity-hydrogen hybrid energy storage microgrid  - Sustainable Energy &amp; Fuels (RSC Publishing) DOI:10.1039/D2SE00556E</title><link rel="canonical" href="https://pubs.rsc.org/en/content/articlehtml/2022/se/d2se00556e"/><meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8"/><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info = {"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-aaa897feae8feeca979","applicationID":"1313546638","transactionName":"M1wANxQFCEcDVU0PWgoWLzUlSyVbDEJcCEEnVgwXFAsKWAdEFgdHEFABDwMMElkO","queueTime":0,"applicationTime":442,"agent":"","atts":""}</script><script type="text/javascript">(window.NREUM||(NREUM={})).init={privacy:{cookies_enabled:true},ajax:{deny_list:["bam.nr-data.net"]},distributed_tracing:{enabled:true}};(window.NREUM||(NREUM={})).loader_config={agentID:"1386013924",accountID:"2851366",trustKey:"1029994",xpid:"Vg4CUFVVDhABV1BRAgUBUFcJ",licenseKey:"NRJS-aaa897feae8feeca979",applicationID:"1313546638"};;/*! For license information please see nr-loader-spa-1.236.0.min.js.LICENSE.txt */
(()=>{"use strict";var e,t,r={5763:(e,t,r)=>{r.d(t,{P_:()=>l,Mt:()=>g,C5:()=>s,DL:()=>v,OP:()=>T,lF:()=>D,Yu:()=>y,Dg:()=>h,CX:()=>c,GE:()=>b,sU:()=>_});var n=r(8632),i=r(9567);const o={beacon:n.ce.beacon,errorBeacon:n.ce.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0},a={};function s(e){if(!e)throw new Error("All info objects require an agent identifier!");if(!a[e])throw new Error("Info for ".concat(e," was never set"));return a[e]}function c(e,t){if(!e)throw new Error("All info objects require an agent identifier!");a[e]=(0,i.D)(t,o),(0,n.Qy)(e,a[e],"info")}var u=r(7056);const d=()=>{const e={blockSelector:"[data-nr-block]",maskInputOptions:{password:!0}};return{allow_bfcache:!0,privacy:{cookies_enabled:!0},ajax:{deny_list:void 0,enabled:!0,harvestTimeSeconds:10},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},session:{domain:void 0,expiresMs:u.oD,inactiveMs:u.Hb},ssl:void 0,obfuscate:void 0,jserrors:{enabled:!0,harvestTimeSeconds:10},metrics:{enabled:!0},page_action:{enabled:!0,harvestTimeSeconds:30},page_view_event:{enabled:!0},page_view_timing:{enabled:!0,harvestTimeSeconds:30,long_task:!1},session_trace:{enabled:!0,harvestTimeSeconds:10},harvest:{tooManyRequestsDelay:60},session_replay:{enabled:!1,harvestTimeSeconds:60,sampleRate:.1,errorSampleRate:.1,maskTextSelector:"*",maskAllInputs:!0,get blockClass(){return"nr-block"},get ignoreClass(){return"nr-ignore"},get maskTextClass(){return"nr-mask"},get blockSelector(){return e.blockSelector},set blockSelector(t){e.blockSelector+=",".concat(t)},get maskInputOptions(){return e.maskInputOptions},set maskInputOptions(t){e.maskInputOptions={...t,password:!0}}},spa:{enabled:!0,harvestTimeSeconds:10}}},f={};function l(e){if(!e)throw new Error("All configuration objects require an agent identifier!");if(!f[e])throw new Error("Configuration for ".concat(e," was never set"));return f[e]}function h(e,t){if(!e)throw new Error("All configuration objects require an agent identifier!");f[e]=(0,i.D)(t,d()),(0,n.Qy)(e,f[e],"config")}function g(e,t){if(!e)throw new Error("All configuration objects require an agent identifier!");var r=l(e);if(r){for(var n=t.split("."),i=0;i<n.length-1;i++)if("object"!=typeof(r=r[n[i]]))return;r=r[n[n.length-1]]}return r}const p={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},m={};function v(e){if(!e)throw new Error("All loader-config objects require an agent identifier!");if(!m[e])throw new Error("LoaderConfig for ".concat(e," was never set"));return m[e]}function b(e,t){if(!e)throw new Error("All loader-config objects require an agent identifier!");m[e]=(0,i.D)(t,p),(0,n.Qy)(e,m[e],"loader_config")}const y=(0,n.mF)().o;var w=r(385),x=r(6818);const A={buildEnv:x.Re,bytesSent:{},queryBytesSent:{},customTransaction:void 0,disabled:!1,distMethod:x.gF,isolatedBacklog:!1,loaderType:void 0,maxBytes:3e4,offset:Math.floor(w._A?.performance?.timeOrigin||w._A?.performance?.timing?.navigationStart||Date.now()),onerror:void 0,origin:""+w._A.location,ptid:void 0,releaseIds:{},session:void 0,xhrWrappable:"function"==typeof w._A.XMLHttpRequest?.prototype?.addEventListener,version:x.q4},E={};function T(e){if(!e)throw new Error("All runtime objects require an agent identifier!");if(!E[e])throw new Error("Runtime for ".concat(e," was never set"));return E[e]}function _(e,t){if(!e)throw new Error("All runtime objects require an agent identifier!");E[e]=(0,i.D)(t,A),(0,n.Qy)(e,E[e],"runtime")}function D(e){return function(e){try{const t=s(e);return!!t.licenseKey&&!!t.errorBeacon&&!!t.applicationID}catch(e){return!1}}(e)}},9567:(e,t,r)=>{r.d(t,{D:()=>i});var n=r(50);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.Z)("Setting a Configurable requires an object as input");if(!t||"object"!=typeof t)return(0,n.Z)("Setting a Configurable requires a model to set its initial properties");const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),o=0===Object.keys(r).length?e:r;for(let a in o)if(void 0!==e[a])try{"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){(0,n.Z)("An error occurred while setting a property of a Configurable",e)}return r}catch(e){(0,n.Z)("An error occured while setting a Configurable",e)}}},6818:(e,t,r)=>{r.d(t,{Re:()=>i,gF:()=>o,q4:()=>n});const n="1.236.0",i="PROD",o="CDN"},385:(e,t,r)=>{r.d(t,{FN:()=>a,IF:()=>u,Nk:()=>f,Tt:()=>s,_A:()=>o,il:()=>n,pL:()=>c,v6:()=>i,w1:()=>d});const n="undefined"!=typeof window&&!!window.document,i="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),o=n?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),a=""+o?.location,s=/iPad|iPhone|iPod/.test(navigator.userAgent),c=s&&"undefined"==typeof SharedWorker,u=(()=>{const e=navigator.userAgent.match(/Firefox[/\s](\d+\.\d+)/);return Array.isArray(e)&&e.length>=2?+e[1]:0})(),d=Boolean(n&&window.document.documentMode),f=!!navigator.sendBeacon},1117:(e,t,r)=>{r.d(t,{w:()=>o});var n=r(50);const i={agentIdentifier:"",ee:void 0};class o{constructor(e){try{if("object"!=typeof e)return(0,n.Z)("shared context requires an object as input");this.sharedContext={},Object.assign(this.sharedContext,i),Object.entries(e).forEach((e=>{let[t,r]=e;Object.keys(i).includes(t)&&(this.sharedContext[t]=r)}))}catch(e){(0,n.Z)("An error occured while setting SharedContext",e)}}}},8e3:(e,t,r)=>{r.d(t,{L:()=>d,R:()=>c});var n=r(2177),i=r(1284),o=r(4322),a=r(3325);const s={};function c(e,t){const r={staged:!1,priority:a.p[t]||0};u(e),s[e].get(t)||s[e].set(t,r)}function u(e){e&&(s[e]||(s[e]=new Map))}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"feature";if(u(e),!e||!s[e].get(t))return a(t);s[e].get(t).staged=!0;const r=[...s[e]];function a(t){const r=e?n.ee.get(e):n.ee,a=o.X.handlers;if(r.backlog&&a){var s=r.backlog[t],c=a[t];if(c){for(var u=0;s&&u<s.length;++u)f(s[u],c);(0,i.D)(c,(function(e,t){(0,i.D)(t,(function(t,r){r[0].on(e,r[1])}))}))}delete a[t],r.backlog[t]=null,r.emit("drain-"+t,[])}}r.every((e=>{let[t,r]=e;return r.staged}))&&(r.sort(((e,t)=>e[1].priority-t[1].priority)),r.forEach((e=>{let[t]=e;a(t)})))}function f(e,t){var r=e[1];(0,i.D)(t[r],(function(t,r){var n=e[0];if(r[0]===n){var i=r[1],o=e[3],a=e[2];i.apply(o,a)}}))}},2177:(e,t,r)=>{r.d(t,{c:()=>f,ee:()=>u});var n=r(8632),i=r(2210),o=r(1284),a=r(5763),s="nr@context";let c=(0,n.fP)();var u;function d(){}function f(e){return(0,i.X)(e,s,l)}function l(){return new d}function h(){u.aborted=!0,u.backlog={}}c.ee?u=c.ee:(u=function e(t,r){var n={},c={},f={},g=!1;try{g=16===r.length&&(0,a.OP)(r).isolatedBacklog}catch(e){}var p={on:b,addEventListener:b,removeEventListener:y,emit:v,get:x,listeners:w,context:m,buffer:A,abort:h,aborted:!1,isBuffering:E,debugId:r,backlog:g?{}:t&&"object"==typeof t.backlog?t.backlog:{}};return p;function m(e){return e&&e instanceof d?e:e?(0,i.X)(e,s,l):l()}function v(e,r,n,i,o){if(!1!==o&&(o=!0),!u.aborted||i){t&&o&&t.emit(e,r,n);for(var a=m(n),s=w(e),d=s.length,f=0;f<d;f++)s[f].apply(a,r);var l=T()[c[e]];return l&&l.push([p,e,r,a]),a}}function b(e,t){n[e]=w(e).concat(t)}function y(e,t){var r=n[e];if(r)for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)}function w(e){return n[e]||[]}function x(t){return f[t]=f[t]||e(p,t)}function A(e,t){var r=T();p.aborted||(0,o.D)(e,(function(e,n){t=t||"feature",c[n]=t,t in r||(r[t]=[])}))}function E(e){return!!T()[c[e]]}function T(){return p.backlog}}(void 0,"globalEE"),c.ee=u)},5546:(e,t,r)=>{r.d(t,{E:()=>n,p:()=>i});var n=r(2177).ee.get("handle");function i(e,t,r,i,o){o?(o.buffer([e],i),o.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},4322:(e,t,r)=>{r.d(t,{X:()=>o});var n=r(5546);o.on=a;var i=o.handlers={};function o(e,t,r,o){a(o||n.E,i,e,t,r)}function a(e,t,r,i,o){o||(o="feature"),e||(e=n.E);var a=t[o]=t[o]||{};(a[r]=a[r]||[]).push([e,i])}},3239:(e,t,r)=>{r.d(t,{bP:()=>s,iz:()=>c,m$:()=>a});var n=r(385);let i=!1,o=!1;try{const e={get passive(){return i=!0,!1},get signal(){return o=!0,!1}};n._A.addEventListener("test",null,e),n._A.removeEventListener("test",null,e)}catch(e){}function a(e,t){return i||o?{capture:!!e,passive:i,signal:t}:!!e}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;window.addEventListener(e,t,a(r,n))}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;document.addEventListener(e,t,a(r,n))}},4402:(e,t,r)=>{r.d(t,{Ht:()=>u,M:()=>c,Rl:()=>a,ky:()=>s});var n=r(385);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function o(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n._A?.crypto||n._A?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(31))),i.split("").map((e=>"x"===e?o(t,++r).toString(16):"y"===e?(3&o()|8).toString(16):e)).join("")}function s(e){const t=n._A?.crypto||n._A?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(31)));const a=[];for(var s=0;s<e;s++)a.push(o(r,++i).toString(16));return a.join("")}function c(){return s(16)}function u(){return s(32)}},7056:(e,t,r)=>{r.d(t,{Bq:()=>n,Hb:()=>o,oD:()=>i});const n="NRBA",i=144e5,o=18e5},7894:(e,t,r)=>{function n(){return Math.round(performance.now())}r.d(t,{z:()=>n})},7243:(e,t,r)=>{r.d(t,{e:()=>o});var n=r(385),i={};function o(e){if(e in i)return i[e];if(0===(e||"").indexOf("data:"))return{protocol:"data"};let t;var r=n._A?.location,o={};if(n.il)t=document.createElement("a"),t.href=e;else try{t=new URL(e,r.href)}catch(e){return o}o.port=t.port;var a=t.href.split("://");!o.port&&a[1]&&(o.port=a[1].split("/")[0].split("@").pop().split(":")[1]),o.port&&"0"!==o.port||(o.port="https"===a[0]?"443":"80"),o.hostname=t.hostname||r.hostname,o.pathname=t.pathname,o.protocol=a[0],"/"!==o.pathname.charAt(0)&&(o.pathname="/"+o.pathname);var s=!t.protocol||":"===t.protocol||t.protocol===r.protocol,c=t.hostname===r.hostname&&t.port===r.port;return o.sameOrigin=s&&(!t.hostname||c),"/"===o.pathname&&(i[e]=o),o}},50:(e,t,r)=>{function n(e,t){"function"==typeof console.warn&&(console.warn("New Relic: ".concat(e)),t&&console.warn(t))}r.d(t,{Z:()=>n})},2587:(e,t,r)=>{r.d(t,{N:()=>c,T:()=>u});var n=r(2177),i=r(5546),o=r(8e3),a=r(3325);const s={stn:[a.D.sessionTrace],err:[a.D.jserrors,a.D.metrics],ins:[a.D.pageAction],spa:[a.D.spa],sr:[a.D.sessionReplay,a.D.sessionTrace]};function c(e,t){const r=n.ee.get(t);e&&"object"==typeof e&&(Object.entries(e).forEach((e=>{let[t,n]=e;void 0===u[t]&&(s[t]?s[t].forEach((e=>{n?(0,i.p)("feat-"+t,[],void 0,e,r):(0,i.p)("block-"+t,[],void 0,e,r),(0,i.p)("rumresp-"+t,[Boolean(n)],void 0,e,r)})):n&&(0,i.p)("feat-"+t,[],void 0,void 0,r),u[t]=Boolean(n))})),Object.keys(s).forEach((e=>{void 0===u[e]&&(s[e]?.forEach((t=>(0,i.p)("rumresp-"+e,[!1],void 0,t,r))),u[e]=!1)})),(0,o.L)(t,a.D.pageViewEvent))}const u={}},2210:(e,t,r)=>{r.d(t,{X:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},1284:(e,t,r)=>{r.d(t,{D:()=>n});const n=(e,t)=>Object.entries(e||{}).map((e=>{let[r,n]=e;return t(r,n)}))},4351:(e,t,r)=>{r.d(t,{P:()=>o});var n=r(2177);const i=()=>{const e=new WeakSet;return(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}};function o(e){try{return JSON.stringify(e,i())}catch(e){try{n.ee.emit("internal-error",[e])}catch(e){}}}},3960:(e,t,r)=>{r.d(t,{K:()=>a,b:()=>o});var n=r(3239);function i(){return"undefined"==typeof document||"complete"===document.readyState}function o(e,t){if(i())return e();(0,n.bP)("load",e,t)}function a(e){if(i())return e();(0,n.iz)("DOMContentLoaded",e)}},8632:(e,t,r)=>{r.d(t,{EZ:()=>u,Qy:()=>c,ce:()=>o,fP:()=>a,gG:()=>d,mF:()=>s});var n=r(7894),i=r(385);const o={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function a(){return i._A.NREUM||(i._A.NREUM={}),void 0===i._A.newrelic&&(i._A.newrelic=i._A.NREUM),i._A.NREUM}function s(){let e=a();return e.o||(e.o={ST:i._A.setTimeout,SI:i._A.setImmediate,CT:i._A.clearTimeout,XHR:i._A.XMLHttpRequest,REQ:i._A.Request,EV:i._A.Event,PR:i._A.Promise,MO:i._A.MutationObserver,FETCH:i._A.fetch}),e}function c(e,t,r){let i=a();const o=i.initializedAgents||{},s=o[e]||{};return Object.keys(s).length||(s.initializedAt={ms:(0,n.z)(),date:new Date}),i.initializedAgents={...o,[e]:{...s,[r]:t}},i}function u(e,t){a()[e]=t}function d(){return function(){let e=a();const t=e.info||{};e.info={beacon:o.beacon,errorBeacon:o.errorBeacon,...t}}(),function(){let e=a();const t=e.init||{};e.init={...t}}(),s(),function(){let e=a();const t=e.loader_config||{};e.loader_config={...t}}(),a()}},7956:(e,t,r)=>{r.d(t,{N:()=>i});var n=r(3239);function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return void(0,n.iz)("visibilitychange",(function(){if(t)return void("hidden"==document.visibilityState&&e());e(document.visibilityState)}),r,i)}},1214:(e,t,r)=>{r.d(t,{em:()=>v,u5:()=>N,QU:()=>S,_L:()=>I,Gm:()=>L,Lg:()=>M,gy:()=>U,BV:()=>Q,Kf:()=>ee});var n=r(2177);const i="nr@original";var o=Object.prototype.hasOwnProperty,a=!1;function s(e,t){return e||(e=n.ee),r.inPlace=function(e,t,n,i,o){n||(n="");var a,s,c,u="-"===n.charAt(0);for(c=0;c<t.length;c++)d(a=e[s=t[c]])||(e[s]=r(a,u?s+n:n,i,s,o))},r.flag=i,r;function r(t,r,n,a,s){return d(t)?t:(r||(r=""),nrWrapper[i]=t,u(t,nrWrapper,e),nrWrapper);function nrWrapper(){var i,u,d,f;try{u=this,i=[...arguments],d="function"==typeof n?n(i,u):n||{}}catch(t){c([t,"",[i,u,a],d],e)}o(r+"start",[i,u,a],d,s);try{return f=t.apply(u,i)}catch(e){throw o(r+"err",[i,u,e],d,s),e}finally{o(r+"end",[i,u,f],d,s)}}}function o(r,n,i,o){if(!a||t){var s=a;a=!0;try{e.emit(r,n,i,t,o)}catch(t){c([t,r,n,i],e)}a=s}}}function c(e,t){t||(t=n.ee);try{t.emit("internal-error",e)}catch(e){}}function u(e,t,r){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){return e[r]=t,t}})})),t}catch(e){c([e],r)}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return t}function d(e){return!(e&&e instanceof Function&&e.apply&&!e[i])}var f=r(2210),l=r(385);const h={},g=XMLHttpRequest,p="addEventListener",m="removeEventListener";function v(e){var t=function(e){return(e||n.ee).get("events")}(e);if(h[t.debugId]++)return t;h[t.debugId]=1;var r=s(t,!0);function i(e){r.inPlace(e,[p,m],"-",o)}function o(e,t){return e[1]}return"getPrototypeOf"in Object&&(l.il&&b(document,i),b(l._A,i),b(g.prototype,i)),t.on(p+"-start",(function(e,t){var n=e[1];if(null!==n&&("function"==typeof n||"object"==typeof n)){var i=(0,f.X)(n,"nr@wrapped",(function(){var e={object:function(){if("function"!=typeof n.handleEvent)return;return n.handleEvent.apply(n,arguments)},function:n}[typeof n];return e?r(e,"fn-",null,e.name||"anonymous"):n}));this.wrapped=e[1]=i}})),t.on(m+"-start",(function(e){e[1]=this.wrapped||e[1]})),t}function b(e,t){let r=e;for(;"object"==typeof r&&!Object.prototype.hasOwnProperty.call(r,p);)r=Object.getPrototypeOf(r);for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];r&&t(r,...i)}var y="fetch-",w=y+"body-",x=["arrayBuffer","blob","json","text","formData"],A=l._A.Request,E=l._A.Response,T="prototype",_="nr@context";const D={};function N(e){const t=function(e){return(e||n.ee).get("fetch")}(e);if(!(A&&E&&l._A.fetch))return t;if(D[t.debugId]++)return t;function r(e,r,n){var i=e[r];"function"==typeof i&&(e[r]=function(){var e,r=[...arguments],o={};t.emit(n+"before-start",[r],o),o[_]&&o[_].dt&&(e=o[_].dt);var a=i.apply(this,r);return t.emit(n+"start",[r,e],a),a.then((function(e){return t.emit(n+"end",[null,e],a),e}),(function(e){throw t.emit(n+"end",[e],a),e}))})}return D[t.debugId]=1,x.forEach((e=>{r(A[T],e,w),r(E[T],e,w)})),r(l._A,"fetch",y),t.on(y+"end",(function(e,r){var n=this;if(r){var i=r.headers.get("content-length");null!==i&&(n.rxSize=i),t.emit(y+"done",[null,r],n)}else t.emit(y+"done",[e],n)})),t}const O={},j=["pushState","replaceState"];function S(e){const t=function(e){return(e||n.ee).get("history")}(e);return!l.il||O[t.debugId]++||(O[t.debugId]=1,s(t).inPlace(window.history,j,"-")),t}var P=r(3239);const C={},R=["appendChild","insertBefore","replaceChild"];function I(e){const t=function(e){return(e||n.ee).get("jsonp")}(e);if(!l.il||C[t.debugId])return t;C[t.debugId]=!0;var r=s(t),i=/[?&](?:callback|cb)=([^&#]+)/,o=/(.*)\.([^.]+)/,a=/^(\w+)(\.|$)(.*)$/;function c(e,t){var r=e.match(a),n=r[1],i=r[3];return i?c(i,t[n]):t[n]}return r.inPlace(Node.prototype,R,"dom-"),t.on("dom-start",(function(e){!function(e){if(!e||"string"!=typeof e.nodeName||"script"!==e.nodeName.toLowerCase())return;if("function"!=typeof e.addEventListener)return;var n=(a=e.src,s=a.match(i),s?s[1]:null);var a,s;if(!n)return;var u=function(e){var t=e.match(o);if(t&&t.length>=3)return{key:t[2],parent:c(t[1],window)};return{key:e,parent:window}}(n);if("function"!=typeof u.parent[u.key])return;var d={};function f(){t.emit("jsonp-end",[],d),e.removeEventListener("load",f,(0,P.m$)(!1)),e.removeEventListener("error",l,(0,P.m$)(!1))}function l(){t.emit("jsonp-error",[],d),t.emit("jsonp-end",[],d),e.removeEventListener("load",f,(0,P.m$)(!1)),e.removeEventListener("error",l,(0,P.m$)(!1))}r.inPlace(u.parent,[u.key],"cb-",d),e.addEventListener("load",f,(0,P.m$)(!1)),e.addEventListener("error",l,(0,P.m$)(!1)),t.emit("new-jsonp",[e.src],d)}(e[0])})),t}var k=r(5763);const H={};function L(e){const t=function(e){return(e||n.ee).get("mutation")}(e);if(!l.il||H[t.debugId])return t;H[t.debugId]=!0;var r=s(t),i=k.Yu.MO;return i&&(window.MutationObserver=function(e){return this instanceof i?new i(r(e,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype),t}const z={};function M(e){const t=function(e){return(e||n.ee).get("promise")}(e);if(z[t.debugId])return t;z[t.debugId]=!0;var r=n.c,o=s(t),a=k.Yu.PR;return a&&function(){function e(r){var n=t.context(),i=o(r,"executor-",n,null,!1);const s=Reflect.construct(a,[i],e);return t.context(s).getCtx=function(){return n},s}l._A.Promise=e,Object.defineProperty(e,"name",{value:"Promise"}),e.toString=function(){return a.toString()},Object.setPrototypeOf(e,a),["all","race"].forEach((function(r){const n=a[r];e[r]=function(e){let i=!1;[...e||[]].forEach((e=>{this.resolve(e).then(a("all"===r),a(!1))}));const o=n.apply(this,arguments);return o;function a(e){return function(){t.emit("propagate",[null,!i],o,!1,!1),i=i||!e}}}})),["resolve","reject"].forEach((function(r){const n=a[r];e[r]=function(e){const r=n.apply(this,arguments);return e!==r&&t.emit("propagate",[e,!0],r,!1,!1),r}})),e.prototype=a.prototype;const n=a.prototype.then;a.prototype.then=function(){var e=this,i=r(e);i.promise=e;for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];s[0]=o(s[0],"cb-",i,null,!1),s[1]=o(s[1],"cb-",i,null,!1);const u=n.apply(this,s);return i.nextPromise=u,t.emit("propagate",[e,!0],u,!1,!1),u},a.prototype.then[i]=n,t.on("executor-start",(function(e){e[0]=o(e[0],"resolve-",this,null,!1),e[1]=o(e[1],"resolve-",this,null,!1)})),t.on("executor-err",(function(e,t,r){e[1](r)})),t.on("cb-end",(function(e,r,n){t.emit("propagate",[n,!0],this.nextPromise,!1,!1)})),t.on("propagate",(function(e,r,n){this.getCtx&&!r||(this.getCtx=function(){if(e instanceof Promise)var r=t.context(e);return r&&r.getCtx?r.getCtx():this})}))}(),t}const B={},F="requestAnimationFrame";function U(e){const t=function(e){return(e||n.ee).get("raf")}(e);if(!l.il||B[t.debugId]++)return t;B[t.debugId]=1;var r=s(t);return r.inPlace(window,[F],"raf-"),t.on("raf-start",(function(e){e[0]=r(e[0],"fn-")})),t}const q={},G="setTimeout",V="setInterval",X="clearTimeout",W="-start",Z="-",$=[G,"setImmediate",V,X,"clearImmediate"];function Q(e){const t=function(e){return(e||n.ee).get("timer")}(e);if(q[t.debugId]++)return t;q[t.debugId]=1;var r=s(t);return r.inPlace(l._A,$.slice(0,2),G+Z),r.inPlace(l._A,$.slice(2,3),V+Z),r.inPlace(l._A,$.slice(3),X+Z),t.on(V+W,(function(e,t,n){e[0]=r(e[0],"fn-",null,n)})),t.on(G+W,(function(e,t,n){this.method=n,this.timerDuration=isNaN(e[1])?0:+e[1],e[0]=r(e[0],"fn-",this,n)})),t}var Y=r(50);const K={},J=["open","send"];function ee(e){var t=e||n.ee;const r=function(e){return(e||n.ee).get("xhr")}(t);if(K[r.debugId]++)return r;K[r.debugId]=1,v(t);var i=s(r),o=k.Yu.XHR,a=k.Yu.MO,c=k.Yu.PR,u=k.Yu.SI,d="readystatechange",f=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],h=[],g=l._A.XMLHttpRequest.listeners,p=l._A.XMLHttpRequest=function(e){var t=new o(e);function n(){try{r.emit("new-xhr",[t],t),t.addEventListener(d,b,(0,P.m$)(!1))}catch(e){(0,Y.Z)("An error occured while intercepting XHR",e);try{r.emit("internal-error",[e])}catch(e){}}}return this.listeners=g?[...g,n]:[n],this.listeners.forEach((e=>e())),t};function m(e,t){i.inPlace(t,["onreadystatechange"],"fn-",E)}function b(){var e=this,t=r.context(e);e.readyState>3&&!t.resolved&&(t.resolved=!0,r.emit("xhr-resolved",[],e)),i.inPlace(e,f,"fn-",E)}if(function(e,t){for(var r in e)t[r]=e[r]}(o,p),p.prototype=o.prototype,i.inPlace(p.prototype,J,"-xhr-",E),r.on("send-xhr-start",(function(e,t){m(e,t),function(e){h.push(e),a&&(y?y.then(A):u?u(A):(w=-w,x.data=w))}(t)})),r.on("open-xhr-start",m),a){var y=c&&c.resolve();if(!u&&!c){var w=1,x=document.createTextNode(w);new a(A).observe(x,{characterData:!0})}}else t.on("fn-end",(function(e){e[0]&&e[0].type===d||A()}));function A(){for(var e=0;e<h.length;e++)m(0,h[e]);h.length&&(h=[])}function E(e,t){return t}return r}},7825:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.ajax},6660:(e,t,r)=>{r.d(t,{A:()=>i,t:()=>n});const n=r(3325).D.jserrors,i="nr@seenError"},3081:(e,t,r)=>{r.d(t,{gF:()=>o,mY:()=>i,t9:()=>n,vz:()=>s,xS:()=>a});const n=r(3325).D.metrics,i="sm",o="cm",a="storeSupportabilityMetrics",s="storeEventMetrics"},4649:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.pageAction},7633:(e,t,r)=>{r.d(t,{Dz:()=>i,OJ:()=>a,qw:()=>o,t9:()=>n});const n=r(3325).D.pageViewEvent,i="firstbyte",o="domcontent",a="windowload"},9251:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.pageViewTiming},3614:(e,t,r)=>{r.d(t,{BST_RESOURCE:()=>i,END:()=>s,FEATURE_NAME:()=>n,FN_END:()=>u,FN_START:()=>c,PUSH_STATE:()=>d,RESOURCE:()=>o,START:()=>a});const n=r(3325).D.sessionTrace,i="bstResource",o="resource",a="-start",s="-end",c="fn"+a,u="fn"+s,d="pushState"},7836:(e,t,r)=>{r.d(t,{BODY:()=>A,CB_END:()=>E,CB_START:()=>u,END:()=>x,FEATURE_NAME:()=>i,FETCH:()=>_,FETCH_BODY:()=>v,FETCH_DONE:()=>m,FETCH_START:()=>p,FN_END:()=>c,FN_START:()=>s,INTERACTION:()=>l,INTERACTION_API:()=>d,INTERACTION_EVENTS:()=>o,JSONP_END:()=>b,JSONP_NODE:()=>g,JS_TIME:()=>T,MAX_TIMER_BUDGET:()=>a,REMAINING:()=>f,SPA_NODE:()=>h,START:()=>w,originalSetTimeout:()=>y});var n=r(5763);const i=r(3325).D.spa,o=["click","submit","keypress","keydown","keyup","change"],a=999,s="fn-start",c="fn-end",u="cb-start",d="api-ixn-",f="remaining",l="interaction",h="spaNode",g="jsonpNode",p="fetch-start",m="fetch-done",v="fetch-body-",b="jsonp-end",y=n.Yu.ST,w="-start",x="-end",A="-body",E="cb"+x,T="jsTime",_="fetch"},5938:(e,t,r)=>{r.d(t,{W:()=>o});var n=r(5763),i=r(2177);class o{constructor(e,t,r){this.agentIdentifier=e,this.aggregator=t,this.ee=i.ee.get(e,(0,n.OP)(this.agentIdentifier).isolatedBacklog),this.featureName=r,this.blocked=!1}}},9144:(e,t,r)=>{r.d(t,{j:()=>m});var n=r(3325),i=r(5763),o=r(5546),a=r(2177),s=r(7894),c=r(8e3),u=r(3960),d=r(385),f=r(50),l=r(3081),h=r(8632);function g(){const e=(0,h.gG)();["setErrorHandler","finished","addToTrace","inlineHit","addRelease","addPageAction","setCurrentRouteName","setPageViewName","setCustomAttribute","interaction","noticeError","setUserId"].forEach((t=>{e[t]=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];let o=[];return Object.values(e.initializedAgents).forEach((e=>{e.exposed&&e.api[t]&&o.push(e.api[t](...n))})),o.length>1?o:o[0]}(t,...n)}}))}var p=r(2587);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0,{init:b,info:y,loader_config:w,runtime:x={loaderType:m},exposed:A=!0}=t;const E=(0,h.gG)();y||(b=E.init,y=E.info,w=E.loader_config),(0,i.Dg)(e,b||{}),(0,i.GE)(e,w||{}),(0,i.sU)(e,x),y.jsAttributes??={},d.v6&&(y.jsAttributes.isWorker=!0),(0,i.CX)(e,y),g();const T=function(e,t){t||(0,c.R)(e,"api");const h={};var g=a.ee.get(e),p=g.get("tracer"),m="api-",v=m+"ixn-";function b(t,r,n,o){const a=(0,i.C5)(e);return null===r?delete a.jsAttributes[t]:(0,i.CX)(e,{...a,jsAttributes:{...a.jsAttributes,[t]:r}}),x(m,n,!0,o||null===r?"session":void 0)(t,r)}function y(){}["setErrorHandler","finished","addToTrace","inlineHit","addRelease"].forEach((e=>h[e]=x(m,e,!0,"api"))),h.addPageAction=x(m,"addPageAction",!0,n.D.pageAction),h.setCurrentRouteName=x(m,"routeName",!0,n.D.spa),h.setPageViewName=function(t,r){if("string"==typeof t)return"/"!==t.charAt(0)&&(t="/"+t),(0,i.OP)(e).customTransaction=(r||"http://custom.transaction")+t,x(m,"setPageViewName",!0)()},h.setCustomAttribute=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){if(["string","number"].includes(typeof t)||null===t)return b(e,t,"setCustomAttribute",r);(0,f.Z)("Failed to execute setCustomAttribute.\nNon-null value must be a string or number type, but a type of <".concat(typeof t,"> was provided."))}else(0,f.Z)("Failed to execute setCustomAttribute.\nName must be a string type, but a type of <".concat(typeof e,"> was provided."))},h.setUserId=function(e){if("string"==typeof e||null===e)return b("enduser.id",e,"setUserId",!0);(0,f.Z)("Failed to execute setUserId.\nNon-null value must be a string type, but a type of <".concat(typeof e,"> was provided."))},h.interaction=function(){return(new y).get()};var w=y.prototype={createTracer:function(e,t){var r={},i=this,a="function"==typeof t;return(0,o.p)(v+"tracer",[(0,s.z)(),e,r],i,n.D.spa,g),function(){if(p.emit((a?"":"no-")+"fn-start",[(0,s.z)(),i,a],r),a)try{return t.apply(this,arguments)}catch(e){throw p.emit("fn-err",[arguments,this,"string"==typeof e?new Error(e):e],r),e}finally{p.emit("fn-end",[(0,s.z)()],r)}}}};function x(e,t,r,i){return function(){return(0,o.p)(l.xS,["API/"+t+"/called"],void 0,n.D.metrics,g),i&&(0,o.p)(e+t,[(0,s.z)(),...arguments],r?null:this,i,g),r?void 0:this}}function A(){r.e(439).then(r.bind(r,7438)).then((t=>{let{setAPI:r}=t;r(e),(0,c.L)(e,"api")})).catch((()=>(0,f.Z)("Downloading runtime APIs failed...")))}return["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach((e=>{w[e]=x(v,e,void 0,n.D.spa)})),h.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),(0,o.p)(l.xS,["API/noticeError/called"],void 0,n.D.metrics,g),(0,o.p)("err",[e,(0,s.z)(),!1,t],void 0,n.D.jserrors,g)},d.il?(0,u.b)((()=>A()),!0):A(),h}(e,v);return(0,h.Qy)(e,T,"api"),(0,h.Qy)(e,A,"exposed"),(0,h.EZ)("activatedFeatures",p.T),T}},3325:(e,t,r)=>{r.d(t,{D:()=>n,p:()=>i});const n={ajax:"ajax",jserrors:"jserrors",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",spa:"spa"},i={[n.pageViewEvent]:1,[n.pageViewTiming]:2,[n.metrics]:3,[n.jserrors]:4,[n.ajax]:5,[n.sessionTrace]:6,[n.pageAction]:7,[n.spa]:8,[n.sessionReplay]:9}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>(({78:"page_action-aggregate",147:"metrics-aggregate",242:"session-manager",317:"jserrors-aggregate",348:"page_view_timing-aggregate",412:"lazy-feature-loader",439:"async-api",538:"recorder",590:"session_replay-aggregate",675:"compressor",733:"session_trace-aggregate",786:"page_view_event-aggregate",873:"spa-aggregate",898:"ajax-aggregate"}[e]||e)+"."+{78:"ac76d497",147:"3dc53903",148:"1a20d5fe",242:"2a64278a",317:"49e41428",348:"bd6de33a",412:"2f55ce66",439:"30bd804e",538:"1b18459f",590:"cf0efb30",675:"ae9f91a8",733:"83105561",786:"06482edd",860:"03a8b7a5",873:"e6b09d52",898:"998ef92b"}[e]+"-1.236.0.min.js"),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA:",i.l=(r,n,o,a)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var f=u[d];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+o){s=f;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[n];var l=(t,n)=>{s.onerror=s.onload=null,clearTimeout(h);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(l.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=l.bind(null,s.onerror),s.onload=l.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=364,i.p="https://js-agent.newrelic.com/",(()=>{var e={364:0,953:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<a.length;u++)o=a[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=window.webpackChunkNRBA=window.webpackChunkNRBA||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o={};(()=>{i.r(o);var e=i(3325),t=i(5763);const r=Object.values(e.D);function n(e){const n={};return r.forEach((r=>{n[r]=function(e,r){return!1!==(0,t.Mt)(r,"".concat(e,".enabled"))}(r,e)})),n}var a=i(9144);var s=i(5546),c=i(385),u=i(8e3),d=i(5938),f=i(3960),l=i(50);class h extends d.W{constructor(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(e,t,r),this.auto=n,this.abortHandler,this.featAggregate,this.onAggregateImported,n&&(0,u.R)(e,r)}importAggregator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.featAggregate||!this.auto)return;const r=c.il&&!0===(0,t.Mt)(this.agentIdentifier,"privacy.cookies_enabled");let n;this.onAggregateImported=new Promise((e=>{n=e}));const o=async()=>{let t;try{if(r){const{setupAgentSession:e}=await Promise.all([i.e(860),i.e(242)]).then(i.bind(i,3228));t=e(this.agentIdentifier)}}catch(e){(0,l.Z)("A problem occurred when starting up session manager. This page will not start or extend any session.",e)}try{if(!this.shouldImportAgg(this.featureName,t))return void(0,u.L)(this.agentIdentifier,this.featureName);const{lazyFeatureLoader:r}=await i.e(412).then(i.bind(i,8582)),{Aggregate:o}=await r(this.featureName,"aggregate");this.featAggregate=new o(this.agentIdentifier,this.aggregator,e),n(!0)}catch(e){(0,l.Z)("Downloading and initializing ".concat(this.featureName," failed..."),e),this.abortHandler?.(),n(!1)}};c.il?(0,f.b)((()=>o()),!0):o()}shouldImportAgg(r,n){return r!==e.D.sessionReplay||!1!==(0,t.Mt)(this.agentIdentifier,"session_trace.enabled")&&(!!n?.isNew||!!n?.state.sessionReplay)}}var g=i(7633),p=i(7894);class m extends h{static featureName=g.t9;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(super(r,n,g.t9,i),("undefined"==typeof PerformanceNavigationTiming||c.Tt)&&"undefined"!=typeof PerformanceTiming){const n=(0,t.OP)(r);n[g.Dz]=Math.max(Date.now()-n.offset,0),(0,f.K)((()=>n[g.qw]=Math.max((0,p.z)()-n[g.Dz],0))),(0,f.b)((()=>{const t=(0,p.z)();n[g.OJ]=Math.max(t-n[g.Dz],0),(0,s.p)("timing",["load",t],void 0,e.D.pageViewTiming,this.ee)}))}this.importAggregator()}}var v=i(1117),b=i(1284);class y extends v.w{constructor(e){super(e),this.aggregatedData={}}store(e,t,r,n,i){var o=this.getBucket(e,t,r,i);return o.metrics=function(e,t){t||(t={count:0});return t.count+=1,(0,b.D)(e,(function(e,r){t[e]=w(r,t[e])})),t}(n,o.metrics),o}merge(e,t,r,n,i){var o=this.getBucket(e,t,n,i);if(o.metrics){var a=o.metrics;a.count+=r.count,(0,b.D)(r,(function(e,t){if("count"!==e){var n=a[e],i=r[e];i&&!i.c?a[e]=w(i.t,n):a[e]=function(e,t){if(!t)return e;t.c||(t=x(t.t));return t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max),t.t+=e.t,t.sos+=e.sos,t.c+=e.c,t}(i,a[e])}}))}else o.metrics=r}storeMetric(e,t,r,n){var i=this.getBucket(e,t,r);return i.stats=w(n,i.stats),i}getBucket(e,t,r,n){this.aggregatedData[e]||(this.aggregatedData[e]={});var i=this.aggregatedData[e][t];return i||(i=this.aggregatedData[e][t]={params:r||{}},n&&(i.custom=n)),i}get(e,t){return t?this.aggregatedData[e]&&this.aggregatedData[e][t]:this.aggregatedData[e]}take(e){for(var t={},r="",n=!1,i=0;i<e.length;i++)t[r=e[i]]=A(this.aggregatedData[r]),t[r].length&&(n=!0),delete this.aggregatedData[r];return n?t:null}}function w(e,t){return null==e?function(e){e?e.c++:e={c:1};return e}(t):t?(t.c||(t=x(t.t)),t.c+=1,t.t+=e,t.sos+=e*e,e>t.max&&(t.max=e),e<t.min&&(t.min=e),t):{t:e}}function x(e){return{t:e,min:e,max:e,sos:e*e,c:1}}function A(e){return"object"!=typeof e?[]:(0,b.D)(e,E)}function E(e,t){return t}var T=i(8632),_=i(4402),D=i(4351);var N=i(7956),O=i(3239),j=i(9251);class S extends h{static featureName=j.t;constructor(e,r){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,r,j.t,n),c.il&&((0,t.OP)(e).initHidden=Boolean("hidden"===document.visibilityState),(0,N.N)((()=>(0,s.p)("docHidden",[(0,p.z)()],void 0,j.t,this.ee)),!0),(0,O.bP)("pagehide",(()=>(0,s.p)("winPagehide",[(0,p.z)()],void 0,j.t,this.ee))),this.importAggregator())}}var P=i(3081);class C extends h{static featureName=P.t9;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,P.t9,r),this.importAggregator()}}var R,I=i(2210),k=i(1214),H=i(2177),L={};try{R=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(L.console=!0,-1!==R.indexOf("dev")&&(L.dev=!0),-1!==R.indexOf("nr_dev")&&(L.nrDev=!0))}catch(e){}function z(e){try{L.console&&z(e)}catch(e){}}L.nrDev&&H.ee.on("internal-error",(function(e){z(e.stack)})),L.dev&&H.ee.on("fn-err",(function(e,t,r){z(r.stack)})),L.dev&&(z("NR AGENT IN DEVELOPMENT MODE"),z("flags: "+(0,b.D)(L,(function(e,t){return e})).join(", ")));var M=i(6660);class B extends h{static featureName=M.t;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(r,n,M.t,i),this.skipNext=0;try{this.removeOnAbort=new AbortController}catch(e){}const o=this;o.ee.on("fn-start",(function(e,t,r){o.abortHandler&&(o.skipNext+=1)})),o.ee.on("fn-err",(function(t,r,n){o.abortHandler&&!n[M.A]&&((0,I.X)(n,M.A,(function(){return!0})),this.thrown=!0,(0,s.p)("err",[n,(0,p.z)()],void 0,e.D.jserrors,o.ee))})),o.ee.on("fn-end",(function(){o.abortHandler&&!this.thrown&&o.skipNext>0&&(o.skipNext-=1)})),o.ee.on("internal-error",(function(t){(0,s.p)("ierr",[t,(0,p.z)(),!0],void 0,e.D.jserrors,o.ee)})),this.origOnerror=c._A.onerror,c._A.onerror=this.onerrorHandler.bind(this),c._A.addEventListener("unhandledrejection",(t=>{const r=function(e){let t="Unhandled Promise Rejection: ";if(e instanceof Error)try{return e.message=t+e.message,e}catch(t){return e}if(void 0===e)return new Error(t);try{return new Error(t+(0,D.P)(e))}catch(e){return new Error(t)}}(t.reason);(0,s.p)("err",[r,(0,p.z)(),!1,{unhandledPromiseRejection:1}],void 0,e.D.jserrors,this.ee)}),(0,O.m$)(!1,this.removeOnAbort?.signal)),(0,k.gy)(this.ee),(0,k.BV)(this.ee),(0,k.em)(this.ee),(0,t.OP)(r).xhrWrappable&&(0,k.Kf)(this.ee),this.abortHandler=this.#e,this.importAggregator()}#e(){this.removeOnAbort?.abort(),this.abortHandler=void 0}onerrorHandler(t,r,n,i,o){"function"==typeof this.origOnerror&&this.origOnerror(...arguments);try{this.skipNext?this.skipNext-=1:(0,s.p)("err",[o||new F(t,r,n),(0,p.z)()],void 0,e.D.jserrors,this.ee)}catch(t){try{(0,s.p)("ierr",[t,(0,p.z)(),!0],void 0,e.D.jserrors,this.ee)}catch(e){}}return!1}}function F(e,t,r){this.message=e||"Uncaught error with no additional information",this.sourceURL=t,this.line=r}let U=1;const q="nr@id";function G(e){const t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===c._A?0:(0,I.X)(e,q,(function(){return U++}))}function V(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return(0,D.P)(e).length}catch(e){return}}}var X=i(7243);class W{constructor(e){this.agentIdentifier=e,this.generateTracePayload=this.generateTracePayload.bind(this),this.shouldGenerateTrace=this.shouldGenerateTrace.bind(this)}generateTracePayload(e){if(!this.shouldGenerateTrace(e))return null;var r=(0,t.DL)(this.agentIdentifier);if(!r)return null;var n=(r.accountID||"").toString()||null,i=(r.agentID||"").toString()||null,o=(r.trustKey||"").toString()||null;if(!n||!i)return null;var a=(0,_.M)(),s=(0,_.Ht)(),c=Date.now(),u={spanId:a,traceId:s,timestamp:c};return(e.sameOrigin||this.isAllowedOrigin(e)&&this.useTraceContextHeadersForCors())&&(u.traceContextParentHeader=this.generateTraceContextParentHeader(a,s),u.traceContextStateHeader=this.generateTraceContextStateHeader(a,c,n,i,o)),(e.sameOrigin&&!this.excludeNewrelicHeader()||!e.sameOrigin&&this.isAllowedOrigin(e)&&this.useNewrelicHeaderForCors())&&(u.newrelicHeader=this.generateTraceHeader(a,s,c,n,i,o)),u}generateTraceContextParentHeader(e,t){return"00-"+t+"-"+e+"-01"}generateTraceContextStateHeader(e,t,r,n,i){return i+"@nr=0-1-"+r+"-"+n+"-"+e+"----"+t}generateTraceHeader(e,t,r,n,i,o){if(!("function"==typeof c._A?.btoa))return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:i,id:e,tr:t,ti:r}};return o&&n!==o&&(a.d.tk=o),btoa((0,D.P)(a))}shouldGenerateTrace(e){return this.isDtEnabled()&&this.isAllowedOrigin(e)}isAllowedOrigin(e){var r=!1,n={};if((0,t.Mt)(this.agentIdentifier,"distributed_tracing")&&(n=(0,t.P_)(this.agentIdentifier).distributed_tracing),e.sameOrigin)r=!0;else if(n.allowed_origins instanceof Array)for(var i=0;i<n.allowed_origins.length;i++){var o=(0,X.e)(n.allowed_origins[i]);if(e.hostname===o.hostname&&e.protocol===o.protocol&&e.port===o.port){r=!0;break}}return r}isDtEnabled(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.enabled}excludeNewrelicHeader(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.exclude_newrelic_header}useNewrelicHeaderForCors(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!1!==e.cors_use_newrelic_header}useTraceContextHeadersForCors(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.cors_use_tracecontext_headers}}var Z=i(7825),$=["load","error","abort","timeout"],Q=$.length,Y=t.Yu.REQ,K=c._A.XMLHttpRequest;class J extends h{static featureName=Z.t;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(r,n,Z.t,i),(0,t.OP)(r).xhrWrappable&&(this.dt=new W(r),this.handler=(e,t,r,n)=>(0,s.p)(e,t,r,n,this.ee),(0,k.u5)(this.ee),(0,k.Kf)(this.ee),function(r,n,i,o){function a(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=E,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,t.params=this.params||{},t.metrics=this.metrics||{},e.addEventListener("load",(function(r){_(t,e)}),(0,O.m$)(!1)),c.IF||e.addEventListener("progress",(function(e){t.lastSize=e.loaded}),(0,O.m$)(!1))}function s(e){this.params={method:e[0]},T(this,e[1]),this.metrics={}}function u(e,n){var i=(0,t.DL)(r);i.xpid&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",i.xpid);var a=o.generateTracePayload(this.parsedOrigin);if(a){var s=!1;a.newrelicHeader&&(n.setRequestHeader("newrelic",a.newrelicHeader),s=!0),a.traceContextParentHeader&&(n.setRequestHeader("traceparent",a.traceContextParentHeader),a.traceContextStateHeader&&n.setRequestHeader("tracestate",a.traceContextStateHeader),s=!0),s&&(this.dt=a)}}function d(e,t){var r=this.metrics,i=e[0],o=this;if(r&&i){var a=V(i);a&&(r.txSize=a)}this.startTime=(0,p.z)(),this.listener=function(e){try{"abort"!==e.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==e.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof t.onload)&&"function"==typeof o.end)&&o.end(t)}catch(e){try{n.emit("internal-error",[e])}catch(e){}}};for(var s=0;s<Q;s++)t.addEventListener($[s],this.listener,(0,O.m$)(!1))}function f(e,t,r){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof r.onload||"function"!=typeof this.end||this.end(r)}function l(e,t){var r=""+G(e)+!!t;this.xhrGuids&&!this.xhrGuids[r]&&(this.xhrGuids[r]=!0,this.totalCbs+=1)}function h(e,t){var r=""+G(e)+!!t;this.xhrGuids&&this.xhrGuids[r]&&(delete this.xhrGuids[r],this.totalCbs-=1)}function g(){this.endTime=(0,p.z)()}function m(e,t){t instanceof K&&"load"===e[0]&&n.emit("xhr-load-added",[e[1],e[2]],t)}function v(e,t){t instanceof K&&"load"===e[0]&&n.emit("xhr-load-removed",[e[1],e[2]],t)}function b(e,t,r){t instanceof K&&("onload"===r&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=(0,p.z)()))}function y(e,t){this.xhrCbStart&&n.emit("xhr-cb-time",[(0,p.z)()-this.xhrCbStart,this.onload,t],t)}function w(e){var t,r=e[1]||{};"string"==typeof e[0]?t=e[0]:e[0]&&e[0].url?t=e[0].url:c._A?.URL&&e[0]&&e[0]instanceof URL&&(t=e[0].href),t&&(this.parsedOrigin=(0,X.e)(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var n=o.generateTracePayload(this.parsedOrigin);if(n&&(n.newrelicHeader||n.traceContextParentHeader))if("string"==typeof e[0]||c._A?.URL&&e[0]&&e[0]instanceof URL){var i={};for(var a in r)i[a]=r[a];i.headers=new Headers(r.headers||{}),s(i.headers,n)&&(this.dt=n),e.length>1?e[1]=i:e.push(i)}else e[0]&&e[0].headers&&s(e[0].headers,n)&&(this.dt=n);function s(e,t){var r=!1;return t.newrelicHeader&&(e.set("newrelic",t.newrelicHeader),r=!0),t.traceContextParentHeader&&(e.set("traceparent",t.traceContextParentHeader),t.traceContextStateHeader&&e.set("tracestate",t.traceContextStateHeader),r=!0),r}}function x(e,t){this.params={},this.metrics={},this.startTime=(0,p.z)(),this.dt=t,e.length>=1&&(this.target=e[0]),e.length>=2&&(this.opts=e[1]);var r,n=this.opts||{},i=this.target;"string"==typeof i?r=i:"object"==typeof i&&i instanceof Y?r=i.url:c._A?.URL&&"object"==typeof i&&i instanceof URL&&(r=i.href),T(this,r);var o=(""+(i&&i instanceof Y&&i.method||n.method||"GET")).toUpperCase();this.params.method=o,this.txSize=V(n.body)||0}function A(t,r){var n;this.endTime=(0,p.z)(),this.params||(this.params={}),this.params.status=r?r.status:0,"string"==typeof this.rxSize&&this.rxSize.length>0&&(n=+this.rxSize);var o={txSize:this.txSize,rxSize:n,duration:(0,p.z)()-this.startTime};i("xhr",[this.params,o,this.startTime,this.endTime,"fetch"],this,e.D.ajax)}function E(t){var r=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var o=0;o<Q;o++)t.removeEventListener($[o],this.listener,!1);r.aborted||(n.duration=(0,p.z)()-this.startTime,this.loadCaptureCalled||4!==t.readyState?null==r.status&&(r.status=0):_(this,t),n.cbTime=this.cbTime,i("xhr",[r,n,this.startTime,this.endTime,"xhr"],this,e.D.ajax))}}function T(e,t){var r=(0,X.e)(t),n=e.params;n.hostname=r.hostname,n.port=r.port,n.protocol=r.protocol,n.host=r.hostname+":"+r.port,n.pathname=r.pathname,e.parsedOrigin=r,e.sameOrigin=r.sameOrigin}function _(e,t){e.params.status=t.status;var r=function(e,t){var r=e.responseType;return"json"===r&&null!==t?t:"arraybuffer"===r||"blob"===r||"json"===r?V(e.response):"text"===r||""===r||void 0===r?V(e.responseText):void 0}(t,e.lastSize);if(r&&(e.metrics.rxSize=r),e.sameOrigin){var n=t.getResponseHeader("X-NewRelic-App-Data");n&&(e.params.cat=n.split(", ").pop())}e.loadCaptureCalled=!0}n.on("new-xhr",a),n.on("open-xhr-start",s),n.on("open-xhr-end",u),n.on("send-xhr-start",d),n.on("xhr-cb-time",f),n.on("xhr-load-added",l),n.on("xhr-load-removed",h),n.on("xhr-resolved",g),n.on("addEventListener-end",m),n.on("removeEventListener-end",v),n.on("fn-end",y),n.on("fetch-before-start",w),n.on("fetch-start",x),n.on("fn-start",b),n.on("fetch-done",A)}(r,this.ee,this.handler,this.dt),this.importAggregator())}}var ee=i(3614);const{BST_RESOURCE:te,RESOURCE:re,START:ne,END:ie,FEATURE_NAME:oe,FN_END:ae,FN_START:se,PUSH_STATE:ce}=ee;var ue=i(7836);const{FEATURE_NAME:de,START:fe,END:le,BODY:he,CB_END:ge,JS_TIME:pe,FETCH:me,FN_START:ve,CB_START:be,FN_END:ye}=ue;var we=i(4649);class xe extends h{static featureName=we.t;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,we.t,r),this.importAggregator()}}new class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,_.ky)(16);c._A?(this.agentIdentifier=t,this.sharedAggregator=new y({agentIdentifier:this.agentIdentifier}),this.features={},this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(m),Object.assign(this,(0,a.j)(this.agentIdentifier,e,e.loaderType||"agent")),this.start()):(0,l.Z)("Failed to initial the agent. Could not determine the runtime environment.")}get config(){return{info:(0,t.C5)(this.agentIdentifier),init:(0,t.P_)(this.agentIdentifier),loader_config:(0,t.DL)(this.agentIdentifier),runtime:(0,t.OP)(this.agentIdentifier)}}start(){const t="features";try{const r=n(this.agentIdentifier),i=[...this.desiredFeatures];i.sort(((t,r)=>e.p[t.featureName]-e.p[r.featureName])),i.forEach((t=>{if(r[t.featureName]||t.featureName===e.D.pageViewEvent){const n=function(t){switch(t){case e.D.ajax:return[e.D.jserrors];case e.D.sessionTrace:return[e.D.ajax,e.D.pageViewEvent];case e.D.sessionReplay:return[e.D.sessionTrace];case e.D.pageViewTiming:return[e.D.pageViewEvent];default:return[]}}(t.featureName);n.every((e=>r[e]))||(0,l.Z)("".concat(t.featureName," is enabled but one or more dependent features has been disabled (").concat((0,D.P)(n),"). This may cause unintended consequences or missing data...")),this.features[t.featureName]=new t(this.agentIdentifier,this.sharedAggregator)}})),(0,T.Qy)(this.agentIdentifier,this.features,t)}catch(e){(0,l.Z)("Failed to initialize all enabled instrument classes (agent aborted) -",e);for(const e in this.features)this.features[e].abortHandler?.();const r=(0,T.fP)();return delete r.initializedAgents[this.agentIdentifier]?.api,delete r.initializedAgents[this.agentIdentifier]?.[t],delete this.sharedAggregator,r.ee?.abort(),delete r.ee?.get(this.agentIdentifier),!1}}}({features:[J,m,S,class extends h{static featureName=oe;constructor(t,r){if(super(t,r,oe,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),!c.il)return;const n=this.ee;let i;(0,k.QU)(n),this.eventsEE=(0,k.em)(n),this.eventsEE.on(se,(function(e,t){this.bstStart=(0,p.z)()})),this.eventsEE.on(ae,(function(t,r){(0,s.p)("bst",[t[0],r,this.bstStart,(0,p.z)()],void 0,e.D.sessionTrace,n)})),n.on(ce+ne,(function(e){this.time=(0,p.z)(),this.startPath=location.pathname+location.hash})),n.on(ce+ie,(function(t){(0,s.p)("bstHist",[location.pathname+location.hash,this.startPath,this.time],void 0,e.D.sessionTrace,n)}));try{i=new PerformanceObserver((t=>{const r=t.getEntries();(0,s.p)(te,[r],void 0,e.D.sessionTrace,n)})),i.observe({type:re,buffered:!0})}catch(e){}this.importAggregator({resourceObserver:i})}},C,xe,B,class extends h{static featureName=de;constructor(e,r){if(super(e,r,de,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),!c.il)return;if(!(0,t.OP)(e).xhrWrappable)return;try{this.removeOnAbort=new AbortController}catch(e){}let n,i=0;const o=this.ee.get("tracer"),a=(0,k._L)(this.ee),s=(0,k.Lg)(this.ee),u=(0,k.BV)(this.ee),d=(0,k.Kf)(this.ee),f=this.ee.get("events"),l=(0,k.u5)(this.ee),h=(0,k.QU)(this.ee),g=(0,k.Gm)(this.ee);function m(e,t){h.emit("newURL",[""+window.location,t])}function v(){i++,n=window.location.hash,this[ve]=(0,p.z)()}function b(){i--,window.location.hash!==n&&m(0,!0);var e=(0,p.z)();this[pe]=~~this[pe]+e-this[ve],this[ye]=e}function y(e,t){e.on(t,(function(){this[t]=(0,p.z)()}))}this.ee.on(ve,v),s.on(be,v),a.on(be,v),this.ee.on(ye,b),s.on(ge,b),a.on(ge,b),this.ee.buffer([ve,ye,"xhr-resolved"],this.featureName),f.buffer([ve],this.featureName),u.buffer(["setTimeout"+le,"clearTimeout"+fe,ve],this.featureName),d.buffer([ve,"new-xhr","send-xhr"+fe],this.featureName),l.buffer([me+fe,me+"-done",me+he+fe,me+he+le],this.featureName),h.buffer(["newURL"],this.featureName),g.buffer([ve],this.featureName),s.buffer(["propagate",be,ge,"executor-err","resolve"+fe],this.featureName),o.buffer([ve,"no-"+ve],this.featureName),a.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"],this.featureName),y(l,me+fe),y(l,me+"-done"),y(a,"new-jsonp"),y(a,"jsonp-end"),y(a,"cb-start"),h.on("pushState-end",m),h.on("replaceState-end",m),window.addEventListener("hashchange",m,(0,O.m$)(!0,this.removeOnAbort?.signal)),window.addEventListener("load",m,(0,O.m$)(!0,this.removeOnAbort?.signal)),window.addEventListener("popstate",(function(){m(0,i>1)}),(0,O.m$)(!0,this.removeOnAbort?.signal)),this.abortHandler=this.#e,this.importAggregator()}#e(){this.removeOnAbort?.abort(),this.abortHandler=void 0}}],loaderType:"spa"})})(),window.NRBA=o})();</script><meta charset="UTF-8"/><meta name="robots" content="index, follow"/><meta name="DC.Creator" content="YingHan"/><meta name="DC.Creator" content="LuoyiLi"/><meta name="DC.Creator" content="WeirongChen"/><meta name="DC.Creator" content="YujingHou"/><meta name="DC.Creator" content="JiefuZhang"/><meta name="DC.title" content="A bi-cyclic co-optimization method for sizing of electricity-hydrogen hybrid energy storage microgrid "/><meta name="DC.publisher" content="Royal Society of Chemistry"/><meta name="DC.Date" content="2022/08/23"/><meta name="DC.Identifier" scheme="doi" content="10.1039/D2SE00556E"/><meta name="DC.Language" content="en"/><meta name="citation_title" content="A bi-cyclic co-optimization method for sizing of electricity-hydrogen hybrid energy storage microgrid "/><meta name="citation_author" content="YingHan"/><meta name="citation_author" content="LuoyiLi"/><meta name="citation_author" content="WeirongChen"/><meta name="citation_author" content="YujingHou"/><meta name="citation_author" content="JiefuZhang"/><meta name="citation_online_date" content="2022/07/22"/><meta name="citation_date" content="2022"/><meta name="citation_journal_title" content="Sustainable Energy &amp; Fuels"/><meta name="citation_volume" content="6"/><meta name="citation_issue" content="17"/><meta name="citation_firstpage" content="4048"/><meta name="citation_lastpage" content="4061"/><meta name="citation_doi" content="10.1039/D2SE00556E"/><meta name="citation_pdf_url" content="https://pubs.rsc.org/en/content/articlepdf/2022/se/d2se00556e"/><meta name="citation_abstract_html_url" content="https://pubs.rsc.org/en/content/articlelanding/2022/se/d2se00556e"/><meta name="citation_fulltext_html_url" content="https://pubs.rsc.org/en/content/articlehtml/2022/se/d2se00556e"/><link rel="shortcut icon" href=""/><link type="text/css" rel="stylesheet" href="/content/stylesheets/rschtml2.css?ver=6_2_1"/><link href="https://www.rsc-cdn.org/oxygen/assets/webfonts/fonts.min.css" rel="stylesheet" type="text/css"/><link type="text/css" rel="stylesheet" href="/content/stylesheets/pubs-ui.min.css"/><meta name="viewport" content="width=device-width, initial-scale=1"/><script type="text/javascript" src="/content/scripts/JQueryPlugins.min.js"></script><script type="text/javascript" src="/content/scripts/GetAnchorText.js"></script><script type="text/javascript">
    
      $(function() {
      $("table.tgroup tfoot th").attr("colspan", "100");
      $("table.tgroup.rtable").each( function (idx, el) {
      var tw = $(this).width();
      $(this).parent().css("min-width", tw+"px");
      });

      });
      
    </script><!--6_2_1--></head><body class="oxy-ui pubs-ui ahtml-page"><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-56FZ7G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--><div class="viewport autopad"><div class="pnl pnl--drop autopad"><span id="top"/><div id="wrapper"><div class="left_head"><a class="simple" href="/"><img class="rsc-logo" border="0" src="/content/NewImages/royal-society-of-chemistry-logo.png" alt="Royal Society of Chemistry"/></a><br/><span class="btnContainer"><a class="btn btn--tiny btn--primary" target="_blank" title="Link to PDF version" href="/en/content/articlepdf/2022/se/d2se00556e">ViewPDFVersion</a></span><span class="btnContainer"><a class="btn btn--tiny btn--nobg" title="Link to previous article (id:d2se00802e)" href="/en/content/articlehtml/2022/se/d2se00802e" target="_BLANK">PreviousArticle</a></span><span class="btnContainer"><a class="btn btn--tiny btn--nobg" title="Link to next article (id:d2se00561a)" href="/en/content/articlehtml/2022/se/d2se00561a" target="_BLANK">NextArticle</a></span></div><div class="right_head"><div id="crossmark_container"><div id="crossmark-content"><a id="open-crossmark" href="#" data-target="crossmark"><img style="max-width:100px" id="crossmark-logo" src="https://crossmark-cdn.crossref.org/widget/v2.0/logos/CROSSMARK_Color_square.svg" alt="Check for updates"/></a><script src="https://crossmark-cdn.crossref.org/widget/v2.0/widget.js"></script></div></div></div><div class="article_info"> DOI:<a target="_blank" title="Link to landing page via DOI" href="https://doi.org/10.1039/D2SE00556E">10.1039/D2SE00556E</a>
(Paper)
<span class="italic"><a title="Link to journal home page" href="https://doi.org/10.1039/2398-4902/2017">Sustainable Energy Fuels</a></span>, 2022, <strong>6</strong>, 4048-4061</div><h1 id="sect196"><span class="title_heading">A bi-cyclic co-optimization method for sizing of electricity-hydrogen hybrid energy storage microgrid</span></h1><p class="header_text">
      <span class="bold">
        
          
            Ying 
            Han
          
        
      </span><sup><span class="sup_ref italic">a</span></sup>, 
      <span class="bold">
        
          
            Luoyi 
            Li
          
        
      </span><span class="orcid"><a target="_blank" title="Select to open ORCID record for LuoyiLi (orcid.org/0000-0002-0769-1225) in a new window" id="connect-orcid-link" href="http://orcid.org/0000-0002-0769-1225"><img id="orcid-id-logo" src="/content/NewImages/orcid_16x16.png" alt="ORCID logo"/></a></span>*<sup><span class="sup_ref italic">a</span></sup>, 
      <span class="bold">
        
          
            Weirong 
            Chen
          
        
      </span><sup><span class="sup_ref italic">a</span></sup>, 
      <span class="bold">
        
          
            Yujing 
            Hou
          
        
      </span><sup><span class="sup_ref italic">a</span></sup><span class="bold"> and </span>
      <span class="bold">
        
          
            Jiefu 
            Zhang
          
        
      </span><sup><span class="sup_ref italic">b</span></sup>
      <br/><a id="affa"><sup><span class="sup_ref italic">a</span></sup></a><span class="italic">School of Electrical Engineering, Southwest Jiaotong University, Chengdu 611756, China. E-mail: <a href="mailto:lly_liluoyi@163.com">lly_liluoyi@163.com</a></span>
      <br/><a id="affb"><sup><span class="sup_ref italic">b</span></sup></a><span class="italic">Measurement Center of State Grid Sichuan Power Company, Chengdu 610000, China</span>
    </p><div id="art-admin"><span class="italic bold">Received 
      21st April 2022
    </span><span class="bold italic">, Accepted 22nd July 2022</span></div><p class="bold italic">First published on 22nd July 2022</p><hr/><div class="abstract"><h2>Abstract</h2><p>An AC/DC microgrid (MG) integrating renewable energy sources and an electric-hydrogen hybrid energy storage system (HESS) can play a vital role in the future low-carbon society. Due to the nonlinear and strong coupling relationships between the sizing parameters of the microgrid components and the operation strategy parameters, research on these two problems in a coupled manner for an electricity-hydrogen hybrid energy storage microgrid is essential. This paper proposes a bi-cyclic co-optimization method for optimally sizing the microgrid components cost-effectively. Based on the proposed co-optimization framework, a MILP-based scheduling algorithm works as an inner optimization cycle to determine the best operational scheduling, and a PSO-based sizing algorithm works as an outer optimization cycle to search for the best size of each component. Finally, we discuss the characteristics of the demand response and the superiority of the proposed method over a rule-based operating strategy. In addition, a 1 h rolling horizon simulation and technical evaluation metrics are used to illustrate the validity of the sizing results.</p></div><hr/>
    
      
      <h2 id="sect245"><span class="a_heading">1 Introduction</span></h2>
      <span>To limit fuel reduction and the environmental crisis, renewable energy sources (RESs), such as photovoltaic panels (PVs) and wind turbines (WTs), are being more and more commonly used to generate electricity.<a title="Select to navigate to references" href="#cit1"><sup><span class="sup_ref">1</span></sup></a> However, the highly stochastic nature and intermittency of RESs would cause power fluctuations, requiring combination with energy storage systems for stable power support. Energy storage systems (ESSs) are diverse.<a title="Select to navigate to references" href="#cit2"><sup><span class="sup_ref">2</span></sup></a> A battery storage system is more suitable for short-term storage due to its low energy density and high self-discharge rate.<a title="Select to navigate to references" href="#cit3"><sup><span class="sup_ref">3</span></sup></a> While hydrogen storage systems, with the easy storage characteristics of hydrogen, are used for long-term energy storage, such as seasonal energy storage. Ref. <a title="Select to navigate to references" href="#cit4">4</a> compares the operational performance of hydrogen energy systems with that of electric energy storage systems in long-term operation. Therefore, a hybrid energy storage system (HESS) combining the former has complementary characteristics and is considered a promising solution.<a title="Select to navigate to reference" href="#cit5"><sup><span class="sup_ref">5,6</span></sup></a></span>
      <p class="otherpara">Microgrids are effective means to achieving large-scale integration of RESs and ESSs. Hybrid AC/DC microgrids are attracting attention as future distribution systems due to the merged advantages of both AC and DC microgrids.<a title="Select to navigate to references" href="#cit7"><sup><span class="sup_ref">7</span></sup></a> The AC sub-grid provides a connection between a hybrid microgrid and the utility, enabling power support in grid-connected modes. The coexistence of a DC sub-grid helps to significantly improve overall efficiency by reducing power conversion loss when interconnected with DC sources and loads. These components have different costs and characteristics, so proper sizing is vital to ensure a reliable and cost-effective power supply.<a title="Select to navigate to references" href="#cit8"><sup><span class="sup_ref">8</span></sup></a></p>
      <p class="otherpara">In this work, we focus on optimal sizing to ensure adequate supply at minimum cost. Costs are divided into O&amp;M costs, capital costs, fuel costs, purchase costs, replacement costs, and emission penalties for different sizes of techno-economic analysis.<a title="Select to navigate to references" href="#cit9"><sup><span class="sup_ref">9</span></sup></a> In addition to these multiple costs, power loss rates, energy autonomy, and other technical indicators can provide further economic recommendations for sizing.<a title="Select to navigate to references" href="#cit10"><sup><span class="sup_ref">10</span></sup></a> For the solution of this optimal sizing problem, various objectives and approaches have been presented in ref. <a title="Select to navigate to references" href="#cit11">11</a>. The study in ref. <a title="Select to navigate to references" href="#cit12">12</a> introduced a two-objective two-level problem, finding the optimum planning of parallel interlinking converters to minimize the annualized investment cost and reliability index costs. Similarly, etinbas <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit13"><sup><span class="sup_ref">13</span></sup></a> presented the Harris Hawks Optimization algorithm to optimize and design the size of an AC microgrid. Furthermore, Hamed <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit14"><sup><span class="sup_ref">14</span></sup></a> integrated the power supply probability, total energy lost, and other values as a cost object function for the optimal sizing of hybrid renewable energy systems. At system level, four energy storage system (ESS) configuration scenarios have been simulated.<a title="Select to navigate to references" href="#cit15"><sup><span class="sup_ref">15</span></sup></a></p>
      <p class="otherpara">It is not difficult to see that the above articles usually consider simple rule-based scheduling strategies when calculating size optimization: when there is surplus power, the excess energy is stored in the ESS, and when there is a shortage of power, the ESS discharges, or controllable generators are turned on. However, the economics of microgrid design entail two crucial aspects: optimal capacity sizing and optimal scheduling.<a title="Select to navigate to references" href="#cit16"><sup><span class="sup_ref">16</span></sup></a> And these segregated sizing strategies often lead to sub-optimality in the overall systems, such as undercapacity or overcapacity sizing of the system components, and high operation costs. This sub-optimality tends to emanate from the failure of long-timescale sizing models to meet the practical conditions of short-timescale scheduling.<a title="Select to navigate to references" href="#cit17"><sup><span class="sup_ref">17</span></sup></a> Specifically, the capacity scheme determines reliability and dispatch flexibility. On the other hand, an optimal operation strategy matches renewable generation and load demand, reducing unnecessary expenditure on capacity investment.</p>
      <p class="otherpara">Hence, there is a growing body of literature that recognizes that the combination of sizing and scheduling is essential. Rmy <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit18"><sup><span class="sup_ref">18</span></sup></a> studied the relationship between sizing and operation optimization and then presented possible optimization frameworks for microgrids. Generally, the dispatch optimization is solved in an inner loop, considering operation costs, while the sizing optimization is solved at an upper level to minimize the life cycle cost. A combined sizing and energy management methodology is formulated as a leaderfollower problem, solving the follower's energy management problem under the optimal size, <span class="italic">i.e.</span>, the leader's results.<a title="Select to navigate to references" href="#cit19"><sup><span class="sup_ref">19</span></sup></a> Siddharth <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit20"><sup><span class="sup_ref">20</span></sup></a> treated sizing and scheduling as nested optimization.<a title="Select to navigate to reference" href="#cit1"><sup><span class="sup_ref">1,17,21</span></sup></a> Develop co-optimization approaches to sequentially solve the sizing and operation problem for a high renewable standalone microgrid. Nevertheless, these works address stand-alone microgrids, but ignore the optimal sizing under grid-connected conditions. That is to say, the impact of incentives given by time-of-use tariffs on optimal sizing is not investigated in the literature.<a title="Select to navigate to reference" href="#cit22"><sup><span class="sup_ref">22,23</span></sup></a> Soumya <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit10"><sup><span class="sup_ref">10</span></sup></a> designed the optimal size of a PV/battery microgrid while considering the feed-in tariff incentive, but the composition was simple. In particular, Eriksson <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit24"><sup><span class="sup_ref">24</span></sup></a> summarized solutions concerning the sizing of fuel cell systems when adding them to an HESS.</p>
      <p class="otherpara">In an electricity-hydrogen hybrid energy storage microgrid, the integration of electricity-hydrogen HESSs increases the system complexity and flexibility. However, the co-optimization of diverse and multiple timescales for an electricity-hydrogen hybrid energy storage microgrid and the incentive of time-of-use tariffs will greatly increase the complexity of the optimal sizing problem. This paper focuses on the optimal sizing of a grid-connected electricity-hydrogen hybrid energy storage microgrid consisting of WT, PV, HESS, and electronics converters. A bi-cyclic co-optimization method is proposed to decompose the optimal sizing problem into bi-cyclic optimization problems. Based on the proposed co-optimization framework, a MILP-based scheduling algorithm works as an inner optimization cycle to determine the best operational scheduling, and a PSO-based sizing algorithm works as an outer optimization cycle to search for the best size for each component. Finally, the results are compared with a rule-based strategy commonly used in the literature, to further evaluate the performance of the proposed method.</p>
      <p class="otherpara">The remainder of this paper has the following structure. The structure of the electricity-hydrogen hybrid energy storage microgrid with demand response is presented in Sections 2 and 3 provides the bi-cyclic co-optimization method; the optimization results and analysis are described in Section 4; finally, the main conclusions are discussed in Section 5.</p>
    
    
      
      <h2 id="sect285"><span class="a_heading">2 Structure of the hybrid electric-hydrogen AC/DC microgrid</span></h2>
      <span>The proposed system configuration of the electricity-hydrogen hybrid energy storage microgrid comprises PV, WT, battery (BAT), hydrogen energy system, AC/DC loads and electronic converters, as shown in <a title="Select to navigate to figure" href="#imgfig1">Fig. 1</a>. To maximize the consumption of renewable energy, the PV and WT are given priority to supply the load. When they cannot meet the load demand, the battery and fuel cell systems operate to maintain the balance of supply and demand. When the PV and WT generate more power than the load, the excess power can not only charge the battery, but also drive the electrolyzer to produce hydrogen and store it in the hydrogen storage tank as long-term backup energy. The ACDC bidirectional power converter (BPC) is designed to ensure that power can flow in both directions between the AC and DC sub-grids. Demand response (DR) is considered on the load side, minimizing the mismatch between renewable energy output and load. This reduces the configuration of energy storage systems, saves investment costs and improves the economics.</span>
      <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig1"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f1.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f1.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 1 </b> <span id="fig1"><span class="graphic_title">Topology of electricity-hydrogen hybrid energy storage microgrid.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
      
        
        <h3 id="sect292"><span class="b_heading">2.1 Modelling of the PV system</span></h3>
        <span>The power output of the PV is related to the installed capacity, ambient temperature, and irradiance, which can be expressed as follows:<a title="Select to navigate to references" href="#cit25"><sup><span class="sup_ref">25</span></sup></a><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn1"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t1.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t1.gif"/></a></td><td class="rightEqn">(1)</td></tr></table>where <span class="italic">P</span><small><sub>pv</sub></small>(<span class="italic">t</span>) is the output power of PV at time <span class="italic">t</span>; <span class="italic">R</span><small><sub>pv</sub></small> is the rated power of PV; <span class="italic">I</span><small><sub>irr</sub></small>(<span class="italic">t</span>) is the irradiance at time <span class="italic">t</span>; <span class="italic">I</span><small><sub>std</sub></small> is the standard temperature of PV; <span class="italic"></span><small><sub>T</sub></small> is the temperature coefficient which is equal to 3.7  10<small><sup>3</sup></small>/C; <span class="italic">T</span>(<span class="italic">t</span>) is the ambient temperature; <span class="italic">T</span><small><sub>std</sub></small> is the standard temperature of PV; and <span class="italic"></span><small><sup>PV</sup></small><small><sub>dcdc</sub></small> is the efficiency of the converter.</span>
      
      
        
        <h3 id="sect323"><span class="b_heading">2.2 Modelling of the WT system</span></h3>
        <span>The output power of the WT is calculated as follows, affected by the wind speed.<a title="Select to navigate to references" href="#cit26"><sup><span class="sup_ref">26</span></sup></a><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn2"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t2_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t2.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t2.gif"/></a></td><td class="rightEqn">(2)</td></tr></table>where <span class="italic">v</span>(<span class="italic">t</span>) is the wind speed at time <span class="italic">t</span>; <span class="italic">v</span><small><sub>cin</sub></small> is the cut-in speed of WT; <span class="italic">v</span><small><sub>r</sub></small> is the rating speed of WT; and <span class="italic">v</span><small><sub>cout</sub></small> is the cut-out speed.</span>
      
      
        
        <h3 id="sect340"><span class="b_heading">2.3 Modelling of the BAT system</span></h3>
        <span>The battery system operating characteristics are described by capacity, charging and discharging power and efficiency:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn3"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t3_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t3.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t3.gif"/></a></td><td class="rightEqn">(3)</td></tr></table>where <span class="italic">E</span><small><sub>bat</sub></small>(<span class="italic">t</span>) is the stored energy at time <span class="italic">t</span>; <span class="italic">E</span><small><sub>bat</sub></small>(<span class="italic">t</span>  1)is the stored energy at time <span class="italic">t</span>  1; <span class="italic"></span> is the self-discharge factor; <span class="italic">t</span> is the time interval between <span class="italic">t</span>  1 and <span class="italic">t</span>; <span class="italic">P</span><small><sub>bat</sub></small>(<span class="italic">t</span>) is the power (positive for discharging and negative for charging); <span class="italic"></span><small><sub>ch</sub></small> and <span class="italic"></span><small><sub>dch</sub></small> are the charging and discharging efficiency, respectively; <span class="italic"></span><small><sub>dch</sub></small> is the efficiency of the converter; SOC(<span class="italic">t</span>) is the state of charge of the BAT; and <span class="italic">E</span><small><sub>bat_max</sub></small> is the capacity of the BAT in kW h.</span>
      
      
        
        <h3 id="sect371"><span class="b_heading">2.4 Modelling of the hydrogen storage system</span></h3>
        <div>
          
          <span id="sect374"/><span class="c_heading_indent">2.4.1 Modeling of the fuel cell. </span>
          <span>Fuel cells consume H<small><sub>2</sub></small> and oxygen to produce electricity and water.<a title="Select to navigate to references" href="#cit27"><sup><span class="sup_ref">27</span></sup></a> A simple electrical model is used to describe the characteristic voltage curve of the FC:<a title="Select to navigate to references" href="#cit28"><sup><span class="sup_ref">28</span></sup></a><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn4"/><span id="eqn4"><span class="italic">V</span><small><sub>fc_cell</sub></small> = <span class="italic">E</span><small><sub>oc</sub></small>  <span class="italic">V</span><small><sub>act_fc</sub></small>  <span class="italic">V</span><small><sub>ohm_fc</sub></small>  <span class="italic">V</span><small><sub>con_fc</sub></small></span></td><td class="rightEqn">(4)</td></tr></table>where <span class="italic">V</span><small><sub>fc_cell</sub></small> is the cell voltage; <span class="italic">E</span><small><sub>oc</sub></small> denotes the thermodynamic electromotive force; <span class="italic">V</span><small><sub>act_fc</sub></small> is the activation overvoltage; <span class="italic">V</span><small><sub>ohm_fc</sub></small> is the ohmic overvoltage; and <span class="italic">V</span><small><sub>con_fc</sub></small> is the concentration overvoltage.</span>
          <p class="otherpara">The efficiency can be written as:<a title="Select to navigate to references" href="#cit6"><sup><span class="sup_ref">6</span></sup></a><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn5"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t4_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t4.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t4.gif"/></a></td><td class="rightEqn">(5)</td></tr></table>where <span class="italic"></span><small><sub>fc</sub></small> and <span class="italic"></span><small><sub>stack</sub></small> are the system electrical efficiency and stack efficiency, respectively; <span class="italic">E</span><small><sub>fc</sub></small> is the electrical efficiency; <span class="italic"></span><small><sub>f</sub></small> represents the hydrogen utilization rate; <span class="italic">V</span><small><sub>fc_cell</sub></small> stands for the output voltage of the stack; <span class="italic">I</span><small><sub>fc</sub></small> is the cell output current; <span class="italic">H</span><small><sub>LHV</sub></small> is known as the lower heating value; and <span class="italic">P</span><small><sub>stack</sub></small> and <span class="italic">P</span><small><sub>aux</sub></small> denote the power of the fuel cell stack and auxiliary system, respectively.</p>
        </div>
        <div>
          
          <span id="sect427"/><span class="c_heading_indent">2.4.2 Modelling of the electrolyzer. </span>
          <span>Electrolyzers are used to produce hydrogen (H<small><sub>2</sub></small>) from electricity. The cell voltage in a PEM electrolyzer cell can be expressed as the sum of the reversible potential and its over-potentials:<a title="Select to navigate to references" href="#cit29"><sup><span class="sup_ref">29</span></sup></a><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn6"/><span id="eqn6"><span class="italic">V</span><small><sub>el_cell</sub></small> = <span class="italic">V</span><small><sub>ref_el</sub></small> + <span class="italic"></span><small><sub>act_el</sub></small> + <span class="italic"></span><small><sub>ohm_el</sub></small> + <span class="italic"></span><small><sub>con_el</sub></small></span></td><td class="rightEqn">(6)</td></tr></table>where <span class="italic">V</span><small><sub>rev_el</sub></small> is the reversible potential; <span class="italic"></span><small><sub>act_el</sub></small>, <span class="italic"></span><small><sub>ohm_el</sub></small>, and <span class="italic"></span><small><sub>con_el</sub></small> are the activation, ohmic and concentration over-potentials.</span>
          <p class="otherpara">The production rate of hydrogen by the electrolyzer is then given by Faraday's law:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn7"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t5_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t5.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t5.gif"/></a></td><td class="rightEqn">(7)</td></tr></table>where <span class="italic"></span><small><sub>el</sub></small> is the electrical efficiency; <span class="italic">N</span><small><sub>el</sub></small> is the number of cells; <span class="italic">i</span><small><sub>el</sub></small> denotes the current; and <span class="italic">F</span> is the Faraday constant.<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn8"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t6_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t6.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t6.gif"/></a></td><td class="rightEqn">(8)</td></tr></table>where <span class="italic">V</span><small><sub>H</sub></small> denotes the thermo-neutral potential and <span class="italic">v</span><small><sub>el</sub></small> is the cell voltage.</p>
        </div>
        <div>
          
          <span id="sect472"/><span class="c_heading_indent">2.4.3 Modelling of the hydrogen storage tank. </span>
          <span>Similar to the battery, the modelling of the hydrogen storage tank can be expressed as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn9"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t7_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t7.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t7.gif"/></a></td><td class="rightEqn">(9)</td></tr></table>where <span class="italic">E</span><small><sub>tank</sub></small>(<span class="italic">t</span>) is the stored energy at time <span class="italic">t</span>; <span class="italic">P</span><small><sub>el</sub></small>(<span class="italic">t</span>  1) and <span class="italic">P</span><small><sub>fc</sub></small>(<span class="italic">t</span>  1) are the charge power of the electrolyzer and the discharge power of the fuel cell at time (<span class="italic">t</span>  1); <span class="italic"></span><small><sub>el</sub></small>, <span class="italic"></span><small><sub>fc</sub></small> and <span class="italic"></span><small><sub>tank</sub></small> are the working conversion efficiency of the electrolyzer, fuel cell and hydrogen storage tank, respectively; dcdc<small><sup>el</sup></small> and dcdc<small><sup>fc</sup></small> are the efficiencies of the converter of the electrolyzer and fuel cell; SOHC is the storage of hydrogen charge; and <span class="italic">E</span><small><sub>tank_max</sub></small> is the maximum capacity.</span>
          <p class="otherpara">In previous work, we modeled the fuel cell and electrolyzer in detail, with parameters referenced to ref. <a title="Select to navigate to references" href="#cit6">6</a>.</p>
        </div>
      
      
        
        <h3 id="sect502"><span class="b_heading">2.5 Modelling of demand response</span></h3>
        <span>Demand response aims to motivate and influence electricity consumer to reshape their energy demand in response to attractive benefits offered by the utilities.<a title="Select to navigate to references" href="#cit30"><sup><span class="sup_ref">30</span></sup></a> There are two types of demand response programs: price-based DR and incentive-based DR. Considering that the stochasticity and volatility of the RESs will exist all the time, the incentive-based DR strategy is used in this paper for DR modeling. It should be emphasized that only part of the loads can be shifted to track the renewable energy output, whereas total consumed energy over the planning horizon is fixed.<a title="Select to navigate to references" href="#cit31"><sup><span class="sup_ref">31</span></sup></a> The participation of incentive-based DR will maximize the direct consumption of renewable energy generation and reduce the configuration of energy storage systems, thus saving investment costs and improving the economics. The corresponding optimization problem is formulated as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn10"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t8_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t8.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t8.gif"/></a></td><td class="rightEqn">(10)</td></tr></table>subject to<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn11"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t9_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t9.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t9.gif"/></a></td><td class="rightEqn">(11)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn12"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t10_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t10.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t10.gif"/></a></td><td class="rightEqn">(12)</td></tr></table>where <span class="italic">T</span> is the scheduling cycle (24 h); <span class="italic">P</span><small><sub>DG</sub></small>(<span class="italic">t</span>) is the output power of the RES at time <span class="italic">t</span>; <span class="italic">L</span><small><sub>dr</sub></small>(<span class="italic">t</span>) and <span class="italic">L</span><small><sub>load</sub></small>(<span class="italic">t</span>) denote the load before and after DR at time <span class="italic">t</span>, respectively; <span class="italic">L</span><small><sub>dr_in</sub></small>(<span class="italic">t</span>) and <span class="italic">L</span><small><sub>dr_out</sub></small>(<span class="italic">t</span>) are the load transferred in and out at time <span class="italic">t</span>, respectively; <span class="italic">m</span><small><sub>dr</sub></small>(<span class="italic">t</span>) and <span class="italic">M</span><small><sub>dr</sub></small> refer to the actual load transfer at time <span class="italic">t</span> and maximum load transferable capacity.<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn13"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-u1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-u1.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-u1.gif"/></a></td><td class="rightEqn">(13)</td></tr></table></span>
      
    
    
      
      <h2 id="sect545"><span class="a_heading">3 Bi-cyclic co-optimization method</span></h2>
      <span>The optimal sizing in this paper aims to achieve economic sizing and operation, that is, minimize the equivalent total cost (ETC) of the microgrid. The optimization problem is divided into two objectives: optimal sizing and optimal scheduling. Moreover, the latter is nested in the former (<a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a>) and uses the bi-cyclic co-optimization method to solve the nested optimization problem.</span>
      <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig2"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f2_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f2.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f2.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 2 </b> <span id="fig2"><span class="graphic_title">Schematic diagram of the proposed framework.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
      <p class="otherpara">The bi-cyclic co-optimization method aims to find the optimal size results that satisfy both the optimal operational scheduling and the minimum ETC. The outer cycle takes minimizing ETC as the optimization objective to obtain the optimal size of each system; the inner cycle takes minimizing the daily operation cost to obtain the optimal scheduling plan for one day. First, the potential size schemes (outer cycle) are determined; then the capacity information is input into the inner cycle to operate scheduling optimization. Second, calculation is undertaken to obtain the operating schedule and operating cost of multiple devices for each period, and they are returned to the outer cycle. Then, iterative operations are performed, to continuously update the optimization results and finally obtain the optimal capacity.</p>
      
        
        <h3 id="sect553"><span class="b_heading">3.1 Optimal objective of sizing</span></h3>
        <span>The main objective is to minimize the equivalent total cost (ETC) over the project duration, which considers equivalent annual value of the investment, replacement and operating costs:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn14"/><span id="eqn14">min<span class="italic">C</span><small><sub>ETC</sub></small> = (<span class="italic">C</span><small><sub>IV_ETC</sub></small> + <span class="italic">C</span><small><sub>RP_ETC</sub></small> + <span class="italic">C</span><small><sub>RU_ETC</sub></small>)  <span class="italic">C</span><small><sub>RF</sub></small>(<span class="italic">r</span>,<span class="italic">Y</span>)</span></td><td class="rightEqn">(14)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn15"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t11_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t11.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t11.gif"/></a></td><td class="rightEqn">(15)</td></tr></table>where <span class="italic">C</span><small><sub>ETC</sub></small> represents equivalent annual value of the total cost of the microgrid; <span class="italic">C</span><small><sub>IV_TEC</sub></small> represents the total investment cost; <span class="italic">C</span><small><sub>RP_TEC</sub></small> represents the total replacement cost; <span class="italic">C</span><small><sub>RU_TEC</sub></small> represents the total operating cost; <span class="italic">r</span> is the discount rate; and <span class="italic">Y</span> is the lifetime of the project.</span>
        <p class="otherpara">The total investment cost is shown as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn16"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t12_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t12.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t12.gif"/></a></td><td class="rightEqn">(16)</td></tr></table>where <span class="italic">C</span><small><sub>inv_pv</sub></small>, <span class="italic">C</span><small><sub>inv_wt</sub></small>, <span class="italic">C</span><small><sub>inv_bat</sub></small>, <span class="italic">C</span><small><sub>inv_fc</sub></small>, <span class="italic">C</span><small><sub>inv_el</sub></small>, <span class="italic">C</span><small><sub>inv_hst</sub></small>, <span class="italic">C</span><small><sub>inv_acdc</sub></small> are the investment costs of PV, WT, BAT, FC, EL, HST and BPC, respectively. <span class="italic">N</span><small><sub>pv</sub></small>, <span class="italic">N</span><small><sub>wt</sub></small>, <span class="italic">N</span><small><sub>bat</sub></small>, <span class="italic">N</span><small><sub>fc</sub></small>, <span class="italic">N</span><small><sub>el</sub></small>, <span class="italic">N</span><small><sub>hst</sub></small>, and <span class="italic">N</span><small><sub>acdc</sub></small> are the numbers of each system.</p>
        <p class="otherpara">The total replacement cost is shown as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn17"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t13_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t13.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t13.gif"/></a></td><td class="rightEqn">(17)</td></tr></table>where <span class="italic">Y</span><small><sub><span class="italic">s</span></sub></small> denotes the lifetime of the system.</p>
        <p class="otherpara">The total operating cost is shown as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn18"/><span id="eqn18"><span class="italic">C</span><small><sub>RU_ETC</sub></small> = <span class="italic">C</span><small><sub>om_ETC</sub></small> + <span class="italic">C</span><small><sub>gc_ETC</sub></small> + <span class="italic">C</span><small><sub>ad_ETC</sub></small> + <span class="italic">C</span><small><sub>dr_ETC</sub></small></span></td><td class="rightEqn">(18)</td></tr></table>with<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn19"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t14_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t14.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t14.gif"/></a></td><td class="rightEqn">(19)</td></tr></table>where <span class="italic">C</span><small><sub>om_TEC</sub></small> represents the O&amp;M cost; <span class="italic">C</span><small><sub>gc_TEC</sub></small> represents the trading tariffs between the microgrid and the grid; <span class="italic">C</span><small><sub>ad_TEC</sub></small> is the power conversion cost between AC and DC; <span class="italic">C</span><small><sub>dr_TEC</sub></small> denotes the subsidy cost of DR; <span class="italic">P</span><small><sub>pv</sub></small>(<span class="italic">t</span>), <span class="italic">P</span><small><sub>wt</sub></small>(<span class="italic">t</span>), <span class="italic">P</span><small><sub>bat</sub></small>(<span class="italic">t</span>), <span class="italic">P</span><small><sub>fc</sub></small>(<span class="italic">t</span>), <span class="italic">P</span><small><sub>el</sub></small>(<span class="italic">t</span>) and <span class="italic">P</span><small><sub>acdc</sub></small>(<span class="italic">t</span>) are the power of PV, WT, battery, fuel cell, electrolyzer and bidirectional power converter at time <span class="italic">t</span>; <span class="italic"></span><small><sub>pv</sub></small>, <span class="italic"></span><small><sub>wt</sub></small>, <span class="italic"></span><small><sub>bat</sub></small>, <span class="italic"></span><small><sub>fc</sub></small>, <span class="italic"></span><small><sub>el</sub></small>, and <span class="italic"></span><small><sub>ad</sub></small> are the O&amp;M coefficients of PV, WT, battery, fuel cell, electrolyzer and bidirectional power converter; <span class="italic">k</span><small><sub>bu</sub></small>(<span class="italic">t</span>) and <span class="italic">k</span><small><sub>se</sub></small>(<span class="italic">t</span>) are the buying and selling electricity prices; <span class="italic">P</span><small><sub>g</sub></small>(<span class="italic">t</span>) is the exchange power between the microgrid and the grid; <span class="italic">R</span><small><sub>mg</sub></small>(<span class="italic">t</span>) refers to the unit power generation cost at time <span class="italic">t</span>; <span class="italic"></span><small><sub>acdc</sub></small> is the efficiency of the bidirectional power converter; and <span class="italic">k</span><small><sub>dr</sub></small> is the subsidy factor for DR.</p>
      
      
        
        <h3 id="sect697"><span class="b_heading">3.2 Optimal objective of scheduling</span></h3>
        <span>Consider designing the scheduling scheme with the optimization goal of minimizing the one-day operating cost:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn20"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t15_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t15.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t15.gif"/></a></td><td class="rightEqn">(20)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn21"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t16_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t16.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t16.gif"/></a></td><td class="rightEqn">(21)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn22"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t17_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t17.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t17.gif"/></a></td><td class="rightEqn">(22)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn23"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t18_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t18.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t18.gif"/></a></td><td class="rightEqn">(23)</td></tr></table><table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn24"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t19_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t19.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t19.gif"/></a></td><td class="rightEqn">(24)</td></tr></table></span>
      
      
        
        <h3 id="sect716"><span class="b_heading">3.3 Constraints</span></h3>
        <div>
          
          <span id="sect719"/><span class="c_heading_indent">3.3.1 Capacity constraints. </span>
          <span>
            <table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn25"/>
              
              <span id="eqn25">
                <span class="italic">u<small><sub>s</sub></small>N</span>
                <small><sub>
                  <span class="italic">s</span>,min</sub></small>  <span class="italic">u</span><small><sub><span class="italic">s</span></sub></small><span class="italic">N</span><small><sub><span class="italic">s</span></sub></small>  <span class="italic">u</span><small><sub><span class="italic">s</span></sub></small><span class="italic">N</span><small><sub><span class="italic">s</span>,max</sub></small>, <span class="italic">s</span>  PV, WT, BAT, FC, EL, HST, BPC</span>
            </td><td class="rightEqn">(25)</td></tr></table>where <span class="italic">s</span> denotes the system components, which are PV, WT, battery, fuel cell, electrolyzer, hydrogen storage tank and bidirectional power converter; <span class="italic">N</span><small><sub><span class="italic">s</span></sub></small> is the actual number; <span class="italic">u</span><small><sub><span class="italic">s</span></sub></small> is the rated power of each system; <span class="italic">u</span><small><sub><span class="italic">s</span></sub></small><span class="italic">N</span><small><sub><span class="italic">s</span>,min</sub></small> represents the lower limit of the capacity of the <span class="italic">s</span>-th system, which is taken to be 0; <span class="italic">u</span><small><sub><span class="italic">s</span></sub></small><span class="italic">N</span><small><sub><span class="italic">s</span>,max</sub></small> represents the upper limit of the capacity of the <span class="italic">s</span>-th system.</span>
        </div>
        <div>
          
          <span id="sect764"/><span class="c_heading_indent">3.3.2 Power balance constraints. </span>
          <span>The total power generated by WT, PV, battery, hydrogen energy system and grid should always meet the load demand for all considered scenarios:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn26"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t20_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t20.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t20.gif"/></a></td><td class="rightEqn">(26)</td></tr></table>where <span class="italic">L</span><small><sub>dr_dc</sub></small> and <span class="italic">L</span><small><sub>dr_ac</sub></small> are the DC and AC side load power after DR, respectively.</span>
        </div>
        <div>
          
          <span id="sect775"/><span class="c_heading_indent">3.3.3 Renewable energy systems constraints. </span>
          <span>Since PV and WT cannot exceed their maximum output power in the actual operation process, the constraints are as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn27"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t21_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t21.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t21.gif"/></a></td><td class="rightEqn">(27)</td></tr></table>where <span class="italic">u</span><small><sub>PV</sub></small> and <span class="italic">u</span><small><sub>WT</sub></small> are the rated power.</span>
        </div>
        <div>
          
          <span id="sect786"/><span class="c_heading_indent">3.3.4 Battery system constraints. </span>
          <span>Overcharging and discharging will affect the battery's life and increase the replacement cost, so SOC must be within the maximum and the minimum values, as must the power:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn28"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t22_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t22.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t22.gif"/></a></td><td class="rightEqn">(28)</td></tr></table>where SOC<small><sub>min</sub></small> and SOC<small><sub>max</sub></small> denote the minimum and maximum SOC; and <span class="italic">P</span><small><sub>mch</sub></small> and <span class="italic">P</span><small><sub>mdch</sub></small> are the maximum charging and discharging power.</span>
        </div>
        <div>
          
          <span id="sect799"/><span class="c_heading_indent">3.3.5 Hydrogen energy system constraints. </span>
          <span>Similar to the battery system, SOHC and the power are constrained:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn29"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t23_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t23.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t23.gif"/></a></td><td class="rightEqn">(29)</td></tr></table>where SOHC<small><sub>min</sub></small> and SOHC<small><sub>max</sub></small> denote the minimum and maximum SOHC; and <span class="italic">P</span><small><sub>elmax</sub></small> and <span class="italic">P</span><small><sub>fcmax</sub></small> are the maximum charging of the electrolyzer and maximum discharging power of the fuel cell.</span>
        </div>
        <div>
          
          <span id="sect812"/><span class="c_heading_indent">3.3.6 Exchange power constraints. </span>
          <span>Excessive commutation losses will harm the microgrid, so the power is bounded by the upper <span class="italic">P</span><small><sub>macdc</sub></small> limit:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn30"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t24_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t24.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t24.gif"/></a></td><td class="rightEqn">(30)</td></tr></table>where <span class="italic">u</span><small><sub>BPC</sub></small> is the rated power of each BPC.</span>
          <p class="otherpara">Moreover, too much power drawn from the main grid may be harmful, so a constraint is needed:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn31"/><span id="eqn31"><span class="italic">P</span><small><sub>gird</sub></small>(<span class="italic">t</span>)  <span class="italic">P</span><small><sub>smc</sub></small></span></td><td class="rightEqn">(31)</td></tr></table>where <span class="italic"></span> is the limit ratio, which in this paper takes the value of 0.5; and <span class="italic">P</span><small><sub>smc</sub></small> denotes the maximum system power, which in this paper takes the value of 1000.</p>
        </div>
      
      
        
        <h3 id="sect835"><span class="b_heading">3.4 Technical evaluation indicators</span></h3>
        <span>In order to analyze more effectively the results of the optimal configuration of the electric-hydrogen coupled ACDC microgrid, the following technical evaluation indicators are introduced: energy autonomy rate, electricity consumption satisfaction rate and customer satisfaction rate.</span>
        <div>
          
          <span id="sect839"/><span class="c_heading_indent">3.4.1 Energy autonomy rate. </span>
          <span>The energy autonomy rate (EAR) is a metric to measure the self-sufficiency or energy independence of the microgrid design. It is calculated as:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn32"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t25_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t25.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t25.gif"/></a></td><td class="rightEqn">(32)</td></tr></table>where <span class="italic">E</span><small><sub>grid_buy</sub></small> is energy bought from the grid; and <span class="italic">E</span><small><sub>load</sub></small> denotes the total load demand.</span>
        </div>
        <div>
          
          <span id="sect850"/><span class="c_heading_indent">3.4.2 Electricity consumption satisfaction rate. </span>
          <span>The electricity consumption satisfaction rate (ECSR) is a metric to characterize customer satisfaction with load shifting after the introduction of demand response:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn33"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t26_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t26.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t26.gif"/></a></td><td class="rightEqn">(33)</td></tr></table>where <span class="italic">E</span><small><sub>shift</sub></small> is the amount of load shifted in a year.</span>
        </div>
        <div>
          
          <span id="sect859"/><span class="c_heading_indent">3.4.3 Customer satisfaction rate. </span>
          <span>ESR and ECSR are integrally evaluated in this study to illustrate the customer satisfaction rate (CSR) of the demand response-based microgrid design:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn34"/><span id="eqn34"><span class="italic">R</span><small><sub>CSR</sub></small> = <span class="italic">R</span><small><sub>EAR</sub></small> + <span class="italic">R</span><small><sub>ECSR</sub></small></span></td><td class="rightEqn">(34)</td></tr></table>where <span class="italic"></span> and <span class="italic"></span> are the evaluation factors. First of all, it should be clear that the values of <span class="italic"></span> and <span class="italic"></span>, as technical evaluation indicators, do not affect the size results for the microgrid. Customer satisfaction rate is a quantitative indicator used to objectively analyze the goodness of the size results. Since the energy autonomy rate and electricity consumption satisfaction rate are used to analyze the optimal size and optimal operation results in terms of reliability and satisfaction, respectively, this paper takes <span class="italic"></span> = <span class="italic"></span> = 0.5 to weight these two indicators in a fair way.</span>
        </div>
        <div>
          
          <span id="sect878"/><span class="c_heading_indent">3.4.4 Total conversion loss. </span>
          <span>A hybrid AC/DC microgrid contains an AC bus and a DC bus, connecting different types of loads and power sources, so there is power interaction between the DC bus and the AC bus. The BPC causes conversion loss when balancing microgrid power. The smaller the loss, the better the energy saving of the microgrid. The total conversion loss (TCL) is calculated as follows:<table><td class="leftEqn"></td><tr><td class="eqn"><span id="eqn35"/><a href="/image/article/2022/SE/d2se00556e/d2se00556e-t27_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-t27.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-t27.gif"/></a></td><td class="rightEqn">(35)</td></tr></table></span>
        </div>
      
      
        
        <h3 id="sect885"><span class="b_heading">3.5 Solution process</span></h3>
        <span>The MILP-based scheduling algorithm and the PSO-based sizing algorithm are combined to obtain the optimal sizing for the system. A set of capacities <span class="italic">N</span><small><sub><span class="italic">s</span></sub></small> = {<span class="italic">N</span><small><sub>PV</sub></small>, <span class="italic">N</span><small><sub>WT</sub></small>, <span class="italic">N</span><small><sub>bat</sub></small>, <span class="italic">N</span><small><sub>con</sub></small>, <span class="italic">N</span><small><sub>fc</sub></small>, <span class="italic">N</span><small><sub>tank</sub></small>, <span class="italic">N</span><small><sub>el</sub></small>} is selected in the outer cycle and held constant while solving the inner schedule problem. The IPSO terminates upon finding the optimal scheduling in the inner loop and transmits the optimal dispatch to the outer cycle. Then the outer cycle calculates the annual cost for the corresponding size combination and dispatch plans. Finally, the problem is repeated for a new set of sizes until the sizing problem termination condition is reached. The solving process is shown in <a title="Select to navigate to figure" href="#imgfig3">Fig. 3</a>:</span>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig3"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f3_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f3.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f3.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 3 </b> <span id="fig3"><span class="graphic_title">The flowchart for the bi-cyclic co-optimization framework.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">Step 1: Input solar radiation, wind speed data, AC and DC load data.</p>
        <p class="otherpara">Step 2: Initialize population B with a population size of 30 and the maximum iteration (<span class="italic">G</span><small><sup>max</sup></small> = 100).</p>
        <p class="otherpara">Step 3: Randomly generate sizing schemes <span class="italic">N</span><small><sub><span class="italic">s</span></sub></small> within the allowed range of sizing under the set population size.</p>
        <p class="otherpara">Step 4: Input the alternative sizing schemes of the populations into the inner cycle of the MILP to solve the scheduling problem (<a title="" href="#eqn20">eqn (20)</a>), obtaining daily optimal schedule and daily operating costs. If no solution is feasible, then a new candidate solution is generated.</p>
        <p class="otherpara">Step 4: Calculate the ETC (the PSO fitness function value) and compare it with the optimal result at the previous moment. If the result is better than one of these results, replace the results with the current calculation results and update the optimal result; if not, discard.</p>
        <p class="otherpara">Step 5: The process continues until the stopping criterion for the number of iterations is met.</p>
      
    
    
      
      <h2 id="sect921"><span class="a_heading">4 Case study</span></h2>
      <span>This paper compares the conventional rule-based approach<a title="Select to navigate to reference" href="#cit32"><sup><span class="sup_ref">32,33</span></sup></a> with the proposed method and analyzes the results, illustrating that the proposed framework can provide economic guidance for the system sizes.</span>
      
        
        <h3 id="sect926"><span class="b_heading">4.1 Case parameters</span></h3>
        <span>The solar radiation, wind speed and AC/DC load data in this paper are referenced from ref. <a title="Select to navigate to reference" href="#cit34">3436</a>, as shown in (<a title="Select to navigate to figure" href="#imgfig4">Fig. 4</a>). And the time-of-use tariffs are from ref. <a title="Select to navigate to references" href="#cit37">37</a> and <a title="Select to navigate to references" href="#cit38">38</a>, as shown in <a title="Select to navigate to table" href="#tab1">Tables 1</a> and <a title="Select to navigate to table" href="#tab2">2</a>.</span>
        
<div class="table_caption"><b>Table 1</b> <span id="tab1">System economic parameters</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/></colgroup>
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom">
                  </th>
                  <th align="left" valign="bottom" class="border_black">Parameters</th>
                  <th align="left" valign="bottom" class="border_black">Value</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td rowspan="3" valign="top">PV</td>
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_pv</sub></small> (/kW)</td>
                  <td align="char" char="." valign="top">8800</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>pv</sub></small> (year)</td>
                  <td align="char" char="." valign="top">20</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>pv</sub></small> (kW)</td>
                  <td align="char" char="." valign="top">1</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">WT</td>
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>wt</sub></small> (kW)</td>
                  <td align="char" char="." valign="top">10</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_wt</sub></small> (/kW)</td>
                  <td align="char" char="." valign="top">12<img class="charmap" src="https://www.rsc.org/images/entities/char_2009.gif" alt="[thin space (1/6-em)]"/>000</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>wt</sub></small> (year)</td>
                  <td align="char" char="." valign="top">20</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">BAT</td>
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_bat</sub></small> (/kW h)</td>
                  <td align="char" char="." valign="top">1000</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>bat</sub></small> (year)</td>
                  <td valign="top"></td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>bat</sub></small> (Ah)</td>
                  <td align="char" char="." valign="top">85</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">BPC</td>
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>BPC</sub></small> (kW)</td>
                  <td align="char" char="." valign="top">1</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_bpc</sub></small> (/kW)</td>
                  <td align="char" char="." valign="top">2000</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>bpc</sub></small> (year)</td>
                  <td align="char" char="." valign="top">10</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">FC</td>
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_fc</sub></small> (/kW)</td>
                  <td align="char" char="." valign="top">14<img class="charmap" src="https://www.rsc.org/images/entities/char_2009.gif" alt="[thin space (1/6-em)]"/>000</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>fc</sub></small> (year)</td>
                  <td align="char" char="." valign="top">10</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>FC</sub></small> (kW)</td>
                  <td align="char" char="." valign="top">1</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">HST</td>
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>HST</sub></small> (Nm<small><sup>3</sup></small>)</td>
                  <td align="char" char="." valign="top">1</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_hst</sub></small> (/Nm<small><sup>3</sup></small>)</td>
                  <td align="char" char="." valign="top">1800</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>hst</sub></small> (year)</td>
                  <td align="char" char="." valign="top">20</td>
                </tr>
                <tr align="left">
                  <td rowspan="3" valign="top">EL</td>
                  <td valign="top">
                    <span class="italic">u</span>
                    <small><sub>EL</sub></small> (kW)</td>
                  <td align="char" char="." valign="top">1</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">C</span>
                    <small><sub>inv_el</sub></small> (/kW)</td>
                  <td align="char" char="." valign="top">20<img class="charmap" src="https://www.rsc.org/images/entities/char_2009.gif" alt="[thin space (1/6-em)]"/>000</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">Y</span>
                    <small><sub>el</sub></small> (year)</td>
                  <td align="char" char="." valign="top">10</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        
<div class="table_caption"><b>Table 2</b> <span id="tab2">Time-of-use tariffs</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/></colgroup>
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Time period</th>
                  <th align="left" valign="bottom" class="border_black">Hours</th>
                  <th align="left" valign="bottom" class="border_black">Buying electricity price (<span class="italic">k</span><small><sub>bu</sub></small>)/ (kW h)<small><sup>1</sup></small></th>
                  <th align="left" valign="bottom" class="border_black">Selling electricity price (<span class="italic">k</span><small><sub>se</sub></small>)/ (kW h)<small><sup>1</sup></small></th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">Off-peak</td>
                  <td valign="top">00:0008:00</td>
                  <td align="char" char="." valign="top">0.37</td>
                  <td align="char" char="." valign="top">0.28</td>
                </tr>
                <tr align="left">
                  <td valign="top">Shoulder</td>
                  <td valign="top">08:0012:00, 17:0021:00</td>
                  <td align="char" char="." valign="top">0.87</td>
                  <td align="char" char="." valign="top">0.72</td>
                </tr>
                <tr align="left">
                  <td valign="top">Peak</td>
                  <td valign="top">12:0017:00, 21:0024:00</td>
                  <td align="char" char="." valign="top">0.69</td>
                  <td align="char" char="." valign="top">0.53</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        <p class="otherpara">The economic parameters are obtained from ref. <a title="Select to navigate to references" href="#cit1">1</a> (<a title="Select to navigate to table" href="#tab3">Table 3</a>).</p>
        
<div class="table_caption"><b>Table 3</b> <span id="tab3">Economic parameters</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/></colgroup>
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Parameters</th>
                  <th align="left" valign="bottom" class="border_black">Value</th>
                  <th align="left" valign="bottom" class="border_black">Parameters</th>
                  <th align="left" valign="bottom" class="border_black">Value</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>pv</sub></small>
                  </td>
                  <td valign="top">0.0096</td>
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>wt</sub></small>
                  </td>
                  <td align="char" char="." valign="top">0.0108</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>bat</sub></small>
                  </td>
                  <td valign="top">0.0275</td>
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>fc</sub></small>
                  </td>
                  <td align="char" char="." valign="top">0.07</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>el</sub></small>
                  </td>
                  <td valign="top">0.07</td>
                  <td valign="top">
                    <span class="italic"></span>
                    <small><sub>ad</sub></small>
                  </td>
                  <td align="char" char="." valign="top">0.058</td>
                </tr>
                <tr align="left">
                  <td valign="top">
                    <span class="italic">R</span>
                    <small><sub>mg</sub></small>
                  </td>
                  <td valign="top">
                    <span class="italic">k</span>
                    <small><sub>bu</sub></small>/<span class="italic">k</span><small><sub>se</sub></small></td>
                  <td valign="top">
                    <span class="italic">k</span>
                    <small><sub>dr</sub></small>
                  </td>
                  <td align="char" char="." valign="top">0.2</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
      
      
        
        <h3 id="sect1157"><span class="b_heading">4.2 Characteristics of HESS and DR</span></h3>
        <span>To discuss the importance/requirement for a HESS in energy systems and the superiority of DR mechanisms, we categorize whether to consider hydrogen storage system and whether to consider DR into three operational modes; see <a title="Select to navigate to table" href="#tab4">Table 4</a>.</span>
        
<div class="table_caption"><b>Table 4</b> <span id="tab4">Operational modes</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/></colgroup>
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Operation mode</th>
                  <th align="left" valign="bottom" class="border_black">Hydrogen storage system</th>
                  <th align="left" valign="bottom" class="border_black">DR</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">A</td>
                  <td valign="top"></td>
                  <td valign="top"></td>
                </tr>
                <tr align="left">
                  <td valign="top">B</td>
                  <td valign="top"></td>
                  <td valign="top"></td>
                </tr>
                <tr align="left">
                  <td valign="top">C</td>
                  <td valign="top"></td>
                  <td valign="top"></td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        <p class="otherpara">
          <a title="Select to navigate to table" href="#tab5">Tables 5</a> and <a title="Select to navigate to table" href="#tab6">6</a> show that the introduction of the hydrogen storage system significantly reduces the battery capacity, resulting in lower equivalent total cost (ETC) and lower total commutation loss. At the same time, it decreases the energy interaction with the grid and improves the energy autonomy rate (EAR) of the system while slightly increasing the customer satisfaction rate (CSR).</p>
        
<div class="table_caption"><b>Table 5</b> <span id="tab5">Sizing results in cases without and with DR</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/><col/><col/><col/><col/></colgroup>
              
              
              
              
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Case</th>
                  <th align="left" valign="bottom" class="border_black">PV/kW</th>
                  <th align="left" valign="bottom" class="border_black">WT/kW</th>
                  <th align="left" valign="bottom" class="border_black">BAT/kW h</th>
                  <th align="left" valign="bottom" class="border_black">BPC/kW</th>
                  <th align="left" valign="bottom" class="border_black">FC/kW</th>
                  <th align="left" valign="bottom" class="border_black">HST/kW h</th>
                  <th align="left" valign="bottom" class="border_black">EL/kW</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">A</td>
                  <td align="char" char="." valign="top">575</td>
                  <td align="char" char="." valign="top">710</td>
                  <td align="char" char="." valign="top">211</td>
                  <td align="char" char="." valign="top">723</td>
                  <td align="char" char="." valign="top">0</td>
                  <td align="char" char="." valign="top">0</td>
                  <td align="char" char="." valign="top">0</td>
                </tr>
                <tr align="left">
                  <td valign="top">B</td>
                  <td align="char" char="." valign="top">594</td>
                  <td align="char" char="." valign="top">870</td>
                  <td align="char" char="." valign="top">112</td>
                  <td align="char" char="." valign="top">704</td>
                  <td align="char" char="." valign="top">3</td>
                  <td align="char" char="." valign="top">25</td>
                  <td align="char" char="." valign="top">3</td>
                </tr>
                <tr align="left">
                  <td valign="top">C</td>
                  <td align="char" char="." valign="top">537</td>
                  <td align="char" char="." valign="top">740</td>
                  <td align="char" char="." valign="top">81</td>
                  <td align="char" char="." valign="top">649</td>
                  <td align="char" char="." valign="top">2</td>
                  <td align="char" char="." valign="top">4</td>
                  <td align="char" char="." valign="top">2</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        
<div class="table_caption"><b>Table 6</b> <span id="tab6">Indicator results in cases without and with DR</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/><col/><col/></colgroup>
              
              
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Case</th>
                  <th align="left" valign="bottom" class="border_black">
                    <span class="italic">I</span>
                    <small><sub>SYS</sub></small> 10<small><sup>4</sup></small>/</th>
                  <th align="left" valign="bottom" class="border_black">TCL/MW</th>
                  <th align="left" valign="bottom" class="border_black">EAR/%</th>
                  <th align="left" valign="bottom" class="border_black">ECSR/%</th>
                  <th align="left" valign="bottom" class="border_black">CSR/%</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">A</td>
                  <td align="char" char="." valign="top">315.37</td>
                  <td align="char" char="." valign="top">142.57</td>
                  <td align="char" char="." valign="top">76.52</td>
                  <td align="char" char="." valign="top">100</td>
                  <td align="char" char="." valign="top">88.26</td>
                </tr>
                <tr align="left">
                  <td valign="top">B</td>
                  <td align="char" char="." valign="top">314.49</td>
                  <td align="char" char="." valign="top">141.22</td>
                  <td align="char" char="." valign="top">80.12</td>
                  <td align="char" char="." valign="top">100</td>
                  <td align="char" char="." valign="top">90.06</td>
                </tr>
                <tr align="left">
                  <td valign="top">C</td>
                  <td align="char" char="." valign="top">312.99</td>
                  <td align="char" char="." valign="top">139.60</td>
                  <td align="char" char="." valign="top">82.46</td>
                  <td align="char" char="." valign="top">91.43</td>
                  <td align="char" char="." valign="top">86.95</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig4"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f4_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f4.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f4.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 4 </b> <span id="fig4"><span class="graphic_title">Annual solar radiation, wind speed and AC/DC load data.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">We use a rule-based operation method to analyze the characteristics of DR. The outline of the algorithm is shown in <a title="Select to navigate to figure" href="#imgfig5">Fig. 5</a>. The principle is to use the battery first, and if it is unavailable, to use the hydrogen storage system. <a title="Select to navigate to figure" href="#imgfig6">Fig. 6</a> shows that the DR minimizes the mismatch between the generation and the load demand profile effectively, increasing the system flexibility. And <a title="Select to navigate to table" href="#tab5">Tables 5</a> and <a title="Select to navigate to table" href="#tab6">6</a> show decreases in capacities and the total annual cost and an increase in ECSR. Thus, the adoption of DR becomes an essential tool for effective and economical sizing of the system components and increases the self-consumption of RES. However, load shifting significantly reduces electricity consumption satisfaction, decreasing the customer satisfaction slightly by 3.11%. Overall, DR within a reasonable range helps to improve the economics and reliability in the microgrid.</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig5"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f5_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f5.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f5.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 5 </b> <span id="fig5"><span class="graphic_title">The flowchart of the rule-based operation method.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig6"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f6_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f6.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f6.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 6 </b> <span id="fig6"><span class="graphic_title">Comparison of typical daily AC and DC load responses.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        
<div class="table_caption"><b>Table 7</b> <span id="tab7">Scenario definitions</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/></colgroup>
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Weather</th>
                  <th align="left" valign="bottom" class="border_black">Scenario number</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">Sunny + gale</td>
                  <td valign="top">Scenario I</td>
                </tr>
                <tr align="left">
                  <td valign="top">Sunny + windy</td>
                  <td valign="top">Scenario II</td>
                </tr>
                <tr align="left">
                  <td valign="top">Cloudy + gale</td>
                  <td valign="top">Scenario III</td>
                </tr>
                <tr align="left">
                  <td valign="top">Cloudy + windy</td>
                  <td valign="top">Scenario IV</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
      
      
        
        <h3 id="sect1317"><span class="b_heading">4.3 Comparison with a rule-based operating strategy</span></h3>
        <span>To better analyze the superiority of the proposed framework, this paper compares the obtained results with a rule-based operating strategy. The results are summarized in <a title="Select to navigate to table" href="#tab8">Tables 8</a> and <a title="Select to navigate to table" href="#tab9">9</a>. Compared with a rule-based operating strategy, the proposed framework reduces the energy interaction with the distribution network by increasing the storage capacity of the battery and hydrogen power generation system. That is to say, it absorbs the excess power during low load and releases it during high load to satisfy the demand in time. Thus, the energy autonomy rate of the microgrid increases by 4.3%. On the other hand, the proposed method slightly increases the installed capacity of RESs while ensuring the overall optimal economy, so the electricity consumption satisfaction rate (ECSR) has improved by 6.38%. Meanwhile, the capacity of the BPC has decreased by 168 kW, indicating that the energy interaction between the AC and DC sides has reduced, thus reducing the total commutation loss.</span>
        
<div class="table_caption"><b>Table 8</b> <span id="tab8">Optimal results</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/><col/><col/><col/><col/></colgroup>
              
              
              
              
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Method</th>
                  <th align="left" valign="bottom" class="border_black">PV/kW</th>
                  <th align="left" valign="bottom" class="border_black">WT/kW</th>
                  <th align="left" valign="bottom" class="border_black">BAT/kW h</th>
                  <th align="left" valign="bottom" class="border_black">BPC/kW</th>
                  <th align="left" valign="bottom" class="border_black">FC/kW</th>
                  <th align="left" valign="bottom" class="border_black">HT/kW h</th>
                  <th align="left" valign="bottom" class="border_black">EL/kW</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">Rule-based method</td>
                  <td align="char" char="." valign="top">537</td>
                  <td align="char" char="." valign="top">740</td>
                  <td align="char" char="." valign="top">81</td>
                  <td align="char" char="." valign="top">649</td>
                  <td align="char" char="." valign="top">2</td>
                  <td align="char" char="." valign="top">4</td>
                  <td align="char" char="." valign="top">2</td>
                </tr>
                <tr align="left">
                  <td valign="top">Proposed method</td>
                  <td align="char" char="." valign="top">540</td>
                  <td align="char" char="." valign="top">780</td>
                  <td align="char" char="." valign="top">303</td>
                  <td align="char" char="." valign="top">481</td>
                  <td align="char" char="." valign="top">9</td>
                  <td align="char" char="." valign="top">32</td>
                  <td align="char" char="." valign="top">9</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        
<div class="table_caption"><b>Table 9</b> <span id="tab9">Indicator results</span>
		</div>

            <div class="rtable__wrapper"><div class="rtable__inner"><table class="tgroup rtable" border="0"><colgroup><col/><col/><col/><col/><col/><col/></colgroup>
              
              
              
              
              
              
              <thead align="left">
                <tr align="left" valign="bottom">
                  <th align="left" valign="bottom" class="border_black">Method</th>
                  <th align="left" valign="bottom" class="border_black">
                    <span class="italic">I</span>
                    <small><sub>SYS</sub></small> 10<small><sup>4</sup></small>/</th>
                  <th align="left" valign="bottom" class="border_black">TCL/MW</th>
                  <th align="left" valign="bottom" class="border_black">EAR/%</th>
                  <th align="left" valign="bottom" class="border_black">ECSR/%</th>
                  <th align="left" valign="bottom" class="border_black">CSR/%</th>
                </tr>
              </thead>
              <tbody align="left">
                <tr align="left">
                  <td valign="top">Rule-based method</td>
                  <td align="char" char="." valign="top">312.99</td>
                  <td align="char" char="." valign="top">139.60</td>
                  <td align="char" char="." valign="top">82.46</td>
                  <td align="char" char="." valign="top">91.43</td>
                  <td align="char" char="." valign="top">86.95</td>
                </tr>
                <tr align="left">
                  <td valign="top">Proposed method</td>
                  <td align="char" char="." valign="top">307.64</td>
                  <td align="char" char="." valign="top">129.80</td>
                  <td align="char" char="." valign="top">86.76</td>
                  <td align="char" char="." valign="top">97.81</td>
                  <td align="char" char="." valign="top">92.28</td>
                </tr>
              </tbody>
            </table></div></div>
          <hr class="hrule"/><br/>
        <p class="otherpara">From the size results, the proposed system indeed has a higher capacity and correspondingly higher investment costs. However, the proposed bi-cyclic co-optimization method achieves optimal scheduling; therefore, the daily operating cost will be less than the rule-based operating cost. Meanwhile, the reduced capacity of the BPC indicates that there is less interaction between the AC and DC sub-grids, which in turn reduces the interaction costs. The increase in the energy autonomy rate of the microgrid indicates a reduction in the power purchase cost from the grid. When calculating the ETC, we are calculating the operating cost, interaction costs, and power purchase cost for 365 days a year, leading to accumulation of cost savings to achieve a lower ETC in the end.</p>
      
      
        
        <h3 id="sect1401"><span class="b_heading">4.4 Scheduling results</span></h3>
        <span>To better analyze the characteristics of DR and the superiority of operational optimization, four typical scenarios are selected in this chapter based on the climatic conditions of a region.<a title="Select to navigate to reference" href="#cit34"><sup><span class="sup_ref">3436</span></sup></a> Four possible weather conditions are considered in this paper, as shown in <a title="Select to navigate to table" href="#tab7">Table 7</a>. The optimal scheduling is presented under the optimal size results of the proposed method. And the following parts will describe the scheduling results in detail. Positive values are used for power purchase from the grid and system discharge, while negative values are used for power sales to the grid and system charging.</span>
        <p class="otherpara">The first typical day has strong renewable energy output, especially for the WT (<a title="Select to navigate to figure" href="#imgfig7">Fig. 7</a>). At night, the output of WT assumes the responsibility of supplying the DC load; while as the intensity increases, PV gradually assumes part of the responsibility for the AC load. Before 08:00, since the RES output is still abundant and the selling price is low, priority is given to charging the battery and electrolyzer and then selling electricity to the grid. However, at the peak of the electricity sales price (08:0013:00), there is a preference to sell electricity to the grid to earn profits. The period 17:0022:00, the trough of the RES output and the peak of load demand, requires the battery and fuel cell to discharge and purchase electricity from the grid to achieve a supply-demand balance.</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig7"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f7_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f7.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f7.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 7 </b> <span id="fig7"><span class="graphic_title">Optimal dispatch results under typical scenario I.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">
          <a title="Select to navigate to figure" href="#imgfig8">Fig. 8</a> shows the dispatch results when the output of WT is small while that of PV is large. Since the power generated by WT cannot meet both DC and AC loads from 0:00 to 08:00, the tendency is to purchase power from the grid to balance demand and charge the battery and electrolyzer in the time of low purchase prices. In this way, the increased storage level will allow the battery and fuel cell to compensate for load demand more often, improving microgrid economics (09:00 and 17:0020:00).</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig8"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f8_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f8.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f8.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 8 </b> <span id="fig8"><span class="graphic_title">Optimal dispatch results under typical scenario II.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">In contrast to scenario II, the production of WT is higher during scenario III (<a title="Select to navigate to figure" href="#imgfig9">Fig. 9</a>). The microgrid prefers to charge the hybrid storage system because of the low selling price. However, it sells electricity to the grid at a high selling price between 09:00 and 15:00, increasing its revenue. Between 10:00 and 21:00, except for battery and fuel cell discharging, it also has to purchase electricity from the grid to meet the peak load. The scheduling results in the last scenario are similar to the previous ones (<a title="Select to navigate to figure" href="#imgfig10">Fig. 10</a>).</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig9"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f9_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f9.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f9.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 9 </b> <span id="fig9"><span class="graphic_title">Optimal dispatch results under typical scenario III.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig10"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f10_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f10.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f10.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 10 </b> <span id="fig10"><span class="graphic_title">Optimal dispatch results under typical scenario IV.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">The results indicate that the hybrid electric-hydrogen storage system can adjust the working mode according to the real-time electricity price and load conditions, shifting peak load to off-peak periods and improving the economic performance. Simulations also show that the hybrid ACDC microgrid structure can maximize the consumption of wind and solar resources by BPC, achieving complementary advantages.</p>
        <p class="otherpara">
          <a title="Select to navigate to figure" href="#imgfig11">Fig. 11</a> and <a title="Select to navigate to figure" href="#imgfig12">12</a> show that SOC and SOHC do not exceed the limits (0.10.9).</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig11"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f11_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f11.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f11.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 11 </b> <span id="fig11"><span class="graphic_title">SOC results.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig12"><a href="/image/article/2022/SE/d2se00556e/d2se00556e-f12_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2se00556e-f12.tif" src="/image/article/2022/SE/d2se00556e/d2se00556e-f12.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 12 </b> <span id="fig12"><span class="graphic_title">SOHC results.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
      
    
    
      
      <h2 id="sect1430"><span class="a_heading">5 Conclusions</span></h2>
      <span>In this paper, a bi-cyclic co-optimization method is proposed for an electricity-hydrogen hybrid energy storage microgrid. The overall control objective is to minimize the annual value costs to obtain the optimal system size. Under the bi-cyclic co-optimization framework, the optimal sizing problem is transformed into a combination of an optimal sizing and an optimal scheduling problem. And a co-optimization method composed of PSO and MILP algorithms is used to search for the best sizing scheme. The simulation results are as follows.</span>
      <p class="otherpara">(1) Demand response and tariff incentives effectively address the mismatch between renewable energy output and load, reducing allocation size and thus improving the economics. Although it slightly reduces user satisfaction, it is still within the acceptable range.</p>
      <p class="otherpara">(2) The proposed method can more flexibly use an electric-hydrogen storage system to cooperate, improving the economy of the AC/DC microgrid. Compared with a rule-based operating strategy, the nested optimal scheduling and optimal sizing scheme saves 53<img class="charmap" src="https://www.rsc.org/images/entities/char_2009.gif" alt="[thin space (1/6-em)]"/>500  and improves the energy autonomy rate by 4.3%.</p>
    
    
      <h2 id="sect1436"><span class="a_heading">Author contributions</span></h2>
      <span>Ying Han: conceptualization, methodology, writing  original draft, project administration, supervision. Luoyi Li: validation, writing  original draft, conceptualization, methodology. Weirong Chen: funding acquisition, supervision. Yujing Hou: validation, writing  reviewing &amp; editing. Jiefu Zhang: resources, writing  original draft.</span>
    
    
      <h2 id="sect1439"><span class="a_heading">Conflicts of interest</span></h2>
      <span>There are no conflicts to declare.</span>
    
  
    <h2 id="sect1443"><span class="a_heading">Acknowledgements</span></h2>
      <span>The authors would like to thank the reviewers for their helpful suggestions. This work was supported by the National Natural Science Foundation of China (52007157, 51977181, 52077180), the China Postdoctoral Science Foundation (2021M692684), the Natural Science Foundation of Sichuan (2022NSFSC0269), and the Fok Ying-Tong Education Foundation of China (171104).</span>
    
    <span id="sect1445"><h2 id="sect1442"><span class="a_heading">Notes and references</span></h2></span><ol type="1">
      <li><span id="cit1">B. Li, R. Roche and A. Miraoui, Microgrid sizing with combined evolutionary algorithm and MILP unit commitment, <span class="italic">Appl. Energy</span>, 2017, <span class="bold">188</span>, 547562<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2016.12.038" title="DOI Link to resource 10.1016/j.apenergy.2016.12.038">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/1_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit2">L. Li, W. Chen, Y. Han, Q. Li and Y. Pu, A Stability Enhancement Method Based on Adaptive Virtual Resistor for Electric-hydrogen Hybrid DC Microgrid Grid-connected Inverter Under Weak Grid, <span class="italic">Electr. Power Syst. Res.</span>, 2021, <span class="bold">191</span>, 106882<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.epsr.2020.106882" title="DOI Link to resource 10.1016/j.epsr.2020.106882">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/2_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit3">G. Cau, D. Cocco, M. Petrollese, S. K. Kaer and C. Milan, Energy management strategy based on short-term generation scheduling for a renewable microgrid using a hydrogen storage system, <span class="italic">Energy Convers. Manage.</span>, 2014, <span class="bold">87</span>, 820831<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.enconman.2014.07.078" title="DOI Link to resource 10.1016/j.enconman.2014.07.078">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/3_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit4">A. Monforti Ferrario, F. Vivas, F. Segura Manzano, J. Andjar, E. Bocci and L. Martirano, Hydrogen vs. Battery in the Long-term Operation. A Comparative Between Energy Management Strategies for Hybrid Renewable Microgrids, <span class="italic">Electronics</span>, 2020, <span class="bold">9</span>, 698<a target="_blank" class="DOILink" href="https://doi.org/10.3390/electronics9040698" title="DOI Link to resource 10.3390/electronics9040698">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/4_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit5">B. Thilo, Hybrid Energy Storage Systems for Renewable Energy Applications, <span class="italic">Energy Procedia</span>, 2015, <span class="bold">73</span>, 103111<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.egypro.2015.07.582" title="DOI Link to resource 10.1016/j.egypro.2015.07.582">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/5_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit6">L. Li, Y. Han, Q. Li, Y. Pu, C. Sun and W. Chen, Event-triggered decentralized coordinated control method for economic operation of an islanded electric-hydrogen hybrid DC microgrid, <span class="italic">Journal of Energy Storage</span>, 2022, <span class="bold">45</span>, 103704<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.est.2021.103704" title="DOI Link to resource 10.1016/j.est.2021.103704">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/6_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit7">Y. Xia, W. Wei, M. Yu, Y. Peng and J. Tang, Decentralized Multi-Time Scale Power Control for a Hybrid AC/DC Microgrid with Multiple Subgrids, <span class="italic">IEEE Trans. Power Electron.</span>, 2017, 1<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20Trans.%20Power%20Electron.%5BJour%5D%20AND%20%5Bvolume%5D%20AND%201%5Bpage%5D%20and%202017%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/7_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit8">P. Li, R. Li, Y. Cao, D. Li and G. Xie, Multiobjective Sizing Optimization for Island Microgrids Using a Triangular Aggregation Model and the Levy-Harmony Algorithm, <span class="italic">IEEE Trans Industr. Inform.</span>, 2018, <span class="bold">14</span>, 34953505<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20Trans%20Industr.%20Inform.%5BJour%5D%20AND%2014%5Bvolume%5D%20AND%203495%5Bpage%5D%20and%202018%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/8_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit9">A. S. Rana, F. Iqbal, A. S. Siddiqui and M. S. Thomas, Hybrid methodology to analyse reliability and techno-economic evaluation of microgrid configurations, <span class="italic">IET Gener. Transm. Distrib.</span>, 2019, <span class="bold">13</span>, 47784787<a target="_blank" class="DOILink" href="https://doi.org/10.1049/iet-gtd.2018.6733" title="DOI Link to resource 10.1049/iet-gtd.2018.6733">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/9_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit10">S. Bandyopadhyay, G. R. C. Mouli, Z. Qin, L. R. Elizondo and P. Bauer, Techno-Economical Model Based Optimal Sizing of PV-Battery Systems for Microgrids, <span class="italic">IEEE Trans Sustain. Energy</span>, 2020, <span class="bold">11</span>, 16571668<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20Trans%20Sustain.%20Energy%5BJour%5D%20AND%2011%5Bvolume%5D%20AND%201657%5Bpage%5D%20and%202020%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/10_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit11">Z. Wei, C. Lou, Z. Li, L. Lin and H. Yang, Current status of research on optimum sizing of stand-alone hybrid solarwind power generation systems, <span class="italic">Appl. Energy</span>, 2010, <span class="bold">87</span>, 380389<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2009.08.012" title="DOI Link to resource 10.1016/j.apenergy.2009.08.012">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/11_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit12">M. R. Estabragh, A. Dastfan and M. Rahimiyan, Parallel AC-DC interlinking converters in the proposed grid-connected hybrid AC-DC microgrid; planning, <span class="italic">Electr. Power Syst. Res.</span>, 2021, <span class="bold">200</span>, 107476<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.epsr.2021.107476" title="DOI Link to resource 10.1016/j.epsr.2021.107476">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/12_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit13">I. etinba, B. Tamyrek and M. Demirta, Sizing optimization and design of an autonomous AC microgrid for commercial loads using Harris Hawks Optimization algorithm, <span class="italic">Energy Convers. Manage.</span>, 2021, <span class="bold">245</span>, 114562<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.enconman.2021.114562" title="DOI Link to resource 10.1016/j.enconman.2021.114562">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/13_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit14">H. Bakhtiari and R. A. Naghizadeh, Multi-criteria optimal sizing of hybrid renewable energy systems including wind, photovoltaic, battery, and hydrogen storage with -constraint method, <span class="italic">IET Renew. Power Gener.</span>, 2018, <span class="bold">12</span>, 883892<a target="_blank" class="DOILink" href="https://doi.org/10.1049/iet-rpg.2017.0706" title="DOI Link to resource 10.1049/iet-rpg.2017.0706">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/14_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit15">A. Monforti Ferrario, A. Bartolini, F. Segura Manzano, F. J. Vivas, G. Comodi, S. J. McPhail and J. M. Andujar, A model-based parametric and optimal sizing of a battery/hydrogen storage of a real hybrid microgrid supplying a residential load: towards island operation, <span class="italic">Advances in Applied Energy</span>, 2021, <span class="bold">3</span>, 100048<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.adapen.2021.100048" title="DOI Link to resource 10.1016/j.adapen.2021.100048">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/15_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit16">M. K. Kiptoo, O. B. Adewuyi, M. E. Lotfy, T. Amara and T. Senjyu, Assessing the Techno-Economic Benefits of Flexible Demand Resources Scheduling for Renewable Energy-Based Smart Microgrid Planning, <span class="italic">Future Internet</span>, 2019, <span class="bold">11</span>, 219<a target="_blank" class="DOILink" href="https://doi.org/10.3390/fi11100219" title="DOI Link to resource 10.3390/fi11100219">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/16_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit17">M. K. Kiptoo, M. E. Lotfy, O. B. Adewuyi, A. Conteh and T. Senjyu, Integrated approach for optimal techno-economic planning for high renewable energy-based isolated microgrid considering cost of energy storage and demand response strategies, <span class="italic">Energy Convers. Manage.</span>, 2020, <span class="bold">215</span>, 112917<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.enconman.2020.112917" title="DOI Link to resource 10.1016/j.enconman.2020.112917">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/17_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit18">R. Rigo-Mariani, S. O. Chea Wae, S. Mazzoni and A. Romagnoli, Comparison of optimization frameworks for the design of a multi-energy microgrid, <span class="italic">Appl. Energy</span>, 2020, <span class="bold">257</span>, 113982<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2019.113982" title="DOI Link to resource 10.1016/j.apenergy.2019.113982">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/18_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit19">A. Roy, J. Olivier, F. Auger, B. Auvity, E. Schaeffer, S. Bourguet, J. Schiebel and J. Perret, A combined optimization of the sizing and the energy management of an industrial multi-energy microgrid: application to a harbour area, <span class="italic">Energy Convers. Manage.: X</span>, 2021, <span class="bold">12</span>, 100107<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Energy%20Convers.%20Manage.:%20X%5BJour%5D%20AND%2012%5Bvolume%5D%20AND%20100107%5Bpage%5D%20and%202021%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/19_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit20">S. Swaminathan, G. S. Pavlak and J. Freihaut, Sizing and dispatch of an islanded microgrid with energy flexible buildings, <span class="italic">Appl. Energy</span>, 2020, <span class="bold">276</span>, 115355<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2020.115355" title="DOI Link to resource 10.1016/j.apenergy.2020.115355">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/20_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit21">B. Li, R. Roche, D. Paire and A. Miraoui, Sizing of a stand-alone microgrid considering electric power, cooling/heating, hydrogen loads and hydrogen storage degradation, <span class="italic">Appl. Energy</span>, 2017, <span class="bold">205</span>, 12441259<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2017.08.142" title="DOI Link to resource 10.1016/j.apenergy.2017.08.142">CrossRef</a><a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2sXhtlyisrnP" title="Link to resource in CAS">CAS</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/21_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit22">J. Moshvel, K. Kairies, D. Magnor, M. Leuthold, M. Bost, S. Ghrs, E. Szczechowicz, M. Cramer and D. U. Sauer, Analysis of the maximal possible grid relief from PV-peak-power impacts by using storage systems for increased self-consumption, <span class="italic">Appl. Energy</span>, 2015, <span class="bold">137</span>, 567575<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2014.07.021" title="DOI Link to resource 10.1016/j.apenergy.2014.07.021">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/22_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit23">R. Atia and N. Yamada, Sizing and Analysis of Renewable Energy and Battery Systems in Residential Microgrids, <span class="italic">IEEE Trans. Smart Grid</span>, 2016, <span class="bold">7</span>, 12041213<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20Trans.%20Smart%20Grid%5BJour%5D%20AND%207%5Bvolume%5D%20AND%201204%5Bpage%5D%20and%202016%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/23_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit24">E. L. V. Eriksson and E. M. Gray, Optimization and integration of hybrid renewable energy hydrogen fuel cell energy systems  a critical review, <span class="italic">Appl. Energy</span>, 2017, <span class="bold">202</span>, 348364<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.apenergy.2017.03.132" title="DOI Link to resource 10.1016/j.apenergy.2017.03.132">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/24_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit25">Z. Wang, Z. Xu, Y. Zhang and M. Xie, Optimal Cleaning Scheduling for Photovoltaic Systems in the Field Based on Electricity Generation and Dust Deposition Forecasting, <span class="italic">IEEE J. Photovolt.</span>, 2020, <span class="bold">10</span>, 11261132<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20J.%20Photovolt.%5BJour%5D%20AND%2010%5Bvolume%5D%20AND%201126%5Bpage%5D%20and%202020%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/25_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit26">A. Dwi and S. Hwachang, Coordination Control Strategy for AC/DC Hybrid Microgrids in Stand-Alone Mode, <span class="italic">Energies</span>, 2016, <span class="bold">9</span>, 469<a target="_blank" class="DOILink" href="https://doi.org/10.3390/en9060469" title="DOI Link to resource 10.3390/en9060469">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/26_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit27">T. Lajnef, S. AbId and A. Ammous, Modeling, Control, and Simulation of a Solar Hydrogen/Fuel Cell Hybrid Energy System for Grid-Connected Applications, <span class="italic">Adv. Power Electron.</span>, 2013, 352765.1352765.9<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Adv.%20Power%20Electron.%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20352765.1%5Bpage%5D%20and%202013%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/27_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit28">Y. Han, Q. Li, T. Wang, W. Chen and L. Ma, Multisource Coordination Energy Management Strategy Based on SOC Consensus for a PEMFCBatterySupercapacitor Hybrid Tramway, <span class="italic">IEEE Trans. Veh. Technol.</span>, 2018, 1<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IEEE%20Trans.%20Veh.%20Technol.%5BJour%5D%20AND%20%5Bvolume%5D%20AND%201%5Bpage%5D%20and%202018%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/28_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit29">. Hernndez-Gmez, V. Ramirez and D. Guilbert, Investigation of PEM electrolyzer modeling: Electrical domain, efficiency, and specific energy consumption, <span class="italic">Int. J. Hydrogen Energy</span>, 2020, <span class="bold">45</span>, 1462514639<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.ijhydene.2020.03.195" title="DOI Link to resource 10.1016/j.ijhydene.2020.03.195">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/29_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit30">
          M. H. Albadi and E. F. El-Saadany, Demand Response in Electricity Markets: An Overview, in <span class="italic">2007 IEEE Power Engineering Society General Meeting Tampa</span>, : IEEE, FL, USA,  2007<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=2007%20IEEE%20Power%20Engineering%20Society%20General%20Meeting%20Tampa%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202007%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/30_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit31">A. N. Ghalelou, A. P. Fakhri, S. Nojavan, M. Majidi and H. Hatami, A stochastic self-scheduling program for compressed air energy storage (CAES) of renewable energy sources (RESs) based on a demand response mechanism, <span class="italic">Energy Convers. Manage.</span>, 2016, <span class="bold">120</span>, 388396<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.enconman.2016.04.082" title="DOI Link to resource 10.1016/j.enconman.2016.04.082">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/31_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit32">M. Uzunoglu, O. C. Onar and M. S. Alam, Modeling, control and simulation of a PV/FC/UC based hybrid power generation system for stand-alone applications, <span class="italic">Renewable Energy</span>, 2009, <span class="bold">34</span>, 509520<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.renene.2008.06.009" title="DOI Link to resource 10.1016/j.renene.2008.06.009">CrossRef</a><a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BD1cXhtlWjtbzO" title="Link to resource in CAS">CAS</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/32_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit33">M. Castaneda, A. Cano, F. Jurado, H. Sanchez and L. M. Fernandez, Sizing optimization, dynamic modeling and energy management strategies of a stand-alone PV/hydrogen/battery-based hybrid system, <span class="italic">Int. J. Hydrogen Energy</span>, 2013, <span class="bold">38</span>, 38303845<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.ijhydene.2013.01.080" title="DOI Link to resource 10.1016/j.ijhydene.2013.01.080">CrossRef</a><a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC3sXisVyjsrY%253D" title="Link to resource in CAS">CAS</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/33_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit34">M. Sugimura, M. M. Gamil, H. Akter, N. Krishna and T. Senjyu, Optimal sizing and operation for microgrid with renewable energy considering two types demand response, <span class="italic">J. Renewable Sustainable Energy</span>, 2020, <span class="bold">12</span>, 065901<a target="_blank" class="DOILink" href="https://doi.org/10.1063/5.0008065" title="DOI Link to resource 10.1063/5.0008065">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/34_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit35">R. Wang, Multi-objective configuration optimization method for a diesel-based hybrid energy system, <span class="italic">Energy Rep.</span>, 2020, <span class="bold">6</span>, 21462152<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.egyr.2020.08.004" title="DOI Link to resource 10.1016/j.egyr.2020.08.004">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/35_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit36">
          K. Hein, Y. Xu, W. Gary and A. K. Gupta, Robustly coordinated operational scheduling of a grid connected seaport microgrid under uncertainties, <span class="italic">IET Generation, Transmission &amp; Distribution</span>,  2021, vol. 15<a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=IET%20Generation,%20Transmission%20&amp;%20Distribution%5BJour%5D%20AND%20vol. 15%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202021%5Bpdat%5D" title="Search PubMed for this citation">SearchPubMed</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/36_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit37">H. Wang, T. Wang, X. Xie, Z. Ling, G. Gao and X. Dong, Optimal Capacity Configuration of a Hybrid Energy Storage System for an Isolated Microgrid Using Quantum-Behaved Particle Swarm Optimization, <span class="italic">Energies</span>, 2018, <span class="bold">11</span>, 454<a target="_blank" class="DOILink" href="https://doi.org/10.3390/en11020454" title="DOI Link to resource 10.3390/en11020454">CrossRef</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/37_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
      <li><span id="cit38">H. Aki, I. Sugimoto, T. Sugai, M. Toda, M. Kobayashi and M. Ishida, Optimal operation of a photovoltaic generation-powered hydrogen production system at a hydrogen refueling station, <span class="italic">Int. J. Hydrogen Energy</span>, 2018, <span class="bold">43</span>, 1489214904<a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.ijhydene.2018.06.077" title="DOI Link to resource 10.1016/j.ijhydene.2018.06.077">CrossRef</a><a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC1cXht1CjtLbN" title="Link to resource in CAS">CAS</a><a target="_blank" class="URLLink" href="/en/Content/OpenURL/50001067/d2se00556e/38_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50001067"/></a>.</span></li>
    </ol>
    
    
    
    
    
  <table><tr><td><hr/></td></tr><tr><td><b>This journal is  The Royal Society of Chemistry 2022</b></td></tr></table></div></div></div></body><script src="/content/scripts/CrossMarkIE.js"></script><SaxonLicenceTest result="pass" message="Licenced Enterprise Edition [ EE 9.3.0.4 ]"/></html>