<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:art="http://www.rsc.org/schema/rscart38" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:rsc="urn:rsc.org" xml:lang="en" lang="en"><head><!--Google Tag Manager--><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-56FZ7G');</script><!--End Google Tag Manager--><title>Bayesian optimization with known experimental and design constraints for chemistry applications   - Digital Discovery (RSC Publishing) DOI:10.1039/D2DD00028H</title><link rel="canonical" href="https://pubs.rsc.org/en/content/articlehtml/2022/dd/d2dd00028h"/><meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8"/><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info = {"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-aaa897feae8feeca979","applicationID":"1313546638","transactionName":"M1wANxQFCEcDVU0PWgoWLzUlSyVbDEJcCEEnVgwXFAsKWAdEFgdHEFABDwMMElkO","queueTime":0,"applicationTime":48,"agent":"","atts":""}</script><script type="text/javascript">(window.NREUM||(NREUM={})).init={privacy:{cookies_enabled:true},ajax:{deny_list:["bam.nr-data.net"]},distributed_tracing:{enabled:true}};(window.NREUM||(NREUM={})).loader_config={agentID:"1386013924",accountID:"2851366",trustKey:"1029994",xpid:"Vg4CUFVVDhABV1BRAgUBUFcJ",licenseKey:"NRJS-aaa897feae8feeca979",applicationID:"1313546638"};;/*! For license information please see nr-loader-spa-1.236.0.min.js.LICENSE.txt */
(()=>{"use strict";var e,t,r={5763:(e,t,r)=>{r.d(t,{P_:()=>l,Mt:()=>g,C5:()=>s,DL:()=>v,OP:()=>T,lF:()=>D,Yu:()=>y,Dg:()=>h,CX:()=>c,GE:()=>b,sU:()=>_});var n=r(8632),i=r(9567);const o={beacon:n.ce.beacon,errorBeacon:n.ce.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0},a={};function s(e){if(!e)throw new Error("All info objects require an agent identifier!");if(!a[e])throw new Error("Info for ".concat(e," was never set"));return a[e]}function c(e,t){if(!e)throw new Error("All info objects require an agent identifier!");a[e]=(0,i.D)(t,o),(0,n.Qy)(e,a[e],"info")}var u=r(7056);const d=()=>{const e={blockSelector:"[data-nr-block]",maskInputOptions:{password:!0}};return{allow_bfcache:!0,privacy:{cookies_enabled:!0},ajax:{deny_list:void 0,enabled:!0,harvestTimeSeconds:10},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},session:{domain:void 0,expiresMs:u.oD,inactiveMs:u.Hb},ssl:void 0,obfuscate:void 0,jserrors:{enabled:!0,harvestTimeSeconds:10},metrics:{enabled:!0},page_action:{enabled:!0,harvestTimeSeconds:30},page_view_event:{enabled:!0},page_view_timing:{enabled:!0,harvestTimeSeconds:30,long_task:!1},session_trace:{enabled:!0,harvestTimeSeconds:10},harvest:{tooManyRequestsDelay:60},session_replay:{enabled:!1,harvestTimeSeconds:60,sampleRate:.1,errorSampleRate:.1,maskTextSelector:"*",maskAllInputs:!0,get blockClass(){return"nr-block"},get ignoreClass(){return"nr-ignore"},get maskTextClass(){return"nr-mask"},get blockSelector(){return e.blockSelector},set blockSelector(t){e.blockSelector+=",".concat(t)},get maskInputOptions(){return e.maskInputOptions},set maskInputOptions(t){e.maskInputOptions={...t,password:!0}}},spa:{enabled:!0,harvestTimeSeconds:10}}},f={};function l(e){if(!e)throw new Error("All configuration objects require an agent identifier!");if(!f[e])throw new Error("Configuration for ".concat(e," was never set"));return f[e]}function h(e,t){if(!e)throw new Error("All configuration objects require an agent identifier!");f[e]=(0,i.D)(t,d()),(0,n.Qy)(e,f[e],"config")}function g(e,t){if(!e)throw new Error("All configuration objects require an agent identifier!");var r=l(e);if(r){for(var n=t.split("."),i=0;i<n.length-1;i++)if("object"!=typeof(r=r[n[i]]))return;r=r[n[n.length-1]]}return r}const p={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},m={};function v(e){if(!e)throw new Error("All loader-config objects require an agent identifier!");if(!m[e])throw new Error("LoaderConfig for ".concat(e," was never set"));return m[e]}function b(e,t){if(!e)throw new Error("All loader-config objects require an agent identifier!");m[e]=(0,i.D)(t,p),(0,n.Qy)(e,m[e],"loader_config")}const y=(0,n.mF)().o;var w=r(385),x=r(6818);const A={buildEnv:x.Re,bytesSent:{},queryBytesSent:{},customTransaction:void 0,disabled:!1,distMethod:x.gF,isolatedBacklog:!1,loaderType:void 0,maxBytes:3e4,offset:Math.floor(w._A?.performance?.timeOrigin||w._A?.performance?.timing?.navigationStart||Date.now()),onerror:void 0,origin:""+w._A.location,ptid:void 0,releaseIds:{},session:void 0,xhrWrappable:"function"==typeof w._A.XMLHttpRequest?.prototype?.addEventListener,version:x.q4},E={};function T(e){if(!e)throw new Error("All runtime objects require an agent identifier!");if(!E[e])throw new Error("Runtime for ".concat(e," was never set"));return E[e]}function _(e,t){if(!e)throw new Error("All runtime objects require an agent identifier!");E[e]=(0,i.D)(t,A),(0,n.Qy)(e,E[e],"runtime")}function D(e){return function(e){try{const t=s(e);return!!t.licenseKey&&!!t.errorBeacon&&!!t.applicationID}catch(e){return!1}}(e)}},9567:(e,t,r)=>{r.d(t,{D:()=>i});var n=r(50);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.Z)("Setting a Configurable requires an object as input");if(!t||"object"!=typeof t)return(0,n.Z)("Setting a Configurable requires a model to set its initial properties");const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),o=0===Object.keys(r).length?e:r;for(let a in o)if(void 0!==e[a])try{"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){(0,n.Z)("An error occurred while setting a property of a Configurable",e)}return r}catch(e){(0,n.Z)("An error occured while setting a Configurable",e)}}},6818:(e,t,r)=>{r.d(t,{Re:()=>i,gF:()=>o,q4:()=>n});const n="1.236.0",i="PROD",o="CDN"},385:(e,t,r)=>{r.d(t,{FN:()=>a,IF:()=>u,Nk:()=>f,Tt:()=>s,_A:()=>o,il:()=>n,pL:()=>c,v6:()=>i,w1:()=>d});const n="undefined"!=typeof window&&!!window.document,i="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),o=n?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),a=""+o?.location,s=/iPad|iPhone|iPod/.test(navigator.userAgent),c=s&&"undefined"==typeof SharedWorker,u=(()=>{const e=navigator.userAgent.match(/Firefox[/\s](\d+\.\d+)/);return Array.isArray(e)&&e.length>=2?+e[1]:0})(),d=Boolean(n&&window.document.documentMode),f=!!navigator.sendBeacon},1117:(e,t,r)=>{r.d(t,{w:()=>o});var n=r(50);const i={agentIdentifier:"",ee:void 0};class o{constructor(e){try{if("object"!=typeof e)return(0,n.Z)("shared context requires an object as input");this.sharedContext={},Object.assign(this.sharedContext,i),Object.entries(e).forEach((e=>{let[t,r]=e;Object.keys(i).includes(t)&&(this.sharedContext[t]=r)}))}catch(e){(0,n.Z)("An error occured while setting SharedContext",e)}}}},8e3:(e,t,r)=>{r.d(t,{L:()=>d,R:()=>c});var n=r(2177),i=r(1284),o=r(4322),a=r(3325);const s={};function c(e,t){const r={staged:!1,priority:a.p[t]||0};u(e),s[e].get(t)||s[e].set(t,r)}function u(e){e&&(s[e]||(s[e]=new Map))}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"feature";if(u(e),!e||!s[e].get(t))return a(t);s[e].get(t).staged=!0;const r=[...s[e]];function a(t){const r=e?n.ee.get(e):n.ee,a=o.X.handlers;if(r.backlog&&a){var s=r.backlog[t],c=a[t];if(c){for(var u=0;s&&u<s.length;++u)f(s[u],c);(0,i.D)(c,(function(e,t){(0,i.D)(t,(function(t,r){r[0].on(e,r[1])}))}))}delete a[t],r.backlog[t]=null,r.emit("drain-"+t,[])}}r.every((e=>{let[t,r]=e;return r.staged}))&&(r.sort(((e,t)=>e[1].priority-t[1].priority)),r.forEach((e=>{let[t]=e;a(t)})))}function f(e,t){var r=e[1];(0,i.D)(t[r],(function(t,r){var n=e[0];if(r[0]===n){var i=r[1],o=e[3],a=e[2];i.apply(o,a)}}))}},2177:(e,t,r)=>{r.d(t,{c:()=>f,ee:()=>u});var n=r(8632),i=r(2210),o=r(1284),a=r(5763),s="nr@context";let c=(0,n.fP)();var u;function d(){}function f(e){return(0,i.X)(e,s,l)}function l(){return new d}function h(){u.aborted=!0,u.backlog={}}c.ee?u=c.ee:(u=function e(t,r){var n={},c={},f={},g=!1;try{g=16===r.length&&(0,a.OP)(r).isolatedBacklog}catch(e){}var p={on:b,addEventListener:b,removeEventListener:y,emit:v,get:x,listeners:w,context:m,buffer:A,abort:h,aborted:!1,isBuffering:E,debugId:r,backlog:g?{}:t&&"object"==typeof t.backlog?t.backlog:{}};return p;function m(e){return e&&e instanceof d?e:e?(0,i.X)(e,s,l):l()}function v(e,r,n,i,o){if(!1!==o&&(o=!0),!u.aborted||i){t&&o&&t.emit(e,r,n);for(var a=m(n),s=w(e),d=s.length,f=0;f<d;f++)s[f].apply(a,r);var l=T()[c[e]];return l&&l.push([p,e,r,a]),a}}function b(e,t){n[e]=w(e).concat(t)}function y(e,t){var r=n[e];if(r)for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)}function w(e){return n[e]||[]}function x(t){return f[t]=f[t]||e(p,t)}function A(e,t){var r=T();p.aborted||(0,o.D)(e,(function(e,n){t=t||"feature",c[n]=t,t in r||(r[t]=[])}))}function E(e){return!!T()[c[e]]}function T(){return p.backlog}}(void 0,"globalEE"),c.ee=u)},5546:(e,t,r)=>{r.d(t,{E:()=>n,p:()=>i});var n=r(2177).ee.get("handle");function i(e,t,r,i,o){o?(o.buffer([e],i),o.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},4322:(e,t,r)=>{r.d(t,{X:()=>o});var n=r(5546);o.on=a;var i=o.handlers={};function o(e,t,r,o){a(o||n.E,i,e,t,r)}function a(e,t,r,i,o){o||(o="feature"),e||(e=n.E);var a=t[o]=t[o]||{};(a[r]=a[r]||[]).push([e,i])}},3239:(e,t,r)=>{r.d(t,{bP:()=>s,iz:()=>c,m$:()=>a});var n=r(385);let i=!1,o=!1;try{const e={get passive(){return i=!0,!1},get signal(){return o=!0,!1}};n._A.addEventListener("test",null,e),n._A.removeEventListener("test",null,e)}catch(e){}function a(e,t){return i||o?{capture:!!e,passive:i,signal:t}:!!e}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;window.addEventListener(e,t,a(r,n))}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;document.addEventListener(e,t,a(r,n))}},4402:(e,t,r)=>{r.d(t,{Ht:()=>u,M:()=>c,Rl:()=>a,ky:()=>s});var n=r(385);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function o(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n._A?.crypto||n._A?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(31))),i.split("").map((e=>"x"===e?o(t,++r).toString(16):"y"===e?(3&o()|8).toString(16):e)).join("")}function s(e){const t=n._A?.crypto||n._A?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(31)));const a=[];for(var s=0;s<e;s++)a.push(o(r,++i).toString(16));return a.join("")}function c(){return s(16)}function u(){return s(32)}},7056:(e,t,r)=>{r.d(t,{Bq:()=>n,Hb:()=>o,oD:()=>i});const n="NRBA",i=144e5,o=18e5},7894:(e,t,r)=>{function n(){return Math.round(performance.now())}r.d(t,{z:()=>n})},7243:(e,t,r)=>{r.d(t,{e:()=>o});var n=r(385),i={};function o(e){if(e in i)return i[e];if(0===(e||"").indexOf("data:"))return{protocol:"data"};let t;var r=n._A?.location,o={};if(n.il)t=document.createElement("a"),t.href=e;else try{t=new URL(e,r.href)}catch(e){return o}o.port=t.port;var a=t.href.split("://");!o.port&&a[1]&&(o.port=a[1].split("/")[0].split("@").pop().split(":")[1]),o.port&&"0"!==o.port||(o.port="https"===a[0]?"443":"80"),o.hostname=t.hostname||r.hostname,o.pathname=t.pathname,o.protocol=a[0],"/"!==o.pathname.charAt(0)&&(o.pathname="/"+o.pathname);var s=!t.protocol||":"===t.protocol||t.protocol===r.protocol,c=t.hostname===r.hostname&&t.port===r.port;return o.sameOrigin=s&&(!t.hostname||c),"/"===o.pathname&&(i[e]=o),o}},50:(e,t,r)=>{function n(e,t){"function"==typeof console.warn&&(console.warn("New Relic: ".concat(e)),t&&console.warn(t))}r.d(t,{Z:()=>n})},2587:(e,t,r)=>{r.d(t,{N:()=>c,T:()=>u});var n=r(2177),i=r(5546),o=r(8e3),a=r(3325);const s={stn:[a.D.sessionTrace],err:[a.D.jserrors,a.D.metrics],ins:[a.D.pageAction],spa:[a.D.spa],sr:[a.D.sessionReplay,a.D.sessionTrace]};function c(e,t){const r=n.ee.get(t);e&&"object"==typeof e&&(Object.entries(e).forEach((e=>{let[t,n]=e;void 0===u[t]&&(s[t]?s[t].forEach((e=>{n?(0,i.p)("feat-"+t,[],void 0,e,r):(0,i.p)("block-"+t,[],void 0,e,r),(0,i.p)("rumresp-"+t,[Boolean(n)],void 0,e,r)})):n&&(0,i.p)("feat-"+t,[],void 0,void 0,r),u[t]=Boolean(n))})),Object.keys(s).forEach((e=>{void 0===u[e]&&(s[e]?.forEach((t=>(0,i.p)("rumresp-"+e,[!1],void 0,t,r))),u[e]=!1)})),(0,o.L)(t,a.D.pageViewEvent))}const u={}},2210:(e,t,r)=>{r.d(t,{X:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},1284:(e,t,r)=>{r.d(t,{D:()=>n});const n=(e,t)=>Object.entries(e||{}).map((e=>{let[r,n]=e;return t(r,n)}))},4351:(e,t,r)=>{r.d(t,{P:()=>o});var n=r(2177);const i=()=>{const e=new WeakSet;return(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}};function o(e){try{return JSON.stringify(e,i())}catch(e){try{n.ee.emit("internal-error",[e])}catch(e){}}}},3960:(e,t,r)=>{r.d(t,{K:()=>a,b:()=>o});var n=r(3239);function i(){return"undefined"==typeof document||"complete"===document.readyState}function o(e,t){if(i())return e();(0,n.bP)("load",e,t)}function a(e){if(i())return e();(0,n.iz)("DOMContentLoaded",e)}},8632:(e,t,r)=>{r.d(t,{EZ:()=>u,Qy:()=>c,ce:()=>o,fP:()=>a,gG:()=>d,mF:()=>s});var n=r(7894),i=r(385);const o={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function a(){return i._A.NREUM||(i._A.NREUM={}),void 0===i._A.newrelic&&(i._A.newrelic=i._A.NREUM),i._A.NREUM}function s(){let e=a();return e.o||(e.o={ST:i._A.setTimeout,SI:i._A.setImmediate,CT:i._A.clearTimeout,XHR:i._A.XMLHttpRequest,REQ:i._A.Request,EV:i._A.Event,PR:i._A.Promise,MO:i._A.MutationObserver,FETCH:i._A.fetch}),e}function c(e,t,r){let i=a();const o=i.initializedAgents||{},s=o[e]||{};return Object.keys(s).length||(s.initializedAt={ms:(0,n.z)(),date:new Date}),i.initializedAgents={...o,[e]:{...s,[r]:t}},i}function u(e,t){a()[e]=t}function d(){return function(){let e=a();const t=e.info||{};e.info={beacon:o.beacon,errorBeacon:o.errorBeacon,...t}}(),function(){let e=a();const t=e.init||{};e.init={...t}}(),s(),function(){let e=a();const t=e.loader_config||{};e.loader_config={...t}}(),a()}},7956:(e,t,r)=>{r.d(t,{N:()=>i});var n=r(3239);function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return void(0,n.iz)("visibilitychange",(function(){if(t)return void("hidden"==document.visibilityState&&e());e(document.visibilityState)}),r,i)}},1214:(e,t,r)=>{r.d(t,{em:()=>v,u5:()=>N,QU:()=>S,_L:()=>I,Gm:()=>L,Lg:()=>M,gy:()=>U,BV:()=>Q,Kf:()=>ee});var n=r(2177);const i="nr@original";var o=Object.prototype.hasOwnProperty,a=!1;function s(e,t){return e||(e=n.ee),r.inPlace=function(e,t,n,i,o){n||(n="");var a,s,c,u="-"===n.charAt(0);for(c=0;c<t.length;c++)d(a=e[s=t[c]])||(e[s]=r(a,u?s+n:n,i,s,o))},r.flag=i,r;function r(t,r,n,a,s){return d(t)?t:(r||(r=""),nrWrapper[i]=t,u(t,nrWrapper,e),nrWrapper);function nrWrapper(){var i,u,d,f;try{u=this,i=[...arguments],d="function"==typeof n?n(i,u):n||{}}catch(t){c([t,"",[i,u,a],d],e)}o(r+"start",[i,u,a],d,s);try{return f=t.apply(u,i)}catch(e){throw o(r+"err",[i,u,e],d,s),e}finally{o(r+"end",[i,u,f],d,s)}}}function o(r,n,i,o){if(!a||t){var s=a;a=!0;try{e.emit(r,n,i,t,o)}catch(t){c([t,r,n,i],e)}a=s}}}function c(e,t){t||(t=n.ee);try{t.emit("internal-error",e)}catch(e){}}function u(e,t,r){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){return e[r]=t,t}})})),t}catch(e){c([e],r)}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return t}function d(e){return!(e&&e instanceof Function&&e.apply&&!e[i])}var f=r(2210),l=r(385);const h={},g=XMLHttpRequest,p="addEventListener",m="removeEventListener";function v(e){var t=function(e){return(e||n.ee).get("events")}(e);if(h[t.debugId]++)return t;h[t.debugId]=1;var r=s(t,!0);function i(e){r.inPlace(e,[p,m],"-",o)}function o(e,t){return e[1]}return"getPrototypeOf"in Object&&(l.il&&b(document,i),b(l._A,i),b(g.prototype,i)),t.on(p+"-start",(function(e,t){var n=e[1];if(null!==n&&("function"==typeof n||"object"==typeof n)){var i=(0,f.X)(n,"nr@wrapped",(function(){var e={object:function(){if("function"!=typeof n.handleEvent)return;return n.handleEvent.apply(n,arguments)},function:n}[typeof n];return e?r(e,"fn-",null,e.name||"anonymous"):n}));this.wrapped=e[1]=i}})),t.on(m+"-start",(function(e){e[1]=this.wrapped||e[1]})),t}function b(e,t){let r=e;for(;"object"==typeof r&&!Object.prototype.hasOwnProperty.call(r,p);)r=Object.getPrototypeOf(r);for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];r&&t(r,...i)}var y="fetch-",w=y+"body-",x=["arrayBuffer","blob","json","text","formData"],A=l._A.Request,E=l._A.Response,T="prototype",_="nr@context";const D={};function N(e){const t=function(e){return(e||n.ee).get("fetch")}(e);if(!(A&&E&&l._A.fetch))return t;if(D[t.debugId]++)return t;function r(e,r,n){var i=e[r];"function"==typeof i&&(e[r]=function(){var e,r=[...arguments],o={};t.emit(n+"before-start",[r],o),o[_]&&o[_].dt&&(e=o[_].dt);var a=i.apply(this,r);return t.emit(n+"start",[r,e],a),a.then((function(e){return t.emit(n+"end",[null,e],a),e}),(function(e){throw t.emit(n+"end",[e],a),e}))})}return D[t.debugId]=1,x.forEach((e=>{r(A[T],e,w),r(E[T],e,w)})),r(l._A,"fetch",y),t.on(y+"end",(function(e,r){var n=this;if(r){var i=r.headers.get("content-length");null!==i&&(n.rxSize=i),t.emit(y+"done",[null,r],n)}else t.emit(y+"done",[e],n)})),t}const O={},j=["pushState","replaceState"];function S(e){const t=function(e){return(e||n.ee).get("history")}(e);return!l.il||O[t.debugId]++||(O[t.debugId]=1,s(t).inPlace(window.history,j,"-")),t}var P=r(3239);const C={},R=["appendChild","insertBefore","replaceChild"];function I(e){const t=function(e){return(e||n.ee).get("jsonp")}(e);if(!l.il||C[t.debugId])return t;C[t.debugId]=!0;var r=s(t),i=/[?&](?:callback|cb)=([^&#]+)/,o=/(.*)\.([^.]+)/,a=/^(\w+)(\.|$)(.*)$/;function c(e,t){var r=e.match(a),n=r[1],i=r[3];return i?c(i,t[n]):t[n]}return r.inPlace(Node.prototype,R,"dom-"),t.on("dom-start",(function(e){!function(e){if(!e||"string"!=typeof e.nodeName||"script"!==e.nodeName.toLowerCase())return;if("function"!=typeof e.addEventListener)return;var n=(a=e.src,s=a.match(i),s?s[1]:null);var a,s;if(!n)return;var u=function(e){var t=e.match(o);if(t&&t.length>=3)return{key:t[2],parent:c(t[1],window)};return{key:e,parent:window}}(n);if("function"!=typeof u.parent[u.key])return;var d={};function f(){t.emit("jsonp-end",[],d),e.removeEventListener("load",f,(0,P.m$)(!1)),e.removeEventListener("error",l,(0,P.m$)(!1))}function l(){t.emit("jsonp-error",[],d),t.emit("jsonp-end",[],d),e.removeEventListener("load",f,(0,P.m$)(!1)),e.removeEventListener("error",l,(0,P.m$)(!1))}r.inPlace(u.parent,[u.key],"cb-",d),e.addEventListener("load",f,(0,P.m$)(!1)),e.addEventListener("error",l,(0,P.m$)(!1)),t.emit("new-jsonp",[e.src],d)}(e[0])})),t}var k=r(5763);const H={};function L(e){const t=function(e){return(e||n.ee).get("mutation")}(e);if(!l.il||H[t.debugId])return t;H[t.debugId]=!0;var r=s(t),i=k.Yu.MO;return i&&(window.MutationObserver=function(e){return this instanceof i?new i(r(e,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype),t}const z={};function M(e){const t=function(e){return(e||n.ee).get("promise")}(e);if(z[t.debugId])return t;z[t.debugId]=!0;var r=n.c,o=s(t),a=k.Yu.PR;return a&&function(){function e(r){var n=t.context(),i=o(r,"executor-",n,null,!1);const s=Reflect.construct(a,[i],e);return t.context(s).getCtx=function(){return n},s}l._A.Promise=e,Object.defineProperty(e,"name",{value:"Promise"}),e.toString=function(){return a.toString()},Object.setPrototypeOf(e,a),["all","race"].forEach((function(r){const n=a[r];e[r]=function(e){let i=!1;[...e||[]].forEach((e=>{this.resolve(e).then(a("all"===r),a(!1))}));const o=n.apply(this,arguments);return o;function a(e){return function(){t.emit("propagate",[null,!i],o,!1,!1),i=i||!e}}}})),["resolve","reject"].forEach((function(r){const n=a[r];e[r]=function(e){const r=n.apply(this,arguments);return e!==r&&t.emit("propagate",[e,!0],r,!1,!1),r}})),e.prototype=a.prototype;const n=a.prototype.then;a.prototype.then=function(){var e=this,i=r(e);i.promise=e;for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];s[0]=o(s[0],"cb-",i,null,!1),s[1]=o(s[1],"cb-",i,null,!1);const u=n.apply(this,s);return i.nextPromise=u,t.emit("propagate",[e,!0],u,!1,!1),u},a.prototype.then[i]=n,t.on("executor-start",(function(e){e[0]=o(e[0],"resolve-",this,null,!1),e[1]=o(e[1],"resolve-",this,null,!1)})),t.on("executor-err",(function(e,t,r){e[1](r)})),t.on("cb-end",(function(e,r,n){t.emit("propagate",[n,!0],this.nextPromise,!1,!1)})),t.on("propagate",(function(e,r,n){this.getCtx&&!r||(this.getCtx=function(){if(e instanceof Promise)var r=t.context(e);return r&&r.getCtx?r.getCtx():this})}))}(),t}const B={},F="requestAnimationFrame";function U(e){const t=function(e){return(e||n.ee).get("raf")}(e);if(!l.il||B[t.debugId]++)return t;B[t.debugId]=1;var r=s(t);return r.inPlace(window,[F],"raf-"),t.on("raf-start",(function(e){e[0]=r(e[0],"fn-")})),t}const q={},G="setTimeout",V="setInterval",X="clearTimeout",W="-start",Z="-",$=[G,"setImmediate",V,X,"clearImmediate"];function Q(e){const t=function(e){return(e||n.ee).get("timer")}(e);if(q[t.debugId]++)return t;q[t.debugId]=1;var r=s(t);return r.inPlace(l._A,$.slice(0,2),G+Z),r.inPlace(l._A,$.slice(2,3),V+Z),r.inPlace(l._A,$.slice(3),X+Z),t.on(V+W,(function(e,t,n){e[0]=r(e[0],"fn-",null,n)})),t.on(G+W,(function(e,t,n){this.method=n,this.timerDuration=isNaN(e[1])?0:+e[1],e[0]=r(e[0],"fn-",this,n)})),t}var Y=r(50);const K={},J=["open","send"];function ee(e){var t=e||n.ee;const r=function(e){return(e||n.ee).get("xhr")}(t);if(K[r.debugId]++)return r;K[r.debugId]=1,v(t);var i=s(r),o=k.Yu.XHR,a=k.Yu.MO,c=k.Yu.PR,u=k.Yu.SI,d="readystatechange",f=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],h=[],g=l._A.XMLHttpRequest.listeners,p=l._A.XMLHttpRequest=function(e){var t=new o(e);function n(){try{r.emit("new-xhr",[t],t),t.addEventListener(d,b,(0,P.m$)(!1))}catch(e){(0,Y.Z)("An error occured while intercepting XHR",e);try{r.emit("internal-error",[e])}catch(e){}}}return this.listeners=g?[...g,n]:[n],this.listeners.forEach((e=>e())),t};function m(e,t){i.inPlace(t,["onreadystatechange"],"fn-",E)}function b(){var e=this,t=r.context(e);e.readyState>3&&!t.resolved&&(t.resolved=!0,r.emit("xhr-resolved",[],e)),i.inPlace(e,f,"fn-",E)}if(function(e,t){for(var r in e)t[r]=e[r]}(o,p),p.prototype=o.prototype,i.inPlace(p.prototype,J,"-xhr-",E),r.on("send-xhr-start",(function(e,t){m(e,t),function(e){h.push(e),a&&(y?y.then(A):u?u(A):(w=-w,x.data=w))}(t)})),r.on("open-xhr-start",m),a){var y=c&&c.resolve();if(!u&&!c){var w=1,x=document.createTextNode(w);new a(A).observe(x,{characterData:!0})}}else t.on("fn-end",(function(e){e[0]&&e[0].type===d||A()}));function A(){for(var e=0;e<h.length;e++)m(0,h[e]);h.length&&(h=[])}function E(e,t){return t}return r}},7825:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.ajax},6660:(e,t,r)=>{r.d(t,{A:()=>i,t:()=>n});const n=r(3325).D.jserrors,i="nr@seenError"},3081:(e,t,r)=>{r.d(t,{gF:()=>o,mY:()=>i,t9:()=>n,vz:()=>s,xS:()=>a});const n=r(3325).D.metrics,i="sm",o="cm",a="storeSupportabilityMetrics",s="storeEventMetrics"},4649:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.pageAction},7633:(e,t,r)=>{r.d(t,{Dz:()=>i,OJ:()=>a,qw:()=>o,t9:()=>n});const n=r(3325).D.pageViewEvent,i="firstbyte",o="domcontent",a="windowload"},9251:(e,t,r)=>{r.d(t,{t:()=>n});const n=r(3325).D.pageViewTiming},3614:(e,t,r)=>{r.d(t,{BST_RESOURCE:()=>i,END:()=>s,FEATURE_NAME:()=>n,FN_END:()=>u,FN_START:()=>c,PUSH_STATE:()=>d,RESOURCE:()=>o,START:()=>a});const n=r(3325).D.sessionTrace,i="bstResource",o="resource",a="-start",s="-end",c="fn"+a,u="fn"+s,d="pushState"},7836:(e,t,r)=>{r.d(t,{BODY:()=>A,CB_END:()=>E,CB_START:()=>u,END:()=>x,FEATURE_NAME:()=>i,FETCH:()=>_,FETCH_BODY:()=>v,FETCH_DONE:()=>m,FETCH_START:()=>p,FN_END:()=>c,FN_START:()=>s,INTERACTION:()=>l,INTERACTION_API:()=>d,INTERACTION_EVENTS:()=>o,JSONP_END:()=>b,JSONP_NODE:()=>g,JS_TIME:()=>T,MAX_TIMER_BUDGET:()=>a,REMAINING:()=>f,SPA_NODE:()=>h,START:()=>w,originalSetTimeout:()=>y});var n=r(5763);const i=r(3325).D.spa,o=["click","submit","keypress","keydown","keyup","change"],a=999,s="fn-start",c="fn-end",u="cb-start",d="api-ixn-",f="remaining",l="interaction",h="spaNode",g="jsonpNode",p="fetch-start",m="fetch-done",v="fetch-body-",b="jsonp-end",y=n.Yu.ST,w="-start",x="-end",A="-body",E="cb"+x,T="jsTime",_="fetch"},5938:(e,t,r)=>{r.d(t,{W:()=>o});var n=r(5763),i=r(2177);class o{constructor(e,t,r){this.agentIdentifier=e,this.aggregator=t,this.ee=i.ee.get(e,(0,n.OP)(this.agentIdentifier).isolatedBacklog),this.featureName=r,this.blocked=!1}}},9144:(e,t,r)=>{r.d(t,{j:()=>m});var n=r(3325),i=r(5763),o=r(5546),a=r(2177),s=r(7894),c=r(8e3),u=r(3960),d=r(385),f=r(50),l=r(3081),h=r(8632);function g(){const e=(0,h.gG)();["setErrorHandler","finished","addToTrace","inlineHit","addRelease","addPageAction","setCurrentRouteName","setPageViewName","setCustomAttribute","interaction","noticeError","setUserId"].forEach((t=>{e[t]=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];let o=[];return Object.values(e.initializedAgents).forEach((e=>{e.exposed&&e.api[t]&&o.push(e.api[t](...n))})),o.length>1?o:o[0]}(t,...n)}}))}var p=r(2587);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0,{init:b,info:y,loader_config:w,runtime:x={loaderType:m},exposed:A=!0}=t;const E=(0,h.gG)();y||(b=E.init,y=E.info,w=E.loader_config),(0,i.Dg)(e,b||{}),(0,i.GE)(e,w||{}),(0,i.sU)(e,x),y.jsAttributes??={},d.v6&&(y.jsAttributes.isWorker=!0),(0,i.CX)(e,y),g();const T=function(e,t){t||(0,c.R)(e,"api");const h={};var g=a.ee.get(e),p=g.get("tracer"),m="api-",v=m+"ixn-";function b(t,r,n,o){const a=(0,i.C5)(e);return null===r?delete a.jsAttributes[t]:(0,i.CX)(e,{...a,jsAttributes:{...a.jsAttributes,[t]:r}}),x(m,n,!0,o||null===r?"session":void 0)(t,r)}function y(){}["setErrorHandler","finished","addToTrace","inlineHit","addRelease"].forEach((e=>h[e]=x(m,e,!0,"api"))),h.addPageAction=x(m,"addPageAction",!0,n.D.pageAction),h.setCurrentRouteName=x(m,"routeName",!0,n.D.spa),h.setPageViewName=function(t,r){if("string"==typeof t)return"/"!==t.charAt(0)&&(t="/"+t),(0,i.OP)(e).customTransaction=(r||"http://custom.transaction")+t,x(m,"setPageViewName",!0)()},h.setCustomAttribute=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){if(["string","number"].includes(typeof t)||null===t)return b(e,t,"setCustomAttribute",r);(0,f.Z)("Failed to execute setCustomAttribute.\nNon-null value must be a string or number type, but a type of <".concat(typeof t,"> was provided."))}else(0,f.Z)("Failed to execute setCustomAttribute.\nName must be a string type, but a type of <".concat(typeof e,"> was provided."))},h.setUserId=function(e){if("string"==typeof e||null===e)return b("enduser.id",e,"setUserId",!0);(0,f.Z)("Failed to execute setUserId.\nNon-null value must be a string type, but a type of <".concat(typeof e,"> was provided."))},h.interaction=function(){return(new y).get()};var w=y.prototype={createTracer:function(e,t){var r={},i=this,a="function"==typeof t;return(0,o.p)(v+"tracer",[(0,s.z)(),e,r],i,n.D.spa,g),function(){if(p.emit((a?"":"no-")+"fn-start",[(0,s.z)(),i,a],r),a)try{return t.apply(this,arguments)}catch(e){throw p.emit("fn-err",[arguments,this,"string"==typeof e?new Error(e):e],r),e}finally{p.emit("fn-end",[(0,s.z)()],r)}}}};function x(e,t,r,i){return function(){return(0,o.p)(l.xS,["API/"+t+"/called"],void 0,n.D.metrics,g),i&&(0,o.p)(e+t,[(0,s.z)(),...arguments],r?null:this,i,g),r?void 0:this}}function A(){r.e(439).then(r.bind(r,7438)).then((t=>{let{setAPI:r}=t;r(e),(0,c.L)(e,"api")})).catch((()=>(0,f.Z)("Downloading runtime APIs failed...")))}return["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach((e=>{w[e]=x(v,e,void 0,n.D.spa)})),h.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),(0,o.p)(l.xS,["API/noticeError/called"],void 0,n.D.metrics,g),(0,o.p)("err",[e,(0,s.z)(),!1,t],void 0,n.D.jserrors,g)},d.il?(0,u.b)((()=>A()),!0):A(),h}(e,v);return(0,h.Qy)(e,T,"api"),(0,h.Qy)(e,A,"exposed"),(0,h.EZ)("activatedFeatures",p.T),T}},3325:(e,t,r)=>{r.d(t,{D:()=>n,p:()=>i});const n={ajax:"ajax",jserrors:"jserrors",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",spa:"spa"},i={[n.pageViewEvent]:1,[n.pageViewTiming]:2,[n.metrics]:3,[n.jserrors]:4,[n.ajax]:5,[n.sessionTrace]:6,[n.pageAction]:7,[n.spa]:8,[n.sessionReplay]:9}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>(({78:"page_action-aggregate",147:"metrics-aggregate",242:"session-manager",317:"jserrors-aggregate",348:"page_view_timing-aggregate",412:"lazy-feature-loader",439:"async-api",538:"recorder",590:"session_replay-aggregate",675:"compressor",733:"session_trace-aggregate",786:"page_view_event-aggregate",873:"spa-aggregate",898:"ajax-aggregate"}[e]||e)+"."+{78:"ac76d497",147:"3dc53903",148:"1a20d5fe",242:"2a64278a",317:"49e41428",348:"bd6de33a",412:"2f55ce66",439:"30bd804e",538:"1b18459f",590:"cf0efb30",675:"ae9f91a8",733:"83105561",786:"06482edd",860:"03a8b7a5",873:"e6b09d52",898:"998ef92b"}[e]+"-1.236.0.min.js"),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA:",i.l=(r,n,o,a)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var f=u[d];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+o){s=f;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[n];var l=(t,n)=>{s.onerror=s.onload=null,clearTimeout(h);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(l.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=l.bind(null,s.onerror),s.onload=l.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=364,i.p="https://js-agent.newrelic.com/",(()=>{var e={364:0,953:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<a.length;u++)o=a[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=window.webpackChunkNRBA=window.webpackChunkNRBA||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o={};(()=>{i.r(o);var e=i(3325),t=i(5763);const r=Object.values(e.D);function n(e){const n={};return r.forEach((r=>{n[r]=function(e,r){return!1!==(0,t.Mt)(r,"".concat(e,".enabled"))}(r,e)})),n}var a=i(9144);var s=i(5546),c=i(385),u=i(8e3),d=i(5938),f=i(3960),l=i(50);class h extends d.W{constructor(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(e,t,r),this.auto=n,this.abortHandler,this.featAggregate,this.onAggregateImported,n&&(0,u.R)(e,r)}importAggregator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.featAggregate||!this.auto)return;const r=c.il&&!0===(0,t.Mt)(this.agentIdentifier,"privacy.cookies_enabled");let n;this.onAggregateImported=new Promise((e=>{n=e}));const o=async()=>{let t;try{if(r){const{setupAgentSession:e}=await Promise.all([i.e(860),i.e(242)]).then(i.bind(i,3228));t=e(this.agentIdentifier)}}catch(e){(0,l.Z)("A problem occurred when starting up session manager. This page will not start or extend any session.",e)}try{if(!this.shouldImportAgg(this.featureName,t))return void(0,u.L)(this.agentIdentifier,this.featureName);const{lazyFeatureLoader:r}=await i.e(412).then(i.bind(i,8582)),{Aggregate:o}=await r(this.featureName,"aggregate");this.featAggregate=new o(this.agentIdentifier,this.aggregator,e),n(!0)}catch(e){(0,l.Z)("Downloading and initializing ".concat(this.featureName," failed..."),e),this.abortHandler?.(),n(!1)}};c.il?(0,f.b)((()=>o()),!0):o()}shouldImportAgg(r,n){return r!==e.D.sessionReplay||!1!==(0,t.Mt)(this.agentIdentifier,"session_trace.enabled")&&(!!n?.isNew||!!n?.state.sessionReplay)}}var g=i(7633),p=i(7894);class m extends h{static featureName=g.t9;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(super(r,n,g.t9,i),("undefined"==typeof PerformanceNavigationTiming||c.Tt)&&"undefined"!=typeof PerformanceTiming){const n=(0,t.OP)(r);n[g.Dz]=Math.max(Date.now()-n.offset,0),(0,f.K)((()=>n[g.qw]=Math.max((0,p.z)()-n[g.Dz],0))),(0,f.b)((()=>{const t=(0,p.z)();n[g.OJ]=Math.max(t-n[g.Dz],0),(0,s.p)("timing",["load",t],void 0,e.D.pageViewTiming,this.ee)}))}this.importAggregator()}}var v=i(1117),b=i(1284);class y extends v.w{constructor(e){super(e),this.aggregatedData={}}store(e,t,r,n,i){var o=this.getBucket(e,t,r,i);return o.metrics=function(e,t){t||(t={count:0});return t.count+=1,(0,b.D)(e,(function(e,r){t[e]=w(r,t[e])})),t}(n,o.metrics),o}merge(e,t,r,n,i){var o=this.getBucket(e,t,n,i);if(o.metrics){var a=o.metrics;a.count+=r.count,(0,b.D)(r,(function(e,t){if("count"!==e){var n=a[e],i=r[e];i&&!i.c?a[e]=w(i.t,n):a[e]=function(e,t){if(!t)return e;t.c||(t=x(t.t));return t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max),t.t+=e.t,t.sos+=e.sos,t.c+=e.c,t}(i,a[e])}}))}else o.metrics=r}storeMetric(e,t,r,n){var i=this.getBucket(e,t,r);return i.stats=w(n,i.stats),i}getBucket(e,t,r,n){this.aggregatedData[e]||(this.aggregatedData[e]={});var i=this.aggregatedData[e][t];return i||(i=this.aggregatedData[e][t]={params:r||{}},n&&(i.custom=n)),i}get(e,t){return t?this.aggregatedData[e]&&this.aggregatedData[e][t]:this.aggregatedData[e]}take(e){for(var t={},r="",n=!1,i=0;i<e.length;i++)t[r=e[i]]=A(this.aggregatedData[r]),t[r].length&&(n=!0),delete this.aggregatedData[r];return n?t:null}}function w(e,t){return null==e?function(e){e?e.c++:e={c:1};return e}(t):t?(t.c||(t=x(t.t)),t.c+=1,t.t+=e,t.sos+=e*e,e>t.max&&(t.max=e),e<t.min&&(t.min=e),t):{t:e}}function x(e){return{t:e,min:e,max:e,sos:e*e,c:1}}function A(e){return"object"!=typeof e?[]:(0,b.D)(e,E)}function E(e,t){return t}var T=i(8632),_=i(4402),D=i(4351);var N=i(7956),O=i(3239),j=i(9251);class S extends h{static featureName=j.t;constructor(e,r){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,r,j.t,n),c.il&&((0,t.OP)(e).initHidden=Boolean("hidden"===document.visibilityState),(0,N.N)((()=>(0,s.p)("docHidden",[(0,p.z)()],void 0,j.t,this.ee)),!0),(0,O.bP)("pagehide",(()=>(0,s.p)("winPagehide",[(0,p.z)()],void 0,j.t,this.ee))),this.importAggregator())}}var P=i(3081);class C extends h{static featureName=P.t9;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,P.t9,r),this.importAggregator()}}var R,I=i(2210),k=i(1214),H=i(2177),L={};try{R=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(L.console=!0,-1!==R.indexOf("dev")&&(L.dev=!0),-1!==R.indexOf("nr_dev")&&(L.nrDev=!0))}catch(e){}function z(e){try{L.console&&z(e)}catch(e){}}L.nrDev&&H.ee.on("internal-error",(function(e){z(e.stack)})),L.dev&&H.ee.on("fn-err",(function(e,t,r){z(r.stack)})),L.dev&&(z("NR AGENT IN DEVELOPMENT MODE"),z("flags: "+(0,b.D)(L,(function(e,t){return e})).join(", ")));var M=i(6660);class B extends h{static featureName=M.t;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(r,n,M.t,i),this.skipNext=0;try{this.removeOnAbort=new AbortController}catch(e){}const o=this;o.ee.on("fn-start",(function(e,t,r){o.abortHandler&&(o.skipNext+=1)})),o.ee.on("fn-err",(function(t,r,n){o.abortHandler&&!n[M.A]&&((0,I.X)(n,M.A,(function(){return!0})),this.thrown=!0,(0,s.p)("err",[n,(0,p.z)()],void 0,e.D.jserrors,o.ee))})),o.ee.on("fn-end",(function(){o.abortHandler&&!this.thrown&&o.skipNext>0&&(o.skipNext-=1)})),o.ee.on("internal-error",(function(t){(0,s.p)("ierr",[t,(0,p.z)(),!0],void 0,e.D.jserrors,o.ee)})),this.origOnerror=c._A.onerror,c._A.onerror=this.onerrorHandler.bind(this),c._A.addEventListener("unhandledrejection",(t=>{const r=function(e){let t="Unhandled Promise Rejection: ";if(e instanceof Error)try{return e.message=t+e.message,e}catch(t){return e}if(void 0===e)return new Error(t);try{return new Error(t+(0,D.P)(e))}catch(e){return new Error(t)}}(t.reason);(0,s.p)("err",[r,(0,p.z)(),!1,{unhandledPromiseRejection:1}],void 0,e.D.jserrors,this.ee)}),(0,O.m$)(!1,this.removeOnAbort?.signal)),(0,k.gy)(this.ee),(0,k.BV)(this.ee),(0,k.em)(this.ee),(0,t.OP)(r).xhrWrappable&&(0,k.Kf)(this.ee),this.abortHandler=this.#e,this.importAggregator()}#e(){this.removeOnAbort?.abort(),this.abortHandler=void 0}onerrorHandler(t,r,n,i,o){"function"==typeof this.origOnerror&&this.origOnerror(...arguments);try{this.skipNext?this.skipNext-=1:(0,s.p)("err",[o||new F(t,r,n),(0,p.z)()],void 0,e.D.jserrors,this.ee)}catch(t){try{(0,s.p)("ierr",[t,(0,p.z)(),!0],void 0,e.D.jserrors,this.ee)}catch(e){}}return!1}}function F(e,t,r){this.message=e||"Uncaught error with no additional information",this.sourceURL=t,this.line=r}let U=1;const q="nr@id";function G(e){const t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===c._A?0:(0,I.X)(e,q,(function(){return U++}))}function V(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return(0,D.P)(e).length}catch(e){return}}}var X=i(7243);class W{constructor(e){this.agentIdentifier=e,this.generateTracePayload=this.generateTracePayload.bind(this),this.shouldGenerateTrace=this.shouldGenerateTrace.bind(this)}generateTracePayload(e){if(!this.shouldGenerateTrace(e))return null;var r=(0,t.DL)(this.agentIdentifier);if(!r)return null;var n=(r.accountID||"").toString()||null,i=(r.agentID||"").toString()||null,o=(r.trustKey||"").toString()||null;if(!n||!i)return null;var a=(0,_.M)(),s=(0,_.Ht)(),c=Date.now(),u={spanId:a,traceId:s,timestamp:c};return(e.sameOrigin||this.isAllowedOrigin(e)&&this.useTraceContextHeadersForCors())&&(u.traceContextParentHeader=this.generateTraceContextParentHeader(a,s),u.traceContextStateHeader=this.generateTraceContextStateHeader(a,c,n,i,o)),(e.sameOrigin&&!this.excludeNewrelicHeader()||!e.sameOrigin&&this.isAllowedOrigin(e)&&this.useNewrelicHeaderForCors())&&(u.newrelicHeader=this.generateTraceHeader(a,s,c,n,i,o)),u}generateTraceContextParentHeader(e,t){return"00-"+t+"-"+e+"-01"}generateTraceContextStateHeader(e,t,r,n,i){return i+"@nr=0-1-"+r+"-"+n+"-"+e+"----"+t}generateTraceHeader(e,t,r,n,i,o){if(!("function"==typeof c._A?.btoa))return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:i,id:e,tr:t,ti:r}};return o&&n!==o&&(a.d.tk=o),btoa((0,D.P)(a))}shouldGenerateTrace(e){return this.isDtEnabled()&&this.isAllowedOrigin(e)}isAllowedOrigin(e){var r=!1,n={};if((0,t.Mt)(this.agentIdentifier,"distributed_tracing")&&(n=(0,t.P_)(this.agentIdentifier).distributed_tracing),e.sameOrigin)r=!0;else if(n.allowed_origins instanceof Array)for(var i=0;i<n.allowed_origins.length;i++){var o=(0,X.e)(n.allowed_origins[i]);if(e.hostname===o.hostname&&e.protocol===o.protocol&&e.port===o.port){r=!0;break}}return r}isDtEnabled(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.enabled}excludeNewrelicHeader(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.exclude_newrelic_header}useNewrelicHeaderForCors(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!1!==e.cors_use_newrelic_header}useTraceContextHeadersForCors(){var e=(0,t.Mt)(this.agentIdentifier,"distributed_tracing");return!!e&&!!e.cors_use_tracecontext_headers}}var Z=i(7825),$=["load","error","abort","timeout"],Q=$.length,Y=t.Yu.REQ,K=c._A.XMLHttpRequest;class J extends h{static featureName=Z.t;constructor(r,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(r,n,Z.t,i),(0,t.OP)(r).xhrWrappable&&(this.dt=new W(r),this.handler=(e,t,r,n)=>(0,s.p)(e,t,r,n,this.ee),(0,k.u5)(this.ee),(0,k.Kf)(this.ee),function(r,n,i,o){function a(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=E,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,t.params=this.params||{},t.metrics=this.metrics||{},e.addEventListener("load",(function(r){_(t,e)}),(0,O.m$)(!1)),c.IF||e.addEventListener("progress",(function(e){t.lastSize=e.loaded}),(0,O.m$)(!1))}function s(e){this.params={method:e[0]},T(this,e[1]),this.metrics={}}function u(e,n){var i=(0,t.DL)(r);i.xpid&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",i.xpid);var a=o.generateTracePayload(this.parsedOrigin);if(a){var s=!1;a.newrelicHeader&&(n.setRequestHeader("newrelic",a.newrelicHeader),s=!0),a.traceContextParentHeader&&(n.setRequestHeader("traceparent",a.traceContextParentHeader),a.traceContextStateHeader&&n.setRequestHeader("tracestate",a.traceContextStateHeader),s=!0),s&&(this.dt=a)}}function d(e,t){var r=this.metrics,i=e[0],o=this;if(r&&i){var a=V(i);a&&(r.txSize=a)}this.startTime=(0,p.z)(),this.listener=function(e){try{"abort"!==e.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==e.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof t.onload)&&"function"==typeof o.end)&&o.end(t)}catch(e){try{n.emit("internal-error",[e])}catch(e){}}};for(var s=0;s<Q;s++)t.addEventListener($[s],this.listener,(0,O.m$)(!1))}function f(e,t,r){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof r.onload||"function"!=typeof this.end||this.end(r)}function l(e,t){var r=""+G(e)+!!t;this.xhrGuids&&!this.xhrGuids[r]&&(this.xhrGuids[r]=!0,this.totalCbs+=1)}function h(e,t){var r=""+G(e)+!!t;this.xhrGuids&&this.xhrGuids[r]&&(delete this.xhrGuids[r],this.totalCbs-=1)}function g(){this.endTime=(0,p.z)()}function m(e,t){t instanceof K&&"load"===e[0]&&n.emit("xhr-load-added",[e[1],e[2]],t)}function v(e,t){t instanceof K&&"load"===e[0]&&n.emit("xhr-load-removed",[e[1],e[2]],t)}function b(e,t,r){t instanceof K&&("onload"===r&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=(0,p.z)()))}function y(e,t){this.xhrCbStart&&n.emit("xhr-cb-time",[(0,p.z)()-this.xhrCbStart,this.onload,t],t)}function w(e){var t,r=e[1]||{};"string"==typeof e[0]?t=e[0]:e[0]&&e[0].url?t=e[0].url:c._A?.URL&&e[0]&&e[0]instanceof URL&&(t=e[0].href),t&&(this.parsedOrigin=(0,X.e)(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var n=o.generateTracePayload(this.parsedOrigin);if(n&&(n.newrelicHeader||n.traceContextParentHeader))if("string"==typeof e[0]||c._A?.URL&&e[0]&&e[0]instanceof URL){var i={};for(var a in r)i[a]=r[a];i.headers=new Headers(r.headers||{}),s(i.headers,n)&&(this.dt=n),e.length>1?e[1]=i:e.push(i)}else e[0]&&e[0].headers&&s(e[0].headers,n)&&(this.dt=n);function s(e,t){var r=!1;return t.newrelicHeader&&(e.set("newrelic",t.newrelicHeader),r=!0),t.traceContextParentHeader&&(e.set("traceparent",t.traceContextParentHeader),t.traceContextStateHeader&&e.set("tracestate",t.traceContextStateHeader),r=!0),r}}function x(e,t){this.params={},this.metrics={},this.startTime=(0,p.z)(),this.dt=t,e.length>=1&&(this.target=e[0]),e.length>=2&&(this.opts=e[1]);var r,n=this.opts||{},i=this.target;"string"==typeof i?r=i:"object"==typeof i&&i instanceof Y?r=i.url:c._A?.URL&&"object"==typeof i&&i instanceof URL&&(r=i.href),T(this,r);var o=(""+(i&&i instanceof Y&&i.method||n.method||"GET")).toUpperCase();this.params.method=o,this.txSize=V(n.body)||0}function A(t,r){var n;this.endTime=(0,p.z)(),this.params||(this.params={}),this.params.status=r?r.status:0,"string"==typeof this.rxSize&&this.rxSize.length>0&&(n=+this.rxSize);var o={txSize:this.txSize,rxSize:n,duration:(0,p.z)()-this.startTime};i("xhr",[this.params,o,this.startTime,this.endTime,"fetch"],this,e.D.ajax)}function E(t){var r=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var o=0;o<Q;o++)t.removeEventListener($[o],this.listener,!1);r.aborted||(n.duration=(0,p.z)()-this.startTime,this.loadCaptureCalled||4!==t.readyState?null==r.status&&(r.status=0):_(this,t),n.cbTime=this.cbTime,i("xhr",[r,n,this.startTime,this.endTime,"xhr"],this,e.D.ajax))}}function T(e,t){var r=(0,X.e)(t),n=e.params;n.hostname=r.hostname,n.port=r.port,n.protocol=r.protocol,n.host=r.hostname+":"+r.port,n.pathname=r.pathname,e.parsedOrigin=r,e.sameOrigin=r.sameOrigin}function _(e,t){e.params.status=t.status;var r=function(e,t){var r=e.responseType;return"json"===r&&null!==t?t:"arraybuffer"===r||"blob"===r||"json"===r?V(e.response):"text"===r||""===r||void 0===r?V(e.responseText):void 0}(t,e.lastSize);if(r&&(e.metrics.rxSize=r),e.sameOrigin){var n=t.getResponseHeader("X-NewRelic-App-Data");n&&(e.params.cat=n.split(", ").pop())}e.loadCaptureCalled=!0}n.on("new-xhr",a),n.on("open-xhr-start",s),n.on("open-xhr-end",u),n.on("send-xhr-start",d),n.on("xhr-cb-time",f),n.on("xhr-load-added",l),n.on("xhr-load-removed",h),n.on("xhr-resolved",g),n.on("addEventListener-end",m),n.on("removeEventListener-end",v),n.on("fn-end",y),n.on("fetch-before-start",w),n.on("fetch-start",x),n.on("fn-start",b),n.on("fetch-done",A)}(r,this.ee,this.handler,this.dt),this.importAggregator())}}var ee=i(3614);const{BST_RESOURCE:te,RESOURCE:re,START:ne,END:ie,FEATURE_NAME:oe,FN_END:ae,FN_START:se,PUSH_STATE:ce}=ee;var ue=i(7836);const{FEATURE_NAME:de,START:fe,END:le,BODY:he,CB_END:ge,JS_TIME:pe,FETCH:me,FN_START:ve,CB_START:be,FN_END:ye}=ue;var we=i(4649);class xe extends h{static featureName=we.t;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,we.t,r),this.importAggregator()}}new class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,_.ky)(16);c._A?(this.agentIdentifier=t,this.sharedAggregator=new y({agentIdentifier:this.agentIdentifier}),this.features={},this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(m),Object.assign(this,(0,a.j)(this.agentIdentifier,e,e.loaderType||"agent")),this.start()):(0,l.Z)("Failed to initial the agent. Could not determine the runtime environment.")}get config(){return{info:(0,t.C5)(this.agentIdentifier),init:(0,t.P_)(this.agentIdentifier),loader_config:(0,t.DL)(this.agentIdentifier),runtime:(0,t.OP)(this.agentIdentifier)}}start(){const t="features";try{const r=n(this.agentIdentifier),i=[...this.desiredFeatures];i.sort(((t,r)=>e.p[t.featureName]-e.p[r.featureName])),i.forEach((t=>{if(r[t.featureName]||t.featureName===e.D.pageViewEvent){const n=function(t){switch(t){case e.D.ajax:return[e.D.jserrors];case e.D.sessionTrace:return[e.D.ajax,e.D.pageViewEvent];case e.D.sessionReplay:return[e.D.sessionTrace];case e.D.pageViewTiming:return[e.D.pageViewEvent];default:return[]}}(t.featureName);n.every((e=>r[e]))||(0,l.Z)("".concat(t.featureName," is enabled but one or more dependent features has been disabled (").concat((0,D.P)(n),"). This may cause unintended consequences or missing data...")),this.features[t.featureName]=new t(this.agentIdentifier,this.sharedAggregator)}})),(0,T.Qy)(this.agentIdentifier,this.features,t)}catch(e){(0,l.Z)("Failed to initialize all enabled instrument classes (agent aborted) -",e);for(const e in this.features)this.features[e].abortHandler?.();const r=(0,T.fP)();return delete r.initializedAgents[this.agentIdentifier]?.api,delete r.initializedAgents[this.agentIdentifier]?.[t],delete this.sharedAggregator,r.ee?.abort(),delete r.ee?.get(this.agentIdentifier),!1}}}({features:[J,m,S,class extends h{static featureName=oe;constructor(t,r){if(super(t,r,oe,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),!c.il)return;const n=this.ee;let i;(0,k.QU)(n),this.eventsEE=(0,k.em)(n),this.eventsEE.on(se,(function(e,t){this.bstStart=(0,p.z)()})),this.eventsEE.on(ae,(function(t,r){(0,s.p)("bst",[t[0],r,this.bstStart,(0,p.z)()],void 0,e.D.sessionTrace,n)})),n.on(ce+ne,(function(e){this.time=(0,p.z)(),this.startPath=location.pathname+location.hash})),n.on(ce+ie,(function(t){(0,s.p)("bstHist",[location.pathname+location.hash,this.startPath,this.time],void 0,e.D.sessionTrace,n)}));try{i=new PerformanceObserver((t=>{const r=t.getEntries();(0,s.p)(te,[r],void 0,e.D.sessionTrace,n)})),i.observe({type:re,buffered:!0})}catch(e){}this.importAggregator({resourceObserver:i})}},C,xe,B,class extends h{static featureName=de;constructor(e,r){if(super(e,r,de,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),!c.il)return;if(!(0,t.OP)(e).xhrWrappable)return;try{this.removeOnAbort=new AbortController}catch(e){}let n,i=0;const o=this.ee.get("tracer"),a=(0,k._L)(this.ee),s=(0,k.Lg)(this.ee),u=(0,k.BV)(this.ee),d=(0,k.Kf)(this.ee),f=this.ee.get("events"),l=(0,k.u5)(this.ee),h=(0,k.QU)(this.ee),g=(0,k.Gm)(this.ee);function m(e,t){h.emit("newURL",[""+window.location,t])}function v(){i++,n=window.location.hash,this[ve]=(0,p.z)()}function b(){i--,window.location.hash!==n&&m(0,!0);var e=(0,p.z)();this[pe]=~~this[pe]+e-this[ve],this[ye]=e}function y(e,t){e.on(t,(function(){this[t]=(0,p.z)()}))}this.ee.on(ve,v),s.on(be,v),a.on(be,v),this.ee.on(ye,b),s.on(ge,b),a.on(ge,b),this.ee.buffer([ve,ye,"xhr-resolved"],this.featureName),f.buffer([ve],this.featureName),u.buffer(["setTimeout"+le,"clearTimeout"+fe,ve],this.featureName),d.buffer([ve,"new-xhr","send-xhr"+fe],this.featureName),l.buffer([me+fe,me+"-done",me+he+fe,me+he+le],this.featureName),h.buffer(["newURL"],this.featureName),g.buffer([ve],this.featureName),s.buffer(["propagate",be,ge,"executor-err","resolve"+fe],this.featureName),o.buffer([ve,"no-"+ve],this.featureName),a.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"],this.featureName),y(l,me+fe),y(l,me+"-done"),y(a,"new-jsonp"),y(a,"jsonp-end"),y(a,"cb-start"),h.on("pushState-end",m),h.on("replaceState-end",m),window.addEventListener("hashchange",m,(0,O.m$)(!0,this.removeOnAbort?.signal)),window.addEventListener("load",m,(0,O.m$)(!0,this.removeOnAbort?.signal)),window.addEventListener("popstate",(function(){m(0,i>1)}),(0,O.m$)(!0,this.removeOnAbort?.signal)),this.abortHandler=this.#e,this.importAggregator()}#e(){this.removeOnAbort?.abort(),this.abortHandler=void 0}}],loaderType:"spa"})})(),window.NRBA=o})();</script><meta charset="UTF-8"/><meta name="robots" content="index, follow"/><meta name="DC.Creator" content="Riley J. Hickman"/><meta name="DC.Creator" content="Matteo Aldeghi"/><meta name="DC.Creator" content="Florian Häse"/><meta name="DC.Creator" content="Alán Aspuru-Guzik"/><meta name="DC.title" content="Bayesian optimization with known experimental and design constraints for chemistry applications  "/><meta name="DC.publisher" content="Royal Society of Chemistry"/><meta name="DC.Date" content="2022/10/10"/><meta name="DC.Identifier" scheme="doi" content="10.1039/D2DD00028H"/><meta name="DC.Language" content="en"/><meta name="citation_title" content="Bayesian optimization with known experimental and design constraints for chemistry applications  "/><meta name="citation_author" content="Riley J. Hickman"/><meta name="citation_author" content="Matteo Aldeghi"/><meta name="citation_author" content="Florian Häse"/><meta name="citation_author" content="Alán Aspuru-Guzik"/><meta name="citation_online_date" content="2022/09/14"/><meta name="citation_date" content="2022"/><meta name="citation_journal_title" content="Digital Discovery"/><meta name="citation_volume" content="1"/><meta name="citation_issue" content="5"/><meta name="citation_firstpage" content="732"/><meta name="citation_lastpage" content="744"/><meta name="citation_doi" content="10.1039/D2DD00028H"/><meta name="citation_pdf_url" content="https://pubs.rsc.org/en/content/articlepdf/2022/dd/d2dd00028h"/><meta name="citation_abstract_html_url" content="https://pubs.rsc.org/en/content/articlelanding/2022/dd/d2dd00028h"/><meta name="citation_fulltext_html_url" content="https://pubs.rsc.org/en/content/articlehtml/2022/dd/d2dd00028h"/><link rel="shortcut icon" href=""/><link type="text/css" rel="stylesheet" href="/content/stylesheets/rschtml2.css?ver=6_2_1"/><link href="https://www.rsc-cdn.org/oxygen/assets/webfonts/fonts.min.css" rel="stylesheet" type="text/css"/><link type="text/css" rel="stylesheet" href="/content/stylesheets/pubs-ui.min.css"/><meta name="viewport" content="width=device-width, initial-scale=1"/><script type="text/javascript" src="/content/scripts/JQueryPlugins.min.js"> </script><script type="text/javascript" src="/content/scripts/GetAnchorText.js"> </script><script type="text/javascript">
    
      $(function() {
      $("table.tgroup tfoot th").attr("colspan", "100");
      $("table.tgroup.rtable").each( function (idx, el) {
      var tw = $(this).width();
      $(this).parent().css("min-width", tw+"px");
      });

      });
      
    </script><!--6_2_1--></head><body class="oxy-ui pubs-ui ahtml-page"><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-56FZ7G" height="0" width="0" style="display:none;visibility:hidden"> </iframe></noscript><!--End Google Tag Manager (noscript)--><div class="viewport autopad"><div class="pnl pnl--drop autopad"><span id="top"/><div id="wrapper"><div class="left_head"><a class="simple" href="/"><img class="rsc-logo" border="0" src="/content/NewImages/royal-society-of-chemistry-logo.png" alt="Royal Society of Chemistry"/></a><br/><span class="btnContainer"><a class="btn btn--tiny btn--primary" target="_blank" title="Link to PDF version" href="/en/content/articlepdf/2022/dd/d2dd00028h">View PDF Version</a></span><span class="btnContainer"><a class="btn btn--tiny btn--nobg" title="Link to previous article (id:d1dd00036e)" href="/en/content/articlehtml/2022/dd/d1dd00036e" target="_BLANK">Previous Article</a></span><span class="btnContainer"><a class="btn btn--tiny btn--nobg" title="Link to next article (id:d2dd90020c)" href="/en/content/articlehtml/2022/dd/d2dd90020c" target="_BLANK">Next Article</a></span></div><div class="right_head"><div id="crossmark_container"><div id="crossmark-content"><a id="open-crossmark" href="#" data-target="crossmark"><img style="max-width:100px" id="crossmark-logo" src="https://crossmark-cdn.crossref.org/widget/v2.0/logos/CROSSMARK_Color_square.svg" alt="Check for updates"/></a><script src="https://crossmark-cdn.crossref.org/widget/v2.0/widget.js"> </script></div></div><br/><span class="oa"><img src="/content/newimages/open_access_blue.png" alt=""/> Open Access Article<br/><img src="/content/newimages/CCBY.svg" alt=""/>
This Open Access Article is licensed under a <br/><a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported Licence</a></span></div><div class="article_info"> DOI: <a target="_blank" title="Link to landing page via DOI" href="https://doi.org/10.1039/D2DD00028H">10.1039/D2DD00028H</a>
(Paper)
<span class="italic"><a title="Link to journal home page" href="https://doi.org/10.1039/2635-098X/2022">Digital Discovery</a></span>, 2022, <strong>1</strong>, 732-744</div><h1 id="sect219"><span class="title_heading">Bayesian optimization with known experimental and design constraints for chemistry applications<a title="Select to navigate to footnote" href="#fn1">†</a></span></h1><p class="header_text">
      <span class="bold">
        
          
            Riley J. 
            Hickman<a title="Select to navigate to footnote" href="#fn2">‡</a>
          
        
        
      </span><sup><span class="sup_ref italic">ab</span></sup>, 
      <span class="bold">
        
          
            Matteo 
            Aldeghi<a title="Select to navigate to footnote" href="#fn2">‡</a>
          
        
      </span><span class="orcid"><a target="_blank" title="Select to open ORCID record for Matteo Aldeghi (orcid.org/0000-0003-0019-8806) in a new window" id="connect-orcid-link" href="http://orcid.org/0000-0003-0019-8806"><img id="orcid-id-logo" src="/content/NewImages/orcid_16x16.png" alt="ORCID logo"/></a></span><sup><span class="sup_ref italic">abcd</span></sup>, 
      <span class="bold">
        
          
            Florian 
            Häse
          
        
      </span><sup><span class="sup_ref italic">abce</span></sup><span class="bold"> and </span>
      <span class="bold">
        
          
            Alán 
            Aspuru-Guzik
          
        
      </span>*<sup><span class="sup_ref italic">abcfgh</span></sup>
      <br/><a id="affa"><sup><span class="sup_ref italic">a</span></sup></a><span class="italic">Chemical Physics Theory Group, Department of Chemistry, University of Toronto, Toronto, ON M5S 3H6, Canada. E-mail: <a href="mailto:alan@aspuru.com">alan@aspuru.com</a></span>
      <br/><a id="affb"><sup><span class="sup_ref italic">b</span></sup></a><span class="italic">Department of Computer Science, University of Toronto, Toronto, ON M5S 3G4, Canada</span>
      <br/><a id="affc"><sup><span class="sup_ref italic">c</span></sup></a><span class="italic">Vector Institute for Artificial Intelligence, Toronto, ON M5S 1M1, Canada</span>
      <br/><a id="affd"><sup><span class="sup_ref italic">d</span></sup></a><span class="italic">Department of Chemical Engineering, Massachusetts Institute of Technology, Cambridge, MA 02139, USA</span>
      <br/><a id="affe"><sup><span class="sup_ref italic">e</span></sup></a><span class="italic">Department of Chemistry and Chemical Biology, Harvard University, Cambridge, MA 02138, USA</span>
      <br/><a id="afff"><sup><span class="sup_ref italic">f</span></sup></a><span class="italic">Department of Chemical Engineering &amp; Applied Chemistry, University of Toronto, Toronto, ON M5S 3E5, Canada</span>
      <br/><a id="affg"><sup><span class="sup_ref italic">g</span></sup></a><span class="italic">Department of Materials Science &amp; Engineering, University of Toronto, Toronto, ON M5S 3E4, Canada</span>
      <br/><a id="affh"><sup><span class="sup_ref italic">h</span></sup></a><span class="italic">Lebovic Fellow, Canadian Institute for Advanced Research, Toronto, ON M5G 1Z8, Canada</span>
    </p><div id="art-admin"><span class="italic bold">Received 
      1st April 2022
    </span><span class="bold italic">, Accepted 13th September 2022</span></div><p class="bold italic">First published on 14th September 2022</p><hr/><div class="abstract"><h2>Abstract</h2><p>Optimization strategies driven by machine learning, such as Bayesian optimization, are being explored across experimental sciences as an efficient alternative to traditional design of experiment. When combined with automated laboratory hardware and high-performance computing, these strategies enable next-generation platforms for autonomous experimentation. However, the practical application of these approaches is hampered by a lack of flexible software and algorithms tailored to the unique requirements of chemical research. One such aspect is the pervasive presence of constraints in the experimental conditions when optimizing chemical processes or protocols, and in the chemical space that is accessible when designing functional molecules or materials. Although many of these constraints are known <span class="italic">a priori</span>, they can be interdependent, non-linear, and result in non-compact optimization domains. In this work, we extend our experiment planning algorithms PHOENICS and GRYFFIN such that they can handle arbitrary known constraints <span class="italic">via</span> an intuitive and flexible interface. We benchmark these extended algorithms on continuous and discrete test functions with a diverse set of constraints, demonstrating their flexibility and robustness. In addition, we illustrate their practical utility in two simulated chemical research scenarios: the optimization of the synthesis of <span class="italic">o</span>-xylenyl Buckminsterfullerene adducts under constrained flow conditions, and the design of redox active molecules for flow batteries under synthetic accessibility constraints. The tools developed constitute a simple, yet versatile strategy to enable model-based optimization with known experimental constraints, contributing to its applicability as a core component of autonomous platforms for scientific discovery.</p></div><hr/>
    
      
      <h2 id="sect329"><span class="a_heading">I. Introduction</span></h2>
      <span>The design of advanced materials and functional molecules often relies on combinatorial, high-throughput screening strategies enabled by high-performance computing and automated laboratory equipment. Despite the successes of high-throughput experimentation in chemistry,<a title="Select to navigate to reference" href="#cit1"><sup><span class="sup_ref">1,2</span></sup></a> biology,<a title="Select to navigate to reference" href="#cit3"><sup><span class="sup_ref">3,4</span></sup></a> and materials science,<a title="Select to navigate to references" href="#cit5"><sup><span class="sup_ref">5</span></sup></a> these approaches typically employ exhaustive searches that scale exponentially with the size of the search space. Data-driven strategies that can adaptively search parameter spaces without the need for exhaustive exploration are thus replacing traditional design of experiment approaches in many instances. These strategies use machine-learnt surrogate models trained on all data generated through the experimental campaign, and are updated each time new data is collected. One such approach is Bayesian optimization which, based on the surrogate model, defines a utility function that prioritize experiments based on their expected informativeness and performance.<a title="Select to navigate to reference" href="#cit6"><sup><span class="sup_ref">6–8</span></sup></a> These data-driven optimization strategies have already demonstrated superior performance in chemistry and materials science applications, <span class="italic">e.g.</span>, in reaction optimization,<a title="Select to navigate to reference" href="#cit9"><sup><span class="sup_ref">9,10</span></sup></a> the discovery of magnetic resonance imaging agents,<a title="Select to navigate to references" href="#cit11"><sup><span class="sup_ref">11</span></sup></a> the fabrication of organic photovoltaic materials,<a title="Select to navigate to reference" href="#cit12"><sup><span class="sup_ref">12,13</span></sup></a> virtual screening of ultra-large chemical libraries,<a title="Select to navigate to references" href="#cit14"><sup><span class="sup_ref">14</span></sup></a> and the design of mechanical structures with additively manufactured components.<a title="Select to navigate to references" href="#cit15"><sup><span class="sup_ref">15</span></sup></a></span>
      <p class="otherpara">Machine learning-driven experiment planning strategies can also be combined with automated laboratory hardware or high-performance computing to create self-driving platforms capable of achieving research goals autonomously.<a title="Select to navigate to reference" href="#cit16"><sup><span class="sup_ref">16–22</span></sup></a> Prototypes of these autonomous research platforms have already shown promise in diverse applications, including the optimization of chemical reaction conditions,<a title="Select to navigate to reference" href="#cit9"><sup><span class="sup_ref">9,10</span></sup></a> the design of photocatalysts for the production of hydrogen from water,<a title="Select to navigate to references" href="#cit23"><sup><span class="sup_ref">23</span></sup></a> the discovery of battery electrolytes,<a title="Select to navigate to references" href="#cit24"><sup><span class="sup_ref">24</span></sup></a> the design of nanoporous materials with tailored adsorption properties,<a title="Select to navigate to references" href="#cit25"><sup><span class="sup_ref">25</span></sup></a> the optimization of multicomponent polymer blend formulations for organic photovoltaics,<a title="Select to navigate to references" href="#cit12"><sup><span class="sup_ref">12</span></sup></a> the discovery of phase-change memory materials for photonic switching devices,<a title="Select to navigate to references" href="#cit26"><sup><span class="sup_ref">26</span></sup></a> and self-optimization of metal nanoparticle synthesis,<a title="Select to navigate to references" href="#cit27"><sup><span class="sup_ref">27</span></sup></a> to name a few.<a title="Select to navigate to reference" href="#cit13"><sup><span class="sup_ref">13,28</span></sup></a> While self-driving platforms seem poised to deliver a next-generation approach to scientific discovery, their practical application is hampered by a lack of flexible software and algorithms tailored to the unique requirements of chemical research.</p>
      <p class="otherpara">To provide chemistry-tailored data-driven optimization tools, our group has developed PHOENICS<a title="Select to navigate to references" href="#cit29"><sup><span class="sup_ref">29</span></sup></a> and GRYFFIN,<a title="Select to navigate to references" href="#cit30"><sup><span class="sup_ref">30</span></sup></a> among others.<a title="Select to navigate to reference" href="#cit31"><sup><span class="sup_ref">31–33</span></sup></a> PHOENICS is a linear-scaling Bayesian optimizer for continuous spaces that uses a kernel regression surrogate model and natively supports batched optimization. GRYFFIN is an extension of this algorithm to categorical, as well as mixed continuous-categorical spaces. Furthermore, GRYFFIN is able to leverage expert knowledge in the form of descriptors to enhance its optimization performance, which was found particularly useful in combinatorial optimizations of molecules and materials.<a title="Select to navigate to references" href="#cit30"><sup><span class="sup_ref">30</span></sup></a> As GRYFFIN is the more general algorithm, and PHOENICS is included within its capabilities, from here on we will refer only to GRYFFIN. These algorithms have already found applications ranging from the optimization of reaction conditions<a title="Select to navigate to references" href="#cit10"><sup><span class="sup_ref">10</span></sup></a> and synthetic protocols,<a title="Select to navigate to reference" href="#cit27"><sup><span class="sup_ref">27,34</span></sup></a> to that of manufacturing of thin film materials<a title="Select to navigate to references" href="#cit13"><sup><span class="sup_ref">13</span></sup></a> and organic photovoltaic devices.<a title="Select to navigate to references" href="#cit12"><sup><span class="sup_ref">12</span></sup></a> However, a number of extensions are still required to make these tools suitable to the broadest range of chemistry applications. In particular, GRYFFIN, like the majority of Bayesian optimization tools available, does not handle known experimental or design constraints.</p>
      <p class="otherpara">There are often many constraints on the experiment being performed or molecule being designed. A flexible data-driven optimization tool should be able to accommodate and handle such constraints. The type of constraints typically encountered may be separated into those that affect the objectives of the optimization (<span class="italic">e.g.</span>, reaction yield, desired molecular properties), and those that affect the optimization parameters (<span class="italic">e.g.</span>, reaction conditions). Those affecting the objectives usually arise in multi-objective optimization, where one would like to optimize a certain property while constraining another to be above/below a desired value.<a title="Select to navigate to reference" href="#cit31"><sup><span class="sup_ref">31,35,36</span></sup></a> For instance, we might want to improve the solubility of a drug candidate, while keeping its protein-binding affinity in the nanomolar range. Conversely, parameter constraints limit the range of experiments or molecules we have access to. Depending on the source of the constraints, these may be referred to as <span class="italic">known</span> or <span class="italic">unknown</span>. Known constraints are those we are aware of <span class="italic">a priori</span>,<a title="Select to navigate to reference" href="#cit37"><sup><span class="sup_ref">37–40</span></sup></a> while unknown ones are discovered through experimentation.<a title="Select to navigate to reference" href="#cit37"><sup><span class="sup_ref">37–40</span></sup></a> For instance, a known constraint might enforce the total volume for two liquids to not exceed the available volume in the container in which they are mixed. While this poses a restriction on the parameter space, we are aware of it in advance and can easily compute which regions of parameter space are infeasible. An unknown constraint may instead be the synthetic accessibility in a molecular optimization campaign. In this case, we might not know in advance which areas of chemical space are easily accessible, and have to resort to trial and error to identify feasible and infeasible synthetic targets. While constraints of the objectives were the subject of our previous work,<a title="Select to navigate to references" href="#cit31"><sup><span class="sup_ref">31</span></sup></a> and unknown constraints of the parameters are the subject of on-going work, this paper focuses on data-driven optimization with known parameter constraints, which we will refer to simply as <span class="italic">known constraints</span> from here on.</p>
      <p class="otherpara">Generally, known constraints arise due to physical or hardware restrictions, safety concerns, or user preference. An example of a physically imposed constraint is the fact that the temperature of a reaction cannot exceed the boiling temperature of its solvent. As such, one may want temperature to be varied in the interval 10 &lt; <span class="italic">T</span> &lt; 100 °C for experiments using water, and in 10 &lt; <span class="italic">T</span> &lt; 66 °C for experiments using tetrahydrofuran. The fact that the sum of volumes of different solutions cannot exceed that of the container they are mixed in is an example of a hardware-imposed constraint. In synthetic chemistry, specific combinations of reagents and conditions might need to be avoided for safety reasons instead. Finally, constraints could also be placed by the researchers to reflect prior knowledge about the performance of a certain protocol. For example, a researcher might know in advance that specific combinations of solvent, substrate, and catalyst will return poor yields. These examples are not natively handled by GRYFFIN and the majority of data-driven optimization tools currently available. In fact, given any number of continuous or categorical parameters, their full Cartesian product is assumed to be accessible by the optimization algorithm. Returning to the example where solvents have different boiling temperatures, this means that if the optimization range for the variable <span class="italic">T</span> is set to 10–100 °C, this range will be applied to all solvents considered. In practice, known constraints are often interdependent, non-linear, and can result in non-compact optimization domains.</p>
      <p class="otherpara">In this work, we extend the capabilities of GRYFFIN to optimization over parameter domains with known constraints. First, we provide a formal introduction to the known constraint problem and detail how GRYFFIN was extended to be able to flexibly handle such scenarios. Then, we benchmark our new constrained version of GRYFFIN on a range of analytical functions subject to a diverse set of constraints. Finally, we demonstrate our method on two chemistry applications: the optimization of the synthesis of <span class="italic">o</span>-xylenyl Buckminsterfullerene adducts under constrained flow conditions, and the design of redox active molecules for flow batteries under synthetic accessibility constraints. Across all tests, we compare GRYFFIN's performance to that of other optimization strategies, such as random search and genetic algorithms, which can also handle complex constraints.</p>
    
    
      
      <h2 id="sect379"><span class="a_heading">II. Methods</span></h2>
      <span>An optimization task involves the identification of parameters, <span class="bold"><span class="italic">x</span></span>, that yield the most desirable outcome for an objective <span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span>). In a chemistry context, these parameters may be experimental conditions or different R groups in a molecule, while the objectives may be the yield of a reaction or absorbance at a specific wavelength. Formally, for a minimization problem, the solution of the optimization is the set of parameters that minimizes the objective <span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span>),<br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgugt1"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t1.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t1.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td><a id="ugt1"/><span id="ugt1"/></td><td class="pushTitleLeft"> </td></tr></table></div>where <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t2_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t2.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t2.gif"/></a> is the optimization domain, or parameter space; <span class="italic">i.e.</span>, the space of all experimental conditions that could have been explored during the optimization. In a Bayesian optimization setting, the objective function <span class="italic">f</span> is considered to be unknown, but can be empirically evaluated at specific values of <span class="bold"><span class="italic">x</span></span>. Evaluating <span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span>) is assumed to be expensive and/or time consuming, and its measurement subject to noise. We also assume that we have no access to gradient information about <span class="italic">f</span>.</span>
      <p class="otherpara">In a <span class="italic">constrained</span> optimization problem, one is interested in solutions within a subset of the optimization domain, <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t3_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t3.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t3.gif"/></a>. This may be because <span class="italic">f</span> can be evaluated only for this subset, or because of user preference. In the QRAK taxonomy of Digabel and Wild,<a title="Select to navigate to references" href="#cit41"><sup><span class="sup_ref">41</span></sup></a> the former scenario would be that of <span class="italic">known</span>, <span class="italic">nonquantifiable</span>, <span class="italic">unrelaxable</span>, <span class="italic">a priori</span> constraints, or 4:NUAK constraints; the latter scenario would fall into the domain of <span class="italic">relaxable</span> constraints. In this work, we focus on unrelaxable constraints, even though the approach would be applicable also to the relaxable case.</p>
      <p class="otherpara">A constraint function <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>) determines which parameters <span class="bold"><span class="italic">x</span></span> are feasible and thus in <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t4_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t4.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t4.gif"/></a>, and which are not. Contrary to <span class="italic">unknown</span> constraints, known constraints are those for which we have access to <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>) <span class="italic">a priori</span>, that is, we are aware of them before performing the optimization. Importantly, we can evaluate the functions <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>) and <span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span>) independently of one another. The solution of this constrained optimization problem may be written formally as<br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgugt5"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t5_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t5.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t5.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td><a id="ugt5"/><span id="ugt5"/></td><td class="pushTitleLeft"> </td></tr></table></div></p>
      <p class="otherpara">The physical meaning of <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>) is case dependent and domain specific. In chemistry, known constraints may reflect safety concerns, physical limits imposed by laboratory equipment, or simply researcher preference. The types of known constraints we focus on in this work are <span class="italic">hard</span>, unrelaxable constraints. They restrict <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t6_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t6.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t6.gif"/></a> irrefutably and no measurement outside of <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t7_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t7.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t7.gif"/></a> is permitted. However, the use of <span class="italic">soft</span> constraints is also possible and has been explored. While soft constraints bias the optimization algorithm away from regions thought to yield undesirable outcomes, they ultimately still allow the full exploration of <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t8_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t8.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t8.gif"/></a>. In the relaxable scenario, imposing soft constraints can be a strategy to collect useful information outside of the desirable region <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t9_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t9.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t9.gif"/></a>. Soft constraints have also been used as means to introduce inductive biases into an optimization campaign based on prior knowledge.<a title="Select to navigate to reference" href="#cit42"><sup><span class="sup_ref">42,43</span></sup></a></p>
      <p class="otherpara">The goal of this work is to equip GRYFFIN with the ability to satisfy arbitrary constraints, as described by a user-defined constraint function <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>). This can be achieved by constraining the optimization of the acquisition function <span class="italic">α</span>.<a title="Select to navigate to references" href="#cit44"><sup><span class="sup_ref">44</span></sup></a><span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span>) defines the utility (or risk) of evaluating the parameters <span class="bold"><span class="italic">x</span></span>, and the parameters proposed by the algorithm are those that optimize <span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span>). Thus, constrained optimization of the acquisition function also constrains the overall optimization problem accordingly. However, contrary to objective function <span class="italic">f</span>, the acquisition function <span class="italic">α</span> is easy to optimize, as its analytical form is known and can be evaluated cheaply. In the next sections we describe GRYFFIN's acquisition function and the approaches we implemented for its constrained optimization. Yet, note that any other constrained optimization algorithm handling nonlinear, nonconvex, and possibly discontinuous constraint functions could also be used.</p>
      
        
        <h3 id="sect457"><span class="b_heading">A. Acquisition optimization in GRYFFIN</span></h3>
        <span>GRYFFIN's acquisition function, which is to be minimized, is defined as<table><td class="leftEqn"> </td><tr><td class="eqn"><span id="eqn1"/><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t10_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t10.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t10.gif"/></a></td><td class="rightEqn">(1)</td></tr></table>where <span class="italic">p</span><small><sub><span class="italic">k</span></sub></small>(<span class="bold"><span class="italic">x</span></span>) are the kernels of the kernel regression model used as the surrogate, <span class="italic">f</span><small><sub><span class="italic">k</span></sub></small> are the measured objective function values, and <span class="italic">λ</span> is a user-defined parameter that determines the exploration-exploitation behavior of the algorithm. The index <span class="italic">k</span> refers to each past observation, for a total number of observations <span class="italic">n</span>.</span>
        <p class="otherpara">For continuous parameters, GRYFFIN uses Gaussian kernels with prior precision <span class="italic">τ</span> sampled from a Gamma distribution, <span class="italic">τ</span> ∼ <span class="italic">Γ</span>(<span class="italic">a</span>,<span class="italic">b</span>), with prior hyperparameters <span class="italic">a</span> = 12<span class="italic">n</span><small><sup>2</sup></small> and <span class="italic">b</span> = 1. For categorical and discrete parameters, it uses Gumbel-Softmax<a title="Select to navigate to reference" href="#cit45"><sup><span class="sup_ref">45,46</span></sup></a> kernels with a prior temperature parameter of 0.5 + 10<span class="italic">n</span><small><sup>−1</sup></small>. These prior parameters are, however, updated by a Bayesian neural network in light of the observed data.<a title="Select to navigate to references" href="#cit29"><sup><span class="sup_ref">29</span></sup></a> As the prior precision of the kernels increases with the number of observations, the surrogate model is encouraged to fit the observations more accurately as more data is acquired.</p>
        <p class="otherpara">Acquisition function optimization in GRYFFIN generally follows a two-step strategy in which a global search is followed by local refinement. Effectively, it is a simple multi-start strategy that is memoryless and easily parallelizable. First, sets of input parameters <span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small> are sampled uniformly from the optimization domain. By default, the number of samples is set to be directly proportional to the dimensionality of the optimization domain. Then, continuous parameters are optimized with a gradient method for a pre-defined number of iterations. While early versions of GRYFFIN employed second order methods such as L-BFGS, the default gradient-based approach is now Adam.<a title="Select to navigate to references" href="#cit47"><sup><span class="sup_ref">47</span></sup></a> Adam is a first-order, gradient-based optimization algorithm with momentum, which computes adaptive learning rates for each parameter by considering the first and second moments of the gradient. It thus naturally adjusts step size, and it is invariant to rescaling of gradients. Adam has found broad application for the optimization of neural network weights thanks to its robust performance. Categorical and discrete parameters are optimized instead following a hill-climbing approach (which we refer to as <span class="italic">Hill</span>), in which each initial sample <span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small> is modified uniformly at random, one dimension at a time, and each move is accepted only if it improves <span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small>).</p>
        <p class="otherpara">In addition to gradient-based optimization of the acquisition function, in this work we have implemented gradient-free optimization <span class="italic">via</span> a genetic algorithm. The population of parameters is firstly selected uniformly at random, as described above. Then, each <span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small> in the population is evolved <span class="italic">via</span> crossover, mutation and selection operations, with elitism applied. This approach handles continuous, discrete, and categorical parameters by applying different mutations and cross-over operations depending on the type. A more detailed explanation of the genetic algorithm used for acquisition optimization is provided in ESI Sec. S.1.B.<a title="Select to navigate to footnote" href="#fn1">†</a> This approach is implemented in Python and makes use of the DEAP library.<a title="Select to navigate to reference" href="#cit48"><sup><span class="sup_ref">48,49</span></sup></a></p>
        <p class="otherpara">
          <a title="Select to navigate to figure" href="#imgfig1">Fig. 1</a> provides a visual example of how these two approaches optimize the acquisition function of GRYFFIN. While Adam optimizes each random sample <span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small> (black crosses) <span class="italic">via</span> small steps towards better <span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small>) values (grey to white crosses), the genetic approach does so <span class="italic">via</span> larger stochastic jumps in parameter space.</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig1"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-f1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-f1.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-f1.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 1 </b> <span id="fig1"><span class="graphic_title">Illustration of unconstrained (top row) and constrained (bottom row) acquisition function optimization using strategies based on the Adam optimizer and a genetic algorithm. Initial, random samples are shown as black crosses. Grey crosses represent the updated parameter locations for these initial samples, while white crosses show the final locations after ten optimization iterations. The purple star indicates the global optima of the unconstrained acquisition function, which lies in the infeasible region in the constrained example.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
      
      
        
        <h3 id="sect529"><span class="b_heading">B. Constrained acquisition optimization with Adam or Hill</span></h3>
        <span>To constrain the optimization of the acquisition function according to a user-defined constraint function <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>), we first sample a set of feasible parameters <span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small> with rejection sampling. That is, we sample <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t11_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t11.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t11.gif"/></a> uniformly from the optimization domain and we retain only samples that satisfy the constraint function <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span>). Sampling is performed until the desired number of feasible samples is drawn. Local optimization of parameters is then performed with Adam, as described above, but it is terminated as soon as an update results in <span class="italic">c</span>(<span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small>) ↦ infeasible (<a title="Select to navigate to figure" href="#imgfig1">Fig. 1</a>). For categorical and discrete parameters, Hill is used rather than Adam, but the constraint protocol is equivalent. In this case, after rejection sampling, any move in parameter space is accepted only if it improves <span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span><small><sub><span class="italic">i</span></sub></small>) and subject to <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t12_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t12.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t12.gif"/></a>. Because of this early termination, each initial sample can be optimized locally for a different number of iterations. Strategies that do not terminate the optimization but adapt the update rule may preserve the number of allocated iterations across all initial samples.</span>
      
      
        
        <h3 id="sect556"><span class="b_heading">C. Constrained acquisition optimization with a genetic algorithm</span></h3>
        <span>The population of the genetic optimization procedure is initialized with rejection sampling as described above for gradient approaches. However, to keep the optimized parameters within the feasible region, a subroutine is used to project infeasible offsprings onto the feasibility boundary using binary search (ESI Sec. S.1.B<a title="Select to navigate to footnote" href="#fn1">†</a>). In addition to guaranteeing that the optimized parameters satisfy the constraint function, this approach also ensures sampling of parameters close to the feasibility boundary (<a title="Select to navigate to figure" href="#imgfig1">Fig. 1</a> and ESI Fig. S1<a title="Select to navigate to footnote" href="#fn1">†</a>).</span>
        <p class="otherpara">Despite having implemented constraints in GRYFFIN independently, when preparing this manuscript we realized that known constraints in DRAGONFLY<a title="Select to navigate to references" href="#cit50"><sup><span class="sup_ref">50</span></sup></a> have been implemented following a very similar strategy. However, rather than projecting infeasible offspring solution on the feasibility boundary, DRAGONFLY relies solely on rejection sampling.</p>
        <p class="otherpara">A practical advantage of the genetic optimization strategy is its favourable computational scaling compared to its gradient-based counterpart. We conducted benchmarks in which the time needed by GRYFFIN to optimize the acquisition function was measured for different numbers of past observations and parameter space dimensions (ESI Sec. S.1.C<a title="Select to navigate to footnote" href="#fn1">†</a>). In fact, acquisition optimization is the most costly task in most Bayesian optimization algorithms, including GRYFFIN. The genetic strategy provided a speedup of approximately 5× over Adam when the number of observations was varied, and of approximately 2.5× when the dimensionality of the optimization domain was varied. The better time complexity of the zeroth-order approach is primarily due to derivatives of <span class="italic">α</span>(<span class="bold"><span class="italic">x</span></span>) not having to be computed. In fact, our Adam implementation currently computes derivatives numerically. Future work will focus on deriving the analytical gradients for GRYFFIN's acquisition function, or taking advantage of automatic differentiation schemes, such that this gap might reduce or disappear in future versions of the code.</p>
      
      
        
        <h3 id="sect570"><span class="b_heading">D. User interface</span></h3>
        <span>With user-friendliness and flexibility in mind, we extended GRYFFIN's Python interface such that it can take a user-defined constraint function among its inputs. As an example, the following code snippet shows an instantiation of GRYFFIN where the sum of two volumes is constrained.<br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgugr1"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-u1_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-u1.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-u1.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td><a id="ugr1"/><span id="ugr1"/></td><td class="pushTitleLeft"> </td></tr></table></div></span>
        <p class="otherpara">This example could be that of a minimization over two parameters, <span class="bold"><span class="italic">x</span></span> = (<span class="italic">x</span><small><sub>1</sub></small>,<span class="italic">x</span><small><sub>2</sub></small>) ∈ [0,1]<small><sup>2</sup></small>, subject to the constraint that the sum of <span class="italic">x</span><small><sub>1</sub></small> and <span class="italic">x</span><small><sub>2</sub></small> does not exceed some upper bound <span class="italic">b</span>,<br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgugt13"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t13_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t13.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t13.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td><a id="ugt13"/><span id="ugt13"/></td><td class="pushTitleLeft"> </td></tr></table></div></p>
      
      
        
        <h3 id="sect589"><span class="b_heading">E. Current limitations</span></h3>
        <span>We note two limitations of our approach to known constraints. First, in continuous spaces, the current implementation handles only inequality constraints. Equality constraints, such as <span class="italic">x</span><small><sub>1</sub></small> + <span class="italic">x</span><small><sub>2</sub></small> = <span class="italic">b</span>, effectively change the dimensionality of the optimization problem and can be tackled <span class="italic">via</span> a re-definition of the optimization domain or analytical transforms. For instance, for the two-dimensional example above, the constraint can be satisfied simply by optimizing over <span class="italic">x</span><small><sub>1</sub></small>, while setting <span class="italic">x</span><small><sub>2</sub></small> = <span class="italic">b</span> − <span class="italic">x</span><small><sub>1</sub></small>.</span>
        <p class="otherpara">Second, because of the rejection sampling procedure used (Sec. II.B), the cost of acquisition optimization is inversely proportional to the fraction of the optimization domain that is feasible. The smaller the feasible volume fraction is, the more samples need to be drawn uniformly at random before reaching the predefined number of samples to be collected for acquisition optimization. It thus follows that the feasible region, as determined by the user-defined constraint function, should not be exceedingly small (<span class="italic">e.g.</span>, less than 1% of the optimization domain), as in that case GRYFFIN's acquisition optimization would become inefficient. In practice we find that when only a tiny fraction of the overall optimization domain is considered feasible, it is because of a sub-optimal definition of the optimization domain, which can be solved by re-framing the problem. A related issue may arise if the constraints define disconnected feasible regions with vastly different volumes. In this scenario, given uniform sampling, little or no samples may be drawn from the smaller region. However, this too is an edge case that is unlikely to arise in practical applications, as the definition of completely separate optimization regions with vastly different scales tends to imply a scenario where multiple separate optimizations would be a more suitable solution.</p>
        <p class="otherpara">Future work will focus on overcoming these two challenges. For instance, deep learning techniques like invertible neural networks<a title="Select to navigate to references" href="#cit51"><sup><span class="sup_ref">51</span></sup></a> may be used to learn a mapping from the unconstrained to the constrained domain, such that the optimization algorithm would be free to operate on the hypercube while the proposed experimental conditions would satisfy the constraints.</p>
      
    
    
      
      <h2 id="sect610"><span class="a_heading">III. Results and discussion</span></h2>
      <span>In this section we test the ability of GRYFFIN to handle arbitrary known constraints. First, we show how GRYFFIN can efficiently optimize continuous and discrete (ordered) benchmark functions with a diverse set of constraints. Then, we demonstrate the practical utility of handling known constraints on two relevant chemistry examples: the optimization of the synthesis of <span class="italic">o</span>-xylenyl Buckminsterfullerene adducts under constrained flow conditions, and the design of redox active molecules for flow batteries under synthetic accessibility constraints.</span>
      <p class="otherpara">In addition to testing GRYFFIN—with both gradient and evolutionary based-acquisition optimization strategies, referred to as <span class="italic">Gryffin (Adam/Hill)</span> and <span class="italic">Gryffin (Genetic)</span>, respectively—we also test three other constrained optimization strategies amenable to experiment planning. Specifically, we use random search (<span class="italic">Random</span>), a genetic algorithm (<span class="italic">Genetic</span>), and Bayesian optimization with a Gaussian process surrogate model (<span class="italic">Dragonfly</span>). <span class="italic">Genetic</span> is the same algorithm developed for constrained acquisition function optimization, but it is here employed directly to optimize the objective function (Sec. II.C). <span class="italic">Dragonfly</span> uses the DRAGONFLY package<a title="Select to navigate to references" href="#cit50"><sup><span class="sup_ref">50</span></sup></a> for optimization. Similar to GRYFFIN, DRAGONFLY allows for the specification of arbitrarily complex constraints <span class="italic">via</span> a Python function, which is not the case for most other Bayesian optimization packages. <span class="italic">Dragonfly</span> was not employed in the two chemistry examples, due to an implementation incompatibility with using both constraints and the multi-objective optimization strategy required by the applications.</p>
      
        
        <h3 id="sect626"><span class="b_heading">A. Analytical benchmarks</span></h3>
        <span>Here, we use eight analytical functions (four continuous and four discrete) to test the ability of GRYFFIN to perform sample-efficient optimization while satisfying a diverse set of user-defined constraints. More specifically, we consider the following four two-dimensional continuous surfaces, as implemented in the OLYMPUS package:<a title="Select to navigate to references" href="#cit52"><sup><span class="sup_ref">52</span></sup></a><span class="italic">Branin</span>, <span class="italic">Schwefel</span>, <span class="italic">Dejong</span>, and <span class="italic">Discrete Ackley</span> (<a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a>). While <span class="italic">Branin</span> has three degenerate global minima, we apply constraints such that only one minimum is present in the feasible region. In <span class="italic">Schwefel</span>, a highly unstructured constraint function is used, where the global minimum is close to the boundary of the infeasible region. In <span class="italic">Dejong</span>, we use a set of constraints that result in a non-compact optimization domain where the global minimum cannot be reached, and there is an infinite number of feasible minima along the feasibility boundary. <span class="italic">Discrete Ackley</span> is a discretized version of the Ackley function, and is an example of an extremely rugged surface. The four, two-dimensional discrete surfaces considered are: <span class="italic">Slope</span>, <span class="italic">Sphere</span>, <span class="italic">Michalewicz</span>, and <span class="italic">Camel</span> (<a title="Select to navigate to figure" href="#imgfig3">Fig. 3</a>). Each variable in these discrete surfaces is comprised of integer numbers from 0 to 20, for a design space of 441 options in total.</span>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig2"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-f2_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-f2.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-f2.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 2 </b> <span id="fig2"><span class="graphic_title">Constrained optimization benchmarks on analytical functions with continuous parameters. The upper row shows contour plots of the surfaces with constrained regions darkly shaded. Gray crosses show sample observation locations using the <span class="italic">Gryffin (Genetic)</span> strategy and purple stars denote the location(s) of unconstrained global optima. The bottom row show optimization traces for each strategy. Shaded regions around the solid trace represent 95% confidence intervals.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig3"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-f3_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-f3.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-f3.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 3 </b> <span id="fig3"><span class="graphic_title">Constrained optimization benchmarks on analytical functions with discrete, ordered parameters. The upper row shows heatmaps of the discrete optimization domain. Shaded regions indicate infeasible regions, where constraints have been applied. The locations of the global optima are indicated by purple stars. Gray crosses show parameters locations that have been probed in a sample optimization run using <span class="italic">Gryffin (Genetic)</span> before the optimum being identified. The bottom row shows, as superimposed box-and-whisker and swarm plots, the distributions of the number of evaluations needed to identify the global optimum for each optimization strategy (numerical values can be found in Table S1<a title="Select to navigate to footnote" href="#fn1">†</a>).</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">Results of constrained optimization experiments on continuous surfaces are shown in <a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a>. These results were obtained by performing 100 repeated optimizations for each of the five strategies considered, while allowing a maximum of 100 objective function evaluations. Optimization performance is assessed using the distance between the best function value found at each iteration of the optimization campaign and the global optimum, a metric known as <span class="italic">regret</span>, <span class="italic">r</span>. The regret after <span class="italic">k</span> optimization iterations is<table><td class="leftEqn"> </td><tr><td class="eqn"><span id="eqn2"/><span id="eqn2"><span class="italic">r</span><small><sub><span class="italic">k</span></sub></small> = |<span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span>*) − <span class="italic">f</span>(<span class="bold"><span class="italic">x</span></span><small><sup>+</sup></small><small><sub><span class="italic">k</span></sub></small>)|.</span></td><td class="rightEqn">(2)</td></tr></table><span class="bold"><span class="italic">x</span></span><small><sup>+</sup></small><small><sub><span class="italic">k</span></sub></small> are the parameters associated with best objective value observed in the optimization campaign after <span class="italic">k</span> iterations, sometimes referred to as the <span class="italic">incumbent</span> point, <span class="italic">i.e.</span>, for a minimization problem <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t14_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t14.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t14.gif"/></a>, where <a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-t15_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-t15.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-t15.gif"/></a> is the current dataset of observations. <span class="bold"><span class="italic">x</span></span>* are the parameters associated with the global optimum of the function within the whole optimization domain. If the optimum lies in the infeasible region, a regret of zero is not attainable. Sample-efficient algorithms should find parameters that return better (in this case lower) function values with fewer objective evaluations.</p>
        <p class="otherpara">All optimization strategies tested obeyed the known constraints (<a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a>, top row). We observe that the combination of analytical function and user-defined constraint have great influence on the relative optimization performance of the considered strategies. On all functions, the performance of GRYFFIN was insensitive to the acquisition optimization strategy, with <span class="italic">Gryffin (Adam)</span> and <span class="italic">Gryffin (Genetic)</span> performing equally well. This observation also held true on higher-dimensional surfaces (ESI Fig. S4<a title="Select to navigate to footnote" href="#fn1">†</a>). On smooth functions, such as <span class="italic">Branin</span> and <span class="italic">Dejong</span>, <span class="italic">Dragonfly</span> displayed strong performance, given that its Gaussian process surrogate model approximates these functions extremely well. In addition, DRAGONFLY appears to propose parameter points that are closer to previous observations than GRYFFIN does, showcasing a more exploitative character, which in this case is beneficial to achieve marginal gains in performance when in very close proximity to the optimum (see ESI Sec. S.2.C for additional details<a title="Select to navigate to footnote" href="#fn1">†</a>). Although their performance is slightly worse than <span class="italic">Dragonfly</span>, <span class="italic">Gryffin</span> strategies still displayed improved performance over <span class="italic">Random</span> and <span class="italic">Genetic</span> on <span class="italic">Branin</span>, and comparable performance to <span class="italic">Dragonfly</span> on <span class="italic">Dejong</span>. <span class="italic">Gryffin</span> strategies showed improved performance compared to <span class="italic">Dragonfly</span> on <span class="italic">Schwefel</span> and <span class="italic">Discrete Ackley</span>. These observations are consistent with previous work<a title="Select to navigate to references" href="#cit29"><sup><span class="sup_ref">29</span></sup></a> where it was observed that, due to the different surrogate models used, GRYFFIN returned better performance on functions with discontinuous character, while Gaussian process-based approaches better performed on smooth surfaces. On <span class="italic">Schwefel</span>, our <span class="italic">Genetic</span> strategy also showed improved performance over that of <span class="italic">Random</span> and <span class="italic">Dragonfly</span>, comparable with that of <span class="italic">Gryffin</span>. It is interesting to note how <span class="italic">Dragonfly</span> performed particularly poorly on this function. This is due to <span class="italic">Schwefel</span> being a periodic function, while the prior used by <span class="italic">Dragonfly</span> is the Matérn kernel. When using a periodic kernel with suitable inductive biases, the Gaussian process model better fits the surface, locating the global minimum (ESI Fig. S5<a title="Select to navigate to footnote" href="#fn1">†</a>). Finally, note that in <a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a> differences between strategies are exaggerated by the use of a logarithmic scale, used to highlight statistically significant differences. We also report the same results using a linear scale, which de-emphasizes significant yet marginal differences in regret values (<span class="italic">e.g.</span> between <span class="italic">Dragonfly</span> and <span class="italic">Gryffin</span> on the <span class="italic">Branin</span> function) in ESI Fig. S3.<a title="Select to navigate to footnote" href="#fn1">†</a></p>
        <p class="otherpara">Results of constrained optimization experiments on discrete synthetic surfaces are shown in <a title="Select to navigate to figure" href="#imgfig3">Fig. 3</a>. These results are also based on 100 repeated optimizations, each initialized with a different random seed. Optimizations were allowed to continue until the global optimum was found. As a measure of performance, the number of objective function evaluations required to identify the optimum was used. As such, a more efficient algorithm should identify the optimum with fewer evaluations on average.</p>
        <p class="otherpara">Here too, all strategies tested correctly obeyed each constraint function (<a title="Select to navigate to figure" href="#imgfig3">Fig. 3</a>, top row), and Bayesian optimization algorithms (<span class="italic">Gryffin</span> and <span class="italic">Dragonfly</span>) outperformed <span class="italic">Random</span> and <span class="italic">Genetic</span> on all four benchmarks (<a title="Select to navigate to figure" href="#imgfig3">Fig. 3</a>, bottom row). <span class="italic">Random</span> needed to evaluate about half of the feasible space before identifying the optimum. <span class="italic">Genetic</span> required significantly fewer evaluations, generally between a half and a third of those required by <span class="italic">Random</span>. On discrete surfaces, the approaches based on GRYFFIN and DRAGONFLY returned equal performance overall, with no considerable differences (Table S1<a title="Select to navigate to footnote" href="#fn1">†</a>). As it was observed for continuous surfaces, the performance of <span class="italic">Gryffin (Adam)</span> and <span class="italic">Gryffin (Genetic)</span> was equivalent.</p>
        <p class="otherpara">In settings where the constraints are the result of limitations in experimental capabilities, one may want to evaluate whether the global optimum could be located in the infeasible region, with the goal of deciding whether to expand such capabilities. While this task is best suited to a supervised learning framework, in which multiple ML models could be evaluated for their predictive ability, the data collected by the optimization algorithm is what enables such models. It is therefore interesting to notice how GRYFFIN tends to collect data that is likely informative for this task. In fact, the combination of GRYFFIN's acquisition function and its constrained optimization results in a data-collection strategy that tends to probe the boundaries of the feasibility region, with a higher density of points in proximity of possible minima. Examples of this behavior may be seen in <a title="Select to navigate to figure" href="#imgfig2">Fig. 2</a> for the <span class="italic">Branin</span> and <span class="italic">Dejong</span> functions, which have their global optima located in the infeasible (constrained) region. In these cases, GRYFFIN sampled a higher density of points on the feasibility boundary close to these optima. These data points would be useful when building a ML model that tries to extrapolate into the infeasible region.</p>
      
      
        
        <h3 id="sect741"><span class="b_heading">B. Process-constrained optimization of <span class="italic">o</span>-xylenyl C<small><sub>60</sub></small> adducts synthesis</span></h3>
        <span>Compared to their inorganic counterparts, organic solar cells have the advantage of being flexible, lightweight and easily fabricated.<a title="Select to navigate to reference" href="#cit53"><sup><span class="sup_ref">53,54</span></sup></a> Bulk heterojunction polymer-fullerene cells are an example of such devices, in which the photoactive layer is composed of a blend of polymeric donor material and fullerene derivative acceptor molecules.<a title="Select to navigate to references" href="#cit55"><sup><span class="sup_ref">55</span></sup></a> The fullerene acceptor is oftentimes functionalized to tune its optoelectronic properties. In particular, mono and bis <span class="italic">o</span>-xylenyl adducts of Buckminsterfullerene are acceptor molecules which have received much attention in this regard. On the other hand, higher-order adducts are avoided as they have a detrimental impact on the power conversion efficiencies of the resulting device.<a title="Select to navigate to references" href="#cit56"><sup><span class="sup_ref">56</span></sup></a> Therefore, synthetic protocols that provide accurate control over the degree of C<small><sub>60</sub></small> functionalization are of primary interests for the manufacturing of these organic photovoltaic devices.</span>
        <p class="otherpara">In this example application of constrained Bayesian optimization, we consider the reaction of C<small><sub>60</sub></small> with an excess of sultine, the cyclic ester of a hydroxy sulfinic acid, to form first, second, and third order <span class="italic">o</span>-xylenyl adducts of Buckminsterfullerene (<a title="Select to navigate to figure" href="#imgfig4">Fig. 4a</a>). This application is based on previous work by Walker <span class="italic">et al.</span>,<a title="Select to navigate to references" href="#cit35"><sup><span class="sup_ref">35</span></sup></a> who reported the optimization of this reaction with an automated, single-phase capillary-based flow reactor. Because this reaction is cascadic, a mixture of products is always present, with the relative amounts of each species depending primarily on reaction kinetics. The overall goal of the optimization is thus to tune reaction conditions such that the yield of first- and second-order adducts is maximized and reaches at least 90%, while the cost of reagents is minimized. We estimated reagents cost by considering the retail price listed by a chemical supplier (ESI Sec. S.3.B<a title="Select to navigate to footnote" href="#fn1">†</a>). In effect, we derive a simple estimate of per-minute operation cost of the flow reactor, which is to be minimized as the second optimization objective.</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig4"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-f4_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-f4.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-f4.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 4 </b> <span id="fig4"><span class="graphic_title">Experimental setup and results of the process-constrained synthesis of <span class="italic">o</span>-xylenyl C<small><sub>60</sub></small> adducts. (a) Synthesis of <span class="italic">o</span>-xylenyl C<small><sub>60</sub></small> adducts. 1,4-dihydro-2,3-benzoxathiin 3-oxide (sultine) is converted to <span class="italic">o</span>-quinidimethane (<span class="italic">o</span>QDM) <span class="italic">in situ</span>, which then reacts with C<small><sub>60</sub></small> by Diels–Alder cycloaddition to form the <span class="italic">o</span>-xylenyl adducts. (b) Schematic of the single-phase capillary-based flow reactor (as reported by Walker <span class="italic">et al.</span><a title="Select to navigate to references" href="#cit35"><sup><span class="sup_ref">35</span></sup></a>), along with the optimization parameters, constraints, and objectives. The C<small><sub>60</sub></small> and sultine flow rates are modulated by syringe pumps, and the reaction temperature is controlled by a solid state heater. Online HPLC and absorption spectroscopy is used for analysis. (c) Results of the constrained optimization experiments. Plots show the mean and 95% confidence interval of the best objective values found after varying numbers of experiments, for each optimization algorithm studied. The background color indicates the desirability of the objective values, with grey being less, and white more desirable. For the first objective (left-hand side), the grey region below the value of 0.9 indicates values for the objective that do not satisfy the optimization goal that was set.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">The controllable reaction conditions are the temperature (<span class="italic">T</span>), the flow rate of C<small><sub>60</sub></small> (<span class="italic">F</span><small><sub>C</sub></small>), and the flow rate of sultine (<span class="italic">F</span><small><sub>S</sub></small>), which determine the chemical composition of the reaction mixture and are regulated by syringe pumps (<a title="Select to navigate to figure" href="#imgfig4">Fig. 4b</a>). <span class="italic">T</span> is allowed to be set anywhere between 100 and 150 °C, and flow rates can be varied between 0 and 200 μL min<small><sup>−1</sup></small>. However, the values of the flow rates are constrained. First, the total flow rate cannot exceed 310 μL min<small><sup>−1</sup></small>, or be below 10 μL min<small><sup>−1</sup></small>. Second, <span class="italic">F</span><small><sub>S</sub></small> cannot be more than twice <span class="italic">F</span><small><sub>C</sub></small>, and <span class="italic">vice versa F</span><small><sub>C</sub></small> cannot be more than twice <span class="italic">F</span><small><sub>S</sub></small>. More formally, the inequality constraints can be defined as 10 &lt; <span class="italic">F</span><small><sub>C</sub></small> + <span class="italic">F</span><small><sub>S</sub></small> &lt; 310 μL min<small><sup>−1</sup></small>, <span class="italic">F</span><small><sub>C</sub></small> &lt; 2<span class="italic">F</span><small><sub>S</sub></small> and <span class="italic">F</span><small><sub>S</sub></small> &lt; 2<span class="italic">F</span><small><sub>C</sub></small>.</p>
        <p class="otherpara">The relative concentrations of each adduct—[<span class="italic">X</span><small><sub>1</sub></small>], [<span class="italic">X</span><small><sub>2</sub></small>], and [<span class="italic">X</span><small><sub>3</sub></small>] for the mono, bis, and tris adduct, respectively—are measured <span class="italic">via</span> online high-performance liquid chromatography (HPLC) and absorption spectroscopy. Following from the above discussion, we would like to maximize the yield of [<span class="italic">X</span><small><sub>1</sub></small>] and [<span class="italic">X</span><small><sub>2</sub></small>], which are the adducts with desirable optoelectronic properties. However, we would also like to reduce the overall cost of the raw materials. These multiple goals are captured <span class="italic">via</span> the use of CHIMERA as a hierarchical scalarizing function for multi-objective optimization.<a title="Select to navigate to references" href="#cit31"><sup><span class="sup_ref">31</span></sup></a> Specifically, we set the first objective as the maximization of [<span class="italic">X</span><small><sub>1</sub></small>] + [<span class="italic">X</span><small><sub>2</sub></small>], with a minimum target goal of 0.9, and the minimization of reagents cost as the secondary goal. Effectively, this setup corresponds to the minimization of cost under the constraint that [<span class="italic">X</span><small><sub>1</sub></small>] + [<span class="italic">X</span><small><sub>2</sub></small>] ≥ 0.9.</p>
        <p class="otherpara">To perform numerous repeated optimizations with different algorithms, as well as collect associated statistics, we constructed a deep learning model to simulate the above-described experiment. In particular, we trained a Bayesian neural network based on the data provided by Walker <span class="italic">et al.</span>,<a title="Select to navigate to references" href="#cit35"><sup><span class="sup_ref">35</span></sup></a> which learns to map reaction conditions to a distribution of experimental outcomes (ESI Sec. S.3.A<a title="Select to navigate to footnote" href="#fn1">†</a>). The measurement is thus stochastic, as expected experimentally. This emulator takes <span class="italic">T</span>, <span class="italic">F</span><small><sub>C</sub></small>, and <span class="italic">F</span><small><sub>S</sub></small> as input, and returns mole fractions of the un- (<span class="italic">X</span><small><sub>0</sub></small>), singly- (<span class="italic">X</span><small><sub>1</sub></small>), doubly- (<span class="italic">X</span><small><sub>2</sub></small>), and triply-functionalized (<span class="italic">X</span><small><sub>3</sub></small>) C<small><sub>60</sub></small>. The model displayed excellent interpolation performance across the parameter space for each adduct type (Pearson coefficient of 0.93–0.96 on the test sets). This enabled us to perform many repeated optimizations thanks to rapid and accurate simulated experiments.</p>
        <p class="otherpara">Results of the constrained optimization experiments are shown in <a title="Select to navigate to figure" href="#imgfig4">Fig. 4c</a>. Optimization traces show the objective values associated with the best scalarized merit value. The constrained GRYFFIN strategies obeyed all flow rate constraints defined. All strategies rapidly identified reaction conditions producing high yields. Upon satisfying the first objective, CHIMERA guided the optimization algorithms towards lowering the cost of the reaction. GRYFFIN achieved cheaper protocols faster than the other strategies tested. In ESI Sec. S.3.B<a title="Select to navigate to footnote" href="#fn1">†</a> we examine the best reactions conditions identified by each optimization strategy after 100 experiments. We find that for the majority of cases, strategies decreased the C<small><sub>60</sub></small> flow rate (the more expensive reagent) to minimize the cost of the experiment, while simultaneously decreasing the sultine flow rate to maintain a stoichiometric ratio close to one and preserve the high (≥0.9 combined mole fraction) yield of <span class="italic">X</span><small><sub>0</sub></small> and <span class="italic">X</span><small><sub>1</sub></small> adducts. In principle, the yield is allowed to degrade with an accompanying decrease (improvement) in cost. However, we did not see the trade-off between yield and cost being required within the experimental budget of 100 experiments. In this case study we used GPYOPT, as opposed to DRAGONFLY, as a representative of an established Bayesian optimization algorithm, because its implementation was compatible with the requirements of this specific scenario. That is, the presence of known constraints and the use of an external scalarizing function for multi-objective optimization. Use of CHIMERA as an external scalarizing function requires updating the entire optimization history at each iteration. Thus, the optimization library must be used <span class="italic">via</span> an <span class="italic">ask-tell</span> interface. Although DRAGONFLY does have such an interface, to the best of our knowledge it does not yet support constrained and multi-objective optimizations with external scalarizing functions. In this instance, GPYOPT with expected improvement as the acquisition function performed similarly to <span class="italic">Genetic</span> and <span class="italic">Random</span> on average.</p>
        <p class="otherpara">As a final note, we point out that in this application the reaction conditions were assumed to be constant throughout each experiment. However, other setups may involve time-varying parameters. When this is done in a controlled fashion, additional parameters can be used to describe a time-dependent protocol. For instance, a linear temperature gradient can be described by three variables: initial temperature, a time interval, and the rate of temperature change over time. If changes in the controllable parameters are undesirable consequences of shortcomings of the protocol or equipment (<span class="italic">e.g.</span>, limited temperature control ability), these may be accounted for by considering the input parameter as uncertain.<a title="Select to navigate to references" href="#cit32"><sup><span class="sup_ref">32</span></sup></a></p>
      
      
        
        <h3 id="sect861"><span class="b_heading">C. Design of redox-active materials for flow batteries with synthetic accessibility constraints</span></h3>
        <span>Long-duration, stationary energy storage devices are needed to handle the rapid growth in intermittent energy sources.<a title="Select to navigate to references" href="#cit58"><sup><span class="sup_ref">58</span></sup></a> Toward this goal, redox flow batteries offer a potentially promising solution.<a title="Select to navigate to reference" href="#cit59"><sup><span class="sup_ref">59–63</span></sup></a> Second-generation non-aqueous redox flow batteries are based on organic solvent as opposed to water, which enables a much larger electrochemical window and higher energy density, the potential to increase the working temperature window, as well as the use of cheap, earth abundant redox-active materials.<a title="Select to navigate to references" href="#cit64"><sup><span class="sup_ref">64</span></sup></a> Nevertheless, the multiobjective design of redox-active materials poses a significant challenge in materials science. Recently, the anolyte redox material 2,1,3-benzothiadiazole was shown to have low redox potential, high stability and promising electrochemical cycling performance.<a title="Select to navigate to reference" href="#cit65"><sup><span class="sup_ref">65–67</span></sup></a> Furthermore, derivatization of benzothiadiazole enabled self-reporting of battery health by fluorescence emission.<a title="Select to navigate to references" href="#cit68"><sup><span class="sup_ref">68</span></sup></a></span>
        <p class="otherpara">In this application we demonstrate our constrained optimization approach for the multi-objective design of retro-synthetically accessible redoxmer molecules. We utilize a previously reported dataset that comprises 1408 benzothiadiazole derivatives (<a title="Select to navigate to figure" href="#imgfig5">Fig. 5a</a>) for which the reduction potential <span class="italic">E</span><small><sup>red</sup></small>, solvation free energy <span class="italic">G</span><small><sup>solv</sup></small>, and maximum absorption wavelength <span class="italic">λ</span><small><sup>abs</sup></small> were computed with DFT.<a title="Select to navigate to references" href="#cit69"><sup><span class="sup_ref">69</span></sup></a> This example application thus simulates a DFT-based computational screen<a title="Select to navigate to reference" href="#cit70"><sup><span class="sup_ref">70–72</span></sup></a> that aims to identify redoxmer candidates with self-reporting features and a high probability of synthetic accessibility.</p>
        <br/><div class="image_table"><table><tr><td colspan="3" class="imgHolder" id="imgfig5"><a href="/image/article/2022/DD/d2dd00028h/d2dd00028h-f5_hi-res.gif" title="Select to open image in new window" onclick="open(this.href, &#34;_blank&#34;, &#34;toolbar=1,scrollbars=yes,resizable=1&#34;); return false;"><img alt="image file: d2dd00028h-f5.tif" src="/image/article/2022/DD/d2dd00028h/d2dd00028h-f5.gif"/></a></td></tr><tr><td class="pushTitleRight"> </td><td class="image_title"><b>Fig. 5 </b> <span id="fig5"><span class="graphic_title">Optimization setup and results for the design of redox-active materials. (a) Markush structure of the benzothiadiazole scaffold and all substituents considered. The entire design space consists of 1408 candidates (2 R<small><sub>1</sub></small> × 8 R<small><sub>2</sub></small> × 8 R<small><sub>3</sub></small> × 11 R<small><sub>4</sub></small> options). (b) Synthetic constraints applied to the optimization. The <span class="italic">RAscore</span><a title="Select to navigate to references" href="#cit57"><sup><span class="sup_ref">57</span></sup></a> was used to score synthesizability. The histogram shows the distribution of synthesizability scores for all 1408 candidates. We constrain the optimization to those candidates with an <span class="italic">RAscore</span> &gt; 0.9. (c) Objectives of the molecular optimization. (d) Results of the constrained optimization experiments. Grey shaded regions indicate objective values failing to achieve the desired objectives. Traces depict the objective values corresponding to the best achieved merit at each iteration, where error bars represent 95% confidence intervals.</span></span></td><td class="pushTitleLeft"> </td></tr></table></div>
        <p class="otherpara">To impose synthetic accessibility constraints we used <span class="italic">RAscore</span>,<a title="Select to navigate to references" href="#cit57"><sup><span class="sup_ref">57</span></sup></a> a recently-reported synthetic accessibility score based on the computer-aided synthesis planner <span class="italic">AiZythFinder</span>.<a title="Select to navigate to references" href="#cit73"><sup><span class="sup_ref">73</span></sup></a><span class="italic">RAscore</span> predicts the probability of <span class="italic">AiZythFinder</span> being able to identify a synthetic route for a target organic molecule. While other measures of synthetic accessibility are available,<a title="Select to navigate to reference" href="#cit34"><sup><span class="sup_ref">34,74–76</span></sup></a><span class="italic">RAscore</span> was chosen for its performance and intuitive interpretation. In our experiments, we constrained the optimization to candidates with <span class="italic">RAscore</span> &gt; 0.9 (<a title="Select to navigate to figure" href="#imgfig5">Fig. 5b</a>, additional details in ESI Sec. S.4.B<a title="Select to navigate to footnote" href="#fn1">†</a>). This synthetic accessibility constraint reduces the design space of feasible candidates to a total of 959 molecules.</p>
        <p class="otherpara">We aimed at optimizing three objectives concurrently: the absorption wavelength <span class="italic">λ</span><small><sup>abs</sup></small>, the reduction potential <span class="italic">E</span><small><sup>red</sup></small>, and the solvation free energy <span class="italic">G</span><small><sup>solv</sup></small> of the candidates (<a title="Select to navigate to figure" href="#imgfig5">Fig. 5c</a>). Specifically, we aimed at identifying molecules that would (i) absorb in the 350–400 nm range, (ii) improve upon the reduction potential of the base scaffold (2.04 V against a Li/Li<small><sup>+</sup></small> reference electrode; ESI Sec. S.4.A<a title="Select to navigate to footnote" href="#fn1">†</a>), and (iii) provide the lowest possible solvation free energy, here used as a proxy for solubility. The hierarchical scalarizing function CHIMERA<a title="Select to navigate to references" href="#cit31"><sup><span class="sup_ref">31</span></sup></a> was used to guide the optimization algorithms toward achieving these desired properties.</p>
        <p class="otherpara">Results of the constrained optimization experiments are displayed in <a title="Select to navigate to figure" href="#imgfig5">Fig. 5d</a>. Each optimization strategy was given a budget of 100 molecules to be tested; the experiments were repeated 100 times and initialized with different random seeds. Optimization traces show the values of Δ<span class="italic">λ</span><small><sup>abs</sup></small>, <span class="italic">E</span><small><sup>red</sup></small>, and <span class="italic">G</span><small><sup>solv</sup></small> associated with the best molecule identified among those tested. In these tests, the dynamic version of GRYFFIN was used.<a title="Select to navigate to references" href="#cit30"><sup><span class="sup_ref">30</span></sup></a> This approach can take advantage of physicochemical descriptors in the search for optimal molecules. In this case, GRYFFIN was provided with several descriptors for each R group in the molecule: number of heavy atoms, number of hetero atoms, molecular weight, geometric diameter, polar surface area, polarizability, fraction of sp<small><sup>3</sup></small> carbons (ESI Sec. S.4.C<a title="Select to navigate to footnote" href="#fn1">†</a>).<a title="Select to navigate to references" href="#cit77"><sup><span class="sup_ref">77</span></sup></a></p>
        <p class="otherpara">Constrained GRYFFIN avoided redoxmer candidates predicted to be retro-synthetically inaccessible. All optimization strategies rapidly identified candidates with <span class="italic">λ</span><small><sup>abs</sup></small> between 350 and 400 nm, and whose <span class="italic">E</span><small><sup>red</sup></small> is lower than that of the starting scaffold. However, GRYFFIN strategies managed to identify candidates with lower <span class="italic">G</span><small><sup>solv</sup></small> faster than <span class="italic">Random</span> and <span class="italic">Genetic</span>. Consistent with previous tests, we did not observe a statistically different performance between <span class="italic">Gryffin (Hill)</span> and <span class="italic">Gryffin (Genetic)</span>. Overall, <span class="italic">Gryffin (Hill)</span> and <span class="italic">Gryffin (Genetic)</span> identified molecules with better <span class="italic">λ</span><small><sup>abs</sup></small>, <span class="italic">E</span><small><sup>red</sup></small>, and <span class="italic">G</span><small><sup>solv</sup></small> properties than <span class="italic">Random</span> or <span class="italic">Genetic</span> after probing 100 molecules. Furthermore, within this budget, GRYFFIN identified molecules with better properties more efficiently than the competing strategies tested. Without the aid of physicochemical descriptors, GRYFFIN's performance deteriorated, as expected,<a title="Select to navigate to references" href="#cit30"><sup><span class="sup_ref">30</span></sup></a> yet it was still superior than that of <span class="italic">Random</span> and <span class="italic">Genetic</span> (ESI Fig. S11<a title="Select to navigate to footnote" href="#fn1">†</a>).</p>
      
    
    
      
      <h2 id="sect949"><span class="a_heading">IV. Conclusion</span></h2>
      <span>In this work, we extended the capabilities of GRYFFIN to handle <span class="italic">a priori</span> known, hard constraints on the parameter domain, a pragmatic requirement for the development of autonomous research platforms in chemistry. Known constraints constitute an important class of restrictions placed on optimization domains, and may reflect physical constraints or limitations in laboratory equipment capabilities. In addition, known constraints may provide a straightforward avenue to inject prior knowledge or intuition into a chemistry optimization task.</span>
      <p class="otherpara">In GRYFFIN, we allow the user to define arbitrary known constraints <span class="italic">via</span> a flexible and intuitive Python interface. The constraints are then satisfied by constraining the optimization of its acquisition function.</p>
      <p class="otherpara">In all our benchmarks, GRYFFIN obeyed the (sometimes complex) constraints defined, showed superior performance to more traditional search strategies based on random search and evolutionary algorithms, and was competitive to state-of-the-art Bayesian optimization approaches.</p>
      <p class="otherpara">Finally, we demonstrated the practical utility of handling known constraints with GRYFFIN in two research scenarios relevant to chemistry. In the first, we demonstrated how to perform an efficient optimization for the synthesis of <span class="italic">o</span>-xylenyl adducts of Buckminsterfullerene while subjecting the experimental protocol to process constraints. In the second, we showed how known constraints may be used to incorporate synthetic accessibility considerations in the design of redox active materials for non-aqueous flow batteries.</p>
      <p class="otherpara">It is our hope that simple, flexible, and scalable software tools for model-based optimization over constrained parameter spaces will enhance the applicability of data-driven optimization in chemistry and material science, and will contribute to the operationalization of self-driving laboratories.</p>
    
    
      <h2 id="sect960"><span class="a_heading">Data availability</span></h2>
      <span>An open-source implementation of GRYFFIN with known constraints is available on GitHub at https://github.com/aspuru-guzik-group/gryffin, under an Apache 2.0 license. The data and scripts used to run the experiments and produce the plots in this paper are also available on GitHub at https://github.com/aspuru-guzik-group/gryffin-known-constraints.</span>
    
    
      <h2 id="sect965"><span class="a_heading">Conflicts of interest</span></h2>
      <span>A. A.-G. is the Chief Visionary Officer and founding member of Kebotix, Inc.</span>
    
  
    <h2 id="sect969"><span class="a_heading">Acknowledgements</span></h2>
      <span>The authors thank Dr Martin Seifrid, Marta Skreta, Ben Macleod, Fraser Parlane, and Michael Elliott for valuable discussions. R. J. H. gratefully acknowledges the Natural Sciences and Engineering Research Council of Canada (NSERC) for provision of the Postgraduate Scholarships-Doctoral Program (PGSD3-534584-2019). M. A. was supported by a Postdoctoral Fellowship of the Vector Institute. A. A.-G. acknowledges support from the Canada 150 Research Chairs program and CIFAR, as well as the generous support of Anders G. Fröseth. This work relates to the Department of Navy award (N00014-18-S-B-001) issued by the office of Naval Research. The United States Government has a royalty-free license throughout the world in all copyrightable material contained herein. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the Office of Naval Research. Computations reported in this work were performed on the computing clusters of the Vector Institute and on the Niagara supercomputer at the SciNet HPC Consortium.<a title="Select to navigate to reference" href="#cit78"><sup><span class="sup_ref">78,79</span></sup></a> Resources used in preparing this research were provided, in part, by the Province of Ontario, the Government of Canada through CIFAR, and companies sponsoring the Vector Institute. SciNet is funded by the Canada Foundation for Innovation, the Government of Ontario, Ontario Research Fund – Research Excellence, and by the University of Toronto.</span>
    
    <span id="sect972"><h2 id="sect968"><span class="a_heading">References</span></h2></span><ol type="1">
      <li><span id="cit1">A. McNally, C. K. Prier and D. W. C. MacMillan, <span class="italic">Science</span>, 2011, <span class="bold">334</span>(6059), 1114–1117 <a target="_blank" class="DOILink" href="https://doi.org/10.1126/science.1213920" title="DOI Link to resource 10.1126/science.1213920">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC3MXhsV2mu7vP" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=22116882%5Buid%5D" title="PubMed Link to resource 22116882">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/1_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit2">K. D. Collins, T. Gensch and F. Glorius, <span class="italic">Nat. Chem.</span>, 2014, <span class="bold">6</span>, 859–871 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/nchem.2062" title="DOI Link to resource 10.1038/nchem.2062">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2cXhsFyhtLjK" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=25242480%5Buid%5D" title="PubMed Link to resource 25242480">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/2_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit3">V. Blay, B. Tolani, S. P. Ho and M. R. Arkin, <span class="italic">Drug Discovery Today</span>, 2020, <span class="bold">25</span>, 1807–1821 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.drudis.2020.07.024" title="DOI Link to resource 10.1016/j.drudis.2020.07.024">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhs1aqtbvJ" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/3_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit4">W. Zeng, L. Guo, S. Xu, J. Chen and J. Zhou, <span class="italic">Trends Biotechnol.</span>, 2020, <span class="bold">38</span>, 888–906 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.tibtech.2020.01.001" title="DOI Link to resource 10.1016/j.tibtech.2020.01.001">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhsFKrtb8%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/4_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit5">L. Cheng, R. S. Assary, X. Qu, A. Jain, S. P. Ong, N. N. Rajput, K. Persson and L. A. Curtiss, <span class="italic">J. Phys. Chem. Lett.</span>, 2015, <span class="bold">6</span>, 283–291 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/jz502319n" title="DOI Link to resource 10.1021/jz502319n">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2cXitFGrsr3M" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=26263464%5Buid%5D" title="PubMed Link to resource 26263464">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/5_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit6">
          J. Močkus, <span class="italic">Optimization techniques IFIP technical conference</span>,  1975, pp. 400–404 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Optimization%20techniques%20IFIP%20technical%20conference%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%201975%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/6_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit7">
          J. Mockus, V. Tiesis and A. Zilinskas, <span class="italic">Towards Global Optimization</span>,  1978, vol. 2, p. 2 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Towards%20Global%20Optimization%5BJour%5D%20AND%202%5Bvolume%5D%20AND%20%5Bpage%5D%20and%201978%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/7_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit8">
          J. Mockus, <span class="italic">Bayesian approach to global optimization: theory and applications</span>, Springer Science &amp; Business Media,  2012, vol. 37 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Bayesian%20approach%20to%20global%20optimization:%20theory%20and%20applications%5BJour%5D%20AND%2037%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202012%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/8_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit9">B. J. Shields, J. Stevens, J. Li, M. Parasram, F. Damani, J. I. M. Alvarado, J. M. Janey, R. P. Adams and A. G. Doyle, <span class="italic">Nature</span>, 2021, <span class="bold">590</span>, 89–96 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/s41586-021-03213-y" title="DOI Link to resource 10.1038/s41586-021-03213-y">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3MXjt1SjtLg%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/9_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit10">M. Christensen, L. P. E. Yunker, F. Adedeji, F. Häse, L. M. Roch, T. Gensch, G. dos Passos Gomes, T. Zepel, M. S. Sigman, A. Aspuru-Guzik and J. E. Hein, <span class="italic">Commun. Chem.</span>, 2021, <span class="bold">4</span>(1), 112 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/s42004-021-00550-x" title="DOI Link to resource 10.1038/s42004-021-00550-x">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/10_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit11">M. Reis, F. Gusev, N. G. Taylor, S. H. Chung, M. D. Verber, Y. Z. Lee, O. Isayev and F. A. Leibfarth, <span class="italic">J. Am. Chem. Soc.</span>, 2021, <span class="bold">143</span>, 17677–17689 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/jacs.1c08181" title="DOI Link to resource 10.1021/jacs.1c08181">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3MXit1Wnu7fO" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=34637304%5Buid%5D" title="PubMed Link to resource 34637304">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/11_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit12">S. Langner, F. Häse, J. D. Perea, T. Stubhan, J. Hauch, L. M. Roch, T. Heumueller, A. Aspuru-Guzik and C. J. Brabec, <span class="italic">Adv. Mater.</span>, 2020, <span class="bold">32</span>, 1907801 <a target="_blank" class="DOILink" href="https://doi.org/10.1002/adma.201907801" title="DOI Link to resource 10.1002/adma.201907801">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXivFygsro%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/12_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit13">B. P. MacLeod, F. G. L. Parlane, T. D. Morrissey, F. Häse, L. M. Roch, K. E. Dettelbach, R. Moreira, L. P. E. Yunker, M. B. Rooney, J. R. Deeth, V. Lai, G. J. Ng, H. Situ, R. H. Zhang, M. S. Elliott, T. H. Haley, D. J. Dvorak, A. Aspuru-Guzik, J. E. Hein and C. P. Berlinguette, <span class="italic">Sci. Adv.</span>, 2020, <span class="bold">6</span>, eaaz8867 <a target="_blank" class="DOILink" href="https://doi.org/10.1126/sciadv.aaz8867" title="DOI Link to resource 10.1126/sciadv.aaz8867">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXitFGhsL3J" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/13_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit14">D. E. Graff, E. I. Shakhnovich and C. W. Coley, <span class="italic">Chem. Sci.</span>, 2021, <span class="bold">12</span>, 7866–7881 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=D0SC06805E&amp;newsite=1" title="Link to RSC resource DOI:10.1039/D0SC06805E">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/14_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit15">A. E. Gongora, B. Xu, W. Perry, C. Okoye, P. Riley, K. G. Reyes, E. F. Morgan and K. A. Brown, <span class="italic">Sci. Adv.</span>, 2020, <span class="bold">6</span>, eaaz1708 <a target="_blank" class="DOILink" href="https://doi.org/10.1126/sciadv.aaz1708" title="DOI Link to resource 10.1126/sciadv.aaz1708">CrossRef</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=32300652%5Buid%5D" title="PubMed Link to resource 32300652">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/15_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit16">F. Häse, L. M. Roch and A. Aspuru-Guzik, <span class="italic">Trends Chem.</span>, 2019, <span class="bold">1</span>, 282–291 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.trechm.2019.02.007" title="DOI Link to resource 10.1016/j.trechm.2019.02.007">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/16_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit17">L. M. Roch, F. Häse, C. Kreisbeck, T. Tamayo-Mendoza, L. P. E. Yunker, J. E. Hein and A. Aspuru-Guzik, <span class="italic">PLoS One</span>, 2020, <span class="bold">15</span>, e0229862 <a target="_blank" class="DOILink" href="https://doi.org/10.1371/journal.pone.0229862" title="DOI Link to resource 10.1371/journal.pone.0229862">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXosVCqu78%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=32298284%5Buid%5D" title="PubMed Link to resource 32298284">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/17_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit18">J.-P. Correa-Baena, K. Hippalgaonkar, J. van Duren, S. Jaffer, V. R. Chandrasekhar, V. Stevanovic, C. Wadia, S. Guha and T. Buonassisi, <span class="italic">Joule</span>, 2018, <span class="bold">2</span>, 1410–1420 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.joule.2018.05.009" title="DOI Link to resource 10.1016/j.joule.2018.05.009">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC1cXhsFGjs7bE" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/18_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit19">H. S. Stein and J. M. Gregoire, <span class="italic">Chem. Sci.</span>, 2019, <span class="bold">10</span>, 9640–9649 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C9SC03766G&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C9SC03766G">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/19_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit20">E. Stach, B. DeCost, A. G. Kusne, J. Hattrick-Simpers, K. A. Brown, K. G. Reyes, J. Schrier, S. Billinge, T. Buonassisi, I. Foster, C. P. Gomes, J. M. Gregoire, A. Mehta, J. Montoya, E. Olivetti, C. Park, E. Rotenberg, S. K. Saikin, S. Smullin, V. Stanev and B. Maruyama, <span class="italic">Matter</span>, 2021, <span class="bold">4</span>, 2702–2726 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.matt.2021.06.036" title="DOI Link to resource 10.1016/j.matt.2021.06.036">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/20_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit21">C. W. Coley, N. S. Eyke and K. F. Jensen, <span class="italic">Angew. Chem., Int. Ed.</span>, 2020, <span class="bold">59</span>, 22858–22893 <a target="_blank" class="DOILink" href="https://doi.org/10.1002/anie.201909987" title="DOI Link to resource 10.1002/anie.201909987">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhtFSktrzF" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=31553511%5Buid%5D" title="PubMed Link to resource 31553511">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/21_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit22">C. W. Coley, N. S. Eyke and K. F. Jensen, <span class="italic">Angew. Chem., Int. Ed.</span>, 2020, <span class="bold">59</span>, 23414–23436 <a target="_blank" class="DOILink" href="https://doi.org/10.1002/anie.201909989" title="DOI Link to resource 10.1002/anie.201909989">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhtFCjtL7M" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=31553509%5Buid%5D" title="PubMed Link to resource 31553509">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/22_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit23">B. Burger, P. M. Maffettone, V. V. Gusev, C. M. Aitchison, Y. Bai, X. Wang, X. Li, B. M. Alston, B. Li, R. Clowes, N. Rankin, B. Harris, R. S. Sprick and A. I. Cooper, <span class="italic">Nature</span>, 2020, <span class="bold">583</span>, 237–241 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/s41586-020-2442-2" title="DOI Link to resource 10.1038/s41586-020-2442-2">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhtlCqur%252FN" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=32641813%5Buid%5D" title="PubMed Link to resource 32641813">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/23_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit24">A. Dave, J. Mitchell, K. Kandasamy, H. Wang, S. Burke, B. Paria, B. Póczos, J. Whitacre and V. Viswanathan, <span class="italic">Cell Rep. Phys. Sci.</span>, 2020, <span class="bold">1</span>, 100264 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.xcrp.2020.100264" title="DOI Link to resource 10.1016/j.xcrp.2020.100264">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB38XhtlGqtrg%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/24_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit25">A. Deshwal, C. M. Simon and J. Rao Doppa, <span class="italic">Mol. Syst. Des. Eng.</span>, 2021, <span class="bold">6</span>, 1066–1086 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=D1ME00093D&amp;newsite=1" title="Link to RSC resource DOI:10.1039/D1ME00093D">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/25_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit26">A. G. Kusne, H. Yu, C. Wu, H. Zhang, J. Hattrick-Simpers, B. DeCost, S. Sarker, C. Oses, C. Toher, S. Curtarolo, A. V. Davydov, R. Agarwal, L. A. Bendersky, M. Li, A. Mehta and I. Takeuchi, <span class="italic">Nat. Commun.</span>, 2020, <span class="bold">11</span>, 5966 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/s41467-020-19597-w" title="DOI Link to resource 10.1038/s41467-020-19597-w">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXisVOnsL3N" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/26_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit27">H. Tao, T. Wu, S. Kheiri, M. Aldeghi, A. Aspuru-Guzik and E. Kumacheva, <span class="italic">Adv. Funct. Mater.</span>, 2021, <span class="bold">31</span>, 2106725 <a target="_blank" class="DOILink" href="https://doi.org/10.1002/adfm.202106725" title="DOI Link to resource 10.1002/adfm.202106725">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3MXitVGnsbjI" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/27_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit28">P. B. Wigley, P. J. Everitt, A. van den Hengel, J. W. Bastian, M. A. Sooriyabandara, G. D. McDonald, K. S. Hardman, C. D. Quinlivan, P. Manju, C. C. N. Kuhn, I. R. Petersen, A. N. Luiten, J. J. Hope, N. P. Robins and M. R. Hush, <span class="italic">Sci. Rep.</span>, 2016, <span class="bold">6</span>, 25890 <a target="_blank" class="DOILink" href="https://doi.org/10.1038/srep25890" title="DOI Link to resource 10.1038/srep25890">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC28XotFOiur8%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=27180805%5Buid%5D" title="PubMed Link to resource 27180805">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/28_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit29">F. Häse, L. M. Roch, C. Kreisbeck and A. Aspuru-Guzik, <span class="italic">ACS Cent. Sci.</span>, 2018, <span class="bold">4</span>, 1134–1145 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acscentsci.8b00307" title="DOI Link to resource 10.1021/acscentsci.8b00307">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/29_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit30">F. Häse, M. Aldeghi, R. J. Hickman, L. M. Roch and A. Aspuru-Guzik, <span class="italic">Appl. Phys. Rev.</span>, 2021, <span class="bold">8</span>, 031406 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Appl.%20Phys.%20Rev.%5BJour%5D%20AND%208%5Bvolume%5D%20AND%20031406%5Bpage%5D%20and%202021%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/30_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit31">F. Häse, L. M. Roch and A. Aspuru-Guzik, <span class="italic">Chem. Sci.</span>, 2018, <span class="bold">9</span>, 7642–7655 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C8SC02239A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C8SC02239A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/31_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit32">M. Aldeghi, F. Häse, R. J. Hickman, I. Tamblyn and A. Aspuru-Guzik, <span class="italic">Chem. Sci.</span>, 2021, <span class="bold">12</span>, 14792–14807 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=D1SC01545A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/D1SC01545A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/32_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit33">
          R. J. Hickman, F. Häse, L. M. Roch and A. Aspuru-Guzik,  2021, arXiv, 2103.03391.</span></li>
      <li><span id="cit34">M. Seifrid, R. J. Hickman, A. Aguilar-Granda, C. Lavigne, J. Vestfrid, T. C. Wu, T. Gaudin, E. J. Hopkins and A. Aspuru-Guzik, <span class="italic">ACS Cent. Sci.</span>, 2022, <span class="bold">8</span>, 122–131 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acscentsci.1c01002" title="DOI Link to resource 10.1021/acscentsci.1c01002">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB38Xks1Wmtw%253D%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=35106378%5Buid%5D" title="PubMed Link to resource 35106378">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/34_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit35">B. E. Walker, J. H. Bannock, A. M. Nightingale and J. C. deMello, <span class="italic">React. Chem. Eng.</span>, 2017, <span class="bold">2</span>, 785–798 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C7RE00123A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C7RE00123A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/35_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit36">
          M. A. Gelbart, J. Snoek and R. P. Adams, <span class="italic">Proceedings of the Thirtieth Conference on Uncertainty in Artificial Intelligence, Arlington, Virginia, USA</span>,  2014, pp. 250–259 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Proceedings%20of%20the%20Thirtieth%20Conference%20on%20Uncertainty%20in%20Artificial%20Intelligence,%20Arlington,%20Virginia,%20USA%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202014%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/36_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit37">
          R. B. Gramacy and H. K. H. Lee,  2010, arXiv:1004.4027 [stat].</span></li>
      <li><span id="cit38">
          M. A. Gelbart, J. Snoek and R. P. Adams,  2014, arXiv:1403.5607 [cs, stat].</span></li>
      <li><span id="cit39">S. Ariafar, J. Coll-Font, D. Brooks and J. Dy, <span class="italic">J. Mach. Learn. Res.</span>, 2019, <span class="bold">20</span>, 1–26 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Mach.%20Learn.%20Res.%5BJour%5D%20AND%2020%5Bvolume%5D%20AND%201%5Bpage%5D%20and%202019%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/39_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit40">C. Antonio, <span class="italic">J. Glob. Optim.</span>, 2021, <span class="bold">79</span>, 281–303 <a target="_blank" class="DOILink" href="https://doi.org/10.1007/s10898-019-00860-4" title="DOI Link to resource 10.1007/s10898-019-00860-4">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/40_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit41">
          S. L. Digabel and S. M. Wild,  2015, arXiv, 1505.07881.</span></li>
      <li><span id="cit42">S. Sun, A. Tiihonen, F. Oviedo, Z. Liu, J. Thapa, Y. Zhao, N. T. P. Hartono, A. Goyal, T. Heumueller, C. Batali, A. Encinas, J. J. Yoo, R. Li, Z. Ren, I. M. Peters, C. J. Brabec, M. G. Bawendi, V. Stevanovic, J. Fisher III and T. Buonassisi, <span class="italic">Matter</span>, 2021, <span class="bold">4</span>, 1305–1322 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.matt.2021.01.008" title="DOI Link to resource 10.1016/j.matt.2021.01.008">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3MXhvVemsLvJ" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/42_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit43">
          Z. Liu, N. Rolston, A. C. Flick, T. Colburn, Z. Ren, R. H. Dauskardt and T. Buonassisi,  2021, arXiv:2110.01387 [physics].</span></li>
      <li><span id="cit44">B. Shahriari, K. Swersky, Z. Wang, R. P. Adams and N. de Freitas, <span class="italic">Proc. IEEE</span>, 2016, <span class="bold">104</span>, 148–175 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Proc.%20IEEE%5BJour%5D%20AND%20104%5Bvolume%5D%20AND%20148%5Bpage%5D%20and%202016%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/44_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit45">
          E. Jang, S. Gu and B. Poole, <span class="italic">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24–26, 2017, Conference Track Proceedings</span>,  2017 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=5th%20International%20Conference%20on%20Learning%20Representations,%20ICLR%202017,%20Toulon,%20France,%20April%2024–26,%202017,%20Conference%20Track%20Proceedings%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202017%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/45_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit46">
          Y. W. T. Chris
          J. Maddison and A. Mnih, <span class="italic">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24–26, 2017, Conference Track Proceedings</span>,  2017 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=5th%20International%20Conference%20on%20Learning%20Representations,%20ICLR%202017,%20Toulon,%20France,%20April%2024–26,%202017,%20Conference%20Track%20Proceedings%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202017%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/46_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit47">
          D. P. Kingma and J. Ba, arXiv:1412.6980 [cs],  2017.</span></li>
      <li><span id="cit48">F.-A. Fortin, F.-M. De Rainville, M.-A. Gardner, M. Parizeau and C. Gagné, <span class="italic">J. Mach. Learn. Res.</span>, 2012, <span class="bold">13</span>, 2171–2175 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Mach.%20Learn.%20Res.%5BJour%5D%20AND%2013%5Bvolume%5D%20AND%202171%5Bpage%5D%20and%202012%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/48_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit49">
          F.-M. De Rainville, F.-A. Fortin, M.-A. Gardner, M. Parizeau and C. Gagné, <span class="italic">Proceedings of the 14th annual conference companion on Genetic and evolutionary computation</span>,  2012, pp. 85–92 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Proceedings%20of%20the%2014th%20annual%20conference%20companion%20on%20Genetic%20and%20evolutionary%20computation%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202012%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/49_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit50">K. Kandasamy, K. R. Vysyaraju, W. Neiswanger, B. Paria, C. R. Collins, J. Schneider, B. Poczos and E. P. Xing, <span class="italic">J. Mach. Learn. Res.</span>, 2020, <span class="bold">21</span>, 1–27 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Mach.%20Learn.%20Res.%5BJour%5D%20AND%2021%5Bvolume%5D%20AND%201%5Bpage%5D%20and%202020%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/50_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit51">
          J. Behrmann, W. Grathwohl, R. T. Q. Chen, D. Duvenaud and J.-H. Jacobsen, <span class="italic">Proceedings of the 36th International Conference on Machine Learning, Long Beach, California, USA</span>,  2019, pp. 573–582 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Proceedings%20of%20the%2036th%20International%20Conference%20on%20Machine%20Learning,%20Long%20Beach,%20California,%20USA%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202019%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/51_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit52">F. Häse, M. Aldeghi, R. J. Hickman, L. M. Roch, M. Christensen, E. Liles, J. E. Hein and A. Aspuru-Guzik, <span class="italic">Mach. Learn.: Sci. Technol.</span>, 2021, <span class="bold">2</span>, 035021 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Mach.%20Learn.:%20Sci.%20Technol.%5BJour%5D%20AND%202%5Bvolume%5D%20AND%20035021%5Bpage%5D%20and%202021%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/52_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit53">L. X. Chen, <span class="italic">ACS Energy Lett.</span>, 2019, <span class="bold">4</span>, 2537–2539 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acsenergylett.9b02071" title="DOI Link to resource 10.1021/acsenergylett.9b02071">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC1MXhvFShsbrJ" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/53_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit54">L. Hong, H. Yao, Y. Cui, Z. Ge and J. Hou, <span class="italic">APL Mater.</span>, 2020, <span class="bold">8</span>, 120901 <a target="_blank" class="DOILink" href="https://doi.org/10.1063/5.0027948" title="DOI Link to resource 10.1063/5.0027948">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXisFWksr7E" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/54_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit55">C. J. Brabec, S. Gowrisanker, J. J. M. Halls, D. Laird, S. Jia and S. P. Williams, <span class="italic">Adv. Mater.</span>, 2010, <span class="bold">22</span>, 3839–3856 <a target="_blank" class="DOILink" href="https://doi.org/10.1002/adma.200903697" title="DOI Link to resource 10.1002/adma.200903697">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC3cXhtFKlu73N" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=20717982%5Buid%5D" title="PubMed Link to resource 20717982">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/55_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit56">H. Kang, K.-H. Kim, T. E. Kang, C.-H. Cho, S. Park, S. C. Yoon and B. J. Kim, <span class="italic">ACS Appl. Mater. Interfaces</span>, 2013, <span class="bold">5</span>, 4401–4408 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/am400695e" title="DOI Link to resource 10.1021/am400695e">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC3sXlsFWnsrw%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=23574307%5Buid%5D" title="PubMed Link to resource 23574307">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/56_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit57">A. Thakkar, V. Chadimová, E. J. Bjerrum, O. Engkvist and J.-L. Reymond, <span class="italic">Chem. Sci.</span>, 2021, <span class="bold">12</span>, 3339–3349 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=D0SC05401A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/D0SC05401A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/57_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit58">T. M. Gür, <span class="italic">Energy Environ. Sci.</span>, 2018, <span class="bold">11</span>, 2696–2767 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C8EE01419A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C8EE01419A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/58_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit59">K. Lin, R. Gómez-Bombarelli, E. S. Beh, L. Tong, Q. Chen, A. Valle, A. Aspuru-Guzik, M. J. Aziz and R. G. Gordon, <span class="italic">Nat. Energy</span>, 2016, <span class="bold">1</span>, 1–8 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Nat.%20Energy%5BJour%5D%20AND%201%5Bvolume%5D%20AND%201%5Bpage%5D%20and%202016%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/59_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit60">P. Leung, A. A. Shah, L. Sanz, C. Flox, J. R. Morante, Q. Xu, M. R. Mohamed, C. Ponce de León and F. C. Walsh, <span class="italic">J. Power Sources</span>, 2017, <span class="bold">360</span>, 243–283 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.jpowsour.2017.05.057" title="DOI Link to resource 10.1016/j.jpowsour.2017.05.057">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2sXpslWkurk%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/60_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit61">R. Ye, D. Henkensmeier, S. J. Yoon, Z. Huang, D. K. Kim, Z. Chang, S. Kim and R. Chen, <span class="italic">J. Electrochem. Energy Convers. Storage</span>, 2017, <span class="bold">360</span>, 243–283 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.jpowsour.2017.05.103" title="DOI Link to resource 10.1016/j.jpowsour.2017.05.103">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/61_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit62">K. Lourenssen, J. Williams, F. Ahmadpour, R. Clemmer and S. Tasnim, <span class="italic">J. Energy Storage</span>, 2019, <span class="bold">25</span>, 100844 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.est.2019.100844" title="DOI Link to resource 10.1016/j.est.2019.100844">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/62_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit63">D. G. Kwabi, Y. Ji and M. J. Aziz, <span class="italic">Chem. Rev.</span>, 2020, <span class="bold">120</span>, 6467–6489 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acs.chemrev.9b00599" title="DOI Link to resource 10.1021/acs.chemrev.9b00599">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXislCqsLk%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=32053366%5Buid%5D" title="PubMed Link to resource 32053366">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/63_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit64">K. Gong, Q. Fang, S. Gu, S. F. Y. Li and Y. Yan, <span class="italic">Energy Environ. Sci.</span>, 2015, <span class="bold">8</span>, 3515–3530 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C5EE02341F&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C5EE02341F">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/64_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit65">W. Duan, J. Huang, J. A. Kowalski, I. A. Shkrob, M. Vijayakumar, E. Walter, B. Pan, Z. Yang, J. D. Milshtein, B. Li, C. Liao, Z. Zhang, W. Wang, J. Liu, J. S. Moore, F. R. Brushett, L. Zhang and X. Wei, <span class="italic">ACS Energy Lett.</span>, 2017, <span class="bold">2</span>, 1156–1161 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acsenergylett.7b00261" title="DOI Link to resource 10.1021/acsenergylett.7b00261">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2sXmsVaiu78%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/65_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit66">J. Huang, W. Duan, J. Zhang, I. A. Shkrob, R. S. Assary, B. Pan, C. Liao, Z. Zhang, X. Wei and L. Zhang, <span class="italic">J. Mater. Chem. A</span>, 2018, <span class="bold">6</span>, 6251–6254 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C8TA01059E&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C8TA01059E">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/66_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit67">J. Zhang, J. Huang, L. A. Robertson, I. A. Shkrob and L. Zhang, <span class="italic">J. Power Sources</span>, 2018, <span class="bold">397</span>, 214–222 <a target="_blank" class="DOILink" href="https://doi.org/10.1016/j.jpowsour.2018.07.001" title="DOI Link to resource 10.1016/j.jpowsour.2018.07.001">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC1cXht1yhs7nE" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/67_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit68">L. A. Robertson, I. A. Shkrob, G. Agarwal, Y. Zhao, Z. Yu, R. S. Assary, L. Cheng, J. S. Moore and L. Zhang, <span class="italic">ACS Energy Lett.</span>, 2020, <span class="bold">5</span>, 3062–3068 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acsenergylett.0c01447" title="DOI Link to resource 10.1021/acsenergylett.0c01447">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3cXhsFGju7bE" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/68_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit69">G. Agarwal, H. A. Doan, L. A. Robertson, L. Zhang and R. S. Assary, <span class="italic">Chem. Mater.</span>, 2021, <span class="bold">33</span>, 8133–8144 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acs.chemmater.1c02040" title="DOI Link to resource 10.1021/acs.chemmater.1c02040">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BB3MXit1ersLjI" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/69_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit70">C. d. l. Cruz, A. Molina, N. Patil, E. Ventosa, R. Marcilla and A. Mavrandonakis, <span class="italic">Sustainable Energy Fuels</span>, 2020, <span class="bold">4</span>, 5513–5521 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=D0SE00687D&amp;newsite=1" title="Link to RSC resource DOI:10.1039/D0SE00687D">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/70_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit71">J. E. Bachman, L. A. Curtiss and R. S. Assary, <span class="italic">J. Phys. Chem. A</span>, 2014, <span class="bold">118</span>, 8852–8860 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/jp5060777" title="DOI Link to resource 10.1021/jp5060777">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC2cXhsVeksbjF" title="Link to resource in CAS">CAS</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/71_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit72">R. S. Assary, F. R. Brushett and L. A. Curtiss, <span class="italic">RSC Adv.</span>, 2014, <span class="bold">4</span>, 57442–57451 <a target="_blank" class="RSCLink" href="http://xlink.rsc.org/?doi=C4RA08563A&amp;newsite=1" title="Link to RSC resource DOI:10.1039/C4RA08563A">RSC</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/72_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit73">S. Genheden, A. Thakkar, V. Chadimová, J.-L. Reymond, O. Engkvist and E. Bjerrum, <span class="italic">J. Cheminf.</span>, 2020, <span class="bold">12</span>, 70 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Cheminf.%5BJour%5D%20AND%2012%5Bvolume%5D%20AND%2070%5Bpage%5D%20and%202020%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/73_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit74">P. Ertl and A. Schuffenhauer, <span class="italic">J. Cheminf.</span>, 2009, <span class="bold">1</span>, 8 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Cheminf.%5BJour%5D%20AND%201%5Bvolume%5D%20AND%208%5Bpage%5D%20and%202009%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/74_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit75">C. W. Coley, L. Rogers, W. H. Green and K. F. Jensen, <span class="italic">J. Chem. Inf. Model.</span>, 2018, <span class="bold">58</span>, 252–261 <a target="_blank" class="DOILink" href="https://doi.org/10.1021/acs.jcim.7b00622" title="DOI Link to resource 10.1021/acs.jcim.7b00622">CrossRef</a> <a target="_blank" class="COILink" href="/en/content/coiresolver?coi=1%3ACAS%3A528%3ADC%252BC1cXkslSisQ%253D%253D" title="Link to resource in CAS">CAS</a> <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/pubmed/?term=29309147%5Buid%5D" title="PubMed Link to resource 29309147">PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/75_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit76">M. Voršilák, M. Kolář, I. Čmelo and D. Svozil, <span class="italic">J. Cheminf.</span>, 2020, <span class="bold">12</span>, 35 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Cheminf.%5BJour%5D%20AND%2012%5Bvolume%5D%20AND%2035%5Bpage%5D%20and%202020%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/76_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit77">H. Moriwaki, Y.-S. Tian, N. Kawashita and T. Takagi, <span class="italic">J. Cheminf.</span>, 2018, <span class="bold">10</span>, 4 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=J.%20Cheminf.%5BJour%5D%20AND%2010%5Bvolume%5D%20AND%204%5Bpage%5D%20and%202018%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/77_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit78">
          M. Ponce, R. van Zon, S. Northrup, D. Gruner, J. Chen, F. Ertinaz, A. Fedoseev, L. Groer, F. Mao, B. C. Mundim<span class="italic">et al.</span>, <span class="italic">Proceedings of the Practice and Experience in Advanced Research Computing on Rise of the Machines (learning)</span>,  2019, pp. 1–8 <a target="_blank" class="PMedLink" href="http://www.ncbi.nlm.nih.gov/sites/entrez?orig_db=PubMed&amp;db=pubmed&amp;cmd=Search&amp;term=Proceedings%20of%20the%20Practice%20and%20Experience%20in%20Advanced%20Research%20Computing%20on%20Rise%20of%20the%20Machines%20(learning)%5BJour%5D%20AND%20%5Bvolume%5D%20AND%20%5Bpage%5D%20and%202019%5Bpdat%5D" title="Search PubMed for this citation">Search PubMed</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/78_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
      <li><span id="cit79">C. Loken, D. Gruner, L. Groer, R. Peltier, N. Bunn, M. Craig, T. Henriques, J. Dempsey, C.-H. Yu and J. Chen, 
            <span class="italic">et al.</span>
          , <span class="italic">J. Phys.: Conf. Ser.</span>, 2010, 012026 <a target="_blank" class="DOILink" href="https://doi.org/10.1088/1742-6596/256/1/012026" title="DOI Link to resource 10.1088/1742-6596/256/1/012026">CrossRef</a> <a target="_blank" class="URLLink" href="/en/Content/OpenURL/50007600/d2dd00028h/79_1" title="Link via OpenURL Resolver"><img height="14px" alt="" src="/en/Image/GetOpenURLImage/50007600"/></a>.</span></li>
    </ol>
    
    
    
    
    
  <hr/><table><tr><td><h3>Footnotes</h3></td></tr><tr><td><span class="sup_ref">† <span id="fn1">Electronic supplementary information (ESI) available. See <a target="_blank" href="https://doi.org/10.1039/d2dd00028h">https://doi.org/10.1039/d2dd00028h</a></span></span></td></tr><tr><td><span class="sup_ref">‡ <span id="fn2">These authors contributed equally.</span></span></td></tr></table><table><tr><td><hr/></td></tr><tr><td><b>This journal is © The Royal Society of Chemistry 2022</b></td></tr></table></div></div></div></body><script src="/content/scripts/CrossMarkIE.js"> </script><SaxonLicenceTest result="pass" message="Licenced Enterprise Edition [ EE 9.3.0.4 ]"/></html>