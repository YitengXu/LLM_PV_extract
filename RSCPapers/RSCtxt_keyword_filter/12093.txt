Accounting for π–π stacking interactions in the mesoscopic models of conjugated polymers   - Molecular Systems Design & Engineering (RSC Publishing) DOI:10.1039/D0ME00034E View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/D0ME00034E
(Paper)
Mol. Syst. Des. Eng., 2020, 5, 1137-1146Accounting for π–π stacking interactions in the mesoscopic models of conjugated polymers†

        
          
            Vladimir Yu. 
            Rudyak
          
        
      *a, 
      
        
          
            Alexey A. 
            Gavrilov
          
        
      a, 
      
        
          
            Daria V. 
            Guseva
          
        
      b, 
      
        
          
            Shih-Huang 
            Tung
          
        
      c and 

        
          
            Pavel V. 
            Komarov
          
        
      bd
aFaculty of Physics, Lomonosov Moscow State University, Leninskie Gory, 1-2, Moscow 119991, Russia. E-mail: vurdizm@gmail.com
bNesmeyanov Institute of Organoelement Compounds, Russian Academy of Sciences, Vavilova st., 28, Moscow 119991, Russia
cInstitute of Polymer Science and Engineering, National Taiwan University, Taipei 10617, Taiwan
dTver State University, Sadovyj per., 35, Tver 170002, Russia
Received 
      30th March 2020
    , Accepted 9th June 2020First published on 9th June 2020AbstractConjugated polymer films play a decisive role in the construction of photoactive elements in organic electronic devices. Their morphology is mainly determined by self-assembly processes during crystallization initiated by π–π interactions between aromatic rings. However, currently there are only very limited methods to construct polymer matrix models taking into account their crystallization in the framework of computer simulations. In this paper, we propose an extension of a mesoscale modeling methodology based on the dissipative particle dynamics method. We use poly(3-hexylthiophene) (P3HT) as a prototype of the mesoscopic model of polymer chains. To take into account the π–π interactions, we implement the formation and breaking of additional dynamic non-covalent bonds between coarse particles mapped to thiophene rings. We show that the introduction of dynamic bonds makes it possible to simulate the self-assembly of the conjugated polymer chains into a hexagonally packed cylinder morphology and lamellar morphology with large thiophene stacks.

Design, System, Application
The growing demand for clean energy resources caused by the increase in the world's population and the related increase in the consumption of the planet's resources has made research, development, and production of both traditional solar cells and solar cells based on new materials relevant. One of the potential alternatives to crystalline silicon solar cells is organic photovoltaic cells made of thin films based on polymer materials, which can be easily applied layer by layer onto flexible substrates of large area using wet processing methods. The use of polymeric materials gives such promising advantages as ease of processing, possible recyclability, and relatively low cost. A typical structure of a polymer solar cell (PSC) has a multilayer architecture. For the widespread use of polymer solar cells in daily practice, it is necessary to achieve a number of properties, such as high power conversion efficiency, durability, and stability with prolonged exposure to temperature changes. When developing PSCs, many polymeric materials need to be tested. The use of computer simulations can greatly facilitate the process of the design and verification of the properties of various polymers prior to their experimental study. In studying the morphology of a photoactive layer (PL), which is crucial for PSC efficiency, the development of computer models is facing a significant challenge. The fact is that the PL is a nanocomposite in which π-conjugated (semiconducting) polymers are used as matrices. Due to π–π stacking interactions, crystalline domains, which play an important role in the formation of PL properties, are present in the structure of conjugated polymers. However, at present, computer simulation methods have very limited possibilities for constructing models of polymeric materials, taking into account π–π interactions driving self-assembly processes. This problem is especially acute for mesoscopic methods that allow the study of polymeric materials at relatively large length and time scales. In this paper, we propose a method for taking into account π–π stacking interactions in mesoscale models and check it in the framework of the dissipative particle dynamics method. We implement the dynamic bonding of mesoscopic particles in the model of conjugated polymer chains. As a prototype of a polymer model, we use poly(3-hexylthiophene). We show that, taking into account π–π stacking interaction in our model leads to the self-assembly of the polymer chains into large stacks with strong alignment due to the dynamic bonding. These stacks form lamellae, which is in good agreement with the known experimental data. The proposed methodology could be helpful in studies of conjugated polymer materials especially in the design of PSCs and other photovoltaic devices.

1 Introduction
Bulk heterojunction plastic films based on polymer matrices belonging to p-type semiconductors (electron donors) and fillers consisting of n-type semiconductors (electron acceptors), such as n-type conjugated polymers, fullerenes, and quantum dots, are widely used to construct organic photovoltaic devices, e.g., photodiodes, phototransistors, and solar cells (PSC) devices.1–4 The latter attract increasing attention as promising renewable, environmentally friendly sources of cheap electric energy.5 In addition to the chemical composition and molecular architecture of polymers, the morphology of the photoactive layer significantly affects the overall efficiency and thermodynamic stability of PSCs.3,6
Regioregular poly(3-hexylthiophene) (P3HT) (Fig. 1a), which belongs to the semiconducting polymers from the polythiophene family, is one of the most outstanding and the most studied electron-donor materials. Its popularity is primarily due to the relatively high mobility of charge carriers (0.1 cm2/(V × s)) combined with a high degree of solubility.7,8 P3HT has a rigid backbone chain with attached side alkyl chains that increase the solubility of the polymer in organic solvents.9 The degree of P3HT crystallinity varies in the range of 60–70%.7,9,10 The equilibrium crystalline structure of poly(3-hexylthiophene) and its dependence on temperature and molecular weight is still disputed. The X-ray diffraction analysis (XRD) of P3HT films shows that the crystalline domains, consisting of stacked lamellae, alternate with amorphous polymer regions. The crystalline domains are formed via packing of thiophene rings into “stacks” due to the π–π stacking interactions. The following characteristic scales of the spatial organization of the crystalline domains were revealed: the scale of 3.8 Å correlates with the distance between the thiophene rings forming the stacks, the scale of 16 Å correlates with the distance between the P3HT chains separated by the side alkyl chains, and the scale of 28 nm correlates with the spatial periodicity of the lamellar domains.7–10
 Fig. 1  a) Chemical structure of the poly(3-hexylthiophene) monomer. b) The structure of a single P3HT chain in our coarse-grain model (blue solid lines depict covalent bonds between beads of the main chain). Schematic representation of c) a coarse-grained stack of thiophene rings belonging to different P3HT chains (orange dashed lines show dynamic non-covalent bonds, representing π–π stacking). d) The main stages of formation of the dynamic bonds. Visualization of P3HT stacks: e) top view and f) side view. The valence angle, α, between the A-beads is introduced to control the persistence length of the main chain. lb – equilibrium bond length. An additional valence angle γ = 180° between the beads of adjacent chains is introduced to control the alignment of the chains in the stack relative to each other. 
The presence of the crystalline domains in the conjugated polymers can strongly affect the morphology of the formed films, the mobility of charge carriers in them, and consequently the properties of produced electronic devices. Therefore, the theoretical consideration of such systems requires constructing computational models capable of reproducing the structure of crystallizing polymers with maximal possible accuracy. However, this is not easy to implement. The crystallization of polymers is a kinetically controlled process that occurs under the thermodynamic conditions far from the equilibrium state, so the crystal morphology (fibrils, lamellae, axialites or spherulites) depends on the interplay of surface tension and diffusion.11–13 Even in the case of the crystallization of linear flexible chain polymers, the sequence of transitions (occurring at different space and time scales) from strongly entangled states to highly ordered domains takes place. For these reasons, the crystallization process is a difficult problem to be described by rigorous analytical methods, especially for polymers with complex structures and the presence of specific intermolecular interactions such as hydrogen bonds and π–π stacking.13 Today, due to the rapid growth in computer power, simulations have become an important method for the direct study of various processes in complex molecular systems. However, the use of full-atomic molecular mechanics methods such as molecular dynamics (MD) and Monte Carlo (MC) to describe the crystallization processes is limited by the size of the model samples and the duration of their simulations due to the very slow dynamics of these processes. To date, the crystallization of polymers and the preceding stages have been modeled in detail only for linear polymers in the framework of coarse-grained models.14–17 Such modeling in the framework of full-atomic models is performed mainly for single chains.18 For the polymer matrices, the technique is applied only in the framework of united-atom models.19,20
To describe the properties of conjugated polymers, it is necessary to take into account the π–π stacking interaction in computer models. It acts over short distances, has a strong spatial orientation, and it is strong enough to force molecules to self-assemble into highly ordered supramolecular structures called aggregates or stacks. Owing to these features, the polymer chains become effectively rigid, which is revealed in the increased persistent length of the chain. In the case of P3HT, its estimated value ranges from 21 Å to 33 Å.9,21,22 Due to the short intermolecular distances in the stacks, new overlapping molecular orbital levels are created, which contribute to the delocalization of electrons and to the transfer of charge carriers.2 Since π–π interactions are caused by specific electron correlations,23,24 the effect of such interactions is difficult to extrapolate to molecular mechanics methods. In the force fields of molecular mechanics, to some extent, π–π interactions are taken into account by adjusting the partial charges and van der Waals (vdW) interactions of atoms in the composition of aromatic rings.23–26 But this approach cannot fully reproduce the directional effect of π–π interactions on the conjugated polymer morphology formation. In mesoscopic simulations, the problem of taking into account the π–π stacking interactions is poorly investigated.27–34 One of the most successful ways is based on using soft anisotropic non-bonded interactions, which strikes certain difficulties in modeling large systems.35
To date, the structure of P3HT has been repeatedly studied using the computer simulation in the framework of various approximations from the coarse-grained models to the full-atom ones.27–35 In these studies, the crystallization process was considered as a consequence of the stiffness of the polymer chain and the specificity of the intermolecular interaction between coarse-grained particles or united atoms. In this case, the alignment of the thiophene rings due to the π–π stacking is realized only within the framework of the united atom models.34,36
In our recent work,37 we used a mesoscale modeling technique based on the dissipative particle dynamics (DPD) method,38 and studied the possibility of controlling the morphology of the photoactive layer by choosing the chemical structure of the blocks of the conjugated AB copolymer. As a prototype of one of the blocks we used P3HT. The DPD method is effective when predicting the three-dimensional morphology of various polymer materials, which is the result of the self-assembly process.37–40 The DPD method allows the tracking of the evolution of sufficiently large molecular systems in the direction to the ordered thermodynamic equilibrium state due to the reduction of the internal degrees of freedom and use of soft potentials but it does not explicitly take into account the π–π stacking interactions.
In the present work, we modify the DPD model of conjugated polymer chains by introducing additional dynamic non-covalent bonds to take into account the formation of supramolecular morphologies in the P3HT matrix caused by π–π stacking interaction. It should be noted that another important task in the simulation of conjugated polymers is to correctly take into account the conformational properties of polymer chains in particular by carefully fitting the torsion potentials.41–43 However, in this study, to focus on the effect of π–π stacking self-assembly, we did not include torsion potentials in our model.
2 Methods
2.1 Coarse-grained model of P3HT
We used dissipative particle dynamics simulations to model a conjugated polymer matrix. DPD is a mesoscale simulation technique suggested by Hoogerbrugge and Koelman44,45 and developed by Español, Groot, and Warren for simulations of polymers and molecular systems.38,45,46 In this method, the polymer molecules are represented in terms of the bead-and-spring model, with particles governed by Newton's equations and interacting through a conservative force (repulsion), a dissipative force (friction), and a random force (heat generator). Each DPD bead has the same weight m and size σ. For weight, length, energy, and time, the reduced units m = 1, σ = 1, kBT = 1 and  are used (T is the absolute temperature and kB is the Boltzmann constant). A soft repulsive potential enhances the stability of the integration of the equations of motion, and allows the increase in the time step (in comparison with molecular or Brownian dynamics) and thus access to large time and spatial scales in the simulation of complex polymer systems. Recently, this method was successfully used to describe the structure and properties of various polymer systems.31,39,47,48 It is also adopted for simulating chemical reactions and dynamic bonding between particles.49–53 We omit the details of this method because they are well described in the publications mentioned. In addition, a recent review and comparison of different molecular scale simulations on thermosetting polymers can be found in ref. 54. Hereinafter, the dimensionless units were used, which is common in coarse-grained simulations.
As a prototype of the mesoscopic model of a polymer chain, we used the chemical structure of poly(3-hexylthiophene). In this study, the coarse-grained model of the P3HT monomer consisted of one A bead (thiophene fragment) and three B beads (alkyl side chain), as shown in Fig. 1a and b. The system density is ρ = 3σ−3. The simulation box contained 1012 polymer chains of length N = 20 monomers and had a size of lx × ly × lz = 30 × 30 × 30σ−3 (here li is the simulation cell edge in i-th direction), which is approximately 17 × 17 × 17 nm3 (based on the mass of the equivalent atomistic system and the experimental density value for regioregular P3HT of 1.15 g cm−3 (ref. 9)). Thus, the DPD unit length σ is about 0.57 nm. The selected coarsening process is a good compromise, since it allows the structural features of the polymer chain to be adequately reproduced and the morphology of the system to be simulated under conditions of solution and melt.33,31,55 While we considered the P3HT polymer in this study, we believe that the model is widely applicable to other polythiophenes (for example, with different morphologies of the side chains and their arrangement).56
The DPD pair repulsion parameters aAA and aBB were equal to 100, while aAB varied from 100 (no incompatibility between A and B) to 120 (high incompatibility between A and B). The test of the model at different degrees of compatibility between the backbone and side chains was conducted for better understanding of the capability of the model to reproduce the behaviour of polymers with various chemical structures. An evaluation of the repulsion parameter αAB corresponding to the case of P3HT is described in the ESI.† The harmonic potential with an equilibrium bond length lb = 0.5σ and a bond strength Kb = 50 kBT/σ2 was applied to all bonds. Such combination of repulsion parameters and bond strength was used to avoid the formation of unnatural local structures. In addition, the harmonic valence angle potentials with an equilibrium angle α0 = 180° and various stiffness KA values were applied to the main chain to maintain its persistence length (which is governed by angle α, see Fig. 1(b)). The friction coefficient is γ = 4.5τ−1. For the improved stability of the integration scheme we used for integration of equations of motion, the time step Δt = 0.01τ. No torsion potential was included in the interactions, and thus we excluded from our model the effects of the regioregularity or the interdigitation of the side chains. At the same time, the model is fully compatible with torsion potentials, and the regioregularity of the polymer can be easily taken into account in the future.
2.2 π–π stacking via dynamic bonding
In our model, π–π interactions were introduced via dynamic bonding of main chain beads (of type A in Fig. 1). In this respect, our model resembles previous studies with saturated bonds.57 The formation and breaking of dynamic non-covalent bonds between these beads were based on the concept of “mesoscale chemistry”, in which reactions are probabilistic, for details see ref. 52 and 58–60. For this purpose at the beginning of simulations, beads of type A are assigned a valence number of 2 that means these beads can form two additional bonds between each other.
Two reactions were implemented: 1) dynamic bond formation reaction and 2) dynamic bond breaking reaction. For dynamic bond formation, we used the following algorithm. At regular intervals, for every bead i of type A with free valence (called primary bead below), the search for neighbor j satisfying the following conditions was performed (see Fig. 1d):
1. Bead j also has type A.
2. Bead j is within a reaction radius Rreact = 0.8σ from bead i.
3. Bead j has free valence.
4. Beads i and j are not already bonded with each other.
5. If beads i and j belong to the same main chain, they are not closer than 3 bonds away from each other.
6. There is no bead k in the system, which is bonded (statically or dynamically) to both beads i and j. In other words, the formation of triangles of bonds is forbidden.
Dynamic non-covalent bond formation and breaking procedures were executed consequently every 200 Δt DPD steps, which was enough to satisfy the local relaxation of the polymer chains.59,60 When these procedures were triggered, the closest neighbor was chosen from the list of neighbors satisfying the conditions. With probability pcreate the new dynamic bond was formed (equilibrium bond length ld = 0.5σ and bond strength Kb = 50 kBT/σ2, same as for regular bonds). The new bond angles were added to take into account the high sensitivity of π–π bonds to the mutual position and orientation of the chains. These angles between the new dynamic bond and existing dynamic bonds are marked as γ in Fig. 1c and e, and are characterized by an equilibrium angle γ0 = 180° and an angle strength Kγ = 5kBT/rad2. These angles, together with the steric interactions of neighbour particles, control the planar orientation of the stacks formed by multiple chains, see Fig. 1(f).
For dynamic non-covalent bond breaking, each existing dynamic bond was deleted with probability pbreak, and the bond angles including this bond were also removed from the system. The bond breaking procedure was executed right after the bond formation procedure, thus setting pbreak = 1 led to the absence of dynamic bonds. The lower the value pbreak, the more dynamic bonds were formed. The ratio pcreate/pbreak has been varied from 1 to 10.
2.3 Simulation protocol and structural analysis
All simulations were performed using the in-house DPD package previously used in many studies.60–64 Starting conformations were generated by randomly placing polymer chains in simulation boxes. Each system was equilibrated for 2 × 108 Δt steps (2 × 106τ DPD time units). Then the structural properties were estimated during a productive run of 0.5 × 108 Δt steps.
The static structure factor was calculated as  where n is the total number of particles, and averaging is performed over the wave vector set qx, qy, and qz = 2πk/lx, 2πm/ly, and 2πp/lz, where k, m, and p are integers from 1 to 32, and over a sequence of independent system conformations. Conformations at a frequency of 105 steps were taken for averaging.
3 Results and discussion
The primary results of our simulations are the equilibrated phases of the model melt of thiophene oligomers under various conditions. Even at the fixed architecture of the model polymer, there are several model parameters that affect the resulting morphology of the system. Here, we focus on the discussion of the effect of such parameters as the rigidity of main chains (which is governed by KA), the miscibility between main and side chains (χAB), and the ratio of the formation and breaking of dynamic bonds (pcreate/pbreak). Supposedly, the exact values of these parameters can be extracted from quantum mechanical simulations for any certain thiophene polymer. At the same time, these values vary with temperature, sidechain structure, and additional compounds. Therefore, we were interested in exploring the regimes and morphologies, which the model allows to obtain, rather than in limiting the simulations to a single compound. For this purpose, we first studied the impact of each parameter independently. In the subsections below, we first report the behavior of the model without π–π interaction between thiophene particles. Second, we report the phase diagram of the system with π–π interaction (by allowing formation of various amounts of dynamic bonds) and chemical incompatibility between thiophene and side chains. Additionally, structural analysis of each obtained phase is shown. Finally, we present the mutual effect of dynamic bonding and main chain stiffness in the absence of chemical incompatibility between the system components to explore the limits of the model.
3.1 System behavior without dynamic bonding
First of all, we equilibrated the melt without dynamic non-covalent bonds. The chemical incompatibility between thiophene chains and side chains was simulated by the difference in DPD repulsion potential Δa = aAB − aAA. According to ref. 38, we used the linear relation between Δa and the Flory–Huggins parameter, viz., χAB ≈ 0.3Δa. We varied χAB from 0 to 12 (corresponding to Δa from 0 to 40). The angle stiffness of main chains KA varied from 3kbT/rad2 (soft chains) to 24kbT/rad2 (rigid chains). The resulting phase diagram is shown in Fig. 2. At χAB = 0, the system remained disordered after equilibration at all values of KA (black squares in Fig. 2). Introduction of chemical incompatibility (χAB > 0) led to the microphase separation and formation of hexagonal packed cylinders phase (red circles in Fig. 2) at sufficiently high KA or χAB. In contrast to the predictions of the coarse-grained molecular dynamics model,30 the soft DPD potential leads to the absence of a lamellar morphology in a reasonable range of parameters. Thus, the introduction of π–π stacking is required to obtain the morphological features of P3HT.
 Fig. 2  Phase diagram of equilibrated systems at various angle stiffness KA values and incompatibility parameters for the main and side chains χAB. Dynamic non-covalent bonds are switched off (no π–π stacking). The value of χAB = 3 corresponds to the case of P3HT (see the ESI†). 
3.2 Effect of component incompatibility in the system with dynamic bonding
To obtain morphologies with higher ordering, we introduced dynamic bonding between neighbor thiophene chains. The balance between bond formation and breaking can be expressed by the dynamic bonding rate pcreate/pbreak, which effectively regulates the amount of dynamic bonds in the system. We varied pcreate/pbreak from 1 to 10. The dynamic bonding rate pcreate/pbreak = 1 leads to the absence of dynamic bonds in the system, i.e., no π–π stacking. The low dynamic bonding rate pcreate/pbreak = 2 results in 6–30% of the maximum possible number of dynamic bonds depending on incompatibility and thus corresponds to weak π–π interaction. The high dynamic bonding rate pcreate/pbreak = 10 leads to 60–80% of the maximum possible number of dynamic bonds, which can be interpreted as strong π–π interaction. The Flory–Huggins parameter χAB varied from 0 to 12. The main chain stiffness was fixed at KA = 12kbT/rad2 in this section.

Fig. 3(a) presents the phase diagram in χABversus pcreate/pbreak coordinates, along with the simulation snapshots for each obtained type of morphology: disordered (black squares), cylinders (red circles), lamellae (full blue triangles) and distorted lamellae (empty blue triangles). The same morphologies are shown in more detail in the ESI,† Fig. S1, S2, S4 and S5. First of all, systems with low χAB and weak π–π stacking exhibit no particular order. Similar to Fig. 2, increasing incompatibility between thiophene and side chains up to χAB ≈ 4.5 leads to the formation of hexagonal packed cylinder phases. Intermediate π–π stacking also stabilizes this phase at χAB = 0 (Fig. 3(c)). In this phase, the core of the cylindrical aggregate is formed by the thiophene chains interconnected by rare dynamic bonds (see details in the ESI,† Fig. S3). All side chains are pushed out into the space between the aggregates. The same morphology was previously obtained by Marsh30 in a mesoscopic model of thiophene-based oligomers with side chains arranged on the one side of the backbone. Thus, the presence of the HEX phase is the consequence of the absence of a torsion potential in our model. On the one hand, the fibrillar phase in P3HT has a different structure.65,66 On the other hand, the obtained results may illustrate self-assembly in terthiophene–thieno[3,4-c]pyrrole-4,6-dione based conjugated polymers (P3TTPD) with a different side chain orientation. P3TTPD is a comb-like polymer with two side chains on the thieno[3,4-c]pyrrole-4,6-dione (TPD) unit. Since P3TTPD and P3HT are similar in chemical composition (but with different chain structures), these polymers correspond to the same value of the parameter χAB and, as a result, the same horizontal line in the phase diagram (Fig. 3). Moreover, due to the different mutual orientations of the side chains in P3TTPD, “from each other” and “towards each other” (outward and inward), different P3TTPD series have different degrees of co-planarity. The outward series of P3TTPD has a higher co-planarity of the thiophene rings than the inward series. A high degree of co-planarity of the thiophene rings leads to the formation of more π–π bonds between polymer chains and vice versa, which corresponds to different regions of the phase diagram. Indeed, due to this structural feature, a lamellar morphology is formed in the samples of the outward series of P3TTPD (as in the case of P3HT), and a cylindrical morphology is formed in the inward series,56 which our model illustrates well.
 Fig. 3  (a) Phase diagram of equilibrated systems at various dynamic bonding rates pcreate/pbreak and Flory–Huggins parameters χAB of the main and side chains. Dash lines show the approximate positions of boundaries between phases. Snapshots of obtained morphologies: (b) disordered, (c) cylinders, (d) lamellae, and (e) distorted lamellae. The snapshots show only thiophene chains (blue) and dynamic non-covalent bonds between them (red), while side chains are not shown. The angle stiffness of the main chains KA = 12kbT/rad2. The value of χAB = 3 corresponds to the case of P3HT (see the ESI†). 
At higher dynamic bonding rates, the system switches to a lamellar morphology (see Fig. 3(d)). In this state the thiophene chains form large stacks within each lamella (see Fig. 4). Side chains fill the gaps between these planes (detailed structures are shown in the ESI,† Fig. S4). On average, these stacks contain 10–20 thiophene chains, and exhibit moderate longitudinal alignment together with high transverse directional order. Different stacks inside one lamella are not well aligned to each other, as well as stacks from different lamellae. Presumably, larger stacks may be formed in our model as well as stacks in one lamella may align in a single direction. However, the simulation time required for re-alignment of stacks may be long, and an arbitrary box size may be incompatible with such alignment. Also, stacks from neighbour lamellae do not form larger aggregates in our model due to the softness of the side chains together with their random orientation towards the lamellae. The inclusion of torsion potentials presumably will lead to the interdigitation of side chains, which in turn may lead to the mutual alignment of stacks in neighbor lamellae.
 Fig. 4  Organisation of thiophene chains in a lamella. (a) The simulation box with the selected lamella. (b) Snapshot of the selected lamella (blue – thiophene chains, red – dynamic non-covalent bonds). (c) The same lamella after the empirical reconstruction of possible π–π bonds. 
Unexpectedly, the further increase of dynamic bonding rate does not improve the lamellar structure. Instead, it leads to the formation of a distorted lamellar morphology, in which the general lamellar structure remains, but the stacks tend to bend, and a significant amount of stacks participate in more than one lamella at a time (Fig. 3(e)). As a result, there is no particular lamellar plane direction, and the system loses the long-range order. At the same time, the average interlayer distance remains the same as in the regular lamellar phase (detailed structures are shown in the ESI,† Fig. S5).
We computed static structure factors S(q) for the observed morphologies in order to characterize their characteristic spatial scales more precisely. Fig. 5 shows S(q) separately for thiophene and side chains in the range of q/2π between 1/30σ−1 and 1σ−1, according to the box size. In the disordered system (Fig. 5(a)), the single smooth peak at q/2π ∼ 0.35σ−1 (wavelength λ ∼ 2.86σ ∼ 16.3 Å) corresponds to the mean distance between thiophene chains. The same peaks were found in other phases, which corresponds to the mean distance between fibrils in the cylinder phase (Fig. 5(b)) and to the mean interlamellar distance in lamellar phases (Fig. 5(c) and (d)). In the latter case, it is the same peak as the (100) peak for SAXS measurements.7Fig. 5(b–d) show secondary peaks with positions relating to the primary peak q* as q*:31/2q*:41/2q*:71/2q* (Fig. 5(b)) and q*:2q*:3q* (Fig. 5(c)), which is typical for hexagonally packed cylinders and lamellae, correspondingly.7,67
 Fig. 5  The structural factors S(q) of the observed morphologies: (a) disordered phase, (b) HEX phase, (c) lamellar phase with strong order, and (d) lamellar phase with weak order. 
Additional analysis of chain ordering is shown in the ESI,† section S4.
The investigation of the effect of the main chain length on the phase diagram shown the same results for chain lengths 20 and 40 (see the ESI,† section S5 for details).
3.3 Effect of dynamic bonding in chemically homogeneous systems
Finally, we investigated in detail the ability of the model to represent self-assembly in the systems without chemical incompatibility between main and side chains (χAB = 0). For this purpose, we equilibrated systems with various main chain rigidities KA and dynamic bonding rates pcreate/pbreak. The phase diagram for this setup contains disordered, cylindric, and distorted lamellar phases, as shown in Fig. 6. As well as in the case before, the formation of dynamic non-covalent bonds results in the self-assembly of the main chains into cylinders and, at higher pcreate/pbreak, into lamellae. The larger the persistent length of the main chains, the lower the amount of dynamic bonds required for the predominance of ordered phases. Comparing the effect of the formation of dynamic bonds with the effect of chemical incompatibility, we could note the following two differences. On the large scale, the formation of dynamic bonds gives both cylindrical and lamellar phases. The latter one was not obtained without dynamic bonds at any reasonable χAB. On the small scale, the formation of dynamic bonds results in additional ordering of the chains in a single lamella into stacks, which is impossible to observe in systems with solely chemical incompatibility.
 Fig. 6  (a) Phase diagram of equilibrated systems at various dynamic bonding rates pcreate/pbreak and angle stiffness KA values of the main chains. Dash lines show the approximate positions of boundaries between phases. Snapshots of obtained morphologies: (b) disordered, KA = 3kbT/rad2, (c) disordered, KA = 24kbT/rad2, (d) cylinders, and (e) distorted lamellae. The snapshots show only main chains (blue) and dynamic non-covalent bonds between them (red), while side chains were not shown. 
4 Conclusions and outlook
In this paper, we propose a mesoscale model of a conjugated polymer matrix with dynamic bonding, reproducing π–π stacking. This model allows thiophene rings to form stacks, whose existence was previously shown experimentally. In turn, thiophene stacking leads to the ordering of the system into cylindrical, lamellar or distorted lamellar phases, depending on the main chain persistence length, chemical incompatibility of the polymer components, and non-covalent bond strength. The disordered phase occurs at low persistence length and low incompatibility. At higher persistence lengths, intrinsic to the P3HT polymer, both dynamic bonding and incompatibility of polymer components allow the formation of hexagonal cylinders and lamellar phases. Unlike previous models without π–π stacking, our model leads to self-assembly of the polymer chains into large stacks with strong alignment due to dynamic bonding. In turn, these stacks form lamellae, which is in good agreement with the known experimental data.
In summary, we believe that the inclusion of π–π stacking into the DPD method via a dynamic bonding mechanism in our model is the next step towards realistic large scale simulations of polythiophene composites. As shown above, dynamic bonding allows simulation of the π–π stacking driven self-assembly of polythiophene-like polymers, which seems to be the initial phase of the crystallization process of such compounds. The model can be tuned to reproduce the morphology features of an individual material via dynamic bonding parameters. Currently, our model does not include the potentials required for chain regioregularity, which is obtained in other models.30,34 Regioregularity is one of the possible mechanisms of mutual alignment of chains pertaining to neighboring lamellae. Thereby the corresponding future expansion of the model will supposedly allow the simulation of the self-assembly of polycrystalline structures in P3HT melts more realistically. This is important for constructing large full-atomic material models (using the reverse mapping procedure52,64) based on the equilibrated mesoscopic models of conjugated polymer matrices. At the same time, our model is not limited to P3HT compounds. In principle, any compound of the common nature can be translated into mesoscopic representation compatible with our approach. It opens up the possibilities for investigating the influence of non-covalent bonding in the self-assembly of a wide range of π-conjugated polymers.
Conflicts of interest
There are no conflicts to declare.
Acknowledgements
The financial support of the Russian Foundation for Basic Research (project 19-53-52004), the Ministry of Science and Technology of Taiwan (Project MOST 108-2923-E-002-001-MY3) and Ministry of Science and Higher Education of the Russian Federation is highly appreciated. The research is carried out using the equipment of the shared research facilities of HPC computing resources at Lomonosov Moscow State University. The authors would like to thank V. A. Ivanov for the constructive criticism of the manuscript.
Notes and references
K. M. Coakley and M. D. McGehee, Chem. Mater., 2004, 16, 4533–4542 CrossRef CAS .
L. Lu, T. Zheng, Q. Wu, A. M. Schneider, D. Zhao and L. Yu, Chem. Rev., 2015, 115, 12666–12731 CrossRef CAS PubMed .
S. H. Mir, L. A. Nagahara, T. Thundat, P. Mokarian-Tabari, H. Furukawa and A. Khosla, J. Electrochem. Soc., 2018, 165, B3137–B3156 CrossRef CAS .
J. R. Sheats, J. Mater. Res., 2004, 19, 1974–1989 CrossRef CAS .
A. J. Heeger, Adv. Mater., 2014, 26, 10–28 CrossRef CAS PubMed .

          S. R. Puniredd, W. Pisula and K. Müllen, in Handbook of Organic Materials for Optical and (Opto)electronic Devices, Elsevier,  2013, pp. 83–101 Search PubMed .
Z. Wu, A. Petzold, T. Henze, T. Thurn-Albrecht, R. H. Lohwasser, M. Sommer and M. Thelakkat, Macromolecules, 2010, 43, 4646–4653 CrossRef CAS .
C. M. Wolf, K. H. Kanekal, Y. Y. Yimer, M. Tyagi, S. Omar-Diallo, V. Pakhnyuk, C. K. Luscombe, J. Pfaendtner and L. D. Pozzo, Soft Matter, 2019, 15, 5067–5083 RSC .
H. W. Ro, B. Akgun, B. T. O'Connor, M. Hammond, R. Joseph Kline, C. R. Snyder, S. K. Satija, A. L. Ayzner, M. F. Toney, C. L. Soles and D. M. DeLongchamp, Macromolecules, 2012, 45, 6587–6599 CrossRef CAS .
P. Kohn, Z. Rong, K. H. Scherer, A. Sepe, M. Sommer, P. Müller-Buschbaum, R. H. Friend, U. Steiner and S. Hüttner, Macromolecules, 2013, 46, 4002–4013 CrossRef CAS .

          L. Mandelkern, Crystallization of Polymers, Cambridge University Press, Cambridge, UK, 2nd edn,  2011 Search PubMed .
M. Zhang, B.-H. Guo and J. Xu, Crystals, 2017, 7, 4–37 CrossRef .

Progress in Understanding of Polymer Crystallization, ed. G. Reiter and G. R. Strobl, Springer,  2007 Search PubMed .
H. Meyer and F. Müller-Plathe, Macromolecules, 2002, 35, 1241–1252 CrossRef CAS .
Y. Termonia, Biomacromolecules, 2004, 5, 2404–2407 CrossRef CAS PubMed .
T. Yamamoto, Polymer, 2009, 50, 1975–1985 CrossRef CAS .
J.-U. Sommer and C. Luo, J. Polym. Sci., Part B: Polym. Phys., 2010, 48, 2222–2232 CrossRef CAS .
X.-B. Zhang, Z.-S. Li, Z.-Y. Lu and C.-C. Sun, Macromolecules, 2002, 35, 106–111 CrossRef CAS .
T. Verho, A. Paajanen, J. Vaari and A. Laukkanen, Macromolecules, 2018, 51, 4865–4873 CrossRef CAS PubMed .
K. Hagita, S. Fujiwara and N. Iwaoka, J. Chem. Phys., 2019, 150, 074901 CrossRef PubMed .
G. W. Heffner and D. S. Pearson, Macromolecules, 1991, 24, 6295–6299 CrossRef CAS .
B. Cesar, M. Rawiso, A. Mathis and B. François, Synth. Met., 1997, 84, 241–242 CrossRef CAS .
J. Sponer, P. Jurecka, I. Marchan, F. J. Luque, M. Orozco and P. Hobza, Chemistry, 2006, 12, 2854–2865 CrossRef CAS PubMed .
R. Zhao and R.-Q. Zhang, Phys. Chem.
Chem. Phys., 2016, 18, 25452–25457 RSC .
R. S. Paton and J. M. Goodman, J. Chem. Inf. Model., 2009, 49, 944–955 CrossRef CAS PubMed .

          R. Zhou, Modeling of Nanotoxicity: Molecular Interactions of Nanomaterials with Bionanomachines, Springer,  2015 Search PubMed .
C.-K. Lee, C.-W. Pao and C.-W. Chu, Energy Environ. Sci., 2011, 4, 4124–4132 RSC .
D. Dudenko, A. Kiersnowski, J. Shu, W. Pisula, D. Sebastiani, H. W. Spiess and M. R. Hansen, Angew. Chem., Int. Ed., 2012, 51, 11068–11072 CrossRef CAS .
S. Obata and Y. Shimoi, Phys. Chem. Chem. Phys., 2013, 15, 9265–9270 RSC .
H. S. Marsh, E. Jankowski and A. Jayaraman, Macromolecules, 2014, 47, 2736–2747 CrossRef CAS .
C. Du, Y. Ji, J. Xue, T. Hou, J. Tang, S.-T. Lee and Y. Li, Sci. Rep., 2015, 5, 16854 CrossRef CAS .
S. E. Root, S. Savagatrup, C. J. Pais, G. Arya and D. J. Lipomi, Macromolecules, 2016, 49, 2886–2894 CrossRef CAS .
K. N. Schwarz, T. W. Kee and D. M. Huang, Nanoscale, 2013, 5, 2017–2027 RSC .
E. D. Miller, M. L. Jones, M. M. Henry, P. Chery, K. Miller and E. Jankowski, Polymers, 2018, 10, 1305 CrossRef PubMed .
C. Greco, A. Melnyk, K. Kremer, D. Andrienko and K. C. Daoulas, Macromolecules, 2019, 52, 968–981 CrossRef PubMed .
M. M. Henry, M. L. Jones, S. D. Oosterhout, W. A. Braunecker, T. W. Kemper, R. E. Larsen, N. Kopidakis, M. F. Toney, D. C. Olson and E. Jankowski, J. Phys. Chem. C, 2017, 121, 26528–26538 CrossRef .
P. Komarov, P. Baburkin, V. Ivanov, S.-A. Chen and A. Khokhlov, Mol. Syst. Des. Eng., 2019, 4, 390–395 RSC .
R. D. Groot and P. B. Warren, J. Chem. Phys., 1997, 107, 4423–4435 CrossRef CAS .
A. A. Markina, V. A. Ivanov, P. V. Komarov, A. R. Khokhlov and S.-H. Tung, J. Phys. Chem. B, 2017, 121, 7878–7888 CrossRef CAS PubMed .
D. S. Dolgov, T. E. Grigor'ev, A. I. Kulebyakina, E. V. Razuvaeva, R. A. Gumerov, S. N. Chvalun and I. I. Potemkin, Polym. Sci., Ser. A, 2018, 60, 902–910 CrossRef CAS .
J. Sjöqvist, M. Linares, K. V. Mikkelsen and P. Norman, J. Phys. Chem. A, 2014, 118, 3419–3428 CrossRef PubMed .
C. Cozza, M. Bonomi and A. Pietropaolo, J. Chem. Theory Comput., 2018, 14, 5441–5445 CrossRef CAS .

          O. A. Guskova, in Quantum Systems in Physics, Chemistry, and Biology, Springer International Publishing,  2017, pp. 209–230 Search PubMed .
P. J. Hoogerbrugge and J. M. V. A. Koelman, Europhys. Lett., 1992, 19, 155–160 CrossRef .
J. M. V. A. Koelman and P. J. Hoogerbrugge, Europhys. Lett., 1993, 21, 363–368 CrossRef CAS .
P. Español and P. Warren, Europhys. Lett., 1995, 30, 191–196 CrossRef .
P. Komarov, A. Markina and V. Ivanov, Chem. Phys. Lett., 2016, 653, 24–29 CrossRef CAS .
A. Markina, V. Ivanov, P. Komarov, S. Larin, J. M. Kenny and S. Lyulin, J. Polym. Sci., Part B: Polym. Phys., 2017, 55, 1254–1265 CrossRef CAS .
A. V. Berezkin and Y. V. Kudryavtsev, Macromolecules, 2011, 44, 112–121 CrossRef CAS .
C. Svaneborg, Comput. Phys. Commun., 2012, 183, 1793–1802 CrossRef CAS .
P. V. Komarov, O. E. Zaborina, T. P. Klimova, V. I. Lozinsky, P. G. Khalatur and A. R. Khokhlov, Chem. Phys. Lett., 2016, 661, 219–223 CrossRef CAS .
D. V. Guseva, V. Y. Rudyak, P. V. Komarov, A. V. Sulimov, B. A. Bulgakov and A. V. Chertovich, J. Polym. Sci., Part B: Polym. Phys., 2018, 56, 362–374 CrossRef CAS .
S. Thomas, M. Alberts, M. M. Henry, C. E. Estridge and E. Jankowski, J. Theor. Comput. Chem., 2018, 17, 1840005 CrossRef CAS .
C. Li and A. Strachan, J. Polym. Sci., Part B: Polym. Phys., 2015, 53, 103–122 CrossRef CAS .
J. Gross, M. Ivanov and W. Janke, J. Phys.: Conf. Ser., 2016, 750, 012009 CrossRef .
C.-A. Chen, P.-C. Yang, S.-C. Wang, S.-H. Tung and W.-F. Su, Macromolecules, 2018, 51, 7828–7835 CrossRef CAS .
A. V. Chertovich, V. A. Ivanov, A. R. Khokhlov and J. Bohr, J. Phys.: Condens. Matter, 2003, 15, 3013–3027 CrossRef CAS .
A. V. Berezkin, P. G. Khalatur and A. R. Khokhlov, J. Chem. Phys., 2003, 118, 8049–8060 CrossRef CAS .
D. V. Guseva, Y. V. Kudryavtsev and A. V. Berezkin, J. Chem. Phys., 2011, 135, 204904 CrossRef PubMed .
A. V. Berezkin and Y. V. Kudryavtsev, J. Chem. Phys., 2014, 141, 194906 CrossRef PubMed .
V. Y. Rudyak, A. A. Gavrilov, D. V. Guseva and A. V. Chertovich, Macromol. Theory Simul., 2017, 26, 1700015 CrossRef .
A. A. Gavrilov and A. V. Chertovich, Macromolecules, 2017, 50, 4677–4685 CrossRef CAS .
V. Y. Rudyak, A. A. Gavrilov, E. Y. Kozhunova and A. V. Chertovich, Soft Matter, 2018, 14, 2777–2781 RSC .
D. V. Guseva, V. Y. Rudyak, P. V. Komarov, B. A. Bulgakov, A. V. Babkin and A. V. Chertovich, Polymer, 2018, 10, 792 Search PubMed .
Y. Han, Y. Guo, Y. Chang, Y. Geng and Z. Su, Macromolecules, 2014, 47, 3708–3712 CrossRef CAS .
S. Lee, H. Jeon, M. Jang, K.-Y. Baek and H. Yang, ACS Appl. Mater. Interfaces, 2015, 7, 1290–1297 CrossRef CAS .

          I. Hamley and V. Castelletto, in Soft Matter Characterization, ed. R. Borsali and R. Pecora, Springer Netherlands, Dordrecht,  2008, vol. 13, pp. 1021–1081 Search PubMed .

Footnote† Electronic supplementary information (ESI) available. See DOI: 10.1039/d0me00034eThis journal is © The Royal Society of Chemistry 2020
Table Content:

Design, System, Application
The growing demand for clean energy resources caused by the increase in the world's population and the related increase in the consumption of the planet's resources has made research, development, and production of both traditional solar cells and solar cells based on new materials relevant. One of the potential alternatives to crystalline silicon solar cells is organic photovoltaic cells made of thin films based on polymer materials, which can be easily applied layer by layer onto flexible substrates of large area using wet processing methods. The use of polymeric materials gives such promising advantages as ease of processing, possible recyclability, and relatively low cost. A typical structure of a polymer solar cell (PSC) has a multilayer architecture. For the widespread use of polymer solar cells in daily practice, it is necessary to achieve a number of properties, such as high power conversion efficiency, durability, and stability with prolonged exposure to temperature changes. When developing PSCs, many polymeric materials need to be tested. The use of computer simulations can greatly facilitate the process of the design and verification of the properties of various polymers prior to their experimental study. In studying the morphology of a photoactive layer (PL), which is crucial for PSC efficiency, the development of computer models is facing a significant challenge. The fact is that the PL is a nanocomposite in which π-conjugated (semiconducting) polymers are used as matrices. Due to π–π stacking interactions, crystalline domains, which play an important role in the formation of PL properties, are present in the structure of conjugated polymers. However, at present, computer simulation methods have very limited possibilities for constructing models of polymeric materials, taking into account π–π interactions driving self-assembly processes. This problem is especially acute for mesoscopic methods that allow the study of polymeric materials at relatively large length and time scales. In this paper, we propose a method for taking into account π–π stacking interactions in mesoscale models and check it in the framework of the dissipative particle dynamics method. We implement the dynamic bonding of mesoscopic particles in the model of conjugated polymer chains. As a prototype of a polymer model, we use poly(3-hexylthiophene). We show that, taking into account π–π stacking interaction in our model leads to the self-assembly of the polymer chains into large stacks with strong alignment due to the dynamic bonding. These stacks form lamellae, which is in good agreement with the known experimental data. The proposed methodology could be helpful in studies of conjugated polymer materials especially in the design of PSCs and other photovoltaic devices.


 	Fig. 1  a) Chemical structure of the poly(3-hexylthiophene) monomer. b) The structure of a single P3HT chain in our coarse-grain model (blue solid lines depict covalent bonds between beads of the main chain). Schematic representation of c) a coarse-grained stack of thiophene rings belonging to different P3HT chains (orange dashed lines show dynamic non-covalent bonds, representing π–π stacking). d) The main stages of formation of the dynamic bonds. Visualization of P3HT stacks: e) top view and f) side view. The valence angle, α, between the A-beads is introduced to control the persistence length of the main chain. lb – equilibrium bond length. An additional valence angle γ = 180° between the beads of adjacent chains is introduced to control the alignment of the chains in the stack relative to each other.	 

 		 

 	Fig. 2  Phase diagram of equilibrated systems at various angle stiffness KA values and incompatibility parameters for the main and side chains χAB. Dynamic non-covalent bonds are switched off (no π–π stacking). The value of χAB = 3 corresponds to the case of P3HT (see the ESI†).	 

 	Fig. 3  (a) Phase diagram of equilibrated systems at various dynamic bonding rates pcreate/pbreak and Flory–Huggins parameters χAB of the main and side chains. Dash lines show the approximate positions of boundaries between phases. Snapshots of obtained morphologies: (b) disordered, (c) cylinders, (d) lamellae, and (e) distorted lamellae. The snapshots show only thiophene chains (blue) and dynamic non-covalent bonds between them (red), while side chains are not shown. The angle stiffness of the main chains KA = 12kbT/rad2. The value of χAB = 3 corresponds to the case of P3HT (see the ESI†).	 

 	Fig. 4  Organisation of thiophene chains in a lamella. (a) The simulation box with the selected lamella. (b) Snapshot of the selected lamella (blue – thiophene chains, red – dynamic non-covalent bonds). (c) The same lamella after the empirical reconstruction of possible π–π bonds.	 

 	Fig. 5  The structural factors S(q) of the observed morphologies: (a) disordered phase, (b) HEX phase, (c) lamellar phase with strong order, and (d) lamellar phase with weak order.	 

 	Fig. 6  (a) Phase diagram of equilibrated systems at various dynamic bonding rates pcreate/pbreak and angle stiffness KA values of the main chains. Dash lines show the approximate positions of boundaries between phases. Snapshots of obtained morphologies: (b) disordered, KA = 3kbT/rad2, (c) disordered, KA = 24kbT/rad2, (d) cylinders, and (e) distorted lamellae. The snapshots show only main chains (blue) and dynamic non-covalent bonds between them (red), while side chains were not shown.	 
Footnote
† Electronic supplementary information (ESI) available. See DOI: 10.1039/d0me00034e

This journal is © The Royal Society of Chemistry 2020
