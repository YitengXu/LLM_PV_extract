Data-driven approach towards identifying dyesensitizer molecules for higher power conversion efficiency in solar cells   - New Journal of Chemistry (RSC Publishing) DOI:10.1039/D1NJ05498H View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/D1NJ05498H
(Paper)
New J. Chem., 2022, 46, 4395-4405Data-driven approach towards identifying dyesensitizer molecules for higher power conversion efficiency in solar cells†

        
          
            Ganapathi Rao 
            Kandregula
          
        
      a, 
      
        
          
            Dhinesh Kumar 
            Murugaiah
          
        
      a, 
      
        
          
            N. Arul 
            Murugan
          
        
      *bc and 

        
          
            Kothandaraman 
            Ramanujam
          
        
      *ade
aDepartment of Chemistry, Indian Institute of Technology Madras, Chennai 600 036, India. E-mail: rkraman@iitm.ac.in
bDepartment of Computer Science, School of Electrical Engineering and Computer Science 106 91, Stockholm, Sweden. E-mail: murugan@kth.se
cDepartment of Computational Biology, Indraprastha Institute of Information Technology, New Delhi 110020, India
dDST-IITM Solar Energy Harnessing Centre, Indian Institute of Technology Madras, Chennai 600036, India
ePotential Centre of Excellence, Advanced Centre for Energy Storage and Conversion, Indian Institute of Technology Madras, Chennai 600036, India
Received 
      18th November 2021
    , Accepted 27th January 2022First published on 27th January 2022AbstractMachine learning (ML) research based on the quantitative structure–property relationship (QSPR) has been applied for the development of highly efficient dye-sensitized solar cells (DSSCs). This study brings forward a robust method for interpreting the QSPR model of 1448 dye molecules by combining three different properties, namely structural, quantum and experimental, in identifying the power conversion efficiency (PCE) of DSSCs via machine learning (ML) and computational methods. The features used for building the ML models to estimate PCE were extracted from PaDEL (structural properties), density functional theory (DFT)/time-dependent DFT (TD-DFT) (quantum properties) and literature/database (experimental properties). The descriptors with the most influence towards predicting the PCE were selected for developing various ML models based on linear regression, sequential minimal optimization (SMO) regression, random forest and multilayer perception neural networks. Random forest emerged as the best model with a prediction accuracy of 95.31% and a root mean squared error (RMSE) of 0.802. The reliability of the models was validated through 10-fold cross-validation. The developed ML model gives us insight into various descriptors having dominant contributions towards PCE, which has been used to propose novel dye molecules for DSSCs with improved efficiency. Interestingly, 75% of the designed molecules showed an improvement in PCE when compared to the parent molecules, which clearly indicates that such a data-driven approach can be used to design novel molecules with improved energy efficiency.
1. Introduction
Development within the renewable energy resource sector has been rapid due to global energy demand. In addressing the growing energy demand for uninterrupted energy generation, conventional fossil fuels are still projected to be the first choice of energy resources. As not all countries have access to fossil fuels, the only way to achieve energy security is to focus on renewable sources such as wind and solar. In the last few decades, enormous efforts have been made to develop suitable light-harvesting systems, one of them being dye-sensitized solar cells (DSSCs). This is preferred as it involves simple process steps, is cheaper and uses environmentally benign chemicals. As DSSCs rely on organic dyes for light harvesting, ample structural engineering routes can modify the dye to achieve higher power conversion efficiency (PCE).1
Normally, a dye is adsorbed onto a wide bandgap semiconductor such as TiO2 to harvest the electrons out of the excitons generated by light. The dye/sensitizer is the key element as it controls photon harvesting and electron transport into the nanostructured semiconductor surface and can govern the interfacial behavior of electron transfer. Dyes can be classified into two types: inorganic metal-based dye sensitizers and organic metal-free dye-sensitizers. To date, ruthenium2- and Zn-based3 (metal-based) DSSCs have demonstrated the highest PCEs of 11.18%2 and 13%,3 respectively. The push pull type (D–π–A, where D, π and A stand for donor, conjugated spacer and acceptor, respectively) organic metal-free dye ADEKA-1 with LEG1 achieved a PCE of 14.3%.4 The ZL003 organic dye exhibited a PCE of 13.6%.5 Besides these, other architectures such as D–D′–π–A, D–π–D′–A, D–A′–π–A, A–π–D–π–A, and A–D–A–D–A have also been explored for DSSCs.6–13
According to the National Renewable Energy Laboratory's solar cell efficiency chart 2020 [https://www.nrel.gov/pv/cell-efficiency.html], DSSCs are considered to be in the less efficient category; therefore, more efficient and practical outcome-oriented research, especially in the area of synthesis and structural modification of organic dye molecules, is required. The design of new dye molecules often involves intense research and development in a targeted area, driven by chemical intuition. Molecular insights on stereo-control in transition states obtained using modern electronic structure theory-based computations have also contributed to this field of work, although such methods are generally computationally demanding. Therefore, faster and reliable design techniques that can guide future experiments are of high contemporary interest. Among the leading efforts, the application of data-driven modelling by machine learning (ML) algorithms has recently emerged as a promising tool. In particular, a large number of molecular parameters are considered to identify the best regression equation, which correlates to important experimental, structural, and computational parameters in predicting the PCE. Fine-tuning the model equations to obtain a compatible model can be challenging, incorporating a huge number of molecules and descriptors. We believe that the burgeoning advances in the domain of ML could be exploited as a complementary optimization tool.
Diverse domains of modern science such as druggability prediction, disease diagnosis using medical image processing, novel materials design, and prognosis of various time-dependent processes have already embraced the benefits of the artificial intelligence (AI)-based ML approach with a conspicuous degree of success. AI is a broad area within the field of computer science, which allows a machine to mimic the human cognitive process either from past experiences or the most recent available data. ML is a subset of AI that equips computers/machines to execute a data-driven decision going through a statistical approach. The innate cognitive attribute of any ML algorithm is to learn and advance into a better system over time when exposed to a new set of data.14 In recent times, numerous ML techniques have been deployed in addressing real-time problems just by adopting regression classification-based approaches. There have also been some important ML applications in chemistry, such as drug discovery,15,16 organic synthesis,17 catalytic reactions,18 materials design for batteries,19 supercapacitors,20,21 and fabrication of solar cells.22 In the recent years, quantitative structure–activity relationship (QSAR)-based models were developed in predicting the relevant information on the desired organic molecules by identifying the relevant subset of descriptors.
QSAR modelling for DSSC is quite challenging just using the structural properties as the accuracy of PCE prediction will be substandard due to the complex power conversion relationship between the dyes and PCE, which involves photon absorption, electron injection, and redox reactions. In 2015, Li et al. achieved relatively high accurate prediction for a cascade-based model for 354-organic dye molecules database using support vector machine (SVM),23 where they reported the prediction results just using complex structural properties. However, in practice, the prediction accuracy and robustness of ML models are still far from ideality. In 2020, Jillella Gopala Krishna et al. established a quantitative structure–property relationship (QSPR) model by utilizing an ML-based approach with 1200 dyes for seven different sets of donor moieties, namely, triphenylamine, phenothiazine, indoline, porphyrin, coumarin, carbazole, and diphenylamine.24 Moreover, in 2020, Yaping Wen et al. reported the accelerated discovery of potential organic dyes for DSSCs by interpretable ML models and virtual screening, where they reported the implementation of different ML methods, virtual screening, and a novel synthetic accessibility score to accelerate the development of potential organic dyes for DSSCs.25 In order for the approach to be suitable for large-scale screening, the GBRT-SVM-ANN learner performed best with superior robustness and accuracy.
As DSSCs work by harvesting visible light, we intend to design a ML protocol that can be deployed to identify a new organic dye molecule that exhibits light absorption above 450 nm. In particular, this study used three different datasets, structural, quantum, and experimental descriptors, in building effective prediction-based models. The ML models for predicting the dye molecule for high PCE includes linear regression (LR), sequential minimal optimization regression (SMOR), random forest (RF), and multilayer perceptron neural networks (MP-NN). In addition, we have given details about how to use the ML model to design new molecules and designed 12 new molecules. The PCE for the derivative molecules were predicted using the MP-NN and RF models. The study clearly illustrates that the ML model is useful for designing novel molecules with improved PCE.
2. Data processing methods
2.1. Datasets
The experimental PCEs used in the current study for modelling varied/different classes of chemical dyes were obtained partially from the recently published literature and the rest from dye-sensitized solar cell database (DSSCDB).26 The entire database contains experimental results from over 4800 diverse set of chemicals. As a preliminary data pre-processing step, the dyes were screened by selecting just the organic molecules based on the absorption spectrum, wherein λmax ≥ 450 nm. Finally, the working dataset of 1448 dye molecules with a wide variety of donors such as carbazole, coumarin, diphenylamine, indoline, phenothiazine, and triphenylamine was considered for the calculation of structural and quantum properties/descriptors. The details of the data sets used in this work are provided in the ESI.†
2.2. Computational details
Modelling and energy optimizations of organic dyes were carried out using density functional theory (DFT) B3LYP/6-31*, and various molecular properties were computed using time-dependent DFT (TD-DFT) calculations (CAM-B3LYP/6-31*) using Gaussian16 suite.27 Parameters such as the lowest unoccupied molecular orbital (LUMO) energy (EL), highest occupied molecular orbital (HOMO) energy (EH), and HOMO–LUMO energy gap (EH–L) at the ground state were compared with respect to the different substitutions. The frontier orbital analysis of the dyes was executed for a basic understanding of the electron density distribution that exists in both the occupied and virtual states. Further, GaussView 6.028 and GaussSum 3.029 were used to visualize the dye structure and extract the excited state properties of the dyes, respectively. Solvation effects in all the calculations were not considered; only gas-phase calculation was performed as most experimental studies are reported in a mixture of solvents. Hence, DFT and TD-DFT calculations for dyes were limited to the gas phase. However, the effect of the solvent should be respected in the developed ML model as many experimental parameters have been used to build the model.
2.3. Machine learning methods
A prediction-based model using four different ML methods implemented in Waikato Environment for Knowledge Analysis (WEKA) was used in this work to perform LR, SMOR, RF, and MP-NN ML algorithms. WEKA is an open-source ML software that can be accessed through a graphical user interface, standard terminal applications, or a Java API (application programming interface).
LR is the statistical analysis of measuring the dependent target variable's (PCE) association from the independent variable (such as experimental input, structural, and quantum properties of dyes). LR is the most straightforward regression-based modelling technique, capturing the linear relationship between two variables. It is best described using a simple mathematical equation y = mx + c, where y and x are the target (dependent) and independent variable, and m and c are the coefficients for determining the slopes and intercepts, respectively. LR facilitates predicting the target variables based on one or more independent variables, assuming a direct relationship that can be represented by a straight line30 or a plane (in the case of multivariable). In the current work, multiple LR was assessed in predicting a single continuous dependent variable (PCE) for two or more independent variables.
Sequential minimal optimization is an effective training method for support vector machine (SVM) that can handle regression-based problems, i.e., support vector regressor (SVR). SVR uses the same principle as that of SVM. The function approximates the mapping of an input variable creating a decision boundary line separating the data into groups. Regression problems are especially prone to non-sparse real numbers (as opposed to binary inputs) with solutions that have many support vectors. In optimizing this, sequential minimal optimization (SMO) is effective in handling regression problems.
RF is a supervised learning model that is an ensemble of decision trees. A decision tree is a nonparametric algorithm with a bagging method, heavily relying on node splitting based on the input variables, resulting in a better dataset with reduced variance. Moreover, RF can also be used to solve both classification and regression-based problems. One of the typical limitations prone to affect the accuracy of the obtained results is overfitting. An effective way to overcome the data overfitting issue is by randomizing the decision trees to average out noises and arbitrary fluctuation to give a better performance. As the name stands signifies, the training samples and subset features are selected randomly and used for node splitting rather than averaging decisions from individual trees.
Artificial neural network (ANN) is often cited as either a neural network (NN) or multilayer perceptron (MLP); the word perceptron denotes a single neuron, which is a forerunner to an extensive neural network. Multilayer perceptron is an augmentation of feedforward neural network (FFNN) with an architecture consisting of feature input layer(s), hidden layer(s), and output layer, which is categorized as deep neural learning, which is a subset of ML. This FFNN consists of neurons that receive a weighted input signal, where the weights are certainly related to the input coefficients that will have an influence on the output. Further, the received input signals are filtered through an activation function (which is a sum of the weighted inputs). The MLPs use a training algorithm that adjusts the weights by the simultaneous learning process. The error rates between the actual output and target are minimum, in other words, there is accurate prediction. In general, multilayer perceptron is trained with backpropagation as the learning algorithm.
2.4. Validation of ML models
We validated the performance of ML models using two different approaches: (a) K-fold-cross-validation (where K = 10 in this work) and (b) Train/test split. In the case of K-fold cross-validation, the entire dataset is divided into K equal subsets. One set is reserved for testing the ML model among these K sets, while the remaining K − 1 sets are used for training. The procedure is repeated K times by choosing a different subset for testing each time. Various metrics such as root mean square error (RMSE) and correlation coefficient (R2) is computed as an average over these K sets of cross validations.31 The hyperparameter tuning of different K values is based on selecting an optimum value that results in minimum RMSE value and high accuracy.32
In the splitting process, we used the regular spilling trend, such as 80% of molecule data for training the model and 20% of the molecule data for the testing of the system. Finally, we have chosen the molecules having PCE as low as 0.05% to as high as 12.5% to test the special test data case model.
2.5. Model performance evaluation33
In this study, two metrics were employed for evaluating the model performance: one stating the prediction error, RMSE, and the second metrics explain the goodness of the model fit, coefficient of determination, R2. RMSE is a measure of the average Euclidean distance between the real value and the predicted value, whereas R2 represents the statistical measuring factor of the predicted data to that of the actual through a linear fit. RMSE = 0, while R2 = 1 indicates that the prediction fits the data perfectly.
The effectiveness of the regression models can be evaluated using multiple criteria. For the QSAR model, we just use the test set prediction error according to the OECD (Organization for Economic Co-operation and Development) guidelines. Predictive error metrics include mean absolute error (MAE) and RMSE, as displayed below in eqn (1) and (2). Besides, the salience of the model fit is expressed by the R2 value mentioned below in eqn (3). (1) (2) (3)
From the above expressions, N represents the number of samples in the test set, with yi being the experimental value of the ith target sample in the test set, is the predicted target value of yi, and ytrainmean is the experimental arithmetic mean of the training set. Further, yfiti is the fitted value of the ith target sample and ymean stands for the mean value of the experimental test set.
3. Results and discussion
All the models used in this study were developed using a graphical user interface (GUI) of an open-source data mining software containing all the practical ML tools, WEKA.34,35 We collected 4850 molecules from different sources to calculate the dyes’ PCE, followed by first stage data cleaning by eliminating all the inorganic and organometallic molecules, narrowing down to 1448 organic molecules. Further, particular data scrutiny was performed using a bare cutoff of the experimental absorption spectrum (λmax > 450 nm). For all the molecules, (1448) experimental data and selected structural and quantum properties are shown in Table S1 (ESI†). Table S2 (ESI†) lists the ML works reported earlier. The table includes the number of dyes (often less than 1000), number of descriptors, and type of descriptors used.
3.1. Details of descriptors
The molecular descriptor is a certain property computed for each of the molecules in the dataset. It can be classified as 0-D, 1-D, 2-D, and 3-D depending upon whether they describe a count, fingerprint, surface, or volumetric data. Further, they can be computed using an empirical approach, using electronic structure theory, or extracted from experimental measurements. The descriptor properties used in the current work are (a) structural, (b) quantum, and (c) experimental in nature.

(a) Structural properties. 
The calculation of structural descriptors was performed using a chemical notation, SMILE (simplified molecular-input line-entry system), as the input data for PaDEL-descriptor 2.21 software.36 In particular, the computed 1-D, 2-D, and 3-D descriptors cover constitutional, connectivity index, ring descriptors, atom-centered fragments, functional group counts, atom type E-states, molecular properties 2-D atom pairs, and extended topochemical atom indices for every molecule that is present in the dataset.
In order to build a model with high accuracy and better prediction, it requires the selection of a particular set of data that directly influences the output. Filter-based feature analysis is a crucial pre-processing step for extracting the variables that majorly affect the target property.23 Correlation-based feature selection was the chosen one for this particular work. “CfsSubsetEval” in WEKA is a simple correlation-based feature selector that evaluates the worth of every subset of attributes and ranks a subset of features that are highly correlated with the target variable while eliminating the independent attributes as the redundant variables.37 The details on the various descriptors used to develop the ML modes can be found in Table S1 (ESI†). Fig. 1 displays the structural properties with high correlation (>80%) toward PCE, directly influencing the model predictability for better accuracy and minimal error values. Further, the same methodology was incorporated in the feature selection of both molecular and experimental descriptors, where most of the selected descriptors were well in agreement with the previous literature study with few exceptions.
 Fig. 1  Feature selected structural properties with >80% influence on PCE. 
Identifying energy materials with a particular characteristic involves the consideration of both structural and molecular properties while building a model. The complexity in handling large datasets increases with the increasing number of independent variables.38
The selected 45 structural properties of the organic dye molecules are nCl, ATSC3c, ATSC4c, ATSC7c, ATSC4e, AATSC5i, AATSC8i, AATSC0s, MATS3c, MATS7c, MATS4v, MATS4p, MATS5i, MATS8s, GATS6c, GATS4v, GATS4p, GATS5i, GATS6i, GATS3s, GATS4s, CrippenLogP, VE1_Dt, nsOm, nsCl, SHCsatu, SsNH2, minHBint2, minHBint4, minHsOH, minHCsatu, minsssCH, maxHCsatu, maxtsC, maxtN, ETA_Epsilon_2, ETA_Epsilon_4, ETA_dEpsilon_C, n4Ring, nF11Ring, nF12Ring, nT4Ring, nT11Ring, nF11HeteroRing, and VE1_D. The detailed description of each feature is given in Table S1 (ESI†).


(b) Quantum properties. 
Quantum properties calculations were performed by extracting the required input in molecular structure format by converting SMILEs data using a special chemical toolbox, OPENBABEL.39 The ground-state optimization calculations have been committed to confirm whether the optimized structure corresponds to the global minima on the potential energy surface (PES) using semi-empirical PM740 functional. Energy calculation was performed by the hybrid B3LYP functional41 with the 6-31G* basis set.42,43 The UV-visible absorption spectra of the dyes were simulated using the CAM-B3LYP44 functional with the 6-31G* basis set. The excited-state properties were implemented using the CAM-B3LYP functional due to its long-range correction factor, which generates a reliable ICT type of excitation, as reported in our previous works.45–48
All the dyes’ optimized geometries are calculated. EH, EL, EH–L, and dye regeneration driving force (ΔGreg) of all the optimized dyes are tabulated in Table S1 (ESI†). The LUMO energy levels of all the dyes are positioned above the conduction band (CB) of TiO2, which supplies sufficient driving force for efficient electron injection (ΔGinject) from the dye's excited state to the CB of TiO2. Also, the HOMO energy levels lie below the redox energy level of the I3−/I− electrolyte. ΔGreg is a crucial parameter that qualifies a dye for its suitability in DSSCs’ application. A dye molecule must have a sufficient driving force to regenerate the oxidized dye to its neutral state.
The electronic absorption spectra were computed by considering the 6 lowest singlet–singlet transitions in the gas phase. The computed absorption spectrum maximum (λc) and oscillator strength (f) corresponding to maximum absorbance are presented in Table S1 (ESI†).
LHE (λ) is the light-harvesting efficiency at a particular wavelength (associated with f), expressed in eqn (4). ηcollect and Φinject are the charge collection efficiency and electron injection efficiency, respectively. ηcollect can be considered as a constant for all the dyes as the same TiO2 is used in this calculation. Φinject is proportional to ΔGinject49,50 and is given in eqn (5). LHE = 1 − 10−f(4) Φinject ∝ f(ΔGinject)(5)
Higher negative ΔGinject would enhance the Φinject. ΔGinject is the difference between the excited state oxidation potential (EdyeOX) of the dye and (−4.0 eV),49,50 and it is expressed in eqn (6). EdyeOX(i.e. −EH) is the ground state oxidation potential. ΔGinject = (EdyeOX − ECBTiO2)(6)
Excited-state lifetime (τ)51 of the dye molecules can be calculated using eqn (7). (7)where E is the vertical excitation energy (in cm−1) of the first excited states.
Electronegativity52 is the one of the key factors to determine the PCE, which is calculated using eqn (8). Electronegativity = − (EH + EL)/2(8)
We calculated 14 quantum descriptors that had an influence on the PCE, such as HOMO−1 (eV), HOMO (eV), LUMO (eV), LUMO+1 (eV), energy gap (Eg (eV)), electronegativity (eV), dipole moment (Debye), vertical energy (cm−1), computational absorption spectrum maximum (nm), f, ΔGreg (eV), exited-state lifetime (ns), LHE (%), and ΔGinject (eV).


(c) Experimental parameters. 
Eleven experimental descriptors were taken from the literature and incorporated as the final attributes, which was selected from feature selection. The selected properties include active area (in cm2), co-absorbent (in mmol), active layer thickness (in μm), scattering layer thickness (in μm), dye loading value (in nmol), dye loading (exposure) time (in h), absorption spectrum maximum (in nm), emission spectrum maximum (in nm), open-circuit voltage, VOC (in V), short-circuit current density, JSC (in mA cm−2), and fill factor (FF). The detailed description of the selected properties are listed in Table S1 (ESI†).

3.2. ML models’ scrutiny
The efficient screening of a large number of organic molecules in achieving high-performance DSSCs includes a sum of 70 descriptors (a combination of 11 experimental + 45 structural + 14 quantum properties), predicting the PCE swiftly carried out by ML algorithms along with 10-fold cross-validation. Table 1 shows the calculated R2, MAE, and RMSE values of the ML models used in this work, i.e., LR, SMO, RF, and MP-NN algorithms. The correlation coefficient values are presented with RF, exhibiting a higher prediction accuracy: RF (0.95) > MP-NN (0.85) > LR (0.74) > SMO (0.63), whereas MAE RF (0.58) < MP-NN (0.90) < SMO (1.12) < LR (1.18), RMSE RF (0.80) < MP-NN (1.21) < LR (1.57) < SMO (2.03).
Table 1 The calculated correlation coefficient, mean absolute error, and root mean squared error values of LR, SMO, RF and MP-NN algorithms under 10-fold cross-validation






Correlation coefficient – cross-validation (10-fold)
Mean absolute error
Root mean squared error




LR
0.74
1.18
1.57


SMO
0.63
1.12
2.03


RF
0.95
0.58
0.80


MP-NN
0.85
0.90
1.21




The results and plots from Fig. 2 indicate a dominant performance of the RF and MP-NN models with a high correlation to PCE. Moreover, the probability density of error distribution between the predicted and actual experimental value for both RF and MP-NN are typically distributed, indicating a minimal sampling error. The LR's predictive capability is better than the sequential minimal optimization model with R2LR = 0.74 and R2SMO = 0.63; however, these two models are far from ideal. Results from MP-NN and tree-based RF models were quite profound; notably, RF was slightly better off with R2 and RMSE of 0.96 and 1.17% than MP-NN (R2 = 0.95, RMSE = 1.32%), respectively, by supplying an external test set, which comprises 60 unexposed molecules. Thus, the random forest model displays superior performance over MP-NN in correlating the selected inputs for better PCE prediction.
 Fig. 2  Theoretically predicted vs. experimental PCE for the dataset, training and 10-fold cross-validation. 
This work also includes evaluating the obtained results through a secondary model validation, the test and train split method, which aligns with the results obtained from 10-fold cross-validation (Fig. 3) in predicting the PCE of organic dye molecules for DSSC application.
 Fig. 3  Theoretically predicted vs. experimental PCE for the dataset, cross validation, splitting and selected molecule training. 
The work also includes the experimentation of secondary model validation through two different testing methods, (i) 80:20 data split and (ii) unexposed dataset of 60 molecules as an external test set is used as a tertiary validation. Fig. 3 shows the actual vs. predicted PCE results from cross-validation, splitting, and external test dataset for both the RF and MP-NN algorithms data. In this figure also, it is clearly shown that RF does not possess any negative values as well as outliers in predicting the PCE. RF shows a superior result with an R2 of more than 95% in all the cases. In contrast, MP-NN exhibits a higher R2 value only in predicting the external test (95%) (Table 2).
Table 2 The calculated correlation coefficient, mean absolute error, and root mean squared error values of 10-fold cross-validation, splitting (80:20) and testing specific molecules under RF and MP-NN algorithms






Correlation coefficient
Mean absolute error
Root mean squared error


RF
MP-NN
RF
MP-NN
RF
MP-NN




Cross validation (10-fold)
0.95
0.85
0.58
0.88
0.80
1.19


Splitting (80:20)
0.95
0.84
0.57
1.36
0.76
1.66


Testing (60 molecules)
0.96
0.95
0.88
0.97
1.17
1.32




The importance of the individual parameters such as structural, quantum, structural + quantum, structural + experimental,53 and structural + experimental + quantum was studied using RF and MP-NN algorithms. The obtained results are presented in Fig. 4 and Table 3. From Fig. 4a, it is clear, the correlation coefficient in RF is improved as much as 0.95 (structural + experimental + quantum) from 0.46 (structural) by consolidating all the available descriptor types; at the same time, both MAE and RMSE also decreased to as low as 0.58 and 0.80, respectively. A similar trend is also seen in the MP-NN algorithm.
 Fig. 4  Theoretically predicted vs. experimental PCE for dataset, training and 10-fold cross-validation. 
Table 3 The calculated R2, MAE, and RMSE values of under RF and MP-NN algorithms






RF
MP-NN



R
2

MAE
RMSE

R
2

MAE
RMSE




Structural
0.46
1.65
2.06
0.10
2.06
2.53


Quantum
0.73
1.22
1.58
0.47
1.68
2.11


Structural + quantum
0.74
1.22
1.58
0.46
1.70
2.13


Structural + experimental
0.93
0.57
0.80
0.82
1.03
1.36


Structural + quantum + experimental
0.95
0.58
0.80
0.85
0.90
1.21




3.3. Design of novel dye molecules with improved PCE
The main purpose of building a data-driven ML model is to identify various descriptors that influence the PCE and this insight can be used to propose novel molecules with improved energy efficiency. To propose novel dye molecules, we have identified a set of 2-D (structural) descriptors that constructively contribute to energy efficiency. The choice here is LR as it provides the relationship between the various descriptors and PCEs. The LR equation (QSAR model) with respective coefficients is presented as a dataset in Box S1 (ESI†).
The LR model (with 74% accuracy) showed that the descriptors such as GATS6c, GATS4v, MATS3c, MATS7c, and GATS6i are positively contributing to PCE, while ATSC3c, GATS3s, GATS4p, and GATS4s are destructively contributing. The presence of a 4-membered ring, an 11-membered ring, and a fused 11-membered ring lowers the PCE, while the presence of a fused 11-membered heterocyclic ring and 12-membered ring increases the PCE. Further, the increase in the optical properties such as absorption maximum (referred to as red shift) and emission maximum increase the PCE, while the increase in the oscillator strength lowers the same. In Table S4 (ESI†), we have collected a list of family of dyes (having similar structure) and their corresponding molar extinction coefficient (ε), oscillator strength, and PCE. For example, although DT3 possesses a larger oscillator strength than DT4 but not a higher PCE. A similar trend can also be seen in the case of other dye families (refer to K groups) listed in Table S4 (ESI†). Overall, the data support that the dyes with larger oscillator strengths are not necessarily those associated with higher PCE.
Based on all these insights, we have designed dye molecules (henceforth referred to as the derivative dye molecules) by introducing the following structural changes in the selected dye molecules (henceforth referred to as parent molecules): (i) removal of 4-membered ring, (ii) changing the fused 11-membered ring to a fused-11 membered heterocyclic ring, (iii) introduction of spacer groups such as CC and CC along the conjugation pathway. Increasing the conjugation length by adding spacer groups will increase the absorption maximum; thus, improved PCE can be expected. To validate this, we inserted CC and CC type spacers along the conjugation pathway in some of the selected molecules, which are shown in Fig. 5(a–f). Among the six parent molecules, we have inserted CC and CC in the first four parent molecules (d1029, d1067, d1130, d279, d824, d1313). Molecules d1029a, d1029b, and d1029c are derivative of d1029, which are modified by the insertion of the CC and CC group to extend the hyperconjugation (Fig. 5a). Similarly, d1067a and d1067 b are derivatives of the d1067 dye, d1130a, d1130b are from d1130 dye and d279a, d279b is derived from the d279 dye. In the d824 dye, modification was done to the 11-membered ring such that forming the d824a and d824b molecules, d824a (fused 11-membered ring to the fused 11-membered heterocyclic ring, i.e., CR2 to NR, where R = n-alkyl group) and d824b (fused 11-membered ring => fused 11-membered heterocyclic ring, i.e., CR2 => O) (refer to Fig. 5e). Finally, we have modified the d1313 dye by opening its 4-membered ring (Fig. 5f).
 Fig. 5  (a) Structural modification to the D1029 parent molecule. (b) Structural modifications to the d1067 parent molecule. (c) Structural modifications to the d1130 parent molecule. (d) Structural modifications to the d279 parent molecule. (e) Structural modifications to the d824 parent molecule. (f) Structural modification to the d1313 parent molecule. 
The PCEs of the designed 12 new molecules were predicted using the MP-NN algorithm and are tabulated in Table 4. The presented results show that indeed the ML model can be used to design molecules with improved PCEs. In particular, dye molecules such as d1029b, d1029c, d1067a, d824a, d824b, d1130b, d279a, d279b, and d313a showed increased PCE when compared to the predicted PCE of the parent molecules. Thus, an improvement in the PCE has been observed in the 9 designed molecules from a total of 12 new dyes (so the success rate is about 75%). The results clearly indicate that the insight from the ML model can be useful in designing molecules with improved PCE. In addition, the MP-NN model fairly reproduces the PCE of the parent molecules (refer to Table 4). It is worth mentioning that the MP-NN model is built using the three sets of descriptors such as structural parameters, electronic properties, and experimental properties. This requires the computation of structural and electronic properties and measurements of experimental parameters for all the designed molecules. We have computed the former two properties using PaDEL and from the electronic structure theory calculations. However, it is impossible to measure the experimental properties; thus, we have approximated them to those of the parent molecules, which is reasonably valid. However, since the absorption maximum is known to shift with an increase in the conjugation length, for the set of molecules where the conjugation length is altered, we have shifted the absorption maximum based on the number of space groups (for each such group, the absorption maximum is shifted by 30 nm)54 (Refer to Table S3, ESI†).
Table 4 Parent and derived molecule predicted PCE values in the RF and MP-NN models




Parent molecule
Experimental PCE (%)
Predicted PCE (%) by MP-NN
New molecule
Predicted PCE (%) by MP-NN




d1029
12.5
13.88
d1029a
10.03


d1029b
14.01


d1029c
15.29


d1067
11.62
11.79
d1067a
12.44


d1067b
8.25


d824
9.8
8.68
d824a
11.99


d824b
9.39


d1130
9.8
9.53
d1130a
9.14


d1130b
11.18


d279
5.27
2.05
d279a
3.74


d279b
2.18


d1313
2.08
2.42
d1313a
4.38




4. Conclusions
QSPR model-based ML methods were used to estimate the PCE in DSSC from 1448 metal free dyes. The entire work considered the combination of structural, experimental, and quantum properties in predicting the PCE. The feature inputs for building an effective ML model were obtained using PaDEL (structural properties), density functional theory (DFT)/Time-dependent DFT (TD-DFT) (quantum properties), and literature/database (experimental properties). The descriptors with the most influence toward PCE prediction were selected from a pre-processing step and feature selection, where the descriptors with higher correlation toward PCE were selected. Regression-based ML models such as LR, SMO regression, RF, and MP-NN were exploited for establishing a data-driven approach. Among the models tested, RF emerged as the best with a prediction accuracy of 95% and RMSE of 0.80 only to outperform the MP-NN model, which had an accuracy of 85% and RMSE of 1.21. The reliability of the models was validated through 10-fold cross-validation, split-training, and by providing an external test set. R2 and RMSE values for various descriptor combinations (such as quantum and structural, quantum and experimental, and structural and experimental) were also calculated using RF and MP-NN, which clearly showed the importance of mixed properties toward estimating PCE in DSSC. Based on the LR model, a number of dye molecules were designed and in 75% of the cases, the PCE was improved, compared to the parent molecules. The study clearly demonstrated that the data driven approach can provide useful insight in the improvement of PCE in DSSCs and the ML models can be efficiently used to design novel dye molecules with improved PCE.
5. Data and software availability
The data pertaining to this manuscript are available on the ESI† (Excel file). An open access Dye-Sensitized Solar Cell Database (DSSCDB) (https://jcheminf.biomedcentral.com/articles/10.1186/s13321-018-0272-0) and the Dye Aggregation Database (https://vvishwesh.github.io/dyeaggregation/) were used to select most of the dyes in this study. The software WEKA (https://www.cs.waikato.ac.nz/ml/weka/) and PaDEL-Descriptor (http://www.yapcwsoft.com/dd/padeldescriptor/) used in this work are available at free of cost in the public domain. Gaussian 16 suite is a commercially available software.
Conflicts of interest
There are no conflicts to declare.
Acknowledgements
Author GRK greatly acknowledges the Ministry of Human Resource Development, Government of India, for providing fellowship and facilities through IIT Madras. The high-performance computing center (HPCE) at IIT Madras and funding for cluster computing facility through the DST grant DST/TMD/SERI/HUB/1(C) are acknowledged. Authors acknowledge the funding through SB20210834CYMHRD008477 for setting up potential centre of excellence (pCoE) at IIT Madras for solar cell research.
References
D. Ahuja and M. Tatsutani, Sapiens, 2009, 2, 1–16 Search PubMed .
A. Mishra, M. K. R. Fischer and P. Büuerle, Angew. Chem., Int. Ed., 2009, 48, 2474–2499 CrossRef CAS PubMed .
S. Mathew, A. Yella, P. Gao, R. Humphry-baker, B. F. E. Curchod, N. Ashari-astani, I. Tavernelli, U. Rothlisberger, K. Nazeeruddin and M. Gra, Nat. Chem., 2014, 6, 242–247 CrossRef CAS PubMed .
K. Kakiage, Y. Aoyama, T. Yano, K. Oya, J. I. Fujisawa and M. Hanaya, Chem. Commun., 2015, 51, 15894–15897 RSC .
L. Zhang, X. Yang, W. Wang, G. G. Gurzadyan, J. Li, X. Li, J. An, Z. Yu, H. Wang, B. Cai, A. Hagfeldt and L. Sun, ACS Energy Lett., 2019, 4, 943–951 CrossRef CAS .
H. Zhou, J. M. Ji, S. H. Kang, M. S. Kim, H. S. Lee, C. H. Kim and H. K. Kim, J. Mater. Chem. C, 2019, 7, 2843–2852 RSC .
J. M. Ji, H. Zhou and H. K. Kim, J. Mater. Chem. A, 2018, 6, 14518–14545 RSC .
Y. K. Eom, S. H. Kang, I. T. Choi, Y. Yoo, J. Kim and H. K. Kim, J. Mater. Chem. A, 2017, 5, 2297–2308 RSC .
S. H. Kang, M. J. Jeong, Y. K. Eom, I. T. Choi, S. M. Kwon, Y. Yoo, J. Kim, J. Kwon, J. H. Park and H. K. Kim, Adv. Energy Mater., 2017, 7, 1–10 Search PubMed .
Y. K. Eom, I. T. Choi, S. H. Kang, J. Lee, J. Kim, M. J. Ju and H. K. Kim, Adv. Energy Mater., 2015, 5, 1–9 Search PubMed .
P. Naika and R. S. M. R. E. A. E.-S. A. V. Adhikaria, Photochem. Photobiol. Sci., 2018, 17, 302–314 CrossRef PubMed .
Y. Wu and W. Zhu, Chem. Soc. Rev., 2013, 2039–2058 RSC .
M. Zhang, H. Xie, X. Ju, L. Qin, Q. Yang, H. Zheng and X. Zhou, Phys. Chem. Chem. Phys., 2013, 634–641 RSC .
R. Dybowski, New J. Chem., 2020, 44, 20914–20920 RSC .
J. Vamathevan, D. Clark, P. Czodrowski, I. Dunham, E. Ferran, G. Lee, B. Li, A. Madabhushi, P. Shah, M. Spitzer and S. Zhao, Nat. Rev. Drug Discovery, 2019, 18, 463–477 CrossRef CAS PubMed .
N. A. Murugan, C. Muvva, C. Jeyarajpandian, J. Jeyakanthan and V. Subramanian, Int. J. Mol. Sci., 2020, 21, 1–15 Search PubMed .
B. Maryasin, P. Marquetand and N. Maulide, Angew. Chem., Int. Ed., 2018, 57, 6978–6980 CrossRef CAS PubMed .
J. R. Kitchin, Nat. Catal., 2018, 1, 230–232 CrossRef .
Y. Liu, B. Guo, X. Zou, Y. Li and S. Shi, Energy Storage Mater., 2020, 31, 434–450 CrossRef .
S. Zhu, J. Li, L. Ma, C. He, E. Liu, F. He, C. Shi and N. Zhao, Mater. Lett., 2018, 233, 294–297 CrossRef CAS .

          Y. Zhou, S. Li and K. Wang, PEDG 2019 - 2019 IEEE 10th Int. Symp. Power Electron. Distrib. Gener. Syst., 2019, 420–424.
F. Li, X. Peng, Z. Wang, Y. Zhou, Y. Wu, M. Jiang and M. Xu, Energy Environ. Mater., 2019, 2, 280–291 CrossRef .
H. Li, Z. Zhong, L. Li, R. Gao, J. Cui, T. Gao, L. H. Hu, Y. Lu, Z. M. Su and H. Li, J. Comput. Chem., 2015, 36, 1036–1046 CrossRef CAS PubMed .
J. G. Krishna, P. K. Ojha, S. Kar, K. Roy and J. Leszczynski, Nano Energy, 2020, 70, 104537 CrossRef CAS .
Y. Wen, L. Fu, G. Li, J. Ma and H. Ma, Sol. RRL, 2020, 4, 1–11 Search PubMed .
V. Venkatraman, R. Raju, S. P. Oikonomopoulos and B. K. Alsber, J. Cheminf., 2018, 10, 1–9 Search PubMed .
M. J. Frisch, G. W. Trucks, H. B. Schlegel, G. E. Scuseria, M. A. Robb, J. R. Cheeseman, G. Scalmani, V. Barone, G. A. Petersson and H. Nakatsuji, Gaussian 16, 2016 Search PubMed .

          K. Roy Dennington, T. A. Keith and J. M. Millam, Gaussview 6, Semichem Inc., Shawnee Mission,  2016 Search PubMed.
N. M. O’Boyle, A. L. Tenderholt and K. M. Langner, J. Comput. Chem., 2007, 29, 839–845 CrossRef PubMed .
K. Kumari and S. Yadav, J. Pract. Cardiovasc. Sci., 2018, 4, 33–36 CrossRef .
H. Wang, Y. Ji and Y. Li, Wiley Interdiscip. Rev.: Comput. Mol. Sci., 2020, 10, 1–18 Search PubMed .
Z. W. Zhao, M. Del Cueto, Y. Geng and A. Troisi, Chem. Mater., 2020, 32, 7777–7787 CrossRef CAS .
H. Li, Y. Cui, Y. Liu, W. Li, Y. Shi, C. Fang, H. Li, T. Gao, L. Hu and Y. Lu, IEEE Access, 2018, 6, 34118–34126 Search PubMed .

          I. H. Witten, E. Frank, M. A. Hall and C. J. Pal, The WEKA workbench,  2016 Search PubMed .
M. Hall, E. Frank, G. Holmes, B. Pfahringer, P. Reutemann and I. H. Witten, SIGKDD Explor., 2009, 11, 10–18 CrossRef .
C. W. Yap, J. Comput. Chem., 2011, 32, 1466–1474 CrossRef CAS PubMed .
A. Mangal and E. A. Holm, Integr. Mater. Manuf. Innov., 2018, 7, 87–95 CrossRef .
Y. Liu, O. C. Esan, Z. Pan and L. An, Energy AI, 2021, 3, 100049 CrossRef .
N. M. O’Boyle, M. Banck, C. A. James, C. Morley, T. Vandermeersch and G. R. Hutchison, J. Cheminf., 2011, 3, 1–14 Search PubMed .
J. J. P. Stewart, J. Mol. Model., 2013, 19, 1–32 CrossRef CAS PubMed .
C. Lee, W. Yang and R. G. Parr, Phys. Rev. B: Condens. Matter Mater. Phys., 1988, 37, 785–789 CrossRef CAS PubMed .
R. Ditchfield, W. J. Hehre and J. A. Pople, J. Chem. Phys., 1971, 54, 724–728 CrossRef CAS .
W. J. Hehre, K. Ditchfield and J. A. Pople, J. Chem. Phys., 1972, 56, 2257–2261 CrossRef CAS .
T. Yanai, D. P. Tew and N. C. Handy, Chem. Phys. Lett., 2004, 393, 51–57 CrossRef CAS .
S. Mandal, G. R. Kandregula and K. Ramanujam, J. Photochem. Photobiol., A, 2020, 403, 112862 CrossRef CAS .
G. R. Kandregula, S. Mandal, G. Prince, S. K. Yadav and K. Ramanujam, New J. Chem., 2020, 44, 4877–4886 RSC .
G. R. Kandregula, S. Mandal and K. Ramanujam, J. Photochem. Photobiol., A, 2021, 410, 113161 CrossRef CAS .
S. Mandal, G. R. Kandregula and V. N. B. Tokala, J. Photochem. Photobiol., A, 2020, 401, 112745 CrossRef CAS .

          H. S. Nalwa, Handbook of Advanced Electronic and Photonic Materials and Devices, Ten-Volume Set, Academic Press,  2000, vol. 1 Search PubMed .
R. Katoh, A. Furube, T. Yoshihara, K. Hara, G. Fujihashi, S. Takano, S. Murata, H. Arakawa and M. Tachiya, J. Phys. Chem. B, 2004, 108, 4818–4822 CrossRef CAS .
K. Chaitanya, X. H. Ju and B. M. Heron, RSC Adv., 2014, 4, 26621–26634 RSC .
A. A. Buglak, T. A. Telegina and M. S. Kritsky, Photochem. Photobiol. Sci., 2016, 15, 801–811 CrossRef CAS PubMed .
A. A. Buglak, A. Charisiadis, A. Sheehan, C. J. Kingsbury, M. O. Senge and M. A. Filatov, Chem. – Eur. J., 2021, 27, 9934–9947 CrossRef CAS PubMed .

          W. Reusch, Visible and Ultraviolet Spectroscopy, https://www2.chemistry.msu.edu/faculty/reusch/virttxtjml/spectrpy/uv-vis/spectrum.htm.

Footnote† Electronic supplementary information (ESI) available. See DOI: 10.1039/d1nj05498hThis journal is © The Royal Society of Chemistry and the Centre National de la Recherche Scientifique 2022
Table Content:
	(1)
	(2)
	(3)

 	Fig. 1  Feature selected structural properties with >80% influence on PCE.	 
LHE = 1 − 10−f	(4)
Φinject ∝ f(ΔGinject)	(5)
ΔGinject = (EdyeOX − ECBTiO2)	(6)
	(7)
Electronegativity = − (EH + EL)/2	(8)

LR	0.74	1.18	1.57
SMO	0.63	1.12	2.03
RF	0.95	0.58	0.80
MP-NN	0.85	0.90	1.21

 	Fig. 2  Theoretically predicted vs. experimental PCE for the dataset, training and 10-fold cross-validation.	 

 	Fig. 3  Theoretically predicted vs. experimental PCE for the dataset, cross validation, splitting and selected molecule training.	 


Cross validation (10-fold)	0.95	0.85	0.58	0.88	0.80	1.19
Splitting (80:20)	0.95	0.84	0.57	1.36	0.76	1.66
Testing (60 molecules)	0.96	0.95	0.88	0.97	1.17	1.32

 	Fig. 4  Theoretically predicted vs. experimental PCE for dataset, training and 10-fold cross-validation.	 


Structural	0.46	1.65	2.06	0.10	2.06	2.53
Quantum	0.73	1.22	1.58	0.47	1.68	2.11
Structural + quantum	0.74	1.22	1.58	0.46	1.70	2.13
Structural + experimental	0.93	0.57	0.80	0.82	1.03	1.36
Structural + quantum + experimental	0.95	0.58	0.80	0.85	0.90	1.21

 	Fig. 5  (a) Structural modification to the D1029 parent molecule. (b) Structural modifications to the d1067 parent molecule. (c) Structural modifications to the d1130 parent molecule. (d) Structural modifications to the d279 parent molecule. (e) Structural modifications to the d824 parent molecule. (f) Structural modification to the d1313 parent molecule.	 

d1029	12.5	13.88	d1029a	10.03
d1029b	14.01
d1029c	15.29
d1067	11.62	11.79	d1067a	12.44
d1067b	8.25
d824	9.8	8.68	d824a	11.99
d824b	9.39
d1130	9.8	9.53	d1130a	9.14
d1130b	11.18
d279	5.27	2.05	d279a	3.74
d279b	2.18
d1313	2.08	2.42	d1313a	4.38
Footnote
† Electronic supplementary information (ESI) available. See DOI: 10.1039/d1nj05498h

This journal is © The Royal Society of Chemistry and the Centre National de la Recherche Scientifique 2022
