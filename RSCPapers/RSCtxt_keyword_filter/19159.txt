 Ab initio study of the dynamics of electron trapping and detrapping processes in the CH 3 NH 3 PbI 3 perovskite   - Journal of Materials Chemistry A (RSC Publishing) DOI:10.1039/C8TA09512D View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/C8TA09512D
(Paper)
J. Mater. Chem. A, 2019, 7, 2135-2147
Ab initio study of the dynamics of electron trapping and detrapping processes in the CH3NH3PbI3 perovskite†

        
          
            Linghai 
            Zhang
          
        
       and 

        
          
            Patrick H.-L. 
            Sit
          
        
      *
      School of Energy and Environment, City University of Hong Kong, Kowloon, Hong Kong S.A.R, China. E-mail: patrick.h.sit@cityu.edu.hk;   Tel: +852 34426709
Received 
      1st October 2018
    , Accepted 23rd December 2018First published on 24th December 2018AbstractCharge trapping and detrapping are responsible for a number of unusual properties in the CH3NH3PbI3 (MAPbI3) perovskite such as photoinduced ion migration, photodegradation, and current density–voltage hysteresis. However, little is known about the dynamic processes of charge trapping and detrapping at the trap sites. Herein, the behavior of excess electron trapping and its interplay with iodine vacancies in the MAI-terminated and PbI2-terminated MAPbI3 surfaces were studied using density functional theory (DFT) calculations. The results show that the positively charged iodine vacancy (VI+) is energetically more favorable to stay at the top-surface layer. By trapping excess electrons, the iodine vacancy migrates from the top-surface layer to the subsurface layer due to the formation of deep-level trap states. On the other hand, the adsorption of OH radicals and O2 molecules induces electron detrapping from the deep-level trap states and iodine vacancies migration from the subsurface back to the top-surface layer. Furthermore, we studied the electron trapping and detrapping processes in bulk MAPbI3. We found that in bulk MAPbI3, the excess electrons facilitate the clustering of the iodine vacancies together and form deep trap states via the iodine migration process. However, electron detrapping was found to induce the hopping of two adjacent iodine vacancies away from each other. Our results show that while excess electrons trapped in both the shallow-level and deep-level states enhance the photodegradation of MAPbI3 under humid air conditions, the electrons in the deep-level traps play a significantly more important role in facilitating photoinduced ion migration and the hysteresis behavior.
1. Introduction
A new generation of photovoltaic devices utilizing hybrid metal-halide perovskites as the light-harvesting layers has recently emerged, showing superb power conversion efficiencies (PCEs) now surpassing 22%.1–3 The hybrid metal-halide perovskites are crystalline materials with a chemical formula of ABX3, where A is typically a monovalent organic cation such as CH3NH3+ (MA) or CH(NH2)2+ (FA); B is a divalent metal such as Pb2+ or Sn2+; and X is a monovalent halide anion like I−, Br− or Cl−.4–7 This class of materials has attracted great interest in the past few years because of their outstanding performance such as long diffusion length of the charge carriers, tunable optical absorption, and low band gaps.8–11
Despite the high PCEs of the perovskite solar cells, the trapping of the free charge carriers by intrinsic defects and impurities is expected to limit the performance of this class of photovoltaic systems.12–15 Such trapped states play a significant role in the charge transport of perovskite solar cells. The shallow trapped states, which are close to the conduction or valence band edges, result in the decrease of charge carrier mobility. The deep trapped states, which are generally close to the middle of the band gap, can serve as the nonradiative recombination centers, reducing the carrier lifetime and open circuit voltage.16 Previous studies measured the number densities of the shallow and deep trapped states in CH3NH3PbI3 (MAPbI3) films to be around 1014–1017 cm−3.17,18 The presence of these trapped states is closely connected to photoinduced halide migration and is detrimental to the photo-stability of the perovskite materials.19–22 For example, Stranks and coworkers observed photoinduced halide migration in the MAPbI3 films in the presence of charge trapped states.20 Aristidou et al. showed that iodine vacancies in the MAPbI3 films can be eliminated by the iodide anion from the salt, suppressing the formation of superoxide species from oxygen (O2) and thus improving the stability of the perovskite materials.21 Meanwhile, the photoluminescence (PL) intensity was also observed to increase when the perovskite is in contact with the atmosphere because the photoinduced intragap states were found to be passivated by O2.23–25 Besides, it has been suggested that charge trapping and detrapping at the trap sites is one of the origins of the current density–voltage (J–V) hysteresis26–33 behavior when a large number of charge carriers can be trapped under forward bias conditions and released under short-circuit conditions.31,32 Lee and coworkers showed that J–V hysteresis can be reduced by minimizing the trap density due to the reduction of nonradiative recombination.29 Wang et al. also found that J–V hysteresis was eliminated by using the fullerene derivative layers, which resolves the electron accumulation problem, resulting in the decrease of the trap density at the perovskite/fullerene derivative interfaces.30
Recently, the shallow and deep trapped states in the bulk, crystal surfaces and grain boundaries of metal-halide perovskites have been widely studied using density functional theory (DFT) and time-dependent DFT (TDDFT) calculations.34–47 For example, previous DFT studies found the formation of the Pb–Pb covalent bond in the deep-level trap states such as antisite defect PbI and iodine vacancy VI−.35–39,45 The above calculations provide important insight on the properties of the trapped states of the perovskite materials. However, little is known about the dynamical processes of charge trapping and detrapping at the trap sites. As stated above, it has been found that photoinduced halide migration occurs in MAPbI3 films in the presence of charge trapped states.20 This means that defects such as iodine vacancies are mobile during charge trapping and detrapping. In other words, the iodine vacancies of different charges (i.e. VI+, VI0, VI−) are no longer confined to a specific lattice site when there are excess electrons or holes in the MAPbI3 perovskite. To distinguish the different types of iodine vacancies, the superscripts +1, 0, and −1 denote the total charge of the systems after the vacancy is introduced.
The focus of this work is to study the iodine vacancies at the top-surface layer and subsurface layer of MAPbI3 surfaces during the electron trapping and detrapping processes. The reason we place focus on the surface is that previous experimental studies showed that the trapped states (e.g., iodine vacancies) are generally located close to the crystal surfaces due to the presence of dangling bonds.48,49 Meanwhile, to consider the long-range ion migrations, we also studied the electron trapping and detrapping processes in bulk MAPbI3. The paper is arranged as follows. In Section 2, we present the computational methodology adopted in this work. In Section 3, we discuss the study of the dynamics of charge trapping and detrapping process in the MAI-terminated and PbI2-terminated MAPbI3 surfaces, and bulk MAPbI3. We first investigated the surface stability of VI+ vacancies in the two surfaces. Then, we studied the electron trapping process around the iodine vacancies. The electron detrapping process was also studied in the presence of H2O, OH radical and O2 in the two surfaces. Finally, the electron trapping and detrapping processes in bulk MAPbI3 were also studied. We conclude our work in Section 4.
2. Computational methodology
At room temperature, MAPbI3 adopts a tetragonal structure with the bulk lattice parameters a = 8.88 Å and c = 12.63 Å.50 The MAI-terminated and PbI2-terminated MAPbI3 (110) surfaces were created by cleaving the bulk MAPbI3. We chose the MAPbI3 (110) surface as the prototypical model because it is of importance in the performance of perovskite solar cells.51,52 We built a  surface supercell with 2.5-layer repeated slab of MAPbI3. The corresponding chemical formulae are (MAPbI3)16(MAI)8 and (MAPbI3)16(PbI2)8. From the compositions of the surface, we can regard them as MAI-excess and PbI2-excess surfaces, respectively. The slabs were modeled by applying a vacuum gap of ∼12 Å to separate the periodically repeated supercells. The surface model is the same as that of our previous work which has been tested to be adequate for the study.53,54 We further tested this surface model with an iodine vacancy and found that the 2.5-layer model is adequate for this study. Fig. 1 shows the top-view and the side-view of the MAI-terminated and PbI2-terminated (110) MAPbI3 surfaces.
 Fig. 1  (a) & (b) Top view and side view of the relaxed MAI-terminated MAPbI3 (110) surface, respectively. M1 and M2 (orange spheres) in the MAI-terminated surface are the selected iodine atoms to create the iodine vacancies. (c) & (d) Top view and side view of the relaxed PbI2-terminated MAPbI3 (110) surface, respectively. P1 and P2 (orange spheres) in the PbI2-terminated surface are the selected iodine atoms to create the iodine vacancies. 
All the density functional theory (DFT)55,56 simulations were performed with the QUANTUM ESPRESSO package.57 The simulations were carried out with the gamma point sampling of the Brillouin zone, which has been tested to be adequate. We performed spin-polarized calculations for the systems which have unpaired electrons (e.g. the structures with VI0, the adsorption of OH and O2, etc.), while spin-unpolarized calculations were applied to the other systems. For the Perdew–Burke–Ernzerhof (PBE) exchange–correlation functional58 calculations, we used the ultrasoft, scalar relativistic pseudopotentials59 with the plane-wave kinetic energy cutoffs for the wavefunctions and the augmented charge density being 30 and 240 Ry, respectively. To better describe the weak interactions, the van der Waals (vdW) correction by Grimme and co-authors was employed.60,61 Unless stated otherwise, the calculations reported in this work were performed at the PBE level with the above settings.
The adsorption energy of the adsorbates (i.e. H2O, O2 and OH) on the MAPbI3 surfaces is defined as: Eads = E(adsorbate/MAPbI3) − E(adsorbate) − E(MAPbI3), where E(adsorbate/MAPbI3) is the total energy of the adsorbate on the MAPbI3 slab, E(adsorbate) is the energy of the adsorbate, and E(MAPbI3) is the energy of the MAPbI3 slab. The activation energy for iodine migration on the perovskite surface was computed by using the climbing image nudged elastic band (CI-NEB) method.62 The charge states of the different species on the perovskite surfaces (e.g. Pb ions) were determined by the maximally localized Wannier function (MLWF)63,64 analysis method, which has been applied in previous studies.53,54,65,66 The Wannier90 package67 was employed to obtain the Wannier Centers (WCs) of the species, and the results of the charge state calculations are presented in the ESI.† Besides the calculations on the MAPbI3 (110) surfaces, we also studied the electron trapping and detrapping behavior in bulk MAPbI3. For the bulk calculations, we used the 2 × 2 × 1 tetragonal MAPbI3 supercell. The simulations were carried out with the 1 × 1 × 2 grids of k-point sampling of the Brillouin zone.
For the defect-level calculations, we also performed single-point calculations using the Heyd–Scuseria–Ernzerhof (HSE) hybrid functional68 (43% Hartree–Fock exchange) with the inclusion of the spin–orbit coupling (SOC) interactions, which was suggested in previous studies.40,45,69,70 The HSE + SOC calculations were performed using norm-conserving pseudopotentials on the optimized structures from the PBE functional calculations above. The plane-wave kinetic energy cutoff for the wavefunctions here is 50 Ry. The k-point sampling mesh of each HSE + SOC calculation is the same as the corresponding calculation at the GGA-PBE level. The HSE + SOC method gave a band gap of 1.45 eV for bulk MAPbI3, which is in good agreement with the experimental band gap of 1.51 eV.71 The energy levels of the defect states in the surface slabs were obtained from the Kohn–Sham levels as in the work by Yamashita and coworkers.45 For the thermodynamic ionization levels ε(q1/q2) of the iodine vacancy in bulk MAPbI3, we used the equation: ε(q1/q2) = [ED(q1) − ED(q2)]/(q2 − q1) − EVBM, where ED(q1) and ED(q2) are the total DFT energies of the defective supercells with the charged states of q1 and q2 respectively, and EVBM is the valence band maximum (VBM) of the pristine bulk MAPbI3.
3. Results and discussion
3.1 Electron trapping at the MAI-terminated surface
We first studied the positive iodine vacancies at the top-surface layer (at the M1 position in Fig. 1) and subsurface layer (at the M2 position in Fig. 1) of the MAI-terminated surface (MAI-excess condition). Without excess electrons, the charge state of iodine vacancy is +1 (VI+) after removal of an iodide ion. The optimized structures are respectively shown in Fig. 2a and b. We obtained two similar structures as the iodide at the top-surface layer spontaneously migrated to the subsurface layer for the case when a vacancy was created at the subsurface M2 position (Fig. 2b), filling up the vacancy there. This means that the VI+ vacancy (M2) at the subsurface layer is energetically unfavorable. The reason could be that creating the subsurface layer vacancy involves breaking two Pb–I bonds while only one Pb–I bond is broken when the top-surface layer vacancy is created.
 Fig. 2  (a) & (b) The relaxed structure with a VI+ vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (c) & (d) The relaxed structure with a VI0 vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (e) & (f) The relaxed structure with a VI− vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (g) & (h) The total density of states for the structure in (c and f), respectively, with the Fermi level set at 0 eV. The red arrow in (h) indicates the intragap trapped state. (i) The energy profile for the iodine migration from the structure in (e) to the structure in (f). The side views of the structures in this figure are shown in Fig. SI5 in the ESI.† The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1. 
We then studied the VI+ vacancy with an excess electron (i.e., VI0). The relaxed structures after introducing the excess electron to the structures with the top-surface layer vacancy and with the subsurface layer vacancy are shown in Fig. 2c and d respectively. Since the systems have an unpaired electron, the figures also show the spin densities. For the case with the VI0 vacancy at the top-surface layer (Fig. 2c), the excess electron delocalizes around the lead ions. The charge density difference (Fig. SI1a in the ESI†) also confirms that the added electron in the structure in Fig. 2c is delocalized. For the case with the VI0 vacancy at the subsurface layer (Fig. 2d), the added electron is partially trapped by the two Pb ions around the iodine vacancy, and spontaneous iodine diffusion was not observed. The charge density difference (Fig. SI1b in the ESI†) also shows that the added electron in the structure in Fig. 2d is partially trapped by the two Pb ions around the iodine vacancy. However, the VI0 vacancy at the top-surface layer is more stable by −6.1 kcal mol−1 compared to that at the subsurface layer. This is consistent with the simulation work of Meng and coworkers.41 Similar to the case with the VI+ vacancy, the VI0 vacancy still prefers to stay at the top-surface layer, and there is no iodide migration induced by trapping one excess electron. As shown in Fig. 2g, the total density of states (DOS) for the top-layer vacancy structure (Fig. 2c) shows that there are no deep intragap states. We also plotted the DOS for the subsurface-layer vacancy structure (Fig. 2d) and found that there are no deep intragap states (Fig. SI2 in the ESI†). As will be discussed later, the presence of deep-level trapped states is closely related to the stability of the iodine vacancy at the subsurface layer.
We then studied the VI+ vacancy with two excess electrons (i.e., VI−). The optimized structures after introducing two excess electrons to the structures with the top-surface layer vacancy and with the subsurface layer vacancy are shown in Fig. 2e and f respectively. The charge density difference (Fig. SI1c and d in the ESI†) shows that the added electron in the structure in Fig. 2e is delocalized, while the added electron in the structure in Fig. 2f is mainly localized at two Pb ions. In contrast to the results above, the optimized structure in Fig. 2f with the vacancy at the subsurface layer was found to be more stable by −10.4 kcal mol−1 than that in Fig. 2e where the vacancy stays at the top-surface layer. It is due to the formation of a Pb–Pb covalent bond (ion distance: d(Pb–Pb) = 3.62 Å) at the subsurface layer. Previous DFT studies also observed Pb–Pb covalent bond formation in the presence of the VI− defect for bulk MAPbI3.35,38 The MLWF analysis showed that the two bonding Pb ions were reduced to form a Pb22+ dimer (as shown in Fig. SI3a and b in the ESI†). This means that the two introduced electrons are strongly localized at the two Pb ions. This Pb dimer could be the precursor of the formation of lead nanoparticles (one of the MAPbI3 degradation products in a vacuum).72,73 Moreover, as shown in Fig. 2h, the total DOS for the structure in Fig. 2f has a deep intragap state. Using the HSE functional with SOC, we also found that the defect levels are located between the conduction band minimum (CBM) and valance band maximum (VBM) (shown in Fig. SI4a in the ESI†), and a deep-level trap state is formed. This is in agreement with the results from the GGA-PBE method. Unlike VI+ and VI0, the VI− vacancy at the subsurface layer is energetically more favorable, suggesting that the two electrons in the deep-level trap enhance the stability of the iodine vacancy at the subsurface layer. Therefore, the iodine vacancy could migrate from the top-surface layer to the subsurface layer upon two-electron trapping. We performed the CI-NEB calculation to obtain the energy barrier for this process. As shown in Fig. 2i, the activation energy is +7.0 kcal mol−1. This is consistent with previous experimental measurements (+7.6–+ 13.8 kcal mol−1)74,75 and DFT calculations (+1.4–+15.0 kcal mol−1).74–78
3.2 Electron trapping at the PbI2-terminated surface
We next studied the VI+ vacancy at the top-surface layer (marked as P1 in Fig. 1) and subsurface layer (marked as P2 in Fig. 1) of the PbI2-terminated surface (PbI2-excess condition). The optimized structures are shown in Fig. 3a and b. Similar to the MAI-terminated surface, VI+ vacancy (P2 position) at the subsurface layer is energetically unstable, and the surface iodide at the P1 position spontaneously migrates to the P2 position to fill up the vacancy. Although removing an iodide (I−) from the top-surface layer and from the subsurface layer both need to break two Pb–I bonds, the subsurface iodide (P2 position) interacts with four MA cations while there are only two MA cations that interact with the top-surface iodide at the P1 position (as shown in Fig. 1c and d). Therefore, creating a top-surface VI+ vacancy requires less energy.
 Fig. 3  (a) & (b) The relaxed structure with a VI+ vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (c) & (d) The relaxed structure with a VI0 vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (e) & (f) The relaxed structure with a VI− vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (g) & (h) The total density of states for the structure in (d and f), respectively, with the Fermi level set at 0 eV. The red arrow indicates the intragap state. (i) The energy profile for iodine migration from the structure in (c) to the structure in (d), and from the structure in (e) to the structure in (f). The side views of the structures in this figure are shown in Fig. SI7 in the ESI.† The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1. 
We then studied the VI+ vacancy with an excess electron (i.e., VI0). The optimized structures after introducing one excess electron to the structures with the top-surface layer vacancy and the subsurface layer vacancy are shown in Fig. 3c and d respectively. The figures also show the spin densities for the two cases. As shown in the figures, the excess electron delocalizes over different Pb ions for the case with the VI0 vacancy in the top layer, which agrees well with the previous DFT work.45 The charge density difference (Fig. SI6a in the ESI†) also confirms that the added electron in the structure in Fig. 3c is delocalized. However, for the VI0 vacancy at the subsurface layer, the excess electron strongly localizes at the two Pb ions originally bonded to the removed iodide, forming a covalent Pb–Pb bond (d(Pb–Pb) = 3.57 Å). The charge density difference (Fig. SI6b in the ESI†) also shows that the added electron in the structure in Fig. 3d is localized. The MLWF analysis showed that the two bonding Pb ions were reduced to form a Pb23+ dimer (Fig. SI3c and d in the ESI†). Unlike VI+, the VI0 at the subsurface layer is more stable by −7.2 kcal mol−1 than that at the top-surface layer. Therefore, the iodine vacancy is likely to migrate from the top-surface layer to the subsurface layer during the one electron trapping process. We performed CI-NEB to study this migration (Fig. 3i), and the activation energy was found to be +7.2 kcal mol−1. For VI0 at the subsurface layer, the total DOS shown in Fig. 3g and the spin density shown in Fig. 3d show that there is a deep-level intragap trapped state with a localized electron. Using the HSE functional with SOC, we also found the defect levels are located between the CBM and VBM (shown in Fig. SI4b in the ESI†), and a deep-level trap state is formed. The electron in the deep-level trap favors the iodine vacancy migration from the top-surface layer to the subsurface layer. Compared with that in the MAI-terminated surface, the iodine vacancy in the PbI2-terminated surface was more susceptible to form deep-level traps due to the presence of dangling bonds on the top-layer Pb ions. The reason is that two deep-level trapped electrons are needed to induce such migration for the MAI-terminated surface while one is sufficient for the PbI2-terminated surface. This could be a reason that previous experimental studies showed that the MAI-excess MAPbI3 films have higher PL intensity (i.e., lower nonradiative recombination) than the stoichiometric or PbI2-excess MAPbI3 films.33,79
We further studied the VI+ vacancy with two excess electrons (i.e. VI−). Fig. 3e and f show the optimized structures with two additional electrons introduced to the structures with the top-surface layer vacancy and the subsurface layer vacancy respectively. As shown in the figures, there is no spontaneous iodine migration upon optimization. The charge density difference (Fig. SI6c and d in the ESI†) shows that the added electron in the structures in both Fig. 3e and f is localized at two Pb ions. Moreover, a Pb–Pb covalent bond was formed between the two Pb originally bonded to the removed iodine in both cases. The Pb–Pb bond length for the two structures is 3.26 and 3.39 Å respectively. The MLWF analysis shows that the two Pb ions for the two structures were reduced to a Pb22+ dimer in both cases (Fig. SI3e–h in the ESI†). Similar to VI0, we found that VI− at the subsurface layer (Fig. 3f) is more stable by −4.5 kcal mol−1 than that at the top-surface layer (Fig. 3e). As shown in Fig. 3h, the total DOS of VI− at the subsurface layer (Fig. 3f) has an intragap state, which is closely related to the favorability of the vacancy at the subsurface layer. Using the HSE functional with SOC, we also found the defect levels located between the CBM and VBM (shown in Fig. SI4c in the ESI†), and a deep-level trap state is formed. We performed CI-NEB to study the migration process (Fig. 3i), and the activation energy was found to be +19.7 kcal mol−1. Due to the strong Pb–Pb covalent bond, the activation energy of iodide migration is large.
3.3 Electron detrapping at the MAI-terminated surface
The trapped electrons can be eliminated via different processes such as recombination with photoinduced holes and removal by humid air or the electron transport layers (e.g., fullerene derivatives and metal oxides). Here, we focus on humid air elimination of the trapped electrons. Since hydroxyl radicals (OH) can readily form at the MAPbI3/metal oxide (e.g., ZnO) interface under illumination and humid air conditions,80,81 we also study here the role of the OH species in eliminating excess electrons. For the charge detrapping process, an OH radical can only abstract one electron. However, molecular O2 can abstract one electron (or two electrons), converting to superoxide (or peroxide) during the chemisorption process. We chose the surface Pb ion as the adsorption site for the OH radical and oxygen species. We also studied H2O molecule adsorption on the perovskite surface for comparison. As will be discussed below, the H2O molecule only physisorbs on the perovskite surface and the excess electrons do not transfer to the H2O molecule. Therefore, the relaxed structures of H2O adsorption are only shown in the ESI.† For the MAI-terminated MAPbI3 surfaces, the energetically favorable structures in Fig. 2a (VI+), 2c (VI0) and 2f (VI−) were selected as the templates for the adsorption study.
First, we respectively placed H2O, O2 and OH on the perovskite surface with a VI+ vacancy (M1 position) as shown in Fig. 2a for the case without excess electrons. The adsorption energies are listed in Table 1. The H2O molecule was found to physisorb on the surface (Fig. SI8a in the ESI†), and the adsorption energy is −37.0 kcal mol−1. The MLWF analysis confirmed that the H2O remains a neutral molecule upon adsorption. The O2 adsorption structure is shown in Fig. 4a. The O2 physisorbs on Pb ions with a small adsorption energy of −16.1 kcal mol−1. The spin density distribution (Fig. 4a) and the MLWF analysis (Fig. SI9a and b in the ESI†) confirm that there is no electron abstraction by the O2. On the other hand, for OH, as shown in the spin density distribution in Fig. 4b, we found that an electron was abstracted from the perovskite surface by the OH radical. The spin density in the figure shows that the resulting hole is delocalized over the inorganic framework of PbI3−. The MLWF analysis in Fig. SI9c and d in the ESI† also confirms that the OH radical is converted to an OH− ion. A Pb–O covalent bond is also formed. Moreover, two H⋯O hydrogen bonds between the OH radical and two nearby MA cations are present on the surface. Since it is chemisorption, the adsorption energy of OH is more negative (−64.9 kcal mol−1) compared to those with H2O and O2. For all three cases above, the iodine vacancy remains at the top-surface layer. We also calculated the OH radical adsorption energy on the pristine surfaces, which equals −63.1 kcal mol−1. Without the excess electron, the OH radical adsorption energy on the defective surface is close to that on the pristine surface.
Table 1 The adsorption energies in kcal mol−1 of the H2O, O2 and OH on the MAI-terminated surfaces with different types of vacancies. We have marked “Y” (or “N”) when there is (or is no) vacancy migration induced by the adsorption and electron abstraction processes






H2O
O2
1st OH
2nd OH



E
ads

Migration

E
ads

Migration

E
ads

Migration

E
ads

Migration





V
I
+

−37.0
N
−16.1
N
−64.9
N
—
—



V
I
0

−34.4
N
−49.5
N
−106.7
N
—
—



V
I
−

−33.7
N
−90.8
Y
−106.8
Y
−102.0
N




 Fig. 4  (a) & (b) The adsorption of an O2 and an OH on the structure in Fig. 2a, respectively. (c) & (d) The adsorption of an O2 and an OH on the structure in Fig. 2c, respectively. (e) & (g) The adsorption of an O2 and an OH on the structure in Fig. 2f, respectively. (f) & (h) The final state of the structure in (e) and (g) after ion migration, respectively. (i) The adsorption with the second OH on the structure in (h). (j) The energy profile for the above two migration processes. The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1. 
Then, we respectively placed H2O, O2 and OH on the perovskite surface in Fig. 2c with a VI0 vacancy (M1 position) for the case with one excess electron. In this case, the excess electron is in the shallow-level trap. The adsorption energies are shown in Table 1. As shown in Fig. 4c, with one excess electron, O2 chemisorbs on the perovskite surface. The MLWF analysis indicates that the O2 is converted to a superoxide (Fig. SI10a and b in the ESI†). The adsorption energy is −49.5 kcal mol−1, which is more negative than that for O2 adsorption without the excess electron (−16.1 kcal mol−1). For the case with an OH radical, the excess electron was also abstracted by the OH radical upon adsorption (Fig. 4d). The MLWF analysis in Fig. SI10c and d in the ESI† confirms that the OH radical is converted to an OH− ion. The adsorption energy is −106.7 kcal mol−1, which is also more negative than the case in Fig. 4b without the excess electron (−64.9 kcal mol−1) and the OH radical adsorption energy on the pristine surfaces (−63.1 kcal mol−1). This shows that the presence of the defect levels leads to the more negative OH adsorption energies. Therefore, the excess electron enhances the adsorption of the O2 and OH species to the surface which is often the first step of the degradation reaction. This means that the presence of the shallow-level traps can accelerate the photodegradation of MAPbI3 under humid air conditions. On the other hand, as shown in Table 1, the H2O adsorption energy changed little in the presence of an excess electron. The adsorption structure is shown in Fig. SI8b and c in the ESI.† The MLWF analysis shown in the figures suggests that the charge state of the H2O remains zero. Again, for all these three cases, the iodine vacancy remains at the top-surface layer upon adsorption.
We then studied the cases with two excess electrons. H2O, O2 and OH were respectively placed on the perovskite surface with a VI− vacancy and the two excess electrons are in the deep-level trapped states (Fig. 2f). The adsorption energies are shown in Table 1. In this case, before adsorption, the iodine vacancy is situated more favorably at the subsurface layer (M2 position). Similar to the previous cases, H2O only physisorbs on the surface. The adsorption energy is −33.7 kcal mol−1. The MLWF analysis (Fig. SI8d and e in the ESI†) shows that the charge state of the H2O remains zero. On the other hand, Fig. 4e shows the O2 adsorption structure. The spin-polarized calculation was performed in this case but we found no net spin for this structure. The two excess electrons are abstracted by the O2 molecule as it chemisorbs on the surface forming a peroxide. Simultaneously, a proton from the nearby MA cations spontaneously transfers to the resulting peroxide in this proton coupled-electron transfer (PCET) process, forming an OOH− ion. The formation of an OOH− ion was also confirmed by the MLWF analysis shown in Fig. SI11a and b in the ESI.† On top of that, the iodine vacancy at the subsurface M2 position spontaneously migrates back to the top-surface M1 position due to the loss of two electrons. The adsorption energy of the O2 molecule is −90.8 kcal mol−1 which is more negative than the cases without excess electrons and with one excess electron. Therefore, the two excess electrons in the deep-level traps enhance the photodegradation of MAPbI3 under humid air conditions. The two transferred electrons come from the original Pb2+ dimer and the Pb22+ dimer is oxidized back to two Pb2+ ions. This suggests that in the presence of O2, the excess electrons prefer to transfer to the O2 over-reducing the Pb2+ ions to Pb+ or Pb0. This is consistent with the previous experimental studies which found that Pb nanoparticles (or metallic Pb) as a degradation product can only form under vacuum conditions rather than in air.73,82 On the other hand, the optimized structure shown in Fig. 4e has slight distortion from the original lattice positions. We manually moved these ions back to their original lattice positions and the optimized structure is shown in Fig. 4f. We found that this structure is more stable by −1.8 kcal mol−1. The CI-NEB calculation showed that the activation energy for the ion migration process is +6.2 kcal mol−1 (Fig. 4j).
Next, we studied OH adsorption on the MAI-terminated surface with a VI− vacancy (Fig. 4g). The OH radical was found to abstract one of the two excess electrons from the surface. The spin density distribution in Fig. 4g shows that the remaining excess electron is mainly trapped in the two Pb ions originally bonded to the removed iodine (i.e. the green lead ions). The VI0 vacancy was found to remain at the subsurface layer although, as stated above for the case with one excess electron in the perovskite surface, it is more favorable for the VI0 vacancy to be situated at the top-surface layer. We performed the CI-NEB calculation to study the iodine migration process for the VI0 vacancy to return to the top-surface layer (Fig. 4j). The activation energy was found to be only +1.5 kcal mol−1. The final state (Fig. 4h) is slightly more stable than the initial state by −1.5 kcal mol−1. The spin density distribution in Fig. 4h shows that the remaining excess electron is delocalized over all the Pb ions. After that, we added another OH radical on the surface. The optimized structure (Fig. 4i) shows that the additional OH radical abstracts the remaining excess electron from the surface. The MLWF analysis also confirmed that the two excess electrons were abstracted by the two OH species, forming two OH− ions (Fig. SI11c and d in the ESI†). After detrapping the two excess electrons, the iodine vacancy at the top-surface layer (M1 position) remains more favorable. Overall, our results suggest that the presence of the electrons in deep-level traps favors vacancies at the subsurface layer. The trapping and detrapping process induces iodine migration between the top-surface layer and the subsurface layer.
3.4 Electron detrapping at the PbI2-terminated surface
For the PbI2-terminated MAPbI3 surface, we used the energetically favorable structures in Fig. 3a (VI+), 3d (VI0) and 3f (VI−) as the templates for the adsorption study. First, we respectively placed the H2O, O2 and OH species on the perovskite surface in Fig. 3a which has no excess electrons. The iodine vacancy is originally at the top-surface layer (P1 position). Table 2 shows the adsorption energies for the different adsorbates. Again, the H2O molecule was found to weakly interact with the perovskite surface (Fig. SI12a in the ESI†) with a small adsorption energy of −17.5 kcal mol−1. Similarly, O2 also physisorbs on the surface (Fig. 5a) with a small adsorption energy of −16.9 kcal mol−1. The MLWF analysis (Fig. SI13a and b in the ESI†) confirmed that the charge state of O2 is zero. On the other hand, as shown in Fig. 5b, the OH radical chemisorbs on the surface bonding with a surface Pb ion (d(Pb–O) = 2.15 Å) with a large adsorption energy of −41.0 kcal mol−1. The net spin density (Fig. 5b) localizes around the OH and the top layer of the inorganic PbI3− framework. The MLWF analysis suggests that the OH radical becomes an OH− ion (Fig. SI13c and d in the ESI†). The iodine vacancy remains at the top-surface layer due to the absence of the deep-level trapped electrons. We also calculated the OH radical adsorption energy on the pristine surfaces, which equals −42.6 kcal mol−1. Without the excess electron, the OH radical adsorption energies on the defective surface are close to those of the pristine surface.
Table 2 The adsorption energies of the H2O, O2 and OH on the PbI2-terminated surfaces with different types of vacancies. We marked “Y” (or “N”) if there is (or is no) vacancy migration induced by the adsorption and electron abstraction processes






H2O
O2
1st OH
2nd OH



E
ads

Migration

E
ads

Migration

E
ads

Migration

E
ads

Migration





V
I
+

−17.5
N
−16.9
N
−41.0
N
—
—



V
I
0

−17.6
N
−44.0
Y
−76.5
Y
—
—



V
I
−

−17.0
N
−62.6
Y
−72.1
N
−78.3
Y




 Fig. 5  (a) & (b) The adsorption of an O2 and an OH on the structure in Fig. 3a, respectively. (c) & (d) The adsorption of an O2 and an OH on the structure in Fig. 3d, respectively. (f) & (g) The adsorption of an O2 and OH on the structure in Fig. 3f, respectively. (h) The adsorption with the second OH on the structure in (g). (e) & (i) The final state of the structure in (d) and (h) during ion migration, respectively. (j) The energy profiles for the above two migration processes. The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1. 
Then, we respectively placed H2O, O2 and OH on the PbI2-terminated perovskite surface with an iodine vacancy and one excess electron (VI0). The iodine vacancy is originally more favorable at the subsurface layer (P2 position). Table 2 shows the adsorption energies for the different adsorbates. The H2O was found to only weakly interact with the perovskite surface (Fig. SI12b and c in the ESI†). On the other hand, the O2 spontaneously abstracts the excess electron upon adsorption (Fig. 5c). The MLWF analysis in Fig. SI14a and b in the ESI† indicates that the O2 is converted to a superoxide. The original Pb23+ dimer at the subsurface is oxidized to become two Pb2+ ions. Due to the detrapping of the deep-level electron, the iodine vacancy spontaneously migrates to the top-surface layer. Moreover, the resulting superoxide occupies the iodine vacancy (P2 position) at the top-surface layer, and two oxygens form two Pb–O covalent bonds with two surface Pb. As shown in Table 2, the adsorption energy is −44.0 kcal mol−1, which is significantly more negative than the case without the excess electron (−16.9 kcal mol−1). There is no obvious distortion of the structure in Fig. 5c from the original lattice structure. For OH adsorption, as shown in Fig. 5d, a Pb–O bond is formed between a surface Pb ion and the OH. The adsorption energy for OH radical is −76.5 kcal mol−1, which is also more negative than the case in Fig. 4b without the excess electron (−41.0 kcal mol−1) and the OH radical adsorption energies on the pristine surfaces (−42.6 kcal mol−1). Therefore, the more negative OH adsorption energy is due to the presence of the defect levels. The MLWF analysis in Fig. SI14c and d in the ESI† indicates that the OH is converted to an OH− ion. The subsurface iodine vacancy spontaneously migrates to the top-surface layer. However, the optimized structure has a slight distortion, and some ions (especially for the green Pb ion on the top-surface layer) are away from the original lattice positions. The CI-NEB calculations (Fig. 5j) were applied to study the ion diffusion back to their original lattice positions. The final structure is shown in Fig. 5e. The activation energy is +5.2 kcal mol−1, and the final state is more stable than the initial state by −4.1 kcal mol−1.
We next placed H2O, O2 and OH respectively on the perovskite surface with an iodine vacancy and two excess electrons (i.e. the structure in Fig. 3f). The iodine vacancy is originally at the subsurface layer (P2 position). For the case with H2O, the two excess electrons do not transfer to the H2O. The H2O only physisorbs on the surface with an adsorption energy of −17.0 kcal mol−1 (Fig. SI12d and e in the ESI†). On the other hand, the O2 chemisorbs on the surface (Fig. 5f). The MLWF analysis (Fig. SI15a and b in the ESI†) shows that the O2 molecule spontaneously abstracts the two excess electrons, forming a peroxide species. As shown in Table 2, the adsorption energy of the O2 is increased to −62.6 kcal mol−1, which is significantly more negative than the case with an excess electron (−44.0 kcal mol−1). Without the two deeply trapped electrons, the iodine vacancy spontaneously migrates to the top-surface layer. At the same time, the resulting peroxide occupied the iodine vacancy. The original Pb22+ dimer is oxidized to form two Pb2+ ions. The two oxygen atoms of the resulting peroxide were also found to form three Pb–O bonds with two surface Pb ions. There is no obvious distortion for the atoms in this case from their original lattice positions. For OH adsorption, as shown in Fig. 5g, one OH radical abstracts only one of the two excess electrons. The spin density distribution in Fig. 5g shows that the remaining excess electron is still mainly shared by the two Pb ions originally bonding to the removed iodine. As shown in Table 2, the adsorption energy of the OH is −72.1 kcal mol−1. However, due to the loss of one excess electron, the Pb–Pb bond increases from 3.26 to 3.55 Å. Since the VI0 at the subsurface layer is more stable than that at the top-surface layer in the case with one excess electron in the surface, there is no iodine migration. We further added another OH radical to the surface. The adsorption energy was found to be −78.3 kcal mol−1 and the remaining excess electron spontaneously transfers to the OH. The MLWF analysis (Fig. SI15c and d in the ESI†) also confirms that the two excess electrons are abstracted by the two OH radicals, forming two OH− ions. Due to the removal of two deeply trapped electrons, the iodine vacancy spontaneously migrates from the subsurface layer to the top-surface layer. However, the optimized structure (Fig. 5h) has a slight distortion. Some atoms (especially for the green Pb ion on the top-surface layer) are away from their lattice sites. The CI-NEB calculation (Fig. 5j) was applied to study the ion diffusion process. The activation energy was calculated to be +6.7 kcal mol−1, and the final state is more stable than the initial state by −5.8 kcal mol−1.
3.5 Electron trapping and detrapping in bulk MAPbI3
In this subsection, we study the electron trapping and detrapping processes in bulk MAPbI3. The behavior of two iodine vacancies in bulk perovskite is also studied. We considered two different types of vacancy arrangement: one is that the two iodine vacancies in bulk MAPbI3 are next-nearest neighbors (nonadjacent), while the other is that the two iodine vacancies are adjacent. Herein, we mainly considered vacancy migration between the two arrangements. We denote here the structures with two next-nearest iodine vacancies and two adjacent iodine vacancies as B1 and B2 structures, respectively. Firstly, for the electron trapping process, we respectively introduced one excess electron to the B1 and B2 structures (Fig. 6a and b). The spin density plot for the B1 structure (Fig. 6a) shows that the excess electron delocalizes around the Pb ions. However, for the B2 structure (Fig. 6b), the excess electron mainly localizes at two of the Pb ions, forming a Pb23+ ion. Therefore, for the B2 structure, one VI0 vacancy and one VI+ vacancy were formed. Moreover, we found that the structure with two adjacent iodine vacancies (Fig. 6b) is more stable by −2.3 kcal mol−1 than the structure with two nonadjacent iodine vacancies (Fig. 6a). We performed the CI-NEB calculation to study the iodine migration process from the B1 to B2 structures, and the activation energy was found to be +9.0 kcal mol−1. Although here we studied iodine vacancy migration from the next-nearest-neighbor to the adjacent configuration, the vacancies can in fact migrate over a long distance. The vacancies can in fact migrate over a long distance. There are two steps for such long-range migration: (1) the iodine vacancies separated by a long distance migrate to the next-nearest sites (B1 structure). The mechanism of this stage is similar to the iodine vacancy migration proposed by previous studies.38,75,76,78 (2) Iodine vacancies migrate from the B1 structure to the B2 structure. The schematic diagram of long-range iodine migration in bulk MAPbI3 is shown in Fig. SI16 in the ESI.†
 Fig. 6  (a) & (b) The relaxed B1 and B2 structures with one excess electron, respectively. (c) & (d) The relaxed B1 and B2 structures with two excess electrons, respectively. (e) & (f) The relaxed B2 and B1 structures without excess electrons, respectively. (g) The energy profiles for the three migration processes. The red arrows in (a), (c) and (e) denote the directions of the iodine diffusion. (h) The thermodynamic ionization levels for the B2 structure. The Pb ions bonded to the removed iodide are marked as dark cyan spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1. 
We then added the second excess electron to both the B1 and the B2 structures. The optimized structures are shown in Fig. 6c and d. A covalent Pb–Pb bond is formed (i.e., Pb22+ ion) in both cases, and the corresponding Pb–Pb distances are 3.62 and 3.57 Å, respectively. Therefore, for both structures, one VI− vacancy and one VI+ vacancy were formed, respectively. We found that the structure with two adjacent iodine vacancies (Fig. 6d) is more stable by −2.1 kcal mol−1 than the structure with two nonadjacent iodine vacancies (Fig. 6c). We performed the CI-NEB calculation to study the iodine migration process (from Fig. 6c and d), and the activation energy is +8.4 kcal mol−1.
Furthermore, we studied the electron detrapping process in bulk MAPbI3. After abstracting an excess electron from the structure in Fig. 6b or two excess electrons from the structure in Fig. 6d, two adjacent VI+ vacancies were formed in the bulk MAPbI3. The optimized structure is shown in Fig. 6e. However, the structure is unstable by +8.7 kcal mol−1 compared to the structure with two nonadjacent (next-nearest) VI+ vacancies (Fig. 6f). We performed the CI-NEB calculation to study the iodine migration process (from Fig. 6e and f), and the activation energy is +8.6 kcal mol−1.
To evaluate the thermostability of the trapped states, we also calculated the thermodynamic ionization levels for the structure with two adjacent iodine vacancies (i.e. the structures in Fig. 6b, d and e) by using the HSE functional with SOC. The charge states for the structures in Fig. 6b, d and e are +1, 0, and +2, respectively. As shown in Fig. 6h, the three transition levels are below the edge of the CBM. Therefore, the deep trapped VI− vacancy (with two excess electrons in the supercell) is thermodynamically stable. The iodine vacancies formed deep trap states via the iodine migration process.
The DFT results showed that without the excess electrons, the iodine vacancies are unlikely to cluster together. The excess electrons facilitate the clustering of the iodine vacancies together. Using DFT calculations, we also studied the following structures: (1) three nonadjacent iodine vacancies in the bulk MAPbI3; (2) three adjacent iodine vacancies in the bulk MAPbI3. The results are shown in Fig. SI17 in the ESI.† We found that with electron trapping, the structure with three adjacent iodine vacancies in the bulk MAPbI3 is more stable. However, after electron detrapping, the structure with three nonadjacent iodine vacancies in bulk MAPbI3 is more stable. This further supports the finding that the excess electrons facilitate the iodine vacancies to cluster together. This could explain the formation of metallic Pb as one of the MAPbI3 photo-degradation products in a vacuum.
3.6 The possible origin of photoinduced ion migration and hysteresis behavior
In this subsection, we discuss the possible origin of photoinduced ion migration and the J–V hysteresis behavior. Snaith and coworkers suggested that a combination of mobile ions and traps is responsible for J–V hysteresis.26 In this work, we found that, without excess electrons, it is more favorable for the iodine vacancy VI+ to locate at the top-surface layer for both the MAI-terminated (i.e., MAI-excess) and PbI2-terminated (i.e., PbI2-excess) MAPbI3 surfaces. Under forward bias conditions when a large number of trapped electrons accumulate at the defects,31,32 the top-surface iodine vacancies become unstable and migrate to the subsurface layer. While two deep-level trapped electrons are needed to induce such migration for the MAI-terminated surface, one is sufficient for the PbI2-terminated surface. This suggests the higher propensity for the PbI2-terminated surface to have deep-level electron trap states and exhibit the J–V hysteresis behavior. This is consistent with the experimental studies which found that the MAI-excess MAPbI3 films have higher photoluminescence intensity (i.e., lower nonradiative recombination) than the stoichiometric or PbI2-excess MAPbI3 films.33,79
When the trapped electrons are released under short-circuit conditions,31,32 the iodine vacancies migrate from the subsurface layer back to the top-surface layer. Therefore, the excess electron trapping and detrapping in the deep-level states induce iodine migration and the J–V hysteresis behavior. Since excess electrons can also be generated under illumination, such a behavior should be dependent on the photon dose. In fact, previous experimental studies also observed photon-dependent iodine migration and hysteresis effects.20,83 Furthermore, it has been found that hysteresis effects were generally higher in the photovoltaic devices using PbI2-excess MAPbI3 samples than in those using stoichiometric or MAI-excess MAPbI3 samples.22,28,33 One possible reason is that the PbI2-terminated (PbI2-excess) surface is more susceptible to form deep-level trapped states. Our work also explains why previous experimental studies84,85 found that suppressing charge accumulations in the interface of the perovskite/electron transport layers contributes to the reduction of the hysteresis effect.
4. Conclusion
Using DFT techniques, we studied the properties of iodine vacancies on the MAI-terminated and PbI2-terminated surfaces. The VI+ vacancy was found to be more favorable to stay at the top-surface layer. It is because removing an I− ion at the top-surface layer of the MAI-terminated surface only breaks one Pb–I bond, rather than two Pb–I bonds if the vacancy is created at the subsurface layer. For the PbI2-terminated surface, there are two MA cations interacting with a top-surface layer I− ion, while there are four MA cations interacting with the subsurface layer I− ion. Therefore, it is energetically favorable to create a VI+ vacancy at the top-surface.
We then studied the effects of excess electrons on the vacancy stability. We first introduced one excess electron to the MAI-terminated surface with one VI+ vacancy. The excess electron was found to be in a shallow-level trap state. The resulting VI0 vacancy remains at the top-surface layer. However, by introduction of one excess electron to form the VI0 vacancy in the PbI2-terminated surface, a deep-level trapped state is formed. The vacancy preferentially migrates to the subsurface layer leading to the formation of a Pb23+ dimer. Therefore, the excess electron in the deep-level trap facilitates the iodine vacancy migration from the top-surface layer to the subsurface layer as well as the Pb23+ dimer formation. Previous theoretical studies using TDDFT also found that deep traps can be formed in defective MAPbI3 perovskite (e.g. iodine vacancies).47 These strongly localized electrons at the iodine vacancies facilitate the formation of Pb–Pb covalent bonds. By introducing two excess electrons, the VI− vacancy preferentially locates at the subsurface layer for both the MAI-terminated and PbI2-terminated surfaces with the formation of the deep-level traps and a Pb22+ dimer. Therefore, for the MAI-terminated surface, the iodine vacancy migrates from the top-surface layer to the subsurface layer. The resulting Pb22+ or Pb23+ dimer could be the precursor of lead nanoparticles (one of the MAPbI3 degradation products in a vacuum).72,73 Based on the above results, the PbI2-terminated (i.e., PbI2-excess) surface exhibits a higher tendency to capture excess electrons to form deep-level trapped states, leading to the migration of top-surface iodine vacancy to the subsurface. This could be a possible reason that the MAI-excess MAPbI3 has higher photoluminescence intensity (i.e., lower nonradiative recombination) than the stoichiometric or PbI2-excess MAPbI3 films.33,79
To study the electron detrapping process, we placed H2O, OH radical and O2 on the surfaces. They are expected to respectively abstract zero, one and two excess electrons. For the surfaces without excess electrons or with only a shallow-level trapped electron, the vacancy remains at the top surface upon adsorption. However, for the surfaces with deep-level trapped electrons, we found that the iodine vacancy migrated from the subsurface layer back to the top-surface layer during the chemisorption of the OH radicals and O2 due to electron detrapping. The adsorption strength of the OH radicals and O2 was also enhanced by the presence of excess electrons no matter whether the electrons were in the shallow or deep trapped states. The Pb22+ or Pb23+ dimer was oxidized back to two Pb2+ ions during the detrapping process. The excess electrons preferentially transfer to the OH and O2 over the Pb ions. This could be the reason why lead nanoparticles (or metallic lead) as a degradation product can only be formed under vacuum conditions.73,82
Furthermore, we studied the electron trapping and detrapping processes in bulk MAPbI3. We found that with electron trapping, the structure with two adjacent iodine vacancies in the bulk MAPbI3 is more stable. The excess electrons facilitate the clustering of the two iodine vacancies together and form deep trap states via the iodine migration process. However, after electron detrapping, the structure with two adjacent iodine vacancies in bulk MAPbI3 becomes unstable, which facilitates the formation of two nonadjacent iodine vacancies via the iodine migration process. The iodine vacancies are unlikely to cluster together in the absence of excess electrons. Finally, we discussed the possible mechanisms for photoinduced ion migration and the hysteresis behavior. Through this study, we found that excess electrons trapped in both the shallow-level and deep-level states enhance the photodegradation of MAPbI3 under humid air conditions. However, the electrons in the deep-level traps play a significantly more important role in facilitating photoinduced ion migration and the hysteresis behavior.
Conflicts of interest
There are no conflicts to declare.
Acknowledgements
This work utilized the High-Performance Computer Cluster managed by the School of Energy and Environment (SEE) and the College of Science and Engineering (CSE) of the City University of Hong Kong. Use of the Center for Nanoscale Materials, an Office of Science user facility, was supported by the U.S. Department of Energy, Office of Science, Office of Basic Energy Sciences, under Contract No. DE-AC02-06CH11357. The authors acknowledge the support by the CityU SRG Funds (Project No. 7004691 and 7004926) and the Research Grants Council of the Hong Kong Special Administrative Region, China (Project No. CityU21305415).
References
W. S. Yang, B.-W. Park, E. H. Jung, N. J. Jeon, Y. C. Kim, D. U. Lee, S. S. Shin, J. Seo, E. K. Kim, J. H. Noh and S. I. Seok, Science, 2017, 356, 1376–1379 CrossRef CAS PubMed .
A. Kojima, K. Teshima, Y. Shirai and T. Miyasaka, J. Am. Chem. Soc., 2009, 131, 6050–6051 CrossRef CAS PubMed .
N.-G. Park, M. Grätzel, T. Miyasaka, K. Zhu and K. Emery, Nat. Energy, 2016, 1, 16152 CrossRef CAS .
M. D. Sampson, J. S. Park, R. D. Schaller, M. K. Y. Chan and A. B. F. Martinson, J. Mater. Chem. A, 2017, 5, 3578–3588 RSC .
P.-P. Sun, Q.-S. Li, S. Feng and Z.-S. Li, Phys. Chem. Chem. Phys., 2016, 18, 14408–14418 RSC .
M. Roknuzzaman, K. Ostrikov, H. Wang, A. Du and T. Tesfamichael, Sci. Rep., 2017, 7, 14025 CrossRef PubMed .
T. Zhao, D. Wang and Z. Shuai, Synth. Met., 2017, 225, 108–114 CrossRef CAS .
S. D. Stranks, G. E. Eperon, G. Grancini, C. Menelaou, M. J. P. Alcocer, T. Leijtens, L. M. Herz, A. Petrozza and H. J. Snaith, Science, 2013, 342, 341–344 CrossRef CAS PubMed .
T. C. Jellicoe, J. M. Richter, H. F. J. Glass, M. Tabachnyk, R. Brady, S. E. Dutton, A. Rao, R. H. Friend, D. Credgington, N. C. Greenham and M. L. Böhm, J. Am. Chem. Soc., 2016, 138, 2941–2944 CrossRef CAS PubMed .
I. L. Braly and H. W. Hillhouse, J. Phys. Chem. C, 2016, 120, 893–902 CrossRef CAS .
T. Zhao, W. Shi, J. Xi, D. Wang and Z. Shuai, Sci. Rep., 2016, 6, 19968 CrossRef PubMed .
B. Murali, E. Yengel, C. Yang, W. Peng, E. Alarousu, O. M. Bakr and O. F. Mohammed, ACS Energy Lett., 2017, 2, 846–856 CrossRef CAS .
A. R. Srimath Kandada, S. Neutzner, V. D'Innocenzo, F. Tassone, M. Gandini, Q. A. Akkerman, M. Prato, L. Manna, A. Petrozza and G. Lanzani, J. Am. Chem. Soc., 2016, 138, 13604–13611 CrossRef CAS PubMed .
N. De Marco, H. Zhou, Q. Chen, P. Sun, Z. Liu, L. Meng, E.-P. Yao, Y. Liu, A. Schiffer and Y. Yang, Nano Lett., 2016, 16, 1009–1016 CrossRef PubMed .
W. Zhang, Y. Ding, Y. Jiang, M. Zheng, S. Wu, X. Lu, M. Zeng, X. Gao, Q. Wang, G. Zhou, J.-M. Liu, K. Kempa and J. Gao, RSC Adv., 2017, 7, 39523–39529 RSC .
W. Nie, H. Tsai, J.-C. Blancon, F. Liu, C. C. Stoumpos, B. Traore, M. Kepenekian, O. Durand, C. Katan, S. Tretiak, J. Crochet, P. M. Ajayan, M. Kanatzidis, J. Even and A. D. Mohite, Adv. Mater., 2017, 30, 1703879 CrossRef PubMed .
V. Adinolfi, W. Peng, G. Walters, O. M. Bakr and E. H. Sargent, Adv. Mater., 2018, 30, 1700764 CrossRef PubMed .
E. Mosconi, D. Meggiolaro, H. J. Snaith, S. D. Stranks and F. De Angelis, Energy Environ. Sci., 2016, 9, 3180–3187 RSC .
E. T. Hoke, D. J. Slotcavage, E. R. Dohner, A. R. Bowring, H. I. Karunadasa and M. D. McGehee, Chem. Sci., 2015, 6, 613–617 RSC .
D. W. deQuilettes, W. Zhang, V. M. Burlakov, D. J. Graham, T. Leijtens, A. Osherov, V. Bulović, H. J. Snaith, D. S. Ginger and S. D. Stranks, Nat. Commun., 2016, 7, 11683 CrossRef CAS .
N. Aristidou, C. Eames, I. Sanchez-Molina, X. Bu, J. Kosco, M. S. Islam and S. A. Haque, Nat. Commun., 2017, 8, 15218 CrossRef PubMed .
T. P. Gujar, T. Unger, A. Schonleber, M. Fried, F. Panzer, S. van Smaalen, A. Kohler and M. Thelakkat, Phys. Chem. Chem. Phys., 2018, 20, 605–614 RSC .
M. Lorenzon, L. Sortino, Q. Akkerman, S. Accornero, J. Pedrini, M. Prato, V. Pinchetti, F. Meinardi, L. Manna and S. Brovelli, Nano Lett., 2017, 17, 3844–3853 CrossRef CAS PubMed .
S. G. Motti, M. Gandini, A. J. Barker, J. M. Ball, A. R. Srimath Kandada and A. Petrozza, ACS Energy Lett., 2016, 1, 726–730 CrossRef CAS .
Y. Tian, M. Peter, E. Unger, M. Abdellah, K. Zheng, T. Pullerits, A. Yartsev, V. Sundstrom and I. G. Scheblykin, Phys. Chem. Chem. Phys., 2015, 17, 24978–24987 RSC .
S. van Reenen, M. Kemerink and H. J. Snaith, J. Phys. Chem. Lett., 2015, 6, 3808–3814 CrossRef CAS PubMed .
B. Wu, K. Fu, N. Yantara, G. Xing, S. Sun, T. C. Sum and N. Mathews, Adv. Energy Mater., 2015, 5, 1500829 CrossRef .
H. Yu, H. Lu, F. Xie, S. Zhou and N. Zhao, Adv. Funct. Mater., 2016, 26, 1411–1419 CrossRef CAS .
J.-W. Lee, S.-G. Kim, S.-H. Bae, D.-K. Lee, O. Lin, Y. Yang and N.-G. Park, Nano Lett., 2017, 17, 4270–4276 CrossRef CAS PubMed .
F. Cai, L. Yang, Y. Yan, J. Zhang, F. Qin, D. Liu, Y.-B. Cheng, Y. Zhou and T. Wang, J. Mater. Chem. A, 2017, 5, 9402–9411 RSC .
W. Tress, N. Marinova, T. Moehl, S. M. Zakeeruddin, M. K. Nazeeruddin and M. Gratzel, Energy Environ. Sci., 2015, 8, 995–1004 RSC .
B. Chen, M. Yang, S. Priya and K. Zhu, J. Phys. Chem. Lett., 2016, 7, 905–917 CrossRef CAS PubMed .
T. J. Jacobsson, J.-P. Correa-Baena, E. Halvani Anaraki, B. Philippe, S. D. Stranks, M. E. F. Bouduban, W. Tress, K. Schenk, J. Teuscher, J.-E. Moser, H. Rensmo and A. Hagfeldt, J. Am. Chem. Soc., 2016, 138, 10331–10343 CrossRef CAS PubMed .
Z. Xiao and Y. Yan, Adv. Energy Mater., 2017, 7, 1701136 CrossRef .
M. L. Agiorgousis, Y.-Y. Sun, H. Zeng and S. Zhang, J. Am. Chem. Soc., 2014, 136, 14570–14575 CrossRef CAS PubMed .
W. Shan and W. A. Saidi, J. Phys. Chem. Lett., 2017, 8, 5935–5942 CrossRef CAS PubMed .
R. Dong, Y. Fang, J. Chae, J. Dai, Z. Xiao, Q. Dong, Y. Yuan, A. Centrone, X. C. Zeng and J. Huang, Adv. Mater., 2015, 27, 1912–1918 CrossRef CAS PubMed .
J.-H. Yang, W.-J. Yin, J.-S. Park and S.-H. Wei, J. Mater. Chem. A, 2016, 4, 13105–13112 RSC .
W. W. Wang, J. S. Dang, R. Jono, H. Segawa and M. Sugimoto, Chem. Sci., 2018, 9, 3341–3353 RSC .
M.-H. Du, J. Phys. Chem. Lett., 2015, 6, 1461–1466 CrossRef CAS PubMed .
L.-y. Wei, W. Ma, C. Lian and S. Meng, J. Phys. Chem. C, 2017, 121, 5905–5913 CrossRef CAS .
W. Ming, S. Chen and M.-H. Du, J. Mater. Chem. A, 2016, 4, 16975–16981 RSC .
D. A. Egger, L. Kronik and A. M. Rappe, Angew. Chem., Int. Ed., 2015, 54, 12437–12441 CrossRef CAS PubMed .
Y. Liu, K. Palotas, X. Yuan, T. Hou, H. Lin, Y. Li and S.-T. Lee, ACS Nano, 2017, 11, 2060–2065 CrossRef CAS PubMed .
H. Uratani and K. Yamashita, J. Phys. Chem. Lett., 2017, 8, 742–746 CrossRef CAS PubMed .
D. Meggiolaro, S. G. Motti, E. Mosconi, A. J. Barker, J. Ball, C. Andrea Riccardo Perini, F. Deschler, A. Petrozza and F. De Angelis, Energy Environ. Sci., 2018, 11, 702–713 RSC .
G. Nan, X. Zhang, M. Abdi-Jalebi, Z. Andaji-Garmaroudi, S. D. Stranks, G. Lu and D. Beljonne, Adv. Energy Mater., 2018, 8, 1702754 CrossRef .
H. Yuan, E. Debroye, G. Caliandro, K. P. F. Janssen, J. van Loon, C. E. A. Kirschhock, J. A. Martens, J. Hofkens and M. B. J. Roeffaers, ACS Omega, 2016, 1, 148–159 CrossRef CAS PubMed .
S. T. Birkhold, E. Zimmermann, T. Kollek, D. Wurmbrand, S. Polarz and L. Schmidt-Mende, Adv. Funct. Mater., 2017, 27, 1604995 CrossRef .
Y. Ren, I. W. H. Oswald, X. Wang, G. T. McCandless and J. Y. Chan, Cryst. Growth Des., 2016, 16, 2945–2951 CrossRef CAS .
E. Mosconi, E. Ronca and F. De Angelis, J. Phys. Chem. Lett., 2014, 5, 2619–2625 CrossRef CAS PubMed .
M. Saliba, S. Orlandi, T. Matsui, S. Aghazada, M. Cavazzini, J.-P. Correa-Baena, P. Gao, R. Scopelliti, E. Mosconi, K.-H. Dahmen, F. De Angelis, A. Abate, A. Hagfeldt, G. Pozzi, M. Graetzel and M. K. Nazeeruddin, Nat. Energy, 2016, 1, 15017 CrossRef CAS .
L. Zhang and P. H. L. Sit, J. Mater. Chem. A, 2017, 5, 9042–9049 RSC .
L. Zhang and P. H. L. Sit, J. Mater. Chem. A, 2017, 5, 23976–23986 RSC .
P. Hohenberg and W. Kohn, Phys. Rev., 1964, 136, B864–B871 CrossRef .
W. Kohn and L. J. Sham, Phys. Rev., 1965, 140, A1133–A1138 CrossRef .
P. Giannozzi, S. Baroni, N. Bonini, M. Calandra, R. Car, C. Cavazzoni, D. Ceresoli, G. L. Chiarotti, M. Cococcioni and I. Dabo, 
            et al.
          , J. Phys.: Condens. Matter, 2009, 21, 395502 CrossRef PubMed .
J. P. Perdew, K. Burke and M. Ernzerhof, Phys. Rev. Lett., 1996, 77, 3865–3868 CrossRef CAS PubMed .
D. Vanderbilt, Phys. Rev. B: Condens. Matter Mater. Phys., 1990, 41, 7892–7895 CrossRef .
S. Grimme, J. Comput. Chem., 2006, 27, 1787–1799 CrossRef CAS PubMed .
V. Barone, M. Casarin, D. Forrer, M. Pavone, M. Sambi and A. Vittadini, J. Comput. Chem., 2009, 30, 934–939 CrossRef CAS PubMed .
G. Henkelman and H. Jónsson, J. Chem. Phys., 2000, 113, 9978–9985 CrossRef CAS .
N. Marzari and D. Vanderbilt, Phys. Rev. B: Condens. Matter Mater. Phys., 1997, 56, 12847 CrossRef CAS .
I. Souza, N. Marzari and D. Vanderbilt, Phys. Rev. B: Condens. Matter Mater. Phys., 2001, 65, 035109 CrossRef .
P. H. L. Sit, F. Zipoli, J. Chen, R. Car, M. H. Cohen and A. Selloni, Chem.–Eur. J., 2011, 17, 12136–12143 CrossRef CAS PubMed .
J. Chen and P. H. L. Sit, Catal. Today, 2018, 314, 179–186 CrossRef CAS .
A. A. Mostofi, J. R. Yates, Y.-S. Lee, I. Souza, D. Vanderbilt and N. Marzari, Comput. Phys. Commun., 2008, 178, 685–699 CrossRef CAS .
J. Heyd, G. E. Scuseria and M. Ernzerhof, J. Chem. Phys., 2003, 118, 8207–8215 CrossRef CAS .
J. Gebhardt and A. M. Rappe, J. Mater. Chem. A, 2018, 6, 14560–14565 RSC .
D. Meggiolaro, E. Mosconi and F. De Angelis, ACS Energy Lett., 2017, 2, 2794–2798 CrossRef CAS .
T. Baikie, Y. Fang, J. M. Kadro, M. Schreyer, F. Wei, S. G. Mhaisalkar, M. Graetzel and T. J. White, J. Mater. Chem. A, 2013, 1, 5628–5641 RSC .
J. Schoonman, Chem. Phys. Lett., 2015, 619, 193–195 CrossRef CAS .
X. Tang, M. Brandl, B. May, I. Levchuk, Y. Hou, M. Richter, H. Chen, S. Chen, S. Kahmann, A. Osvet, F. Maier, H.-P. Steinruck, R. Hock, G. J. Matt and C. J. Brabec, J. Mater. Chem. A, 2016, 4, 15896–15903 RSC .
S. Meloni, T. Moehl, W. Tress, M. Franckevičius, M. Saliba, Y. H. Lee, P. Gao, M. K. Nazeeruddin, S. M. Zakeeruddin, U. Rothlisberger and M. Graetzel, Nat. Commun., 2016, 7, 10334 CrossRef CAS PubMed .
C. Eames, J. M. Frost, P. R. F. Barnes, B. C. O'Regan, A. Walsh and M. S. Islam, Nat. Commun., 2015, 6, 7497 CrossRef CAS PubMed .
J. M. Azpiroz, E. Mosconi, J. Bisquert and F. De Angelis, Energy Environ. Sci., 2015, 8, 2118–2127 RSC .
C.-J. Tong, W. Geng, O. V. Prezhdo and L.-M. Liu, ACS Energy Lett., 2017, 2, 1997–2004 CrossRef CAS .
J. Haruyama, K. Sodeyama, L. Han and Y. Tateyama, J. Am. Chem. Soc., 2015, 137, 10048–10051 CrossRef CAS PubMed .
S. Ham, Y. J. Choi, J.-W. Lee, N.-G. Park and D. Kim, J. Phys. Chem. C, 2017, 121, 3143–3148 CrossRef CAS .
J. Yang, B. D. Siempelkamp, E. Mosconi, F. De Angelis and T. L. Kelly, Chem. Mater., 2015, 27, 4229–4236 CrossRef CAS .
L. Zhang and P. H. L. Sit, J. Phys. Chem. C, 2015, 119, 22370–22378 CrossRef CAS .
Q. Sun, P. Fassl, D. Becker-Koch, A. Bausch, B. Rivkin, S. Bai, P. E. Hopkinson, H. J. Snaith and Y. Vaynzof, Adv. Energy Mater., 2017, 7, 1700977 CrossRef .
M. Pazoki, T. J. Jacobsson, S. H. T. Cruz, M. B. Johansson, R. Imani, J. Kullgren, A. Hagfeldt, E. M. J. Johansson, T. Edvinsson and G. Boschloo, J. Phys. Chem. C, 2017, 121, 26180–26187 CrossRef .
W. Bo, F. Kunwu, Y. Natalia, X. Guichuan, S. Shuangyong, S. T. Chien and M. Nripan, Adv. Energy Mater., 2015, 5, 1500829 CrossRef .
J. H. Heo, M. S. You, M. H. Chang, W. Yin, T. K. Ahn, S.-J. Lee, S.-J. Sung, D. H. Kim and S. H. Im, Nano Energy, 2015, 15, 530–539 CrossRef CAS .

Footnote† Electronic supplementary information (ESI) available. See DOI: 10.1039/c8ta09512dThis journal is © The Royal Society of Chemistry 2019
Table Content:

 	Fig. 1  (a) & (b) Top view and side view of the relaxed MAI-terminated MAPbI3 (110) surface, respectively. M1 and M2 (orange spheres) in the MAI-terminated surface are the selected iodine atoms to create the iodine vacancies. (c) & (d) Top view and side view of the relaxed PbI2-terminated MAPbI3 (110) surface, respectively. P1 and P2 (orange spheres) in the PbI2-terminated surface are the selected iodine atoms to create the iodine vacancies.	 

 	Fig. 2  (a) & (b) The relaxed structure with a VI+ vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (c) & (d) The relaxed structure with a VI0 vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (e) & (f) The relaxed structure with a VI− vacancy initially at the M1 and the M2 position, respectively, in the MAI-terminated surface. (g) & (h) The total density of states for the structure in (c and f), respectively, with the Fermi level set at 0 eV. The red arrow in (h) indicates the intragap trapped state. (i) The energy profile for the iodine migration from the structure in (e) to the structure in (f). The side views of the structures in this figure are shown in Fig. SI5 in the ESI.† The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1.	 

 	Fig. 3  (a) & (b) The relaxed structure with a VI+ vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (c) & (d) The relaxed structure with a VI0 vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (e) & (f) The relaxed structure with a VI− vacancy initially at the P1 and the P2 position, respectively, in the PbI2-terminated surface. (g) & (h) The total density of states for the structure in (d and f), respectively, with the Fermi level set at 0 eV. The red arrow indicates the intragap state. (i) The energy profile for iodine migration from the structure in (c) to the structure in (d), and from the structure in (e) to the structure in (f). The side views of the structures in this figure are shown in Fig. SI7 in the ESI.† The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1.	 



V
I
+
	−37.0	N	−16.1	N	−64.9	N	—	—

V
I
0
	−34.4	N	−49.5	N	−106.7	N	—	—

V
I
−
	−33.7	N	−90.8	Y	−106.8	Y	−102.0	N

 	Fig. 4  (a) & (b) The adsorption of an O2 and an OH on the structure in Fig. 2a, respectively. (c) & (d) The adsorption of an O2 and an OH on the structure in Fig. 2c, respectively. (e) & (g) The adsorption of an O2 and an OH on the structure in Fig. 2f, respectively. (f) & (h) The final state of the structure in (e) and (g) after ion migration, respectively. (i) The adsorption with the second OH on the structure in (h). (j) The energy profile for the above two migration processes. The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1.	 



V
I
+
	−17.5	N	−16.9	N	−41.0	N	—	—

V
I
0
	−17.6	N	−44.0	Y	−76.5	Y	—	—

V
I
−
	−17.0	N	−62.6	Y	−72.1	N	−78.3	Y

 	Fig. 5  (a) & (b) The adsorption of an O2 and an OH on the structure in Fig. 3a, respectively. (c) & (d) The adsorption of an O2 and an OH on the structure in Fig. 3d, respectively. (f) & (g) The adsorption of an O2 and OH on the structure in Fig. 3f, respectively. (h) The adsorption with the second OH on the structure in (g). (e) & (i) The final state of the structure in (d) and (h) during ion migration, respectively. (j) The energy profiles for the above two migration processes. The Pb ions originally bonded to the removed iodide are marked as green spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1.	 

 	Fig. 6  (a) & (b) The relaxed B1 and B2 structures with one excess electron, respectively. (c) & (d) The relaxed B1 and B2 structures with two excess electrons, respectively. (e) & (f) The relaxed B2 and B1 structures without excess electrons, respectively. (g) The energy profiles for the three migration processes. The red arrows in (a), (c) and (e) denote the directions of the iodine diffusion. (h) The thermodynamic ionization levels for the B2 structure. The Pb ions bonded to the removed iodide are marked as dark cyan spheres. The spin densities are shown as the yellow contour surfaces. The color codes for the other atoms are the same as those in Fig. 1.	 
Footnote
† Electronic supplementary information (ESI) available. See DOI: 10.1039/c8ta09512d

This journal is © The Royal Society of Chemistry 2019
