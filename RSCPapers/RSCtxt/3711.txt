Application of an inverse-design method to optimizing porphyrins in dye-sensitized solar cells   - Physical Chemistry Chemical Physics (RSC Publishing) DOI:10.1039/C8CP07722C View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/C8CP07722C
(Paper)
Phys. Chem. Chem. Phys., 2019, 21, 5834-5844Application of an inverse-design method to optimizing porphyrins in dye-sensitized solar cells†

        
          
            Chencheng 
            Fan
          
        
      *a, 
      
        
          
            Michael 
            Springborg
          
        
      ab and 

        
          
            Yaqing 
            Feng
          
        
      cde
aPhysical and Theoretical Chemistry, University of Saarland, 66123 Saarbruecken, Germany. E-mail: chencheng.fan@uni-saarland.de; m.springborg@mx.unisaarland.de
bMaterials Science, Tianjin University, 300350 Tianjin, China
cSchool of Chemical Engineering and Technology, Tianjin University, 300350 Tianjin, China. E-mail: yqfeng@tju.edu.cn
dCollaborative Innovation Center of Chemical Science and Engineering (Tianjin), 300072 Tianjin, China
eTianjin Engineering Research Center of Functional Fine Chemicals, China
Received 
      18th December 2018
    , Accepted 16th February 2019First published on 19th February 2019AbstractDye-sensitized solar cells (DSSCs) have attracted much interest during the past few decades. However, it is still a tremendous challenge to identify organic molecules that give an optimal power conversion efficiency (PCE). Here, we apply our recently developed, inverse-design method for this issue with the special aim of identifying porphyrins with promisingly high PCE. It turns out that the calculations lead to the prediction of 15 new molecules with optimal performances and for which none so far has been studied. These porphyrin derivatives will in the near future be synthesized and subsequently tested experimentally. Our inverse-design approach, PooMa, is based on the strategy of providing suggestions for molecular systems with optimal properties. PooMa has been developed as a tool that requires minimal resources and, therefore, builds on various approximate methods. It uses genetic algorithm to screen thousands (or often more) of molecules. For each molecule, the density-functional tight-binding (DFTB) method is used for calculating the electronic properties. In the present work, five different electronic properties are determined, all of which are related to optical performance. Subsequently, a quantitative structure–property relationship (QSPR) model is constructed that can predict the PCE through those five electronic properties. Finally, we benchmark our results through more accurate DFT calculations that give further information on the predicted optimal molecules.
1 Introduction
The identification of materials for renewable-energy applications has become one of the most imperative issues within the global-energy strategy. Compared with silicon photovoltaic cells, dye-sensitized solar cells (DSSCs) exhibit advantages including ease of fabrication, low production costs, and compatibility with flexible substrates.
The performance of DSSCs can be quantified through various photovoltaic parameters such as the overall power conversion efficiency (PCE), the photo-current density measured at short-circuit (Jsc), the open circuit voltage (Voc), the fill factor (FF), and the intensity of the incident light (Pin). Specifically, the PCE gives the overall performance of the solar cell (eqn (1)). (1)
Considering the working principles of DSSC (Fig. 1), when illuminated with light, the electrons in the ground state of the dye are excited to higher-energy excited states. Subsequently, the excited electrons are injected into the conduction band of a semiconductor (in most cases, TiO2) and the oxidized dye sensitizers are regenerated by taking electrons from the redox couple in the electrolyte. Therefore, as a key component in DSSCs, the dyes play an important role in determining the corresponding cell performance and should fulfill various essential characteristics:1
 Fig. 1  The mechanism of a DSSC.2 
1. The dye should have a good absorption of solar light.
2. The dye should have at least one anchoring group (COOH, PO3H2, etc.) to bind strongly the dye to the semiconductor surface.
3. The energy of the LUMO of the dye should be higher than the conduction band edge of the semiconductor (which in the present work will be TiO2) so that electrons can be transferred efficiently from the excited dye to the conduction band of TiO2. Moreover, the energy of the HOMO of the dye should be lower than the energy level of the electrolyte for the dye regeneration.
4. Unfavorable dye aggregation on the semiconductor surface should be avoided through optimization of the molecular structure of the dye or by addition of coadsorbers that prevent aggregation. However, controlled dye aggregates (J-aggregates) can lead to an improved performance compared with a monomer dye layer.
5. The dye should be photostable, thermally stable, and electrochemically stable.
However, there are many other factors that also influence the performance of a DSSC making it difficult to optimize the system. For example,1 it may be beneficial for the performance of the DSSC to slow down the electron injection by increasing the energy at the conduction band edge (Ec). On the one hand, this should lead to an increase in Voc, but, on the other hand, this will simultaneously lead to a decrease in the driving force for electron injection, which may result in a decrease in Jsc. Accordingly, the performance of a DSSC may be quantified through the product of current and voltage, which will represent a compromise between these two effects.
Another example1 is that, generally, it seems to be favorable to have a larger spatial separation of HOMO and LUMO orbitals because this can imply an increased electron-density in those parts of the molecules that are close to the anchor group and to the TiO2 substrate, while simultaneously decreasing the electron-density in those part of the molecules that are closest to the electrolyte. However, it should be noted that such a design will lead to a dye with a high reorganization energy, which will influence the performance negatively.
Therefore, considering the complexity of the DSSCs, it is still a big challenge to improve the solar cell efficiency so much that they can meet the standards of the photovoltaic cells market.
In 2014, Michael Grätzel and his co-workers studied the porphyrin named SM315 within the concept of DSSCs and obtained a PCE of 13%, which is the current record for DSSCs.3 Actually, among the organic-based dyes, porphyrins have always attracted much attention because they have a natural role in light harvesting, notably in the wavelength range of 400–700 nm.4 Moreover, different substituents can be easily attached to the core of porphyrin, which offers plenty of possibilities for molecular design. During the last decades, many novel porphyrins have been designed and applied in DSSCs. Most often, one considers porphyrins with a donor–π bridge–acceptor (D–π–A) framework, together with its variations, such as D–A–π–A, D–π–A–π–D, A–π–D–π–A, etc.5 The D–π–A structure is beneficial for an efficient intra-molecular charge transfer (ICT) from donor to acceptor and is helpful for the electron injection into the conduction band of TiO2.5
In addition, many studies have focused on theoretical calculations with the aim of analysing the electronic structures and properties of porphyrins in DSSCs, and thereby providing a deeper understanding of the DSSCs that can lead to a more rational design of dyes. Thus, Giribabu and co-workers found that the zinc porphyrins give a better performance in comparison with the corresponding free-base porphyrins.6 Nazeeruddin and co-workers found that porphyrins with Zn are better than porphyrins containing Cu. Porphyrins with a phosphonate anchoring group showed lower efficiencies than those with a carboxylate anchoring group.7 Kim and co-workers found that charge-separation is one of the main factors that govern the solar cell efficiency.8 The role of para-alkyl substitutes on meso-phenylporphyrin-sensitized solar cells was studied by Ballester and co-workers, who reported that the presence of hydrophobic alkyl chains in the molecular structures of porphyrins can decrease the charge recombination between the injected electrons and the electrolyte.9
However, it has been estimated that the maximum achievable theoretical PCE amounts to 32% for DSSCs,10 implying that the current record of 13% can be improved significantly. The common approach of arriving at an improvement is, based on personal experience and ideas, to design and synthesize novel dyes. Subsequently, these are assembled and their cell performance is checked. In parallel, theoretical calculations may be carried through with the aim of studying their electronic structures and electronic properties. This “trial and error” approach is very time-consuming, expensive, and inefficient when aiming at finding breakthrough dyes for DSSCs. There is an increasing trend towards using computational methods to rationalize the design of new dyes,11,12 in particular using quantitative structure–property relationship (QSPR) models. Some of those approaches are based on machine learning or data mining tools. Our study is related to that of Venkatraman et al.11 who used genetic algorithm to optimize coumarin dyes for dye-sensitized solar cells. However, many details of our computational approach as well in the class of molecular systems and properties that we are considering differ from those of Venkatraman et al.
In the present work, we take known findings about DSSCs into consideration and adapt our inverse design method “PooMa”13,14 to the DSSCs with the purpose of identifying—eventually new—porphyrins with promisingly large values for the PCE. PooMa combines a stoichiometry-optimization approach based on genetic algorithms, an automatic approach for constructing molecules, an inexpensive but sufficiently accurate approach for calculating the relevant electronic properties of DSSCs, and a mathematical formulation of the performance function whose value shall be optimized. In the present study, the PooMa calculations lead to the prediction of 15 molecules with optimal values for the PCE, all of which has not been studied earlier. Subsequently, these modified porphyrins are studied through standard DFT and TD-DFT methods. Moreover, it is planned that they will be synthesized in the near future.
It is clearly a strong simplification to attempt to describe the performance of the DSSCs using solely properties of the individual, isolated dyes. A more accurate description could have been obtained by including, for instance, the interfacial properties of dyes absorbed on a TiO2 film (such as adsorption configurations, adsorption energy, charge transfer at the TiO2–dye interface),15,16 the Fermi energy of TiO2,17 charge recombination at TiO2–electrolyte interface18etc. However, the rationale behind PooMa is not to provide exact results and to identify uniquely the best possible systems, but rather to provide interesting suggestions for useful systems by exploring a larger part of chemical space than what usually is done. Moreover, PooMa is based on being computationally efficient which would be partly in conflict with attempts to try to include larger parts of the DSSCs in the modelling. With these limitations in mind, we are convinced that PooMa is an interesting alternative to the try-and-error approaches often used as well as to the computationally much more costly big-data approaches.
2 PooMa: the inverse design approach
2.1 The genetic algorithm and construction of molecules
The main idea of our approach is to identify functional groups and their positions at a given backbone. Since α substituted zinc-porphyrins are known to show good performance,19 we use the zinc-porphyrin as the backbone and the four α sites as the sites for functional groups (see Fig. 2). In view of the feasibility of synthesis, H atoms are kept at the eight β positions.
 Fig. 2  Zinc-porphyrin as backbone and the four α sites as available sites for functional groups. 
Currently in the pool of possible functional groups, we have collected 41 functional groups (see Fig. S1 in the ESI†). All of these are extracted from published dye sensitizers. Moreover, the groups 1–17 are “anchor types” containing the carboxyl group COOH, while groups 18–41 are “donor types”. Since the porphyrins should have at least one anchor group for the transfer of electrons from the dye to the electrode, we require that the α1 site has to be occupied by an anchor group. For the other sites, any functional group can be attached.
The core of our inverse design approach is a genetic algorithm (GA) that is constructed to optimize the solar cell performance among thousands of molecules with different functional groups. More details can be found in our earlier work.13,14 Therefore, here we give just a short description, referring to Fig. 3. Our genetic algorithm consists of the following steps:
 Fig. 3  Flowchart of the genetic algorithm. 
1. Create randomly 20 porphyrins, which differ in the arrangement of the functional groups and which all are different also after applying symmetry operations.
2. Relax their structures locally and calculate their values for the performance function that shall be optimized.
3. Separate the molecules (“Parent molecules”) randomly into 10 pairs.
4. For each pair, interchange a (randomly generated) part of the functional groups through a crossover operation to create new “Children molecules”. The children may experience mutations whereby some functional group on one site is replaced randomly with another functional group, except on α1 site at which the replacement can only be through an anchor type. It is verified that all the children and parent molecules are different also after applying symmetry operations.
5. Relax the structures of the children molecules and calculate their values for the performance function.
6. Out of the 20 “Parent molecules” and 20 “Children molecules”, choose those 20 molecules with the best performance function as parents for the next generation.
7. If the 20 best molecules are unchanged for 10 generations, stop the calculation, otherwise return to step 3.
2.2 DFTB method
In our recently developed PooMa (POOr MAn's MAterials optimization) approach we have made a compromise between accuracy and computational speed. Thus, calculations based on density functional theory (DFT) can give comparatively accurate results at a relatively expensive cost but since our approach is based on studying the electronic structure of maybe even tens of thousands of molecules, DFT-based methods become too expensive for our aim.
Instead, we use the non-self-consistent-charge density-functional tight-binding (non-SCC DFTB) method by Seifert and co-workers.20 Thereby, the computational efforts can be reduced drastically while simultaneously maintaining a reasonable accuracy. With this method, the total energy relative to that of the non-interacting atoms is given as (2)where εi is the energy of the ith occupied orbital for the system of interest and εjm is that of the mth occupied orbital for the isolated jth atom. Ujk is a short-ranged pair potential between atoms j and k. Non-SCC implies that we do not take charge fluctuations and the resulting interactions into account. The Ujk is so adjusted that experimental data or results of ab initio calculations for certain test systems are accurately reproduced. Valence electrons are treated explicitly in the DFTB formalism, whereas the effects of the core electrons are included within a frozen-core approximation.
The orbital energies εi are obtained from the single-particle Kohn–Sham equations (3)whereby the potential V() is approximated as the superposition of potentials of the isolated atoms, (4)with m being the position of the mth nucleus. Moreover, ψi() is approximated through a linear combination of atom-centered functions, (5)with χ,j() being the jth function centered at the atom at position . Within the DFTB approach it is furthermore assumed that all matrix elements 〈χ1,j1|ĥeff|χ2,j2〉 can be obtained from calculations on diatomic molecules.
2.3 Performance function and property descriptors
Since the PCE quantifies the overall performance of the solar cell, we shall let PCE be the performance function whose value shall be optimized when identifying the best molecules. Even though the factors that affect the PCE are quite complicated and difficult to access with electronic-properties calculations, the electronic properties of a sensitizer are very important for the overall performance of a DSSC. Thus, we choose the followings five electronic property descriptors whose values subsequently shall be used to predict the PCE:
1. The energy gap G between the highest occupied molecular orbital (HOMO) and the lowest unoccupied molecular orbital (LUMO). G = εLUMO − εHOMO(6)
2. We define the sun absorption per valence electron A through eqn (7), whereby Ne is the number of valence electrons of the dye, i denotes an occupied orbital and a denotes an unoccupied orbital. fia is the oscillator strength for single electron excitation from the ith orbital to the ath orbital. The spectral function P(εa − εi) for the solar spectrum is calculated using a black-body approximation as given in eqn (8). (7) (8)The oscillator strength fia is calculated using the approximated TD-DFTB (time-dependent density-functional tight-binding) method.21 Since we only consider one-electron excitations and do not take charge fluctuations into account, the expression for fia can be simplified as given below in eqn (9), whereby the transition dipole moment ia is approximated in terms of Mulliken transition charges qn,ia and the corresponding coordinates n of the atom n for transition i → a. (9)
3. Light-harvesting efficiency per valence electron, LHE. All electronic transitions are taken into account for excitations in the UV-Vis range. (10)
4. Average orbital overlap per valence electron Oav (eqn (11)), that takes into account all single overlaps for each pair of occupied and unoccupied molecular orbitals with a weight factor according to its transition probability fiaP(εa − εi). The individual overlap Oia (eqn (12)) is calculated using Mulliken gross populations qn,i and qn,a. (11) (12)
5. Average orbital distance per valence electron Dav (eqn (13)), similar to Oav, that takes into account all the single-orbital distances with a weight fiaP(εa − εi). Also here, the single orbital distance Dia (eqn (14)) is calculated using Mulliken gross populations. (13) (14)
In several cases we are studying properties per valence electron. The reason is that our goal is to optimize intensive properties and not extensive properties in order to avoid that the largest molecules are found to be the best ones.
2.4 DFT calculations
Additional DFT and TD-DFT calculations are used to have a further theoretical understanding of the porphyrin molecules that result from the PooMa calculations.
The ground state geometry optimization of all molecules are carried through using the B3LYP functional with a 6-311G(d,p) basis set. Keeping the geometries that are obtained through those calculations, we studied the excited states using the CAM-B3LYP functional with a 6-311G(d,p) basis set. The conductor-like polarizable continuum model (C-PCM) is used to simulate the environment of tetrahydrofuran (THF). All DFT and TD-DFT calculations are performed using the Gaussian09 software package.22 Subsequently, the Fukui functions, condensed Fukui functions, and charge transfer indices are calculated using the Multiwfn software package.23
2.5 Fukui function
The Fukui function is important within conceptual density functional theory and is defined as23 (15)where N is the number of electrons in the system of interest and V is the external potential. Using a finite-difference approximation, the Fukui function can be calculated unambiguously for three situations:
Nucleophilic attack: (16)Electrophilic attack: (17)Radical attack: (18)
When a molecule accepts electrons, the additional electrons tend to go to those parts of space where f+() is large because this is where the molecule is most stable against the addition of electrons. Therefore, a molecule is susceptible to nucleophilic attack at places where f+() is large. Similarly, a molecule is susceptible to electrophilic attack at sites where f−() is large, because these are the regions where an electron removal destabilizes the molecule the least.
Furthermore, the “condensed” version of the Fukui function based on atomic charges can be helpful in providing a more quantitative description. For an atom A, the condensed Fukui function is defined as23
Nucleophilic attack: f+A = qAN − qAN+1(19)Electrophilic attack: f−A = qAN−1 − qAN(20)Radical attack: f0A = (qAN−1 − qAN+1)/2(21)Here, qA is the atomic charge according to a Hirshfeld population analysis.
2.6 Charge transfer indices
Le Bahers24 proposed a method for analyzing the charge-transfer (CT) during an electronic transition. The electron density variation between the excited state (EX) and the ground state (GS) is defined as Δρ(r) = ρEX(r) − ρGS(r)(22)The geometry of the excited state and the ground state must be identical. Δρ(r) can be separated into positive and negative parts, namely ρ+(r) and ρ−(r). The transferred charge qCT is the magnitude of the integral of ρ+(r) and ρ−(r) over the whole space. The barycenters of the positive and negative parts can be defined as (23) (24)The spatial distance between the two barycenters of density distributions can subsequently be used to quantify the CT excitation length DCT, DCT = |R+ − R−|.(25)From this, a dipole moment relating the ground and the excited states (μCT) can be defined as μCT = DCT·qCT(26)
3 The QSPR model
Quantitative structure–property relationship (QSPR) models aim to establish a mathematical relation between one set of descriptors characterizing the system and a property of interest. Here, we will construct a QSPR model that uses the five electronic properties as descriptors to predict the PCE.
3.1 Data set
In total, 206 dye-sensitizers including porphyrins and some small molecules, compiled from the literature, were chosen as forming the data set (see Table S1 in ESI†) from which the QSPR model should be derived. Ideally all values should result from a single source, for example from the same laboratory, but such a data set would be very limited in size. To obtain data that are reasonably comparable despite being from different sources, we have chosen data that satisfy:
1. The electrolyte is iodine based.
2. The semiconductor is TiO2.
3. No polymer sensitizer.
4. Only one dye sensitizer is used without co-adsorbent or co-sensitizer.
5. The global standard AM 1.5G light source with a light intensity of 100 mW cm−2 is used.
Although other experimental parameters (like semiconductor thickness, cell fabrication, the amount of dyes absorbed on TiO2, exposure time) can influence the performance, further constraints based on these factors would reduce the size of the data set too much and were therefore ignored.
In order to obtain and validate a reliable QSPR model, we split the whole data set into a training set, a validation set, and a test set (Fig. 4). Specifically, at first we randomly select 10% of the data as constituting the test set. The remaining data is sorted according to ascending order of the PCE. Every 10th data (such as the 10th, 20th, 30th, etc.) are selected as forming the validation set while the other ones constitute the training set. We use the training set in constructing the QSPR model. Subsequently, we examine its performance using the validation set. Finally, we examine the model with further randomly constructed test sets.
 Fig. 4  The whole data set is split into training set, validation set, and test set. 
3.2 Correlation coefficients
The correlation coefficient between two variables X and Y is defined as given in eqn (27). Here, cov is the covariance, σX and σY are the standard deviations, E is the expectation value, and μX and μY are the mean values of X and Y. (27)
With the help of the correlation coefficient only linear relationships between the two variables X and Y can be identified. Moreover, −1 ≤ corr(X,Y) ≤ 1. When corr(X,Y) approaches 0, X and Y possess no linear relationship. As corr(X,Y) approaches ±1, the variables possess an increased linear relationship. The correlation coefficient is symmetric, corr(X,Y) = corr(Y,X).
According to Cohen's standard we have that, if the correlation coefficient lies between the 0.1 and 0.29, the two variables have a small linear dependence; if the correlation coefficient is between 0.3 and 0.49, the two variables have a medium linear dependence; and if the correlation coefficient is larger than 0.5, the two variables have a large linear dependence. We shall use these criteria in evaluating the interdependence of our variables.
3.3 Model evaluation
The quality of a model can be quantified through the coefficient R2 given below in eqn (28). Here, N is the number of data in the training set, PCEobsi is the observed/experimental PCE value for the ith sample, and PCEcali is the calculated PCE value for this system. PCEobsmean is the arithmetic mean of the observed PCE values in the training set. (28)For the ideal model, R2 equals 1. As the value of R2 deviates from 1, the quality of the model is reduced. Then, one possible approach for improving the model could be to increase the number of descriptors with, however, the accompanying risk that the QSPR model becomes overdetermined.
The predictive power of the model is evaluated by the predictive squared correlation coefficient (Q2), the mean absolute error (MAE), and the root of mean square error (RMSE) of the validation set and test set. Q2 is given in eqn (29), where N is the number of samples in the validation set/test set, PCEpredi is the predicted PCE value of the ith sample, and PCEobsi is the observed/experimental value. PCEtrainmean is the arithmetic mean of the observed PCE values in the training set. (29)
The MAE and RMSE are given in eqn (30) and (31), where N is the number of samples in the training/validation/test set. (30) (31)
4 Results and discussion
4.1 Analysis of the descriptors
At first we verified that the descriptors take different values for different systems in order to assure that they indeed are able to distinguish between different samples. Table 1 shows that all the five descriptors have standard deviations that are comparable with the mean values, i.e., for each descriptor the data are sufficiently well scattered.
Table 1 Mean values and standard deviations of the electronic properties G, Oav, Dav, A, and LHE




Variables

G


O
av


D
av


A

LHE





μ

0.054
0.085
16.7
2.84
0.089



σ

0.013
0.031
10.4
0.75
0.020




Then we examined whether the descriptors are linearly dependent through their correlation coefficient. Table 2 shows that all the five descriptors are independent since the largest correlation coefficient equals 0.74 (between Oav and A). Therefore, the five electronic properties G, Oav, Dav, A, LHE can be used as independent variables in the QSPR model.
Table 2 The correlation coefficients between G, Oav, Dav, A, LHE, and PCE




Variables

G


O
av


D
av


A

LHE





O
av

0.47











D
av

−0.43
−0.41









A

0.23
0.74
0.10






LHE
−0.11
0.34
0.37
0.7








PCE
−0.21
−0.24
−0.08
−0.37
−0.29




In addition, from the results for the correlation coefficients between any of the electronic properties and PCE (see Table 2) we conclude that a QSPR model can only contain non-linear relationships: according to Cohen's standard, only A shows a medium linear relationship with PCE while the rest electronic properties show only small or no linear relationship.
4.2 The QSPR model
We adopted a non-linear mathematical function for our QSPR model (eqn (32)), where the PCE for the ith system is denoted Zi and the value for the jth of the five descriptors is denoted Xij. As can be seen, the expression consists of a constant plus terms that depend on one, two, three, four, or five descriptors. (32)whereby in each summation we include only terms involving different descriptors.
The fitting will result in the coefficients c and the powers p. In order to reduce the effects of numerical noise and to make the QSPR model more stable, terms in eqn (32) involving powers p smaller than 0.3 were removed. In addition, if it subsequently was found that two terms were strongly dependent (a value for corr larger than 0.9) one of the terms was deleted, too. Finally, if any term was found to be irrelevant for PCE (i.e., corr is smaller than 0.1) this term was also deleted.
At the end, the final expression of our QSPR model becomes (in Hartree atomic units): (33)
As shown in Fig. 5, the resulting predicted PCE values show the same trends as the experimental PCE values among the training set, the validation set, and the test set. Table 3 shows however also that the model is not perfect. We emphasize that a perfect model should not be expected because of various reasons. At first, all the comments at the end of Section 1 apply, i.e., reducing the performance of a DSSC to the properties of the single dye is a tremendous simplification when taking into account the complexity of the DSSCs. Moreover, there are significant experimental uncertainties (occasionally, even the same system studied experimentally by the same group at different times has resulted in different values for the PCE). Thus, for our purpose, we are convinced that the quality of our QSPR model is reasonable. Thus, when our QSPR is used in PooMa as performance function to identify good porphyrins, the absolute error between predicted PCE and experimental PCE is less important.
 Fig. 5  Predicted and experimental PCE values for training set, validation set, and test set. 
Table 3 Model validation: R2, Q2, MAE, and RMSE for training set, validation set and test set







R
2


Q
2

MAE
RMSE




Training set
0.23
—
1.63
1.98


Validation set
—
0.42
1.58
1.78


Test set
—
0.42
1.61
1.87




We add that when repeating the procedure of constructing the QSPR model through a different, randomly constructed training set, the mathematical expression changes only little, showing that our approach is numerically robust. Furthermore, when subsequently applying these slightly different mathematical functions in PooMa essentially the same porphyrins are found as being those performing the best.
4.3 DFT results
The PooMa calculations resulted in the 15 porphyrins that are shown in Fig. 6. These porphyrins are novel and have not been studied earlier. All the porphyrins share the same strong donor (iminostilbene). Moreover, some functional groups show up frequently. In addition, at least one of the COOH groups is used as anchor group, while in some cases additional groups that could also act as anchor groups occur although not necessarily acting as anchor groups.
 Fig. 6  The molecular structures identified by the PooMa calculations. 

Fig. 7 shows that the energy level alignments of all resulting porphyrins match the requirements for DSSCs, i.e., the energy of HOMO is lower than the potential of the electrolyte and the energy of LUMO is higher than the conduction band of TiO2.
 Fig. 7  The energies of the four frontier molecular orbitals (HOMO−1, HOMO, LUMO, LUMO+1) of the 15 substituted porphyrins as obtained in the DFT calculations. 

Fig. 8 shows the Fukui function. We remind that the electrons tend to flow from those regions where f− is large to those regions where f+ is large. For a more quantitative analysis we show the condensed Fukui function in Table 4. Thereby, we recognize two charge-flow patterns, i.e., a flow from the porphyrin ring to a functional group, a pattern that can be recognized for Porphyrin01–04, 06, 12–14, whereas the other porphyrins show a pattern with a flow from one functional group to the porphyrin ring and to another functional group.
 Fig. 8  The Fukui functions for the 15 substituted porphyrins. For each molecule, the upper part shows f− and the lower part shows f+. 
Table 4 Condensed Fukui function of Porphyrin01–15






Core
α1
α2
α3
α4



f
−


f
+


f
−


f
+


f
−


f
+


f
−


f
+


f
−


f
+





Porphyrin01
0.52
0.41
0.20
0.36
0.07
0.03
0.14
0.17
0.06
0.03


Porphyrin02
0.47
0.38
0.22
0.40
0.10
0.03
0.13
0.15
0.06
0.03


Porphyrin03
0.49
0.40
0.25
0.39
0.06
0.03
0.14
0.17
0.06
0.03


Porphyrin04
0.49
0.41
0.18
0.36
0.12
0.03
0.13
0.17
0.07
0.03


Porphyrin05
0.15
0.38
0.06
0.40
0.71
0.03
0.04
0.17
0.02
0.03


Porphyrin06
0.52
0.41
0.20
0.35
0.06
0.03
0.15
0.17
0.07
0.03


Porphyrin07
0.25
0.37
0.09
0.40
0.55
0.04
0.06
0.16
0.03
0.02


Porphyrin08
0.16
0.39
0.07
0.32
0.69
0.03
0.06
0.23
0.02
0.03


Porphyrin09
0.23
0.39
0.07
0.36
0.61
0.04
0.05
0.17
0.03
0.03


Porphyrin10
0.25
0.36
0.58
0.04
0.08
0.49
0.07
0.08
0.03
0.04


Porphyrin11
0.27
0.32
0.52
0.04
0.10
0.53
0.08
0.08
0.03
0.03


Porphyrin12
0.50
0.41
0.19
0.36
0.06
0.03
0.14
0.17
0.11
0.03


Porphyrin13
0.52
0.38
0.05
0.02
0.20
0.47
0.14
0.08
0.09
0.04


Porphyrin14
0.49
0.37
0.19
0.45
0.13
0.08
0.11
0.08
0.08
0.03


Porphyrin15
0.24
0.39
0.07
0.36
0.60
0.04
0.06
0.17
0.03
0.03





Table 6 shows the results of the TD-DFT calculations. For all 15 porphyrins, the maximum absorption is in the 380–500 nm range, which corresponds to the so-called Soret bands. All the 15 porphyrins show comparatively high oscillator strengths and light-harvest efficiencies (LHE). Moreover, the main contribution to the absorption peak is electronic transitions from the five energetically highest, occupied orbitals to the three energetically lowest, unoccupied ones.
Following Le Bahers' approach, we show in Table 5 the calculated charge transfer indices which only considered the first excited singlet state. In particular, Porphyrin11, Porphyrin10, Porphyrin9, and Porphyrin07 have large values for the intramolecular charge transfer for the first excited singlet state. However, other excited states can be critical too in intramolecular charge transfer, which will not be discussed further here.
Table 5 The charge transfer indicesaqCT, DCT, μCT of Porphyrin01–15







q
CT/a.u.

D
CT/Angstrom

μ
CT/Debye





a The excited state is the first singlet excited state.





Porphyrin01
0.61
0.05
0.16


Porphyrin02
0.64
0.06
0.18


Porphyrin03
0.67
0.05
0.16


Porphyrin04
0.59
0.06
0.17


Porphyrin05
0.72
0.18
0.61


Porphyrin06
0.58
0.09
0.25


Porphyrin07
0.75
0.45
1.59


Porphyrin08
0.76
0.08
0.30


Porphyrin09
0.68
0.55
1.82


Porphyrin10
0.72
0.61
2.11


Porphyrin11
0.79
0.58
2.21


Porphyrin12
0.61
0.09
0.27


Porphyrin13
0.58
0.19
0.54


Porphyrin14
0.59
0.24
0.68


Porphyrin15
0.61
0.05
0.16




Table 6 Oscillator strength, LHEa and excitation contribution (only above 10%) at the calculated absorption maximum using the TD-DFT method




Molecules

λ
absmax (nm)
Oscillator strength
LHE
Main configuration





a LHE corresponding to maximum oscillator strength. H represents HOMO, while L represents LUMO.





Porphyrin01
426
1.65
0.977
H → L+1 (57%)


H−1 → L (36%)


Porphyrin02
475
1.84
0.986
H−1 → L+1 (34%)


H → L+2 (25%)


H−3 → L (13%)


H → L (11%)


Porphyrin03
470
1.70
0.980
H−1 → L+1 (32%)


H → L+2 (33%)


H−3 → L (13%)


Porphyrin04
443
1.66
0.978
H → L+1 (47%)


H−1 → L (40%)


Porphyrin05
472
1.53
0.970
H → L+1 (23%)


H−2 → L+2 (20%)


H−4 → L (14%)


H−2 → L+1 (10%)


Porphyrin06
452
1.69
0.979
H−1 → L+1 (47%)


H → L+2 (21%)


H → L (15%)


Porphyrin07
469
2.31
0.995
H−2 → L (40%)


H → L+1 (35%)


Porphyrin08
469
1.52
0.970
H → L+1 (30%)


H−2 → L+2 (20%)


H−4 → L (16%)


Porphyrin09
474
2.07
0.992
H−2 → L (36%)


H → L+1 (34%)


Porphyrin10
471
2.21
0.994
H−2 → L (48%)


H → L+1 (22%)


H−2 → L+1 (10%)


Porphyrin11
470
2.14
0.993
H−2 → L (41%)


H → L+1 (17%)


H−2 → L+1 (14%)


H−2 → L+2 (12%)


Porphyrin12
451
1.58
0.973
H−1 → L+1 (41%)


H → L+2 (19%)


H → L (14%)


Porphyrin13
444
2.16
0.993
H−1 → L (48%)


H → L+1 (41%)


Porphyrin14
475
1.59
0.974
H−1 → L+1 (52%)


H → L (25%)


H → L+2 (12%)


Porphyrin15
474
2.10
0.992
H−2 → L (36%)


H → L+1 (34%)




5 Conclusions
The main purpose of the present study was to apply our recently developed inverse-design method (PooMa) to a practical application, i.e. identifying efficient α substituted porphyrin-dyes to be used in dye-sensitized solar cells. A second, equally important, purpose was to provide suggestions for new molecules with hopefully better performance than the so-far synthesized ones.
PooMa is based on genetic algorithms that make it possible to identify efficiently the optimal molecules out of eventually thousands or more of molecules. In order to reduce the computational demands we used the DFTB method for the electronic-structure calculations, which provides a good compromise between efficiency and accuracy. For each molecule, five property descriptors (G, Oav, Dav, A, and LHE) were calculated. We developed a QSPR model that could established a mathematical relationship between these five property descriptors and the PCE.
It is interesting that the PooMa calculations led to 15 porphyrins of which none has been studied so far. Thus, this demonstrates that an approach like PooMa may make it possible to extend the chemical space and provide suggestions for interesting systems beyond what the more traditional use of chemical intuition provides. Moreover, we used DFT methods to provide further information on the porphyrins that PooMa identified. Finally, for the sake of completeness we add that the suggested porphyrins will be synthesized and tested in experiment in the near future.
The main ideas behind genetic algorithms are not new. However, the combination with a simple, fast, but still accurate method (DFTB) for the calculation of electronic properties is a unique feature of our method that makes it generally applicable also for other properties and/or classes of systems. Thus, our inverse design method is not limited to solar cells or to optical properties. New electronic properties can be added in PooMa and new performance functions can be optimized. Other areas, such as heterogeneous catalysis, hydrogen storage, etc., provide other possible applications of PooMa.
Conflicts of interest
The authors declare no conflict of interest.
Acknowledgements
This work was supported by the German Research Council through Project Sp439/41-1, National Natural Science Foundation of China (No. 21761132007).
References
A. Hagfeldt, G. Boschloo, L. Sun, L. Kloo and H. Pettersson, Chem. Rev., 2010, 110, 6595–6663 CrossRef CAS PubMed .
L. Zhang and J. M. Cole, J. Mater. Chem. A, 2017, 5, 19541–19559 RSC .
S. Mathew, A. Yella, P. Gao, R. Humphry-Baker, B. F. E. Curchod, N. Ashari-Astani, I. Tavernelli, U. Rothlisberger, M. K. Nazeeruddin and M. Grätzel, Nat. Chem., 2014, 6, 242–247 CrossRef CAS PubMed .
M. P. Balanay and D. H. Kim, Phys. Chem. Chem. Phys., 2008, 10, 5121–5127 RSC .
X. Liao, H. Zhang, J. Huang, G. Wu, X. Yin and Y. Hong, Dyes Pigm., 2018, 158, 240–248 CrossRef CAS .
C. V. K. Lingamallu Giribabu and P. Y. Reddy, J. Porphyrins phthalocyanines, 2006, 10, 1007–1016 CrossRef .
M. K. Nazeeruddin, R. Humphry-Baker, D. L. Officer, W. M. Campbell, A. K. Burrell and M. Grätzel, Langmuir, 2004, 20, 6514–6517 CrossRef CAS PubMed .
M. P. Balanay, C. V. P. Dipaling, S. H. Lee, D. H. Kim and K. H. Lee, Sol. Energy Mater. Sol. Cells, 2007, 91, 1775–1781 CrossRef CAS .
A. Forneli, M. Planells, M. A. Sarmentero, E. Martinez-Ferrero, B. C. O'Regan, P. Ballester and E. Palomares, J. Mater. Chem., 2008, 18, 1652–1658 RSC .
H. J. Snaith, Adv. Funct. Mater., 2010, 20, 13–19 CrossRef CAS .
V. Venkataraman, S. Abburu and B. K. Alsberg, Phys. Chem. Chem. Phys., 2015, 17, 27672–27682 RSC .
H. Li, Z. Zhong, L. Li, R. Gao, J. Cui, T. Gao, L. H. Hu, Y. Lu, Z. M. Su and H. Li, J. Comput. Chem., 2015, 36, 1036–1046 CrossRef CAS PubMed .
K. Huwig, C. Fan and M. Springborg, J. Chem. Phys., 2017, 147, 234105 CrossRef PubMed .
M. Springborg, S. Kohaut, Y. Dong and K. Huwig, Comput. Theor. Chem., 2017, 1107, 14–22 CrossRef CAS .
H. G. Tsai, J. Hu, C. Tan, Y. Sheng and C. Chiu, J. Phys. Chem. A, 2016, 120, 8813–8822 CrossRef CAS PubMed .
W. Fan, D. Tan and W. Deng, Phys. Chem. Chem. Phys., 2011, 13, 16159–16167 RSC .
M. Karami, A. R. S. Beni and B. Hosseinzadeh, Surf. Sci., 2017, 664, 110–119 CrossRef CAS .
E. Maggio, N. Martsinovich and A. Troisi, J. Chem. Phys., 2012, 137, 22A508 CrossRef CAS PubMed .
M. Urbani, M. Gräzel, M. K. Nazeeruddin and T. Torres, Chem. Rev., 2014, 114, 12330–12396 CrossRef CAS PubMed .
G. Seifert, D. Porezag and T. Frauenheim, Int. J. Quantum Chem., 1996, 58, 185–192 CrossRef CAS .
T. A. Niehaus, S. Suhai, F. Della Sala, P. Lugli, M. Elstner, G. Seifert and T. Frauenheim, Phys. Rev. B: Condens. Matter Mater. Phys., 2001, 63, 085108 CrossRef .

          M. J. Frisch, G. W. Trucks, H. B. Schlegel, G. E. Scuseria, M. A. Robb, J. R. Cheeseman, G. Scalmani, V. Barone, G. A. Petersson, H. Nakatsuji, X. Li, M. Caricato, A. V. Marenich, J. Bloino, B. G. Janesko, R. Gomperts, B. Mennucci, H. P. Hratchian, J. V. Ortiz, A. F. Izmaylov, J. L. Sonnenberg, D. Williams-Young, F. Ding, F. Lipparini, F. Egidi, J. Goings, B. Peng, A. Petrone, T. Henderson, D. Ranasinghe, V. G. Zakrzewski, J. Gao, N. Rega, G. Zheng, W. Liang, M. Hada, M. Ehara, K. Toyota, R. Fukuda, J. Hasegawa, M. Ishida, T. Nakajima, Y. Honda, O. Kitao, H. Nakai, T. Vreven, K. Throssell, J. A. Montgomery, Jr., J. E. Peralta, F. Ogliaro, M. J. Bearpark, J. J. Heyd, E. N. Brothers, K. N. Kudin, V. N. Staroverov, T. A. Keith, R. Kobayashi, J. Normand, K. Raghavachari, A. P. Rendell, J. C. Burant, S. S. Iyengar, J. Tomasi, M. Cossi, J. M. Millam, M. Klene, C. Adamo, R. Cammi, J. W. Ochterski, R. L. Martin, K. Morokuma, O. Farkas, J. B. Foresman and D. J. Fox, Gaussian 09 Revision D.01, Gaussian Inc., Wallingford, CT,  2013 Search PubMed .
T. Lu and F. Chen, J. Comput. Chem., 2012, 33, 580–592 CrossRef CAS PubMed .
T. Le Bahers, C. Adamo and I. Ciofini, J. Chem. Theory Comput., 2011, 7, 2498–2506 CrossRef CAS PubMed .

Footnote† Electronic supplementary information (ESI) available: Data set and substitutes pool. See DOI: 10.1039/c8cp07722cThis journal is © the Owner Societies 2019
Table Content:
	(1)

 	Fig. 1  The mechanism of a DSSC.2	 

 	Fig. 2  Zinc-porphyrin as backbone and the four α sites as available sites for functional groups.	 

 	Fig. 3  Flowchart of the genetic algorithm.	 
	(2)
	(3)
	(4)
	(5)
G = εLUMO − εHOMO	(6)
	(7)
	(8)
	(9)
	(10)
	(11)
	(12)
	(13)
	(14)
	(15)
	(16)
	(17)
	(18)
f+A = qAN − qAN+1	(19)
f−A = qAN−1 − qAN	(20)
f0A = (qAN−1 − qAN+1)/2	(21)
Δρ(r) = ρEX(r) − ρGS(r)	(22)
	(23)
	(24)
DCT = |R+ − R−|.	(25)
μCT = DCT·qCT	(26)

 	Fig. 4  The whole data set is split into training set, validation set, and test set.	 
	(27)
	(28)
	(29)
	(30)
	(31)


μ
	0.054	0.085	16.7	2.84	0.089

σ
	0.013	0.031	10.4	0.75	0.020


O
av
	0.47	
	
	
	


D
av
	−0.43	−0.41	
	
	


A
	0.23	0.74	0.10	
	

LHE	−0.11	0.34	0.37	0.7	



PCE	−0.21	−0.24	−0.08	−0.37	−0.29
	(32)
	(33)

 	Fig. 5  Predicted and experimental PCE values for training set, validation set, and test set.	 

Training set	0.23	—	1.63	1.98
Validation set	—	0.42	1.58	1.78
Test set	—	0.42	1.61	1.87

 	Fig. 6  The molecular structures identified by the PooMa calculations.	 

 	Fig. 7  The energies of the four frontier molecular orbitals (HOMO−1, HOMO, LUMO, LUMO+1) of the 15 substituted porphyrins as obtained in the DFT calculations.	 

 	Fig. 8  The Fukui functions for the 15 substituted porphyrins. For each molecule, the upper part shows f− and the lower part shows f+.	 


Porphyrin01	0.52	0.41	0.20	0.36	0.07	0.03	0.14	0.17	0.06	0.03
Porphyrin02	0.47	0.38	0.22	0.40	0.10	0.03	0.13	0.15	0.06	0.03
Porphyrin03	0.49	0.40	0.25	0.39	0.06	0.03	0.14	0.17	0.06	0.03
Porphyrin04	0.49	0.41	0.18	0.36	0.12	0.03	0.13	0.17	0.07	0.03
Porphyrin05	0.15	0.38	0.06	0.40	0.71	0.03	0.04	0.17	0.02	0.03
Porphyrin06	0.52	0.41	0.20	0.35	0.06	0.03	0.15	0.17	0.07	0.03
Porphyrin07	0.25	0.37	0.09	0.40	0.55	0.04	0.06	0.16	0.03	0.02
Porphyrin08	0.16	0.39	0.07	0.32	0.69	0.03	0.06	0.23	0.02	0.03
Porphyrin09	0.23	0.39	0.07	0.36	0.61	0.04	0.05	0.17	0.03	0.03
Porphyrin10	0.25	0.36	0.58	0.04	0.08	0.49	0.07	0.08	0.03	0.04
Porphyrin11	0.27	0.32	0.52	0.04	0.10	0.53	0.08	0.08	0.03	0.03
Porphyrin12	0.50	0.41	0.19	0.36	0.06	0.03	0.14	0.17	0.11	0.03
Porphyrin13	0.52	0.38	0.05	0.02	0.20	0.47	0.14	0.08	0.09	0.04
Porphyrin14	0.49	0.37	0.19	0.45	0.13	0.08	0.11	0.08	0.08	0.03
Porphyrin15	0.24	0.39	0.07	0.36	0.60	0.04	0.06	0.17	0.03	0.03


Porphyrin01	0.61	0.05	0.16
Porphyrin02	0.64	0.06	0.18
Porphyrin03	0.67	0.05	0.16
Porphyrin04	0.59	0.06	0.17
Porphyrin05	0.72	0.18	0.61
Porphyrin06	0.58	0.09	0.25
Porphyrin07	0.75	0.45	1.59
Porphyrin08	0.76	0.08	0.30
Porphyrin09	0.68	0.55	1.82
Porphyrin10	0.72	0.61	2.11
Porphyrin11	0.79	0.58	2.21
Porphyrin12	0.61	0.09	0.27
Porphyrin13	0.58	0.19	0.54
Porphyrin14	0.59	0.24	0.68
Porphyrin15	0.61	0.05	0.16


Porphyrin01	426	1.65	0.977	H → L+1 (57%)
H−1 → L (36%)
Porphyrin02	475	1.84	0.986	H−1 → L+1 (34%)
H → L+2 (25%)
H−3 → L (13%)
H → L (11%)
Porphyrin03	470	1.70	0.980	H−1 → L+1 (32%)
H → L+2 (33%)
H−3 → L (13%)
Porphyrin04	443	1.66	0.978	H → L+1 (47%)
H−1 → L (40%)
Porphyrin05	472	1.53	0.970	H → L+1 (23%)
H−2 → L+2 (20%)
H−4 → L (14%)
H−2 → L+1 (10%)
Porphyrin06	452	1.69	0.979	H−1 → L+1 (47%)
H → L+2 (21%)
H → L (15%)
Porphyrin07	469	2.31	0.995	H−2 → L (40%)
H → L+1 (35%)
Porphyrin08	469	1.52	0.970	H → L+1 (30%)
H−2 → L+2 (20%)
H−4 → L (16%)
Porphyrin09	474	2.07	0.992	H−2 → L (36%)
H → L+1 (34%)
Porphyrin10	471	2.21	0.994	H−2 → L (48%)
H → L+1 (22%)
H−2 → L+1 (10%)
Porphyrin11	470	2.14	0.993	H−2 → L (41%)
H → L+1 (17%)
H−2 → L+1 (14%)
H−2 → L+2 (12%)
Porphyrin12	451	1.58	0.973	H−1 → L+1 (41%)
H → L+2 (19%)
H → L (14%)
Porphyrin13	444	2.16	0.993	H−1 → L (48%)
H → L+1 (41%)
Porphyrin14	475	1.59	0.974	H−1 → L+1 (52%)
H → L (25%)
H → L+2 (12%)
Porphyrin15	474	2.10	0.992	H−2 → L (36%)
H → L+1 (34%)
Footnote
† Electronic supplementary information (ESI) available: Data set and substitutes pool. See DOI: 10.1039/c8cp07722c

This journal is © the Owner Societies 2019
