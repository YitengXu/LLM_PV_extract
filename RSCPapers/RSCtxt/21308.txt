A continuity equation for the simulation of the current–voltage curve and the time-dependent properties of dye -sensitized solar cells   - Physical Chemistry Chemical Physics (RSC Publishing) DOI:10.1039/C2CP40719A View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/C2CP40719A
(Paper)
Phys. Chem. Chem. Phys., 2012, 14, 10285-10299Show Chemical TermsA continuity equation for the simulation of the current–voltage curve and the time-dependent properties of dye-sensitized solar cells†

        
          
            Juan A. 
            Anta
          
        
      *a, 
      
        
          
            Jesús 
            Idígoras
          
        
      a, 
      
        
          
            Elena 
            Guillén
          
        
      a, 
      
        
          
            Julio 
            Villanueva-Cab
          
        
      b, 
      
        
          
            Humberto J. 
            Mandujano-Ramírez
          
        
      b, 
      
        
          
            Gerko 
            Oskam
          
        
      b, 
      
        
          
            Laila 
            Pellejà
          
        
      c and 

        
          
            Emilio 
            Palomares
          
        
      cd
aÁrea de Química Física, Universidad Pablo de Olavide, E-41013, Sevilla, Spain. E-mail: anta@upo.es
bDepartamento de Física Aplicada, CINVESTAV-IPN, Mérida, Yucatán 97310, México
cInstitute of Chemical Research of Catalonia (ICIQ), E-43007, Tarragona, Spain
dICREA, Barcelona, E-80810, Spain
Received 
      6th March 2012
    , Accepted 17th May 2012First published on 17th May 2012AbstractA numerical model that simulates the steady-state current–voltage curve and the time-dependent response of a dye-sensitized solar cell with a single continuity equation is derived. It is shown that the inclusion of the multiple-trapping model, the quasi-static approximation and non-linear recombination kinetics leads to a continuity equation for the total electron density in the photoanode with an electron density-dependent diffusion coefficient and a density-dependent pseudo-first order recombination constant. All parameters in the model can be related to quantities accessible experimentally. The required power exponents are taken from impedance spectroscopy measurements at different voltages. The model provides new insights into the physical interpretation of the power exponents. Modeling examples involving a high-efficiency TiO2-based dye solar cell and a ZnO-based dye solar cell are presented. It is demonstrated that the model reproduces the transient behavior of the cell under small perturbations. The spatial dependence of the recombination rate and the influence of film thickness and of voltage dependent injection efficiency on cell performance are studied. The implications of the model are discussed in terms of efficiencies potentially attainable in dye-sensitized solar cells and other kinds of solar cells with a diffusional mechanism of charge transport.
Introduction
Novel photovoltaic devices based on nanostructured semiconductors are nowadays a very active field of research due to their attractive properties for the photovoltaic industry such as low cost, possibility of making transparent and colored devices, and good performance under diffuse light. Among them, dye-sensitized solar cells1,2 (DSC) have reached a certified efficiency of 10.9% for test devices of 1 cm2 active area and 9.9% for a 17 cm2 submodule.3 The highest reported efficiency to date at 1 sun is 12.3%.4 A DSC is based on a complex photoelectrochemical system, where several photochemical and electron transfer processes play an essential role in determining the final efficiency of the device. The mechanisms of many of these processes are still currently under debate, such as the electron transport and recombination mechanisms that actually take place in the photoanode of the solar cell, and the nature of the traps apparently involved.5–12 Together with series resistance losses, the balance between transport and recombination determines to a great extent the shape of the current–voltage curve of the device10 and the electron collection efficiency of the solar cell.11,13
There are many publications that describe the physics of DSC and simulate the current–voltage curve. Sodergren et al.14 introduced a simple continuity equation based on the assumption that electron transport occurs by diffusion and that the kinetics of electron recombination is first-order with respect to the free electron concentration. Cao et al.15 extended the model by considering that the diffusion coefficient is electron density-dependent, as observed in current transient and IMPS measurements as a function of illumination intensity.16 Ferber et al.17 developed a full model that includes all transport and electrochemical reactions involved in the device operation to simulate the current–voltage curve. Wang et al.18 and Fabregat-Santiago et al.19 utilized impedance spectroscopy to extract equivalent circuit elements that can be used to fit the current–voltage curve.
It was realized early on that recombination is often not first-order in electron density and is related to non-linear transport.20,21 Recently Bisquert and Mora-Seró10 formalized non-first order electron recombination and discussed its effects on the shape of the current–voltage curve. Penny et al.22 devised a numerical model that takes the interfacial charge-transfer dynamics and the transport of charged species in the anodic part of the solar cell explicitly into account. Halme et al.23 developed a very complete model that is capable of simulating all processes involved in DSC functioning (light absorption, charge transport and charge transfer at oxide–electrolyte and electrolyte–counterelectrode interfaces) within a single analytical framework. However, this model, being analytical, does not contain important features like non-linear recombination kinetics. Barnes and coworkers have published a set of papers where the transport and recombination factors of dye-sensitized solar cells are analyzed and simulated in terms of measurements of total charge density.8,24 The simulation of the device physics has also been extended recently to two and three dimensions.25,26 Filipič et al.27 have published a model where recombination is implemented via Marcus–Gerischer theory and contributions of the electrolyte and the counter-electrode are included. Gentilini et al.28 discussed recently the charge transport mechanism in DSC by solving numerically the continuity equation for complete devices.
In this work we focus on the transport–recombination kinetics in the semiconductor and at the semiconductor–electrolyte interface. The main objective is to establish a transport–recombination model that makes it possible to simulate, based on a unified description, both the steady-state current–voltage curve and the time-dependent response of the DSC with parameters that can be determined experimentally. Furthermore, we aim to include an appropriate consideration of the non-linear character of the recombination kinetics. For this purpose, the model is based on the derivation of a continuity equation for the total electron density in the photoanode that results in the consideration of a diffusion coefficient and a kinetic recombination constant that are formally density-dependent. The total electron density includes both free and trapped electrons and can be determined easily by charge extraction measurements. In addition, in a formulation in terms of the total density there is no need to assume that there is a conduction band in the semiconductor and therefore it can be easily extended to amorphous semiconductors. The model tries to be, at the same time, simple and rigorous (based on microscopic theories of transport and recombination in nanostructured devices), so that it is flexible enough to incorporate parameters that can be determined experimentally, such as those that evidence the non-linear behaviour of transport and recombination. Hence, the model is aimed to bridge the gap between theoreticians and experimentalists, based on rigorous theoretical grounds.
Previous work by the authors29–31 introduced a model to obtain the current–voltage curve in a DSC based on the total electron density accumulated in the semiconductor oxide. This model described the influence of the density dependence of the transport and recombination kinetics on the shape of the current–voltage curve. In this paper, it is shown (1) that the total-density model is equivalent to models based on the free electron density with non-linear recombination, (2) how the model parameters can be extracted from experiments and (3) that it gives the correct time behavior of the device under small perturbations.
From the equivalence between free and total density formalisms, a simple description of the non-linearity occurring both in transport and in recombination is introduced here. This is taken into account via an effective electron diffusion coefficient and a pseudo-first order recombination constant that depend on the total electron density according to a power law. The fact that the diffusion coefficient and the lifetime of electrons in nanostructured TiO2 electrodes vary with illumination intensity or negative bias (i.e., electron density) is well-known.21,32–36 As these magnitudes are electron density dependent, and the electron density is a function of the position, the model takes into account explicitly that transport and recombination rates can vary locally within the photoanode. The power exponents that control both density dependencies are α and β, which describe trapping and recombination respectively. The first can be estimated from capacitance measurements whereas the second is obtainable from recombination resistance measurements or open-circuit voltage data versus light intensity. A β exponent different from unity, corresponding to non-linear recombination kinetics, leads to a non-ideal current–voltage curve with smaller fill factors than an ideal diode curve.10
Modeling examples presented in this work show that the current–voltage characteristics can be easily derived from a continuity equation for electrons in the photoanode only, which is numerically solvable and based on microscopic theories of transport and recombination fully consistent with the time-dependent behaviour of the solar cell. The parameters required to define the model are related to common experimental techniques that include both stationary and transient techniques. The adequate performance of the model makes it possible to investigate how the shape of the I–V curve and the efficiency of the DSC are affected by the simultaneous effect of non-ideality, series resistance, film thickness and quantum injection yield. Although originally devised to describe DSC, the same idea on which this model is based can also be applied to bulk heterojunction solar cells, as shown recently.37
Basic features of DSC modeling
1. Current–voltage curve and origin of photocurrent
The performance of a solar cell is generally described through the measurement of the current–voltage characteristics of the device, i.e., the I–V curve: J = J(V)(1)where J is the DC electrical current density flowing through the device and V is an externally applied bias or simply the voltage across an external series resistance. The universal shape of an I–V curve of a solar cell under illumination is a consequence of the balance between two opposing mechanisms: (1) light-induced charge separation and subsequent current generation and (2) loss processes (recombination, or dark current). The application of an external (forward) bias implies the accumulation of electrons within the negative photoelectrode (photoanode). This leads to an increase of current in the opposite direction to the current generated by the cell. At sufficiently high bias, the two currents cancel, corresponding to open-circuit conditions, while at zero bias the cell produces its maximum current, corresponding to short-circuit conditions. The solar cell generates power when it produces current at non-zero bias (see Fig. 1). This behaviour can be described, in its simplest form, via the diode equation. Assuming no series or shunt resistances, this can be written as:38 J = Jsc − J0(exp(eV/mkBT) − 1)(2)where Jsc is the short-circuit photocurrent density, J0 the exchange-current density, e the elementary charge, kB the Boltzmann constant, T the absolute temperature and m the ideality factor.
 Fig. 1  Left: illustration of the conditions of accumulation of total electron density in the semiconductor in a dye-sensitized solar cell under illumination at different points of the current voltage curve. Right: illustration of the multiple-trapping model: electron transport is assumed to occur via an extended state Ec, but it is slowed down by trapping and detrapping events to and from localized states (shown as thin arrows) with energies distributed along a certain density of states g(E). This mechanism results in an effective diffusion coefficient that depends on the quasi-Fermi energy EF or on the electron density. In addition, recombination processes between electrons and tri-iodide ions and dye cations can occur in the cell under operation (shown as a thick arrow), both for electrons present in the conduction band and in the localized states. 
The current-density in solar cells arises from the movement of both electrons and holes. Focusing on DSC an important simplification (approximation 1) can be introduced: a DSC device is based on the interpenetration of a nanostructured network of high dielectric constant (at least for TiO2) and an electrolyte with high ionic strength. This implies that the Debye length is very short (of the order of a few nanometers) so that no macroscopic electrical field can be sustained within the device and transport occurs mainly by diffusion while drift contributions are negligible. The accuracy of this approximation has been demonstrated recently by Gentilini et al.39 Additionally this diffusion will be a two-directional process, where both electrons and ionic charge in the electrolyte contribute to the total current and the motion of both kinds of carriers is connected due to electrical neutrality. Recently, it has been proposed that the assumption of transport by diffusion is also valid for bulk heterojunction solar cells.37 Under the diffusion-only assumption, charge separation in a solar cell is produced by kinetic selectivity, and the photocurrent arises from the existence of a density gradient at the external contact.
2. Electron density in the photoanode and origin of photovoltage
Electrons in a semiconductor obey Fermi–Dirac statistics if they behave ideally. Under equilibrium conditions (dark conditions) a Fermi level is defined, which corresponds to the chemical potential of the electrons in the semiconductor. When the energy difference between the Fermi level and the conduction band is much larger than the thermal energy kBT, the density of electrons in the conduction band is given by the Boltzmann approximation (approximation 2)40 n0c = Ncexp(−E0F/kBT)(3)where n0c is the density of free electrons in the dark, E0F is the corresponding Fermi energy with respect to the conduction band (defined positive), and Nc is the density of states in the conduction band. Note that the electron density and Fermi level in the dark are assumed to be independent of x, which is a reasonable assumption for a system at thermodynamic equilibrium.
When the solar cell is under illumination, electrons are injected into the conduction band, raising the Fermi level (which is called a quasi-Fermi level). Additionally, a density gradient is created, which is consequently linked to a quasi-Fermi level gradient nc(x) = Ncexp(−EF(x)/kBT)(4)The applied voltage across the cell corresponds to the energy difference between the quasi-Fermi level of electrons and holes at the contacts. In a DSC the hole quasi-Fermi level is generally defined as the redox potential energy in the electrolyte, which also defines the Fermi level in the anode under dark conditions. This implies that the photovoltage in a DSC is related to the increase of the quasi-Fermi level at the interface between the transparent conducting oxide and the TiO2 film (defined as x = 0) with respect to dark conditions5,6 (5)As noted, eqn (3) and (4) are based on the Boltzmann approximation of Fermi–Dirac statistics (approximation 2). Therefore, it is implicitly assumed that the system behaves ideally. However, there are indications9,41 that electron concentration cannot be related to the Fermi level by a simple Boltzmann factor and that an ideality factor, related to the “activity” of the electrons in the conduction band, should be introduced in eqn (3) and (4). It should also be noted that when a large current is flowing, a small overpotential is required at the counter electrode to sustain the current, which may affect the current versus cell voltage curve, depending on the kinetics of the reduction reaction.
It is well-accepted that in nanocrystalline semiconductor oxides (assumption 1) there is a significant amount of localized states (traps).36,42 Furthermore, these traps are assumed (assumption 2) to have energies distributed according to an exponential distribution43,44 (6)where Et is the energy of the trap with respect to the conduction band (defined positive), Nt is the total trap density and α is a parameter that reflects the average energy of the distribution of trap states below the conduction band. Commonly the trap parameter is related to temperature via α = T/T0 where T0 is the characteristic temperature of the distribution.
As mentioned in the Introduction, it is convenient to base the modeling of the solar cell in terms of the total electron density in the photoanode, as this is an experimentally accessible quantity. To do so it is necessary to relate the quasi-Fermi level and the total electron density. This is achieved by performing an integration of the trap distribution convoluted to the Fermi–Dirac probability. Applying the Boltzmann limit of this (again approximation 2), and assuming that most of the electrons are trapped (n ≈ nt) we find the following relation between the quasi-Fermi level, EF(x), and total density, n(x), both under illumination and in the dark:34,45 n(x) = Ntexp(−αEF(x)/kBT)(7) n0 = Ntexp(−αE0F/kBT)(8) (9)The photovoltage is then related to the total density accumulated in the semiconductor as: (10)Combining eqn (5) and (10) the following relationship is found between total and free densities (11)The same relationship has been derived by van de Lagemaat and Frank using arguments of internal equilibrium between free and trapped electrons.33 We will make use of this equation to express the continuity equation in terms of the total density of electrons in the photoanode.
3. Continuity equation for electrons
As said, in order to formulate a continuity equation that is useful to reproduce the stationary I–V curve of the solar cell and its transient behavior, it is important to write it in terms of experimentally measurable quantities, i.e., current-density, applied bias and total carrier density. In addition, it has to be based on well-defined quantities from the fundamental point of view. Normally in a DSC, the electrolyte has a high ionic strength, making the electronic part of the current the only limiting process (approximation 3). This permits us to write the continuity equation in terms of the electron density in the photoanode.
It is generally accepted (assumption 3) that the diffusional transport of electrons throughout the nanostructured semiconductor occurs according to the multiple-trapping model.46–48 This model assumes that transport occurs via extended states but that it is limited by trapping (detrapping) events to (from) localized states (see Fig. 1). Under assumption 3, it is common in the DSC literature5,8,14,35,49 to use the free electron density to write the continuity equation, as only free electrons move on the short time scale and, hence, determine the current density in the device. From these ideas, and assuming 1-dimensional geometry for electronic processes in the photoanode, the following continuity equation is formulated (12)where x is the distance to the collecting contact (working electrode), J(x) is the current density, JR(x) is the recombination rate, G(x) is the volume generation rate and nc and nt are the number densities of free and trapped electrons respectively.
The generation term G can be calculated, assuming a Lambert–Beer profile for light harvesting, as (13)where ϕinj is the quantum injection yield, I0(λ) is the solar spectrum (here taken from the standard AM1.5G) and εcell(λ) is the absorption coefficient of the dye in the solar cell.
The diffusion and recombination terms in eqn (12) can be expressed in terms of the free density using Fick's first law and non-linear chemical kinetics (14)where D0 and k0 are the diffusion coefficient and the recombination rate constant of free electrons, respectively, and β is the recombination reaction order with respect to free electrons.

Eqn (14) is the continuity equation that has to be solved to describe the dynamic behavior of the solar cell device under approximation 3, and assumption 3. This requires knowledge of the kinetics of the trapping–detrapping mechanism contained in the last term in eqn (14), and solving the corresponding coupled continuity equation for trapped electrons. In the steady-state, the time-dependent derivatives do not appear and the I–V curve can be simulated by numerical integration on the x-coordinate (see for instance ref. 8, 10, and 23). In this work, in contrast, we aim to formulate a single continuity equation in terms of experimentally measurable quantities that contain the correct time-dependence. To do so, we make use of the quasi-static approximation (approximation 4) of Bisquert and Vikhrenko.35 This approximation assumes that the trapping–detrapping kinetics are much more rapid than the transport and the recombination processes. Consequently, the concentration of free electrons is “buffered” or amortiguated by the concentration of trapped electrons with respect to small deviations of the Fermi level, produced by either a small perturbation in voltage or in illumination. Mathematically, this approximation is expressed as (15)where the “trapping factor”, ∂nt/∂nc, is independent of time. The quasi-static approximation is implicit to eqn (11), because it is based on the assumption that the total and the free electron densities are in quasi-equilibrium defining the same Fermi level. From eqn (4), (7) and (11), and approximation 2, we find35 (16)
As mentioned in the Introduction, it is convenient to express the continuity equation in terms of the total electron density in the photoanode, as this is an experimentally accessible quantity. Using eqn (15) and (16), the continuity equation can be written as (17)with (18) (19)
Note that now the trapping term in eqn (17) does not appear explicitly. The trapping–detrapping dynamics is implicitly considered in the form of an effective diffusion coefficient and an effective recombination constant. As explained below, these two time constants are experimentally accessible by means of small-perturbation techniques, including electrochemical impedance spectroscopy (EIS) and intensity-modulated photocurrent and photovoltage spectroscopies (IMPS/IMVS).35,50 It is well-known that these two magnitudes are density or Fermi level dependent. Therefore, this dependence should be explicitly considered in the continuity equation. This is an important point because, as mentioned above, in the photoanode there exists an electron density gradient which gives rise to the photocurrent (unless under open-circuit conditions). As a consequence there is a dependence of Dn and k1 on local density that should be taken into account when the continuity equation is solved. The consideration of non-constant diffusion coefficients in diffusional problems is not new, having been treated previously a number of times in the physics literature.51–55 In this case Fick's second law takes the form of the first term in eqn (17), with the second spatial derivative outside the product of Dn and the density gradient. Density-dependent diffusion coefficients have been associated to anomalous diffusion51 and strongly interacting systems.53,54 This is the case in the electron transport in nanostructured semiconductor oxides, where trap-filling effects play the role of an effective interaction between carriers, which causes the dependence on electron density.44,45,56

Eqn (17) can be further reduced if we take into account approximation 2: ∂nc/∂n ≪ 1. Hence (20)which is the continuity equation in terms of the total electron density that contains the correct trapping dynamics and time dependence via approximation 4.
The continuity equation (eqn (20)) contains density-dependent time constants defined by eqn (18) and (19). As these depend on parameters difficult to measure experimentally, it is convenient to rewrite these equations as21,35,45,57 (21) (22)where Dref and kref are the diffusion coefficient and recombination constant that correspond to a reference value of the total density nref. In principle, both time constants can be related to any reference but it might appear convenient to choose the equilibrium, dark situation, as we do henceforth. However, another reference can be used, especially when one has small-perturbation measurements at different illumination intensities. Hence, it is not necessary to know the equilibrium value, only the power law exponent and a reference point, to use this model.
The power-law dependence shown in eqn (21) has indeed been observed in nanocrystalline semiconductor oxides.5,15,16,21,58 On the other hand, k1 plays the role of a pseudo-first order kinetic recombination constant which can be related to the inverse of an electron lifetime:59k1 = 1/τ1. The connection with the experiments of the functionality shown in eqn (22) and the measurement of k1 is discussed in the next section. The advantage of using the formalism contained in eqn (20)–(22) is that the transient and stationary behaviors of the device are described with a single continuity equation, with all the trapping and recombination characteristics contained in the density-dependence of Dn and k1. Furthermore, it takes into account that the transport and recombination rates vary locally within the nanostructured electrode. This issue has only been treated marginally in the literature.60
4. Recombination kinetics: linear and non-linear regimes and connection with small-perturbation experimental techniques
The density dependence of the pseudo-first order recombination constant and its experimental determination can be obtained by defining a small-perturbation recombination constant kn by (note that, for simplicity, in the following equations we do not show the dependency on x implicit to the model) (23)where JR is the recombination current (third term in the right-hand side of eqn (20)). As voltage and Fermi level are directly related, the first factor in eqn (23) corresponds to the inverse of the recombination resistance. This has been studied by Bisquert and coworkers10,18,59 (24)where β is a parameter that can be determined by impedance spectroscopy and which normally varies between 0.5 and 0.7 (we remind the reader that Fermi energies are defined positive, see eqn (3)).
The second factor in eqn (23) corresponds to the inverse of the differential response of the total electron density within the semiconductor upon small variations of the external voltage. Hence, this is the inverse of the chemical capacitance of electrons in the semiconductor.61 By differentiating eqn (7) with respect to the Fermi level we obtain (25)
By combining eqn (23)–(25) we find for the small-perturbation recombination constant kn(n) = k0nexp{−(β − α)[EF − E0F]/kBT}(26)which transforms into eqn (22) if we substitute the relation between total density and Fermi level (eqn (7) and (8)). If we would define a local voltage as a function of x, the term [EF(x) − E0F] in eqn (26) could be replaced by eV(x), and we would recover a voltage (defined positive) dependent recombination rate constant.
It is important to find the relationship between kn, the experimental quantity, and the pseudo-first order recombination constant k1 defined in eqn (19). If the recombination current JR is linearized with respect to small perturbations of the total density or the Fermi level (as in a EIS experiment) the density derivative of JR is directly related to the recombination constant (see for instance ref. 59). By differentiating JR and using eqn (19) one finds (27)Hence the relationship between both definitions of the recombination constant is just a constant parameter and does not affect the density and Fermi level dependence, which is the same for both.
In previous work29 we investigated the influence of two different recombination mechanisms by using different expressions for the recombination rate constant in the continuity equation for total electron density: we distinguished between transport-limited recombination, where the recombination rate constant had the same dependence on the electron density as the diffusion coefficient, and transfer-limited recombination, where we postulated a Butler–Volmer-type electron transfer rate constant as a function of the cell voltage: kn(n) = k0nexp{−b[EF − E0F]/kBT}(28)where b is the transfer coefficient. It was found that introduction of eqn (28) led to the interesting result that the recombination rate becomes non-linear in electron density, with an exponent of α + b. As a consequence, it was concluded that non-linear recombination is a consequence of recombination being not completely transport-limited. In the current analysis, we can see by comparing eqn (26) and (28) that b = β − α, hence, one could say that the transfer parameter contains the complex dependence of the recombination rate on the density of localized states, their population and the density of acceptor states in the electrolyte, as well the kinetics of the charge transfer process. This complex dependence has been studied in detail by several authors.18,62–64 For instance Bisquert et al.59 derived that, under the approximation that the reorganization energy is sufficiently large, β = ½ + α. Replacing this in eqn (26), one obtains b = ½, which is the classical value of Butler–Volmer theory (the limit of Marcus theory for large reorganization energy).65 However, as this work deals with the numerical simulation of the current–voltage curve and the time-dependent response of the solar cell we do not consider the physics behind the β parameter and just take it as a fitting parameter.
The previous derivation shows that the parameter β corresponds indeed to the reaction order of the recombination reaction with respect to the free electron density. If β = 1 (linear recombination with respect to free electron density), the kinetics of recombination has the same density dependence as the diffusion kinetics. This has been described as if recombination is a diffusion-limited process.21,34,66,67 Hence: kn ∼ Dn(29)In any other case, recombination and diffusion do not have the same density-dependence. We have described this as transfer-limited recombination.29
The continuity equation (eqn (20)) together with eqn (21) and (22) can be solved numerically for the total density n(x) using a finite difference method for appropriate boundary conditions. In ref. 29–31 the equation was solved using the Forward Time Central Space method15 coupled with the Lax scheme68 (required to catch the strong density dependence contained in eqn (21) and (22)). An illustration of the numerical method employed to solve the continuity equation and to obtain the I–V curve is shown in Fig. 2. As shown previously,29,30 if β = 1 the numerical solution reproduces the diode equation (eqn (2)) for the ideal case (m = 1), when the recombination constant has the same density dependence as the diffusion coefficient. In any other case a non-ideal diode is obtained, with m = 1/β.
 Fig. 2  Scheme of the numerical procedure utilized to obtain the current–voltage curve from the numerical solution of the continuity equation based on the total density (eqn (20)–(22)). Once steady-state is reached (signaled by a constant value of the photocurrent) an electron density profile is produced within the semiconductor (between x = 0 and x = d, where d is the film thickness). The boundary conditions impose zero current at x = d, and a density at time zero and at the contact (x = 0) given by eqn (10). The current is obtained from the gradient of the density profile at the contact. By varying the applied bias V from zero to open-circuit conditions (zero current), the full current–voltage curve can be calculated. 
In this section we have derived the continuity equation (eqn (20)) from the continuity equation based on free electron density, eqn (12). In the stationary state, both equations should give the same current–voltage curve. This is shown numerically in the ESI.† The advantage of eqn (20) is that results for non-steady-state conditions can also be obtained from the same differential equation.
Table 1 Assumptions and approximations considered in the model of this work




Approximation 1
Charge transport occurs only by diffusion


Approximation 2
Electron density and Fermi level are related by Boltzmann statistics


Approximation 3
The I–V curve is determined by the electronic part only


Approximation 4
A quasi-static equilibrium holds between free and trapped electrons


Assumption 1
Electron traps exist in the nanostructured semiconductor


Assumption 2
Traps in the semiconductor fit to an exponential distribution of energies


Assumption 3
Electron transport occurs according to the multiple-trapping model


Assumption 4
Effective diffusion coefficient, pseudo-first order recombination constant, and electron diffusion length correspond to quantities measured by small-perturbation techniques




5. Determination of the electron diffusion length
The manifestation of non-linear recombination and deviations from this compensation effect is most clearly seen via the electron diffusion length. This important parameter is strictly defined from the solution of the continuity equation (eqn (12)) at steady-state with no generation: (30)The general solution of this differential equation is an exponential function for nc where the diffusion length is the decay parameter, i.e., the electron diffusion length:13,69,70 Ln = (D0/k0)1/2 = (D0τ0)1/2(31)
The electron diffusion length can be viewed as the average distance that electrons travel before recombination. This has been shown both theoretically10 and from random walk numerical simulation.13 When recombination does not depend linearly on electron density the diffusion length cannot be defined from the product of the diffusion coefficient and the lifetime. However Bisquert and Mora-Seró10 have elegantly shown that a “small-perturbation diffusion length” can be defined from the solution of the continuity equation for a small deviation of the electron density with respect to a uniform background. Under this assumption (assumption 4) we write: Ln = (Dn/kn)1/2(32)Using eqn (21) and (22) that define the diffusion coefficient and the recombination constant in terms of the total density we arrive at the expression: Ln = (D0/k0)1/2(n/n0)(1−β)/2α(33)If β = 1 (linear, diffusion-limited recombination), the diffusion length reduces to eqn (31) and, therefore, it remains constant. For sub-linear recombination, β < 1, the diffusion length will increase with the total electron density, that is, with applied bias or illumination (Scheme 1). This effect has been accurately measured and modeled by Villanueva-Cab and coworkers.49
 Scheme 1  Comparison between linear (β = 1) and sub-linear (β < 1) recombination kinetics. 
6. Practical modeling of a DSC and simulation of the I–V curve
The parameters required for the application of the model are obtained as follows:
(1) The trap distribution parameter α was obtained from Electrochemical Impedance Spectroscopy (EIS) measurements of the capacitance at different applied voltages (see ESI† and ref. 71). Taking into account eqn (25) (assumption 2), and assuming that there is no band edge unpinning,12 these measurements should give approximately straight lines in the semilogarithmic plot according to eqn (25). This can be written as:61 (34)
(2) The charge transfer parameter β is obtained from EIS measurements of the recombination resistance at different applied voltages.10,18,59 According to eqn (24) these measurements should give approximately straight lines in the semilogarithmic plot according to the relation: (35)Alternatively, the β parameter can be obtained from steady-state measurements of the open-circuit photovoltage versus light intensity. At open circuit, generation should balance recombination: JR = G. Using eqn (10) and (22), and knowing that generation should be proportional to light intensity, the following relation can be obtained: (36)which means that β can be obtained from the slope of a semilogarithmic plot of the open-circuit voltage versus light intensity. In our previous work,29 the slope of the Voc–ln I plot was described as determined by β = b + α. Hence, both the kinetics of transfer and the trapping density have an influence on the behavior of the open-circuit voltage. As mentioned above, determination of β by eqn (35) or (36) can give different results as a consequence of a non-ideal behaviour of the electron density. This can be sorted out at the cost of introducing an extra parameter in the model, as proposed by Barnes et al.8
The effective electron diffusion coefficient in the dark D0 is estimated from experimental measurements of the diffusion coefficient at various applied voltages, as obtained, for instance, from Intensity-Modulated Photocurrent Spectroscopy (IMPS).72
The I–V curve is reproduced by using the short-circuit photocurrent, the open-circuit photovoltage and the maximum power point as reference points. The first is fitted by adjusting the dye concentration of the cell and/or the quantum injection yield assuming, initially, zero recombination.31 The second is fitted by adjusting the recombination constant prefactor kref (k0) in eqn (22). Several iterations of these two steps are necessary to fit simultaneously JSC and VOC with the same set of parameters. Finally the additional series resistance is fitted by reproducing the experimental current at the maximum power point. As the electron transport resistance is already implicit to the model (diffusional term in the continuity equation (eqn (20)), this additional series resistance pertains only to the conducting glass, solution, wires and leads contributions.
Results and discussion
1. Simulation of the I–V curve
In Fig. 3 and 4, and Table 2, examples of application of the present model to a 8.5% efficient TiO2 solar cell73 and a 2.7% efficient ZnO solar cell are presented.74 Details of the experimental fabrication and characterization of the DSC can be found in the ESI.† A similar application of the model to ZnO cells can be found in ref. 74. The figures contain the steady-state results of the solution of eqn (20)–(22) according to the procedure outlined in the previous section. With no series resistance, the model is found to reproduce very accurately the diode equation (eqn (2)) with m = 1/β. This is a very relevant result since the model includes position-dependent diffusion and recombination terms with trapping effects. However, as it could be expected, under steady state conditions, trapping and position dependent effects cancel out, and the final result depends on the β parameter only, as predicted by the simple diode equation. As a consequence, when β is extracted from the slope of the VOC–ln I curve, the model reproduces the correct light intensity dependence of the open-circuit voltage (defined as the voltage at which the numerical solution gives zero current at a given illumination), as shown in the insets of Fig. 3 and 4. When the series resistance is introduced in the model, good agreement is found with the experimental data along the full I–V curve.
 Fig. 3  Current–voltage curve of an 8.5% efficient TiO2 solar cell sensitized with C101 Ru-dye in an organic solvent electrolyte. The parameter α required in eqn (21) and (22) is extracted from impedance spectroscopy capacitance measurements at different applied bias. The parameter β (eqn (22)) is obtained from the slope of the recombination resistance versus applied bias in the impedance spectra (solid lines) or from the slope of the open-circuit voltage versus light intensity (dashed-dotted line). Dashed line corresponds to the result of including an external series resistance to the model. The illumination intensity was 100 mW cm−2 (AM1.5). 
 Fig. 4  Same as Fig. 3 but for the current–voltage curve of a 2.7% efficient ZnO solar cell sensitized with the D149 dye in an organic solvent electrolyte. In this case a single β value has been used, extracted from the VOC−ln(I/I0) curve. The illumination intensity was 100 mW cm−2 (AM1.5). 
Table 2 Model and experimental parameters for the cells studied in Fig. 3 and 4




Parameter
Experiment
Model
Units




TiO2 cell (0.16 cm2, 8.5% efficiency, 1 sun AM1.5), d = 10 μm, D0 = 10−10 cm2 s−1



α

0.195 (EIS)
0.2
—



β

0.598 (EIS)
0.60/0.88
—



m

1.13 (Vocvs. ln I)
1.19
—



R
s
A

2.16 (EIS)
4.8
Ω cm2



τ

n
 (VOC)
∼0.005 (OCVD)
0.0035/0.0038
seconds


Dye loading
 
1.0 × 10−7/1.1 × 10−7
mol cm−2


ZnO cell (0.64 cm2, 2.7% efficiency, 1 sun AM1.5), d = 10 μm, D0 = 10−7 cm2 s−1



α

0.13 (EIS)
0.2
—



β

0.55 (EIS)
0.7
—



m

1.35 (Vocvs. ln I)
1.27
—



R
s
A

11.5 (EIS)
30
Ω cm2



τ

n
 (VOC)
∼6 × 10−3
4.4 × 10−4
seconds


Dye loading
3.5 × 10−8 (adsorption)
4.3 × 10−8
mol cm−2




Results for the fitted parameters and comparison with the same parameters obtained by experimental measurements are shown in Table 2. It is found that the fitted electron lifetime under open-circuit conditions (inverse of the pseudo-first recombination constant of eqn (22)–(26)) matches fairly well the lifetime extracted from OCVD or the small-perturbation lifetime extracted by EIS experiments (both directly related by eqn (27)). The fitted series resistance is also close to the series resistance estimated from EIS. Since the model is based on the continuity equation for electrons only, the series resistance parameter should correspond to the sum of the TCO resistance, the contribution of the counter-electrode and the resistance of the electrolyte, all of them obtainable from EIS experiments.
The steady-state result of the modeling permits us to derive a number of conclusions. As mentioned several times above, the values of β extracted from recombination resistances or from VOC–ln I data do not coincide. This problem has already been noticed by Barnes et al.,8,9 who introduced a third dimensionless parameter that accounts for the deviation of eqn (4) from ideal statistics (Boltzmann). This deviation has been related75 to an electron activity coefficient different from unity due to electron–electron interactions, which are ignored in an ideal “electron gas”. However, the effect of this disagreement in the current voltage curve (Fig. 3) and in the electron density profiles (see below) is small. As a matter of fact, it can be observed that the major loss in the fill factor for many cells is due to series resistance rather than to non-ideal recombination (β < 1). The series resistance loss is especially evident for the ZnO cell, which is constructed on a larger active area.
However, it has been observed that the series resistance parameter required to fit the maximum power point always lies above the value extracted from the EIS experiments. This might indicate that additional factors apart from non-ideality and external series resistance can have a contribution to the deterioration of the fill factor and the decrease in efficiency. In this regard, very recently Jennings and coworkers12 have studied the effect of inefficient dye-regeneration on the performance of the DSC, especially under conditions close to open-circuit, and estimated its effect on the current–voltage curve. In connection with this issue, Cai and coworkers76 developed a two-band model that predicts a decrease of the injection efficiency as the Fermi level in the semiconductor is raised, as also noticed by Koops et al.77 These effects would lead to a bias-dependent generation term in eqn (20) that would produce an additional decrease of the fill factor. In fact, the present model proves to be unable to reproduce the slight decrease of the photocurrent at voltages slightly smaller than the voltage at the maximum power point, observed in Fig. 3 and 4. An estimation of the impact of a bias-dependent generation term in the current–voltage curve is presented below.
2. Density profile and position dependence of the recombination rate
The accurate modeling of the experimental current–voltage curve provides us with a safe tool to extract additional information from the numerical solution of the continuity equation. In Fig. 5 the total steady-state density profile and the quasi-Fermi level profile within the photoanode for the high-efficiency TiO2 cell are presented.
 Fig. 5  Total electron density profile (top) and quasi-Fermi level profile (bottom) at steady-state for the DSC studied in Fig. 3. The Fermi level shift between short-circuit (solid line) and open-circuit (dashed line) conditions is shown in the graph. Note that densities are normalized with respect to their value at the contact x = 0. 
As expected, the numerical model reproduces a steep gradient of the density near the collecting boundary (x = 0), which gives rise to the photocurrent measured in the current–voltage curve. As the voltage is increased, the gradient is reduced, until the gradient is zero under open-circuit conditions, and no current is produced. From eqn (9) the quasi-Fermi level variation within the photoanode can be obtained. The model predicts a shift of 207 mV between short-circuit and open-circuit conditions at x approaching x = d, in agreement with values measured experimentally.5,78,79 The model results indicate that in spite of the strong density dependence of the diffusion coefficient and the recombination constant of eqn (21) and (22), the electron density within the semiconductor is fairly homogeneous, under short circuit conditions, except at distances very close to the collecting boundary. This fact explains why the models that do not take trapping or position-dependent processes explicitly into account, including the classical diode equation, are so accurate in reproducing the current–voltage curve.
As the numerical solution of the model is based on a position-dependent electron density function, the model makes it possible to obtain information about the recombination rate within the photoanode. In Fig. 6 the recombination rate is plotted as a function of position, together with the generation profile. It can be observed that the recombination rate resembles the spatial variation of the electron density. As a consequence, the recombination rate is smaller at short distances from the collecting electrode (x = 0) than in the bulk of the film. The vast majority of the recombination losses is hence produced away from the collecting electrode. The introduction of a non-linear recombination process (β < 1) increases the relative contribution of recombination in the vicinity of the collecting boundary, where more electrons are generated. At the maximum power point the recombination profile is almost flat (resembling the electron density profile), and little spatial dependence is found for different β. However, the voltage dependence of eqn (26) makes the fill factor lower for smaller values of the β parameter.
 Fig. 6  Recombination and generation rates as obtained from the numerical solution of the model for the DSC studied in Fig. 3. 
As observed in Fig. 6 the recombination rate is several orders of magnitude smaller than the generation rate. As a consequence, the collection efficiency of the cell at short circuit is very high. The ratio between the number of electrons collected and the number of electrons injected into the semiconductor is defined as the External Circuit Collection Efficiency (ECCE). A value of 99.4% for the ECCE is obtained from the numerical solution of the model. This result can be related to the electron diffusion length in the photoanode. Combining eqn (7), (8) and (21), we can write for the diffusion coefficient: Dn(EF) = D0exp[−(1 − α)e(EF − E0F)/kBT](37)According to Fig. 5, the Fermi level is raised by 0.541 V at x = d with respect to its dark value when the cell is at short circuit. Using β = 0.88, α = 0.2 and D0 = 10−10 cm2 s−1, we obtain a diffusion coefficient of 1.7 × 10−3 cm2 s−1 at short-circuit. Analogously for the recombination constant (see eqn (26)): kn(n) = k0nexp[−(β − α)e(EF − E0F)/kBT](38)Using the same value of the Fermi level (the diffusion length should be determined at the same position of the Fermi level5) and k0n = 8.5 × 10−7 s−1 (as derived from the fitting of the I–V curve: Table 2), we obtain a lifetime at short-circuit of 0.84 s. Using eqn (32) we obtain a diffusion length of 380 μm. This value is several times longer than the film thickness, and confirms the good collection efficiency of the device. Diffusion lengths much longer than the film thickness, even of hundreds of microns for high-efficiency DSC, have already been reported by many authors.5,11,18,80,81 However, it must be borne in mind that the diffusion length concept is only strictly defined in terms of the product of the diffusion coefficient and the lifetime for linear recombination.10 Furthermore, we have estimated the diffusion length at positions away from the collecting electrode. Within the model, this is also a position-dependent quantity. Therefore, this is a mean value of the diffusion length at short-circuit.
3. Time dependent response of the DSC
One of the most relevant features of the numerical model presented here is that it describes correctly the time-dependent response of the device. To show this, we have performed a “numerical” experiment similar to the Stepped Light Induced Transient method developed by Nakade et al.82 Following a similar strategy we apply an increase of 10% in the illumination intensity at a certain time, once the cell is in its stationary state at short circuit. This is a perturbation of the same order of magnitude as that used in IMPS/IMVS experiments.50 The system is then allowed to relax to the new illumination conditions until a new steady-state is reached. Results for different base-line illumination intensities are presented in Fig. 7.
 Fig. 7  Light induced transients at different base-line intensities as obtained from the numerical model for the DSC of Fig. 3. The inset contains the diffusion coefficients extracted from the exponential fittings of the transients, as indicated in the text. 
The numerical model produces a photocurrent transient which is related to the diffusion kinetics of electrons in the semiconductor. As the illumination intensity increment corresponds to a small-perturbation with respect to the base line illumination intensity, the transient is monoexponential and can be described very accurately by a single time constant, in the spirit of the small-perturbation techniques commonly used for DSC characterization.11,35,50 We have then fitted the transients to an exponential function Jsc/Jsc(max) = 1 − b0exp[−(t − t0)/τtr](39)where t0 is the time when the perturbation is applied and τtr is a “transport” time constant. If we assume that the contribution of recombination is negligible during the transient, the transport constant can be related to the diffusion coefficient via57,72 (40)Results for the diffusion coefficient at different light intensities are included in the inset of Fig. 7. The diffusion coefficient is found to increase with light intensity according to a power law, as predicted by the multiple-trapping theory and the experimental evidence.16 In particular, if we assume that the concentration of free electrons is linearly proportional to illumination intensity,5eqn (11) and (21) predict an exponent of 0.8 for α = 0.2. This compares quite well with the value of 0.82 obtained in the numerical “experiment” of Fig. 7. This result demonstrates that the continuity equation (eqn (20)) based on the total electron density and a density-dependent diffusion coefficient reproduces correctly the time-dependent response of a DSC.
4. Efficiency limitations in a DSC
The results shown in the previous sections indicate that the numerical model utilized here describes correctly the basic physics of a DSC. This provides a good starting point to establish improvement strategies by making predictions for current–voltage curves potentially obtainable in actual devices.
In Table 3, the results of the modeling for the TiO2 solar cell studied in Fig. 3 are extended to different film thicknesses. Collection efficiency remains close to 100% in all cases. Hence, the improvement in the short-circuit photocurrent is due to better light harvesting. On the other hand, the open-circuit photovoltage is found to decrease as the film gets thicker. This is due to an increase of the recombination losses, and it has been observed experimentally.83 As a consequence of the decrease in VOC, the efficiency improvement due to larger photocurrents for thicker devices is reduced. Furthermore, a larger photocurrent implies a larger voltage loss due to series resistance. A simple estimation, based on the assumption that series resistance measured for the reference cell is the same in all cases, is included in the results. However an increase of the series resistance is expected for thicker cells, hence reducing even more the efficiency.
Table 3 Model results for TiO2 solar cells of the type studied in Fig. 3 with different film thickness. The illumination intensity was 100 mW cm−2 (AM1.5) in all cases. The reference cell values (10 μm: Fig. 3) are in italic font. Efficiencies in the first column are estimated assuming a constant fill factor of 0.7. Corrected efficiencies are estimated assuming an additional voltage loss due to series resistance corresponding to RsA = 2 Ω cm2. A constant injection yield of 1.0, and constant dye loading (10−7 mol cm−2) has been assumed in all cases





d/μm
ECCE

J
SC/mA cm−2

V
OC/V

η/%

η/% (corr.)




5
0.993
10.37
0.756
5.5
5.3



10


0.994


15.45


0.748


8.1

—


20
0.994
20.00
0.735
10.3
10.2


30
0.993
21.98
0.726
11.2
10.5


40
0.990
23.02
0.719
11.6
10.8


50
0.988
23.59
0.713
11.8
11.0




As mentioned above, an additional efficiency loss might be occurring in the solar cell due to inefficient electron injection and/or dye regeneration, especially at high voltages. This problem has been addressed recently by Jennings et al.12 (described as a regeneration problem) and Cai et al.76 (described as an injection problem). In both cases this leads to a voltage dependence of the generation rate. This voltage dependence arises from the fact that as the electron Fermi level is raised, the probability of back reaction between electrons and dye cations increases, resulting in poor dye-regeneration by the electron donor in the solution. Jennings et al. demonstrated that this loss process results in deterioration of the fill factor.
In this work, we have introduced this effect in the model by means of a bias-dependent injection yield considered in eqn (13). Note that, as our model is based on the solution of the electronic part of the continuity equation only (approximation 3 in Table 1), a limitation in dye regeneration results in a lower injection yield, which is the relevant parameter in eqn (17). In Fig. 8 a simulation of the effect of this process on the shape of the current–voltage curve is reported. Following Cai et al.76 and Jennings et al.12 we have assumed a simple linear decay of the quantum injection yield with electron density: (41)with the parameter p controlling the decrease in the injection quantum yield as the Fermi level is raised. As observed in Fig. 8 the introduction of the non-constant injection yield makes it possible to reproduce the slight decrease of the photocurrent at voltages just smaller than the voltage at the maximum power point, an observation that the original model was unable to reproduce. (For simplicity, the simulations with a non-constant injection yield were carried out with no series resistance.) The numerical results show that a value of p = 0.001, corresponding to an ∼9% decrease of the injection yield at the maximum power point (MPP), leads to an approximate match with the experimental fill factor. This decrease is of the same order as that reported by Jennings et al.12 for similar TiO2 devices.
 Fig. 8  Current–voltage curve of the solar cell studied in Fig. 3 as obtained from the numerical model with several choices for the bias-dependence of the injection quantum yield. The inset shows the variation of the injection yield with voltage. 
Conclusions
The diffusion and recombination processes in a DSC can be adequately described on the basis of the total density of electrons accumulated within the semiconductor oxide. The model is able to reproduce correctly the steady-state current–voltage curve, the light intensity dependence of the open-circuit photovoltage, and the time-dependent behaviour of the solar cell for trapping and recombination parameters extracted from electrochemical impedance spectroscopy. The fitted parameters provide results consistent with independent measurements of the electron lifetime and the series resistance. As the model is based on the local density dependence of the diffusion coefficient and the pseudo-first order recombination constant, it provides valuable information about the spatial variation of the electron density, the Fermi level and the recombination rate within the photoanode. The model can be used to estimate the thickness dependence of the energy conversion efficiency and the influence of a bias-dependent quantum injection yield, recently reported in the literature. Similar ideas to those utilized in this work can be used to model bulk heterojunction solar cells based on nanostructured organic semiconductors.
Acknowledgements
We thank the Ministerio de Ciencia e Innovación of Spain for funding under project HOPE CSD2007-00007 (Consolider-Ingenio 2010) and CTQ2009-10477, and Junta de Andalucía under projects P06-FQM-01869, P07-FQM-02595 and P07-FQM-02600. Conacyt (México) is gratefully acknowledged for funding under grant number 80002. EP would like to thank ICIQ and ICREA for financial support, as well as the Spanish MINECO for the project CTQ2010-18859. The Generalitat de Catalonia and the European Research Council are also gratefully acknowledged for the 2009-SGR-207 and the project PolyDot, respectively.
References
B. O'Regan and M. Gratzel, Nature, 1991, 353, 737–740 CrossRef CAS .
M. Grätzel, Acc. Chem. Res., 2009, 42, 1788–1798 CrossRef .
M. A. Green, K. Emery, Y. Hishikawa, W. Warta and E. D. Dunlop, Prog. Photovoltaics, 2011, 19, 565–572 Search PubMed .
A. Yella, H.-W. Lee, H. N. Tsao, C. Yi, A. K. Chandiran, M. K. Nazeeruddin, E. W.-G. Diau, C.-Y. Yeh, S. M. Zakeeruddin and M. Grätzel, Science, 2011, 334, 629–634 CrossRef CAS .
L. M. Peter, J. Phys. Chem. C, 2007, 111, 6601–6612 CAS .
A. Hagfeldt, G. Boschloo, L. Sun, L. Kloo and H. Pettersson, Chem. Rev., 2010, 110, 6595–6663 CrossRef CAS .
G. Oskam, Curr. Top. Electrochem., 2004, 10, 141–162 CAS .
P. R. F. Barnes, A. Y. Anderson, J. R. Durrant and B. C. O’Regan, Phys. Chem. Chem. Phys., 2011, 13, 5798 RSC .
P. R. F. Barnes, A. Y. Anderson, M. Juozapavicius, L. Liu, X. Li, E. Palomares, A. Forneli and B. C. O’Regan, Phys. Chem. Chem. Phys., 2011, 13, 3547 RSC .
J. Bisquert and I. Mora-Seró, J. Phys. Chem. Lett., 2010, 1, 450–456 CrossRef CAS .
J. R. Jennings, F. Li and Q. Wang, J. Phys. Chem. C, 2010, 114, 14665–14674 CAS .
J. R. Jennings, Y. Liu and Q. Wang, J. Phys. Chem. C, 2011, 115, 15109–15120 CAS .
J. P. Gonzalez-Vazquez, J. A. Anta and J. Bisquert, J. Phys. Chem. C, 2010, 114, 8552–8558 CAS .
S. Sodergren, A. Hagfeldt, J. Olsson and S. E. Lindquist, J. Phys. Chem., 1994, 98, 5552–5556 CrossRef .
F. Cao, G. Oskam, G. J. Meyer and P. C. Searson, J. Phys. Chem., 1996, 100, 17021–17027 CrossRef CAS .
L. M. Peter and K. G. U. Wijayantha, Electrochem. Commun., 1999, 1, 576–580 CrossRef CAS .
J. Ferber, R. Stangl and J. Luther, Sol. Energy Mater. Sol. Cells, 1998, 53, 29–54 CrossRef CAS .
Q. Wang, S. Ito, M. Gratzel, F. Fabregat-Santiago, I. Mora-Sero, J. Bisquert, T. Bessho and H. Imai, J. Phys. Chem. B, 2006, 110, 25210–25221 CrossRef CAS .
F. Fabregat-Santiago, J. Bisquert, E. Palomares, L. Otero, D. B. Kuang, S. M. Zakeeruddin and M. Gratzel, J. Phys. Chem. C, 2007, 111, 6550–6560 CAS .
G. Schlichthorl, N. G. Park and A. J. Frank, J. Phys. Chem. B, 1999, 103, 782–791 CrossRef .
A. J. Frank, N. Kopidakis and J. van de Lagemaat, Coord. Chem. Rev., 2004, 248, 1165–1179 CrossRef CAS .
M. Penny, T. Farrell and G. Will, Sol. Energy Mater. Sol. Cells, 2008, 92, 24–37 CrossRef CAS .
J. Halme, P. Vahermaa, K. Miettunen and P. Lund, Adv. Mater., 2010, 22, E210–E234 CrossRef CAS .
P. Barnes, A. Anderson, M. Juozapavicius, L. Liu, X. Li, E. Palomares, A. Forneli and B. O’Regan, Phys. Chem. Chem. Phys., 2011, 13, 3547–3558 RSC .
A. Gagliardi, M. A. D. Maur, A. Pecchia and A. D. Carlo, IWCE-13: 2009 13th International workshop on computational electronics, 2009, 65–68 Search PubMed .
K. Miettunen, J. Halme, A.-M. Visuri and P. Lund, J. Phys. Chem. C, 2011, 115, 7019–7031 CAS .
M. Filipič, M. Berginc, F. Smole and M. Topič, Curr. Appl. Phys., 2012, 12, 238–246 CrossRef .
D. Gentilini, A. Gagliardi, M. Auf der Maur, L. Vesce, D. D'Ercole, T. M. Brown, A. Reale and A. Di Carlo, J. Phys. Chem. C, 2011, 116, 1151–1157 Search PubMed .
J. Villanueva-Cab, G. Oskam and J. A. Anta, Sol. Energy Mater. Sol. Cells, 2010, 94, 45–50 CrossRef CAS .
J. A. Anta, F. Casanueva and G. Oskam, J. Phys. Chem. B, 2006, 110, 5372–5378 CrossRef CAS .
J. Villanueva, J. A. Anta, E. Guillén and G. Oskam, J. Phys. Chem. C, 2009, 113, 19722–19731 CAS .
A. C. Fisher, L. M. Peter, E. A. Ponomarev, A. B. Walker and K. G. U. Wijayantha, J. Phys. Chem. B, 2000, 104, 949–958 CrossRef CAS .
J. van de Lagemaat and A. J. Frank, J. Phys. Chem. B, 2000, 104, 4292–4294 CrossRef CAS .
J. A. Anta, J. Nelson and N. Quirke, Phys. Rev. B: Condens. Matter Mater. Phys., 2002, 65, 125324 CrossRef .
J. Bisquert and V. S. Vikhrenko, J. Phys. Chem. B, 2004, 108, 2313–2322 CrossRef CAS .
P. E. deJongh and D. Vanmaekelbergh, Phys. Rev. Lett., 1996, 77, 3427–3430 CrossRef CAS .
J. Bisquert and G. Garcia-Belmonte, J. Phys. Chem. Lett., 2011, 2, 1950–1964 CrossRef CAS .

          J. Nelson, The Physics of Solar Cells, Imperial College Press, 1st edn,  2003 Search PubMed .
D. Gentilini, A. Gagliardi, M. Auf der Maur, L. Vesce, D. D'Ercole, T. M. Brown, A. Reale and A. Di Carlo, J. Phys. Chem. C, 2011, 116, 1151–1157 Search PubMed .

          N. W. Ashcroft and N. D. Mermin, Solid State Physics, Brooks Cole, 1st edn,  1976 Search PubMed .
J. R. Jennings, A. Ghicov, L. M. Peter, P. Schmuki and A. B. Walker, J. Am. Ceram. Soc., 2008, 130, 13364–13372 CAS .
A. Chernikov, S. Horst, T. Waitz, M. Tiemann and S. Chatterjee, J. Phys. Chem. C, 2011, 115, 1375–1379 CAS .
F. Fabregat-Santiago, I. Mora-Sero, G. Garcia-Belmonte and J. Bisquert, J. Phys. Chem. B, 2003, 107, 758–768 CrossRef CAS .
J. A. Anta, I. Mora-Sero, T. Dittrich and J. Bisquert, J. Phys. Chem. C, 2007, 111, 13997–14000 CAS .
J. A. Anta, I. Mora-Sero, T. Dittrich and J. Bisquert, Phys. Chem. Chem. Phys., 2008, 10, 4478–4485 RSC .
F. W. Schmidlin, Bull. Am. Phys. Soc., 1977, 22, 346 Search PubMed .
T. Tiedje and A. Rose, Solid State Commun., 1981, 37, 49–52 CrossRef CAS .
D. Vanmaekelbergh and P. E. de Jongh, Phys. Rev. B: Condens. Matter Mater. Phys., 2000, 61, 4699 CrossRef CAS .
J. Villanueva-Cab, H. Wang, G. Oskam and L. M. Peter, J. Phys. Chem. Lett., 2010, 1, 748–751 CrossRef CAS .
J. Halme, Phys. Chem. Chem. Phys., 2011, 13, 12435 RSC .
M. Küntz and P. Lavallée, J. Phys. D: Appl. Phys., 2004, 37, L5–L8 CrossRef .
M. Küntz and P. Lavallée, J. Phys. D: Appl. Phys., 2003, 36, 1135–1142 CrossRef .
L. J. Gosting and H. Fujita, J. Am. Chem. Soc., 1957, 79, 1359–1366 CrossRef CAS .
B. S. Cao and M. K. Lei, Phys. Rev. B: Condens. Matter Mater. Phys., 2007, 76, 212301 CrossRef .
P. Bántay and I. M. Jánosi, Phys. Rev. Lett., 1992, 68, 2058–2061 CrossRef .
J. Bisquert, J. Phys. Chem. B, 2004, 108, 2323–2332 CrossRef CAS .
N. Kopidakis, E. A. Schiff, N.-G. Park, J. van de Lagemaat and A. J. Frank, J. Phys. Chem. B, 2000, 104, 3930–3936 CrossRef CAS .
J. van de Lagemaat and A. J. Frank, J. Phys. Chem. B, 2001, 105, 11194–11205 CrossRef CAS .
J. Bisquert, F. Fabregat-Santiago, I. Mora-Seró, G. Garcia-Belmonte and S. Giménez, J. Phys. Chem. C, 2009, 113, 17278–17290 CAS .
K. Zhu, E. A. Schiff, N.-G. Park, J. van de Lagemaat and A. J. Frank, Appl. Phys. Lett., 2002, 80, 685 CrossRef CAS .
J. Bisquert, Phys. Chem. Chem. Phys., 2003, 5, 5360–5364 RSC .
P. Salvador, M. G. Hidalgo, A. Zaban and J. Bisquert, J. Phys. Chem. B, 2005, 109, 15915–15926 CrossRef CAS .
J. W. Ondersma and T. W. Hamann, J. Am. Chem. Soc., 2011, 133, 8264–8271 CrossRef CAS .
J. R. Jennings and Q. Wang, J. Phys. Chem. C, 2010, 114, 1715–1724 CAS .

          R. Memming, Semiconductor Electrochemistry, Wiley-VCH, 1st edn,  2001 Search PubMed .
N. Kopidakis, K. D. Benkstein, J. van de Lagemaat and A. J. Frank, J. Phys. Chem. B, 2003, 107, 11307–11315 CrossRef CAS .
J. Nelson, Phys. Rev. B: Condens. Matter Mater. Phys., 2003, 67, 155209 CrossRef .

          W. H. Press, S. A. Teukolsky, W. T. Vetterling and B. P. Flannery, Numerical Recipes in Fortran 90, Cambridge University Press, 2nd edn,  1996, vol. 2 Search PubMed .
N. J. Harrick, J. Appl. Phys., 1956, 27, 1439–1442 CrossRef CAS .
J. Bisquert, J. Phys. Chem. B, 2002, 106, 325–333 CrossRef CAS .
E. Guillen, J. Idigoras, T. Berger, J. Anta, C. Fernandez-Lorenzo, R. Alcantara, J. Navas and J. Martin-Calleja, Phys. Chem. Chem. Phys., 2011, 13, 207–213 RSC .
L. Dloczik, O. Ileperuma, I. Lauermann, L. M. Peter, E. A. Ponomarev, G. Redmond, N. J. Shaw and I. Uhlendorf, J. Phys. Chem. B, 1997, 101, 10281–10289 CrossRef CAS .
A. Reynal, A. Forneli and E. Palomares, Energy Environ. Sci., 2010, 3, 805–812 CAS .
E. Guillén, L. M. Peter and J. A. Anta, J. Phys. Chem. C, 2011, 115, 22622–22632 Search PubMed .
J. R. Jennings, A. Ghicov, L. M. Peter, P. Schmuki and A. B. Walker, J. Am. Chem. Soc., 2008, 130, 13364–13372 CrossRef CAS .
J. Cai, N. Satoh and L. Han, J. Phys. Chem. C, 2011, 115, 6033–6039 CAS .
S. E. Koops, B. C. O’Regan, P. R. F. Barnes and J. R. Durrant, J. Am. Chem. Soc., 2009, 131, 4808–4818 CrossRef CAS .
K. Lobato, L. M. Peter and U. Wurfel, J. Phys. Chem. B, 2006, 110, 16201–16204 CrossRef CAS .
G. Boschloo and A. Hagfeldt, J. Phys. Chem. B, 2005, 109, 12093–12098 CrossRef CAS .
J. Navas, E. Guillén, R. Alcántara, C. Fernández-Lorenzo, J. Martín-Calleja, G. Oskam, J. Idígoras, T. Berger and J. A. Anta, J. Phys. Chem. Lett., 2011, 1045–1050 CrossRef CAS .
M. Wang, P. Chen, R. Humphry-Baker, S. M. Zakeeruddin and M. Gratzel, ChemPhysChem, 2009, 10, 290–299 CrossRef CAS .
S. Nakade, T. Kanzaki, Y. Wada and S. Yanagida, Langmuir, 2005, 21, 10803–10807 CrossRef CAS .
S. Ito, S. M. Zakeeruddin, R. Humphry-Baker, P. Liska, R. Charvet, P. Comte, M. K. Nazeeruddin, P. Pechy, M. Takata, H. Miura, S. Uchida and M. Gratzel, Adv. Mater., 2006, 18, 1202–1205 CrossRef CAS .

Footnote† Electronic supplementary information (ESI) available. See DOI: 10.1039/c2cp40719aThis journal is © the Owner Societies 2012
Table Content:
J = J(V)	(1)
J = Jsc − J0(exp(eV/mkBT) − 1)	(2)

 	Fig. 1  Left: illustration of the conditions of accumulation of total electron density in the semiconductor in a dye-sensitized solar cell under illumination at different points of the current voltage curve. Right: illustration of the multiple-trapping model: electron transport is assumed to occur via an extended state Ec, but it is slowed down by trapping and detrapping events to and from localized states (shown as thin arrows) with energies distributed along a certain density of states g(E). This mechanism results in an effective diffusion coefficient that depends on the quasi-Fermi energy EF or on the electron density. In addition, recombination processes between electrons and tri-iodide ions and dye cations can occur in the cell under operation (shown as a thick arrow), both for electrons present in the conduction band and in the localized states.	 
n0c = Ncexp(−E0F/kBT)	(3)
nc(x) = Ncexp(−EF(x)/kBT)	(4)
	(5)
	(6)
n(x) = Ntexp(−αEF(x)/kBT)	(7)
n0 = Ntexp(−αE0F/kBT)	(8)
	(9)
	(10)
	(11)
	(12)
	(13)
	(14)
	(15)
	(16)
	(17)
	(18)
	(19)
	(20)
	(21)
	(22)
	(23)
	(24)
	(25)
kn(n) = k0nexp{−(β − α)[EF − E0F]/kBT}	(26)
	(27)
kn(n) = k0nexp{−b[EF − E0F]/kBT}	(28)
kn ∼ Dn	(29)

 	Fig. 2  Scheme of the numerical procedure utilized to obtain the current–voltage curve from the numerical solution of the continuity equation based on the total density (eqn (20)–(22)). Once steady-state is reached (signaled by a constant value of the photocurrent) an electron density profile is produced within the semiconductor (between x = 0 and x = d, where d is the film thickness). The boundary conditions impose zero current at x = d, and a density at time zero and at the contact (x = 0) given by eqn (10). The current is obtained from the gradient of the density profile at the contact. By varying the applied bias V from zero to open-circuit conditions (zero current), the full current–voltage curve can be calculated.	 
Approximation 1	Charge transport occurs only by diffusion
Approximation 2	Electron density and Fermi level are related by Boltzmann statistics
Approximation 3	The I–V curve is determined by the electronic part only
Approximation 4	A quasi-static equilibrium holds between free and trapped electrons
Assumption 1	Electron traps exist in the nanostructured semiconductor
Assumption 2	Traps in the semiconductor fit to an exponential distribution of energies
Assumption 3	Electron transport occurs according to the multiple-trapping model
Assumption 4	Effective diffusion coefficient, pseudo-first order recombination constant, and electron diffusion length correspond to quantities measured by small-perturbation techniques
	(30)
Ln = (D0/k0)1/2 = (D0τ0)1/2	(31)
Ln = (Dn/kn)1/2	(32)
Ln = (D0/k0)1/2(n/n0)(1−β)/2α	(33)

 	Scheme 1  Comparison between linear (β = 1) and sub-linear (β < 1) recombination kinetics.	 
	(34)
	(35)
	(36)

 	Fig. 3  Current–voltage curve of an 8.5% efficient TiO2 solar cell sensitized with C101 Ru-dye in an organic solvent electrolyte. The parameter α required in eqn (21) and (22) is extracted from impedance spectroscopy capacitance measurements at different applied bias. The parameter β (eqn (22)) is obtained from the slope of the recombination resistance versus applied bias in the impedance spectra (solid lines) or from the slope of the open-circuit voltage versus light intensity (dashed-dotted line). Dashed line corresponds to the result of including an external series resistance to the model. The illumination intensity was 100 mW cm−2 (AM1.5).	 

 	Fig. 4  Same as Fig. 3 but for the current–voltage curve of a 2.7% efficient ZnO solar cell sensitized with the D149 dye in an organic solvent electrolyte. In this case a single β value has been used, extracted from the VOC−ln(I/I0) curve. The illumination intensity was 100 mW cm−2 (AM1.5).	 

TiO2 cell (0.16 cm2, 8.5% efficiency, 1 sun AM1.5), d = 10 μm, D0 = 10−10 cm2 s−1

α
	0.195 (EIS)	0.2	—

β
	0.598 (EIS)	0.60/0.88	—

m
	1.13 (Vocvs. ln I)	1.19	—

R
s
A
	2.16 (EIS)	4.8	Ω cm2

τ

n
 (VOC)	∼0.005 (OCVD)	0.0035/0.0038	seconds
Dye loading	 	1.0 × 10−7/1.1 × 10−7	mol cm−2
ZnO cell (0.64 cm2, 2.7% efficiency, 1 sun AM1.5), d = 10 μm, D0 = 10−7 cm2 s−1

α
	0.13 (EIS)	0.2	—

β
	0.55 (EIS)	0.7	—

m
	1.35 (Vocvs. ln I)	1.27	—

R
s
A
	11.5 (EIS)	30	Ω cm2

τ

n
 (VOC)	∼6 × 10−3	4.4 × 10−4	seconds
Dye loading	3.5 × 10−8 (adsorption)	4.3 × 10−8	mol cm−2

 	Fig. 5  Total electron density profile (top) and quasi-Fermi level profile (bottom) at steady-state for the DSC studied in Fig. 3. The Fermi level shift between short-circuit (solid line) and open-circuit (dashed line) conditions is shown in the graph. Note that densities are normalized with respect to their value at the contact x = 0.	 

 	Fig. 6  Recombination and generation rates as obtained from the numerical solution of the model for the DSC studied in Fig. 3.	 
Dn(EF) = D0exp[−(1 − α)e(EF − E0F)/kBT]	(37)
kn(n) = k0nexp[−(β − α)e(EF − E0F)/kBT]	(38)

 	Fig. 7  Light induced transients at different base-line intensities as obtained from the numerical model for the DSC of Fig. 3. The inset contains the diffusion coefficients extracted from the exponential fittings of the transients, as indicated in the text.	 
Jsc/Jsc(max) = 1 − b0exp[−(t − t0)/τtr]	(39)
	(40)

5	0.993	10.37	0.756	5.5	5.3

10
	
0.994
	
15.45
	
0.748
	
8.1
	—
20	0.994	20.00	0.735	10.3	10.2
30	0.993	21.98	0.726	11.2	10.5
40	0.990	23.02	0.719	11.6	10.8
50	0.988	23.59	0.713	11.8	11.0
	(41)

 	Fig. 8  Current–voltage curve of the solar cell studied in Fig. 3 as obtained from the numerical model with several choices for the bias-dependence of the injection quantum yield. The inset shows the variation of the injection yield with voltage.	 
Footnote
† Electronic supplementary information (ESI) available. See DOI: 10.1039/c2cp40719a

This journal is © the Owner Societies 2012
