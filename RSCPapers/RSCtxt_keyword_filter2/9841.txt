Computer calculations across time and length scales in photovoltaic solar cells  - Energy & Environmental Science (RSC Publishing) DOI:10.1039/C6EE01010E View PDF VersionPrevious ArticleNext Article  DOI: 10.1039/C6EE01010E
(Review Article)
Energy Environ. Sci., 2016, 9, 2197-2218Computer calculations across time and length scales in photovoltaic solar cells

        
          
            Marco 
            Bernardi
          
          
        
      *a and 

        
          
            Jeffrey C. 
            Grossman
          
          
        
      *b
aDepartment of Applied Physics and Materials Science, California Institute of Technology, 1200 E. California Blvd, Pasadena CA 91125, USA. E-mail: bmarco@caltech.edu
bDepartment of Materials Science and Engineering, Massachusetts Institute of Technology, 77 Massachusetts Avenue, Cambridge MA 02139, USA. E-mail: jcg@mit.edu
Received 
      6th April 2016
    , Accepted 5th May 2016First published on 5th May 2016AbstractPhotovoltaic (PV) solar cells convert solar energy to electricity through a cascade of microscopic processes spanning over 10 order of magnitudes of time and length. PV conversion involves a complex interplay of photons, charge carriers, and excited states. Processes following light absorption include generation of charge carriers or excitons, exciton dissociation over nanometer lengths and subpicosecond times, and carrier transport over ns–ms times and nm–mm lengths. Computer calculations have become an indispensable tool to understand and engineer solar cells across length and time scales. In this article, we examine the microscopic processes underlying PV conversion and review state-of-the-art computational methods to study PV solar cells. Recent developments and future research challenges are outlined.
Marco Bernardi
Marco Bernardi is Assistant Professor in the Department of Applied Physics and Materials Science at Caltech. He obtained his BS in Materials Science from the University of Rome in 2008, and his PhD in Materials Science in 2013 from MIT, where he worked with Prof. Jeff Grossman on novel materials and physical processes in solar energy conversion. He was a postdoctoral researcher between 2013–2015 in the Physics Department of UC Berkeley. He received the 2015 Psi-K Volker Heine Young Investigator Award and the Intel PhD Fellowship, among other awards. His research has been featured in a number of magazines, including Wired, Nature, Scientific American, and Technology Review. His group at Caltech focuses on computing the dynamics of excited states in materials, with applications to ultrafast optical processes and solar energy conversion.
Jeffrey C. Grossman
Jeffrey C. Grossman is a Professor in the Department of Materials Science and Engineering at the Massachusetts Institute of Technology. He received his PhD in theoretical physics from the University of Illinois, performed postdoctoral work at UC Berkeley, was a Lawrence Fellow at the Lawrence Livermore National Laboratory, and joined MIT in fall, 2009. Dr Grossman's group uses a combination of modeling and experiment to gain fundamental understanding, develop new insights based on this understanding, then use these insights to develop new materials with improved properties for energy conversion, energy storage, and clean water technologies. Prof. Grossman has been named a MacVicar Fellow of MIT, recognizing his contributions to engineering education, and he has been named a Fellow of the American Physical Society. He has published more than 150 scientific papers, and holds 17 current or pending U.S. patents.
1 Introduction
Motivated by the availability of abundant solar energy and pressed by the need to meet the ever-rising global energy demand while facing rapid worldwide population growth, technologies capable of converting solar energy to heat and electricity remain at the center of technological innovation and scientific research.1 Among these, photovoltaic (PV) solar cells have reached a great level of sophistication and have the potential to provide a significant fraction of renewable energy in the near future. PV devices convert solar energy to electricity using combinations of semiconducting sunlight absorbers and metallic materials as electrical contacts. Enormous advances in large-scale high purity silicon fabrication have dramatically lowered the module cost of PV to 60 cents per Watt at the time of writing. This tremendous silicon PV learning curve has resulted in the balance of systems now dominating the total cost (∼80% of the total cost for a typical residential installations). Yet, despite these advances, further reductions in cost are still needed in order to make grid parity ubiquitous. Towards this end, the role of simulation is poised to play a critical role as new materials, new interfaces, and new device architectures are needed in order to lower installation costs, e.g., by moving to flexible substrates while maintaining high efficiencies and robust operation. In addition to the mainstream Si solar cells that dominate current PV installations, a range of solid-state PV technologies are being investigated, including thin film GaAs, CdTe, CIGS, amorphous Si,2 and more recently metal–organic perovskites.3 Molecular and nanostructured active layers maintain a central role in solar cell research despite their lower efficiencies to date compared to bulk inorganic materials. These PV technologies include materials such as conjugated polymers and small molecules,4,5 quantum dots (QDs),6–8 dye-sensitized TiO2,9,10 and carbon nanomaterials.11–13
The physics of PV devices focuses on understanding the energetics and dynamics of the charge carriers (electrons and holes) and excited states (excitons, phonons, and in some cases surface plasmons) involved in the photon conversion process. Computational approaches to solve Schrödinger's equation for electrons and Maxwell's equation for light in materials are well-suited to investigate the physical processes underlying solar energy conversion.
However, modeling solar cells is challenging due to the multiple time and length scales at play; different theories, equations, and approximations are necessary to investigate physical processes occurring on different length and time scales in solar cells. For example, computing the electronic structure of a nanostructured interface requires a quantum mechanical treatment of the electrons, while sunlight absorption in a macroscopic assembly of solar panels and mirrors can be studied with classical optics. In all cases, the relevant equations can be solved numerically using hardware ranging from laptops to small computer clusters and high-performance supercomputers, depending on the problem at hand. Computational approaches employed to study PV are highly flexible, and can further capture the atomistic details of materials, provide high accuracy, reproducibility, and automation.
In this article, we discuss the microscopic processes taking place in PV conversion for different materials families, with an emphasis on the time and length scales involved. We review the computational methods available to study these processes and understand the microscopic origin of PV efficiency. Examples of calculations involving different time and length scales are given, along with a perspective for future directions in computer calculations for PV solar cells.
2 Physical processes in photovoltaics
2.1 Conventional and excitonic solar cells
The Sun emits 5800 K blackbody radiation as a result of thermonuclear fusion of hydrogen in its core. Earth intercepts a small fraction of this emitted solar energy, with absorption and scattering in the atmosphere modifying the incident solar spectrum and intensity. While solar irradiance depends on latitude, season, altitude and weather, a convenient reference for solar illumination is the AM1.5 solar spectrum, which corresponds to solar radiation passing through 1.5 times the thickness of the atmosphere, with a total power of 1 Sun (1 kW m−2 or 100 mW cm−2).† The AM1.5 spectrum14 is useful in numerical calculations and can be reproduced in the laboratory by solar simulators employed to test solar cells. Photons with a range of energies (∼0.3–4 eV) and incident directions reach the surface of a solar cell, and are absorbed, reflected, or transmitted depending on the properties of the active layer materials and coatings.
PV devices are typically divided into conventional solar cells (CSCs)2,15 and excitonic solar cells (XSCs)16,17 depending on their active layer material. The device architecture and physical processes regulating PV conversion in CSCs and XSCs differ significantly (see Fig. 1). Typical CSCs are constituted by junctions between inorganic semiconductors, such as planar p–n junctions in Si or GaAs and heterojunctions in CdTe and CIGS active layers. Since the dielectric permittivity ε of inorganic semiconductors is relatively large (e.g., ε ≈ 12 in Si), the Coulomb interaction between photogenerated electrons and holes is weak due to the large screening, leading to typical electron–hole binding energies in CSCs lower than kBT (∼25 meV at room temperature). Sunlight absorption thus leads directly to free carrier generation in CSCs, with carrier transport in the active layer and extraction at metallic contacts completing PV conversion. In a conventional Si solar cell, electron and hole transport is driven by an electrochemical potential gradient in a depletion layer of a few μm thickness at the p–n junction.15 The upper limit for the current generated in CSCs is given by the absorbed photon flux, and the fraction of photogenerated minority carriers (e.g., electrons in the p-type material) injected across the junction before recombining with majority carriers determines the current observed in practice.
 Fig. 1  Comparison of conventional and excitonic solar cells. Conventional solar cells (left) are based on p–n junctions or heterojunctions of crystalline inorganic materials, such as Si and GaAs, connected to an external circuit with metallic electrodes. Excitonic solar cells (right) are based on interfaces between two materials, called the donor and the acceptor, to dissociate strongly bound excitons and generate charge carriers in the active layer. One electrode is typically a transparent conductive oxide (TCO) coated with buffer layers for additional charge and exciton management. The inset shows the type-II alignment of the VBM and CBM levels required for exciton dissociation. 
In contrast, XSCs are typically based on semiconducting organic molecules and/or nanomaterials with weak dielectric screening. In organic semiconductors, the relatively small dielectric permittivity (ε ≈ 2–3) is a consequence of the low electron density typical of van der Waals bonded systems, while in nanomaterials such as quantum dots, nanowires, nanotubes, and two-dimensional semiconductors the vacuum in the region surrounding the system leads to an overall reduced screening. A photogenerated electron-hole pair interacting through a weakly screened Coulomb interaction forms a bound state in XSCs, known as exciton, with typical binding energies of 0.3–1 eV, in large excess of kBT. Excitons can be visualized as mobile, charge-neutral species unaffected by electric fields to a first approximation.18,19 The smallest energy for exciton formation corresponds to the photoabsorption onset and is called the optical absorption gap, Eopt, which is smaller than the electronic gap Eg needed for the formation of a free electron–hole pair, the difference of the two being equal to the (positive) binding energy Eb of the lowest-energy exciton, Eb = Eg − Eopt. In CSCs, on the other hand, the optical and electronic gaps differ by a negligible amount of order kBT. Due to the presence of strongly bound excitons, XSCs first need to dissociate excitons in order to generate free carriers, and only then can carrier transport to the electrodes occur similar to CSCs. We emphasize that sunlight absorption in XSCs does not lead directly to charge carriers, and the extra step of exciton dissociation represents a significant technological barrier toward efficient PV conversion in XSCs. A comparison between conventional and excitonic solar cells is given in Fig. 1.
Exciton dissociation is typically performed in XSCs using donor–acceptor (D–A) heterojunctions, in which a staggered (so-called type-II) band alignment is established between the valence band maximum (VBM) and conduction band minimum (CBM) energies of two semiconducting materials. The semiconductor with the higher CBM energy (i.e., the smaller electron affinity) is called the donor, and the other semiconductor the acceptor.‡ Upon illumination, excitons formed close to the type-II heterojunction can be dissociated with a cross section determined by the D–A materials and dynamical conditions. Exciton dissociation generates an electron in the acceptor and a hole in the donor, regardless of which material absorbed the photon. A well-known example of XSC active layer material is a mixture of a conjugated polymer, such as P3HT (the donor), and C60 fullerene (the acceptor). The energetics and dynamics of exciton dissociation are discussed in detail below.
The active layer of XSCs is usually constituted by a random mixture of the donor and acceptor in the so-called bulk heterojunction morphology,4 which aims to maximize the fraction of excitons reaching the D–A interface by providing nm-size domains of interconnected donor and acceptor phases. This is particularly important given that exciton diffusion lengths are typically short, of order ∼10 nm. Alternatively, a mesoporous acceptor with a thin donor layer adsorbed on the surface can be employed, as in the case of the so-called dye-sensitized solar cells.20,21 In such a configuration, excitons are formed directly at the D–A interface since the light absorbing donor is a molecular monolayer adsorbed on the acceptor phase. Planar (so-called bilayer) D–A junctions are also possible, but their efficiency is severely limited by the short exciton diffusion lengths.
Carrier generation at the D–A interface of XSCs is followed by carrier transport in the active layer and extraction at the electrodes, similar to the case of CSCs. The additional exciton dissociation step restricts the current to the fraction of excitons successfully dissociated at the D–A junction, and complicates carrier transport in the active layer due to the complex morphology of the D–A phases. In addition, careful choice of electron- and hole-conducting buffer layers placed between the active layer and the metallic contacts is necessary to optimize carrier extraction. The role of buffer layer materials is often not completely understood, and their choice optimized experimentally by trial and error.
While Si and conjugated polymers are clear-cut cases of, respectively, materials for conventional and excitonic solar cells, other materials with exciton binding energy of order 50–100 meV appear to fall in between these categories. This is the case, for example, for solar cells utilizing quantum dots of Pb or Cd chalcogenides (e.g., PbS, PbSe, CdS, CdTe, etc.),6,7 in which the bulk material has a ∼5 meV binding energy that increases up to 100 meV for quantum dots with radii of a few nm.19 Bulk materials can also display exciton binding energies of order kBT, as is the case for methylammonium lead iodide perovskite, a compound with an estimated exciton binding energy of ∼25 meV.22,23 In such intermediate cases, excitons and free carriers may co-exist in dynamical equilibrium upon illumination, although treating the device as a CSC is satisfactory to a first approximation. Lastly, we note that device architectures can be significantly more complex than those in Fig. 1, and refer the reader to ref. 2, 4, 6, 21 and 24 for detailed discussions.
2.2 Time and length scales in solar cells
It takes 8 minutes for a photon emitted from the Sun to reach a solar cell on Earth. Sunlight absorption initiates a cascade of microscopic processes spanning multiple time and length scales, as shown in Fig. 2. Light absorption can be managed and optimized by engineering solar cells from the nm to the meter scale, using a variety of strategies such as: (1) increasing the optical absorption of the active layer by designing its atomistic and electronic structure,25,26 (2) increasing the electric field in the active layer by means of metallic nanostructures27,28 or macroscopic concentrators,29 and (3) optimally orienting the solar panels with respect to the apparent solar trajectory.30
 Fig. 2  Time and length scales of microscopic processes in solar cells. Processes involved in PV conversion, including sunlight absorption, exciton formation, thermalization, and dissociation, and carrier transport and extraction. Different simulation techniques are employed to model processes at different length and time scales. Exciton formation, diffusion and dissociation are absent in CSCs due to the direct formation of charge carriers upon sunlight absorption. 
Relatively small carrier (in CSCs) or exciton (in XSCs) concentrations are formed upon sunlight absorption. For PV active layers with typical absorption coefficients of 103–105 cm−1, steady-state carrier/exciton densities of 1014–1016 cm−3 are generated, corresponding to one excited state formed every 1–100 s in a 1 nm3 volume, namely the volume of a small molecule or crystal unit cell. Since one second is very long compared to the ns–ms carrier/exciton recombination lifetime, our analysis shows that solar radiation at the microscopic scale is diluted, meaning that, for example, a typical molecular absorber in an XSC sits in the ground state for over 99% of the time under solar illumination.
At the sub-ps time scale, multiple processes occur following sunlight absorption, including carrier/exciton formation and thermalization, and exciton dissociation in XSCs. The time to form photoexcited carriers/excitons for a typical PV material with a band gap of Eg ≈ 2 eV can be estimated to be ℏ/Eg ≈ 0.1 fs, an extremely short time. The carrier population generated by sunlight absorption has an energy distribution dictated by the solar spectrum and the absorption of the material. For the ideal case of a sunlight pulse absorbed by Si, a pocket of excited (so-called hot) electrons is generated in the conduction band spanning a 2 eV range above the CBM.11 Similar considerations apply to excited holes formed with a distribution of energies below the VBM. The surplus energy, given by the difference between the electron or hole energy and the conduction or valence band edge, respectively, is rapidly lost through sub-ps inelastic electron–phonon and electron–electron scattering processes.31,32 The hot carrier equilibration process, known as hot carrier thermalization, is associated with a significant loss of solar energy. For the case of Si under AM1.5 solar illumination, the average absorbed photon energy is 1.8 eV, a third of which is rapidly lost to heat as the hot carriers thermalize to the edges of the ∼1.2 eV band gap in a time of approximately 350 fs.32 This analysis shows that nearly a third of absorbed solar energy is very rapidly lost to heat in a Si solar cell.32
Exciton thermalization in XSC molecular materials occurs on a sub-ps time scale. Exciton thermalization, also called internal conversion, is a complex process due to the role of spin and the possible presence of intersecting potential energy surfaces. Excitons generated by Franck–Condon transitions rapidly lose energy and evolve toward the ground vibrational state of the excited potential energy surface via phonon emission, a process analogous to carrier thermalization in CSCs. Multiple intersecting potential energy surfaces can exist in molecules; during thermalization, the molecular system may cross a conical intersection between potential energy surfaces and undergo a conformational change to a long-lived excited state, as is observed for example in the cis–trans conversion in azobenzene.33 In general, excitons formed by photoabsorption conserve the spin of the ground state, and thus are typically spin singlets. A singlet exciton with zero spin can convert into a triplet exciton with unit spin through a process known as intersystem crossing, occurring with appreciable rate in systems with large spin–orbit coupling, as favored by the presence of heavy atoms (e.g., transition metals).34 Alternatively, in materials where the energy of a singlet exciton is greater than the energy of two triplets (e.g., in tetracene), a singlet exciton can undergo singlet fission and convert into two triplet excitons, each hosted by a molecule previously in a singlet state.35 Given that singlet fission can double the number of excitons – and thus the number of carriers and the current, upon exciton dissociation – it has been the focus of intense recent investigations.36,37 A map of exciton relaxation and recombination processes can be defined using Jablonski diagrams.38
In XSCs, excitons can form directly at a type-II D–A heterojunction, or reach it by diffusion. In both cases, the exciton can dissociate into a pair of carriers consisting of an electron in the acceptor and a hole in the donor material (see Fig. 3). The intermediate state in which the electron in the acceptor and hole in the donor are bound across the D–A interface due to the Coulomb attraction is called a charge-transfer (CT) exciton, and plays a key role in carrier generation in XSCs. Recent pump–probe spectroscopy experiments show that excitons formed at D–A heterojunctions can dissociate within 50–100 fs by forming excited (so-called “hot”) CT excitons (see Fig. 3) as intermediates toward delocalized free carriers.39–41 Other measurements42 carried out in a wide range of polymer and small-molecule XSCs show, on the contrary, that the excess energy of hot CT excitons (with respect to the lowest-energy CT exciton) may have a marginal role, and that relaxation to the lowest-energy CT exciton may be faster than charge separation. In this scenario, the efficiency of charge separation is independent of photon energy, given that it occurs from the lowest-energy CT exciton regardless of the excitation energy. This hypothesis is supported by the observation that charge separation efficiency is independent of photon energy and electric field in a wide range of devices explored in ref. 42. The implication that charges may not be generated hot (i.e., with excess energy) in many XSC devices is important. Since recent results43 suggest that hot photo-generated carriers may be extracted in XSC devices before losing their excess energy, future work should aim to understand more completely the role of hot charge-transfer excitons and hot carriers at D–A interfaces and in XSCs in general. In particular, the exact delocalization mechanism of electrons and holes previously interacting across the interface is still somewhat controversial and is likely material-dependent.
 Fig. 3  Energetics and dynamics at type-II D–A heterojunctions in XSCs. The blue and green arrows show, respectively, the charge transfer processes following photoexcitation of semiconductor 1 (SC1, the donor) and semiconductor 2 (SC2, the acceptor) in a type-II heterojunction. The energy of the hot CT states are shown in yellow as a continuum, and the energies of electrons and holes in the ground-state CT0 exciton are shown in purple. Eopt are the optical gaps in the two materials. 
A range of microscopic processes follow carrier generation in solar cells. Carrier transport and recombination are characterized by ns–ms times and nm–mm lengths (see Fig. 2). Carriers in CSCs drift and diffuse under the action of electric fields and concentration gradients, respectively. Within a semiclassical transport model,44 the two main material properties regulating carrier transport are the mobility and diffusion length.45,46 The diffusion length LD depends on the mobility μ and carrier recombination lifetime τrec through , where kB is the Boltzmann constant, T the temperature, and e the electronic charge. The recombination lifetime depends critically on purity and doping, and is generally longer for indirect gap materials than for direct gap materials. Carriers may recombine non-radiatively via defect- or phonon-assisted processes, or radiatively by emitting light in direct gap materials. To maximize carrier extraction efficiency in CSCs and XSCs, it is crucial to have a carrier diffusion length (LD) greater than the absorption length (LA). The absorption length is the inverse absorption coefficient averaged over the solar energy range, and represents the material thickness necessary to absorb a significant fraction of above-gap sunlight.26 An active layer thickness greater than LA is necessary to absorb sunlight effectively, while an active layer thickness smaller than LD is necessary to extract carriers effectively. In an ideal PV material, LD > LA allows one to collect carriers efficiently, and LA < 1 μm enables use of very thin active layers.
In Si, GaAs, CdTe and other inorganic crystalline CSC materials, common room-temperature mobilities are higher than 1000 cm2 V−1 s−1 for electrons and 100 cm2 V−1 s−1 for holes.47 The recombination lifetimes are of order 1 μs–1 ms for Si with purity and doping levels typical in CSCs, and the associated diffusion lengths are of order 10–100 μm.47,48 Due to its indirect band gap, the absorption length in Si is of order 10–100 μm, thus requiring relatively thick active layers. The recombination lifetimes in GaAs are 1 ns–1 ms, and thus shorter than in Si due to the direct band gap of GaAs. The associated diffusion lengths in GaAs are 10–100 μm for both electrons and holes, and the absorption length is ∼100 nm, enabling very thin GaAs solar cells with high efficiency.49 Direct-gap materials such as GaAs are also good light emitters, given that light emission is an indicator of material purity and lack of non-radiative recombination channels.49 Recently synthesized metal–organic perovskites3,10 with diffusion lengths of 1 μm and absorption lengths of ∼100 nm50 can be categorized as CSCs due to the small (∼25 meV) exciton binding energy.22,50 Their high performance stems from carrier diffusion lengths longer than the absorption length,50 as well as unusual defect physics which is not yet completely understood.
Exciton transport in XSCs is usually modeled as a random walk of a localized (Frenkel) exciton19 taking place within the exciton recombination lifetime.51 This model is satisfactory to describe transport in conjugated polymers or small molecules with strongly localized Frenkel excitons, but it breaks down in cases where the exciton radius is comparable to the thickness of the active layer, e.g., in PbS quantum dots.6 If the photogenerated exciton does not dissociate at a D–A interface during the diffusive process, it recombines radiatively or non-radiatively, leading to loss of the absorbed solar energy. The lifetimes and diffusion lengths of excitons in molecular materials and nanostructures vary widely. Typical values for exciton recombination lifetimes in molecular materials are of order 10 ps–10 ns, and typical diffusion lengths are relatively short, of order ∼5–20 nm.52,53 Exceptionally long exciton diffusion lengths of up to 50 μm have been measured in rubrene crystals,54 and exceptionally long lifetimes are found in organic crystals with high purity and crystalline order. The design rules to achieve long-lived excitons in molecular systems are not yet completely understood. In nanomaterials, the exciton lifetime and diffusion length depend critically on size and surface passivation. For example, in single-walled carbon nanotubes the lifetime depends on diameter and chirality and is generally in the 10–100 ps range for non-radiative decay rates, and up to 1 ns for radiative recombination.55
The steps following exciton diffusion in XSCs are carrier generation and transport to the electrodes.4,56 Charge transport in XSCs is a complex multi-scale problem.57,58 Since charge carriers form narrow electronic bands in organic semiconductors, carrier–phonon coupling is strong in these materials and leads to localized carriers known as polarons.59,60 Polarons are mobile charges with a localized wavefunction; they are thermodynamically favorable to form and are associated with a localized distortion of the molecular structure.59,60 Polarons have been the subject of extensive theoretical investigations since the early days of condensed matter physics,61,62 following which more advanced models relying on effective Hamiltonians and quantum field theory have been developed. An excellent review of polaron physics has been published recently.60 Due to the localized nature of polarons, a real-space description of transport in terms of variable-range hopping of localized carriers is common in organic semiconductors and XSCs.57,58,63–65 Alternative models employing master equations66,67 or fully ab initio calculations68,69 have also been employed to compute the mobility of pure organic semiconductors or D–A blends in XSCs. The real-space description in organic semiconductors contrasts with the momentum-space picture adopted in inorganic materials and CSCs to describe delocalized carriers.
In organic XSCs, the molecular structure and morphology of the active layer crucially impact charge transport.51,70–73 Because polaron hopping rates within a given small molecule or polymer chain are typically orders of magnitude faster than inter-molecular hopping processes,59 subtle changes in molecular packing can have a strong effect on charge transport in organic XSCs, and the charge mobility is typically dominated by pathways with the lowest inter-molecular charge transfer rates.51,70 Important factors include the degree of alignment of polymer backbones, crystallinity, and influence of side-chain length and molecular weight on polymer chain conformation.70,72 Major improvements in transport and device performance can be achieved by controlling and optimizing the active layer morphology, both in polymer71,74–76 and small molecule5,73,77,78 organic and in quantum dot inorganic79 XSCs. Mobilities of order 10−7–10−3 cm2 V−1 s−1 and carrier lifetimes of 1 μs–1 ms are common in polymers4,56,70 and nanomaterials,6,80 and the associated diffusion lengths are in the 10 nm–1 μm range. The mobilities and diffusion lengths in XSCs are orders of magnitude lower than those in CSCs, which in turn limits the active layer thickness of XSCs to the sub-μm carrier diffusion length values.15 For example, the active layer thickness in Si and GaAs solar cells are of order 100 μm and 1 μm respectively, and thus greater in both cases than the absorption length. In XSCs with active layers based on organic molecules and/or nanostructures, the active layer thickness is typically 100 nm–1 μm, and thus shorter than the absorption length (1–10 μm in most XSC materials). Such thinner active layers are necessary in most XSCs to guarantee effective carrier extraction, at the cost of incomplete sunlight absorption; this trade-off between carrier extraction and sunlight absorption constitutes a major bottleneck to increase the efficiency of XSCs.
While the widely employed bulk heterojunction morphology can optimize exciton dissociation in XSCs, it has been argued that it is not ideal to attain high efficiencies due to enhanced carrier recombination at the interface between the donor and acceptor phases. The recombination of a pair of as-generated electron and hole carriers at the D–A interface in XSCs, also known as geminate recombination,81 typically causes a fast decay in carrier population on a sub ns–ns time scale.81–85 On the other hand, the so-called bimolecular recombination, taking place on a longer time scale of ∼1–10 ns, has been shown to be the dominant recombination mechanism in several organic XSCs.82–84 Other authors arrived at the opposite conclusion that in some XSCs geminate recombination is dominant under sunlight illumination.85 While in some systems it has been reported that geminate recombination takes place in tens of nanoseconds,86 in other systems it happens much more quickly, on a sub-ns time scale.85 The physics of free charge generation in XSCs has been the focus of much research to quantify the relative importance of geminate and bimolecular recombination (for example, see ref. 81 and 85 and references therein). Based on the existing literature, it appears that charge generation and recombination in XSCs depend strongly on the material and its nanoscale morphology.81,82 Lastly, we note that an ideal organic XSC would consist of a D–A bilayer in which the donor and acceptor materials possess very long (e.g., 1–10 μm) exciton and carrier diffusion lengths, though such a combination of properties has thus far been elusive to realize.
In summary, sub-ps times and nm lengths characterize generation and thermalization of carriers and excitons, while transport of carriers occurs over longer times and lengths of up to 1 ms and 1 mm, respectively. We note that processes occurring on longer time scales are associated with longer length scales. A curious conclusion of this analysis is that given the ∼1–10 ms time and ∼1–100 μm length scales for carrier extraction, an overall rate for solar energy conversion can be estimated as 1–10 mm s−1. This slow rate characteristic of solar energy conversion in a PV device is, incidentally, close to the ∼10 mm s−1 exit speed of ketchup from a glass bottle.§ One can thus picture PV operation as the extraction of solar energy at the rate of extraction of ketchup from a glass bottle.
2.3 Solar cell performance
We summarize the main quantities employed to characterize solar cell performance and operation.15 Since PV solar cells convert solar energy to electricity, their power conversion efficiency (PCE) can be defined as the ratio of output electrical to incident solar power under AM1.5 illumination:14 (1)where Jsc is the short-circuit current density (units of mA cm−2), Voc is the open-circuit voltage (units of V), FF is the fill factor (a unitless number), and Pin is the AM1.5 solar irradiation of 100 mW cm−2. The current, voltage, and fill factor provide insight into the physical processes occurring in the device, and constitute quantities of key interest in comparing calculations with experiments in PV.
The maximum short-circuit current Jsc,max depends on the optical properties and geometry of the active layer. It can be computed as the absorbed photon flux – expressed in terms of the equivalent electrical current – for the limit case in which every photon is converted to an extracted carrier: (2)where E is the photon energy, Jph is the incident AM1.5 photon flux, and A(E) is the absorbance of the active layer, namely the fraction of absorbed photons at energy E. For the simple case of a flat active layer of thickness L, absorption coefficient α(E), and for p passes of light with normal incidence, the absorbance is A(E) = 1 − exp[−pα(E)L]. The absorption coefficient α(E), a property of the active layer material, can be engineered to achieve high absorption at energies with high solar flux, within limits dictated by optical sum rules.26Eqn (2) is important since the absorption coefficient α(E) (and thus Jsc,max for an ideal geometry) can be computed using first-principles electronic structure calculations, as discussed below.
As seen from eqn (2), sunlight absorption is limited to photon energies above the optical gap, so that the available current decreases for increasing Eopt, assuming a fixed above-gap absorbance. A total current of 68.9 mA cm−2 is available under AM1.5 illumination to an ideal black absorber with Eopt = 0 and A = 1. Roughly 58% of the maximum current is associated with infrared photon energies of less than 1.5 eV, while 40% of the maximum current derives from visible photons with 1.5–3.2 eV energy and only 2% from UV photons with energy greater than 3.2 eV.
Out of the absorbed Jsc,max photon current, only a fraction results in the device short-circuit current Jsc, depending on carrier extraction efficiency. While absorbance increases for increasing active layer thickness, in a real device a trade-off is needed to optimize thickness, since thicker active layers require higher carrier mobilities for effective carrier extraction. The energy-dependent internal quantum efficiency (IQE), defined as the ratio of the electrical short-circuit current to the absorbed photon flux under monochromatic illumination with photons of energy E, quantifies the efficiency for transporting and extracting photogenerated carriers. We can thus write Jsc as: (3)High IQE values near 100% indicate a balance between active layer thickness and carrier mobility, a low density of defects and traps, and efficient carrier injection into the contacts.
While our analysis for Jsc applies to both CSCs and XSCs, the open circuit voltage on the other hand depends critically on the type of solar cell considered. Modeling Voc is typically more challenging than modeling Jsc. A variety of models have been proposed and applied, yet voltage in solar cells is often predicted using heuristic arguments. In CSCs, Voc is limited by the electronic gap of the active layer material, and is numerically equal to the separation of the quasi-Fermi electron and hole levels.15 The resulting Voc values are typically 0.3–0.4 eV lower than the band gap even in CSC devices with efficient transport, both due to the inconvenience of doping the p and n layers degenerately15 and to subtle effects (currently under debate) associated with the entropy difference between the absorbed and emitted sunlight.27 In XSCs, the electronic gap Δ at the D–A interface (see Fig. 3) constitutes the upper limit for Voc, since it corresponds to the difference between the energy levels of the extracted electrons and holes. This interface gap can be computed as the difference between the VBM energy of the donor and the CBM energy of the acceptor. In many devices, Voc has shown a linear dependence on both the donor's VBM and the acceptor's CBM, thus indicating that Voc is proportional to Δ minus a loss term of order 0.3–0.7 eV,78,87 where the loss term is commonly attributed to electron–hole recombination in the active layer or at the contacts. Recombination is in general more severe in XSCs compared to CSCs due to large ratios between the D–A interface area and the macroscopic solar cell area.
The third quantity entering the definition of PCE in eqn (1) is the fill factor (FF), defined as the ratio between the power generated by the solar cell and the Jsc·Voc product. FF is a variable combining multiple effects linked to transport: in general, it decreases for increasing series resistance of the active layer, and is thus lowered by recombination, traps, and impurities. Typical FF values in good CSCs can be higher than 0.8, while the FF values in XSCs are in the 0.3–0.6 range, with maximum reported values of up to 0.75 for organic XSCs.88
Lastly, we remark that a practical limit exists for the PCE of a “typical” solar cell, known as the Schockley–Queisser (SQ) limit.89 It imposes a maximum PCE of 32% under AM1.5 illumination when a single material is used in the active layer and the carriers are extracted after thermalization. The SQ limit is generally valid also for XSCs when either the donor or the acceptor are the main absorbers. The physical reason for the SQ limit is two-fold: (1) photons with energy lower than the optical gap are not absorbed, while photons with energy higher than the optical gap generate excited carriers that quickly thermalize to the band edge before being extracted, thus losing the surplus energy; (2) while smaller energy gaps result in higher absorbed sunlight and currents, they lead to smaller voltages. Since the PCE is the product of a current and a voltage, this trade-off results in an ideal optical gap in the 1.3–1.5 eV range to achieve limit PCE values close to 30%. Similar PCE values have been recently achieved in high purity GaAs solar cells.49
3 Computer calculations in photovoltaics
This section discusses computer calculations of physical processes in solar cells across time and length scales. We focus on calculations of the energy and dynamics of electrons and excitons, transport in PV active layers, and sunlight absorption, propagation and management.
3.1 Electronic and optical properties of materials from first principles atomistic calculations

3.1.1 Primer on first-principles atomistic calculations. 
We introduce atomistic computational methods based on density functional theory (DFT)90 and many-body perturbation theory (MBPT)91 employed to study the energy of excited electrons and excitons in materials for solar cells. The common characteristics of these quantum mechanical approaches is that they do not use experimentally derived parameters. The structure of the material is the only input in these calculations, although the structure itself can also be computed within DFT. The Hamiltonian of the system is constructed using the position and type of the atoms in the unit cell, and no other information. For this reason, these methods are known as first-principles, or ab initio. The application of first principles methods in PV focuses on computing spectroscopic quantities regulating PV performance, such as the band gap, bandstructure, band alignment at interfaces, optical absorption spectra, and energy and dynamics of excited carriers and excitons. We review briefly DFT and MBPT methods and their application in PV, and refer the reader to ref. 90–94 for detailed technical discussions.
DFT is the method of choice to calculate the ground-state properties of materials.90,92 The Kohn–Sham (KS) equations of DFT, a cornerstone of modern electronic structure theory, are self-consistent, one-electron Schrödinger-like equations to construct the electronic density ρ(r) minimizing the ground state energy Egd[ρ]: {H0(r) + vxc[ρ(r)]}φnk(r) = εnkφnk(r)(4)where  is the sum of, respectively, the kinetic energy, the potential vN(r) from the nuclei (or nuclei plus core electrons), and the Hartree repulsive potential , felt by an electron in the material. In eqn (4), φnk are KS orbitals, and εnk are KS eigenvalues. The subscript n is a band index, while k is the crystal momentum in the Brillouin zone for periodic systems, and can be dropped (i.e., k = 0) for an isolated system such as a molecule or quantum dot. The electron density is obtained as a sum over occupied states of single electron densities, .
The KS Hamiltonian in eqn (4) is the sum of H0 and the exchange correlation potential vxc capturing electron–electron interactions beyond the electrostatic (Hartree) term. The exact form of vxc is unknown and several approximations have been developed for it. The two most common local forms of vxc(r) (here, local means acting on the KS orbitals in a multiplicative way) include the local density approximation (LDA) and the generalized gradient approximation (GGA).92 These vxc approximations have enabled calculations of a large number of materials properties, although they fail to capture several features of the exact vxc.92 The KS equations are general and can be applied to crystals as well as surfaces, interfaces, and nanostructures.95 The self-consistent numerical solution of the KS equations (eqn (4)) is typically carried out either using a plane-wave basis set by iterative diagonalization, as is done in the Quantum ESPRESSO96 and VASP97 codes, or a localized atomic orbital or a gaussian basis set (e.g., in the SIESTA98 code). The ground-state electronic density is thus obtained, and from it the ground-state energy along with other ground-state quantities such as the elastic, vibrational, and thermal properties of materials, and their spontaneous polarization and magnetization.90
In PV research, DFT can be employed to study the ground-state properties of novel solar cell materials, as well as their defects and surfaces. DFT is also the starting point for excited-state calculations, and it can sometimes be used in non-rigorous excited-state calculations (see below). Before discussing excited-state methods, we note that band gaps, bandstructures and band offsets could in principle be rigorously computed within DFT, provided the KS eigenvalues εnk, which are mere Lagrange multipliers in the derivation of eqn (4), can be attributed the physical meaning of quasiparticle energies (i.e., energies for addition or removal of electrons and holes). In a quasiparticle equation, the ionization potential (IP) and electron affinity (EA) are, respectively, the absolute energies of the highest occupied and lowest unoccupied orbitals; the electronic band gap is given by Eg = IP − EA, and the bandstructure contains information equivalent to angle-resolved photoemission spectra. These conditions are satisfied in Hartree–Fock theory,90 in which vxc is replaced by the Fock non-local exchange, and Koopman's theorem90,99 guarantees that the energy for the addition or removal of an electron is given by the corresponding one-particle eigenvalue, under the assumption that the electronic states do not relax following electron addition or removal. An analogue of Koopman's theorem exists in DFT: Eg = εCBM − εVBM + Δxc(5)namely, the band gap is equal to the KS gap, which is the difference of the KS energies of the CBM and VBM orbitals, plus a positive term Δxc, the derivative discontinuity of the exchange–correlation energy Exc. This term represents a discontinuity in  as the number of electrons is increased or decreased away from N, the number of electrons in the neutral system, by a small amount δN (here, δN = Vδρ, with V the volume). Since in practice the KS equations are solved using an approximate vxc (while the theorem holds for the exact vxc), the band gap is not computed accurately within DFT. For the commonly employed LDA and GGA functionals, the derivative discontinuity vanishes, and the KS gap εCBM − εVBM is smaller than the experimental electronic gap (the difference being Δxc) usually by 30–50%. In some cases, semiconductors (e.g., Ge) or insulators with d or f electrons are predicted to be metals within LDA. Even for non-local exchange–correlation functionals, the non-zero derivative discontinuity Δxc is difficult to compute, and eqn (5) is of limited practical use.
Recent efforts have focused on creating Koopmans-compliant exchange–correlation functionals99–101 with piecewise linearity with respect to fractional particle occupations. Other groups have focused on exchange–correlation functionals, such as the GLLB potential by Gritsenko et al.102 and its modified version GLLB-SC for solids,103 in which the derivative discontinuity can be computed explicitly with a reasonable computational effort. Alternatively, so-called hybrid exchange–correlation functionals mixing a fraction α of Fock exchange with the approximate LDA or GGA exchange can give band gaps closer to experiment than LDA, at the cost of using α as an empirical parameter92 (a common and non-rigorously justified choice is α ≈ 0.25). The hybrid functionals are popular when working with localized basis sets. Using DFT with new functionals that can accurately compute bandstructures and interface band offsets would facilitate studies of materials with complex unit cells, as well as nanostructures and interfaces of relevance in PV, especially if the same computational cost as LDA can be retained in the new functionals.
Much PV research employing first-principles calculations focuses on excited state properties linked to PV efficiency. Commonly employed excited-state methods include the so-called GW method94,104 to compute band gaps, bandstructures and band offsets at interfaces, the Bethe–Salpeter equation (BSE) to compute optical spectra and excitons, and time-dependent DFT (TD-DFT) to compute optical spectra and more recently excited state dynamics. In their ab initio implementation, these methods use KS eigenvalues and orbitals as the ingredients to build excited-state equations.
The GW and BSE methods are based on the perturbative expansion of the one-particle and two-particle (electron–hole) Green's functions, respectively. These approaches are in general computationally more expensive than DFT, but achieve state-of-the-art accuracy. In GW, the analogue of the KS equation is the Dyson equation for the quasiparticle energy Enk and wavefunction φnk: (6)where Σ is the electron self-energy operator containing exchange and correlation effects among the electrons. In the GW method, the self-energy is taken as the first-order approximation of a perturbation series expansion in the screened Coulomb interaction W. This yields Σ = iGW (hence the name of the method), where G is the one-electron Green's function, and W = ε−1vc is the screened Coulomb interaction, with vc the Coulomb potential and ε−1 the inverse RPA dielectric function describing the dynamical electron screening in the system. The GW self-energy is a non-local, energy-dependent, and non-Hermitian operator, replacing the vxc potential in the KS equations. The simplest procedure to solve eqn (6) is the so-called G0W0 approximation (also known as one-shot GW), in which G, ε−1, and W are constructed with the KS eigenvalues and orbitals, and first-order perturbation theory is applied to the KS equation to correct the KS eigenvalues εnk by computing the diagonal matrix elements of the perturbing potential Σ − vxc:¶ Enk = εnk + 〈φnk|Σ(Enk) − vxc|φnk〉(7) The G0W0 method is implemented in the Yambo105 and BerkeleyGW106 codes, among others, using a plane-wave basis to build Σ. Several strategies exist to solve eqn (6) self-consistently91 but will not be discussed here. GW is important in PV research because it can compute band gaps and bandstructures in excellent agreement (typically, within 0.1–0.2 eV) with experiment for sp-bonded systems, and can also be employed to study moderately correlated systems with d valence electrons (e.g., transition metal oxides), though with additional technical challenges.107 GW has a higher computational cost than DFT. For a system with N valence electrons and using a plane-wave basis set, the computational cost in GW scales roughly as N4, versus N2log(N) for the LDA approximation of DFT. The high computational cost in GW is due to the large number of unoccupied states needed to compute the screening. Recent implementations such as the WEST108 code avoid the use of empty states and are highly promising for large-scale GW calculations of complex PV materials and nanostructures with thousands of atoms in the unit cell.
BSE is an accurate method to study optical absorption and excitons. It includes the exchange and attractive screened Coulomb interactions between electrons and holes generated upon photoexcitation, and can thus compute the binding energy and spin character (singlet or triplet) of excitons in materials.109 The BSE method is essential to study systems with weak dielectric screening and strongly bound excitons, including important solar cell materials such as organic semiconductors, nanomaterials, and some oxides. Even in materials with relatively high permittivity (e.g. Si), excitonic effects are necessary to reproduce the experimental absorption spectrum due to weight redistributions of the oscillator strengths.
In the one-electron picture of band theory, optical transitions induced by visible light are vertical in the Brillouin zone due to the small photon momentum, and excite an electron in a valence orbital φvk to a conduction orbital φck. On the other hand, excitonic transitions within BSE are composed by weighted sums of one-particle vertical transitions from valence states to conduction states. The excitonic wavefunctions |S〉 corresponding to excitation energies ΩS are superpositions of electron–hole states through coefficients ASvck: (8)where we wrote the wavefunction in real space with electron/hole coordinates re/h, used the Tamm–Dancoff approximation, and neglected the photon momentum. The excitation energies ΩS and the coefficients ASvck can be obtained by solving the BSE, which amounts to diagonalizing an effective excitonic Hamiltonian Hexc constituted by a diagonal kinetic energy term and a kernel including the exchange and screened Coulomb interactions:109 (9) The excitonic Hamiltonian is constructed using the static screening and quasiparticle energies from GW, and eqn (9) is solved by iterative or full diagonalization using a converged number of k-points and enough valence and conduction bands to span the energy range of interest.
The BSE yields multiple quantities of interest in PV. The binding energy of the lowest singlet exciton can be obtained as the difference between the GW quasiparticle gap and the BSE optical gap, while the exciton wavefunction in eqn (8) can be visualized, among other approaches, by fixing the position of the hole (electron) and plotting the square modulus of the excitonic wavefunction. The optical absorption α(E) at photon energy E, from which the absorbance and the short-circuit current of the active layer can be obtained (see above), are computed from the imaginary part of the BSE macroscopic dielectric function ε2 using  (n is the refractive index). In the BSE approximation: (10)where Vuc is the unit cell volume.
This formula has an intuitive physical interpretation, namely, the one-particle vertical transitions are mixed in the BSE oscillator strengths and weighted by the excitonic wavefunctions ASvck, while the excitation energies ΩS are not mere differences of quasiparticle energies. BSE optical spectra have shown remarkable agreement with experiment for many semiconductors and insulators.91 One of the missing features in the BSE spectra is phonon-assisted transitions, of particular relevance in indirect gap materials (a notable example is Si), which can be included with recently developed methods.110 The accuracy of BSE is better established for solids than for molecules, in which double or higher excitations not included in BSE may play an important role. We note that optical absorption spectra can also be obtained using TD-DFT within the linear response approximation, with an accuracy critically dependent on the exchange–correlation functional.91 At present, the GW-BSE approach is commonly used in the physics and materials science communities. The quantum chemistry community favors approaches using localized basis sets and treating correlation effects in the ground and excited states by expanding the wavefunction into excited Slater determinants within post-Hartee–Fock methods, such as coupled cluster and configuration interaction,111,112 as implemented in codes such as GAUSSIAN113 and QCHEM.114
Ultrafast carrier dynamics is a new frontier of first-principles calculations with great potential to impact PV research due to the importance of processes taking place at the fs–ns time scale in solar cells. Ultrafast dynamics has been dominated for the last few decades by semiempirical calculations with model Hamiltonians, which can explain the main physical trends but miss the atomistic details and are not ab initio. Several approaches for ultrafast carrier dynamics have been developed to study laser excitation, including the semiclassical Boltzmann transport equation (BTE) and its “quantum version”, the Kadanoff–Baym equation (KBE).115,116 The BTE evolves the carrier populations in time according to the rate of the scattering processes present in the material, while the KBE employs non-equilibrium Green's functions on the Keldysh contour to obtain the carrier population dynamics and additional information.115 Electron–electron (e–e), electron–phonon (e–ph) and electron–defect (e–d) scattering processes regulating the dynamics are typically taken into account through parameters or simplified models.115
First principles calculations of ultrafast carrier dynamics are in their nascent stage. Two main approaches are currently being explored, one based on the time-dependent Kohn–Sham equation, and the other on perturbation theory together with the BTE or KBE. The former is real-time TD-DFT,117 which uses the KS Hamiltonian to self-consistently propagate the electronic wavefunction through the time-dependent Kohn–Sham equation. The forces on the nuclei are typically obtained using Ehrenfest's theorem. Both real-space grids118 and plane-wave basis sets119 have been employed in real-time TD-DFT. The second approach involves computing the e–e, e–ph, and e–d scattering rates from first principles, and then evolving in time the carrier population32 with the BTE or non-equilibrium Green's function using the KBE.120


3.1.2 First-principles calculations applied to solar cells. 
We discuss examples of first-principles calculations applied to solar cells. We first turn our attention to band alignment calculations at interfaces, a central problem for heterojunction CSCs and organic/nanostructured XSCs. As discussed above, DFT with the LDA or GGA exchange–correlation functionals lacks the necessary accuracy to compute VBM and CBM energy levels, and GW calculations should be employed to this end. However, interfaces of practical interest in PV are often too computationally expensive for GW. For example, interfaces between inorganic crystalline phases typically possess dislocations and incommensurate structures that cannot be modeled with unit cells sizes within reach for first-principles methods. New accurate approaches with lower computational cost would be beneficial to advance band alignment calculations in solar cells.
Valence and conduction band offsets are quasiparticle energy differences rather than absolute quasiparticle energies. While DFT has a significant error on the band gap of both materials composing the interface, error cancellation can make DFT band alignment trends qualitatively correct. For example, recent calculations of interfaces between PCBM fullerene and semiconducting single-walled carbon nanotubes can correctly predict type-II alignment for nanotubes with diameters up to 1.2 nm, and type-I alignment for larger diameters.11 Experiments confirmed this prediction, leading to fabrication of XSCs based on PCBM and small-diameter nanotubes with a record PCE of 3.1% for carbon-based solar cells.13
This surprising success of DFT can be attributed to the chemical similarity of the two materials composing the interface. As a rule of thumb, whenever the localization of valence electrons changes significantly between the two materials forming the interface (e.g., at metal/molecule or transition-metal oxide/semiconductor interfaces), DFT is subject to large and unpredictable errors in the band alignment.121,122 Interfaces between two sp-bonded systems tend in general to be better described by DFT than systems with d valence electrons, due to self-interaction errors. These considerations are generally valid also for hybrid exchange–correlation functionals.
Given the often prohibitive cost to compute entire interfaces using DFT or GW, band offsets are typically derived from the VBM and CBM levels of the isolated materials composing the interface. However, upon formation of an interface between two semiconductors, charge redistribution leads to formation of a dipole with an associated potential ΔV that can be as large as ∼1 eV.123 This effect needs to be taken into account when combining VBM and CBM energies of the two isolated materials to compute band offsets.123 The interface dipole can be computed in a supercell containing an interface of the two materials. DFT and GW calculations of the dipole potential ΔV at interfaces between sp-bonded semiconductors show agreement within ∼100 meV,123 suggesting that the dipole potential can be accurately computed within DFT due to its electrostatic origin. Conversely, the determination of ΔV at interfaces between semiconductors and transition metal oxides with localized d or f electrons are challenging due to self-interaction errors in DFT leading to fictitious orbital delocalization.
Systematic studies of band offsets for interfaces between two inorganic or two organic semiconductors have been recently carried out. Hinuma et al.124 studied the band alignment of over 20 inorganic semiconductors with diamond, zinc-blende and wurtzite structures, and compared the performance of GW with the PBE and hybrid HSE functionals. The experimental ionization potentials, electron affinities, and band offsets computed with GW are in very good agreement with experiment for most semiconductor surfaces and heterointerfaces considered in their study. While both PBE and HSE gave large errors for the ionization potentials and electron affinities, the errors on the band offsets were much lower due to error cancellation, as noted above. A good overall transitivity was found for the band offsets, implying that if the VBM and CBM with respect to vacuum are known (e.g., from a slab calculation), the band offsets can be estimated by aligning the vacuum levels. This approach neglects the detailed value of the interface dipole, as it implicitly assumes that the difference of the isolated semiconductor surface dipoles approximates the interface dipole in the combined system. As noted above, the interface dipole contribution can be small when the phases that constitute the interface have similar atomic arrangements and chemical bonding, but large in the case of different chemical bonding in the two phases, leading to band offset errors as large as ∼0.5 eV for the vacuum level alignment approach.124
High-throughput DFT calculations of ionization potentials and electron affinities of organic materials have also been carried out125 to identify D–A pairs with type-II alignment for organic XSCs. These studies have so far focused on isolated organic molecules125 rather than interfaces. An interesting new direction is the use of Koopmans compliant exchange–correlation functionals, recently applied to study the ionization potential and electron affinity of a large number of organic compounds.100 The detailed investigations of inorganic interfaces discussed above highlight the role of the interface dipole, a result that needs to be taken into account to derive the band alignment between organic molecules.122 For this reason, we believe that high-throughput searches of materials for organic XSCs should focus on computing interfaces, rather than isolated materials, to correctly include the effect of the interface dipole.
The energetics and dynamics of exciton dissociation at D–A interfaces is shown schematically in Fig. 3. In XSCs, the problem of finding suitable D–A material pairs is complicated by the large exciton binding energy (up to ∼0.5–1 eV) of organic materials and nanostructures. In particular, type-II electronic alignment does not guarantee effective exciton dissociation at D–A interfaces, given that the electron and hole that make up the bound exciton need to break free of their Coulomb attraction and delocalize on opposite sides of the interface toward free carrier states. The rule-of-thumb commonly employed by experimentalists consists of subtracting the exciton binding energy from the electronic band offsets to estimate effective band offsets for exciton dissociation at D–A interfaces.87 This simple rule, guided by a single-electron picture of the electronic structure, can fail for several reasons. First, the time scale for exciton dissociation at D–A interfaces is comparable to the time scale for exciton thermalization, so that dissociation can occur before the electron and hole thermalize to the band edges (more rigorously, before the exciton decays to the lowest-energy singlet for the interface). Recent time-resolved optical experiments39–41 of organic interfaces found that hot CT form on a 100 fs time scale following light absorption, and act as intermediate states to shuffle electrons into the conduction band of the acceptor, with a dynamics fast enough to avoid trapping into the lowest-energy CT0 exciton (see Fig. 3). While the energy of CT excitons at D–A interfaces can be computed using either BSE or linear-response TD-DFT calculations, their dynamics is still challenging to compute. Open questions remain on the details of exciton dissociation dynamics, an important topic deserving further investigation with first-principles methods.
An ambitious goal of first-principles calculations is to estimate the efficiency of solar cells. A truly multi-scale method is necessary to compute the efficiency, especially given that the current–voltage curve is determined by non-equilibrium carrier transport and dynamics. Yet, first-principles calculations can help establish efficiency limits for a given material, and identify promising materials for solar cells.
Accurate calculations of optical absorption are essential to compute efficiency limits, given that the maximum short-circuit current is determined by optical absorption through eqn (2). New materials can be screened and compared with well-known sunlight absorbers and PV materials26 such as Si and GaAs. For example, our recent work employed the GW-BSE method to compute the absorption and maximum short-circuit current in graphene and two-dimensional transition metal dichalcogenides (TMDCs) such as MoS2 and MoSe2.126 These calculations established that TMDCs and graphene are among the best sunlight absorbers available, harvesting 5–10% of incident sunlight in a sub-nm thickness, versus a thickness of 20 nm for GaAs and over 100 nm of Si to absorb the same amount of sunlight. Similar studies can uncover the potential of new families of materials for efficient solar cells.
A simple criterion to find optimal materials for CSCs without computing optical absorption is based on the band gap. In the Schockley–Queisser limit,89 semiconductors with a direct band gap in the 1.3–1.5 eV range are optimal for efficient solar cell active layers. However, even materials with a band gap in the optimal range may not yield high efficiency solar cells due to a range of issues, including defects, carrier recombination, weak above-gap optical absorption, challenges in fabrication, and poor stability under sunlight illumination. For example, CdTe has an ideal band gap of 1.5 eV, but it achieves a record efficiency of only less than 15% versus a maximum theoretical efficiency of 29%.127 Similarly, pyrite (FeS2), a material with a 1 eV bandgap and intense sunlight absorption, is an excellent candidate for solar cells, but its low open-circuit voltage of ∼0.2 V is a major challenge limiting its practical application. For both CdTe and FeS2, the microscopic origin of the relatively low efficiency is still poorly understood, and first-principles calculations can provide new insight.
High-throughput calculations of the band gap of a vast number of compounds have been recently carried out using GW.25 The work identified over 20 materials with potential for high efficiency, including the best known along with previously unrecognized PV absorbers. In addition, the GLLB-SC approach has been employed by Castelli et al.128,129 to compute the band gap of a large number of compounds with potential for sunlight harvesting, obtaining good agreement with experiment and finding multiple candidate materials. PCE limits of practical use for CSC materials can also be estimated by using the band gap as an approximate limit for the open circuit voltage, the absorption spectrum and active layer geometry to determine the maximum short-circuit current, together with 0.6–0.8 fill factor values typical of good CSCs.
For XSCs, the problem of estimating efficiency limits is more complex.88 The interface gap Δ (see Fig. 3) sets an upper limit for the open circuit voltage, and requires a band offset calculation to be computed. The optical absorption of both the donor and acceptor are needed to compute the active layer absorption. A useful model introduced by Scharber can be employed to estimate the efficiency of XSCs,87 which uses effective band offsets renormalized by the exciton binding energy. We recently applied this model to estimate the efficiency of an ideal 2D material with a tunable band gap interfaced with a PCBM fullerene acceptor, showing the potential of 2D materials for XSCs with tunable efficiency.130
A family of materials of current focus in PV research are the metal–organic perovskites,50 currently achieving efficiencies close to 22% in solution-processed thin film devices.10,24 The most widely studied metal–organic perovskite is methylammonium lead iodide (MAPbI3), a 1.5 eV direct gap semiconductor with intense light absorption and long carrier diffusion lengths of up to 1–10 μm.50,131 At odds with common CSC semiconductors, MAPbI3 is a highly complex material combining polymorphism, strong spin–orbit coupling (due to the heavy Pb atom) and bulky methylammonium cations with rotation dynamics breaking inversion symmetry. At room temperature, MAPbI3 adopts a body-centered tetragonal structure, with transitions to a cubic structure at temperatures above 330 K, and orthorhombic structure below 160 K.
The GW bandstructure and the carrier effective masses of MAPbI3 have been computed by several groups,132–134 and related compounds with different cations or Pb replaced by Sn or other elements have also been studied. BSE calculations of the absorption spectrum and exciton binding energies have been recently carried out,135 confirming the small exciton binding energies (of order kBT) found experimentally. This result implies that MAPbI3 devices effectively behave as CSCs. DFT calculations with hybrid functionals136,137 have also been employed to study the defect physics in MAPbI3. These studies showed that readily formed defects in MAPbI3, such as Pb vacancies and interstitial methylammonium ions, possess shallow energies with respect to the band edges, and as such they might not affect transport by trapping carriers. On the other hand, defects that create states near the center of the gap (and thus with potential to trap carriers) appear to have prohibitively high formation energies.136,137 This work offers a tentative explanation for the favorable carrier transport in MAPbI3 in spite of the significant concentration of defects typical of a solution-processed material.
Several open questions remain in metal–organic perovskites. In particular, the origin of the long carrier lifetimes and diffusion lengths, especially for a material deposited from solution, are not fully understood. It has been suggested138 that the Rashba splitting of the VBM and CBM due to spin–orbit may induce selection rules for dipole-forbidden transitions leading to longer lifetimes, yet the extent of the Rashba splitting has not yet been verified experimentally in the room temperature tetragonal phase, and it may be only very small in practice. On longer timescales, the hysteresis of the current–voltage curve, a peculiar behavior of MAPbI3 solar cells,139 has been tentatively explained either in terms of a local polarization of the methylammonium ions or the PbI framework, and more recently as a consequence of ion migration.140
Lastly, photodegradation is an important problem in MAPbI3. Devices that are not properly encapsulated typically lose their efficiency over a few days under operating conditions; though multiple degradation mechanisms have been proposed, extensive computational studies are still missing. First-principles calculations have not yet been able to unravel these complex dynamical processes in metal–organic perovskites, and have focused mainly on structure and bandstructure studies thus far.141
In general, first-principles calculations in solar cells have chiefly focused on the energetics of electrons and excitons, with less focus on the equally important electron and exciton dynamics that regulate sunlight conversion. For example, the ultrafast thermalization of excited (so-called hot) carriers is the main source of energy loss in most PV materials. For the case of Si under AM1.5 solar illumination, nearly 25% of incident solar energy is lost to heat as the hot carriers generated by sunlight absorption thermalize to the edges of the band gap. Experimentally, this thermalization process is difficult to control and understand with microscopic detail due to the sub-ps time scale involved.32 One of the authors has developed a novel approach to study hot carriers in solar cells combining first-principles calculations of electron–phonon and electron–electron scattering with semiclassical carrier dynamics.32 In particular, it was shown32 that a hot carrier distribution characteristic of Si under solar illumination thermalizes within 350 fs, in excellent agreement with pump–probe experiments, and further computed the ballistic mean free path of hot carriers, a key property to engineer hot carrier extraction in solar cells. This work sheds light on the sub-ps time scale following sunlight absorption in Si, and constitutes a first step towards ab initio quantification of hot carrier dynamics in materials.
First-principles studies of exciton dissociation dynamics are of central importance in XSCs. Recent work employed real-time TD-DFT to study the time scale for exciton dissociation at dye molecule/TiO2 interfaces,142 contributing to resolve controversies on charge generation dynamics in dye-sensitized solar cells. Studies of fundamental importance have also been carried out in prototypical PV systems, such as triad carotene–porphyrin–fullerene molecules in which the porphyrin absorbs light forming bound excitons, which dissociate over a ∼100 fs time scale resulting in electrons transferred to the fullerene and holes to the carotenoid.143,144 Using real-time TD-DFT, Rozzi et al.144 showed that the charge-transfer process in the triad consists of a coherent, wavelike motion of electrons initiated by nuclear vibrations on a time scale of tens of femtoseconds, in agreement with time-resolved spectroscopy. We note that TD-DFT within the adiabatic LDA approximation fails to properly describe charge-transfer excitations.145 Additional work is thus necessary to establish the accuracy of real-time TD-DFT calculations employed to study the dynamics of excited electrons. While calculations of ultrafast carrier and exciton dynamics applied to solar cells are still in their infancy, we believe they will play a key role in the future to understand solar cell devices.
Practical barriers to the realization of solar cells include problems not commonly explored in first-principles calculations, such as the optimization of contacts and buffer layers, carrier recombination at defects and grain boundaries, and the stability of materials exposed to sunlight and moisture. Investigations that capture the complexity of real devices are necessary to bridge the gap between first-principles calculations of ideally perfect crystalline active layer materials, as typically investigated in the ab initio community, and real devices with multiple interfaces between materials with defects and impurities. We believe that a combination of new theory, first-principles calculations, and experiments designed to understand devices microscopically (rather than merely increase their efficiency) will enhance fabrication of efficient solar cells.

3.2 Charge and exciton transport
A range of computational approaches are available to model charge and exciton transport in solar cells. The ultimate goal of computing transport in PV is to obtain current–voltage curves, from which the open-circuit voltage, short-circuit current, efficiency, fill factor, and series and shunt resistances can be extracted. A more typical goal is to compute the charge carrier mobility in the active layer or its composing materials.
The microscopic mechanism of charge transport differs dramatically in CSCs and XSCs. Charge transport in inorganic materials employed in CSCs is typically analyzed in momentum space, whereby the bandstructure together with scattering of delocalized carriers with phonons, defects, and other carriers determine the mobility and transport properties.146 At room temperature in CSCs, the upper bound of the mobility is governed by scattering with phonons. Scattering with defects, both elastic and inelastic (i.e., carrier trapping), depends on the purity and microstructure of the active layer, and is typically minimized by employing high purity active layer materials.147
In organic XSCs, the strong electron–phonon coupling induces the formation of small polarons,59,60 which can be thought of as localized charge carriers moving in the active layer material by discrete intra-molecular and inter-molecular hopping processes. While hopping is a simplified model of charge transport in the strong electron–phonon coupling regime, this picture has guided most of the research on charge transport in organic active layers made up by small molecules, polymers, and D–A blends. For example, since organic polymers are typically employed as the donor, the hole mobility is the main quantity of interest in polymer-based XSCs as it constitutes the bottleneck for charge transport and efficiency.4,56
At the device scale, commonly employed computational methods for CSCs and XSCs include semi-classical drift–diffusion148 and kinetic Monte Carlo (KMC) simulations,51,57 respectively. Both methods are able to describe diffusive transport (i.e., in the presence of multiple scattering events) over time scales up to carrier extraction at the contacts. These calculations are typically semi-empirical, using inputs such as generation and recombination rates, mobility, and trap density obtained from experimental data. Useful trends can also be obtained by treating transport variables as parameters and studying the resulting current–voltage curves.
Transport properties to be used as inputs in device-scale models can also be obtained from ab initio calculations. Although this approach is not yet widespread, first-principles calculations of transport properties are being actively investigated in the electronic structure community, and constitute at present an important missing link between ab initio microscopic and device-scale models in semiconductors. For example, the conductivity σ and mobility μ in crystalline materials employed in CSCs can be computed from first principles within the Boltzmann transport formalism:146,149 (11)where vnk,α are Cartesian components (α = x, y, z) of the band velocities for the Bloch state |nk〉, which can be obtained from DFT or GW bandstructures, τnk are carrier relaxation times due to scattering with phonons and defects, and f(T) is the temperature dependent Fermi–Dirac distribution. The mobility μ can be obtained from the conductivity using μ = σ/(ec), where c is the carrier concentration and σ the direction-averaged conductivity. By varying the chemical potential, both the electron and hole mobilities can be computed.
In a state-of-the-art calculation, eqn (11) can be evaluated by interpolating the bandstructure to obtain the band velocities on fine Brillouin zone grids. The relaxation times can be computed using Fermi's golden rule within the lowest order of perturbation theory in the electron–phonon and electron–defect interactions.150 The BoltzWann149 and BoltzTrap151 codes implement such conductivity and mobility calculations by interpolating the bandstructure with Wannier functions152 and Fourier interpolation, respectively. The relaxation times, which in principle depend on band and k-point in the Brillouin zone, are often approximated near the chemical potential with a constant or a slowly varying function of energy. The constant relaxation time can be used as a fitting parameter or extracted from experiment,153 thus making the calculation semi-empirical. First-principles calculations of carrier–phonon32,154,155 and carrier–defect156,157 scattering reveal a non-trivial dependence of the relaxation times on band and k-point, which is not captured by the constant relaxation time approximation and improves the agreement of the computed conductivity with experiment. Computation of ab initio carrier relaxation times are challenging due to the need to interpolate the scattering matrix elements on fine grids in the Brillouin zone to converge the sum over final states imposed by Fermi's golden rule. While so far only materials with simple unit cells have been studied, we believe that research efforts to compute relaxation times from first principles will greatly improve transport calculations by eliminating the use of empirical relaxation times.
Carrier diffusion lengths can also in principle be computed ab initio by calculating both the carrier mobility and the recombination lifetimes due to radiative158 and non-radiative159 processes, although no examples of such ab initio diffusion length calculations in semiconductors exist in the literature. Other quantities of interest for transport calculations, such as the effective mass tensor, carrier concentration, and density of states, can be routinely computed from first principles using DFT or GW bandstructures.
In organic XSCs, fully ab initio calculations of the mobility are challenging due to the strong electron–phonon coupling. Boltzmann transport theory (e.g., eqn (11)) cannot be applied to compute the conductivity due to the localized nature of the carriers, and the electron–phonon interaction cannot be treated perturbatively. While hopping models (see below) dominate the literature, attempts have been made to compute the mobility in organic semiconductors from first principles. For example, Hannenwald et al.68,69 demonstrated an interesting ab initio approach to compute the polaron mobility in organic molecular crystals of high purity. Employing the Kubo formula for the conductivity, they evaluated the current–current correlation function using a Holstein–Peierls Hamiltonian for small polaron hopping, accounting for both the intra-site and inter-site phonon coupling. By mapping the first principles bandstructure to the tight-binding Hamiltonian, their work showed calculations of the mobility of naphthalene in good agreement with experiment. Their results provide insight into the difference between electron and hole mobilities as well as their temperature dependence.68,69 While this approach has not been applied extensively, it constitutes a starting point for ab initio calculations of mobility in organic semiconductors and XSCs, which can be extended to crystalline or perhaps even disordered polymers provided the method can be scaled to larger unit cells.
Device-scale transport in CSCs is commonly modeled using drift–diffusion simulations that employ a continuum description of carrier dynamics. A set of self-consistent partial differential equations is solved to find the currents, carrier concentrations, potential, and Fermi energies at steady state.160 A variety of in-house developed, distributed open-source, or commercial drift–diffusion codes are available to study transport in CSCs. Standard software packages such as COMSOL use finite element methods to solve the drift–diffusion equations, and provide graphic tools to prepare the device geometry. Light absorption and propagation within the active layer can be modeled as a space-dependent carrier generation term, thus allowing one to couple the problem of light management (see below) and carrier transport. Drift–diffusion calculations can be extended to model XSCs by including mono/bimolecular and geminate recombination, respectively, in the bulk and at D–A interfaces.161 A variety of models have been proposed for organic and nanostructured XSCs, including a range of treatments to study bulk recombination and interfaces with the contacts. While the drift–diffusion method can be extended to model transport in XSCs, Monte Carlo calculations based on hopping of localized carriers and/or excitons are a more natural choice for XSCs.
Kinetic Monte Carlo (KMC) models162 provide an alternative picture of transport that is based on discrete hopping processes of localized charge carriers and excitons. In KMC simulations, a catalogue of possible processes and their rates are assumed for carriers and/or excitons. The rate of a given process can be obtained from experiment, computed within a variety of approximations, or taken to be a parameter. A random number is extracted at each time step of the simulation, and processes are chosen and carried out according to their relative rate.162 The PV active layer is spatially discretized, usually in the form of a lattice or network over which carriers and excitons move.51 KMC has been used extensively to model exciton transport163 and charge transport in XSCs51,57,58,63–65,67,70,164,165 and organic light-emitting devices,57,166 a technology with important overlap and cross-fertilization with organic XSCs. The advantages of the approach include the possibility to couple exciton and carrier dynamics, and to obtain current–voltage curves by using appropriate boundary conditions, thus guiding interpretation of transport data in XSCs.51
Next, we describe some of the approaches employed so far to compute the mobility in organic XSC active layer materials using KMC and related hopping models. In polymer XSCs, the molecular packing, molecular weight distribution, and morphology of the active layer have a major impact on device-scale charge transport.51,57,70,167–169 Charge transport in disordered polymers is regarded as a hopping process between localized sites, which are thought to consist of conjugated polymer chain segments. Deposition from solution generates a polymeric phase composed of individual chains and lamellar structures with structural and energetic disorder. Approaches employed to model transport in the active layer on the 10–100 nm scale explicitly include the effect of the molecular structure of the crystalline and amorphous domains of the polymer.51,57,70 The inter-molecular polaron hopping rates, Γ, are typically computed from the electronic structure of the molecules through nonadiabatic Marcus theory:170 (12)where Γij is the transfer rate between the initial and final localized sites, labelled as i and j respectively, Jij is the electronic transfer integral, λ is the molecular reorganization energy, ΔGij is the free energy difference between the sites, kB is the Boltzmann constant, and T the temperature.
In a typical calculation,51 DFT is employed to locally relax the molecular geometry, and the transfer integrals Jij are then computed. Because of the large number of possible relative molecular orientations to be sampled in the active layer, computationally efficient methods to compute the transfer integrals are preferable. For example, ref. 51, 57 and 70 use the so-called ZINDO semiempirical quantum chemistry approach to compute the transfer integrals,171 though other choices are also possible. These calculations focus on inter-chain hopping rates, which are strongly dependent on chain separation and relative orientation, and typically constitute the rate-limiting step for charge transport in polymers.51 Once the transfer integrals have been computed, a KMC transport simulation is carried out on the chosen morphology in the presence of an electric field. By adopting waiting times for inter-site hopping consistent with the computed hopping rates, multiple polaron trajectories are analyzed, and the average mobility μ is computed by dividing the distance L travelled by the polaron by the electric field F times the average transit time 〈τ〉 employed to cover that distance, i.e., μ = L/(〈τ〉F). Using this approach, the temperature and electric field dependent mobility and photocurrent generation have been studied as a function of morphology in organic polymers and D–A active layer blends in polymer XSCs.51,57,70,163
Transport experiments in organic devices have shown that the mobility can differ by up to several orders of magnitude between organic diodes and field-effect transistors, a trend that has been explained in terms of the mobility dependence on carrier concentration.66 Approaches explicitly taking into account the dependence of the mobility on carrier concentration have been developed to explain these results. Pasveer et al.66 employed a master equation for hopping that includes a penalty for double or multiple polaron occupation of a given molecular site. The master equation is solved numerically and the concentration-dependent mobility is extracted, thus enabling studies of carrier density, temperature, and electric field dependent mobility in polymer66 and small-molecule materials.
Device-scale models in XSCs are built by employing the mobility and exciton diffusivity as inputs for KMC or continuum electrical/optical models.57,172 For example, Lacic et al.172 developed a device-scale transport model for XSCs employing as inputs the active layer optical absorption as well as measured or estimated transport parameters. Another important element of their approach is a model for charge injection into the solar cell blend material at the anode and cathode. By applying their approach to devices with a range of active layers, they concluded that the low hole mobility in the D–A active layer blend is the key efficiency limiting parameter in XSC devices.
Calculations based on hopping of localized carriers have recently been employed by Lee et al.173 to model transport in quantum dot XSCs. By combining the continuity equations with explicitly computed charge hopping and recombination rates, the authors studied the impact of the electronic energy disorder (originating from the quantum dot size dispersion) on the charge carrier mobility in quantum dot films. We highlight that charge hopping models continue to dominate transport calculations in disordered PV active layers, within a variety of approximations and for a range of XSC materials.
The semi-classical transport models discussed above treat charge carriers as localized wavepackets in momentum (drift–diffusion) and position (KMC) space to compute their classical trajectory. However, for distances comparable to the carrier wavelength (1–10 nm) and much smaller than the carrier mean free path this picture breaks down, making quantum mechanical models necessary to study transport at very short length scale. Transport in this regime is defined as ballistic (or coherent) if no scattering processes occur, and quasi-ballistic (or super-diffusive) if only a few scattering processes occur before the carriers reach the contacts. A widely employed method to study ballistic transport is the non-equilibrium Green's function (NEGF) formalism,174 which can also account for carrier–carrier and carrier–phonon scattering, though it is more commonly used in the ballistic regime. NEGF computes the transmission probability of electrons through an open system under study coupled with two semi-infinite contacts. The current is computed as a function of the applied bias between the contacts, thus yielding current–voltage curves from first-principles atomistic calculations; an excellent review of the method can be found in ref. 174. NEGF based on atomistic DFT calculations, as possible using the TranSIESTA code,175 can currently study transport only in small molecular systems due to computational cost. Extending the NEGF method to the ∼10 nm length scale would enable ab initio studies of transport in nanostructures accounting for the atomistic details of the system. If such a length scale were reached, NEGF would become an interesting tool in modeling nanostructured solar cells.
3.3 Sunlight management across length scales
Sunlight harvesting is the first step in solar energy conversion. Engineering photon propagation in solar cells, a research area known as light management (LM), plays a central role in PV research. The goal of LM is to maximize the intensity of sunlight in an active layer with a given geometry, or to up/down-convert the photon energy to more efficiently harness the solar spectrum. Fig. 2 shows that LM encompasses all the length scales involved in PV from nm to meter. Modeling LM thus requires a wide range of theoretical and computational tools.
Several LM approaches have been employed at the nm–μm scale. Within a simple ray optics model of light propagation, the absorbance of an active layer with absorption coefficient α(E) is A(E) = 1 − exp[α(E)Leff], where Leff is the length of the path traveled by light, and the product αLeff is called the optical thickness. LM focuses on constructing optically thick but physically thin PV active layers by trapping light or enhancing absorption. Perhaps the simplest and most widely used approach to trap light is a corrugated active layer with a rough surface or coating, resulting in an absorbance increase by up to a factor of 4n2 (n is the refractive index), the so-called ergodic limit corresponding to maximally trapped light.176 Metallic nanostructures are able to enhance light scattering, guide light into waveguide modes, or create strong local fields by exciting surface plasmon polaritons.27,177 In all these scenarios, the desired effects can be achieved by introducing nm–μm metallic structures in the active layer, resulting in an increased IQE over a range of light frequencies. Alternative LM strategies include luminescent solar concentrators that absorb and selectively re-emit light in the active layer,178 or nanostructures able to restrict the light emission angle to potentially reduce entropy losses due to light emission.28,179
Computational methods available to study LM at the nm–μm scale focus on computing the electromagnetic field within the active layer by solving Maxwell's equations. Among different possible implementations, a popular choice is finite-difference time-domain (FDTD) simulations propagating Maxwell's equation in time using real-space grids. The FDTD approach is implemented for example in the widely used MEEP open source code.180 Maxwell's equations can be solved with MEEP to obtain the electrical and magnetic fields in materials using a variety of boundary conditions. In MEEP, materials are described by their dielectric function ε and permeability μ, which are in general anisotropic tensors that depend on position and frequency. The code can use as input arbitrary anisotropic dielectric tensors, in which the frequency dependence is introduced as a fit to multiple Drude–Lorentz oscillators. The approach is versatile and widely used in nanostructured PV solar cells, but is currently limited to materials in which the optical properties are known from experiment. When not available in reference handbooks, the dielectric tensor needs to be measured, for example by ellipsometry, or computed using the methods described in Section 3.1; in both cases, the frequency dependence then needs to be represented by multiple Drude–Lorentz oscillators, using a fitting procedure that is somewhat prone to errors.
Alternative approaches are emerging that can propagate in time both Maxwell's equations to describe the electromagnetic field and the time-dependent Kohn–Sham equations to compute the electronic response to light in the material.181 The two sets of equations are coupled: the vector potential computed with Maxwell's equations is used as an input in the Kohn–Sham time-dependent equations, and the microscopic current computed from the Kohn–Sham orbitals enters Maxwell's equations. A coarser grid with ∼μm spacing is used for Maxwell's equations, while a finer grid with ∼nm spacing is necessary to converge the Kohn–Sham equations.181 The multi-grid and multi-scale character of the method is intriguing, and the approach is non-perturbative so that even experiments on solar cells under laser illumination can be modeled. The main benefit is that the optical properties of the material are not needed as input, but rather are computed in real time using the electronic response. While this approach in principle allows one to study light propagation in novel materials without measuring their dielectric function, two main drawbacks need to be considered. From a practical viewpoint, the multi-grid calculations are computationally very expensive, requiring MPI and OpenMP parallelization together with considerable computational resources (over 10000 compute cores in a typical calculation). These requirements are in contrast with MEEP calculations, which typically employ only ∼1–10 cores. Besides computational resources, accuracy is a concern. If the common adiabatic LDA approximation of the exchange–correlation potential is used in the time-dependent Kohn–Sham equations, the electronic response lacks memory and fails to accurately describe quasiparticle and excitonic effects. More expensive kernels with linear-response accuracy comparable to BSE have been developed,182,183 but have not yet been employed to propagate the Kohn–Sham equations in real time.
Sunlight harvesting can also be optimized using LM at the macroscopic (i.e., solar panel) length scale. At any location, the Sun subtends an arc-shaped apparent trajectory with an elevation dependent on latitude and season. Solar cells are employed in flat form in rooftop installations and are commonly oriented using simple rules of thumb to optimize solar energy collection. This approach yields far-from-optimal sunlight harvesting and coupling with the Sun's trajectory. Sun-tracking systems can extend the range of useful peak hours, but are costly and not well suited for residential or commercial installations. A surprising fact about sunlight harvesting is that even two solar cells with the same AM1.5 efficiency generally perform differently in real conditions due to the different dependence of the efficiency on incident sunlight angle. For example, XSCs commonly yield 20–30% higher energy generation over a year than Si panels of identical AM1.5 efficiency, as a result of the increased optical thickness of the active layer for higher incident angles, leading to improvements of the off-peak performance of XSCs. This trend partially compensates the incomplete sunlight absorption in XSC active layers.
Given the complexity of sunlight absorption in solar cells, an important question to manage sunlight is how to arrange solar panels to best couple with the Sun's trajectory at a given location, and maximize solar energy collection throughout the year for a solar cell with a given angle-dependent PCE. We studied the problem of collecting solar energy in arbitrary geometries of solar cells and mirrors arranged in three dimensions (3D) by developing a code that can numerically solve Maxwell's equations within the simplified ray optics formalism.30,184 The code computes the Sun's trajectory for the particular day and location specified by the user, and propagates light rays onto solar cells with user-defined position, shape, reflectivity and power conversion efficiency. The main routine computes the total energy generated during a given period of time and for a given location by the 3D assembly of panels and mirrors. The code has been validated against outdoor experiments, showing excellent agreement. Since the energy can be expressed as an objective function of the solar cell and mirror coordinates, one can also optimize the solar cells position and shape to maximize the generated energy using standard Monte Carlo (MC) and genetic algorithm (GA) techniques, both implemented in the code and employed to find optimal 3D arrangements of solar cells.30,184 A number of technical challenges remain to compute and optimize the energy generated in 3D assemblies of mirrors and solar panels. We refer the reader to ref. 30 and 184 for a technical discussion.
3.4 Summary of computer codes to model solar cells
Since modeling solar cells is a multi-faceted problem, it is important to recognize the key physical processes governing the PV problem under study and identify appropriate computational tools. Table 1 summarizes the methods and some of the computer codes available to model different processes in solar cells, as discussed in this review.
Table 1 Methods and codes to model solar cells




Method
Main computer codes




DFT
Quantum ESPRESSO,96 VASP,97


ABINIT,185 SIESTA,98 GPAW186


GW-BSE
Yambo,105 BerkeleyGW,106


WEST,108 GPAW,186 VASP97


TD-DFT
Octopus,118 QCHEM,114 Gaussian,113 GPAW186






Transport coefficients
BoltzWann,149 BoltzTrap151


Ballistic transport
TranSIESTA,175 GPAW186


Drift–diffusion
COMSOL187


Kinetic Monte Carlo
SPPARKS188






Light propagation and Maxwell's equations
MEEP,180 Lumerical,189 COMSOL187


Macroscopic light management
In-house code,30,184 COMSOL187




4 Outlook and future challenges
We close our discussion of computational methods in PV with an analysis of current trends and future challenges in the field. Over the last three decades, the ab initio community has focused extensively on computing the energy of quasiparticles and excited states employing DFT, GW-BSE and related methods.91 Typical calculations of relevance in PV and optoelectronics include quasiparticle bandstructures and band gaps, band offsets, and absorption spectra. Only recently ab initio calculations have begun addressing the problem of dynamics of excited electrons and excitons, both using perturbative32,154,155,158 and non-perturbative143,144,190 methods. The advent of ultrafast spectroscopies able to probe carrier dynamics at the fs–ns time scale, over which key PV physical processes occur, suggests that fundamental understanding of solar cells can be advanced by joint experimental and computational studies of ultrafast carrier dynamics.
Computations of transport and carrier dynamics at longer time scales face at least two challenges. First, ab initio calculations of carrier mobilities and diffusion lengths beyond the constant relaxation time approximation need to be developed by computing the rate of electron scattering with phonons and defects. This would make transport calculations entirely parameter-free, while at present relaxation times are used as empirical or fitting parameters. Extended defects such as grain boundaries191 and interfaces are particularly important in CSCs, but are challenging to model with ab initio calculations due to the large number of atoms in extended defects. Trapping at deep impurity states and defect scattering has received little attention from the ab initio community despite being a crucial issue in CSC active layer materials.147,192 Bridging ab initio calculations of mobilities and conductivities to device-scale drift–diffusion or Monte Carlo simulations also appears to be an important challenge to comprehensively model solar cells. The main goal in this area is to obtain current–voltage curves for devices under operating conditions. Since current–voltage curves depend on the device geometry and non-equilibrium carrier dynamics, they are not intrinsic properties of the active layer material. This implies that different calculations need to be carried out for each specific device and experiment to be modeled.
Another research direction in PV is the automated, high-throughput (HT) search of novel active layer materials for solar cells. The Materials Project193 introduced workflows to compute the properties of materials using HT ab initio calculations and store the results in large-scale databases. Other HT projects were later created, some of which are looking for active layer materials for CSCs and organic XSCs.125 While the most recent breakthrough in new materials for PV, namely metal–organic perovskite active layers,50 was produced from experiment rather than HT computation, improvements in HT searches of PV materials may help find new active layer materials in the future. A critical point for HT computations in PV is the accuracy of band gaps and band offsets calculations, for which many-body methods such as GW are necessary, rather than DFT based on LDA or GGA exchange–correlation functionals as currently implemented in most HT schemes. However, determining band gaps, band offsets, and absorption spectra is not enough to find a good material for PV. The relevant criteria for a good PV candidate material should include, at least, a band gap in the 1–2 eV range, long (e.g. above 1 μm) carrier diffusion lengths, absorption lengths of order 100 nm, the possibility to fabricate the material with sufficient purity and low defect concentration, and stability under exposure to sunlight and moisture. Some of these aspects are clearly very challenging to assess computationally even for single (and simple) materials, let alone to include in HT searches. In particular, screening materials for stability against moisture and light exposure appears to be particularly challenging. Recent advances in computing Pourbaix diagrams194 offer new insight into the problem of materials stability in the presence of moisture, and are promising to design stable PV materials.
The computational methods described in this article can be employed to investigate the behavior of carriers, excitons and photons over a range of time and length scales. Computation can aid design of active layer materials, contacts, solar cell geometry and solar panel arrangement, as well as provide microscopic interpretation of experiments in PV. Multi-scale simulations bridging the nanoscale to the device scale appear possible by combining different methods. Atomistic ab initio calculations can be employed to model the nanoscale, while transport at the device scale can be simulated using semiclassical models with ab initio derived parameters to obtain the current–voltage curves and efficiency. Calculations at the solar panel scale further enable optimization of solar energy collection at specific locations30 by taking into account season, weather, and angle-dependent efficiency effects, as described above. Such a comprehensive approach to perform multi-scale PV simulations involves a sequence of steps in which parameters are extracted from shorter length and time scales and transferred to methods computing progressively longer time and length scales. More work is necessary to seamlessly perform multi-scale simulations in a single framework without suffering from the fragmentation and parameter transfer among methods designed to study processes at different length and time scales.
The computational approaches and workflows reviewed in this article can also be applied to study photocatalysis and other solar conversion devices. In summary, the fact that multi-scale simulations of solar energy conversion may be within reach constitutes a remarkable achievement of computation in mastering the complexity of renewable energy devices.
Acknowledgements
MB thanks the California Institute of Technology for start-up funds and NERSC for computational resources. MB acknowledges partial support from the Joint Center for Artificial Photosynthesis, a DOE Energy Innovation Hub, as follows: the development of part of this review article was supported through the Office of Science of the U.S. Department of Energy under Award No. DE-SC0004993. JCG is grateful for support from the Eni Solar Frontiers Program at MIT.
References
The Future of Solar Energy: http://mitei.mit.edu/futureofsolar.
D. Ginley, M. A. Green and R. Collins, MRS Bull., 2008, 33, 355–364 CrossRef CAS .
M. Liu, M. B. Johnston and H. J. Snaith, Nature, 2013, 501, 395–398 CrossRef CAS PubMed .
G. Li, R. Zhu and Y. Yang, Nat. Photonics, 2012, 6, 153–161 CrossRef CAS .
A. Mishra and P. Bäuerle, Angew. Chem., Int. Ed., 2012, 51, 2020–2067 CrossRef CAS PubMed .
E. H. Sargent, Nat. Photonics, 2012, 6, 133–135 CrossRef CAS .
C.-H. M. Chuang, P. R. Brown, V. Bulović and M. G. Bawendi, Nat. Mater., 2014, 13, 796–801 CrossRef CAS PubMed .
P. R. Brown, D. Kim, R. R. Lunt, N. Zhao, M. G. Bawendi, J. C. Grossman and V. Bulovic, ACS Nano, 2014, 8, 5863 CrossRef CAS PubMed .
M. Grätzel, Acc. Chem. Res., 2009, 42, 1788–1798 CrossRef PubMed .
N.-G. Park, J. Phys. Chem. Lett., 2013, 4, 2423–2429 CrossRef CAS .
M. Bernardi, J. Lohrman, P. V. Kumar, A. Kirkeminde, N. Ferralis, J. C. Grossman and S. Ren, ACS Nano, 2012, 6, 8896–8903 CrossRef CAS PubMed .
M. P. Ramuz, M. Vosgueritchian, P. Wei, C. Wang, Y. Gao, Y. Wu, Y. Chen and Z. Bao, ACS Nano, 2012, 6, 10384–10395 CrossRef CAS PubMed .
M. Gong, T. A. Shastry, Y. Xie, M. Bernardi, D. Jasion, K. A. Luck, T. J. Marks, J. C. Grossman, S. Ren and M. C. Hersam, Nano Lett., 2014, 14, 5308–5314 CrossRef CAS PubMed .
The AM1.5G spectrum was taken from the NREL website: http://rredc.nrel.gov/solar/spectra/am1.5 and integrated with the trapezoid rule.

          P. Wurfel, Physics of Solar Cells, Wiley-VCH, Weinheim,  2009 Search PubMed .
B. A. Gregg, MRS Bull., 2005, 30, 20–22 CrossRef CAS .
B. A. Gregg, J. Phys. Chem. B, 2003, 107, 4688–4698 CrossRef CAS .

          R. S. Knox, Theory of Excitons, Academic Press, New York,  1963, vol. 5 Search PubMed .
G. D. Scholes and G. Rumbles, Nat. Mater., 2006, 5, 683–696 CrossRef CAS PubMed .
B. O'Regan and M. Grätzel, Nature, 1991, 353, 737–740 CrossRef .
M. Grätzel, R. J. Janssen, D. B. Mitzi and E. H. Sargent, Nature, 2012, 488, 304–312 CrossRef PubMed .
V. D'Innocenzo, G. Grancini, M. J. Alcocer, A. R. S. Kandada, S. D. Stranks, M. M. Lee, G. Lanzani, H. J. Snaith and A. Petrozza, Nat. Commun., 2014, 5, 3586 Search PubMed .
M. A. Green, A. Ho-Baillie and H. J. Snaith, Nat. Photonics, 2014, 8, 506–514 CrossRef CAS .
S. D. Stranks and H. J. Snaith, Nat. Nanotechnol., 2015, 10, 391–402 CrossRef CAS PubMed .
L. Yu and A. Zunger, Phys. Rev. Lett., 2012, 108, 068701 CrossRef PubMed .
M. Bernardi and J. C. Grossman, J. Phys. Chem. C, 2013, 117, 26896–26904 CAS .
A. Polman and H. A. Atwater, Nat. Mater., 2012, 11, 174–177 CrossRef CAS PubMed .
H. A. Atwater and A. Polman, Nat. Mater., 2010, 9, 205–213 CrossRef CAS PubMed .
A. Luque, G. Sala and I. Luque-Heredia, Prog. Photovoltaics, 2006, 14, 413–428 Search PubMed .
M. Bernardi, N. Ferralis, J. H. Wan, R. Villalon and J. C. Grossman, Energy Environ. Sci., 2012, 5, 6880–6884 CAS .

          J. Shah, Ultrafast Spectroscopy of Semiconductors and Semiconductor Nanostructures, Springer,  1999 Search PubMed .
M. Bernardi, D. Vigil-Fowler, J. Lischner, J. B. Neaton and S. G. Louie, Phys. Rev. Lett., 2014, 112, 257402 CrossRef PubMed .
A. M. Kolpak and J. C. Grossman, Nano Lett., 2011, 11, 3156–3162 CrossRef CAS PubMed .

          B. H. Bransden and C. J. Joachain, Physics of Atoms and Molecules,  2003 Search PubMed .
M. B. Smith and J. Michl, Chem. Rev., 2010, 110, 6891–6936 CrossRef CAS PubMed .
D. N. Congreve, J. Lee, N. J. Thompson, E. Hontz, S. R. Yost, P. D. Reusswig, M. E. Bahlke, S. Reineke, T. Van Voorhis and M. A. Baldo, Science, 2013, 340, 334–337 CrossRef CAS PubMed .
B. J. Walker, A. J. Musser, D. Beljonne and R. H. Friend, Nat. Chem., 2013, 5, 1019–1024 CrossRef CAS PubMed .

          W. Demtröder, Molecular Physics, Wiley,  2008 Search PubMed .
A. A. Bakulin, A. Rao, V. G. Pavelyev, P. H. van Loosdrecht, M. S. Pshenichnikov, D. Niedzialek, J. Cornil, D. Beljonne and R. H. Friend, Science, 2012, 335, 1340–1344 CrossRef CAS PubMed .
A. E. Jailaubekov, A. P. Willard, J. R. Tritsch, W.-L. Chan, N. Sai, R. Gearba, L. G. Kaake, K. J. Williams, K. Leung and P. J. Rossky, 
            et al.
          , Nat. Mater., 2012, 12, 66–73 CrossRef PubMed .
G. Grancini, M. Maiuri, D. Fazzi, A. Petrozza, H. Egelhaaf, D. Brida, G. Cerullo and G. Lanzani, Nat. Mater., 2012, 12, 29–33 CrossRef PubMed .
K. Vandewal, S. Albrecht, E. T. Hoke, K. R. Graham, J. Widmer, J. D. Douglas, M. Schubert, W. R. Mateker, J. T. Bloking and G. F. Burkhard, 
            et al.
          , Nat. Mater., 2014, 13, 63–68 CrossRef CAS PubMed .
A. Melianas, F. Etzold, T. J. Savenije, F. Laquai, O. Inganäs and M. Kemerink, Nat. Commun., 2015, 6, 8778 CrossRef CAS PubMed .
P. Allen, Contemp. Concepts Condens. Matter Sci., v6, 2006, 2, 165–218 Search PubMed .

          M. Lundstrom, Fundamentals of Carrier Transport, Cambridge University Press,  2009 Search PubMed .
M. Lundstrom, Sol. Cells, 1988, 24, 91–102 CrossRef CAS .

          O. Madelung, Semiconductors: Data Handbook, Springer Berlin,  2004, vol. 3 Search PubMed .
R. Jayakrishnan, S. Gandhi and P. Suratkar, Mater. Sci. Semicond. Process., 2011, 14, 223–228 CrossRef CAS .
O. D. Miller, E. Yablonovitch and S. R. Kurtz, IEEE J. Photovolt., 2012, 2, 303–311 CrossRef .
S. D. Stranks, G. E. Eperon, G. Grancini, C. Menelaou, M. J. P. Alcocer, T. Leijtens, L. M. Herz, A. Petrozza and H. J. Snaith, Science, 2013, 342, 341–344 CrossRef CAS PubMed .
J. M. Frost, F. Cheynis, S. M. Tuladhar and J. Nelson, Nano Lett., 2006, 6, 1674–1681 CrossRef CAS PubMed .
O. V. Mikhnenko, H. Azimi, M. Scharber, M. Morana, P. W. M. Blom and M. A. Loi, Energy Environ. Sci., 2012, 5, 6960–6965 CAS .
D. E. Markov, E. Amsterdam, P. W. Blom, A. B. Sieval and J. C. Hummelen, J. Phys. Chem. A, 2005, 109, 5266–5274 CrossRef CAS PubMed .
H. Najafov, B. Lee, Q. Zhou, L. Feldman and V. Podzorov, Nat. Mater., 2010, 9, 938–943 CrossRef CAS PubMed .
F. Wang, G. Dukovic, L. E. Brus and T. F. Heinz, Phys. Rev. Lett., 2004, 92, 177401 CrossRef PubMed .
A. C. Mayer, S. R. Scully, B. E. Hardin, M. W. Rowell and M. D. McGehee, Mater. Today, 2007, 10, 28–33 CrossRef CAS .
A. B. Walker, Proc. IEEE, 2009, 97, 1587–1596 CrossRef CAS .
C. Groves, Energy Environ. Sci., 2013, 6, 3202–3217 CAS .
J. L. Bredas and G. B. Street, Acc. Chem. Res., 1985, 18, 309–315 CrossRef CAS .
J. T. Devreese and A. S. Alexandrov, Rep. Prog. Phys., 2009, 72, 066501 CrossRef .
L. D. Landau, Phys. Z. Sowjetunion, 1933, 3, 664 CAS .
I. Austin and N. F. Mott, Adv. Phys., 1969, 18, 41–102 CrossRef CAS .
L. Koster, E. Smits, V. Mihailetchi and P. Blom, Phys. Rev. B: Condens. Matter Mater. Phys., 2005, 72, 085205 CrossRef .
J. A. Barker, C. M. Ramsdale and N. C. Greenham, Phys. Rev. B: Condens. Matter Mater. Phys., 2003, 67, 075205 CrossRef .
R. G. Kimber, E. N. Wright, S. E. O'Kane, A. B. Walker and J. C. Blakesley, Phys. Rev. B: Condens. Matter Mater. Phys., 2012, 86, 235206 CrossRef .
W. Pasveer, J. Cottaar, C. Tanase, R. Coehoorn, P. Bobbert, P. Blom, D. De Leeuw and M. Michels, Phys. Rev. Lett., 2005, 94, 206601 CrossRef CAS PubMed .
L. Koster, Phys. Rev. B: Condens. Matter Mater. Phys., 2010, 81, 205318 CrossRef .
K. Hannewald and P. Bobbert, Appl. Phys. Lett., 2004, 85, 1535–1537 CrossRef CAS .
K. Hannewald and P. Bobbert, Phys. Rev. B: Condens. Matter Mater. Phys., 2004, 69, 075212 CrossRef .
S. Athanasopoulos, J. Kirkpatrick, D. Martnez, J. M. Frost, C. M. Foden, A. B. Walker and J. Nelson, Nano Lett., 2007, 7, 1785–1788 CrossRef CAS PubMed .
D. Chen, A. Nakahara, D. Wei, D. Nordlund and T. P. Russell, Nano Lett., 2010, 11, 561–567 CrossRef PubMed .
H. Hoppe and N. S. Sariciftci, J. Mater. Chem., 2006, 16, 45–61 RSC .
F. Yang and S. R. Forrest, ACS Nano, 2008, 2, 1022–1032 CrossRef CAS PubMed .
T. M. Burke and M. D. McGehee, Adv. Mater., 2014, 26, 1923–1928 CrossRef CAS PubMed .
Y. Yao, J. Hou, Z. Xu, G. Li and Y. Yang, Adv. Funct.
Mater., 2008, 18, 1783–1789 CrossRef CAS .
I. McCulloch, M. Heeney, C. Bailey, K. Genevicius, I. MacDonald, M. Shkunov, D. Sparrowe, S. Tierney, R. Wagner and W. Zhang, 
            et al.
          , Nat. Mater., 2006, 5, 328–333 CrossRef CAS PubMed .
P. Peumans, S. Uchida and S. R. Forrest, Nature, 2003, 425, 158–162 CrossRef CAS PubMed .
M. Riede, T. Mueller, W. Tress, R. Schueppel and K. Leo, Nanotechnology, 2008, 19, 424001 CrossRef CAS PubMed .
H. Li, D. Zhitomirsky and J. C. Grossman, Chem. Mater., 2016, 28, 1888–1896 CrossRef CAS .
G. Garcia-Belmonte, P. P. Boix, J. Bisquert, M. Sessolo and H. J. Bolink, Sol. Energy Mater. Sol. Cells, 2010, 94, 366–375 CrossRef CAS .
T. M. Clarke and J. R. Durrant, Chem. Rev., 2010, 110, 6736–6767 CrossRef CAS PubMed .
S. Shoaee, M. P. Eng, E. Espildora, J. L. Delgado, B. Campo, N. Martin, D. Vanderzande and J. R. Durrant, Energy Environ. Sci., 2010, 3, 971–976 CAS .
A. Maurano, C. G. Shuttle, R. Hamilton, A. M. Ballantyne, J. Nelson, W. Zhang, M. Heeney and J. R. Durrant, J. Phys. Chem. C, 2011, 115, 5947–5957 CAS .
C. G. Shuttle, B. O'Regan, A. M. Ballantyne, J. Nelson, D. D. Bradley and J. R. Durrant, Phys. Rev. B: Condens. Matter Mater. Phys., 2008, 78, 113201 CrossRef .
S. Massip, P. M. Oberhumer, G. Tu, S. Albert-Seifried, W. T. S. Huck, R. H. Friend and N. C. Greenham, J. Phys. Chem. C, 2011, 115, 25046–25055 CAS .
H. Ohkita, S. Cook, Y. Astuti, W. Duffy, S. Tierney, W. Zhang, M. Heeney, I. McCulloch, J. Nelson and D. D. Bradley, 
            et al.
          , J. Am. Chem. Soc., 2008, 130, 3030–3042 CrossRef CAS PubMed .
M. C. Scharber, D. Mühlbacher, M. Koppe, P. Denk, C. Waldauf, A. J. Heeger and C. J. Brabec, Adv. Mater., 2006, 18, 789–794 CrossRef CAS .
R. R. Lunt, T. P. Osedach, P. R. Brown, J. A. Rowehl and V. Bulović, Adv. Mater., 2011, 23, 5712–5727 CrossRef CAS PubMed .
W. Shockley and H. J. Queisser, J. Appl. Phys., 1961, 32, 510–519 CrossRef CAS .

          R. M. Martin, Electronic Structrure: Basic Theory and Practical Methods, Cambridge University Press,  2008 Search PubMed .
G. Onida, L. Reining and A. Rubio, Rev. Mod. Phys., 2002, 74, 601–659 CrossRef CAS .
J. P. Perdew, MRS Bull., 2013, 38, 743–750 CrossRef CAS .

          W. G. Aulbur, L. Jonsson, J. W. Wilkins, Solid State Physics-Advances in Research and Applications,  1999, pp. 89–132 Search PubMed .
M. S. Hybertsen and S. G. Louie, Phys. Rev. B: Condens. Matter Mater. Phys., 1986, 34, 5390–5413 CrossRef CAS .

          S. Louie, in Conceptual Foundations of Materials A Standard Model for Ground- and Excited-State Properties, ed. S. G. Louie and M. L. Cohen, Elsevier,  2006, vol. 2, pp. 9–53 Search PubMed .
P. Giannozzi, S. Baroni, N. Bonini, M. Calandra, R. Car, C. Cavazzoni, D. Ceresoli, G. L. Chiarotti, M. Cococcioni and I. Dabo, 
            et al.
          , J. Phys.: Condens. Matter, 2009, 21, 395502 CrossRef PubMed .
G. Kresse and J. Furthmüller, Phys. Rev. B: Condens. Matter Mater. Phys., 1996, 54, 11169 CrossRef CAS .
J. M. Soler, E. Artacho, J. D. Gale, A. Garca, J. Junquera, P. Ordejón and D. Sánchez-Portal, J. Phys.: Condens. Matter, 2002, 14, 2745 CrossRef CAS .
L. Kronik, T. Stein, S. Refaely-Abramson and R. Baer, J. Chem. Theory Comput., 2012, 8, 1515–1531 CrossRef CAS PubMed .
I. Dabo, A. Ferretti, C.-H. Park, N. Poilvert, Y. Li, M. Cococcioni and N. Marzari, Phys. Chem. Chem. Phys., 2013, 15, 685–695 RSC .

          I. Dabo, A. Ferretti and N. Marzari, First Principles Approaches to Spectroscopic Properties of Complex Materials, Springer,  2014, pp. 193–233 Search PubMed .
O. Gritsenko, R. van Leeuwen, E. van Lenthe and E. J. Baerends, Phys. Rev. A: At., Mol., Opt., 1995, 51, 1944–1954 CrossRef CAS .
M. Kuisma, J. Ojanen, J. Enkovaara and T. T. Rantala, Phys. Rev. B: Condens. Matter Mater. Phys., 2010, 82, 115106 CrossRef .

          L. Hedin and S. Lundqvist, Effects of Electron–Electron and Electron–Phonon Interactions on the One-Electron States of Solids, Academic Press,  1970, vol. 23, pp. 1–181 Search PubMed .
A. Marini, C. Hogan, M. Gruning and D. Varsano, Comput. Phys. Commun., 2009, 180, 1392–1403 CrossRef CAS .
J. Deslippe, G. Samsonidze, D. A. Strubbe, M. Jain, M. L. Cohen and S. G. Louie, Comput. Phys. Commun., 2012, 183, 1269–1289 CrossRef CAS .
G. Samsonidze, C.-H. Park and B. Kozinsky, J. Phys.: Condens. Matter, 2014, 26, 475501 CrossRef PubMed .
M. Govoni and G. Galli, J. Chem. Theory Comput., 2015, 11, 2680–2696 CrossRef CAS PubMed .
M. Rohlfing and S. G. Louie, Phys. Rev. B: Condens. Matter Mater. Phys., 2000, 62, 4927 CrossRef CAS .
J. Noffsinger, E. Kioupakis, C. G. Van de Walle, S. G. Louie and M. L. Cohen, Phys. Rev. Lett., 2012, 108, 167402 CrossRef PubMed .

          C. J. Cramer, Essentials of Computational Chemistry: Theories and Models, John Wiley & Sons,  2013 Search PubMed .
C. D. Sherrill and H. F. Schaefer, Adv. Quantum Chem., 1999, 34, 143–269 CrossRef CAS .

          M. J. Frisch, G. W. Trucks, H. B. Schlegel and G. E. Scuseria, et al., Gaussian 09, Revision D.01, Gaussian Inc., Wallingford CT,  2009 Search PubMed .
Y. Shao, Z. Gan, E. Epifanovsky and A. T. B. Gilbert, 
            et al.
          , Mol. Phys., 2015, 113, 184–215 CrossRef CAS .

          H. Haug, A.-P. Jauho and M. Cardona, Quantum Kinetics in Transport and Optics of Semiconductors, Springer,  2008, vol. 2 Search PubMed .

          G. Stefanucci and R. van Leeuwen, Nonequilibrium Many-Body Theory of Quantum Systems: A Modern Introduction, Cambridge University Press,  2013 Search PubMed .
K. Yabana and G. Bertsch, Phys. Rev. B: Condens. Matter Mater. Phys., 1996, 54, 4484 CrossRef CAS .
M. A. Marques, A. Castro, G. F. Bertsch and A. Rubio, Comput. Phys. Commun., 2003, 151, 60–78 CrossRef CAS .
A. Schleife, E. W. Draeger, Y. Kanai and A. A. Correa, J. Chem. Phys., 2012, 137, 22A546 CrossRef PubMed .
D. Sangalli and A. Marini, J. Phys.: Conf. Ser., 2015, 609, 12006–12010 CrossRef .
Z. Wu, Y. Kanai and J. C. Grossman, Phys. Rev. B: Condens. Matter Mater. Phys., 2009, 79, 201309 CrossRef .
Y. Kanai and J. C. Grossman, Nano Lett., 2008, 8, 908–912 CrossRef CAS PubMed .
M. Giantomassi, M. Stankovski, R. Shaltaf, M. Gruning, F. Bruneval, P. Rinke and G.-M. Rignanese, Phys. Status Solidi B, 2011, 248, 275 CrossRef CAS .
Y. Hinuma, A. Grüneis, G. Kresse and F. Oba, Phys. Rev. B: Condens. Matter Mater. Phys., 2014, 90, 155405 CrossRef .
J. Hachmann, R. Olivares-Amaya, S. Atahan-Evrenk, C. Amador-Bedolla, R. S. Sánchez-Carrera, A. Gold-Parker, L. Vogt, A. M. Brockway and A. Aspuru-Guzik, J. Phys. Chem. Lett., 2011, 2, 2241–2251 CrossRef CAS .
M. Bernardi, M. Palummo and J. C. Grossman, Nano Lett., 2013, 13, 3664–3670 CrossRef CAS PubMed .
R. Ramesh, Nat. Mater., 2012, 11, 178 CrossRef CAS PubMed .
I. E. Castelli, F. Hüser, M. Pandey, H. Li, K. S. Thygesen, B. Seger, A. Jain, K. A. Persson, G. Ceder and K. W. Jacobsen, Adv. Energy Mater., 2015, 5, 1400915 Search PubMed .
I. E. Castelli, T. Olsen, S. Datta, D. D. Landis, S. Dahl, K. S. Thygesen and K. W. Jacobsen, Energy Environ. Sci., 2012, 5, 5814–5819 CAS .
M. Bernardi, M. Palummo and J. C. Grossman, ACS Nano, 2012, 6, 10082–10089 CrossRef CAS PubMed .
D. Shi, V. Adinolfi, R. Comin, M. Yuan, E. Alarousu, A. Buin, Y. Chen, S. Hoogland, A. Rothenberger and K. Katsiev, 
            et al.
          , Science, 2015, 347, 519–522 CrossRef CAS PubMed .
J. M. Frost, K. T. Butler, F. Brivio, C. H. Hendon, M. Van Schilfgaarde and A. Walsh, Nano Lett., 2014, 14, 2584–2590 CrossRef CAS PubMed .
M. R. Filip, G. E. Eperon, H. J. Snaith and F. Giustino, Nat. Commun., 2014, 5, 5757 CrossRef CAS PubMed .
P. Umari, E. Mosconi and F. De Angelis, Sci. Rep., 2014, 4, 4467 Search PubMed .
I. E. Castelli, J. M. Garca-Lastra, K. S. Thygesen and K. W. Jacobsen, APL Mater., 2014, 2, 081514 CrossRef .
W.-J. Yin, T. Shi and Y. Yan, Appl. Phys. Lett., 2014, 104, 063903 CrossRef .
J. L. Miller, Phys. Today, 2014, 67, 13–15 CrossRef CAS .
F. Zheng, L. Z. Tan, S. Liu and A. M. Rappe, Nano Lett., 2015, 15, 7794–7800 CrossRef CAS PubMed .
H. J. Snaith, A. Abate, J. M. Ball, G. E. Eperon, T. Leijtens, N. K. Noel, S. D. Stranks, J. T.-W. Wang, K. Wojciechowski and W. Zhang, J. Phys. Chem. Lett., 2014, 5, 1511–1515 CrossRef CAS PubMed .
W. Tress, N. Marinova, T. Moehl, S. Zakeeruddin, M. K. Nazeeruddin and M. Grätzel, Energy Environ. Sci., 2015, 8, 995–1004 CAS .
E. Mosconi, A. Amat, M. K. Nazeeruddin, M. Grätzel and F. De Angelis, J. Phys. Chem. C, 2013, 117, 13902–13913 CAS .
S. Meng and E. Kaxiras, Nano Lett., 2010, 10, 1238–1247 CrossRef CAS PubMed .
S. M. Falke, C. A. Rozzi, D. Brida, M. Maiuri, M. Amato, E. Sommer, A. De Sio, A. Rubio, G. Cerullo and E. Molinari, 
            et al.
          , Science, 2014, 344, 1001–1005 CrossRef CAS PubMed .
C. A. Rozzi, S. M. Falke, N. Spallanzani, A. Rubio, E. Molinari, D. Brida, M. Maiuri, G. Cerullo, H. Schramm and J. Christoffers, 
            et al.
          , Nat. Commun., 2013, 4, 1602 CrossRef PubMed .
A. Dreuw and M. Head-Gordon, J. Am. Chem. Soc., 2004, 126, 4007–4016 CrossRef CAS PubMed .

          G. D. Mahan, Condensed Matter in a Nutshell, Princeton University Press,  2010 Search PubMed .
J. Jean, P. R. Brown, R. L. Jaffe, T. Buonassisi and V. Bulovic, Energy Environ. Sci., 2015, 8, 1200–1219 CAS .
D. Vasileska and S. M. Goodnick, Synth. Lect. Comput. Electromagnet., 2005, 1, 1–216 CrossRef .
G. Pizzi, D. Volja, B. Kozinsky, M. Fornari and N. Marzari, Comput. Phys. Commun., 2014, 185, 422–429 CrossRef CAS .

          G. D. Mahan, Many-Particle Physics, Springer,  2000 Search PubMed .
G. K. Madsen and D. J. Singh, Comput. Phys. Commun., 2006, 175, 67–71 CrossRef CAS .
J. R. Yates, X. Wang, D. Vanderbilt and I. Souza, Phys. Rev. B: Condens. Matter Mater. Phys., 2007, 75, 195121 CrossRef .
D. Parker and D. J. Singh, Phys. Rev. B: Condens. Matter Mater. Phys., 2010, 82, 035204 CrossRef .
M. Bernardi, D. Vigil-Fowler, C. S. Ong, J. B. Neaton and S. G. Louie, Proc. Natl. Acad. Sci. U. S. A., 2015, 112, 5291–5296 CrossRef CAS PubMed .
M. Bernardi, J. Mustafa, J. B. Neaton and S. G. Louie, Nat. Commun., 2015, 6, 7044 CrossRef CAS PubMed .
V. Lordi, P. Erhart and D. Åberg, Phys. Rev. B: Condens. Matter Mater. Phys., 2010, 81, 235204 CrossRef .
O. Restrepo, K. Varga and S. Pantelides, Appl. Phys. Lett., 2009, 94, 212103 CrossRef .
M. Palummo, M. Bernardi and J. C. Grossman, Nano Lett., 2015, 15, 2794 CrossRef CAS PubMed .
L. Shi and L.-W. Wang, Phys. Rev. Lett., 2012, 109, 245501 CrossRef PubMed .

          S. Selberherr, Analysis and Simulation of Semiconductor Devices, Springer-Verlag, Wien,  1984 Search PubMed .
W. Tress, K. Leo and M. Riede, Phys. Rev. B: Condens. Matter Mater. Phys., 2012, 85, 155201 CrossRef .

          A. F. Voter, Radiation Effects in Solids, Springer,  2007, pp. 1–23 Search PubMed .
P. K. Watkins, A. B. Walker and G. L. Verschoor, Nano Lett., 2005, 5, 1814–1818 CrossRef CAS PubMed .
J. Van der Holst, F. Van Oost, R. Coehoorn and P. Bobbert, Phys. Rev. B: Condens. Matter Mater. Phys., 2011, 83, 085206 CrossRef .
J. Van Der Holst, M. Uijttewaal, B. Ramachandhran, R. Coehoorn, P. Bobbert, G. De Wijs and R. De Groot, Phys. Rev. B: Condens. Matter Mater. Phys., 2009, 79, 085203 CrossRef .
M. Mesta, M. Carvelli, R. J. de Vries, H. van Eersel, J. J. van der Holst, M. Schober, M. Furno, B. Lüssem, K. Leo and P. Loebl, 
            et al.
          , Nat. Mater., 2013, 12, 652–658 CrossRef CAS PubMed .
S. Himmelberger, K. Vandewal, Z. Fei, M. Heeney and A. Salleo, Macromolecules, 2014, 47, 7151–7157 CrossRef CAS .
S. Himmelberger and A. Salleo, MRS Commun., 2015, 5, 383–395 CrossRef CAS .
S. Ren, M. Bernardi, R. R. Lunt, V. Bulovic, J. C. Grossman and S. Gradecak, Nano Lett., 2011, 11, 5316–5321 CrossRef CAS PubMed .
J.-L. Brédas, D. Beljonne, V. Coropceanu and J. Cornil, Chem. Rev., 2004, 104, 4971–5004 CrossRef PubMed .
J. Kirkpatrick, Int. J. Quantum Chem., 2008, 108, 51–56 CrossRef CAS .
S. Lacic and O. Inganäs, J. Appl. Phys., 2005, 97, 124901 CrossRef .
S. Lee, D. Zhitomirsky and J. C. Grossman, Adv. Funct. Mater., 2016, 26, 1554–1562 CrossRef CAS .

          S. Datta, Electronic Transport in Mesoscopic Systems, Cambridge University Press,  1997 Search PubMed .
K. Stokbro, J. Taylor, M. Brandbyge and P. Ordejon, Ann. N. Y. Acad. Sci., 2003, 1006, 212–226 CrossRef CAS PubMed .
E. Yablonovitch and G. Cody, IEEE Trans. Electron Devices, 1982, 29, 300–305 CrossRef .
R. A. Pala, J. White, E. Barnard, J. Liu and M. L. Brongersma, Adv. Mater., 2009, 21, 3504–3509 CrossRef CAS .
W. G. van Sark, K. W. Barnham, L. H. Slooff, A. J. Chatten, A. Büchtemann, A. Meyer, S. J. McCormack, R. Koole, D. J. Farrell, R. Bose, E. E. Bende, A. R. Burgers, T. Budel, J. Quilitz, M. Kennedy, T. Meyer, C. D. M. Donegá, A. Meijerink and D. Vanmaekelbergh, Opt. Express, 2008, 16, 21773–21792 CrossRef CAS PubMed .
E. D. Kosten, B. K. Newman, J. V. Lloyd, A. Polman and H. A. Atwater, IEEE J. Photovolt., 2015, 5, 61–69 CrossRef .
A. F. Oskooi, D. Roundy, M. Ibanescu, P. Bermel, J. Joannopoulos and S. G. Johnson, Comput. Phys. Commun., 2010, 181, 687–702 CrossRef CAS .
S. A. Sato and K. Yabana, J. Adv. Simulat. Sci. Eng., 2014, 1, 98–110 CrossRef .
F. Sottile, V. Olevano and L. Reining, Phys. Rev. Lett., 2003, 91, 056402 CrossRef PubMed .
S. Sharma, J. Dewhurst, A. Sanna and E. Gross, Phys. Rev. Lett., 2011, 107, 186401 CrossRef CAS PubMed .
B. Myers, M. Bernardi and J. C. Grossman, Appl. Phys. Lett., 2010, 96, 071902 CrossRef .
X. Gonze, J.-M. Beuken, R. Caracas, F. Detraux, M. Fuchs, G.-M. Rignanese, L. Sindic, M. Verstraete, G. Zerah and F. Jollet, 
            et al.
          , Comput. Mater. Sci., 2002, 25, 478–492 CrossRef .
J. J. Mortensen, L. B. Hansen and K. W. Jacobsen, Phys. Rev. B: Condens. Matter Mater. Phys., 2005, 71, 035109 CrossRef .

          http://www.comsol.com
        .

          C. Garcia Cardona, E. B. Webb III, G. J. Wagner, V. Tikare, E. A. Holm, S. J. Plimpton, A. P. Thompson, A. Slepoy, X. W. Zhou and C. C. Battaile, et al., Crossing the Mesoscale No-Man's Land via Parallel Kinetic Monte Carlo, Sandia national laboratories technical report,  2009 Search PubMed .

          http://www.lumerical.com
        .
M. Schultze, K. Ramasesha, C. Pemmaraju, S. Sato, D. Whitmore, A. Gandman, J. S. Prell, L. Borja, D. Prendergast and K. Yabana, 
            et al.
          , Science, 2014, 346, 1348–1352 CrossRef CAS PubMed .
R. Raghunathan, E. Johlin and J. C. Grossman, Nano Lett., 2014, 14, 4943–4950 CrossRef CAS PubMed .
S. C. Siah, M. T. Winkler, D. M. Powell, S. W. Johnston, A. Kanevce, D. H. Levi and T. Buonassisi, J. Appl. Phys., 2015, 117, 105701 CrossRef .
A. Jain, S. P. Ong, G. Hautier, W. Chen, W. D. Richards, S. Dacek, S. Cholia, D. Gunter, D. Skinner and G. Ceder, 
            et al.
          , APL Mater., 2013, 1, 011002 CrossRef .
K. A. Persson, B. Waldwick, P. Lazic and G. Ceder, Phys. Rev. B: Condens. Matter Mater. Phys., 2012, 85, 235438 CrossRef .

Footnotes† This choice represents a useful yearly average of solar radiation at mid-latitudes where most of the population, industry, and thus solar panel installations are located.‡ In molecular systems, the VBM and CBM energy levels are equivalently called the highest occupied molecular orbital (HOMO) and lowest unoccupied molecular orbital (LUMO), respectively.§ See http://www.heinz.com/our-company/press-room/trivia.aspx.¶ The fact that in G0W0 the quasiparticle orbitals are the same as the KS orbitals is an often physically justified approximation.This journal is © The Royal Society of Chemistry 2016
Table Content:

Marco Bernardi
	Marco Bernardi is Assistant Professor in the Department of Applied Physics and Materials Science at Caltech. He obtained his BS in Materials Science from the University of Rome in 2008, and his PhD in Materials Science in 2013 from MIT, where he worked with Prof. Jeff Grossman on novel materials and physical processes in solar energy conversion. He was a postdoctoral researcher between 2013–2015 in the Physics Department of UC Berkeley. He received the 2015 Psi-K Volker Heine Young Investigator Award and the Intel PhD Fellowship, among other awards. His research has been featured in a number of magazines, including Wired, Nature, Scientific American, and Technology Review. His group at Caltech focuses on computing the dynamics of excited states in materials, with applications to ultrafast optical processes and solar energy conversion.

Jeffrey C. Grossman
	Jeffrey C. Grossman is a Professor in the Department of Materials Science and Engineering at the Massachusetts Institute of Technology. He received his PhD in theoretical physics from the University of Illinois, performed postdoctoral work at UC Berkeley, was a Lawrence Fellow at the Lawrence Livermore National Laboratory, and joined MIT in fall, 2009. Dr Grossman's group uses a combination of modeling and experiment to gain fundamental understanding, develop new insights based on this understanding, then use these insights to develop new materials with improved properties for energy conversion, energy storage, and clean water technologies. Prof. Grossman has been named a MacVicar Fellow of MIT, recognizing his contributions to engineering education, and he has been named a Fellow of the American Physical Society. He has published more than 150 scientific papers, and holds 17 current or pending U.S. patents.

 	Fig. 1  Comparison of conventional and excitonic solar cells. Conventional solar cells (left) are based on p–n junctions or heterojunctions of crystalline inorganic materials, such as Si and GaAs, connected to an external circuit with metallic electrodes. Excitonic solar cells (right) are based on interfaces between two materials, called the donor and the acceptor, to dissociate strongly bound excitons and generate charge carriers in the active layer. One electrode is typically a transparent conductive oxide (TCO) coated with buffer layers for additional charge and exciton management. The inset shows the type-II alignment of the VBM and CBM levels required for exciton dissociation.	 

 	Fig. 2  Time and length scales of microscopic processes in solar cells. Processes involved in PV conversion, including sunlight absorption, exciton formation, thermalization, and dissociation, and carrier transport and extraction. Different simulation techniques are employed to model processes at different length and time scales. Exciton formation, diffusion and dissociation are absent in CSCs due to the direct formation of charge carriers upon sunlight absorption.	 

 	Fig. 3  Energetics and dynamics at type-II D–A heterojunctions in XSCs. The blue and green arrows show, respectively, the charge transfer processes following photoexcitation of semiconductor 1 (SC1, the donor) and semiconductor 2 (SC2, the acceptor) in a type-II heterojunction. The energy of the hot CT states are shown in yellow as a continuum, and the energies of electrons and holes in the ground-state CT0 exciton are shown in purple. Eopt are the optical gaps in the two materials.	 
	(1)
	(2)
	(3)
{H0(r) + vxc[ρ(r)]}φnk(r) = εnkφnk(r)	(4)
Eg = εCBM − εVBM + Δxc	(5)
	(6)
Enk = εnk + 〈φnk|Σ(Enk) − vxc|φnk〉	(7)
	(8)
	(9)
	(10)
	(11)
	(12)

DFT	Quantum ESPRESSO,96 VASP,97
ABINIT,185 SIESTA,98 GPAW186
GW-BSE	Yambo,105 BerkeleyGW,106
WEST,108 GPAW,186 VASP97
TD-DFT	Octopus,118 QCHEM,114 Gaussian,113 GPAW186


Transport coefficients	BoltzWann,149 BoltzTrap151
Ballistic transport	TranSIESTA,175 GPAW186
Drift–diffusion	COMSOL187
Kinetic Monte Carlo	SPPARKS188


Light propagation and Maxwell's equations	MEEP,180 Lumerical,189 COMSOL187
Macroscopic light management	In-house code,30,184 COMSOL187
Footnotes
† This choice represents a useful yearly average of solar radiation at mid-latitudes where most of the population, industry, and thus solar panel installations are located.
‡ In molecular systems, the VBM and CBM energy levels are equivalently called the highest occupied molecular orbital (HOMO) and lowest unoccupied molecular orbital (LUMO), respectively.
§ See http://www.heinz.com/our-company/press-room/trivia.aspx.
¶ The fact that in G0W0 the quasiparticle orbitals are the same as the KS orbitals is an often physically justified approximation.

This journal is © The Royal Society of Chemistry 2016
