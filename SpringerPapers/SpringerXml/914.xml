<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s41601-022-00258-7</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41601</journal-id><journal-title-group><journal-title>Protection and Control of Modern Power Systems</journal-title><abbrev-journal-title abbrev-type="publisher">Prot Control Mod Power Syst</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2367-2617</issn><issn pub-type="epub">2367-0983</issn><publisher><publisher-name>Springer Nature Singapore</publisher-name><publisher-loc>Singapore</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41601-022-00258-7</article-id><article-id pub-id-type="manuscript">258</article-id><article-id pub-id-type="doi">10.1186/s41601-022-00258-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Adaptive coordination control strategy of renewable energy sources, hydrogen production unit, and fuel cell for frequency regulation of a hybrid distributed power system</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2911-2172</contrib-id><name><surname>Salama</surname><given-names>Hossam S.</given-names></name><address><email>eng.hossam.salah@aswu.edu.eg</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="corresp" rid="IDs41601022002587_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Magdy</surname><given-names>Gaber</given-names></name><address><email>gabermagdy@aswu.edu.eg</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Bakeer</surname><given-names>Abualkasim</given-names></name><address><email>abualkasim.bakeer@aswu.edu.eg</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Vokony</surname><given-names>Istvan</given-names></name><address><email>vokony.istvan@vet.bme.hu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.417764.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 4699 3028</institution-id><institution content-type="org-division">Electrical Engineering Department, Faculty of Engineering</institution><institution content-type="org-name">Aswan University</institution></institution-wrap><addr-line content-type="postcode">81542</addr-line><addr-line content-type="city">Aswân</addr-line><country country="EG">Egypt</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6759.d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2180 0451</institution-id><institution content-type="org-division">Department of Electric Power Engineering</institution><institution content-type="org-name">Budapest University of Technology and Economics</institution></institution-wrap><addr-line content-type="postcode">1111</addr-line><addr-line content-type="city">Budapest</addr-line><country country="HU">Hungary</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.417764.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 4699 3028</institution-id><institution content-type="org-division">Electrical Engineering Department, Faculty of Energy Engineering</institution><institution content-type="org-name">Aswan University</institution></institution-wrap><addr-line content-type="postcode">81528</addr-line><addr-line content-type="city">Aswân</addr-line><country country="EG">Egypt</country></aff></contrib-group><author-notes><corresp id="IDs41601022002587_cor1"><label>a</label><email>eng.hossam.salah@aswu.edu.eg</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>31</day><month>8</month><year>2022</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2022</year></pub-date><volume>7</volume><issue seq="34">1</issue><elocation-id>34</elocation-id><history><date date-type="registration"><day>16</day><month>8</month><year>2022</year></date><date date-type="received"><day>24</day><month>3</month><year>2022</year></date><date date-type="accepted"><day>15</day><month>8</month><year>2022</year></date><date date-type="online"><day>31</day><month>8</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Owing to the significant number of hybrid generation systems (HGSs) containing various energy sources, coordination between these sources plays a vital role in preserving frequency stability. In this paper, an adaptive coordination control strategy for renewable energy sources (RESs), an aqua electrolyzer (AE) for hydrogen production, and a fuel cell (FC)-based energy storage system (ESS) is proposed to enhance the frequency stability of an HGS. In the proposed system, the excess energy from RESs is used to power electrolysis via an AE for hydrogen energy storage in FCs. The proposed method is based on a proportional-integral (PI) controller, which is optimally designed using a grey wolf optimization (GWO) algorithm to estimate the surplus energy from RESs (i.e., a proportion of total power generation of RESs: Kn). The studied HGS contains various types of generation systems including a diesel generator, wind turbines, photovoltaic (PV) systems, AE with FCs, and ESSs (e.g., battery and flywheel). The proposed method varies Kn with varying frequency deviation values to obtain the best benefits from RESs, while damping the frequency fluctuations. The proposed method is validated by considering different loading conditions and comparing with other existing studies that consider Kn as a constant value. The simulation results demonstrate that the proposed method, which changes Kn value and subsequently stores the power extracted from the RESs in hydrogen energy storage according to frequency deviation changes, performs better than those that use constant Kn. The statistical analysis for frequency deviation of HGS with the proposed method has the best values and achieves large improvements for minimum, maximum, difference between maximum and minimum, mean, and standard deviation compared to the existing method.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Adaptive coordination control method</kwd><kwd>Renewable energy sources</kwd><kwd>Fuel cell</kwd><kwd>Grey wolf optimization (GWO) algorithm</kwd><kwd>Fraction factor (Kn)</kwd><kwd>Frequency control</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>34</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>8</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41601_2022_Article_258.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par32">Hybrid generation systems (HGSs) are often used in a centralized form. However, a centralized HGS delivers a continuous power source, and has various disadvantages, such as high losses because of transmission systems, low effectiveness, increased emission, insufficient power supply reliability, high changing and maintenance costs, unstable peaking power, low resilience, and low sustainability [<xref ref-type="bibr" rid="CR1">1</xref>]. Therefore, it is an urgent requirement to transfer to a distributed HGS, which has many merits because of the utilization of renewable energy sources (RESs). Advantages are such as high effectiveness, low emission, generation and delivery of electricity being more reliable and having high quality, low changing and maintenance costs, high resilience, and sustainability [<xref ref-type="bibr" rid="CR1">1</xref>]. However, the unpredictable changes in the weather, such as wind speed and irradiance, lead to intermittent generation from RESs (e.g. PV and wind systems) [<xref ref-type="bibr" rid="CR2">2</xref>]. Thus, the uncertain characteristics of PV and wind systems, and the probabilistic behavior of the loads, lead to fluctuations in system frequency [<xref ref-type="bibr" rid="CR3">3</xref>].</p><p id="Par33">In order to overcome these challenges, load frequency control (LFC) is mandatory for distributed HGS. In the literature, several methods are proposed to mitigate system frequency fluctuations. A black hole optimization algorithm is applied to fine-tune the cascaded proportional derivative-proportional integral derivative (PD-PID) controller parameters for the frequency regulation of a distributed HGS [<xref ref-type="bibr" rid="CR4">4</xref>], while an adaptive differential evolution technique based on PD with filter plus (1 + PI) is proposed in [<xref ref-type="bibr" rid="CR5">5</xref>]. Reference [<xref ref-type="bibr" rid="CR6">6</xref>] presents a modified equilibrium optimizer process that relies on an interval type-2 fuzzy-PID controller for LFC of a distributed HGS. A modified moth swarm algorithm (mMSA) with a hybrid fuzzy PD-PI controller to achieve the frequency stability of a distributed HGS is described in [<xref ref-type="bibr" rid="CR7">7</xref>]. In addition, a feedforward fractional-order PID strategy based on a harmony search algorithm is applied in [<xref ref-type="bibr" rid="CR8">8</xref>] to regulate system frequency considering the integral of time multiplied squared error (ITSE), while the chaotic crow search algorithm is used to optimize the hybrid fuzzy proportional derivative–tilt integral derivative controller parameters to control the frequency of a standalone microgrid [<xref ref-type="bibr" rid="CR9">9</xref>].</p><p id="Par34">A bacterial foraging optimization algorithm-based PID controller with a derivative filter is used for frequency control of a distributed HGS [<xref ref-type="bibr" rid="CR10">10</xref>], while the researchers in [<xref ref-type="bibr" rid="CR11">11</xref>] propose a compound control strategy based on model predictive control and a distributed leader-following consensus control strategy. In these control algorithms, the distributed energy resources and energy storage technologies are used to support the power system frequency [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. In [<xref ref-type="bibr" rid="CR14">14</xref>], the PI + clegg integrator (CI) reset control technique is proposed for the secondary frequency control in an islanded microgrid, considering RESs/load changes. A cascaded PI-PD controller is tuned by the salp swarm optimization technique for LFC of a standalone microgrid integrated with electric vehicles (EVs) [<xref ref-type="bibr" rid="CR15">15</xref>].</p><p id="Par35">In [<xref ref-type="bibr" rid="CR16">16</xref>], a comparison is presented between the proposed fractional-order (FO)-fuzzy-PID controller method and different types of control techniques such as optimized FO-Fuzzy-PID, PID, FO-PID, and Fuzzy-PID. The droop controller and PID controller are used with superconducting magnetic energy storage (SMES) to inject power to the microgrid during sudden load changes, thus achieving the frequency stability aim [<xref ref-type="bibr" rid="CR17">17</xref>]. The proposed control strategy in [<xref ref-type="bibr" rid="CR18">18</xref>] depends on two main control actions. The first is injecting active power from the battery to reach a constant power between the load and generation where the generated power from RESs is intermittent. The second control action is related to the frequency deviation, in which the proposed method is used to damp the frequency fluctuation and to compensate for the low-inertia of the system. The issue of reducing the lifetime of a battery energy storage system (BESS) (which helps in damping frequency deviation through a large amount of charging and discharging) is addressed in [<xref ref-type="bibr" rid="CR19">19</xref>], where an adaptive droop control method is proposed between the BESS and FC through the controlling of the power-sharing between FC and battery.</p><p id="Par36">One of the newest optimization algorithms is the grey wolf optimization (GWO) algorithm based on the meta-heuristic optimization technique [<xref ref-type="bibr" rid="CR20">20</xref>]. The GWO algorithm is used in many applications of electrical power systems because of its simplicity and easy applicability [<xref ref-type="bibr" rid="CR21">21</xref>]. Moreover, the GWO has several advantages such as flexibility, fewer algorithm parameters, comprehensiveness, and fast programmability features. The PID controller gains are used with the integral time absolute error (ITAE) as inputs to the control process that depends on the GWO to optimize the value of the PID gains, in order to achieve the secondary frequency control of an isolated multi-microgrid [<xref ref-type="bibr" rid="CR22">22</xref>]. The particle swarm optimization (PSO) and GWO techniques are applied with adaptive fuzzy logic control based on the PI controller to obtain the optimal values of membership functions (MFs) in the regulation and control of microgrid frequency [<xref ref-type="bibr" rid="CR23">23</xref>].</p><p id="Par37">The coordination control strategy between RESs and FC-based energy storage systems (ESS) is presented in [<xref ref-type="bibr" rid="CR24">24</xref>], where an adaptive fuzzy PID controller is proposed based on a simplified GWO algorithm for the LFC of a distributed power generation system considering generation rate constraints and time delays to include nonlinearity features. It also presents a comparison between several optimization algorithms including the simplified GWO algorithm to show its superiority over other methods. One of the most important applications of a hydrogen production unit is presented in [<xref ref-type="bibr" rid="CR25">25</xref>] to overcome the large-scale power curtailment resulting from the connection between RESs and large-scale power systems. The hydrogen production unit is suitable for such an application, since it can have large-capacity and long-term absorption of electric energy.</p><p id="Par38">The presented coordination control strategy has the following levels. The first derives energy conversion efficiency from electrical to hydrogen energy by a hydrogen production unit. The second takes into account the storage state of charge and the instantaneous power in the control process. The maximum power point tracking of a PV system is designed and included in the control process. The Bahr AL-Najaf area is used as a case study that utilizes a PV and wind system with fuel cells [<xref ref-type="bibr" rid="CR26">26</xref>]. The chaotic PSO is used in [<xref ref-type="bibr" rid="CR27">27</xref>] to optimize the parameters of FO fuzzy control. The proposed method is compared with PID and the integer-order fuzzy PID controller, considering the linear and nonlinear operating systems, to show its effectiveness over the mentioned control methods. The management strategy is to merge with the DC grid in [<xref ref-type="bibr" rid="CR28">28</xref>] to optimize the bus voltage and coordinate the power-sharing between the energy sources during different loading conditions with variable solar irradiance, considering the state of FC. The presented method is based on DC bus regulation through supercapacitor energy, and a PI controller is used to reduce the fluctuations in the DC bus voltage. The energy management strategy relies on the optimal control for a battery–supercapacitor in HGS, and is targeted to define the adaptive gains to state the reference power for the battery and the supercapacitor by using the slap swarm algorithm and load following control technique [<xref ref-type="bibr" rid="CR29">29</xref>].</p><p id="Par39">The high penetration of integrated RES with EVs is aggregated as a virtual power plant to reduce the cost of power balancing between the generation and demand sides, and the proposed control framework focuses on the control of complementary generation based on lifelong learning [<xref ref-type="bibr" rid="CR30">30</xref>]. In this control strategy, lifelong learning represents the primary layer, while the secondary layer is set in line with the ascending order of the regulation costs of the available reserve resources. In addition, the tertiary layer is represented by the coordination control for RESs, and an online optimization is applied considering the EV charging demands. In [<xref ref-type="bibr" rid="CR31">31</xref>], an optimal dispatch for automatic generation control is proposed to distribute the AGC command between generation units in a hybrid system with RESs and conventional resources. To do this, an adaptive distributed auction-based algorithm (ADAA) is used instead of the multiple fixed swap sizes of the auction-based algorithm, where ADAA has a fast convergence speed (i.e., low communication latency) and model-free features.</p><p id="Par40">The rest of this paper is structured as follows: the relevant literature is reviewed in Sect. <xref rid="Sec2" ref-type="sec">2</xref>, to highlight how the proposed method differs from existing ones. Section <xref rid="Sec3" ref-type="sec">3</xref> presents the model of the HGS, while Sect. <xref rid="Sec13" ref-type="sec">4</xref> discusses the proposed adaptive coordination control strategy. The simulation results are presented in Sect. <xref rid="Sec14" ref-type="sec">5</xref>, and finally, Sect. <xref rid="Sec19" ref-type="sec">6</xref> concludes the study.</p></sec><sec id="Sec2"><title>Literature survey</title><p id="Par41">In [<xref ref-type="bibr" rid="CR32">32</xref>], a super-twisting algorithm (STA) technique is proposed to improve the fluctuation of bus voltage, the current circulation, and the power distribution rationality. However, the impact of the wind system and high load variations are not investigated, and the fraction factor of the power-sharing between RESs and FC is also not considered. A two-time scale energy management system is presented in [<xref ref-type="bibr" rid="CR33">33</xref>] to deal with the FC and electrolysis specifications, but the high load variation and the fraction factor consideration are not presented with the proposed method. The P-f droop control strategy is used in [<xref ref-type="bibr" rid="CR34">34</xref>] for an energy management system between the AC microgrid components, considering their electrical characteristics, although the fraction factor which is used to define the power-sharing between RESs and FC is not studied. In [<xref ref-type="bibr" rid="CR35">35</xref>], a linear quadratic regulator with an integral controller is applied to control the frequency of a microgrid (MG). However, the effectiveness of the proposed method is validated under small load perturbation, and the fraction factor is not taken into consideration. References [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] propose a decentralized coordination control strategy among generation, ESS, hydrogen production unit, and FC in island DC and AC microgrids, respectively. However, both studies fail to take the electrical characteristics of the FC and the fraction factor into consideration. A stochastic model is proposed for the coordinated scheduling of RESs in [<xref ref-type="bibr" rid="CR37">37</xref>], but without including state-of-charge (SoC) protection and overpower protection studies. In addition, in the decentralization approach, the fraction factor is not considered. The most relevant studies are compared in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Summary of state-of-the-art solutions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>References</p></th><th align="left"><p>Year</p></th><th align="left"><p>Main contribution</p></th><th align="left"><p>Enhancement requirement/disadvantage</p></th><th align="left"><p>Algorithm</p></th></tr></thead><tbody><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR32">32</xref>]</p></td><td align="left"><p>2021</p></td><td align="left"><p>Improve bus voltage fluctuation, current circulation, and the rationality of power distribution</p></td><td align="left"><p>The integration of wind system</p><p>The high load variation</p><p>The fraction factor consideration to state the power sharing between RESs and FC</p></td><td align="left"><p>Super-twisting algorithm (STA)</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR33">33</xref>]</p></td><td align="left"><p>2019</p></td><td align="left"><p>A two-time scale energy management system to deal with the fuel cells and electrolysis specifications</p></td><td align="left"><p>Load high variation</p><p>The fraction factor consideration to state the power sharing between RESs and FC</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR34">34</xref>]</p></td><td align="left"><p>2020</p></td><td align="left"><p>Proposed energy management system between the AC MG component, considering its electrical characteristics</p></td><td align="left"><p>The fraction factor consideration to state the power sharing between RESs and FC</p></td><td align="left"><p><italic>P-f</italic> droop control strategy</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR35">35</xref>]</p></td><td align="left"><p>2020</p></td><td align="left"><p>Frequency control of MG system</p></td><td align="left"><p>The effectiveness of the proposed method was validated under small load perturbation</p><p>The fraction factor consideration to state the power sharing between RESs and FC</p></td><td align="left"><p>A linear quadratic regulator with an integral controller</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]</p></td><td align="left"><p>2020</p></td><td align="left"><p>Proposed a decentralized coordination control strategy among the generation, storage, hydrogen production unit, FC in the island DC, AC MG</p></td><td align="left"><p>It does not take into consideration the electrical characteristics of the fuel cell</p><p>The fraction factor is considered to state the power sharing between RESs and FC</p></td><td align="left"><p>Efficiency adaptive control strategy</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR37">37</xref>]</p></td><td align="left"><p>2017</p></td><td align="left"><p>Stochastic model is proposed for coordinated scheduling of renewable energy sources</p></td><td align="left"><p>SoC protection and overpower protection are not considered</p><p>Decentralization approach is not considered</p><p>The fraction factor consideration to state the power sharing between RESs and FC</p></td><td align="left"><p>A stochastic model</p></td></tr></tbody></table></table-wrap></p><p id="Par42">Based on Table <xref rid="Tab1" ref-type="table">1</xref>, several research gaps can be identified: (i) SoC protection and overpower protection; (ii) decentralization approach; (iii) electrical characteristics of the FC; (iv) high load variations; and (v) the fraction factor coordination to state the power-sharing between RESs and FC.</p><p id="Par43">Based on the above discussion and the presented studies, all the studies have either used a constant value for the fraction of the total power of RESs (Kn) or not considered. Therefore, this study proposes an adaptive coordination control application to control the power used from the RESs for energizing the FC-based ESS. The control approach proposed here is based on controlling the value of Kn that depends on the GWO algorithm to obtain the optimal gains of the PI controller. These are used to define the value of Kn with different loading conditions and uncertainties of PV and wind power generation. Moreover, it defines the power extracted from the RESs injected into the FC to achieve the best benefits from the RESs and FC, while fulfilling the frequency control aim.</p><p id="Par44">In order to clarify the disparities among the different studies, Table <xref rid="Tab2" ref-type="table">2</xref> provides a comparison among the investigated studies and the present work.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Comparison between the investigated studies and the present work</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>References</p></th><th align="left"><p>RESs</p></th><th align="left"><p>AE and FC</p></th><th align="left"><p>LFC algorithm</p></th><th align="left"><p>Kn consideration</p></th><th align="left"><p>Load variation</p></th><th align="left"><p>Kn algorithm</p></th><th align="left"><p>Main contributions</p></th></tr></thead><tbody><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR10">10</xref>]</p></td><td align="left"><p>Wind</p></td><td align="left"><p>√</p></td><td align="left"><p>A bacterial foraging optimization algorithm-based PID controller with a derivative filter</p></td><td align="left"><p>×</p></td><td align="left"><p>Low</p></td><td align="left"><p>n/a</p></td><td align="left"><p>Frequency control</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR9">9</xref>]</p></td><td align="left"><p>PV and wind</p></td><td align="left"><p>√</p></td><td align="left"><p>Hybrid fuzzy proportional derivative–tilt integral derivative (FPD-TID) based chaotic crow search algorithm (CCSA)</p></td><td align="left"><p>Constant</p></td><td align="left"><p>Low</p></td><td align="left"><p>n/a</p></td><td align="left"><p>LFC and proposed control scheme aims to achieve a trade-off between its performance and the operational stability of the microgrid</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR8">8</xref>]</p></td><td align="left"><p>PV and wind</p></td><td align="left"><p>×</p></td><td align="left"><p>A feedforward fractional order PID (FFOPID) based on a modified harmony search algorithm</p></td><td align="left"><p>×</p></td><td align="left"><p>High</p></td><td align="left"><p>n/a</p></td><td align="left"><p>LFC</p></td></tr><tr><td align="left"><p>[<xref ref-type="bibr" rid="CR7">7</xref>]</p></td><td align="left"><p>PV and wind</p></td><td align="left"><p>√</p></td><td align="left"><p>mMSA-based hFPD–PI controller</p></td><td align="left"><p>Constant</p></td><td align="left"><p>Low</p></td><td align="left"><p>n/a</p></td><td align="left"><p>LFC</p></td></tr><tr><td align="left"><p>Proposed study</p></td><td align="left"><p>PV and wind</p></td><td align="left"><p>√</p></td><td align="left"><p>mMSA-based PID controller</p></td><td align="left"><p>Variable</p></td><td align="left"><p>High</p></td><td align="left"><p>GWO based PI controller</p></td><td align="left"><p>Adaptive coordination control strategy</p><p>LFC</p><p>The proposed adaptive coordination control strategy based on changing the value of Kn and subsequently varying the power extracted from the RESs that is used with hydrogen energy storage according to the changing of the frequency deviation</p></td></tr></tbody></table></table-wrap></p><p id="Par45">The main contributions of this study are as follows:<list list-type="bullet"><list-item><p id="Par46">Benefits from RESs and FC-based ESSs using an adaptive coordination control strategy are obtained.</p></list-item><list-item><p id="Par47">The proposed adaptive coordination control method controls the value of Kn and consequently the power extracted from RESs to be used with FC-based ESSs.</p></list-item><list-item><p id="Par48">The GWO algorithm is used with the proposed adaptive coordination control method to adjust the PI controller gains of fraction factor Kn with different loading conditions and uncertainties of RESs powers.</p></list-item><list-item><p id="Par49">The advantages of the proposed coordination strategy are proved and established over existing studies that are based on the constant value of Kn.</p></list-item><list-item><p id="Par50">A comparison between the proposed method and the existing methods is presented.</p></list-item><list-item><p id="Par51">The effectiveness and robustness of the proposed method are proved using different loading conditions and uncertainties of RESs/loads power.</p></list-item><list-item><p id="Par52">The frequency fluctuation is stabilized successfully by the newly proposed control method.</p></list-item></list></p></sec><sec id="Sec3"><title>Hybrid generation system (HGS) model</title><p id="Par53">The studied HGS is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This shows different types of energy sources: wind generators (WGs), a photovoltaic (PV) system, an aqua electrolyzer (AE), fuel cells (FCs), a diesel generator (DG), electric vehicles (EVs), BESS, and a flywheel energy storage system (FESS) [<xref ref-type="bibr" rid="CR38">38</xref>]. All these components are represented by transfer function (TF) models, where the values of the gain (<italic>K</italic>) and time constant (<italic>T</italic>) are listed in Table <xref rid="Tab3" ref-type="table">3</xref>. The LFC-PID controller is designed using the mMSA, as discussed in [<xref ref-type="bibr" rid="CR7">7</xref>].<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>The studied HGS with the proposed coordination control strategy</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig1_HTML.png" id="MO1"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Nominal parameters of the studied HGS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Component</p></th><th align="left"><p>Gain</p></th><th align="left"><p>Time constant</p></th></tr></thead><tbody><tr><td align="left"><p>Wind generator (WG)</p></td><td align="left"><p><italic>K</italic><sub><italic>WG</italic></sub> = 1.0</p></td><td align="left"><p><italic>T</italic><sub><italic>WG</italic></sub> = 1.5</p></td></tr><tr><td align="left"><p>Photovoltaic (PV)</p></td><td align="left"><p><italic>K</italic><sub><italic>PV</italic></sub> = 1.0</p></td><td align="left"><p><italic>T</italic><sub><italic>PV</italic></sub> = 1.8</p></td></tr><tr><td align="left"><p>Aqua electrolyzer (AE)</p></td><td align="left"><p><italic>K</italic><sub><italic>AE</italic></sub> = 0.002</p></td><td align="left"><p><italic>T</italic><sub><italic>AE</italic></sub> = 0.5</p></td></tr><tr><td align="left"><p>Fuel cell (FC)</p></td><td align="left"><p><italic>K</italic><sub><italic>FC</italic></sub> = 0.01</p></td><td align="left"><p><italic>T</italic><sub><italic>FC</italic></sub> = 4.0</p></td></tr><tr><td align="left"><p>Flywheel energy storage system (FESS)</p></td><td align="left"><p><italic>K</italic><sub><italic>F</italic></sub> = -0.01</p></td><td align="left"><p><italic>T</italic><sub><italic>F</italic></sub> = 0.1</p></td></tr><tr><td align="left"><p>Battery energy storage system (BESS)</p></td><td align="left"><p><italic>K</italic><sub><italic>B</italic></sub> = -0.003</p></td><td align="left"><p><italic>T</italic><sub><italic>B</italic></sub> = 0.1</p></td></tr><tr><td align="left"><p>Electric vehicles (EV)</p></td><td align="left"><p><italic>K</italic><sub><italic>EV</italic></sub> = 1.0</p></td><td align="left"><p><italic>T</italic><sub><italic>EV</italic></sub> = 1.0</p></td></tr><tr><td align="left"><p>Diesel generator (DG)</p></td><td align="left"><p><italic>K</italic><sub><italic>DG</italic></sub> = 0.003</p></td><td align="left"><p><italic>T</italic><sub><italic>DG</italic></sub> = 2.0</p></td></tr><tr><td align="left"><p>Power system (PS)</p></td><td align="left"/><td align="left"/></tr><tr><td align="left"><p>Parameter name</p></td><td align="left"><p>Damping factor</p></td><td align="left"><p>Virtual inertia factor</p></td></tr><tr><td align="left"><p>Parameter value</p></td><td align="left"><p><italic>D</italic> = 0.3</p></td><td align="left"><p><italic>J</italic> = 0.4</p></td></tr></tbody></table></table-wrap></p><sec id="Sec4"><title>Wind generator</title><p id="Par54">The studied wind generation system consists of three wind turbines, and the power produced by each is <italic>P</italic><sub><italic>WG</italic></sub>. The well-known equation describing the mechanical power of a wind generator (<italic>P</italic><sub><italic>m</italic></sub>) is presented in (<xref rid="Equ1" ref-type="disp-formula">1</xref>), where <italic>C</italic><sub><italic>p</italic></sub> is the coefficient of performance and is related to <italic>β</italic> (blade pitch angle) and <italic>λ</italic> (tip speed ratio), <italic>ρ</italic> is air density, <italic>A</italic> is turbine swept area, and <italic>v</italic><sub><italic>wind</italic></sub> is wind speed [<xref ref-type="bibr" rid="CR38">38</xref>].<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:mi>ρ</mml:mi><mml:mi>A</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">wind</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{m} = 0.5C_{P} \left( {\lambda ,\beta } \right)\rho Av_{wind}^{3}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ1.gif"/></alternatives></disp-formula></p><p id="Par55">The nonlinearities and uncertainties are considered to be the main features of the wind generator system, e.g., the pitch control system. The wind generator system is represented by the TF model as in (<xref rid="Equ2" ref-type="disp-formula">2</xref>), where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{WG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{WG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq2.gif"/></alternatives></inline-formula> represent the gain and time constant, respectively, and <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{WG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq4.gif"/></alternatives></inline-formula> stand for the input and output power of the wind generator system, respectively.<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">WG</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{WG} \left( s \right) = \frac{{K_{WG} }}{{1 + sT_{WG} }} = \frac{{\Delta P_{WG} }}{{\Delta P_{m} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ2.gif"/></alternatives></disp-formula></p></sec><sec id="Sec5"><title>Photovoltaic model</title><p id="Par56">A PV system is based on converting the sun’s radiation into electricity, and the PV power (<italic>P</italic><sub><italic>PV</italic></sub>) can be calculated by (<xref rid="Equ3" ref-type="disp-formula">3</xref>), where <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{PV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq5.gif"/></alternatives></inline-formula> is the PV array area, <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq6.gif"/></alternatives></inline-formula> is the solar radiation,<inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq7.gif"/></alternatives></inline-formula> is the PV cell conversion efficiency. The TF of the PV system is defined in (<xref rid="Equ4" ref-type="disp-formula">4</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{PV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq8.gif"/></alternatives></inline-formula> is the gain and <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{PV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq9.gif"/></alternatives></inline-formula> is the time constant of the PV system, while <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \phi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta P_{PV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq11.gif"/></alternatives></inline-formula> are the input and output of the PV system, respectively.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>0.005</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{PV} = A_{PV} \left[ {1 - 0.005\left( {T_{a} + 25} \right)} \right]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ3.gif"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{PV} \left( s \right) = \frac{{K_{PV} }}{{1 + sT_{PV} }} = \frac{{\Delta P_{PV} }}{\Delta \phi }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ4.gif"/></alternatives></disp-formula></p></sec><sec id="Sec6"><title>Aqua electrolyzer (AE)</title><p id="Par57">The power generated by the PV and wind generation systems is used by an AE to generate hydrogen, while the generated hydrogen can be injected into an FC-based ESS to produce power. The TF of the AE is specified in (<xref rid="Equ5" ref-type="disp-formula">5</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{AE}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{AE}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq13.gif"/></alternatives></inline-formula> are its gain and time constant, respectively. The term <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mi>_</mml:mi><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {\left( {1 - K\_n } \right) \times P\_RESs} \right]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq14.gif"/></alternatives></inline-formula> represents the input of the AE and <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{AE}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq15.gif"/></alternatives></inline-formula> is its output.<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">RESs</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{AE} \left( s \right) = \frac{{K_{AE} }}{{1 + sT_{AE} }} = \frac{{\Delta P_{AE} }}{{\left( {1 - K_{n} } \right) \times P_{RESs} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ5.gif"/></alternatives></disp-formula></p></sec><sec id="Sec7"><title>Fuel cells</title><p id="Par58">The studied system has two identical FCs to provide high efficiency by sharing the power, and to increase the system reliability in case one fails. As the FC here is the main energy storage that is integrated to make coordination with the RESs, it is important to always keep them in the system. The TF used in this study is based on the first-order presented in (<xref rid="Equ6" ref-type="disp-formula">6</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq17.gif"/></alternatives></inline-formula> are the gain and time constant of the FC system-based ESS, respectively, while <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{AE}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq19.gif"/></alternatives></inline-formula> are the input and output of the fuel cell system, respectively.<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{FC} \left( s \right) = \frac{{K_{FC} }}{{1 + sT_{FC} }} = \frac{{P_{FC} }}{{P_{AE} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ6.gif"/></alternatives></disp-formula></p></sec><sec id="Sec8"><title>Diesel generator</title><p id="Par59">The diesel generator can be used as an independent power source to minimize the mismatch between generation and demand. The TF of the diesel generator is given in (<xref rid="Equ7" ref-type="disp-formula">7</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{DG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{DG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq21.gif"/></alternatives></inline-formula> are the gain and time constant of the diesel generator, respectively, while <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {u}_{DG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {P}_{DG}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq23.gif"/></alternatives></inline-formula> are its input and output, respectively.<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">DG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{DG} \left( s \right) = \frac{{K_{DG} }}{{1 + sT_{DG} }} = \frac{{\Delta P_{DG} }}{{\Delta u_{DG} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ7.gif"/></alternatives></disp-formula></p></sec><sec id="Sec9"><title>Electric vehicles</title><p id="Par60">The EVs can operate as supply in the discharging mode and as load in the charging mode, so their performance helps to mitigate system fluctuations. The TF of EVs in the first-order is specified in (<xref rid="Equ8" ref-type="disp-formula">8</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">EV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{EV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">EV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{EV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq25.gif"/></alternatives></inline-formula> are the gain and time constant of EVs, respectively.<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">EV</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">EV</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">EV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{EV} \left( s \right) = \frac{{K_{EV} }}{{1 + sT_{EV} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ8.gif"/></alternatives></disp-formula></p></sec><sec id="Sec10"><title>Battery energy storage system</title><p id="Par61">The BESS plays an essential role in preserving system frequency stability, as it can operate either as a load or a power source. The TF of BESS is presented in (<xref rid="Equ9" ref-type="disp-formula">9</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{B}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq26.gif"/></alternatives></inline-formula> is the gain of BESS and <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{B}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq27.gif"/></alternatives></inline-formula> is its time constant.<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{B} \left( s \right) = \frac{{K_{B} }}{{1 + sT_{B} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ9.gif"/></alternatives></disp-formula></p></sec><sec id="Sec11"><title>Flywheel energy storage system</title><p id="Par62">The FESS aids in keeping the power system as stable as possible during different operating conditions. The TF of the FESS is specified in (<xref rid="Equ10" ref-type="disp-formula">10</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>] where <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{F}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq28.gif"/></alternatives></inline-formula> is the gain of FESS and <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{F}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq29.gif"/></alternatives></inline-formula> is its time constant.<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_{F} \left( s \right) = \frac{{K_{F} }}{{1 + sT_{F} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ10.gif"/></alternatives></disp-formula></p></sec><sec id="Sec12"><title>Power system model</title><p id="Par63">The dynamic power system model has one input and one output. The input is the change in the power (the difference between the load and generation), while the output changes the system frequency as presented in (<xref rid="Equ11" ref-type="disp-formula">11</xref>) [<xref ref-type="bibr" rid="CR38">38</xref>], where <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mi>D</mml:mi></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq31.gif"/></alternatives></inline-formula> are the damping factor and the virtual inertia factor, respectively.<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">PS</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{PS} \left( s \right) = \frac{1}{D + sJ} = \frac{\Delta f}{{\Delta P}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ11.gif"/></alternatives></disp-formula></p></sec></sec><sec id="Sec13"><title>The proposed adaptive coordination control strategy</title><p id="Par64">In this study, the algorithm of GWO is programmed using the MATLAB program. The PI controller of Kn is optimized, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The main role of the optimization is to achieve the adaptive control method of the RESs, the AE for hydrogen production and the FC-ESS, and enhance the frequency of the power system in different loading conditions in addition to the main frequency control. The different loading conditions will be presented in the results section. The objective function used in this study is the ITAE shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. This integrates the multiplication of the absolute error (i.e., system frequency deviation (<inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq32.gif"/></alternatives></inline-formula>)) and the time as:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mtext>ITAE</mml:mtext><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">sim</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mi>t</mml:mi><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Fitness\,equation = {\text{ITAE}} = \mathop \smallint \limits_{0}^{{t_{sim} }} t\left| {\Delta f} \right|dt$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ12.gif"/></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>The proposed control method of Kn</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par65">where <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">sim</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{sim} \user2{ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq33.gif"/></alternatives></inline-formula> is the simulation time.</p><p id="Par66">Recently, one of the most recommended optimization techniques has been GWO, which is considered as a meta-heuristic technique [<xref ref-type="bibr" rid="CR20">20</xref>]. Wolves have a hierarchy in strict dominance when they live in a group, which typically has 5 to 12 members. The leader of this group is called alpha (α), who has a strong aider called beta (β), which helps the main leader make the right decision. The omega (ω) is considered the lowest position wolf, which acts as the scapegoat. The rest of the wolves are called delta (δ), and all of the deltas follow alphas and betas. All of these roles are presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The GWO method has three main steps to reach a prey: (i) search for the prey and approach it, (ii) surround the prey and limit its motion, and (iii) attack and hunt down the prey.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>The hierarchy of grey wolves</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig3_HTML.png" id="MO3"/></fig></p><p id="Par67">The surrounding of the prey can be presented in arithmetic form as in (<xref rid="Equ13" ref-type="disp-formula">13</xref>), where <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{P}_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq34.gif"/></alternatives></inline-formula> is the position of the GW, <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">pi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{P}_{pi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq35.gif"/></alternatives></inline-formula> is the position of prey, and <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{S}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq36.gif"/></alternatives></inline-formula> is the distance between them. <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{A}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{C}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq38.gif"/></alternatives></inline-formula> are vectors that are computed from Eqs. (<xref rid="Equ15" ref-type="disp-formula">15</xref>)–(<xref rid="Equ16" ref-type="disp-formula">17</xref>).<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">pi</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{S} = \left| {\vec{C}\vec{P}_{pi} - \vec{P}_{i} } \right|$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">pi</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{P}_{i + 1} = \vec{P}_{pi} - \vec{A}\vec{S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{A} = 2\vec{a} \vec{n}_{1} - \vec{a}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ15.gif"/></alternatives></disp-formula></p><p id="Par68">where<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>_</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{a} = 2 - \frac{2t}{{Max\_iter}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{C} = 2\vec{n}_{2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ17.gif"/></alternatives></disp-formula></p><p id="Par69">where <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overrightarrow{n}}_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq39.gif"/></alternatives></inline-formula> and <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overrightarrow{n}}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq40.gif"/></alternatives></inline-formula> express the random numbers between zero and one.</p><p id="Par70">Equation (<xref rid="Equ15" ref-type="disp-formula">15</xref>) presents the factor <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq41.gif"/></alternatives></inline-formula> that reduces linearly from two to zero when increasing the number of iterations. The diverging technique is used for searching a prey location where <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>A</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| A \right| &gt; 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq42.gif"/></alternatives></inline-formula>, while the convergence technique is used for getting a prey where <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>A</mml:mi></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| A \right| &lt; 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq43.gif"/></alternatives></inline-formula>. The hunting process uses α which is then followed by β and δ as presented in (<xref rid="Equ18" ref-type="disp-formula">18</xref>)–(<xref rid="Equ19" ref-type="disp-formula">20</xref>). The <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mi>A</mml:mi></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mi>C</mml:mi></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_IEq45.gif"/></alternatives></inline-formula> factors help the GWO method to keep away from the stagnation event.<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>δ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}l} {\vec{S}_{\alpha } = \left| {\vec{C}_{1} \vec{P}_{\alpha i} - \vec{P}_{i} } \right|} \hfill \\ {\vec{S}_{\beta } = \left| {\vec{C}_{2} \vec{P}_{\beta i} - \vec{P}_{i} } \right|} \hfill \\ {\vec{S}_{\delta } = \left| {\vec{C}_{3} \vec{P}_{\delta i} - \vec{P}_{i} } \right|} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ18.gif"/></alternatives></disp-formula><disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>δ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}l} {\vec{P}_{1} = \vec{P}_{\alpha i} - \vec{A}_{1} \vec{S}_{\alpha } } \hfill \\ {\vec{P}_{2} = \vec{P}_{\beta i} - \vec{A}_{2} \vec{S}_{\beta } } \hfill \\ {\vec{P}_{3} = \vec{P}_{\delta i} - \vec{A}_{3} \vec{S}_{\delta } } \hfill \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ19.gif"/></alternatives></disp-formula><disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{P}_{i + 1} = \frac{1}{3}\left( {\vec{P}_{1} + \vec{P}_{2} + \vec{P}_{3} } \right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_258_Article_Equ20.gif"/></alternatives></disp-formula></p><p id="Par71">The flowchart of the proposed adaptive coordination control strategy based on the GWO technique is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, to achieve the coordination between RESs, aqua electrolyzer for hydrogen production, and FC-ESS, thus enhancing the frequency stability of HGSs. The overall proposed adaptive coordination control strategy is organized as follows:<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Flowchart of the complete proposed method</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig4_HTML.png" id="MO4"/></fig></p><p id="Par72"><bold>Step 1</bold>: Measure and collect the various signals, and feed them into the adaptive coordination control process. These parameters include the generation active power, load active power, and the parameters of the GWO algorithm.</p><p id="Par73"><bold>Step 2</bold>: The computation of the frequency deviation is presented in this step from the known difference between the load active and generation active power. The power mismatch between the load and generation plays a vital role in power system frequency stability and defines the value of the frequency deviation. The frequency deviation must be within permissible limits based on the signal of an adaptive coordination control strategy that defines the fraction of total power generation of RESs (Kn) and the power fed into the AE for hydrogen production and FC. When the frequency deviation is out of limit, the absolute value of the frequency deviation is taken and used in Step 3.</p><p id="Par74"><bold>Step 3</bold>: The GWO algorithm is described in this step, where the best value of the Kn can be obtained by applying the GWO to get the optimal value of the PI controller. The value of Kn is responsible for coordinating the RESs and the AE of hydrogen production and the FC.</p><p id="Par75"><bold>Step 4</bold>: The best value of Kn is used in the equation presented in Step 4 and also shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The power extracted from RESs is adaptively used with an AE, and the remaining power is fed into the HGS. By using this adaptive coordination control strategy, the power of FC and RESs can be optimally distributed to help preserve the system frequency within limits.</p><p id="Par76">The fitness value and gain factors of <italic>K</italic><sub><italic>P</italic></sub> and <italic>K</italic><sub><italic>I</italic></sub> are listed in Table <xref rid="Tab4" ref-type="table">4</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Controller parameters for the HGS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p><italic>K</italic><sub><italic>P</italic></sub></p></th><th align="left"><p><italic>K</italic><sub><italic>I</italic></sub></p></th><th align="left"><p><italic>K</italic><sub><italic>D</italic></sub></p></th></tr></thead><tbody><tr><td align="left"><p>Frequency regulation control parameters (PID-mMSO) [<xref ref-type="bibr" rid="CR7">7</xref>]</p></td><td char="." align="char"><p>1.9069</p></td><td char="." align="char"><p>1.8844</p></td><td align="left"><p>1.9235</p></td></tr><tr><td align="left"><p>Proposed Kn control parameters</p></td><td char="." align="char"><p>5.1986</p></td><td char="." align="char"><p>0.7925</p></td><td align="left"><p>–</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec14"><title>Results and discussion</title><p id="Par77">The studied system shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> is simulated using the MATLAB/Simulink software. The simulation results comprise four cases of different loading conditions to indicate the performance of the proposed method compared to the existing work in [<xref ref-type="bibr" rid="CR7">7</xref>] that used a fixed value for the coordination gain of Kn. At the same time, the frequency regulation control is based on mMSA in both studies to make a fair comparison between the two systems. Therefore, a better coordination between the RESs and the ESS-based fuel cell can be achieved, where the PID controller based on mMSA damps the frequency regulation in both studies. The PI controller based on GWO is proposed to determine the value of Kn that defines the injected power into the AE to power the FC. This case is called “Proposed PI-GWO of Kn” and the existing case is referred to as “Constant value of Kn”. The power of the wind generator and PV systems used during all cases at different loading conditions is presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. It is clear that the RESs profile has random output characteristics as a reflection of the change in environmental conditions which lead to fluctuation in system frequency. The fluctuations of output power from the wind and PV systems are overcome by a suitable control approach. Different cases are tested with variable load conditions to examine the proposed control method.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>The power profile of <bold>a</bold> wind generator and <bold>b</bold> PV system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig5_HTML.png" id="MO5"/></fig></p><sec id="Sec15"><title>Case 1</title><p id="Par78">In this case, the random load variation is a combination of two load types: one being an industrial load and the other a domestic load, as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, where the total load profile is the sum of the two. The total load changes from 0.045 pu to 0.307 pu, while the generated power from the wind varies between 0.025 pu to 0.225 pu (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), and the PV between 0.001 pu to 0.1 pu (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The frequency deviation in this case study is presented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>The load power fluctuation of Case 1</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig6_HTML.png" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>The frequency deviation of Case 1</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig7_HTML.png" id="MO7"/></fig></p><p id="Par79">It is evident that at 400 s, the proposed PI-GWO of Kn controller mitigates the frequency fluctuation better than that with the constant value of Kn. The improvement in the system frequency results from the impact of the Kn controller, where the power of the FC is changed, as presented in Fig. <xref rid="Fig8" ref-type="fig">8</xref>a. The power injected into the AE is controlled by following the value of Kn as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b. The response of the controller is evident in Kn as presented in Fig. <xref rid="Fig8" ref-type="fig">8</xref>c, where the proposed method varies the value of Kn according to the frequency state, whereas the existing work uses constant Kn regardless of the frequency deviation in the system. The variation of input power from different power sources of HGS is presented in Fig. <xref rid="Fig9" ref-type="fig">9</xref>, in which the proposed work provides smoother and lower fluctuations of the power from the different sources than the existing work during the variation in the power of RESs and load. This leads to reduced variations of the generated power from the BESS, FESS, EV, and DG, as is evident in Fig. <xref rid="Fig9" ref-type="fig">9</xref>. The above discussion proves that the proposed control method is suitable for making the HGS more stable and robust in the case of large system disturbances.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>The response of <bold>a</bold> fuel cell power of case 1, <bold>b</bold> power fed into AE of Case 1, and <bold>c</bold> value of Kn of Case 1</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig8_HTML.png" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>The performance of HGS sources for Case 1: <bold>a</bold> battery power, <bold>b</bold> flywheel power, <bold>c</bold> EV power, and <bold>d</bold> DG power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig9_HTML.png" id="MO9"/></fig></p></sec><sec id="Sec16"><title>Case 2</title><p id="Par80">In this case, the load demand is varied as shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, while the power profile of wind and PV systems is the same as in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The frequency deviation is given in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. It is observed from the curve that the HGS frequency is damped using the proposed method despite the uncertainties of the power generated from RESs and the load variations. The responses of the FC power and the power injected to the AE, and the Kn response are shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, which indicates the effect of the proposed control. The variations of power from the generation sources and ESSs are presented in Fig. <xref rid="Fig13" ref-type="fig">13</xref>. By applying the proposed control method, the power from the variable sources can be better smoothed than with the existing method.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>The load power fluctuation of Case 2</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig10_HTML.png" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>The frequency deviation of Case 2</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig11_HTML.png" id="MO11"/></fig><fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>The Case 2 response of <bold>a</bold> fuel cell power, <bold>b</bold> power fed to AE, <bold>c</bold> value of Kn</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig12_HTML.png" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>The performance of HGS sources for Case 2: <bold>a</bold> battery power, <bold>b</bold> flywheel power, <bold>c</bold> EV power, and <bold>d</bold> DG power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig13_HTML.png" id="MO13"/></fig></p></sec><sec id="Sec17"><title>Case 3</title><p id="Par81">The proposed control method is examined with multi-sharp variation in the load demand curve, as shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>, considering the same profile of the wind and PV generation systems as in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The frequency fluctuation due to the variable load demand and intermittent RESs is minimized by applying the proposed coordination method using the adaptive gain Kn (Fig. <xref rid="Fig15" ref-type="fig">15</xref>). The proposed method has successfully minimized the overshoot, undershoot, and steady-state error of the system frequency during the overall simulation time. The impact of the proposed control technique on HGS is indicated through the performance of the FC power energized by the AE. This is controlled by the Kn value that is based on the PI-GOW technique, as displayed in Fig. <xref rid="Fig16" ref-type="fig">16</xref>. Also, the power variations from different generation sources are presented in Fig. <xref rid="Fig17" ref-type="fig">17</xref> with the two control systems.<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>The load power fluctuation of Case 3</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig14_HTML.png" id="MO14"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>The frequency deviation of Case 3</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig15_HTML.png" id="MO15"/></fig><fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>The Case 3 response of <bold>a</bold> fuel cell power, <bold>b</bold> power fed to AE, <bold>c</bold> value of Kn</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig16_HTML.png" id="MO16"/></fig><fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p>The performance of HGS sources for Case 3: <bold>a</bold> battery power <bold>b</bold> flywheel power <bold>c</bold> EV power <bold>d</bold> DG power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig17_HTML.png" id="MO17"/></fig></p></sec><sec id="Sec18"><title>Case 4</title><p id="Par82">In this case, the proposed control is tested by multi-changes in the load demand profile as displayed in Fig. <xref rid="Fig18" ref-type="fig">18</xref> to inspect the quality of the control. In the presence of the proposed control method, the frequency deviation is kept approximately constant (around zero) during the variations of the load demand and power generated from the RESs. In contrast, in existing work with a constant value of Kn, the frequency deviation varies between 0.041 pu and -0.03 pu, as presented in Fig. <xref rid="Fig19" ref-type="fig">19</xref>. This improvement is achieved by using a suitable control of Kn, which affects the FC operation as shown in Fig. <xref rid="Fig20" ref-type="fig">20</xref>a through controlling the power required by the AE as shown in Fig. <xref rid="Fig20" ref-type="fig">20</xref>b. The values of Kn with the proposed method and existing work are compared in Fig. <xref rid="Fig20" ref-type="fig">20</xref>c. These values are responsible for stating the different power used from the RESs to energize the FC. The BESS, FESS, EV, and DG achieve the balance between generation units and loads in the HGS as displayed in Fig. <xref rid="Fig21" ref-type="fig">21</xref>. The smaller fluctuations in the generated power are the results of the proposed control method.<fig id="Fig18"><label>Fig. 18</label><caption xml:lang="en"><p>The load power fluctuation of Case 4</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig18_HTML.png" id="MO18"/></fig><fig id="Fig19"><label>Fig. 19</label><caption xml:lang="en"><p>The frequency deviation of Case 4</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig19_HTML.png" id="MO19"/></fig><fig id="Fig20"><label>Fig. 20</label><caption xml:lang="en"><p>The Case 4 response of <bold>a</bold> fuel cell power, <bold>b</bold> power fed to AE, and <bold>c</bold> value of Kn</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig20_HTML.png" id="MO20"/></fig><fig id="Fig21"><label>Fig. 21</label><caption xml:lang="en"><p>The performance of HGS sources for Case 4 <bold>a</bold> battery power, <bold>b</bold> flywheel power, <bold>c</bold> EV power, and <bold>d</bold> DG power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig21_HTML.png" id="MO21"/></fig></p><p id="Par83">The proposed control method and existing work in [<xref ref-type="bibr" rid="CR7">7</xref>] are further compared in Fig. <xref rid="Fig22" ref-type="fig">22</xref> using the statistical analysis of the frequency deviation presenting computational results of minimum (Min), maximum (Max), the difference between maximum and minimum (Max–Min), mean, and standard deviation (Std). The maximum and minimum values are employed to define the overshoot and undershoot of the frequency response during the different loading conditions, respectively. The difference between them is used to express the range of changes, and if this indicator is near zero, it means that the frequency deviation is a near-constant and stable value.<fig id="Fig22"><label>Fig. 22</label><caption xml:lang="en"><p>Statistical analysis for frequency deviation (Hz): <bold>a</bold> Case 1, <bold>b</bold> Case 2, <bold>c</bold> Case 3, and <bold>d</bold> Case 4</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_258_Fig22_HTML.png" id="MO22"/></fig></p><p id="Par84">The mean value reflects the frequency response during the whole simulation time, while the standard deviation expresses how much the frequency response differs from the mean value of the frequency response curve. A comparison between the proposed work and the existing work for the frequency deviation response is presented to evaluate the effectiveness of the proposed method.</p><p id="Par85">The proposed method in Case 1 reduces the undershoot by 82.2% compared to the existing work, and the overshoot by 32.4%. The proposed method has the lowest value of the difference between the maximum and minimum values, mean, and standard deviation. In Case 2, the improvements reach 93.4% and 87.8% in the undershoot and overshoot, respectively, compared to the existing work. The mean, standard deviation values, and the difference between the maximum and minimum validate the proposed control method. These indicators have smaller values than those in the existing work.</p><p id="Par86">In addition, the importance of the proposed control technique compared to the existing work is observed in Case 3, where it improves the lowest minimum value by 78.6% and lowest maximum value by 72.1%. Also, the other indicators, including the difference between the maximum and minimum, mean, and standard deviation achieve enhancements of 76%, 100%, and 91%, respectively. The proposed PI-GWO of Kn control method in Case 4 makes the system more stable and reliable through the improvements of 91.7%, 85.7%, 89.2%, 98.4%, and 95.4% for minimum, maximum, the difference between the maximum and minimum, mean, and standard deviation, respectively.</p></sec></sec><sec id="Sec19" sec-type="conclusions"><title>Conclusion</title><p id="Par87">This paper presents an adaptive coordination control method for optimal operation of the RESs and fuel cell system. The proposed method is based on the PI-GWO controller to set the power-sharing between RESs and FCs, and therefore to stabilize the power system frequency with different loading conditions. The studied system has multi-energy sources, including intermittent PV and wind generation systems, leading to more fluctuations in the power system frequency. The parameters of the PI controller are tuned using the GWO technique to obtain optimal controller values. The proposed control method is examined with four cases with different load profiles, and the effectiveness and robustness of the proposed method are validated by comparing it with existing work. The simulation results validate the effectiveness of the proposed method compared with the existing one. The key findings can be summarized as follows:<list list-type="bullet"><list-item><p id="Par88">The proposed control approach for HGS constructively mitigates the frequency fluctuations and improves the power exchange between the generation and load sides under different generation and load conditions.</p></list-item><list-item><p id="Par89">The variable Kn effectively maintains the load/frequency at an approximately constant level during the assessment tests.</p></list-item><list-item><p id="Par90">With the proposed coordination control strategy based on PI-GWO of Kn, the variability of Kn shows a superior performance over the constant Kn in terms of minimum, maximum, the difference between the maximum and minimum, mean, and standard deviation of the frequency deviation.</p></list-item><list-item><p id="Par91">The computational results of the frequency deviation are listed and discussed, and prove the superiority of the proposed coordination control method.</p></list-item><list-item><p id="Par92">With the proposed coordination control strategy based on PI-GWO of Kn, the power-sharing from RESs to fuel cell through AE is optimized.</p></list-item></list></p><p id="Par93">The proposed work can initiate a new research area using the proposed work with different control methods and optimization techniques.</p></sec></body><back><ack><title>Acknowledgements</title><p>Not applicable.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><sec><p>HSS: Conceptualization, Methodology, Software, Data curation, Writing- Original draft preparation, Visualization, Investigation. GM: Conceptualization, Methodology, Software, Data curation, Writing- Original draft preparation, Visualization, Investigation. AB: Resources, Methodology, Software, Data curation, Writing- Original draft preparation, Validation. IV: Supervision, Validation, Resources, Writing- Reviewing and Editing, Data curation. All authors read and approved the final manuscript.</p></sec><sec><title>Author's information</title><p id="Par94"><bold>Hossam S. Salama</bold> was born in Aswan, Egypt in 1990. He received his B.Sc. and M. Sc. degrees in Electrical Engineering from Aswan University, Egypt in 2012 and 2016, respectively. In 2022, he received Ph.D. degree in Electrical Engineering from Budapest University of Technology and Economics. In 2013, he joined the Electrical Engineering Department, Aswan University, Egypt as Assistant Lecturer. In 2018, he jointed Department of Electric Power Engineering, Budapest University of Technology and Economics, Hungary as Assistant Lecturer and Researcher. He is currently an Assistant Professor at Faculty of Engineering, Aswan University, Egypt. His major interests include power system stability and control of power systems, fuzzy logic control, energy storage systems and electric vehicles.</p><p id="Par95"><bold>Abualkasim Bakeer</bold> (S’14) was born in Qena, Egypt in 1990. He received the B.Sc. and M.Sc. (Hons.) degrees in Electrical Engineering from Aswan University, Egypt, in 2012 and 2017, respectively. Since 2014, he joined the Electrical Engineering Department, Faculty of Engineering, Aswan University, Aswan, Egypt, first as a Demonstrator (Assistant Researcher), and then became an Assistant lecturer in 2017. Since September 2019, he is pursuing a Ph.D. degree with the Department of Electrical Power Engineering and Mechatronics, Tallinn University of Technology, Estonia. His current main research topics are focusing on the Power Electronics, drives, and DC-DC converters.</p><p id="Par96"><bold>Gaber Magdy</bold> is a faculty member at Aswan University, Aswan, Egypt. He received the B.Sc. and M.Sc. (Hons.) degrees in Electrical Engineering from Aswan University, Egypt, in 2011 and 2014, respectively. In 2019, he received a jointly supervised Ph.D. degree in Electrical Engineering from Minia University, Egypt (Main university), and Kyushu Institute of Technology, Japan (Host university). Since December 2011, he joined the Electrical Engineering Department, Faculty of Energy Engineering, Aswan University, Aswan, Egypt, first as a Demonstrator and then as an Assistant Lecturer in November 2014. From 2017 to 2019, he was a researcher in the Department of Electrical and Electronic Engineering, Kyushu Institute of Technology, Japan. He is currently an assistant professor at the Department of Electrical Engineering, Faculty of Energy Engineering, Aswan University, Aswan, Egypt. He has authored /co-authored two international books and over 35 peer-reviewed papers on the stability, dynamics, and control of renewable power systems. His research interests include power system control, smart/micro-grid control, renewable energy, and energy storage systems, digital control techniques, all applied to power systems.</p><p id="Par97"><bold>István Vokony</bold> received a Master of Science degree in electrical engineering and obtained his Ph.D. from Budapest University of Technology and Economics (BUTE) in 2007 and 2012, respectively. He is a senior lecturer with the BUTE department of electric power engineering. He is a former officer of the AEE Hungary student chapter. His interests include system stability, renewable energy integration, energy efficiency, and smart grids.</p></sec></sec><sec><title>Funding</title><p>Not applicable.</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>Not applicable.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par98">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhatti</surname><given-names>HJ</given-names></name><name><surname>Danilovic</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Making the world more sustainable: enabling localized energy generation and distribution on decentralized smart grid systems</article-title><source>World Journal of Engineering and Technology</source><year>2018</year><volume>06</volume><issue>02</issue><fpage>350</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.4236/wjet.2018.62022</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="other">Khatibi, M., &amp; Ahmed, S. (2019). Impact of distributed energy resources on frequency regulation of the bulk power system. In <italic>IEEE conference on power electronics and renewable energy, CPERE 2019</italic> (pp. 258–263).</mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Mele, F. M., Ortega, Á., Zárate-Miñano, R., &amp; Milano, F. (2016). Impact of variability, uncertainty and frequency regulation on power system frequency distribution. In <italic>19th power systems computation conference, PSCC 2016</italic>.</mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorripotu</surname><given-names>TS</given-names></name><name><surname>Pilla</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Black hole optimised cascade proportional derivative-proportional integral derivative controller for frequency regulation in hybrid distributed power system</article-title><source>International Journal of Swarm Intelligence</source><year>2019</year><volume>4</volume><issue>2</issue><fpage>155</fpage><pub-id pub-id-type="doi">10.1504/IJSI.2019.104090</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Khamari, D., Sahu, R. K., &amp; Panda, S. (2020). Adaptive differential evolution based PDF plus (1+PI) controller for frequency regulation of the distributed power generation system with electric vehicle. <italic>International Journal of Ambient Energy</italic>.</mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar Khadanga</surname><given-names>R</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Frequency control in hybrid distributed power systems via type-2 fuzzy PID controller</article-title><source>IET Renewable Power Generation</source><year>2021</year><volume>15</volume><issue>8</issue><fpage>1706</fpage><lpage>1723</lpage><pub-id pub-id-type="doi">10.1049/rpg2.12140</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khamari</surname><given-names>D</given-names></name><name><surname>Sahu</surname><given-names>RK</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A modified moth swarm algorithm-based hybrid fuzzy PD–PI controller for frequency regulation of distributed power generation system with electric vehicle</article-title><source>Journal of Control, Automation and Electrical Systems</source><year>2020</year><volume>31</volume><issue>3</issue><fpage>675</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1007/s40313-020-00565-0</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Asgari, S., Suratgar, A. A., &amp; Kazemi, M. G. (2021) Feedforward fractional order PID load frequency control of microgrid using harmony search algorithm. <italic>Iranian Journal of Science and Technology - Transactions of Electrical Engineering</italic> (pp. 1–13).</mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khokhar</surname><given-names>B</given-names></name><name><surname>Dahiya</surname><given-names>S</given-names></name><name><surname>Parmar</surname><given-names>KPS</given-names></name></person-group><article-title xml:lang="en">A novel hybrid fuzzy PD-TID controller for load frequency control of a standalone microgrid</article-title><source>Arabian Journal for Science and Engineering</source><year>2021</year><volume>46</volume><issue>2</issue><fpage>1053</fpage><lpage>1065</lpage><pub-id pub-id-type="doi">10.1007/s13369-020-04761-7</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorripotu</surname><given-names>TS</given-names></name><name><surname>Kumar</surname><given-names>DV</given-names></name><name><surname>Boddepalli</surname><given-names>MK</given-names></name><name><surname>Ramana</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Design and analysis of BFOA optimised PID controller with derivative filter for frequency regulation in distributed generation system</article-title><source>International Journal of Automation and Control</source><year>2018</year><volume>12</volume><issue>2</issue><fpage>291</fpage><lpage>323</lpage><pub-id pub-id-type="doi">10.1504/IJAAC.2018.090808</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>G</given-names></name><name><surname>Hu</surname><given-names>G</given-names></name><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Shi</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Frequency regulation of source-grid-load systems: A compound control strategy</article-title><source>IEEE Trans. Ind. Informatics</source><year>2016</year><volume>12</volume><issue>1</issue><fpage>69</fpage><lpage>78</lpage></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akram</surname><given-names>U</given-names></name><name><surname>Nadarajah</surname><given-names>M</given-names></name><name><surname>Shah</surname><given-names>R</given-names></name><name><surname>Milano</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">A review on rapid responsive energy storage technologies for frequency regulation in modern power systems</article-title><source>Renewable and Sustainable Energy Reviews</source><year>2020</year><volume>120</volume><fpage>109626</fpage><pub-id pub-id-type="doi">10.1016/j.rser.2019.109626</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Mishra</surname><given-names>Y</given-names></name><name><surname>Shahidehpour</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Utilizing distributed energy resources to support frequency regulation services</article-title><source>Applied Energy</source><year>2017</year><volume>206</volume><fpage>1484</fpage><lpage>1494</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2017.09.114</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banki</surname><given-names>T</given-names></name><name><surname>Faghihi</surname><given-names>F</given-names></name><name><surname>Soleymani</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Frequency control of an island microgrid using reset control method in the presence of renewable sources and parametric uncertainty</article-title><source>Systems Science &amp; Control Engineering</source><year>2020</year><volume>8</volume><issue>1</issue><fpage>500</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1080/21642583.2020.1801533</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khokhar</surname><given-names>B</given-names></name><name><surname>Dahiya</surname><given-names>S</given-names></name><name><surname>Singh Parmar</surname><given-names>KP</given-names></name></person-group><article-title xml:lang="en">A robust cascade controller for load frequency control of a standalone microgrid incorporating electric vehicles</article-title><source>Electric Power Components and Systems</source><year>2020</year><volume>48</volume><issue>6–7</issue><fpage>711</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1080/15325008.2020.1797936</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annamraju</surname><given-names>A</given-names></name><name><surname>Nandiraju</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Robust frequency control in a renewable penetrated power system: An adaptive fractional order-fuzzy approach</article-title><source>Protection and Control of Modern Power Systems</source><year>2019</year><volume>4</volume><issue>1</issue><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1186/s41601-019-0115-7</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajamand</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Load frequency control and dynamic response improvement using energy storage and modeling of uncertainty in renewable distributed generators</article-title><source>Journal of Energy Storage</source><year>2021</year><volume>37</volume><fpage>102467</fpage><pub-id pub-id-type="doi">10.1016/j.est.2021.102467</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hassanzadeh</surname><given-names>ME</given-names></name><name><surname>Nayeripour</surname><given-names>M</given-names></name><name><surname>Hasanvand</surname><given-names>S</given-names></name><name><surname>Waffenschmidt</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Decentralized control strategy to improve dynamic performance of micro-grid and reduce regional interactions using BESS in the presence of renewable energy resources</article-title><source>Journal of Energy Storage</source><year>2020</year><volume>31</volume><fpage>101520</fpage><pub-id pub-id-type="doi">10.1016/j.est.2020.101520</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marzebali</surname><given-names>MH</given-names></name><name><surname>Mazidi</surname><given-names>M</given-names></name><name><surname>Mohiti</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">An adaptive droop-based control strategy for fuel cell-battery hybrid energy storage system to support primary frequency in stand-alone microgrids</article-title><source>Journal of Energy Storage</source><year>2020</year><volume>27</volume><pub-id pub-id-type="doi">10.1016/j.est.2019.101127</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirjalili</surname><given-names>S</given-names></name><name><surname>Mirjalili</surname><given-names>SM</given-names></name><name><surname>Lewis</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Grey Wolf Optimizer</article-title><source>Advances in Engineering Software</source><year>2014</year><volume>69</volume><fpage>46</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1016/j.advengsoft.2013.12.007</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qais</surname><given-names>MH</given-names></name><name><surname>Hasanien</surname><given-names>HM</given-names></name><name><surname>Alghuwainem</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A Grey Wolf optimizer for optimum parameters of multiple PI controllers of a grid-connected PMSG driven by variable speed wind turbine</article-title><source>IEEE Access</source><year>2018</year><volume>6</volume><fpage>44120</fpage><lpage>44128</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2018.2864303</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinivasarathnam</surname><given-names>C</given-names></name><name><surname>Yammani</surname><given-names>C</given-names></name><name><surname>Maheswarapu</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Load frequency control of multi-microgrid system considering renewable energy sources using Grey Wolf optimization</article-title><source>Smart Science</source><year>2019</year><volume>7</volume><issue>3</issue><fpage>198</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1080/23080477.2019.1630057</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Annamraju, A., &amp; Nandiraju, S. (2018) Robust frequency control in an autonomous microgrid: a two-stage adaptive fuzzy approach. <italic>Electric Power Components and Systems</italic>, 1–12.</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padhy</surname><given-names>S</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Application of a simplified Grey Wolf optimization technique for adaptive fuzzy PID controller design for frequency regulation of a distributed power generation system</article-title><source>Protection and Control of Modern Power Systems</source><year>2021</year><volume>6</volume><issue>1</issue><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1186/s41601-021-00180-4</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Wei</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Decentralised coordination control strategy of the PV generator, storage battery and hydrogen production unit in islanded AC microgrid</article-title><source>IET Renewable Power Generation</source><year>2020</year><volume>14</volume><issue>6</issue><fpage>1053</fpage><lpage>1062</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg.2019.0842</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>AL-bonsrulah</surname><given-names>HAZ</given-names></name><etal/></person-group><article-title xml:lang="en">Design and simulation studies of hybrid power systems based on photovoltaic, wind, electrolyzer, and PEM fuel cells</article-title><source>Energies</source><year>2021</year><volume>14</volume><issue>9</issue><fpage>2643</fpage><pub-id pub-id-type="doi">10.3390/en14092643</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>I</given-names></name><name><surname>Das</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Fractional order fuzzy control of hybrid power system with renewable generation using chaotic PSO</article-title><source>ISA Transactions</source><year>2016</year><volume>62</volume><fpage>19</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1016/j.isatra.2015.03.003</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferahtia</surname><given-names>S</given-names></name><name><surname>Djerioui</surname><given-names>A</given-names></name><name><surname>Zeghlache</surname><given-names>S</given-names></name><name><surname>Houari</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A hybrid power system based on fuel cell, photovoltaic source and supercapacitor</article-title><source>SN Applied Sciences</source><year>2020</year><volume>2</volume><issue>5</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1007/s42452-020-2709-0</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferahtia</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal adaptive gain LQR-based energy management strategy for battery-supercapacitor hybrid power system</article-title><source>Energies</source><year>2021</year><volume>14</volume><issue>6</issue><fpage>1660</fpage><pub-id pub-id-type="doi">10.3390/en14061660</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>XS</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Pan</surname><given-names>ZN</given-names></name><name><surname>Yang</surname><given-names>B</given-names></name><name><surname>Bao</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Lifelong learning for complementary generation control of interconnected power grids with high-penetration renewables and EVs</article-title><source>IEEE Transactions on Power Systems</source><year>2018</year><volume>33</volume><issue>4</issue><fpage>4097</fpage><lpage>4110</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2017.2767318</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Tan</surname><given-names>T</given-names></name><name><surname>Zhou</surname><given-names>B</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>B</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Adaptive distributed auction-based algorithm for optimal mileage based AGC dispatch with high participation of renewable energy</article-title><source>International Journal of Electrical Power &amp; Energy Systems</source><year>2021</year><volume>124</volume><fpage>106371</fpage><pub-id pub-id-type="doi">10.1016/j.ijepes.2020.106371</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Pu</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Coordinated control of electric-hydrogen hybrid energy storage for multi-microgrid with fuel cell/ electrolyzer/ PV/ battery</article-title><source>J. Energy Storage</source><year>2021</year><volume>42</volume><fpage>103110</fpage><pub-id pub-id-type="doi">10.1016/j.est.2021.103110</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Kbidi, F., Damour, C., Grondin, D., Hilairet, M., &amp; Benne, M. (2019). Optimal fuel cell and electrolyser Energy Management System for microgrid. In <italic>IECON proceedings (industrial electronics conference),</italic> (Vol. 2019-Octob, pp. 2197–2202).</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Wei</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Model construction and energy management system of lithium battery, PV generator, hydrogen production unit and fuel cell in islanded AC microgrid</article-title><source>International Journal of Hydrogen Energy</source><year>2020</year><volume>45</volume><issue>33</issue><fpage>16381</fpage><lpage>16397</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.04.155</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mandal</surname><given-names>R</given-names></name><name><surname>Chatterjee</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Frequency control and sensitivity analysis of an isolated microgrid incorporating fuel cell and diverse distributed energy sources</article-title><source>International Journal of Hydrogen Energy</source><year>2020</year><volume>45</volume><issue>23</issue><fpage>13009</fpage><lpage>13024</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.02.211</pub-id></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Wei</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Decentralized coordination control of PV generators, storage battery, hydrogen production unit and fuel cell in islanded DC microgrid</article-title><source>International Journal of Hydrogen Energy</source><year>2020</year><volume>45</volume><issue>15</issue><fpage>8243</fpage><lpage>8256</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.01.058</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bornapour</surname><given-names>M</given-names></name><name><surname>Hooshmand</surname><given-names>RA</given-names></name><name><surname>Khodabakhshian</surname><given-names>A</given-names></name><name><surname>Parastegari</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Optimal stochastic coordinated scheduling of proton exchange membrane fuel cell-combined heat and power, wind and photovoltaic units in micro grids considering hydrogen storage</article-title><source>Applied Energy</source><year>2017</year><volume>202</volume><fpage>308</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2017.05.133</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>I</given-names></name><name><surname>Das</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Fractional order AGC for distributed energy resources using robust optimization</article-title><source>IEEE Transactions on Smart Grid</source><year>2016</year><volume>7</volume><issue>5</issue><fpage>2175</fpage><lpage>2186</lpage><pub-id pub-id-type="doi">10.1109/TSG.2015.2459766</pub-id></mixed-citation></ref></ref-list></ref-list><glossary><title>Abbreviations</title><def-list><def-item><term>AE</term><def><p id="Par2">Aqua electrolyzer</p></def></def-item><def-item><term>BESS</term><def><p id="Par3">Battery energy storage system</p></def></def-item><def-item><term>CI</term><def><p id="Par4">Clegg integrator</p></def></def-item><def-item><term>DG</term><def><p id="Par5">Diesel generator</p></def></def-item><def-item><term>ESS</term><def><p id="Par6">Energy storage system</p></def></def-item><def-item><term>EVs</term><def><p id="Par7">Electric vehicles</p></def></def-item><def-item><term>FC</term><def><p id="Par8">Fuel cell</p></def></def-item><def-item><term>FESS</term><def><p id="Par9">Flywheel energy storage system</p></def></def-item><def-item><term>FO</term><def><p id="Par10">Fractional-order</p></def></def-item><def-item><term>GWO</term><def><p id="Par11">Grey wolf optimization</p></def></def-item><def-item><term>HGSs</term><def><p id="Par12">Hybrid generation systems</p></def></def-item><def-item><term>ITAE</term><def><p id="Par13">Integral time absolute error</p></def></def-item><def-item><term>ITSE</term><def><p id="Par14">Integral of time multiplied squared error</p></def></def-item><def-item><term>LFC</term><def><p id="Par15">Load frequency control</p></def></def-item><def-item><term>Max</term><def><p id="Par16">Maximum</p></def></def-item><def-item><term>MFs</term><def><p id="Par17">Membership functions</p></def></def-item><def-item><term>MG</term><def><p id="Par18">Microgrid</p></def></def-item><def-item><term>Min</term><def><p id="Par19">Minimum</p></def></def-item><def-item><term>mMSA</term><def><p id="Par20">Modified moth swarm algorithm</p></def></def-item><def-item><term>PD-PID</term><def><p id="Par21">Proportional derivative-proportional integral derivative</p></def></def-item><def-item><term>PI</term><def><p id="Par22">Proportional-integral</p></def></def-item><def-item><term>PSO</term><def><p id="Par23">Particle swarm optimization</p></def></def-item><def-item><term>PV</term><def><p id="Par24">Photovoltaic</p></def></def-item><def-item><term>RESs</term><def><p id="Par25">Renewable energy sources</p></def></def-item><def-item><term>SMES</term><def><p id="Par26">Superconducting magnetic energy storage</p></def></def-item><def-item><term>SoC</term><def><p id="Par27">Sate of charge</p></def></def-item><def-item><term>STA</term><def><p id="Par28">Super-twisting algorithm</p></def></def-item><def-item><term>Std</term><def><p id="Par29">Standard deviation</p></def></def-item><def-item><term>T</term><def><p id="Par30">Time constant</p></def></def-item><def-item><term>WGs</term><def><p id="Par31">Wind generators</p></def></def-item></def-list></glossary></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Adaptive coordination control method</facet-value><facet-value count="1">Fraction factor (Kn)</facet-value><facet-value count="1">Frequency control</facet-value><facet-value count="1">Fuel cell</facet-value><facet-value count="1">Grey wolf optimization (GWO) algorithm</facet-value><facet-value count="1">Renewable energy sources</facet-value></facet><facet name="pub"><facet-value count="1">Protection and Control of Modern Power Systems</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">Egypt</facet-value><facet-value count="1">Hungary</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
