<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/978-3-030-15943-6_11</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><book-part-wrapper dtd-version="2.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><book-meta><book-id book-id-type="doi">10.1007/978-3-030-15943-6</book-id><book-id book-id-type="publisher-id">978-3-030-15943-6</book-id><book-id book-id-type="book-title-id">459867</book-id><book-title-group><book-title>Aquaponics Food Production Systems</book-title><subtitle>Combined Aquaculture and Hydroponic Production Technologies for the Future</subtitle></book-title-group><contrib-group content-type="book editors"><contrib contrib-type="editor"><name><surname>Goddek</surname><given-names>Simon</given-names><prefix>Dr.</prefix></name><address><email>simon.goddek@wur.nl</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="editor"><name><surname>Joyce</surname><given-names>Alyssa</given-names></name><address><email>alyssa.joyce@marine.gu.se</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="editor"><name><surname>Kotzen</surname><given-names>Benz</given-names></name><address><email>b.kotzen@gre.ac.uk</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="editor"><name><surname>Burnell</surname><given-names>Gavin M.</given-names><prefix>Dr.</prefix></name><address><email>g.burnell@ucc.ie</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4818.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0791 5666</institution-id><institution content-type="org-division">Mathematical and Statistical Methods (Biometris)</institution><institution content-type="org-name">Wageningen University</institution></institution-wrap><addr-line content-type="city">Wageningen</addr-line><country country="NL">The Netherlands</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.8761.8</institution-id><institution-id institution-id-type="ISNI">0000 0000 9919 9582</institution-id><institution content-type="org-division">Department of Marine Science</institution><institution content-type="org-name">University of Gothenburg</institution></institution-wrap><addr-line content-type="city">Gothenburg</addr-line><country country="SE">Sweden</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.36316.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 0806 5472</institution-id><institution content-type="org-division">School of Design</institution><institution content-type="org-name">University of Greenwich</institution></institution-wrap><addr-line content-type="city">London</addr-line><country country="GB">UK</country></aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.7872.a</institution-id><institution-id institution-id-type="ISNI">0000000123318773</institution-id><institution content-type="org-division">School of Biological, Earth and Environmental Sciences</institution><institution content-type="org-name">University College Cork</institution></institution-wrap><addr-line content-type="city">Cork</addr-line><country country="IE">Ireland</country></aff></contrib-group><pub-date date-type="pub"><string-date>2019-01-01</string-date></pub-date><isbn content-type="ppub">978-3-030-15942-9</isbn><isbn content-type="epub">978-3-030-15943-6</isbn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher><permissions><copyright-statement content-type="compact">© The Editor(s) (if applicable) and The Author(s) 2019</copyright-statement><copyright-statement content-type="comment">This book is an open access publication.</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>The Editor(s) (if applicable) and The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This book is licensed under the terms of the Creative Commons Attribution 4.0 International License (http://creativecommons.org/licenses/by/4.0/), which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license and indicate if changes were made.</license-p><license-p>The images or other third party material in this book are included in the book's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the book's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder.</license-p></license></permissions><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>book-chapter-count</meta-name><meta-value>25</meta-value></custom-meta><custom-meta><meta-name>media-type</meta-name><meta-value>eBook</meta-value></custom-meta><custom-meta><meta-name>contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>book-product-type</meta-name><meta-value>Contributed volume</meta-value></custom-meta><custom-meta><meta-name>book-subject-primary</meta-name><meta-value>Life Sciences</meta-value></custom-meta><custom-meta><meta-name>book-subject-secondary</meta-name><meta-value>Freshwater &amp; Marine Ecology</meta-value></custom-meta><custom-meta><meta-name>book-subject-secondary</meta-name><meta-value>Fish &amp; Wildlife Biology &amp; Management</meta-value></custom-meta><custom-meta><meta-name>book-subject-secondary</meta-name><meta-value>Agriculture</meta-value></custom-meta><custom-meta><meta-name>book-subject-secondary</meta-name><meta-value>Sustainable Development</meta-value></custom-meta><custom-meta><meta-name>book-subject-secondary</meta-name><meta-value>Environmental and Sustainability Education</meta-value></custom-meta><custom-meta><meta-name>book-subject-collection</meta-name><meta-value>Biomedical and Life Sciences</meta-value></custom-meta></custom-meta-group></book-meta><book-part book-part-type="part" id="Part2" seq="2"><book-part-meta><book-part-id book-part-id-type="publisher-id">2</book-part-id><title-group><label>Part II</label><title>Specific Aquaponics Technology</title></title-group></book-part-meta><body><book-part book-part-type="chapter" id="b978-3-030-15943-6_11" seq="11"><book-part-meta><book-part-id book-part-id-type="doi">10.1007/978-3-030-15943-6_11</book-part-id><book-part-id book-part-id-type="chapter">11</book-part-id><title-group><label>Chapter 11</label><title>Aquaponics Systems Modelling</title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Keesman</surname><given-names>Karel J.</given-names></name><address><email>karel.keesman@wur.nl</email></address><xref ref-type="aff" rid="Aff5">5</xref><xref ref-type="corresp" rid="IDb978303015943611_cor1">a</xref></contrib><contrib contrib-type="author"><name><surname>Körner</surname><given-names>Oliver</given-names></name><address><email>koerner@igzev.de</email></address><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Wagner</surname><given-names>Kai</given-names></name><address><email>kai.wagner@htwsaar.de</email></address><xref ref-type="aff" rid="Aff7">7</xref></contrib><contrib contrib-type="author"><name><surname>Urban</surname><given-names>Jan</given-names></name><address><email>urbanj@frov.jcu.cz</email></address><xref ref-type="aff" rid="Aff8">8</xref></contrib><contrib contrib-type="author"><name><surname>Karimanzira</surname><given-names>Divas</given-names></name><address><email>divas.karimanzira@iosb-ast.fraunhofer.de</email></address><xref ref-type="aff" rid="Aff9">9</xref></contrib><contrib contrib-type="author"><name><surname>Rauschenbach</surname><given-names>Thomas</given-names></name><address><email>Thomas.Rauschenbach@iosb-ast.fraunhofer.de</email></address><xref ref-type="aff" rid="Aff9">9</xref></contrib><contrib contrib-type="author"><name><surname>Goddek</surname><given-names>Simon</given-names></name><address><email>simon.goddek@wur.nl</email><email>simon@goddek.nl</email></address><xref ref-type="aff" rid="Aff5">5</xref></contrib><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.4818.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0791 5666</institution-id><institution content-type="org-division">Mathematical and Statistical Methods (Biometris)</institution><institution content-type="org-name">Wageningen University</institution></institution-wrap><addr-line content-type="city">Wageningen</addr-line><country country="NL">The Netherlands</country></aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.461794.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 0493 7589</institution-id><institution content-type="org-name">Leibniz-Institute of Vegetable and Ornamental Crops (IGZ)</institution></institution-wrap><addr-line content-type="city">Grossbeeren</addr-line><country country="DE">Germany</country></aff><aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.424705.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 0374 4072</institution-id><institution content-type="org-division">Institut für physikalische Prozesstechnik</institution><institution content-type="org-name">University of Applied Sciences Saarbrücken</institution></institution-wrap><addr-line content-type="city">Saarbrücken</addr-line><country country="DE">Germany</country></aff><aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.14509.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 2166 4904</institution-id><institution content-type="org-division">Laboratory of Signal and Image Processing, Institute of Complex Systems, South Bohemian Research Center of Aquaculture and Biodiversity of Hydrocenoses, Faculty of Fisheries and Protection of Waters</institution><institution content-type="org-name">University of South Bohemia in Ceske Budejovice</institution></institution-wrap><addr-line content-type="city">Nove Hrady</addr-line><country country="CZ">Czech Republic</country></aff><aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.466706.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2187 7504</institution-id><institution content-type="org-name">Fraunhofer IOSB-AST</institution></institution-wrap><addr-line content-type="city">Ilmenau</addr-line><country country="DE">Germany</country></aff></contrib-group><author-notes><corresp id="IDb978303015943611_cor1"><label>a</label><email>karel.keesman@wur.nl</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>22</day><month>06</month><year>2019</year></pub-date><fpage>267</fpage><lpage>299</lpage><pub-history><date date-type="registration"><day>28</day><month>2</month><year>2019</year></date><date date-type="online"><day>22</day><month>06</month><year>2019</year></date></pub-history><permissions><copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This chapter is licensed under the terms of the Creative Commons Attribution 4.0 International License (http://creativecommons.org/licenses/by/4.0/), which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license and indicate if changes were made.</license-p><license-p>The images or other third party material in this chapter are included in the chapter's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the chapter's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Mathematical models can take very different forms and very different levels of complexity. A systematic way to postulate, calibrate and validate, as provided by systems theory, can therefore be very helpful. In this chapter, dynamic systems modelling of aquaponic (AP) systems, from a systems theoretical perspective, is considered and demonstrated to each of the subsystems of the AP system, such as fish tanks, anaerobic digester and hydroponic (HP) greenhouse. It further shows the links between the subsystems, so that in principle a complete AP systems model can be built and integrated into daily practice with respect to management and control of AP systems. The main challenge is to choose an appropriate model complexity that meets the experimental data for estimation of parameters and states and allows us to answer questions related to the modelling objective, such as simulation, experiment design, prediction and control.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Modelling</kwd><kwd>Recirculating aquaculture system</kwd><kwd>Anaerobic digestion</kwd><kwd>Hydroponic greenhouse</kwd><kwd>Multi-loop aquaponic system</kwd><kwd>Tools</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>chapter-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>chapter-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/978-3-030-15943-6_Chapter_11.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta></custom-meta-group></book-part-meta><body><sec id="Sec1"><title>Introduction</title><p id="Par2">In general, mathematical models can take very different forms depending on the system under study, which may range from social, economic and environmental to mechanical and electrical systems. Typically, the internal mechanisms of social, economic or environmental systems are not very well known or understood and often only small data sets are available, while the prior knowledge of mechanical and electrical systems is at a high level, and experiments can easily be done. Apart from this, the model form also strongly depends on the final objective of the modelling procedure. For instance, a model for process design or simulation should contain much more detail than a model used for studying different long-term scenarios.</p><p id="Par3">In particular, for a wide range of applications (e.g. Keesman <xref ref-type="bibr" rid="CR35">2011</xref>), models are developed to:<list list-type="bullet"><list-item><p id="Par4">Obtain or enlarge insight in different phenomena, for example, recovering physical or economic relationships.</p></list-item><list-item><p id="Par5">Analyse process behaviour using simulation tools, for example, process training of operators or weather forecasts.</p></list-item><list-item><p id="Par6">Estimate state variables that cannot be easily measured in real time on the basis of available measurements, for instance, online process information.</p></list-item><list-item><p id="Par7">Control, for instance, in the internal model control or model-based predictive control concept or to manage processes.</p></list-item></list></p><p id="Par8">A critical step in the modelling of any system is to find a mathematical model which adequately describes the actual situation or state. Firstly, the system boundaries and the system variables have to be specified. Then relationships between these variables have to be specified on the basis of prior knowledge, and assumptions about the uncertainties in the model have to be made. Combining this information defines the model structure. Still the model may contain some unknown or incompletely known coefficients, the model parameters, which in case of time-varying behaviour define an additional set of system variables. For a general introduction to mathematical modelling we refer to, for instance, Sinha and Kuszta (<xref ref-type="bibr" rid="CR60">1983</xref>), Willems and Polderman (<xref ref-type="bibr" rid="CR69">1998</xref>) and Zeigler et al. (<xref ref-type="bibr" rid="CR72">2000</xref>).</p><p id="Par9">In this chapter, the modelling of an aquaponic (food) production (AP) system will be described. Figure <xref rid="Fig1" ref-type="fig">11.1</xref> shows a typical example of an AP system, i.e. the so-called decoupled three-loop aquaponic system. As a result of basic principles modelling, using conservation laws and constitutive relationships, mathematical models of all kinds of AP systems are usually represented as a set of ordinary or partial differential equations. These mathematical models are commonly used for design, estimation and control. In each of these specific modelling objectives, we distinguish between analysis and synthesis.<fig id="Fig1"><label>Fig. 11.1</label><caption xml:lang="en"><p>Decoupled, three-loop aquaponic system with RAS, hydroponic and remineralization subsystems. (Goddek, <xref ref-type="bibr" rid="CR21">2017</xref>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par10">The outline of the chapter is as follows. In Sect. <xref rid="Sec1" ref-type="sec">11.1</xref> some background on mathematical systems modelling is presented. Sections <xref rid="Sec2" ref-type="sec">11.2</xref>, <xref rid="Sec3" ref-type="sec">11.3</xref>, <xref rid="Sec8" ref-type="sec">11.4</xref> and <xref rid="Sec11" ref-type="sec">11.5</xref> describe the modelling of a recirculating aquaculture system (RAS), anaerobic digestion, hydroponic (HP) greenhouse and a multi-loop AP system, respectively. In Sect. <xref rid="Sec12" ref-type="sec">11.6</xref> modelling tools are introduced and illustrated with some examples. The chapter concludes with a Discussion and Conclusions section.</p></sec><sec id="Sec2"><title>Background</title><sec><p id="Par11">Many definitions of a system are available, ranging from loose descriptions to strict mathematical formulations. In what follows, a <italic>system</italic> is considered to be an object in which different variables interact at all kinds of time and space scales and that produces observable signals. These types of systems are also called <italic>open systems</italic>. A graphical representation of a general open system (<bold><italic>S</italic></bold>) with vector-valued input and output signals is represented in Fig. <xref rid="Fig2" ref-type="fig">11.2</xref>. Thus, multiple inputs or outputs are combined in one single arrow. So, the system variables may be scalars or vectors. In addition, they can be continuous or discrete functions of time. It is important to stress that the arrows in Fig. <xref rid="Fig2" ref-type="fig">11.2</xref> represent signal flows and thus not necessarily physical flows.<fig id="Fig2"><label>Fig. 11.2</label><caption xml:lang="en"><p>General open system representation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig2_HTML.png" id="MO2"/></fig></p></sec><sec><p id="Par12">It is also possible to connect systems into a network, as in an AP system, with parallel, feedback and feedforward paths. Figure <xref rid="Fig3" ref-type="fig">11.3</xref> presents an example of such a network.<fig id="Fig3"><label>Fig. 11.3</label><caption xml:lang="en"><p>Open system network representation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig3_HTML.png" id="MO3"/></fig></p></sec><sec><p id="Par13">For controller/management analysis and synthesis, it is often convenient to connect the system (<italic>S</italic>) to the controller or management strategy (<italic>C</italic>), as in Fig. <xref rid="Fig4" ref-type="fig">11.4</xref>. Most often the input to the controller or management strategy is the external steering signal of the controlled system, and the output of the system is the observed system’s behaviour.<fig id="Fig4"><label>Fig. 11.4</label><caption xml:lang="en"><p>Controlled system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig4_HTML.png" id="MO4"/></fig></p></sec><sec><p id="Par14">Finally, to emphasize the incorporation of a mathematical model (<italic>M</italic>) into the controller structure or management strategy, the following model-based controlled system representation is introduced (Fig. <xref rid="Fig5" ref-type="fig">11.5</xref>).<fig id="Fig5"><label>Fig. 11.5</label><caption xml:lang="en"><p>Model-based controlled system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig5_HTML.png" id="MO5"/></fig></p></sec><sec><p id="Par15">For now, it suffices to present the block diagram representation. In subsequent sections, the modelling of AP systems will be worked out in more detail.</p></sec><sec><p id="Par16">In systems theory the basic structure of a mathematical model (<italic>M</italic>) is schematically represented as in Fig. <xref rid="Fig6" ref-type="fig">11.6</xref>. In Fig. <xref rid="Fig6" ref-type="fig">11.6</xref>, <italic>x</italic> is the so-called state of the system, <italic>u</italic> the control input, <italic>y</italic> the output, <italic>w</italic> the disturbance input and <italic>v</italic> the output noise. In general, each of these variables is vector-valued.<fig id="Fig6"><label>Fig. 11.6</label><caption xml:lang="en"><p>Basic structure of mathematical model (M)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig6_HTML.png" id="MO6"/></fig></p></sec><sec><p id="Par17">In continuous time, the following set of equations describes a general dynamic model (<italic>M</italic>), with parameter vector <italic>p</italic>, in what is called <italic>state-space</italic> form:</p></sec><sec><p id="Par18"><disp-formula id="Equ1"><label>11.1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dx</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=",,,;"><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi>p</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mfenced close=")" open="(" separators=",,;"><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi>p</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℜ</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{l}\frac{dx(t)}{dt}=f\left(t,x(t),u(t),w(t);p\right),\kern2em x(0)={x}_0\\ {}y(t)=g\left(t,x(t),u(t);p\right)+v(t),\kern2em t\in {\Re}^{+}\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ1.gif"/></alternatives></disp-formula>where the first equation describes the nonlinear and time-varying dynamics of the system in terms of state variables (<italic>x</italic>) and the second one expresses the algebraic relationship between <italic>u</italic>, <italic>x</italic> and <italic>y</italic>. This state-space model representation has been a starting point for many software implementations for design, control and estimation. In what follows, however, only deterministic models, thus without the stochastic vectors <italic>v</italic> and <italic>w</italic>, are considered. Let us illustrate this theory on a fish tank system.</p></sec><sec id="FPar1"><title>Example: Fish Tank System</title><p id="Par19">Consider the following fish tank, which is a typical example of the general system presented in Fig. <xref rid="Fig7" ref-type="fig">11.7</xref>.<fig id="Fig7"><label>Fig. 11.7</label><caption xml:lang="en"><p>Fish tank with volume-controlled flow using level controller (LC)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig7_HTML.png" id="MO7"/></fig></p><p id="Par20">Let us start with specifying our prior knowledge of the internal system mechanisms. The following mass balance can be defined in terms of the volume of the storage tank (<italic>V</italic>), also called the <italic>state</italic> of the system, inflows <italic>u</italic>(<italic>t</italic>) and outflows <italic>y</italic>(<italic>t</italic>):<disp-formula id="Equ2"><label>11.2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \frac{dV(t)}{dt}=u(t)-y(t) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ2.gif"/></alternatives></disp-formula></p><p id="Par21">Suppose there is a level controller (LC) that keeps the outflow proportional to the volume in the tank. This can be enforced by implementing the following proportional control law,</p><p id="Par22"><disp-formula id="Equ3"><label>11.3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mi>Y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">KV</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ Y(t)= KV(t) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ3.gif"/></alternatives></disp-formula>with <italic>K</italic> a real, positive constant. Hence, after substituting Eq. (<xref rid="Equ3" ref-type="disp-formula">11.3</xref>) into (11.2), we obtain the following differential equation<disp-formula id="Equ4"><label>11.4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="italic">KV</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \frac{dV(t)}{dt}+ KV(t)=u(t) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ4.gif"/></alternatives></disp-formula></p><p id="Par23">For this specific linear differential equation with constant coefficients, an analytical solution exists and is given by<disp-formula id="Equ5"><label>11.5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="italic">Kt</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi mathvariant="italic">Ke</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mi mathvariant="italic">ds</mml:mi></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ y(t)=y(0){e}^{- Kt}+{\int}_0^t{Ke}^{-K\left(t-s\right)}u(s) ds $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ5.gif"/></alternatives></disp-formula>under the assumption that <italic>u</italic>(<italic>t</italic>) = 0 for <italic>t</italic> &lt; 0. From this example it is clear that applying first principles – mass conservation in this case – directly leads to an ordinary differential equation. In state-space format, the model can be represented as<disp-formula id="Equ6"><label>11.6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dx</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">Kx</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Kx</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{l}\frac{dx(t)}{dt}=- Kx(t)+u(t)\\ {}y(t)= Kx(t)\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ6.gif"/></alternatives></disp-formula></p><p id="Par24">With <italic>x</italic> volume, <italic>u</italic> flow input and <italic>K</italic> controller gain. Thus, in terms of the general state-space Eq. (<xref rid="Equ1" ref-type="disp-formula">11.1</xref>), <italic>f</italic>(<italic>t</italic>, <italic>x</italic>(<italic>t</italic>), <italic>u</italic>(<italic>t</italic>); <italic>p</italic>) ≡  − <italic>Kx</italic>(<italic>t</italic>) + <italic>u</italic>(<italic>t</italic>) and <italic>g</italic>(<italic>t</italic>, <italic>x</italic>(<italic>t</italic>), <italic>u</italic>(<italic>t</italic>); <italic>p</italic>) ≡ <italic>Kx</italic>(<italic>t</italic>).</p><p id="Par25">For two volume-controlled fish tanks in series with volume <italic>V</italic><sub>1</sub> and <italic>V</italic><sub>2</sub>, and controller gain <italic>K</italic><sub>1</sub> and <italic>K</italic><sub>2</sub>, respectively, two mass balances can be formulated, i.e.</p><p id="Par26"><disp-formula id="Equ7"><label>11.7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">dV</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">dV</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{l}\frac{dV_1(t)}{dt}=-{K}_1{V}_1(t)+u(t)\\ {}\frac{dV_2(t)}{dt}={K}_1{V}_1(t)-{K}_2{V}_2(t)\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ7.gif"/></alternatives></disp-formula></p><p id="Par27">In vector-matrix form, and for physical outflow <italic>y</italic>(<italic>t</italic>), we can write:</p><p id="Par28"><disp-formula id="Equ8"><label>11.8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mtable displaystyle="true" groupalign="{right left}"><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:maligngroup/><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="-8.25em"/><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:maligngroup/><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{c}\frac{d}{dt}\left[\begin{array}{l}{V}_1(t)\\ {}{V}_2(t)\end{array}\right]=\left[\begin{array}{cc}-{K}_1&amp; 0\\ {}{K}_1&amp; -{K}_2\end{array}\right]\left[\begin{array}{l}{V}_1(t)\\ {}{V}_2(t)\end{array}\right]+\left[\begin{array}{l}1\\ {}0\end{array}\right]u(t)\\ {}\kern-8.25em y(t)={K}_2{V}_2(t)\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ8.gif"/></alternatives></disp-formula></p><p id="Par29">And thus, with <italic>x</italic><sub>1</sub> = <italic>V</italic><sub>1</sub>,<italic>x</italic><sub>2</sub> = <italic>V</italic><sub>2</sub>: <inline-formula id="IEq1"><alternatives><mml:math display="inline" id="IEq1_Math"><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=",,;"><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi>p</mml:mi></mml:mfenced><mml:mo>≡</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ f\left(t,x(t),u(t);p\right)\equiv \left[\begin{array}{l}-{K}_1{x}_1(t)+u(t)\\ {}{K}_1{x}_1(t)-{K}_2{x}_2(t)\end{array}\right] $$
\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_IEq1.gif"/></alternatives></inline-formula> and <italic>g</italic>(<italic>t</italic>, <italic>x</italic>(<italic>t</italic>), <italic>u</italic>(<italic>t</italic>); <italic>p</italic>) ≡ <italic>K</italic><sub>2</sub><italic>x</italic><sub>2</sub>(<italic>t</italic>).</p><p id="Par30">In the next sections, each of the subsystems of the AP system (Fig. <xref rid="Fig1" ref-type="fig">11.1</xref>) will be described in more detail.</p></sec></sec><sec id="Sec3"><title>RAS Modelling</title><p id="Par31">Global fish aquaculture reached 50 million tons in 2014 (FAO <xref ref-type="bibr" rid="CR16">2016</xref>). Given the growing human population, there is a growing demand for fish proteins. Sustainable growth of aquaculture requires novel (bio)technologies such as recirculating aquaculture systems (RAS). RAS have a low water consumption (Orellana <xref ref-type="bibr" rid="CR50">2014</xref>) and allow for a recycling of excretory products (Waller et al. <xref ref-type="bibr" rid="CR66">2015</xref>). RAS provide suitable living conditions for fish, as a result of a multistep water treatment, such as particle separation, nitrification (biofiltration), gas exchange and temperature control. Dissolved and particulate excretory products can be transferred to secondary treatment such as plant (Waller et al. <xref ref-type="bibr" rid="CR66">2015</xref>) or algae production in integrated aqua-agriculture (IAAC) systems. IAAC systems are sustainable alternatives to conventional aquaculture systems and in particular are a promising expansion to RAS. In RAS it would be necessary to circulate the process water which has special implications for the process technology in both, the RAS and the algae/plant system. To combine RAS and algae/plant system, a deep understanding of the interaction between fish and water treatment is prerequisite and can be derived from dynamic modelling. The metabolism in fish follows a daily pattern which is well represented by the gastric evacuation rate (Richie et al. <xref ref-type="bibr" rid="CR57">2004</xref>). Particle separation, biofiltration and gas exchange are subjected to the same pattern. For design purposes the characterization of the basic components of a RAS treatment system should be investigated through simulation models. These simulation models are highly complex. Available numerical models for RAS capture only a small part of the complexity and consider only a part of the components with corresponding mechanisms. Hence, in this chapter, only a small part of a dynamic RAS model will be presented, i.e. nitrification-based biofiltration. The conversion of toxic ammonia into nitrate is a central process in the water treatment process in RAS. In the following, the dynamic modelling of the mass balance of ammonia excretion of fish and the conversion of ammonia into nitrate will be demonstrated as well as the transfer of the nutrient into an aquaponic system. With this it is possible not only to engineer a RAS but also to integrate fish production into an IAAC system based on valid parameters.</p><sec id="Sec4"><title>Dynamic Model of Nitrification-Based Biofiltration in RAS</title><p id="Par32">The model is subdivided into a fish model for European seabass, <italic>Dicentrarchus labrax</italic>, a model describing the time- dependenting excretion of ammonia, and a nitrification model (Fig. <xref rid="Fig8" ref-type="fig">11.8</xref>). The fish excretion pattern is introduced into the model through the input vector u (Eq. <xref rid="Equ15" ref-type="disp-formula">11.15</xref>), similar to the approach used by Wik et al. (<xref ref-type="bibr" rid="CR68">2009</xref>). The complexity of the fish model is kept low to be able to explain its method of implementation. Nonetheless, a short introduction into modelling fish is presented in Sect. <xref rid="Sec5" ref-type="sec">11.3.2</xref>. Four basic aspects important to describe the nutrient flow in RAS (Badiola et al. <xref ref-type="bibr" rid="CR2">2012</xref>) are:<list list-type="order"><list-item><p id="Par33">The flow Q, which is the total process water flow per unit time through the RAS, determines the mass transfer of all dissolved and particulate matter, including ammonia and nitrate.</p></list-item><list-item><p id="Par34">The excretion of the fish input ammonia to the RAS process water and is depicted by the product of matrix B and vector u (Eq. <xref rid="Equ15" ref-type="disp-formula">11.15</xref>).</p></list-item><list-item><p id="Par35">The ammonia conversion into nitrate, taking place in the nitrification, is depicted in the nitrification vector n (Eq. <xref rid="Equ15" ref-type="disp-formula">11.15</xref>).</p></list-item><list-item><p id="Par36">The nutrient transfer from the RAS to a connected HP system is depicted in vector u (Eq. <xref rid="Equ15" ref-type="disp-formula">11.15</xref>). Other important aspects of the RAS process chain such as solid removal, dissolved oxygen concentration and carbon dioxide concentration are not considered here. Hints for modelling these can be found in Sects. <ext-link xlink:href="10.1007/978-3-030-15943-6_3" ext-link-type="doi">3.1.1</ext-link> and <ext-link xlink:href="10.1007/978-3-030-15943-6_3" ext-link-type="doi">3.2.2</ext-link> of this book.</p></list-item></list><fig id="Fig8"><label>Fig. 11.8</label><caption xml:lang="en"><p>RAS setup with fish tank, pump, nitrification reactor and water transfer to hydroponic system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig8_HTML.png" id="MO8"/></fig></p></sec><sec id="Sec5"><title>Fish</title><p id="Par37">A variety of models in the scientific literature predict growth and feed intake of different aquatic species. The models describe growth as weight gain per day, as percentage growth increment or as specific growth rate based on an exponential growth model. Models are often valid for specific life stages. Feed consumption, biomass and gender are influencing the model output as well as the environmental conditions such as temperature, oxygen level and nutrient concentration (Lugert et al. <xref ref-type="bibr" rid="CR44">2014</xref>). Careful research is needed to identify the correct model used for the specific application. Commercial RAS that consists of several cohorts of fish in different life stages require the modelling to incorporate cohorts into the model (Fig. <ext-link xlink:href="10.1007/978-3-030-15943-6_8" ext-link-type="doi">8.6</ext-link>) (Halamachi and Simon <xref ref-type="bibr" rid="CR27">2005</xref>). The excretory mass flow for the European seabass (<italic>Dicentrarchus labrax</italic>) can be estimated with algorithms published by Lupatsch and Kissil (<xref ref-type="bibr" rid="CR300">1998</xref>).</p><p id="Par38">Here the net nitrogen mass flow into the process water is estimated from the feed composition (protein content), the amount of given feed and the nitrogen retained in body tissues through the growth (weight increment) of fish. The faecal nitrogen losses are not included in the model, but excretion rate is corrected assuming a share of 0.25 and 0.75 of nitrogen excretion for faecal loss and ammonia excretion, respectively. The nitrogen input through the feeding of fish is estimated from the protein content and the average relative nitrogen content of proteins which is assumed to be 0.16. The protein content of seabass tissue is reported at around 0.17 g proteins g<sup>−1</sup> seabass (Lupatsch et al. <xref ref-type="bibr" rid="CR45">2003</xref>). For a fish gaining body weight by consuming a given amount of feed, the nitrogen excretion (X<sub>N,excreted</sub>, g) can be calculated from Eq. (<xref rid="Equ9" ref-type="disp-formula">11.9</xref>). It is assumed that the feed (X<sub>feed</sub>) contains 0.5 g protein g<sup>−1</sup> fish. It is further assumed that the feed conversion rate equals 1, i.e. 1 g of feed consumption is resulting in 1 g of body weight increase (Fig. <xref rid="Fig9" ref-type="fig">11.9</xref>):<fig id="Fig9"><label>Fig. 11.9</label><caption xml:lang="en"><p>Representation of the mass flows (Sankey chart) of feed ingredients and excretory products for a fish consuming 1000 g of feed assuming an FCR of 1</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig9_HTML.png" id="MO9"/></fig></p><p id="Par39"><disp-formula id="Equ9"><label>11.9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mtext>excreted</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mtext>feed</mml:mtext></mml:msub><mml:mo>∗</mml:mo><mml:mn>0.16</mml:mn><mml:mo>∗</mml:mo><mml:mn>0.75</mml:mn><mml:mo>∗</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>−</mml:mo><mml:mn>0.17</mml:mn></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {X}_{N,\mathrm{excreted}}={X}_{\mathrm{feed}}\ast 0.16\ast 0.75\ast \left(0.5-0.17\right) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ9.gif"/></alternatives></disp-formula></p><p id="Par40">Dissolved ammonia excreted via the gills of fish follows similar daily pattern as the gastric evacuation rate (GER). GER is described for cold water and warm water fish by He and Wurtsbaugh (<xref ref-type="bibr" rid="CR29">1993</xref>) and Richie et al. (<xref ref-type="bibr" rid="CR57">2004</xref>), respectively. The excretory pattern can be well simulated with a sine function. The ammonia excretion can be calculated from Eq. (<xref rid="Equ10" ref-type="disp-formula">11.10</xref>):</p><p id="Par41"><disp-formula id="Equ10"><label>11.10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mtext>excreted</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mtext>excreted</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.12em"/><mml:mfenced close="]" open="["><mml:mi>g</mml:mi></mml:mfenced><mml:mo>∗</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>sin</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mn>1440</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {X}_{{\mathrm{NH}}_x-N,\mathrm{excreted}}={X}_{N,\mathrm{excreted}}\;\left[g\right]\ast \left(\sin \left(\frac{2\pi }{1440}\right)+1\right) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ10.gif"/></alternatives></disp-formula></p></sec><sec id="Sec6"><title>RAS</title><p id="Par42">A variety of models describing RAS having different levels of complexity can be found in the literature. Very complex models are available for specific aspects, such as the interaction of soluble gases and alkalinity (Colt <xref ref-type="bibr" rid="CR8">2013</xref>) or the description of the microbial community (Henze et al. <xref ref-type="bibr" rid="CR30">2002</xref>). More practical models for the mass balance of RAS are published by Sánchez-Romero et al. (<xref ref-type="bibr" rid="CR59">2016</xref>), Pagand et al. (<xref ref-type="bibr" rid="CR51">2000</xref>), Wik et al. (<xref ref-type="bibr" rid="CR68">2009</xref>) and Weatherley et al. (<xref ref-type="bibr" rid="CR67">1993</xref>). All models provide information on excretory mass flows and/or nutrient flows in dependence of time and location in the process chain. Such models provide a base for the simulation of the coupling of RAS and HP. The most important dissolved matter in RAS modelling is total ammonia nitrogen (TAN). Besides TAN the chemical (COD) and biological (BOD) oxygen demand, the total suspended solids (TSS) and dissolved oxygen concentration need to be considered. However, different notations in the scientific literature make it sometimes hard to read, to convert and to implement the information into models. In the following, notations as recommended by Corominas et al. (<xref ref-type="bibr" rid="CR9">2010</xref>) will be used. TAN will be rewritten as X<sub>NHx-N</sub> and nitrate nitrogen will be expressed as X<sub>NO3-N</sub>.</p></sec><sec id="Sec7"><title>Model Example</title><sec><p id="Par43">The model as it is described in the following is only valid for the RAS presented in Fig. <xref rid="Fig8" ref-type="fig">11.8</xref>. Other possible process chains for RAS are discussed in Sect. <xref rid="Sec3" ref-type="sec">11.3</xref> of this chapter. For the mathematical depiction of physical systems, the following assumptions were made:<list list-type="order"><list-item><p id="Par44">Density of water is assumed to be constant.</p></list-item><list-item><p id="Par45">Tank and reactor are assumed to be well mixed.</p></list-item><list-item><p id="Par46">Tank and reactor volume are assumed to be constant.</p></list-item><list-item><p id="Par47">Process water flow is always greater than zero.</p></list-item></list></p></sec><sec><p id="Par48">The assumption of a well-mixed tank and reactor leads to a mass balance equation for continuous stirred-tank reactor (CSTR) as described by Drayer and Howard (<xref ref-type="bibr" rid="CR13">2014</xref>) in Eq. (<xref rid="Equ11" ref-type="disp-formula">11.11</xref>). It must be mentioned that diffusive processes can usually be neglected in RAS calculations because of a typically high process water flow rate. For a multi-tank RAS, the following holds:</p></sec><sec><p id="Par49"><disp-formula id="Equ11"><label>11.11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mtable columnalign="center" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>Accumulation</mml:mtext><mml:mo>=</mml:mo><mml:mtext>Inflow</mml:mtext><mml:mo>–</mml:mo><mml:mtext>outflow</mml:mtext><mml:mo>+</mml:mo><mml:mtext>generation</mml:mtext><mml:mo>–</mml:mo><mml:mtext>reduction</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>̇</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mtext>in</mml:mtext></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>in</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mtext>out</mml:mtext></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>out</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>gen</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>red</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{c}\mathrm{Accumulation}=\mathrm{Inflow}\hbox{--} \mathrm{outflow}+\mathrm{generation}\hbox{--} \mathrm{reduction}\\ {}{V}_i{\dot{x}}_i={Q}_{\mathrm{in}}{x}_{i,\mathrm{in}}-{Q}_{\mathrm{out}}{x}_{i,\mathrm{out}}+{x}_{i,\mathrm{gen}}-{x}_{i,\mathrm{red}}\\ {}j=\left\{\begin{array}{cc}n,&amp; i=1\\ {}i-1,&amp; i\ne 1\end{array}\right.\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ11.gif"/></alternatives></disp-formula></p></sec><sec><p id="Par50">In the above given equation <italic>n</italic> represents the number of tanks in the System, <inline-formula id="IEq2"><alternatives><mml:math display="inline" id="IEq2_Math"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>̇</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\dot{x}}_i $$
\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_IEq2.gif"/></alternatives></inline-formula> is the change of concentration of a given substrate <italic>x</italic> in a volume given by <italic>V</italic><sub><italic>i.</italic></sub>. The process water flow into the tank or reactor is represented by <italic>Q</italic><sub>in</sub>. <italic>V</italic><sub><italic>i</italic></sub> is the volume of the component where the process water flow <italic>Q</italic><sub>in</sub> is entering in. The process water flow <italic>Q</italic><sub>in</sub> came from a component having the volume <italic>V</italic><sub><italic>j</italic></sub>.</p></sec><sec><p id="Par51">The conversion of X<sub>NHx-N</sub> into X<sub>NO3-N</sub> in nitrifying biofilters takes place on the surface area A [m<sup>2</sup>] available on the bio-carriers in the nitrification reactor (Rusten <xref ref-type="bibr" rid="CR58">2006</xref>). The available bioactive surface in the nitrification is calculated by multiplying the volume of the reactor with the volume-specific active surface of the bio-carriers A<sub>S</sub> [m<sup>2</sup>· m<sup>−3</sup>]. The total bioactive surface is calculated (Eq. <xref rid="Equ12" ref-type="disp-formula">11.12</xref>) from the relative filling f<sub>bc</sub> of the nitrification reactor which usually is 0.6 (for details, see Rusten <xref ref-type="bibr" rid="CR58">2006</xref>).</p></sec><sec><p id="Par52"><disp-formula id="Equ12"><label>11.12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mi mathvariant="normal">A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mtext>nitrification</mml:mtext></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi mathvariant="normal">f</mml:mi><mml:mi>bc</mml:mi></mml:msub></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \mathrm{A}={\mathrm{V}}_{\mathrm{nitrification}}\ast {\mathrm{A}}_{\mathrm{S}}\ast {\mathrm{f}}_{\mathrm{bc}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ12.gif"/></alternatives></disp-formula></p></sec><sec><p id="Par53">The total daily TAN microbial conversion μ<sub>max</sub> [g d<sup>−1</sup>] (nitrification) was calculated by multiplying the specific TAN conversion (nitrification) rate, NHx<sub>conversion-rate</sub> [g m<sup>−2</sup> d<sup>−1</sup>], with the total active surface area, A [m<sup>2</sup>], of the bio-carriers. Values for TAN conversion in different types of nitrifying biofilters can be found in literature. For moving bed biofilm reactors (MBBR), values are reported by Rusten (<xref ref-type="bibr" rid="CR58">2006</xref>). This rate is valid for certain process conditions, and it is assumed that the bacteria biofilm is fully developed over the whole.<disp-formula id="Equ13"><label>11.13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>mm</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">A</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msub><mml:mi>NHx</mml:mi><mml:mrow><mml:mtext>Conversion</mml:mtext><mml:mo>−</mml:mo><mml:mtext>rate</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\upmu}_{\mathrm{mm}}={\mathrm{A}}^{\ast }{\mathrm{NHx}}_{\mathrm{Conversion}-\mathrm{rate}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ13.gif"/></alternatives></disp-formula></p></sec><sec><p id="Par54">The total mass of NH<sub>x</sub> converted into NO<sub>3</sub>-N can subsequently be calculated with a Monod kinetic (Eq. <xref rid="Equ14" ref-type="disp-formula">11.14</xref>). For this the NH<sub>x-N</sub> concentration, X<sub>NHx-N,2</sub> [g · l<sup>−1</sup>], in the volume of the nitrification reactor (MBBR) <italic>V</italic><sub>2</sub>, is needed.</p></sec><sec><p id="Par55"><disp-formula id="Equ14"><label>11.14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mn>0</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{l}\frac{d}{dt}{X}_{{\mathrm{N}\mathrm{H}}_x-\mathrm{N},2}=-{\upmu}_{\mathrm{max}}\ast \left(\frac{X_{{\mathrm{N}\mathrm{H}}_x-\mathrm{N},2}}{K_s+{X}_{{\mathrm{N}\mathrm{H}}_x-\mathrm{N},2}}\right)\ast \frac{1}{V_2}\kern1em \mathrm{with}\kern1em {\mathrm{K}}_{\mathrm{s}}=\frac{\upmu_{\mathrm{max}}}{2}\\ {}\frac{d}{dt}{X}_{\mathrm{N}{0}_{\mathrm{s}}-\mathrm{N},2}=+{\upmu}_{\mathrm{max}}\ast \left(\frac{X_{{\mathrm{N}\mathrm{H}}_x-\mathrm{N},2}}{K_s+{X}_{{\mathrm{N}\mathrm{H}}_x-\mathrm{N},2}}\right)\ast \frac{1}{V_2}\kern1em \mathrm{with}\kern1em {\mathrm{K}}_{\mathrm{s}}=\frac{\upmu_{\mathrm{max}}}{2}\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ14.gif"/></alternatives></disp-formula></p></sec><sec><p id="Par56">Given Eqs. (<xref rid="Equ9" ref-type="disp-formula">11.9</xref>, <xref rid="Equ10" ref-type="disp-formula">11.10</xref>, <xref rid="Equ11" ref-type="disp-formula">11.11</xref>, <xref rid="Equ12" ref-type="disp-formula">11.12</xref>, <xref rid="Equ13" ref-type="disp-formula">11.13</xref> and <xref rid="Equ14" ref-type="disp-formula">11.14</xref>), the following state-space model (combining fish-nitrification) results<disp-formula id="Equ15"><label>11.15</label><alternatives><mml:math id="Equ15_Math"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mspace width="8em"/><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dx</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NO</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NO</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mspace width="1em"/><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mtext>excreted</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:msub><mml:mi mathvariant="bold-italic">Q</mml:mi><mml:mi mathvariant="bold">Exc</mml:mi></mml:msub><mml:mo>∗</mml:mo></mml:msup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>NH</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mtext>hydroponics</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mspace width="1em"/><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo mathvariant="bold-italic">=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="bold">max</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="bold-italic">max</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>∗</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mi>Exc</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mi>Exc</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo>×</mml:mo><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{l}\kern8em \frac{dx(t)}{dt}={\boldsymbol{A}}^{\ast}\boldsymbol{X}+{\boldsymbol{B}}^{\ast}\boldsymbol{u}+\boldsymbol{n}\\ {}\boldsymbol{X}=\left[\begin{array}{l}{X}_{{\mathrm{NH}}_x-\mathrm{N},1}\\ {}{X}_{{\mathrm{NH}}_x-\mathrm{N},2}\\ {}{X}_{{\mathrm{NO}}_3-\mathrm{N},1}\\ {}{X}_{{\mathrm{NO}}_3-\mathrm{N},2}\end{array}\right]\kern1em \boldsymbol{u}=\left[\begin{array}{c}{X}_{{\mathrm{NH}}_x-\mathrm{N},\mathrm{excreted}}\\ {}\mathbf{0}\\ {}{{\boldsymbol{Q}}_{\mathbf{Exc}}}^{\ast }{X}_{{\mathrm{NH}}_x-\mathrm{N},\mathrm{hydroponics}}\\ {}\mathbf{0}\end{array}\right]\kern1em \boldsymbol{n}=\left[\begin{array}{c}\mathbf{0}\\ {}-\frac{\upmu_{\mathbf{max}}\ast {\left[\boldsymbol{X}\right]}_2}{{\boldsymbol{K}}_{\boldsymbol{s}}+{\left[\boldsymbol{X}\right]}_2}\ast \frac{1}{{\boldsymbol{V}}_2}\\ {}\mathbf{0}\\ {}+\frac{\upmu_{\boldsymbol{max}}\ast {\left[\boldsymbol{X}\right]}_2}{{\boldsymbol{K}}_{\boldsymbol{s}}+{\left[\boldsymbol{X}\right]}_2}\ast \frac{1}{{\boldsymbol{V}}_2}\end{array}\right]\\ {}A=\left[\begin{array}{cccc}-\frac{Q}{V_1}-\frac{Q_{\mathrm{Exc}}}{V_1}&amp; \frac{Q}{V_1}&amp; 0&amp; 0\\ {}\frac{Q}{V_2}&amp; -\frac{Q}{V_2}&amp; 0&amp; 0\\ {}0&amp; 0&amp; -\frac{Q}{V_1}-\frac{Q_{\mathrm{Exc}}}{V_1}&amp; \frac{Q}{V_1}\\ {}0&amp; 0&amp; \frac{Q}{V_2}&amp; -\frac{Q}{V_1}\end{array}\right]\\ {}\times B=\left[\begin{array}{cccc}\frac{1}{V_1}&amp; 0&amp; 0&amp; 0\\ {}0&amp; \frac{1}{V_2}&amp; 0&amp; 0\\ {}0&amp; 0&amp; \frac{1}{V_1}&amp; 0\\ {}0&amp; 0&amp; 0&amp; \frac{1}{V_2}\end{array}\right]\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ15.gif"/></alternatives></disp-formula></p></sec><sec id="FPar2"><title>Example</title><p id="Par57">In this example, a theoretical RAS with V_reactor = 1300 l and V_tank = 6000 l is simulated.</p><p id="Par58">All simulations had a daily feed input of 2000 g/day with 500 g protein/kg feed (Eq. <xref rid="Equ8" ref-type="disp-formula">11.8</xref>). The daily TAN excretion was assumed to be a sine curve (Eq. <xref rid="Equ9" ref-type="disp-formula">11.9</xref>). Active surface of the bio-carriers A<sub>S</sub> is 300 [m<sup>2</sup> m<sup>−3</sup>], and the relative filling of the reactor f<sub>bc</sub> is 0.6. Specific TAN conversion rate, NHx<sub>conversion-rate</sub>, is 1.2 [g m<sup>−2 −</sup>d], and the biofilm is supposed to be fully developed (Eqs. <xref rid="Equ11" ref-type="disp-formula">11.11</xref> and <xref rid="Equ12" ref-type="disp-formula">11.12</xref>). The state-space representation (Eq. <xref rid="Equ14" ref-type="disp-formula">11.14</xref>) was implemented in MATLAB Simulink. The Example showcases the importance of mass flow for nutrient concentrations in coupled systems (Fig. <xref rid="Fig10" ref-type="fig">11.10</xref> and <xref rid="Fig11" ref-type="fig">11.11</xref>).<fig id="Fig10"><label>Fig. 11.10</label><caption xml:lang="en"><p>Simulation of TAN (X<sub>NHx-N,1</sub>) in [mg/l] over 2 days = 2880 min with Q = 300 l/min (blue) and Q = 200 l/min (orange)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig10_HTML.png" id="MO10"/></fig></p></sec></sec></sec><sec id="Sec8"><title>Modelling Anaerobic Digestion</title><p id="Par59">Anaerobic digestion (AD) of organic material is a process that involves the sequential steps of hydrolysis, acidogenesis, acetogenesis and methanogenesis (Batstone et al. <xref ref-type="bibr" rid="CR3">2002</xref>). The anaerobic digestion of a mixture of proteins, carbohydrates and lipids is visualized in Figure <xref rid="Fig11" ref-type="fig">11.11</xref>. Most often, hydrolysis is considered as the rate-limiting step in the anaerobic digestion of complex organic matter (Pavlostathis and Giraldo-Gomez <xref ref-type="bibr" rid="CR52">1991</xref>). Thus, increasing the hydrolysis reaction rate will most likely lead to a higher anaerobic digestion reaction rate. However, increasing the reaction rates needs further understanding of the related process. Further understanding can be obtained via experimentation and/or mathematical modelling. As there are many factors influencing, for instance, the hydrolysis process, such as ammonia concentration; temperature; substrate composition; particle size; pH; intermediates; degree of hydrolysis; i.e. the potential of hydrolysable content; and residence time, it is almost impossible to evaluate the total effect of the factors on the hydrolysis reaction rate through experimentation. Mathematical modelling could therefore be an alternative, but as a result of all the uncertainties in model formulation, rate coefficients and initial conditions, no unique answers can be expected. But, a mathematical modelling framework would allow sensitivity and uncertainty analyses to facilitate the modelling process. As mentioned before, hydrolysis is just one of the steps in anaerobic digestion. Consequently, understanding and optimization of the full anaerobic digestion process needs connections from hydrolysis to the other processes taking place during anaerobic digestion and interactions between all these steps.<fig id="Fig11"><label>Fig. 11.11</label><caption xml:lang="en"><p>Simulation of nitrate-N (X<sub>NO3-N,1</sub>) in [mg/l] over 50 days = 72,000 min with Q<sub>Exc</sub> = 300 l/day (yellow), Q<sub>Exc</sub> = 480 l/day (orange) and Q<sub>Exc</sub> = 600 l/day (blue)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig11_HTML.png" id="MO11"/></fig></p><p id="Par60">The well-known and widely used ADM1 (anaerobic digestion model #1) is a structured model including disintegration and hydrolysis, acidogenesis, acetogenesis and methanogenesis steps. Disintegration and hydrolysis are two extracellular steps. In the disintegration step, composite particulate substrates are converted into inert material, particulate carbohydrates, protein and lipids. Subsequently, the enzymatic hydrolysis step decomposes particulate carbohydrates, protein and lipids to monosaccharides, amino acids and long-chain fatty acids (LCFA), respectively (Batstone et al. <xref ref-type="bibr" rid="CR3">2002</xref>) (see Fig. <xref rid="Fig12" ref-type="fig">11.12</xref>).<fig id="Fig12"><label>Fig. 11.12</label><caption xml:lang="en"><p>A simplified scheme for the anaerobic digestion of complex particulate organic matter. (based on El-Mashad 2003)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig12_HTML.png" id="MO12"/></fig></p><p id="Par61">ADM1 is a mathematical model that describes the biological processes and physicochemical processes of anaerobic digestion as a set of differential and algebraic equations (DAE). The model contains 26 dynamic state variables in terms of concentrations, 19 biochemical kinetic processes, 3 gas-liquid transfer kinetic processes and 8 implicit algebraic variables for each process unit. As an alternative, Galí et al. (<xref ref-type="bibr" rid="CR20">2009</xref>) described the anaerobic process a<italic>s</italic> a set of differential equations with 32 dynamic state variables in terms of concentrations and an additional 6 acid-base kinetic processes per process unit. For an overview of the modelling of anaerobic digestion processes, we refer to Ficara et al. (<xref ref-type="bibr" rid="CR17">2012</xref>). However, in what follows and for some first insights into the AD process, we will present a simple nutrient-balance model of AD in a sequencing batch reactor (SBR).</p><sec id="Sec9"><title>Nutrient Mineralization</title><p id="Par62">The nutrient mineralization can be calculated using the following equation (Delaide et al. <xref ref-type="bibr" rid="CR12">2018</xref>):</p><p id="Par63"><disp-formula id="Equ16"><label>11.15a</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mi>NR</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>DN</mml:mi><mml:mtext>out</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>DN</mml:mi><mml:mtext>in</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>TN</mml:mi><mml:mtext>in</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>DN</mml:mi><mml:mtext>in</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \mathrm{NR}=100\%\times \left(\frac{{\mathrm{DN}}_{\mathrm{out}}-{\mathrm{DN}}_{\mathrm{in}}}{{\mathrm{TN}}_{\mathrm{in}}-{\mathrm{DN}}_{\mathrm{in}}}\right) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ16.gif"/></alternatives></disp-formula>where NR is the nutrient recovery at the end of the experiment in percent, DN<sub>out</sub> is the total mass of dissolved nutrient in the outflow, DN<sub>in</sub> is the total mass of dissolved nutrient in the inflow and TN<sub>in</sub> is the total mass of dissolved plus undissolved nutrients in the inflow (see also Fig. <xref rid="Fig13" ref-type="fig">11.13</xref>).<fig id="Fig13"><label>Fig. 11.13</label><caption xml:lang="en"><p>Overall reactor scheme for determining the mineralization potential, where DN are the dissolved nutrients in the water, UN the undissolved nutrients in the sludge (i.e. TN-DN) and TN the total nutrients</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig13_HTML.png" id="MO13"/></fig></p></sec><sec id="Sec10"><title>Organic Reduction</title><p id="Par64">The organic reduction performance of the reactor can be calculated using the following equation:</p><p id="Par65"><disp-formula id="Equ17"><label>11.15b</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>OM</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>OM</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>OM</mml:mi><mml:mspace width="0.5em"/><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>OM</mml:mi><mml:mspace width="0.5em"/><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mfrac></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\eta}_{\mathrm{OM}}=1-\frac{\varDelta \mathrm{OM}+{T}_{\mathrm{OM}\kern0.5em \mathrm{out}}}{T_{\mathrm{OM}\kern0.5em \mathrm{in}}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ17.gif"/></alternatives></disp-formula>where ΔOM is the organic matter (i.e. COD, TS, TSS, etc.) inside the reactor at the end of the experiment minus the one at the beginning of the experiment, T<sub>OM out</sub> is the total OM outflow and T<sub>OM in</sub> is the total OM inflow (see also Fig. <xref rid="Fig14" ref-type="fig">11.14</xref>).<fig id="Fig14"><label>Fig. 11.14</label><caption xml:lang="en"><p>Overall reactor scheme for determining the organic material reduction potential, where T<sub>OM</sub> is the total organic matter and <italic>Δ</italic>OM the change of organic matter inside the reactor</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig14_HTML.png" id="MO14"/></fig></p></sec></sec><sec id="Sec11"><title>HP Greenhouse Modelling</title><p id="Par66">The crop water use and nutrient uptake is a central subsystem of aquaponics. The HP part is complex, as pure uptake of water and dissolved nutrients do not simply follow a rather simple linear relationship as, e.g. fish growth. To create a full-functional model, a complete greenhouse simulator is needed. This involves sub-model systems of greenhouse physics including climate controllers and crop biology covering interactive processes with biological and physical stressors.</p><p id="Par67">However, from the HP point of view, greenhouse climate is the main driver for the complete aquaponic system, including, next to the nutrient balances, feedback loops of heat produced by the fish and additional CO<sub>2</sub> supplied to the plants as reported by Körner et al. (<xref ref-type="bibr" rid="CR41">2017</xref>) (Fig. <xref rid="Fig15" ref-type="fig">11.15</xref>).<fig id="Fig15"><label>Fig. 11.15</label><caption xml:lang="en"><p>Additional symbiotic behaviour of an aquaponic system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig15_HTML.png" id="MO15"/></fig></p><p id="Par68">In this model, the fish culture produces heat through metabolic processes. The amount of heat produced by the fish is directly calculated from oxygen consumption that is a function of temperature and a constant for heat production for one unit oxygen consumed (i.e. 13608 J g<sup>−1</sup> fish). Heat from breakdown of organic matter (Q<sub>bio</sub>), e.g. faeces and feed remain, is also contributing to the heat balance. Energy supply to the water system can then be calculated by heat production through the fish calculated from an average oxygen consumption rate (f<sub>O2,Twb</sub>). Additional heat production can then be calculated by biological breakdown of faeces (Fig. <xref rid="Fig16" ref-type="fig">11.16</xref>).<fig id="Fig16"><label>Fig. 11.16</label><caption xml:lang="en"><p>Aquaculture system implemented in the greenhouse with humidity, temperature and CO2 concentrations of the air (RH<sub>air</sub> T<sub>air</sub>, CO<sub>2,air</sub>), heat from (Q) fish environment (fish), biological breakdown (bio) and heat fluxes (ɸ), taken from Körner et al. (<xref ref-type="bibr" rid="CR41">2017</xref>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig16_HTML.png" id="MO16"/></fig></p><p id="Par69">CO<sub>2</sub> production from the aquatic subsystem (<inline-formula id="IEq3"><alternatives><mml:math display="inline" id="IEq3_Math"><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="italic">CO</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {d}_{CO_2} $$
\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_IEq3.gif"/></alternatives></inline-formula>, g h<sup>−1</sup> ), i.e. delivery to the aerial environment (d, g h<sup>−1</sup>), can be calculated for the given water temperature (T<sub>H2O</sub>, K) from oxygen delivery to the system ( <inline-formula id="IEq4"><alternatives><mml:math display="inline" id="IEq4_Math"><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {d}_{O_2}, $$
\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_IEq4.gif"/></alternatives></inline-formula> g h<sup>−1</sup>) at water base temperature (T<sub>H2O,b</sub>, K) and the Q<sub>10</sub> value of fish respiration (Q<sub>10,R</sub>). The following relationships are used:</p><p id="Par70"><disp-formula id="Equ18"><label>11.16</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mtable columnalign="center" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">f</mml:mi><mml:mtext>fish</mml:mtext></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">f</mml:mi><mml:msub><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:msub><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="italic">CO</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>CO</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mfenced close="]" open="["><mml:msub><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mspace width="0.25em"/><mml:msup><mml:msub><mml:mi mathvariant="normal">Q</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">T</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">O</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">T</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">O</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{c}{d}_{O_2}={\mathrm{f}}_{\mathrm{f}\mathrm{ish}}\ {\mathrm{f}}_{{\mathrm{O}}_2}\ {\mathrm{w}}_{{\mathrm{O}}_2}\\ {}{d}_{CO_2}=\frac{\left[{\mathrm{CO}}_2\right]}{\left[{\mathrm{O}}_2\right]}{d}_{O_2}\ {{\mathrm{Q}}_{10,\mathrm{R}}}^{\left({\mathrm{T}}_{\mathrm{H}2\mathrm{O}}-{\mathrm{T}}_{\mathrm{H}2\mathrm{O},\mathrm{b}}\right)/10}\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ18.gif"/></alternatives></disp-formula>with feed amount for the fish (f<sub>fish</sub>, g h<sup>−1</sup>), oxygen consumption rate at base temperature (f<sub>O2</sub>, kg [O<sub>2</sub>] kg<sup>−1</sup> [feed]), fraction of feed loss w<sub>O2</sub> (<sup>−</sup>) and mass balance of O<sub>2</sub>/CO<sub>2</sub> (<sup>−</sup>).</p><p id="Par71">To calculate the basis of aquaponics, i.e. the process flow (indicated with arrows, →) greenhouse macroclimate → microclimate → evapotranspiration → nutrients uptake, various greenhouse simulators that were developed in the past can be used and combined with aquaculture to an aquaponic system. All greenhouse models include a crop growth model. The model quality, however, can vary a lot from simple empirical regression models, e.g. Boote and Jones (<xref ref-type="bibr" rid="CR4">1987</xref>), via deterministic models, e.g. Heuvelink (<xref ref-type="bibr" rid="CR31">1996</xref>), to functional structural plant models (FSPM), e.g. Buck-Sorlin et al. (<xref ref-type="bibr" rid="CR6">2011</xref>). As current crop growth and development models are inaccurate and have limited predictive power (Poorter et al. <xref ref-type="bibr" rid="CR53">2013</xref>), models are occasionally employed in crop management, but then mainly for planning issues in greenhouse simulators, e.g. Vanthoor (<xref ref-type="bibr" rid="CR65">2011</xref>) and Körner and Hansen (<xref ref-type="bibr" rid="CR37">2011</xref>). Prediction accuracy is jeopardized by many sources of uncertainty, such as modelling errors, variability between plants, variability between greenhouses and uncertain external climate conditions. As for predictions, accuracy also varies strongly per situation. However, online feeding of sensor information into the plant model can make plant model predictions considerably more reliable and useful to the grower.</p><p id="Par72">Greenhouse simulators were developed in and for several places, e.g. the Virtual Grower (Frantz et al. <xref ref-type="bibr" rid="CR19">2010</xref>), KASPRO (De Zwart <xref ref-type="bibr" rid="CR11">1996</xref>), Greenergy Energy Audit Tool (Körner et al. <xref ref-type="bibr" rid="CR40">2008</xref>), The Virtual Greenhouse (Körner and Hansen <xref ref-type="bibr" rid="CR37">2011</xref>), The Adaptive Greenhouse (Vanthoor <xref ref-type="bibr" rid="CR65">2011</xref>), Hortex (Rath <xref ref-type="bibr" rid="CR54">1992</xref>, <xref ref-type="bibr" rid="CR55">2011</xref>) and the integrated aquaponic greenhouse model (Goddek and Körner <xref ref-type="bibr" rid="CR23">2019</xref>). At a research level, some models (i.e. simulation models in combination with certain greenhouse technologies) have been developed that potentially can be used to optimize investments and structural modifications to the production unit and production process. However, most systems entail closed software environments that can only be used by the developers, and many of them only exist in a research mode and lack further development and acceptance from the industry. However, there is yet no common basis for model sharing and collaborative model development. As a result, most modellers and modelling teams work in isolation developing their own models and codes. A shortcoming of that procedure is that greenhouse simulation models are developed in parallel in disparate research environments, which fail in cooperative growth and development.</p><p id="Par73">All HP greenhouse model simulators are a compilation of sub-models that depend on the aim to integrate the interaction of plants and greenhouse equipment. The general two-part differentiation in greenhouse models and also in control and planning is the shoot and the root environment. Rather complicated and differentiated model approaches have been done for the greenhouse climate (Bot <xref ref-type="bibr" rid="CR5">1993</xref>; de Zwart <xref ref-type="bibr" rid="CR11">1996</xref>), and greenhouse crop growth has been intensively modelled in the 1990s for the main greenhouse crops such as tomatoes (Heuvelink <xref ref-type="bibr" rid="CR31">1996</xref>), cucumber (Marcelis <xref ref-type="bibr" rid="CR48">1994</xref>) and lettuce (Liebig and Alscher <xref ref-type="bibr" rid="CR43">1993</xref>). However, in order to calculate the water and nutrient uptake of crops, the microclimate, i.e. the climate close to and on the plant organs, needs to be known (Challa and Bakker <xref ref-type="bibr" rid="CR7">1999</xref>). This is an ongoing issue in greenhouse modelling, as microclimate variables, such as the central leaf temperature, are highly variable and dependent on many parameters and variables. One version of a leaf temperature model used in a crop canopy for crop temperature (T<sub>c</sub>) integrated over vertical layers (z) by Körner et al. (<xref ref-type="bibr" rid="CR39">2007</xref>) integrating absorbed irradiative net fluxes (R<sub>n,a</sub>, Wm<sup>−2</sup>), boundary layer and stomata resistances (r<sub>b</sub> and r<sub>s</sub>, respectively, sm<sup>−1</sup>) and vapour pressure deficit at the leaf surface (VPD<sub>s</sub>, Pa) in the canopy is shown here, i.e.</p><p id="Par74"><disp-formula id="Equ19"><label>11.17</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:msub><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">γ</mml:mi></mml:mfrac><mml:msub><mml:mi>VPD</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">γ</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:msub><mml:mi>σT</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\mathrm{T}}_{\mathrm{c}}\left(\mathrm{z}\right)-{\mathrm{T}}_{\mathrm{a}}=\frac{\frac{1}{\uprho_{\mathrm{a}}{\mathrm{c}}_{\mathrm{p}}}\left({\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)+{\mathrm{r}}_{\mathrm{s}}\left(\mathrm{z}\right)\right){\mathrm{R}}_{\mathrm{n},\mathrm{a}}\left(\mathrm{z}\right)-\frac{1}{\upgamma}{\mathrm{VPD}}_{\mathrm{s}}\left(\mathrm{z}\right)}{1+\frac{\updelta}{\upgamma}+\frac{{\mathrm{r}}_{\mathrm{s}}\left(\mathrm{z}\right)}{{\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)}+\frac{1}{\uprho_{\mathrm{a}}{\mathrm{c}}_{\mathrm{p}}/4{{\upsigma \mathrm{T}}_a}^3}\left({\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)+{\mathrm{r}}_{\mathrm{s}}\left(\mathrm{z}\right)\right)} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ19.gif"/></alternatives></disp-formula>with greenhouse air temperature (T<sub>a</sub>, K), vapour pressure air density (ρ<sub>a</sub>, g m<sup>−2</sup>), Stefan-Boltzmann constant (σ, Wm<sup>−2</sup> K<sup>−4</sup>), specific heat capacity of the air (c<sub>p</sub>, J g<sup>−1</sup> K<sup>−1</sup>), the psychrometric constant (γ, Pa K<sup>−1</sup>) and the slope between saturated vapour pressure and greenhouse air temperature (δ, Pa K<sup>−1</sup>).</p><p id="Par75">Leaf temperature is the central part of the microclimate model, it has feedback loops to several input variables and especially stomata resistance (often also used as its reciprocal, the conductance), and the calculation needs several simulation steps for equilibrium. For HP, as part of the aquaponic system, however, modelling water and nutrient fluxes is most important. All water and nutrient balances in a closed multi-loop system are controlled based on the evapotranspiration rate of the crop ET<sub>c</sub> (Chap. <ext-link xlink:href="10.1007/978-3-030-15943-6_8" ext-link-type="doi">8</ext-link>). Commonly ET<sub>c</sub> is calculated as latent heat of evaporation, i.e. in energy terms (λE, Wm<sup>−2</sup>), and can be in accordance to leaf temperature expressed in different canopy layers z<disp-formula id="Equ20"><label>11.18</label><alternatives><mml:math id="Equ20_Math"><mml:mi>λE</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">γ</mml:mi></mml:mfrac><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">γ</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:msub><mml:mi>σT</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mi>VPD</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">γ</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:msub><mml:mi>σT</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">z</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \uplambda \mathrm{E}\left(\mathrm{z}\right)=\left(\frac{\frac{\updelta}{\upgamma}{\mathrm{R}}_{\mathrm{n},\mathrm{a}}\left(\mathrm{z}\right)+\frac{\uprho_{\mathrm{a}}{\mathrm{c}}_{\mathrm{p}}}{\upgamma}\left(\frac{1}{{\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)}+\frac{1}{\uprho_{\mathrm{a}}{\mathrm{c}}_{\mathrm{p}}/4{{\upsigma \mathrm{T}}_{\mathrm{a}}}^3}\right){\mathrm{VPD}}_{\mathrm{s}}\left(\mathrm{z}\right)}{1+\frac{\updelta}{\upgamma}+\frac{{\mathrm{r}}_{\mathrm{s}}\left(\mathrm{z}\right)}{{\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)}+\frac{1}{\uprho_{\mathrm{a}}{\mathrm{c}}_{\mathrm{p}}/4{{\upsigma \mathrm{T}}_{\mathrm{a}}}^3}\left({\mathrm{r}}_{\mathrm{s}}\left(\mathrm{z}\right)+{\mathrm{r}}_{\mathrm{b}}\left(\mathrm{z}\right)\right)}\right) $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equ20.gif"/></alternatives></disp-formula></p><p id="Par76">To calculate ET<sub>c</sub> (L m<sup>-2</sup>), λE needs to be multiplied with the constant L<sub>w</sub> (heat of vaporization of water; 2454·103 J kg<sup>−1</sup>) and the specific weight of water (9.789 kN·m<sup>3</sup> at 20 °C).</p><p id="Par77">Equation (<xref rid="Equ20" ref-type="disp-formula">11.18</xref>), however, only calculates the water flux through the crop, while the easiest way to estimate nutrient uptake is the assumption that nutrients are taken up/absorbed as dissolved in irrigation water and assuming that no element specific chemical, biological or physical resistances exist. In reality uptake of nutrients is a highly complicated matter. Consequently, to maintain equilibrium, all nutrients taken up by the crop as contained in the nutrient solution need to be added back to the hydroponics system (see Chap. <ext-link xlink:href="10.1007/978-3-030-15943-6_8" ext-link-type="doi">8</ext-link>). However, Eq. (<xref rid="Equ20" ref-type="disp-formula">11.18</xref>) only calculates the potential ETc, while too high potential levels can result in a higher transpiration than plants can handle, and then potential water loss may exceed water uptake. For that, the simple assumption of nutrient uptake is not satisfying. As described in Chap. <ext-link xlink:href="10.1007/978-3-030-15943-6_10" ext-link-type="doi">10</ext-link>, the different nutrients can have different states and change states with, e.g. pH, while the plant availability strongly depends on pH and the relation of nutrients to each other. In addition, the microbiome in the root zone plays an important role, which is not implemented in models yet. Some models, however, differentiate between phloem and xylem pathways. The vast amount of nutrients, however, is not modelled in detail for aquaponics nutrient balancing and sizing of systems, while the easiest way to estimate nutrient uptake is the assumption that nutrients are taken up/absorbed as dissolved in irrigation water and apply the above explained ETc calculation approach.</p><p id="Par78">For control purposes the greenhouse is typically considered as a black box, where outside climate conditions determine the disturbance inputs, CO<sub>2</sub> supply, heating and ventilation are the control inputs, and the greenhouse macro- and microclimate define the output of the system (Fig. <xref rid="Fig17" ref-type="fig">11.17</xref>).<fig id="Fig17"><label>Fig. 11.17</label><caption xml:lang="en"><p>Input-output system of a greenhouse</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig17_HTML.png" id="MO17"/></fig></p><p id="Par79">To control the greenhouse, the actions are directed to minimize the fast impacts of the disturbances, i.e. being ahead of expected changes by smart control. For that, control actions such as feedback and feedforward are used (Chap. <ext-link xlink:href="10.1007/978-3-030-15943-6_8" ext-link-type="doi">8</ext-link>). The best control, however, can be achieved when using a complete greenhouse model and combine it with weather forecast (Körner and Van Straten, <xref ref-type="bibr" rid="CR38">2008</xref>) attaining a model-based optimal greenhouse climate control, as worked out by Van Ooteghem (<xref ref-type="bibr" rid="CR64">2007</xref>).</p></sec><sec id="Sec12"><title>Multi-loop Aquaponic Modelling</title><p id="Par80">Traditional aquaponic designs comprise of aquaculture and hydroponic units involving recirculating water between both subsystems (Körner et al. <xref ref-type="bibr" rid="CR41">2017</xref>; Graber and Junge <xref ref-type="bibr" rid="CR26">2009</xref>). In such one-loop aquaponic systems, it is necessary to make trade-offs between the conditions of both subsystems in terms of pH, temperature and nutrient concentrations, as fish and plants share one ecosystem (Goddek et al. <xref ref-type="bibr" rid="CR24">2015</xref>). By contrast, decoupled double-loop aquaponic systems separate the RAS and hydroponic units from one another, creating detached ecosystems with inherent advantages for both plants and fish. Recently, there has been an increased interest in closing the loop in terms of nutrients as well as increasing the input-output efficiency. For that reason, remineralization (Goddek <xref ref-type="bibr" rid="CR21">2017</xref>; Emerenciano et al. <xref ref-type="bibr" rid="CR14">2017</xref>; Goddek et al. <xref ref-type="bibr" rid="CR500">2018</xref>; Yogev et al. <xref ref-type="bibr" rid="CR71">2016</xref>) and desalination loops (Goddek and Keesman <xref ref-type="bibr" rid="CR22">2018</xref>) have been incorporated into the overall system design. Such systems are called decoupled multi-loop aquaponic system (Goddek et al. <xref ref-type="bibr" rid="CR25">2016</xref>).</p><p id="Par81">Sizing the respective subsystems is fundamental of having a functioning check-and-balance system. For sizing one-loop systems, a simple rule of thumb is generally used, determining the hydroponic cultivation area based on the daily feed input to the RAS (Knaus and Palm <xref ref-type="bibr" rid="CR36">2017</xref>; Licamele <xref ref-type="bibr" rid="CR42">2009</xref>). The higher degree of complexity of multi-loop systems does not allow this approach anymore, as it comes with inherent risks for making false assumptions for each subsystem. There is a growing body of literature that examines mass balances for aquaponic systems (Körner et al. <xref ref-type="bibr" rid="CR41">2017</xref>; Goddek et al. <xref ref-type="bibr" rid="CR25">2016</xref>; Reyes Lastiri et al. <xref ref-type="bibr" rid="CR56">2016</xref>; Karimanzira et al. <xref ref-type="bibr" rid="CR34">2016</xref>). While some research has been carried out in developing numerical models for one- and multi-loop aquaponic systems, no single study exists that integrates a multi-loop aquaponic model with a complemented full-scale deterministic greenhouse model. This is particularly relevant for sizing the system, since plant growth and nutrient uptake are location dependent with crop transpiration as major driver. In concrete terms, this means that the climate within a greenhouse – which is highly dependent on the external weather conditions – has a high impact on plant growth given environmental factors such as relative humidity (RH), light irradiation, temperature, carbon dioxide (CO<sub>2</sub>) levels, etc. that were incorporated in greenhouse microclimate modelling (Körner et al. <xref ref-type="bibr" rid="CR39">2007</xref>; Janka et al. <xref ref-type="bibr" rid="CR33">2018</xref>).</p></sec><sec id="Sec13"><title>Modelling Tools</title><p id="Par82">In aquaponics, flow charts or stock and flow diagrams (SFD) and causal loop diagrams (CLDs) are commonly used to illustrate the functionality of the aquaponic system. In the following, flow chart and CLDs will be described.</p><sec id="Sec14"><title>Flow Charts</title><p id="Par83">To get a systemic understanding of the aquaponics, flow charts with the most important components of the aquaponics are a good tool to show how material flows in the system. This can help, for example, in finding missing components and unbalanced flows and mainly influencing determinants of the subprocesses. Figure <xref rid="Fig18" ref-type="fig">11.18</xref> shows a simple flow chart in aquaponics. In the flow chart, fish food and water are added to the fish tank, where the feed is taken by the fish for growth, the water is enriched with the fish waste and the nutrient-enriched water is added to the hydroponics system to produce plant biomass. From the flow chart, a CLD shown in Fig. <xref rid="Fig19" ref-type="fig">11.19</xref> can be easily constructed.<fig id="Fig18"><label>Fig. 11.18</label><caption xml:lang="en"><p>Example of a flow chart in aquaponics (only RAS and HP exchange)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig18_HTML.png" id="MO18"/></fig><fig id="Fig19"><label>Fig. 11.19</label><caption xml:lang="en"><p>Causal loop diagram (CLD) illustrating examples of a reinforcing and a balanced loop within aquaponic systems. The reinforcing loop (R) is one in which an action produces a result which influences more of the same action and consequently resulting in growth or decline, where as a balancing loop (B) attempts to bring things to a desired state and keep them there (e.g. temperature regulation in the house)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig19_HTML.png" id="MO19"/></fig></p></sec><sec id="Sec15"><title>Causal Loop Diagrams</title><p id="Par84">Causal loop diagrams (CLDs) are a tool to show the feedback structure of a system (Sterman <xref ref-type="bibr" rid="CR62">2000</xref>). These diagrams can create a foundation for understanding complex systems by visualizing the interconnection of different variables within a system. When drawing a CLD, variables are pictured as nodes. These nodes are connected by edges, which form a connection between two variables accordingly. Figure <xref rid="Fig19" ref-type="fig">11.19</xref> shows that such edges can be marked as either positive or negative. This depends on the relation of the variables to one another. When both variables change into the same direction, then one can speak of a positive causal link. A negative causal link thus causes a change in opposite directions. When connecting two nodes from both sides, one creates a closed cycle that can have two characteristics: (1) a <italic>reinforcing loop</italic> that describes a causal relationship, creating exponential growth or collapse within the loop or (2) a <italic>balancing loop</italic> in which the causal influences keep the system in an equilibrium. Figure <xref rid="Fig19" ref-type="fig">11.19</xref> shows an example of both types of loops.</p><p id="Par85">Let us illustrate this (Fig. <xref rid="Fig20" ref-type="fig">11.20</xref>) for the flow chart of Fig. <xref rid="Fig18" ref-type="fig">11.18</xref>.<fig id="Fig20"><label>Fig. 11.20</label><caption xml:lang="en"><p>Example CLD for RAS and HP exchange</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig20_HTML.png" id="MO20"/></fig></p><p id="Par86">It is obvious that CLD and SFD are very useful for system understanding, when the model does not require numerical accuracy. If numerical accuracy is required, the process should be studied further with a system dynamic tool diagram (SDTD) and modelled in dynamic system simulation software. For example, the CLD in Fig. <xref rid="Fig20" ref-type="fig">11.20</xref> can be augmented with differential equations to a SDTD (Fig. <xref rid="Fig21" ref-type="fig">11.21</xref>).<fig id="Fig21"><label>Fig. 11.21</label><caption xml:lang="en"><p>Example SDTD for RAS and HP exchange</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/459867_1_En_11_Fig21_HTML.png" id="MO21"/></fig></p><p id="Par87">From the SDTD, we can now see how the differential equations for the nutrients balance in the tank look like. We know that the nutrient flow out of the fish tank (<italic>M</italic><sub>xfout</sub>) must be the water flow (<italic>Q</italic><sub>fout</sub>) times the concentration in the out stream (<italic>C</italic><sub>xf</sub>):<disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:msub><mml:mi>M</mml:mi><mml:mtext mathvariant="italic">xfout</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="italic">xf</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi>Q</mml:mi><mml:mtext mathvariant="italic">fout</mml:mtext></mml:msub></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {M}_{xf out}=={C}_{xf}\ {Q}_{fout} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equa.gif"/></alternatives></disp-formula></p><p id="Par88">Assuming a stirred tank gives the nutrient concentration of the fink tank to:<disp-formula id="Equb"><alternatives><mml:math display="block" id="Equb_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>xf</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>xf</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {C}_{\mathrm{xf}}={M}_{\mathrm{xf}}/{V}_f $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equb.gif"/></alternatives></disp-formula></p><p id="Par89">The differential equations of the RAS part can be derived to:<disp-formula id="Equc"><alternatives><mml:math display="block" id="Equc_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mi mathvariant="italic">dV</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi mathvariant="italic">dt</mml:mi><mml:mo>=</mml:mo><mml:malignmark/><mml:msub><mml:mi>Q</mml:mi><mml:mi>fin</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mtext>fout</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mi mathvariant="italic">dM</mml:mi><mml:mi>xf</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi mathvariant="italic">dt</mml:mi><mml:mo>=</mml:mo><mml:malignmark/><mml:msub><mml:mi>M</mml:mi><mml:mtext>xfin</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>xfout</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equc_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ {\displaystyle \begin{array}{c}{dV}_f/ dt={Q}_{\mathrm{fin}}-{Q}_{\mathrm{fout}}\\ {}{dM}_{\mathrm{xf}}/ dt={M}_{\mathrm{xf}\mathrm{in}}-{M}_{\mathrm{xf}\mathrm{out}},\end{array}} $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equc.gif"/></alternatives></disp-formula>and for the concentration<disp-formula id="Equd"><alternatives><mml:math display="block" id="Equd_Math"><mml:mi mathvariant="italic">dc</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="italic">dt</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>fin</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mtext>xfin</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>fou</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>xf</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="Equd_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ dc/ dt=\left({Q}_{\mathrm{fin}}{C}_{\mathrm{xf}\mathrm{in}}-{Q}_{\mathrm{fou}t}{C}_{\mathrm{xf}}\right)/{V}_f $$
\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="459867_1_En_11_Chapter_Equd.gif"/></alternatives></disp-formula></p></sec><sec id="Sec16"><title>Software</title><p id="Par90">In addition to basic computer languages, such as Fortran, C++ and Python, for fast computation and fully user-specific implementation, all kinds of advanced software tools are available. These advanced software tools offer a variety of environments, concepts and options. We can model state variables, differential equations, connections and loops. In addition, we can use the model for simulations, stability analysis, optimization and control.</p><p id="Par91">The main reasons for modelling of a system are to understand and control it. Therefore, the model helps to predict the system dynamics or behaviour. The software applications could allow us to do three consequent tasks: (a) the modelling itself, (b) the simulations of the model(s) and (c) optimization of the model and/or simulation.</p><p id="Par92"><italic>Mathematica</italic> software is for functional analysis of mathematically described problems (Wolfram <xref ref-type="bibr" rid="CR70">1991</xref>). The concept is based on the LISP approach (McCarthy and Levin <xref ref-type="bibr" rid="CR49">1965</xref>.), a very effective functional programming language. The syntax is reasonably simple, and this software is popular in mathematics, physics and systems biology. Especially, the Ndsolve module helps to solve ordinary differential equations, plot the solution and find specific values.</p><p id="Par93">Very similar tools for solving ODEs are offered by the <italic>Maple</italic>. This software is very powerful; between its features belong boundary problems solution, exact solutions and mathematical approximations. <italic>Copasi</italic> (complex pathway simulator) is a software tool for simulation and analysis of biochemical networks via ordinary differential equations.</p><p id="Par94"><italic>SageMath</italic> is a free open-source mathematics software system. The software is Python-based and facilitates the simulation of ODE models. <italic>Data2Dynamics</italic> software is a collection of numerical methods for quantitative dynamic modelling and is a comprehensive model and data description language. The software allows the analysis of noise, calibration and uncertainty predictions and has libraries of biological models.</p><p id="Par95">Probably the best simulation language is Simula (probably not in use anymore) and <italic>Simula 67</italic>, considered at the beginning as a package for Algol 60. These were the first fully object-oriented languages, introducing classes, inheritance, subclasses, garbage collector and others. In the beginning of the twenty-first century, the creators Ole-Johan Dahl and Kristen Nygaard were awarded the IEEE John von Neumann Medal and the A. M. Turing Award (Dahl and Nygaard <xref ref-type="bibr" rid="CR10">1966</xref>).</p><p id="Par96">The idea behind Simula was that objects have life; they start to exist, do their being and cease. The objects are defined as general classes (template code), and each instance of such object has a ‘life’ in the simulation. The language was quite difficult to learn. However, it offered the possibility to model processes object by object and run simulation of their lives. The simulation runs on the basis of discrete events, and it is possible to simulate objects in co-routine. More tasks can start, run, detach, resume and complete in overlapping time periods in quasiparallel processes. Today’s hardware allows us modelling and simulation in fully parallel threads. However, many of the Simula concepts were already used for development of other languages, namely, Java, C/C++/C# and persistent objects libraries like DOL (Soukup and Machacek <xref ref-type="bibr" rid="CR61">2014</xref>). Current successor of Simula is <italic>BETA</italic>, extending and featuring the possibilities of inheritance in concepts of nested (sub)classes (with nested local time) and patterns (Madsen et al. <xref ref-type="bibr" rid="CR47">1993</xref>).</p><p id="Par97">It is always an option to use any of the object-oriented languages and specific libraries and program all the necessary code for a specific model. On the other hand, already existing graphical programming environments allow to design and link the structure of the modelled system from libraries of objects (signal generator, sum, integrator, etc.), parametrize them and run the simulation in virtual time.</p><p id="Par98">Another popular software for simulation is MathWorks <italic>Simulink</italic>, describing itself as a model-based design tool. The environment allows to combine and parametrize predefined blocks (from wide range of libraries) and diagrams into subsystems. The programming is done using graphical blocks and their connections into functional parts with feedback loops. The environment is widely used for control, automation and signal processing. Another possibility is to integrate own code from MathWorks <italic>Matlab</italic> language or use various toolboxes (Jablonsky et al. <xref ref-type="bibr" rid="CR32">2016</xref>). One of them, <italic>SensSB</italic>, is focused on the sensitivity analysis and allows to import other models using the Systems Biology Markup Language. For just the visualization of existing models in Simulink, it is also possible to use the very quick models viewer <italic>DiffPlug</italic>. <italic>PottersWheel</italic> supports the modelling of time-dependent dynamic systems, parameter calibration, analysis and prediction. Interesting tool is the experimental design for model verification.</p><p id="Par99">For the modelling and analysis of system dynamics, similar strategy is used by the <italic>Stella</italic> Architect isee software application, where the model is composed of blocks, which are connected by relations. Stella allows modelling and simulation of very different types of applications, ranging from medical needs through building construction to the airplanes. Stella is sometimes marketed as <italic>iThink</italic> software. <italic>Powersim</italic> software was designed originally for economic purposes. However, it developed into more sophisticated tool, including electronic, solar power or drug treatment simulations. The former developer of <italic>Powersim</italic> is currently producing a similar software for more complex tasks <italic>Dynaplan Smia</italic>. <italic>Vensim</italic> is a system for modelling big data relationships of real systems. The power of <italic>Vensim</italic> is that it allows causal tracking, sensitivity analysis, calibration and intensive simulation. However, the software is also capable of dealing with wide range of simple and complex real systems (Hassan et al. <xref ref-type="bibr" rid="CR28">2016</xref>). <italic>True-World</italic> system dynamics software facilitates complex multibody dynamic simulations in discrete and continuous time. The modelling basically starts from balances.</p><p id="Par100">Completely different approaches to modelling and simulation are cellular automata or agent-based modelling approaches, popularized by Stephen Wolfram (Wolfram <xref ref-type="bibr" rid="CR70">1991</xref>) as a new kind of science. The approach is sometimes also called the game of life. The modelling is implemented via interactions of autonomous individuals (Macal and North <xref ref-type="bibr" rid="CR46">2005</xref>). The simulations show emergent behaviour and therefore are very popular in systems biology for population dynamics. A simple tool for basic (and advanced, as well) agent-based modelling and simulation is the <italic>NetLogo</italic> software, where simple descriptions and parametrization create powerful models. The software allows visualization of the time development and noise induction (Stys et al. <xref ref-type="bibr" rid="CR63">2015</xref>). The application is written in Java, which sometimes limits the available memory. Probably the biggest effort in the multi-agent modelling was done by development of <italic>Wolfram</italic> software, which is the continuation of popular Mathematica, with extended tools for modelling and simulation. It has put Simulink-like modelling in a more attractive suit and also creates possibilities of agent-based modelling and much more tools for other mathematical disciplines (multivariate statistics, data mining, global optimization).</p><p id="Par101"><italic>AnyLogic</italic> is very interesting software for problems of flow – information, money, traffic, logistic and mining. The simulation solves the problem of optimal flow in the designed system with minimal effort and maximal efficiency. The used concepts are system dynamics and agent-based and discrete-event modelling. It also offers hybrids between different modelling concepts. The software is useful, for example, in the epidemic spread simulations (Emrich et al. <xref ref-type="bibr" rid="CR15">2007</xref>).</p><p id="Par102">Another agent-based modelling tool is <italic>Insight Maker</italic>, for simulation of population interacting in geographic or network space. The software supports graphical model construction, usage of multiple paradigms, embedded scripting and optimization toolset (Fortmann-Roe <xref ref-type="bibr" rid="CR18">2014</xref>).</p><p id="Par103">For the modelling itself, description of the state variables, solution of the ODEs, parametrization and time dependency analysis, the first group of software, from <italic>Mathematica</italic> to <italic>Matlab</italic>, could be used without hesitation. They represent powerful tools for the modelling purposes. In case of more complex analysis, such as related to big data, simulation, noise induction, optimization, sensitivity and stochastics, more advanced tools are required, with object-oriented approach, involving also higher induction in the programming languages syntax.</p></sec></sec><sec id="Sec17"><title>Discussion and Conclusions</title><p id="Par104">Aquaponics are complex technical and biological systems. For example, possible explanations for fish not growing properly can be small food rations, adverse water quality, technical problems causing stress, etc. Due to the inherently slow biology, scientific investigations of the validity of these explanations would be tedious and require several experimental trials to get all important factors and their interactions, demanding a lot of facilities, expertise, research time and financial assets. Therefore, the issue of modelling aquaponic systems was addressed in this chapter. In aquaponics, modelling is required for different objectives: (i) insight/understanding, (ii) analysis, (iii) estimation and (iv) management and control. For all these objectives, appropriate models are required. For example, to achieve objectives (ii) and (iii), an empirical approach can be utilized which uses statistical models to analyse data from previous experimental trials with the objective of extracting as much information as possible without conducting new experiments. Statistical models can reveal the most important factors affecting fish and crop production in the aquaponic systems. Future experiments could concentrate on these factors, thus making the utilization of costly research assets more effective.</p><p id="Par105">The complexity of aquaponic systems, due to their feedback character and the interactions between RAS and hydroponic system, water treatment and fish growth, implies that in order to fulfil objectives (i) and (iv), i.e. to understand or optimize a plant (configuration, size, fish, feed, flows, etc.) with respect to cost, stability, robustness and water quality, non-trivial theoretical models of most of the system components described in this chapter are required. The advantage of these theoretical models presented over statistical models is their stronger ability to analyse the process underlying the aquaponics and the possibility to model the time aspect (dynamics). Statistical models just confirm or refute a hypothesis and to what extent variables covary but give no evidence of the underlying processes. On the other hand, theoretical models allow us to simulate the processes according to a hypothesis, compare simulated with observed data, evaluate both the hypothesis and the model and make adaptions. The validity of statistical models may not be beyond the operational range they were trained for, whereas theoretical models can be defined and used for a wide range of environments, provided that the models are validated for these ranges before application. For example, the multiple regression model used to assess relationships between fish growth with <italic>Oreochromis niloticus</italic> as fish species and environmental variables in an aquaponics facility in Germany cannot be easily applied to Spain with <italic>Cyprinus carpio</italic>, whereas a theoretical model describing the underlying processes (e.g. fish behaviour, aquaculture, freshwater ecology) as mathematical equations can be adjusted relatively easily because the fish and ecological process underlying that model are basically the same for the two sites.</p><p id="Par106">Nevertheless, theoretical models also require some parameters such as reaction constants and substance settling velocity in settling tank to be determined. This is achieved commonly based on empirical study of one facility or very few facilities or in most cases from previously published studies (secondary sources). Studies based on secondary sources have limitations imposed by the given structure and amount of the available data, which is not existent when the data come from an experimental setup designed ad hoc for the study. However, estimating model parameters using experimental data from one aquaponics facility only can have problems regarding generalizability and replication of the results due to particular conditions present in the study. The data scarcity sometimes imposes strong restrictions to models that limit their practicality. The development of studies for parameter estimation with primary data that use a larger number of aquaponics facilities than earlier studies does help to overcome the present limitations and provide better and reliable results. This, however, is not an easy challenge for aquaponics researchers.</p><p id="Par107">Simulation of aquaponics with the mathematical models under a wide range of management conditions will improve the understanding of aquaponics, verify different aquaponics configurations and point the way to the most promising strategies for improving aquaponics facilities. Again, this can lead to a more efficient way of conducting experiments.</p><p id="Par108">Some modelling tools were also presented in this chapter. Traditionally, stock and flow diagrams (SFD) have been used for understanding processes as support tools for quantitative analysis. They are used to comprehend the flow and fluxes of quantities but lack the ability to illustrate the information associated to the flow and fluxes. Causal loop diagram (CLD) can be used to transfer complex SFD system into understandable simplified feedback structures. Together, the SFDs and the CLDs fully define the differential equation system. If only a simple qualitative understanding of the system is required, then CLD and SFD may be enough, but if the answer requires a numerical accuracy, then the problem can be investigated further with system dynamic tool diagrams (SDTD) and subsequently be modelled in a software tool for numerical simulation.</p></sec></body><back><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badiola</surname><given-names>M</given-names></name><name><surname>Mendiola</surname><given-names>D</given-names></name><name><surname>Bostock</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Recirculating Aquaculture Systems (RAS) analysis: main issues on management</article-title><source>Aquac Eng</source><year>2012</year><volume>51</volume><fpage>26</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1016/j.aquaeng.2012.07.004</pub-id></mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Batstone</surname><given-names>DJ</given-names></name><name><surname>Keller</surname><given-names>J</given-names></name><name><surname>Angelidaki</surname><given-names>I</given-names></name><name><surname>Kalyuzhnyi</surname><given-names>SV</given-names></name><name><surname>Pavlostathis</surname><given-names>SG</given-names></name><name><surname>Rozzi</surname><given-names>A</given-names></name><name><surname>Sanders</surname><given-names>WTM</given-names></name><name><surname>Siegrist</surname><given-names>H</given-names></name><name><surname>Vavilin</surname><given-names>VA</given-names></name></person-group><article-title xml:lang="en">The IWA Anaerobic Digestion Model no 1 (ADM1)</article-title><source>Water Sci Technol</source><year>2002</year><volume>45</volume><fpage>65</fpage><lpage>73</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XntVCgs7o%3D</pub-id><pub-id pub-id-type="doi">10.2166/wst.2002.0292</pub-id></mixed-citation></ref><ref id="CR4"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boote</surname><given-names>KJ</given-names></name><name><surname>Jones</surname><given-names>JW</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Biggins</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Equations to define canopy photosynthesis from given quantum efficiency, maximum leaf rate, light extinction, leaf area index, and photon flux density</article-title><source>Progress in photosynthesis research</source><year>1987</year><publisher-loc>Dordrecht</publisher-loc><publisher-name>Martinus Nijhoff</publisher-name><fpage>415</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1007/978-94-017-0519-6_85</pub-id></mixed-citation></ref><ref id="CR5"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bot</surname><given-names>GPA</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Hashimoto</surname><given-names>Y</given-names></name><name><surname>Bot</surname><given-names>GPA</given-names></name><name><surname>Day</surname><given-names>W</given-names></name><name><surname>Tantau</surname><given-names>HJ</given-names></name><name><surname>Nonami</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Physical modelling of greenhouse climate</article-title><source>The computerized greenhouse</source><year>1993</year><publisher-loc>San Diego</publisher-loc><publisher-name>Academic Press</publisher-name><fpage>51</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/B978-0-12-330590-9.50006-9</pub-id></mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buck-Sorlin</surname><given-names>G</given-names></name><name><surname>De Visser</surname><given-names>PHB</given-names></name><name><surname>Henke</surname><given-names>M</given-names></name><name><surname>Sarlikioti</surname><given-names>V</given-names></name><name><surname>Ven der Heijden</surname><given-names>G</given-names></name><name><surname>Marcelis</surname><given-names>LFM</given-names></name><name><surname>Vos</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Towards a functional–structural plant model of cut-rose: simulation of light environment, light absorption, photosynthesis and interference with the plant structure</article-title><source>Ann Bot</source><year>2011</year><volume>108</volume><fpage>1121</fpage><lpage>1134</lpage><pub-id pub-id-type="doi">10.1093/aob/mcr190</pub-id></mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="other">Challa H, Bakker M (1999) Potential production within the greenhouse environment. In: Stanhill G, Enoch HZ (eds) Ecosystems of the world 20 – Greenhouse ecosystems. Elsevier, pp 333–347</mixed-citation></ref><ref id="CR8"><mixed-citation publication-type="other">Colt JEK (2013) Impact of aeration and alkalinity on the water quality and product quality of transported tilapia—a simulation study. <italic>Aquac Eng</italic>:46–58</mixed-citation></ref><ref id="CR9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corominas</surname><given-names>L</given-names></name><name><surname>Riegler</surname><given-names>L</given-names></name><name><surname>Takács</surname><given-names>I</given-names></name></person-group><article-title xml:lang="en">New framework for standardized notation in wastewater</article-title><source>J Int Assoc Water Pollut Res</source><year>2010</year><volume>61</volume><issue>4</issue><fpage>S841</fpage><lpage>S857</lpage></mixed-citation></ref><ref id="CR10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dahl</surname><given-names>O-J</given-names></name><name><surname>Nygaard</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">SIMULA: an ALGOL-based simulation language</article-title><source>Commun ACM</source><year>1966</year><volume>9</volume><issue>9</issue><fpage>671</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1145/365813.365819</pub-id></mixed-citation></ref><ref id="CR11"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>de Zwart</surname><given-names>HF</given-names></name></person-group><source>Analyzing energy-saving options in greenhouse cultivation using a simulation model</source><year>1996</year><publisher-loc>Wageningen</publisher-loc><publisher-name>Wageningen Agricultural University</publisher-name><fpage>236</fpage></mixed-citation></ref><ref id="CR12"><mixed-citation publication-type="other">Delaide B, Goddek S, Keesman, KJ, Jijakli MH (2018). A methodology to quantify the aerobic and anaerobic sludge digestion performance for nutrient recycling in aquaponics. <ext-link xlink:href="https://popups.uliege.be/1780-4507" ext-link-type="uri">https://popups.uliege.be:443/1780-4507</ext-link> 22, 12</mixed-citation></ref><ref id="CR13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drayer</surname><given-names>GE</given-names></name><name><surname>Howard</surname><given-names>AM</given-names></name></person-group><article-title xml:lang="en">Modeling and simulation of an aquatic habitat for bioregenerative life support research</article-title><source>Acta Astronaut</source><year>2014</year><volume>93</volume><fpage>S.138</fpage><lpage>S.147</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhsV2jsbrO</pub-id><pub-id pub-id-type="doi">10.1016/j.actaastro.2013.07.013</pub-id></mixed-citation></ref><ref id="CR400"><mixed-citation publication-type="other">El-Mashad H (2003) Solar Thermophilic Anaerobic Reactor (STAR) for renewable energy production PhD thesis Wageningen University. ISBN: 9058089533-238</mixed-citation></ref><ref id="CR14"><mixed-citation publication-type="other">Emerenciano M, Carneiro P, Lapa M, Lapa K, Delaide B, Goddek S (2017) Mineralizacão de sólidos. Aquac Bras 21–26</mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="other">Emrich S, Suslov S, Judex F (2007) Fully agent based. Modellings of epidemic spread using anylogic. In: Proceedings of the EUROSIM</mixed-citation></ref><ref id="CR16"><mixed-citation publication-type="book"><person-group person-group-type="author"><collab>FAO</collab></person-group><source><italic>The State of World Fisheries and Aquaculture 2016. Contributing to food security and nutrition for all</italic></source><year>2016</year><publisher-loc>Rome</publisher-loc><publisher-name>Food and Agriculture Organization of the United Nations</publisher-name></mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="other">Ficara E, Hassam S, Allegrini A, Leva A, Malpei F, Ferretti G (2012) Anaerobic digestion models: a comparative study. In: Proceedings of the 7th Vienna international conference on mathematical modelling 2012, p 1052</mixed-citation></ref><ref id="CR18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fortmann-Roe</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Insight maker: a general-purpose tool for web-based modeling &amp; simulation</article-title><source>Simul Model Pract Theory</source><year>2014</year><volume>47</volume><fpage>28</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/j.simpat.2014.03.013</pub-id></mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frantz</surname><given-names>JM</given-names></name><name><surname>Hand</surname><given-names>B</given-names></name><name><surname>Buckingham</surname><given-names>L</given-names></name><name><surname>Ghose</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Virtual grower: software to calculate heating costs of greenhouse production in the United States</article-title><source>HortTechnology</source><year>2010</year><volume>20</volume><fpage>778</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.21273/HORTTECH.20.4.778</pub-id></mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galí</surname><given-names>A</given-names></name><name><surname>Benabdallah</surname><given-names>T</given-names></name><name><surname>Astals</surname><given-names>S</given-names></name><name><surname>Mata-Alvarez</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Modified version of ADM1 model for agro-waste application</article-title><source>Bioresour Technol</source><year>2009</year><volume>100</volume><issue>11</issue><fpage>2783</fpage><lpage>2790</lpage><pub-id pub-id-type="doi">10.1016/j.biortech.2008.12.052</pub-id></mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="other">Goddek S (2017) Opportunities and challenges of multi-loop aquaponic systems. Wageningen University. <ext-link xlink:href="10.18174/412236" ext-link-type="doi">https://doi.org/10.18174/412236</ext-link></mixed-citation></ref><ref id="CR500"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goddek</surname><given-names>S</given-names></name><name><surname>Delaide</surname><given-names>BPL</given-names></name><name><surname>Joyce</surname><given-names>A</given-names></name><name><surname>Wuertz</surname><given-names>S</given-names></name><name><surname>Jijakli</surname><given-names>MH</given-names></name><name><surname>Gross</surname><given-names>A</given-names></name><name><surname>Eding</surname><given-names>EH</given-names></name><name><surname>Bläser</surname><given-names>I</given-names></name><name><surname>Reuter</surname><given-names>M</given-names></name><name><surname>Keizer</surname><given-names>LCP</given-names></name><name><surname>Morgenstern</surname><given-names>R</given-names></name><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Verreth</surname><given-names>J</given-names></name><name><surname>Keesman</surname><given-names>KJ</given-names></name></person-group><article-title xml:lang="en">Nutrient mineralization and organic matter reduction performance of RAS-based sludge in sequential UASB-EGSB reactors</article-title><source>Aquac Eng</source><year>2018</year><volume>83</volume><fpage>10</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1016/j.aquaeng.2018.07.003</pub-id><comment>ISSN: 0144-8609</comment></mixed-citation></ref><ref id="CR22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goddek</surname><given-names>S</given-names></name><name><surname>Keesman</surname><given-names>KJ</given-names></name></person-group><article-title xml:lang="en">The necessity of desalination technology for designing and sizing multi-loop aquaponics systems</article-title><source>Desalination</source><year>2018</year><volume>428</volume><fpage>76</fpage><lpage>85</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhvVClsrrF</pub-id><pub-id pub-id-type="doi">10.1016/j.desal.2017.11.024</pub-id></mixed-citation></ref><ref id="CR23"><mixed-citation publication-type="other">Goddek S, Körner O (2019) A fully integrated simulation model of multi-loop aquaponics: A case study for system sizing in different environments. Agric Syst</mixed-citation></ref><ref id="CR24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goddek</surname><given-names>S</given-names></name><name><surname>Delaide</surname><given-names>B</given-names></name><name><surname>Mankasingh</surname><given-names>U</given-names></name><name><surname>Ragnarsdottir</surname><given-names>K</given-names></name><name><surname>Jijakli</surname><given-names>H</given-names></name><name><surname>Thorarinsdottir</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Challenges of sustainable and commercial aquaponics</article-title><source>Sustainability</source><year>2015</year><volume>7</volume><fpage>4199</fpage><lpage>4224</lpage><pub-id pub-id-type="doi">10.3390/su7044199</pub-id></mixed-citation></ref><ref id="CR25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goddek</surname><given-names>S</given-names></name><name><surname>Espinal</surname><given-names>CA</given-names></name><name><surname>Delaide</surname><given-names>B</given-names></name><name><surname>Jijakli</surname><given-names>MH</given-names></name><name><surname>Schmautz</surname><given-names>Z</given-names></name><name><surname>Wuertz</surname><given-names>S</given-names></name><name><surname>Keesman</surname><given-names>KJ</given-names></name></person-group><article-title xml:lang="en">Navigating towards decoupled aquaponic systems: a system dynamics design approach</article-title><source>Water (Switzerland)</source><year>2016</year><volume>8</volume><fpage>303</fpage><pub-id pub-id-type="doi">10.3390/W8070303</pub-id></mixed-citation></ref><ref id="CR26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graber</surname><given-names>A</given-names></name><name><surname>Junge</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Aquaponic systems: nutrient recycling from fish wastewater by vegetable production</article-title><source>Desalination</source><year>2009</year><volume>246</volume><fpage>147</fpage><lpage>156</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXpvFehsb4%3D</pub-id><pub-id pub-id-type="doi">10.1016/j.desal.2008.03.048</pub-id></mixed-citation></ref><ref id="CR27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halamachi</surname><given-names>I</given-names></name><name><surname>Simon</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">A novel computer simulation model for design and management of re-circulating aquaculture systems</article-title><source>Aquac Eng</source><year>2005</year><volume>32</volume><issue>3–4</issue><fpage>S443</fpage><lpage>S464</lpage><pub-id pub-id-type="doi">10.1016/j.aquaeng.2004.09.010</pub-id></mixed-citation></ref><ref id="CR28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hassan</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Transient accumulation of NO2-and N2O during denitrification explained by assuming cell diversification by stochastic transcription of denitrification genes</article-title><source>PLoS Comput Biol</source><year>2016</year><volume>11</volume><issue>1</issue><fpage>e1004621</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004621</pub-id></mixed-citation></ref><ref id="CR29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>E</given-names></name><name><surname>Wurtsbaugh</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">An empirical model of gastric evacuation rates for fish and an analysis of digestion in piscivorous brown trout</article-title><source>Trans Am Fish Soc</source><year>1993</year><volume>122</volume><issue>5</issue><fpage>S.717</fpage><lpage>S.730</lpage><pub-id pub-id-type="doi">10.1577/1548-8659(1993)122&lt;0717:AEMOGE&gt;2.3.CO;2</pub-id></mixed-citation></ref><ref id="CR30"><mixed-citation publication-type="other">Henze M, Willi G, Takashi M, Mark L (2002) Activated sludge models ASM1, ASM2, ASM2d AND ASM3. IWA Publishing in its Scientific and Technical Report series, UK. ISBN: 1-900222-24-8</mixed-citation></ref><ref id="CR31"><mixed-citation publication-type="other">Heuvelink E (1996) Tomato growth and yield: quantitative analysis and synthesis. Department of Horticulture. Wageningen Agricultural University, Wageningen, The Netherlands, p 326</mixed-citation></ref><ref id="CR32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jablonsky</surname><given-names>J</given-names></name><name><surname>Papacek</surname><given-names>S</given-names></name><name><surname>Hagemann</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Different strategies of metabolic regulation in cyanobacteria: from transcriptional to biochemical control</article-title><source>Sci Rep</source><year>2016</year><volume>6</volume><fpage>33024</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhsV2ktLnJ</pub-id><pub-id pub-id-type="doi">10.1038/srep33024</pub-id></mixed-citation></ref><ref id="CR33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janka</surname><given-names>E</given-names></name><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Rosenqvist</surname><given-names>E</given-names></name><name><surname>Ottosen</surname><given-names>CO</given-names></name></person-group><article-title xml:lang="en">Simulation of PSII-operating efficiency from chlorophyll fluorescence in response to light and temperature in chrysanthemum (Dendranthema grandiflora) using a multilayer leaf model</article-title><source>Photosynthetica</source><year>2018</year><volume>56</volume><fpage>633</fpage><lpage>640</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXitlOmu7w%3D</pub-id><pub-id pub-id-type="doi">10.1007/s11099-017-0701-8</pub-id></mixed-citation></ref><ref id="CR34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karimanzira</surname><given-names>D</given-names></name><name><surname>Keesman</surname><given-names>KJ</given-names></name><name><surname>Kloas</surname><given-names>W</given-names></name><name><surname>Baganz</surname><given-names>D</given-names></name><name><surname>Rauschenbach</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Dynamic modeling of the INAPRO aquaponic system</article-title><source>Aquac Eng</source><year>2016</year><volume>75</volume><fpage>29</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/j.aquaeng.2016.10.004</pub-id></mixed-citation></ref><ref id="CR35"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Keesman</surname><given-names>KJ</given-names></name></person-group><source>System identification: an introduction</source><year>2011</year><publisher-loc>London</publisher-loc><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-85729-522-4</pub-id></mixed-citation></ref><ref id="CR36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knaus</surname><given-names>U</given-names></name><name><surname>Palm</surname><given-names>HW</given-names></name></person-group><article-title xml:lang="en">Effects of fish biology on ebb and flow aquaponical cultured herbs in northern Germany (Mecklenburg Western Pomerania)</article-title><source>Aquaculture</source><year>2017</year><volume>466</volume><fpage>51</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/j.aquaculture.2016.09.025</pub-id></mixed-citation></ref><ref id="CR37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Hansen</surname><given-names>JB</given-names></name></person-group><article-title xml:lang="en">An on-line tool for optimising greenhouse crop production</article-title><source>Acta Hortic</source><year>2011</year><volume>957</volume><fpage>147</fpage><lpage>154</lpage></mixed-citation></ref><ref id="CR38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Van Straten</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Decision support for dynamic greenhouse climate control strategies</article-title><source>Comput Electron Agric</source><year>2008</year><volume>60</volume><fpage>18</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1016/j.compag.2007.05.005</pub-id></mixed-citation></ref><ref id="CR39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Aaslyng</surname><given-names>JM</given-names></name><name><surname>Andreassen</surname><given-names>AU</given-names></name><name><surname>Holst</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Modelling microclimate for dynamic greenhouse climate control</article-title><source>HortScience</source><year>2007</year><volume>42</volume><fpage>272</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.21273/HORTSCI.42.2.272</pub-id></mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Warner</surname><given-names>D</given-names></name><name><surname>Tzilivakis</surname><given-names>J</given-names></name><name><surname>Eveleens-Clark</surname><given-names>B</given-names></name><name><surname>Heuvelink</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Decision support for optimising energy consumption in European greenhouses</article-title><source>Acta Hortic</source><year>2008</year><volume>801</volume><fpage>803</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.17660/ActaHortic.2008.801.94</pub-id></mixed-citation></ref><ref id="CR41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körner</surname><given-names>O</given-names></name><name><surname>Gutzmann</surname><given-names>E</given-names></name><name><surname>Kledal</surname><given-names>PR</given-names></name></person-group><article-title xml:lang="en">A dynamic model simulating the symbiotic effects in aquaponic systems</article-title><source>Acta Hortic</source><year>2017</year><volume>1170</volume><fpage>309</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.17660/ActaHortic.2017.1170.37</pub-id></mixed-citation></ref><ref id="CR42"><mixed-citation publication-type="other">Licamele JD (2009) Biomass production and nutrient dynamics in an aquaponics system. The University of Arizona</mixed-citation></ref><ref id="CR43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liebig</surname><given-names>HP</given-names></name><name><surname>Alscher</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Combination of growth models for optimized CO<sub>2</sub>- and temperature-control of lettuce</article-title><source>Acta Hortic</source><year>1993</year><volume>328</volume><fpage>155</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.17660/ActaHortic.1993.328.13</pub-id></mixed-citation></ref><ref id="CR44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lugert</surname><given-names>V</given-names></name><name><surname>Thaller</surname><given-names>G</given-names></name><name><surname>Tetens</surname><given-names>J</given-names></name><name><surname>Schulz</surname><given-names>C</given-names></name><name><surname>Krieter</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">A review on fish growth calculation: multiple functions in fish production and their specific application</article-title><source>Rev Aquac</source><year>2014</year><volume>8</volume><issue>1</issue><fpage>30</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1111/raq.12071</pub-id></mixed-citation></ref><ref id="CR300"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lupatsch</surname><given-names>I</given-names></name><name><surname>Kissil</surname><given-names>GW</given-names></name></person-group><article-title xml:lang="en">Predicting aquaculture waste from gilthead seabream (<italic>Sparus aurata</italic>) culture using nutritional approach</article-title><source>Aquat Living Resour</source><year>1998</year><volume>11</volume><issue>4</issue><fpage>265</fpage><lpage>268</lpage><pub-id pub-id-type="doi">10.1016/S0990-7440(98)80010-7</pub-id></mixed-citation></ref><ref id="CR45"><mixed-citation publication-type="other">Lupatsch I, Kissil GW, Sklan D (2003) Comparison of energy and protein efficiency among three fish species gilthead sea bream (Sparus aurata), European sea bass (Dicentrarchus labrax) and white grouper (Epinephelus aeneus): energy expenditure for protein and lipid deposition. <italic>Aquaculture</italic>:175–189</mixed-citation></ref><ref id="CR46"><mixed-citation publication-type="other">Macal CM, North MJ (2005) Tutorial on agent-based modeling and simulation. In: Simulation conference, 2005 proceedings of the winter. IEEE</mixed-citation></ref><ref id="CR47"><mixed-citation publication-type="other">Madsen LO, Møller-Pedersen B, Nygaard K (1993) Object-oriented programming in the BETA programming language. Addison-Wesley. ISBN 0-201-62430-3</mixed-citation></ref><ref id="CR48"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marcelis</surname><given-names>LFM</given-names></name></person-group><source>Fruit growth and dry matter partitioning in cucumber</source><year>1994</year><publisher-loc>Wageningen</publisher-loc><publisher-name>Department of Horticulture. Wageningen Agricultural University</publisher-name><fpage>173</fpage></mixed-citation></ref><ref id="CR49"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>J</given-names></name><name><surname>Levin</surname><given-names>MI</given-names></name></person-group><source>LISP 1.5 programmer’s manual</source><year>1965</year><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT Press</publisher-name></mixed-citation></ref><ref id="CR50"><mixed-citation publication-type="other">Orellana JUW (2014) Culture of yellowtail kingfish (Seriola lalandi) in a marine recirculating aquaculture system (RAS) with artificial seawater. Aquac Eng:20–28</mixed-citation></ref><ref id="CR51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pagand</surname><given-names>P</given-names></name><name><surname>Blancheton</surname><given-names>JP</given-names></name><name><surname>Casellas</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">A model for predicting the quantities of dissolved inorganic nitrogen released in effluents from a sea bass (Dicentrarchus labrax) recirculating water system</article-title><source>Aquac Eng</source><year>2000</year><volume>22</volume><issue>1–2</issue><fpage>S137</fpage><lpage>S153</lpage><pub-id pub-id-type="doi">10.1016/S0144-8609(00)00037-6</pub-id></mixed-citation></ref><ref id="CR52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlostathis</surname><given-names>SG</given-names></name><name><surname>Giraldo-gomez</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Kinetics of anaerobic treatment: A critical review</article-title><source>Crit Rev Environ Control</source><year>1991</year><volume>21</volume><fpage>411</fpage><lpage>490</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XhvVShtbc%3D</pub-id><pub-id pub-id-type="doi">10.1080/10643389109388424</pub-id></mixed-citation></ref><ref id="CR53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poorter</surname><given-names>H</given-names></name><name><surname>Anten</surname><given-names>NP</given-names></name><name><surname>Marcelis</surname><given-names>LFM</given-names></name></person-group><article-title xml:lang="en">Physiological mechanisms in plant growth models: do we need a supra-cellular systems biology approach</article-title><source>Plant Cell Environ</source><year>2013</year><volume>36</volume><fpage>1673</fpage><lpage>1690</lpage><pub-id pub-id-type="doi">10.1111/pce.12123</pub-id></mixed-citation></ref><ref id="CR54"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rath</surname><given-names>T</given-names></name></person-group><source>Einsatz wissensbasierter Systeme zur Modellierung und Darstellung von gartenbautechnischem Fachwissen am Beispiel des hybriden Expertensystems HORTEX</source><year>1992</year><publisher-loc>Germany</publisher-loc><publisher-name>University of Hannover</publisher-name></mixed-citation></ref><ref id="CR55"><mixed-citation publication-type="other">Rath T (2011) Softwaresystem zur Planung von Heizanlagen von Gewächshäusern. Fachgebiet Biosystem- und Gartenbautechnik. Leibniz University Hannover, Germany</mixed-citation></ref><ref id="CR56"><mixed-citation publication-type="other">Reyes Lastiri D, Slinkert T, Cappon HJ, Baganz D, Staaks G, Keesman KJ, (2016) Model of an aquaponic system for minimised water, energy and nitrogen requirements. Water Sci Technol. wst2016127. <ext-link xlink:href="10.2166/wst.2016.127" ext-link-type="doi">https://doi.org/10.2166/wst.2016.127</ext-link></mixed-citation></ref><ref id="CR57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richie</surname><given-names>M</given-names></name><name><surname>Haley</surname><given-names>D</given-names></name><name><surname>Oetker</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Effect of feeding frequency on gastric evacuation and the return of appetite in tilapia Oreochromis niloticus (L.)</article-title><source>Aquaculture</source><year>2004</year><volume>234</volume><issue>1–4</issue><fpage>S657</fpage><lpage>S673</lpage><pub-id pub-id-type="doi">10.1016/j.aquaculture.2003.12.012</pub-id></mixed-citation></ref><ref id="CR58"><mixed-citation publication-type="other">Rusten BE (2006) Design and operations of the Kaldnes moving bed biofilm reactors. Aquac Eng:322–331</mixed-citation></ref><ref id="CR59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sánchez-Romero</surname><given-names>A</given-names></name><name><surname>Miranda-Baeza</surname><given-names>A</given-names></name><name><surname>Rivas-Vega</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Development of a model to simulate nitrogen dynamics in an integrated shrimp–macroalgae culture system with zerowater exchange</article-title><source>J World Aquacult Soc</source><year>2016</year><volume>47</volume><issue>1</issue><fpage>129</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1111/jwas.12242</pub-id></mixed-citation></ref><ref id="CR60"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sinha</surname><given-names>NK</given-names></name><name><surname>Kuszta</surname><given-names>B</given-names></name></person-group><source>Modelling and identification of dynamic systems</source><year>1983</year><publisher-loc>New York</publisher-loc><publisher-name>Von-Nostrand Reinhold</publisher-name></mixed-citation></ref><ref id="CR61"><mixed-citation publication-type="other">Soukup J, Macháček P (2014) Serialization and persistent objects. Springer. <ext-link xlink:href="10.1007/978-3-642-39323-5" ext-link-type="doi">https://doi.org/10.1007/978-3-642-39323-5</ext-link></mixed-citation></ref><ref id="CR62"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sterman</surname><given-names>J</given-names></name></person-group><source>Business dynamics: systems thinking and modeling for a complex world</source><year>2000</year><publisher-loc>Boston</publisher-loc><publisher-name>McGraw Hill</publisher-name></mixed-citation></ref><ref id="CR63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Štys</surname><given-names>D</given-names></name><name><surname>Stys</surname><given-names>D</given-names><suffix>Jr</suffix></name><name><surname>Pecenkova</surname><given-names>J</given-names></name><name><surname>Stys</surname><given-names>KM</given-names></name><name><surname>Chkalova</surname><given-names>M</given-names></name><name><surname>Kouba</surname><given-names>P</given-names></name><name><surname>Pautsina</surname><given-names>A</given-names></name><name><surname>Durniev</surname><given-names>D</given-names></name><name><surname>Nahlık</surname><given-names>T</given-names></name><name><surname>Cısa</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">5iD Viewer-observation of fish school behaviour in labyrinths and use of semantic and syntactic entropy for school structure definition</article-title><source>World Acad Sci Eng Technol Int J Comput Electr Autom Control Inf Eng</source><year>2015</year><volume>9</volume><issue>1</issue><fpage>281</fpage><lpage>285</lpage></mixed-citation></ref><ref id="CR64"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>van Ooteghem</surname><given-names>RJC</given-names></name></person-group><source>Optimal control design for a solar greenhouse</source><year>2007</year><publisher-loc>Wageningen</publisher-loc><publisher-name>Wageningen University</publisher-name><fpage>304</fpage></mixed-citation></ref><ref id="CR65"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vanthoor</surname><given-names>B</given-names></name></person-group><source>A model-based greenhouse design method</source><year>2011</year><publisher-loc>Wageningen</publisher-loc><publisher-name>Wageningen University</publisher-name><fpage>307</fpage></mixed-citation></ref><ref id="CR66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waller</surname><given-names>U</given-names></name><name><surname>Buhmann</surname><given-names>AK</given-names></name><name><surname>Ernst</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Integrated multi-trophic aquaculture in a zero-exchange recirculation aquaculture system for marine fish and hydroponic halophyte production</article-title><source>Aquac Int</source><year>2015</year><volume>23</volume><fpage>1473</fpage><pub-id pub-id-type="doi">10.1007/s10499-015-9898-3</pub-id></mixed-citation></ref><ref id="CR67"><mixed-citation publication-type="other">Weatherley LR, Hill RG, Macmillan KJ (1993) Process modelling of an intensive aquaculture system. <italic>Aquac Eng</italic>:215–230</mixed-citation></ref><ref id="CR68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wik</surname><given-names>TEI</given-names></name><name><surname>Lindén</surname><given-names>BT</given-names></name><name><surname>Wramner</surname><given-names>PI</given-names></name></person-group><article-title xml:lang="en">Integrated dynamic aquaculture and wastewater treatment modelling for recirculating aquaculture systems</article-title><source>Aquaculture</source><year>2009</year><volume>287</volume><issue>3/4</issue><fpage>361</fpage><lpage>370</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXntFCjtQ%3D%3D</pub-id><pub-id pub-id-type="doi">10.1016/j.aquaculture.2008.10.056</pub-id></mixed-citation></ref><ref id="CR69"><mixed-citation publication-type="other">Willems JC, Polderman JW (1998) Introduction to mathematical systems theory: a behavioral approach. Springer. ISBN: 978-1-4757-2953-5</mixed-citation></ref><ref id="CR70"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wolfram</surname><given-names>S</given-names></name></person-group><source>Mathematica: a system for doing mathematics by computer</source><year>1991</year><publisher-loc>Champagne</publisher-loc><publisher-name>Wolfram Research</publisher-name></mixed-citation></ref><ref id="CR71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yogev</surname><given-names>U</given-names></name><name><surname>Barnes</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Nutrients and energy balance analysis for a conceptual model of a three loops off grid, aquaponics</article-title><source>Water</source><year>2016</year><volume>8</volume><fpage>589</fpage><pub-id pub-id-type="doi">10.3390/W8120589</pub-id></mixed-citation></ref><ref id="CR72"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zeigler</surname><given-names>BP</given-names></name><name><surname>Praehofer</surname><given-names>H</given-names></name><name><surname>Kim</surname><given-names>TG</given-names></name></person-group><source>Theory of modeling and simulation</source><year>2000</year><edition>2</edition><publisher-loc>London</publisher-loc><publisher-name>Elsevier</publisher-name></mixed-citation></ref></ref-list></ref-list></back></book-part></body></book-part></book-part-wrapper></records><facets><facet name="subject"><facet-value count="1">Agriculture</facet-value><facet-value count="1">Environmental and Sustainability Education</facet-value><facet-value count="1">Fish &amp; Wildlife Biology &amp; Management</facet-value><facet-value count="1">Freshwater &amp; Marine Ecology</facet-value><facet-value count="1">Life Sciences</facet-value><facet-value count="1">Sustainable Development</facet-value></facet><facet name="keyword"><facet-value count="1">Anaerobic digestion</facet-value><facet-value count="1">Hydroponic greenhouse</facet-value><facet-value count="1">Modelling</facet-value><facet-value count="1">Multi-loop aquaponic system</facet-value><facet-value count="1">Recirculating aquaculture system</facet-value><facet-value count="1">Tools</facet-value></facet><facet name="pub"><facet-value count="1">Aquaponics Food Production Systems</facet-value></facet><facet name="year"><facet-value count="1">2019</facet-value></facet><facet name="country"><facet-value count="1">Czech Republic</facet-value><facet-value count="1">Germany</facet-value><facet-value count="1">Netherlands</facet-value></facet><facet name="type"><facet-value count="1">Book</facet-value></facet></facets></response>
