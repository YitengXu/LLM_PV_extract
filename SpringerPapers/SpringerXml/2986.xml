<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s41601-021-00204-z</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41601</journal-id><journal-title-group><journal-title>Protection and Control of Modern Power Systems</journal-title><abbrev-journal-title abbrev-type="publisher">Prot Control Mod Power Syst</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2367-2617</issn><issn pub-type="epub">2367-0983</issn><publisher><publisher-name>Springer Singapore</publisher-name><publisher-loc>Singapore</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41601-021-00204-z</article-id><article-id pub-id-type="manuscript">204</article-id><article-id pub-id-type="doi">10.1186/s41601-021-00204-z</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title xml:lang="en">High performance decoupled active and reactive power control for three-phase grid-tied inverters using model predictive control</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4001-9833</contrib-id><name><surname>Azab</surname><given-names>Mohamed</given-names></name><address><email>Mohamed.ahmed.azab@ieee.org</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="corresp" rid="IDs4160102100204z_cor1">a</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.440763.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 0605 1095</institution-id><institution content-type="org-name">EEET Department, Yanbu Industrial College</institution></institution-wrap><addr-line content-type="city">Yanbu AL Sinaiyah</addr-line><country country="SA">Saudi Arabia</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.411660.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0621 2741</institution-id><institution content-type="org-division">EEET Department, Faculty of Engineering</institution><institution content-type="org-name">Benha University</institution></institution-wrap><addr-line content-type="city">Banha</addr-line><country country="EG">Egypt</country></aff></contrib-group><author-notes><corresp id="IDs4160102100204z_cor1"><label>a</label><email>Mohamed.ahmed.azab@ieee.org</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>30</day><month>7</month><year>2021</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2021</year></pub-date><volume>6</volume><issue seq="25">1</issue><elocation-id>25</elocation-id><history><date date-type="registration"><day>16</day><month>6</month><year>2021</year></date><date date-type="received"><day>27</day><month>9</month><year>2020</year></date><date date-type="accepted"><day>15</day><month>6</month><year>2021</year></date><date date-type="online"><day>30</day><month>7</month><year>2021</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Finite control set-model predictive control (FCS-MPC) is employed in this paper to control the operation of a three-phase grid-connected string inverter based on a direct PQ control scheme. The main objective is to achieve high-performance decoupled control of the active and reactive powers injected to the grid from distributed energy resources (DER).</p><p id="Par2">The FCS-MPC scheme instantaneously searches for and applies the optimum inverter switching state that can achieve certain goals, such as minimum deviation between reference and actual power; so that both power components (P and Q) are well controlled to their reference values.</p><p id="Par3">In addition, an effective method to attenuate undesired cross coupling between the P and Q control loops, which occurs only during transient operation, is investigated. The proposed method is based on the variation of the weight factors of the terms of the FCS-MPC cost function, so a higher weight factor is assigned to the cost function term that is exposed to greater disturbance. Empirical formulae of optimum weight factors as functions of the reference active and reactive power signals are proposed and mathematically derived. The investigated FCS-MPC control scheme is incorporated with the LVRT function to support the grid voltage in fulfilling and accomplishing the up-to-date grid codes. The LVRT algorithm is based on a modification of the references of active and reactive powers as functions of the instantaneous grid voltage such that suitable values of P and Q are injected to the grid during voltage sag.</p><p id="Par4">The performance of the elaborated FCS-MPC PQ scheme is studied under various operating scenarios, including steady-state and transient conditions. Results demonstrate the validity and effectiveness of the proposed scheme with regard to the achievement of high-performance operation and quick response of grid-tied inverters during normal and fault modes.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Model predictive control</kwd><kwd>Finite control set</kwd><kwd>Grid-connected inverter</kwd><kwd>Active power</kwd><kwd>Reactive power</kwd><kwd>Distributed generation</kwd><kwd>Low voltage ride through</kwd><kwd>PQ theory</kwd><kwd>FCS-MPC</kwd><kwd>LVRT</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>25</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41601_2021_Article_204.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1186/s41601-021-00204-z" ext-link-type="doi">https://doi.org/10.1186/s41601-021-00204-z</ext-link>.</p></notes></front><body><sec id="Sec1"><title>Introduction</title><sec id="Sec2"><title>Literature review</title><p id="Par67">A grid-connected inverter constitutes an essential part of modern DER (distributed energy resources) grid integration systems [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. During the last few years, many efforts have been made to ensure reliable operation of the grid-tied inverter by taking into consideration modern grid codes and standards [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]. The increasing computation capability of high-speed digital signal processors (DSPs) and the availability of various hardware-in-the loop (HIL) control boards have facilitated the development and implementation of sophisticated control algorithms for achieving reliable grid-integrated systems [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Accordingly, some new functions and features (such as LVRT) recommended by updated grid codes and standards can be added to the inverter control algorithm [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. Such regulations obligate the grid-tied inverters to withstand unintentional grid voltage sag for a specific duration based on some LVRT profiles, which are customised in many countries [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR38">38</xref>]. A modern control technique that has been utilised in recent years to control the operation of grid-tied inverters is the FCS-MPC [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR55">55</xref>]. Successful utilisation of the FCS-MPC algorithm has been reported in many studies [<xref ref-type="bibr" rid="CR56">56</xref>–<xref ref-type="bibr" rid="CR69">69</xref>]. Most of the existing FCS-MPC schemes for grid-connected inverters are either current controlled [<xref ref-type="bibr" rid="CR51">51</xref>, <xref ref-type="bibr" rid="CR61">61</xref>, <xref ref-type="bibr" rid="CR63">63</xref>, <xref ref-type="bibr" rid="CR66">66</xref>, <xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR71">71</xref>] or voltage controlled [<xref ref-type="bibr" rid="CR72">72</xref>–<xref ref-type="bibr" rid="CR75">75</xref>].</p><p id="Par68">In current-controlled schemes, FCS-MPC regulates and controls as per the desired value the current injected to the grid from the DER by applying the adequate inverter switching state. In voltage-controlled schemes, FCS-MPC controls the inverter output voltage (voltage space vector), which indirectly controls the current injected to the grid. In this scheme, the computation of the voltage space vector is similar to the one used in the well-known SVM technique.</p><p id="Par69">In this paper, FCS-MPC is employed to apply a direct PQ control strategy such that the active and reactive powers (P and Q) injected to the grid from the DER are directly controlled to their reference values; this is done through the application of the optimum inverter switching state to ensure a quick response. In recent years, considerable efforts have been made to overcome the major challenges of FCS-MPC that negatively affect its overall performance. One of these challenges is choosing the weight factors of the cost function. Thus, the topic of selecting the weight factors of the FCS-MPC cost function to optimise the scheme’s performance has gained much attention [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR76">76</xref>]. Most of the weight factor determination methods are based on iterative range-sweeping techniques or evolutionary search algorithms because of the lack of theoretical design methodologies or analytical approaches for designing and adjusting these parameters. In general, all methods aim to assign a higher weight factor to a given objective term whenever it presents an unaccepted error [<xref ref-type="bibr" rid="CR46">46</xref>]. To achieve this task, the errors between the desired and actual values of the associated variables are usually used as inputs to the tuning algorithm [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR76">76</xref>].</p><p id="Par70">Some methods assign discrete values to the weight factors (usually dual values) [<xref ref-type="bibr" rid="CR41">41</xref>] or employ evolutionary search algorithms to determine the optimum weight factors involving the operating range [<xref ref-type="bibr" rid="CR44">44</xref>], while other methods compute the dynamic weighting factor gain as functions of the errors such that the weight factors are tuned online [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR76">76</xref>]. Nevertheless, inappropriate dynamic weight factors can lead to the over-optimisation of the terms of the cost function. This deteriorates overall performance. Thus, there is a trade-off between simplicity and accuracy. To address such issues, this paper proposes an empirical weight factor-tuning method for achieving an optimised transient response of the overall FCS-MPC system.</p></sec><sec id="Sec3"><title>Objective of the paper</title><p id="Par71">The primary objective of the paper is to study and investigate an integrated control scheme for a three-phase grid-tied string inverter that can guarantee satisfactory steady-state performance as well as quick transient performance by employing decoupled control of the active and reactive powers (PQ) injected into the grid. The control scheme also attempts to consider the LVRT mode during grid voltage sag to satisfy the existing grid codes related to grid-connected inverters. The performance of the investigated scheme is studied under various operating conditions, including the normal and fault modes (grid voltage sag). Qualitative and quantitative analyses of steady state and transient responses are undertaken and addressed. Results demonstrate the validity and effectiveness of the discussed scheme in terms of the achievement of a high-performance three-phase grid integration system during both the normal and fault modes of operation. The rest of the paper is organized as follows. Section 2 provides an overview of the current-controlled FCS-MPC scheme for three-phase grid-tied inverters, and Section 3 details the different parts of the investigated system, including the computation of grid voltages and currents in (α-β) coordinates, the computation of power components (P and Q), the formulation of the cost function, and the adjustment of weight factors and also describes the LVRT mode. In Section 4, selected simulation results are presented and discussed, and qualitative and quantitative assessments on the results are also provided. Conclusions are drawn in Section 5, and the empirical formulae of variable weight factors and their mathematical derivations are presented in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>.</p></sec><sec id="Sec4"><title>Main contribution</title><p id="Par72">The main contributions of the paper are as follows:</p><p id="Par73">(1) It proposes a simple and effective method of optimising the weighting factors of the FCS-MPC cost function for reducing undesired cross coupling between the P and Q control loops. Empirical formulae of optimum weight factors (as functions of active and reactive power references) are formulated and mathematically derived.</p><p id="Par74">The proposed method varies the weight factors of the cost function only during detected transient periods and retains equal weight factors during steady-state operation. Thus, during steady-state operation, both terms of the cost function have the same levels of priority and contribution. However, during the transient period, the weight factors adjustment is governed by a simple, logical rule, i.e., granting a higher weight factor to the term that is exposed to higher undesired coupling until the error is restricted to predetermined satisfactory limits.</p><p id="Par75">(2) It applies the concept of decoupled PQ control to incorporate LVRT capability, which is an essential option demanded by recently published grid codes (such as IEEE 1547, VDE-AR-N 4120 and IEC 62477–1). Most existing LVRT schemes are current-control based. They inject a suitable reactive current to the grid; consequently, reactive power is indirectly injected to the grid. However, in this paper, the LVRT is achieved through the direct injection of the optimum values of P and Q during a fault condition using the same FCS-MPC scheme; the corresponding reference powers (P<sub>ref</sub> &amp; Q<sub>ref</sub>) are instantaneously calculated within the FCS-MPC algorithm.</p></sec></sec><sec id="Sec5"><title>Current controlled FCS-MPC scheme for 3-Φ grid- connected string inverter</title><sec id="Sec6"><title>Single-line diagram and inverter power circuit</title><p id="Par76">The single-line diagram of a typical three-phase PV grid integration system is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In this system, all PV arrays (considered as one of the DERs) are connected to a common DC bus of 600 V through the individual MPPT tracking units and suitable DC-DC converters incorporated with each PV array. The string inverter injects both active and reactive powers (P and Q) to the grid according to the mode of operation. The circuit diagram of a 3-Φ grid-connected inverter is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>; as shown, the energy produced from the distributed resource is injected to the grid through the inverter. A 3-Φ inductor L<sub>S</sub> having a small equivalent series resistance R<sub>S</sub> is inserted at PCC between the inverter output and the grid [<xref ref-type="bibr" rid="CR24">24</xref>]. The voltage space vector <inline-formula id="IEq6"><alternatives><mml:math display="inline" id="IEq6_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">U</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="normal">S</mml:mi></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mathrm{U}}}_{\mathrm{S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq6.gif"/></alternatives></inline-formula> can be described as a function of the DC link voltage and inverter switching states as follows:
<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">U</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>DC</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mn>4</mml:mn><mml:mi mathvariant="normal">π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mathrm{U}}}_{\mathrm{S}}=\frac{2}{3}\ {\mathrm{V}}_{\mathrm{DC}}\left({\mathrm{S}}_1+{\mathrm{e}}^{\mathrm{j}2\uppi /3}{\mathrm{S}}_3+{\mathrm{e}}^{\mathrm{j}4\uppi /3}{\mathrm{S}}_5\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ1.gif"/></alternatives></disp-formula>where S<sub>1</sub>, S<sub>3</sub> and S<sub>5</sub> are the switching states of the upper power transistors of the inverter. The voltage space vector <inline-formula id="IEq7"><alternatives><mml:math display="inline" id="IEq7_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">U</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="normal">S</mml:mi></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mathrm{U}}}_{\mathrm{S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq7.gif"/></alternatives></inline-formula> can be resolved into two orthogonal components (U<sub>α</sub> and U<sub>β</sub>) in the (α-β reference frame, where their equivalent values are computed by:
<disp-formula id="Equ2"><label>2.a</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:msub><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>DC</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{U}}_{\upalpha}=\frac{2}{3}\ {\mathrm{V}}_{\mathrm{DC}}\left({\mathrm{S}}_1-\frac{1}{2}{\mathrm{S}}_3-\frac{1}{2}{\mathrm{S}}_5\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>2.b</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:msub><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>DC</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi mathvariant="normal">S</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{U}}_{\upbeta}=\frac{2}{3}\ {\mathrm{V}}_{\mathrm{DC}}\left(\frac{\sqrt{3}}{2}{\mathrm{S}}_3-\frac{\sqrt{3}}{2}{\mathrm{S}}_5\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ3.gif"/></alternatives></disp-formula><fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Single line diagram of 3-Φ grid-tied String Inverter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig1_HTML.png" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Power Circuit of a 3-ΦGrid Connected String Inverter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par77">The resultant components of inverter voltage space vector <inline-formula id="IEq8"><alternatives><mml:math display="inline" id="IEq8_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">U</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="normal">S</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mathrm{U}}}_{\mathrm{S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq8.gif"/></alternatives></inline-formula> for all switching states are presented in Table <xref rid="Tab1" ref-type="table">1</xref>. The six active inverter switching states and two nil switching states are used to control the operation of the grid-tied inverter in different configurations such as current-controlled mode or SPWM or SVM techniques.
<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Switching States of a 3-Φ VSI Inverter</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"><p>Switching</p><p>State</p><p>S<sub><bold>1</bold></sub> S<sub><bold>3</bold></sub> S<sub><bold>5</bold></sub></p></th><th rowspan="2"><p>Vector Notation</p><p>U<sub><bold>x</bold></sub></p></th><th colspan="2"><p>Space Vector</p><p>Ū<sub><bold>S</bold></sub></p></th><th colspan="2"><p>α-β Components</p><p>U<sub><bold>α</bold></sub> and U<sub><bold>β</bold></sub></p></th></tr><tr><th><p>Mag.</p></th><th><p>Angle</p></th><th><p>U<sub><bold>α</bold></sub></p></th><th><p>U<sub><bold>β</bold></sub></p></th></tr></thead><tbody><tr><td><p>0 0 0</p></td><td><p>U<sub>0</sub></p></td><td><p>0</p></td><td><p>N/A</p></td><td><p>0</p></td><td><p>0</p></td></tr><tr><td><p>1 0 0</p></td><td><p>U<sub>1</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>0</p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>0</p></td></tr><tr><td><p>1 1 0</p></td><td><p>U<sub>2</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>π/3</p></td><td><p>1/3V<sub>DC</sub></p></td><td><p>1/√3V<sub>DC</sub></p></td></tr><tr><td><p>0 1 0</p></td><td><p>U<sub>3</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>2π/3</p></td><td><p>−1/3V<sub>DC</sub></p></td><td><p>1/√3V<sub>DC</sub></p></td></tr><tr><td><p>0 1 1</p></td><td><p>U<sub>4</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>π</p></td><td><p>- 2/3V<sub>DC</sub></p></td><td><p>0</p></td></tr><tr><td><p>0 0 1</p></td><td><p>U<sub>5</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>4π/3</p></td><td><p>−1/3V<sub>DC</sub></p></td><td><p>−1/√3V<sub>DC</sub></p></td></tr><tr><td><p>1 0 1</p></td><td><p>U<sub>6</sub></p></td><td><p>2/3V<sub>DC</sub></p></td><td><p>5π/3</p></td><td><p>1/3V<sub>DC</sub></p></td><td><p>−1/√3V<sub>DC</sub></p></td></tr><tr><td><p>1 1 1</p></td><td><p>U<sub>7</sub></p></td><td><p>0</p></td><td><p>N/A</p></td><td><p>0</p></td><td><p>0</p></td></tr></tbody></table></table-wrap></p><p id="Par78">In FCS-MPC, the optimum inverter switching state is instantaneously selected and applied to the inverter to minimise a specific cost function; this is explained in the following sections.</p></sec><sec id="Sec7"><title>Principle of current controlled FCS-MPC approach</title><p id="Par79">In recent years, FCS-MPC has been adopted to control the operation of switching power converters such as grid-tied inverters [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR76">76</xref>, <xref ref-type="bibr" rid="CR77">77</xref>]. In the FCS-MPC technique, the future behaviour of the system is predicted for a finite time frame [<xref ref-type="bibr" rid="CR40">40</xref>]. Accordingly, the optimum future control action is applied to the system to satisfy a customised goal function [<xref ref-type="bibr" rid="CR57">57</xref>–<xref ref-type="bibr" rid="CR66">66</xref>], and the FCS-MPC algorithm is repeated at every sampling period [<xref ref-type="bibr" rid="CR67">67</xref>–<xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR76">76</xref>, <xref ref-type="bibr" rid="CR77">77</xref>]. Generally, it is characterised by fast transient response and the ability to consider the nonlinearities and constraints in the control law [<xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR60">60</xref>].</p><p id="Par80">Applying KVL to the circuit in Fig. <xref rid="Fig2" ref-type="fig">2</xref> yields:
<disp-formula id="Equ4"><label>3.a</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{an}={i}_a{R}_S+{L}_S\frac{di_a}{dt}+{e}_{an}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ4.gif"/></alternatives></disp-formula><disp-formula id="Equ5"><label>3.b</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{bn}={i}_b{R}_S+{L}_S\frac{di_b}{dt}+{e}_{bn}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>3.c</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{cn}={i}_c{R}_S+{L}_S\frac{di_c}{dt}+{e}_{cn}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ6.gif"/></alternatives></disp-formula></p><p id="Par81">The rates of change of grid currents <inline-formula id="IEq9"><alternatives><mml:math display="inline" id="IEq9_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_a}{dt}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq9.gif"/></alternatives></inline-formula>, <inline-formula id="IEq10"><alternatives><mml:math display="inline" id="IEq10_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_b}{dt}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><mml:math display="inline" id="IEq11_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_c}{dt}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq11.gif"/></alternatives></inline-formula> are rearranged:
<disp-formula id="Equ7"><label>4.a</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_a}{dt}=\frac{1}{L_S}\left({v}_{an}-{e}_{an}\right)-{i}_a\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>4.b</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_b}{dt}=\frac{1}{L_S}\left({v}_{bn}-{e}_{bn}\right)-{i}_b\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ8.gif"/></alternatives></disp-formula><disp-formula id="Equ9"><label>4.c</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mfrac><mml:msub><mml:mi mathvariant="italic">di</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi mathvariant="italic">dt</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{di_c}{dt}=\frac{1}{L_S}\left({v}_{cn}-{e}_{cn}\right)-{i}_c\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ9.gif"/></alternatives></disp-formula></p><p id="Par82">Accordingly, (4.a) is employed to derive the instantaneous value of phase current <italic>i</italic><sub><italic>a</italic></sub> at the (k + 1)<sup>th</sup> sample as:
<disp-formula id="Equ10"><label>5.a</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mo>∆</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {i}_a=\frac{\Delta t}{L_S}\left({v}_{an}-{e}_{an}\right)-\Delta t\ {i}_a\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ10.gif"/></alternatives></disp-formula><disp-formula id="Equ11"><label>5.b</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_a^{k+1}-{i}_a^k=\frac{T_S}{L_S}\left({v}_{an}-{e}_{an}\right)-{T}_S\ {i}_a^k\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ11.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><label>5.c</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_a^{k+1}={i}_a^k+\frac{T_S}{L_S}\left({v}_{an}-{e}_{an}\right)-{T}_S\ {i}_a^k\frac{R_S}{L_S}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ12.gif"/></alternatives></disp-formula><disp-formula id="Equ13"><label>6.a</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_a^{k+1}={i}_a^k\left(1-{T}_S\frac{R_S}{L_S}\right)+\frac{T_S}{L_S}\ \left({v}_{an}-{e}_{an}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ13.gif"/></alternatives></disp-formula>where T<sub>S</sub> is the sampling time, L<sub>S</sub> is the per-phase inductance of the inductor and R<sub>S</sub> is the equivalent series resistance of the inductor L<sub>S</sub>.</p><p id="Par83">Similarly, the instantaneous grid currents of other phases, <italic>i</italic><sub><italic>b</italic></sub> and <italic>i</italic><sub><italic>c</italic></sub>, at the (k + 1)<sup>th</sup> sample are predicted as:
<disp-formula id="Equ14"><label>6.b</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_b^{k+1}={i}_b^k\left(1-{T}_S\frac{R_S}{L_S}\right)+\frac{T_S}{L_S}\ \left({v}_{bn}-{e}_{bn}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>6.c</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_c^{k+1}={i}_c^k\left(1-{T}_S\frac{R_S}{L_S}\right)+\frac{T_S}{L_S}\ \left({v}_{cn}-{e}_{cn}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ15.gif"/></alternatives></disp-formula></p><p id="Par84">From (6.a), (6.b) and (6.c), the grid currents at the (k + 1)<sup>th</sup> sample can be predicted through online measurement of the grid voltage (<italic>e</italic><sub><italic>an</italic></sub>, <italic>e</italic><sub><italic>bn</italic></sub>, <italic>e</italic><sub><italic>cn</italic></sub>) and grid currents <italic>i</italic><sub><italic>a</italic></sub>, <italic>i</italic><sub><italic>b</italic></sub> and <italic>i</italic><sub><italic>c</italic></sub> at the current k<sup>th</sup> sample.</p><p id="Par85">The inverter output voltages (<italic>v</italic><sub><italic>an</italic></sub>, <italic>v</italic><sub><italic>bn</italic></sub>, <italic>v</italic><sub><italic>cn</italic></sub>) can be measured directly, while their (α-β) components in the stationary reference frame can be calculated based on (2.a) and (2.b). Unlike the hysteresis controllers or PI controllers driving PWM units, the FCS-MPC scheme instantaneously selects the optimum switching state every sampling period and achieves a specific goal function without requiring a PWM unit or hysteresis current controllers [<xref ref-type="bibr" rid="CR40">40</xref>].</p><p id="Par86">A simplified block diagram of a typical FCS-MPC scheme is presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, in which the predictive model block computes and predicts the grid currents at the (k + 1)<sup>th</sup> sample for the eight inverter switching states. Inside the cost function computation block, a cost function is computed for all switching states.
<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Simplified block diagrams of current controlled FCS-MPC for grid-tied inverter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig3_HTML.png" id="MO3"/></fig></p><p id="Par87">The switching state that results in the minimum value of the cost function is considered as the optimum state to be applied. This task is performed inside the optimum switching state selection block shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Consequently, if the reference grid currents <inline-formula id="IEq12"><alternatives><mml:math display="inline" id="IEq12_Math"><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_a^{\ast }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><mml:math display="inline" id="IEq13_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_b^{\ast }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><mml:math display="inline" id="IEq14_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_c^{\ast }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq14.gif"/></alternatives></inline-formula> are given, the chosen cost function <italic>J</italic>, described by (7), is repeatedly evaluated during every sampling period for the eight possible switching states. One of them is the optimum switching state that results in the minimum value of the cost function at the (k + 1)<sup>th</sup> sample. Accordingly, the actual grid current tracks the reference value with accepted error (deviation).
<disp-formula id="Equ16"><label>7</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J=\left|{i}_a^{\ast }-{i}_a^{k+1}\right|+\left|{i}_b^{\ast }-{i}_b^{k+1}\right|+\left|{i}_c^{\ast }-{i}_c^{k+1}\right|$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ16.gif"/></alternatives></disp-formula></p><p id="Par88">Excellent waveform tracking under FCS-MPC approach requires high sampling rates, which can be provided by high-speed data acquisition cards.</p></sec></sec><sec id="Sec8"><title>Description of the investigated decoupled PQ control system using FCS-MPC approach</title><p id="Par89">The block diagram of the investigated FCS-MPC PQ system for a 3-Φ grid-connected string inverter is illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The system is composed of two main blocks: (1) LVRT, which determines the mode of operation and computes the suitable reference signals of active and reactive powers; (2) The FCS-MPC system, which includes several blocks, such as prediction of grid currents and active and reactive powers, computation of cost function and selection of optimum switching state. All tasks are explained below in Subsections 3.1, 3.2 and 3.3.
<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Block diagram of FCS-MPC scheme for three-phase grid-tied inverter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig4_HTML.png" id="MO4"/></fig></p><sec id="Sec9"><title>Computation of grid voltages and currents in (α-β) stationary reference frame</title><p id="Par90">The (α-β) components of grid currents <italic>i</italic><sub><italic>α</italic></sub> and <italic>i</italic><sub><italic>β</italic></sub> are computed using (8.a) and (8.b), respectively. Similarly, the (α-β) components of grid voltages <italic>e</italic><sub><italic>α</italic></sub> and <italic>e</italic><sub><italic>β</italic></sub> are calculated using (9.a) and (9.b), respectively, based on the concept of the space vector as described by (1). Those components are essential in active and reactive power computations, as explained in Section 3.2.
<disp-formula id="Equ17"><label>8.a</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_{\alpha }=\frac{2}{3}\left({i}_a-\frac{1}{2}{i}_b-\frac{1}{2}{i}_c\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ17.gif"/></alternatives></disp-formula><disp-formula id="Equ18"><label>8.b</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_{\beta }=\frac{2}{3}\left(\frac{\sqrt{3}}{2}{i}_b-\frac{\sqrt{3}}{2}{i}_c\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ18.gif"/></alternatives></disp-formula><disp-formula id="Equ19"><label>9.a</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext mathvariant="italic">an</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\alpha }=\frac{2}{3}\left({e}_{an}-\frac{1}{2}{e}_{bn}-\frac{1}{2}{e}_{cn}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ19.gif"/></alternatives></disp-formula><disp-formula id="Equ20"><label>9.b</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">bn</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">cn</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\beta }=\frac{2}{3}\left(\frac{\sqrt{3}}{2}{e}_{bn}-\frac{\sqrt{3}}{2}{e}_{cn}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ20.gif"/></alternatives></disp-formula></p></sec><sec id="Sec10"><title>Prediction of active and reactive power</title><p id="Par91">The instantaneous active and reactive powers (P and Q) injected to the grid are computed as follows [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR78">78</xref>]:
<disp-formula id="Equ21"><label>10.a</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=\left({e}_{\alpha }{i}_{\alpha }+{e}_{\beta }{i}_{\beta}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ21.gif"/></alternatives></disp-formula><disp-formula id="Equ22"><label>10.b</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q=\left({e}_{\beta }{i}_{\alpha }-{e}_{\alpha }{i}_{\beta}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ22.gif"/></alternatives></disp-formula></p><p id="Par92">Resolution of (6.a), (6.b) and (6.c) into the equivalent (α-β) components leads to the predicted <italic>i</italic><sub><italic>α</italic></sub> and <italic>i</italic><sub><italic>β</italic></sub> at the (<italic>k</italic> + 1)<sup>th</sup> sample period as follows:
<disp-formula id="Equ23"><label>11.a</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_{\alpha}^{k+1}={i}_{\alpha}^k\left(1-{T}_S\frac{R_S}{L_S}\right)+\frac{T_S}{L_S}\ \left({u}_{\alpha }-{e}_{\alpha}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ23.gif"/></alternatives></disp-formula><disp-formula id="Equ24"><label>11.b</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_{\beta}^{k+1}={i}_{\beta}^k\left(1-{T}_S\frac{R_S}{L_S}\right)+\frac{T_S}{L_S}\ \left({u}_{\beta }-{e}_{\beta}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ24.gif"/></alternatives></disp-formula></p><p id="Par93">where <italic>u</italic><sub><italic>α</italic></sub> and <italic>u</italic><sub><italic>β</italic></sub> were previously computed using (2) and tabulated in Table <xref rid="Tab1" ref-type="table">1</xref>. <italic>e</italic><sub><italic>α</italic></sub> and <italic>e</italic><sub><italic>β</italic></sub> were previously computed using (10).</p><p id="Par94">From (8) to (11), the instantaneous active and reactive powers are predicted at the (<italic>k</italic> + 1)<sup>th</sup> sample as follows [<xref ref-type="bibr" rid="CR17">17</xref>]:
<disp-formula id="Equ25"><label>12</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}^{k+1}=\left({e}_{\alpha}^{k+1}\ {i}_{\alpha}^{k+1}+{e}_{\beta}^{k+1}\ {i}_{\beta}^{k+1}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ25.gif"/></alternatives></disp-formula><disp-formula id="Equ26"><label>13</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>i</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}^{k+1}=\left({e}_{\beta}^{k+1}\ {i}_{\alpha}^{k+1}-{e}_{\alpha}^{k+1}\ {i}_{\beta}^{k+1}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ26.gif"/></alternatives></disp-formula></p><p id="Par95">As the grid voltage has low variation compared to the sampling and switching frequencies, the grid voltage components <italic>e</italic><sub><italic>α</italic></sub> and <italic>e</italic><sub><italic>β</italic></sub> can be considered constant during the sampling period, i.e., (<inline-formula id="IEq15"><alternatives><mml:math display="inline" id="IEq15_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\alpha}^{k+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq15.gif"/></alternatives></inline-formula> = <inline-formula id="IEq16"><alternatives><mml:math display="inline" id="IEq16_Math"><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>e</mml:mi><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\alpha}^k$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq16.gif"/></alternatives></inline-formula>) and (<inline-formula id="IEq17"><alternatives><mml:math display="inline" id="IEq17_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\beta}^{k+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq17.gif"/></alternatives></inline-formula> = <inline-formula id="IEq18"><alternatives><mml:math display="inline" id="IEq18_Math"><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>e</mml:mi><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{\beta}^k$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq18.gif"/></alternatives></inline-formula>).</p></sec><sec id="Sec11"><title>Formulation of cost function</title><p id="Par96">The cost function is formulated to account for the active and reactive powers as follows:
<disp-formula id="Equ27"><label>14</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ref</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="italic">ref</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J={\left({P}_{ref}-{P}^{k+1}\right)}^2+{\left({Q}_{ref}-{Q}^{k+1}\right)}^2$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ27.gif"/></alternatives></disp-formula></p><p id="Par97">where P<sub>ref</sub> and Q<sub>ref</sub> are the desired reference values of the active and reactive powers to be injected to the grid from the DER through the 3-Φ inverter. In (14), the first term of the objective function aims to minimise the active power deviation (ripple), while the second term aims to minimise the reactive power ripple, and both terms have the same degree of importance and make equal contribution. Accordingly, the instantaneous value of the cost function <italic>J</italic> in (14) is computed for all inverter switching states. The resultant values of the cost function are plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref> (a) for a small time frame of 70 μs (seven samples, each with a sampling period of 10 μs). From the results, applying inverter vectors U<sub>4</sub> and U<sub>5</sub> alternatively produces the minimum values of the cost function (J<sub>4</sub> and J<sub>5</sub>) during the selected time frame (in six samples out of seven) in conjunction with the null vectors U<sub>0</sub> or U<sub>7</sub> (in one sample out of seven). Thus, switching states 4 and 5 is the optimum selection (also see Fig. <xref rid="Fig5" ref-type="fig">5</xref> (b)). In addition, the null vector is considered as the optimum selected vector in one of the seven samples (at t = 0.02005 s; J<sub>0</sub> is the minimum). Fig. <xref rid="Fig5" ref-type="fig">5</xref> (a) also shows that applying vectors U<sub>2</sub> and U<sub>3</sub> will yield the worst values of cost function (J<sub>2</sub> and J<sub>3</sub>) during the selected time frame. Similarly, applying vectors U<sub>1</sub> and U<sub>6</sub> will not result in an optimised cost function. Thus, vectors U<sub>2</sub>, U<sub>3</sub>, U<sub>1</sub> and U<sub>6</sub> are not used during the investigated time period. In Fig. <xref rid="Fig5" ref-type="fig">5</xref> (b), the overall minimum possible cost function J<sub>min</sub> (dotted line) is plotted together with J<sub>4</sub> and J<sub>5</sub>, which correspond to vectors U<sub>4</sub> and U<sub>5</sub>, respectively. In most FCS-MPC systems, weight factors are included in the terms of the cost function. Involving such weight factors allows the FCS-MPC system to assign a priority to the controlled variables on the design criteria. Thus, (14) is rewritten to involve weight factors in both terms of the cost function:
<disp-formula id="Equ28"><label>15</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ref</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="italic">ref</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.25em"/></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J={w}_p{\left({P}_{ref}-{P}^{k+1}\right)}^2+{w}_q{\left({Q}_{ref}-{Q}^{k+1}\right)}^2$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equ28.gif"/></alternatives></disp-formula><fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p><bold>a</bold> Cost function for all possible inverter switching states. <bold>b</bold> Cost function when applying U<sub>4</sub> &amp; U<sub>5</sub> and the resultant minimum cost function as alteration between J<sub>4</sub> &amp; J<sub>5</sub></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig5_HTML.png" id="MO5"/></fig></p><p id="Par98">where <italic>w</italic><sub>p</sub> and <italic>w</italic><sub>q</sub> are the weight factors of active and reactive power terms, respectively.</p></sec><sec id="Sec12"><title>Flowchart of the investigated FCS-MPC PQ control system</title><p id="Par99">The flowchart of the FCS-MPC algorithm is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> (a); (2) and (11)–(15) are computed at each sample for all possible inverter switching states such that an optimum switching state is determined and applied during the next sample.
<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p><bold>a</bold> Flowchart of the FCS-MPC algorithm. Flowchart of the overall elaborated FCS-MPC algorithm for 3-Φ grid connected string inverter. <bold>b</bold> Flowchart of weight factors adjustment. <bold>c</bold> Flowchart of LVRT algorithm</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig6_HTML.png" id="MO6"/></fig></p><p id="Par100">Initially, the system is investigated with constant weight factors (<italic>w</italic><sub>p</sub> = <italic>w</italic><sub>q</sub> = 1) during the whole operation of the FCS-MPC system.</p><p id="Par101">Then, those weight factors are varied during the transient periods, as explained in the flowchart of Fig. <xref rid="Fig6" ref-type="fig">6</xref> (b); this is described in detail in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>.</p></sec><sec id="Sec13"><title>Adjustment of weight factors (Wp &amp;Wq) of cost function</title><p id="Par102">As shown in the flowchart presented in Fig. <xref rid="Fig6" ref-type="fig">6</xref> (b), the weight factors in (15) are adjusted based on a simple rule that imposes a penalty to the term causing cross coupling during the transient operation (by reducing its weight factor).</p><p id="Par103">The same result can be obtained by granting higher priority or rewarding the negatively affected term of the cost function (by increasing its weight factor) during the transient periods. During steady-state operation, since no change occurs in the reference power, the weight factors are assigned to their initial values of unity. Once the algorithm detects a transient change in any of the reference signals (P<sub>ref</sub> or Q<sub>ref</sub>), the weight factors are adjusted accordingly based on the rule summarised in Table <xref rid="Tab2" ref-type="table">2</xref> and previously illustrated in the flowchart of Fig. <xref rid="Fig6" ref-type="fig">6</xref> (b).
<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Selection criteria of weight factors</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="4"><p>Parameter</p></th><th colspan="3"><p>Operating Condition</p></th></tr><tr><th><p>Abrupt change in P<sub>ref</sub> only</p></th><th><p>No changes</p><p>(Steady state)</p></th><th><p>Abrupt change in Q<sub>ref</sub> only</p></th></tr><tr><th><p>Sp &gt; Sq</p></th><th><p>Sp = Sq</p></th><th><p>Sp &lt; Sq</p></th></tr><tr><th colspan="3"><p>Optimum Value</p></th></tr></thead><tbody><tr><td><p><italic>w</italic><sub>p</sub></p></td><td><p>(0.8–0.1)</p></td><td><p>1</p></td><td><p>1</p></td></tr><tr><td><p><italic>w</italic><sub>q</sub></p></td><td><p>1</p></td><td><p>1</p></td><td><p>(0.2–0.04)</p></td></tr></tbody></table></table-wrap></p><p id="Par104">As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, when the algorithm detects an abrupt change in P<sub>ref</sub> while Q<sub>ref</sub> has no change (Sp &gt; Sq), the weight factor <italic>w</italic><sub>p</sub> is reduced to alleviate the disturbance that occurred on the Q loop from the P loop, while the weight factor <italic>w</italic><sub>q</sub> is kept constant at unity.</p><p id="Par105">Similarly, when the algorithm detects an abrupt change in the Q<sub>ref</sub> signal while P<sub>ref</sub> has no change (Sq &gt; Sp), the weight factor <italic>w</italic><sub>p</sub> is kept constant at unity, while <italic>w</italic><sub>q</sub> is reduced to alleviate the disturbance that occurred on the P loop from the Q loop.</p><p id="Par106">This paper proposes a simple and effective method of tuning the weight factors (<italic>w</italic><sub>p</sub> and <italic>w</italic><sub>q</sub>). The details of the proposed method, including the mathematical derivation of the proposed formulae of <italic>w</italic><sub>p</sub> and <italic>w</italic><sub>q</sub>, are presented in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>. The optimum values of <italic>w</italic><sub>p</sub> and <italic>w</italic><sub>q</sub> are plotted in Fig. <xref rid="Fig7" ref-type="fig">7</xref> (a) and (b), respectively.
<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Optimum values of weight factors of FCS-MPC cost function to minimize cross coupling during transient response. a. w<sub>p</sub> as a function of P<sub>ref. b.</sub> w<sub>q</sub> as a function of Q<sub>ref</sub></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig7_HTML.png" id="MO7"/></fig></p></sec><sec id="Sec14"><title>LVRT mode and modification of reference signals</title><p id="Par107">The inverter control scheme is incorporated with an LVRT option to make it compatible with modern grid integration regulations and standards such as VDE-AR-N 4120, IEC 62477–1 and IEEE 1547 [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR37">37</xref>].</p><p id="Par108">In cases of fault and occurrence of voltage sag, the LVRT mode is enabled. Hence, the LVRT subroutine determines the level of voltage sag, and the reference power signals (P<sub>ref</sub> and Q<sub>ref</sub>) are then computed such that the inverter injects a combination of active and reactive powers (or only reactive power) to the grid based on the actual value of the grid voltage sag (V<sub>sag</sub>), as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> (c). The flowchart of the LVRT subroutine illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref> (c) demonstrates that the numerical value of the active and reactive powers to be injected to the grid is considered as a function of (V<sub>sag</sub>). This relation is also presented as follows:
<disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">If</mml:mtext><mml:mspace width="0.25em"/><mml:mn>0.9</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>sag</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1.0</mml:mn><mml:mo>⇒</mml:mo><mml:mtext mathvariant="italic">Then</mml:mtext><mml:mspace width="0.25em"/><mml:mfenced open="{"><mml:mrow><mml:mspace width="0.25em"/><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Q</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mtext>rated</mml:mtext></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">If</mml:mtext><mml:mspace width="0.25em"/><mml:mn>0.5</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>sag</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>0.9</mml:mn><mml:mo>⇒</mml:mo><mml:mtext mathvariant="italic">Then</mml:mtext><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Q</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mtext>rated</mml:mtext></mml:msub><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>sag</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mn>16</mml:mn></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">P</mml:mi><mml:mtext>rated</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Q</mml:mi><mml:mi>ref</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">If</mml:mtext><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mi>sag</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn><mml:mo>⇒</mml:mo><mml:mtext mathvariant="italic">Then</mml:mtext><mml:mspace width="0.25em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">Q</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mtext>rated</mml:mtext></mml:msub><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{c}\begin{array}{c} If\ 0.9&lt;{\mathrm{V}}_{\mathrm{sag}}\le 1.0\Rightarrow Then\ \left\{\ \begin{array}{c}{\mathrm{Q}}_{\mathrm{ref}}=0\ \\ {}\\ {}{\mathrm{P}}_{\mathrm{ref}}={\mathrm{P}}_{\mathrm{rated}}\end{array}\ \right.\\ {}\\ {} If\ 0.5&lt;{\mathrm{V}}_{\mathrm{sag}}\le 0.9\Rightarrow Then\left\{\begin{array}{c}{\mathrm{Q}}_{\mathrm{ref}}=2\ {\mathrm{P}}_{\mathrm{rated}}\ \left(1-{\mathrm{V}}_{\mathrm{sag}}\right)\ \\ {}\ (16)\\ {}{\mathrm{P}}_{\mathrm{ref}}=\sqrt{{\mathrm{P}}_{\mathrm{rated}}^2-{\mathrm{Q}}_{\mathrm{ref}}^2}\ \end{array}\ \right.\end{array}\\ {}\\ {}\ If\ 0\le {\mathrm{V}}_{\mathrm{sag}}\le 0.5\Rightarrow Then\ \left\{\begin{array}{c}{\mathrm{Q}}_{\mathrm{ref}}={\mathrm{P}}_{\mathrm{rated}}\ \\ {}\\ {}{\mathrm{P}}_{\mathrm{ref}}=0\ \end{array}\ \right.\end{array}\right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_Equa.gif"/></alternatives></disp-formula></p><p id="Par109">In (16), the voltage sag is discriminated in three zones:
<list list-type="bullet"><list-item><p id="Par110">In the first zone, V<sub>sag</sub> is between 0.9 and 1, and the inverter injects only active power to the grid.</p></list-item><list-item><p id="Par111">In the second zone, V<sub>sag</sub> is between 0.5 and 0.9, and the inverter injects both active and reactive powers with fixed apparent power.</p></list-item><list-item><p id="Par112">In the third zone, V<sub>sag</sub> is below 0.5, and the inverter injects only reactive power to the grid with nil active power.</p></list-item></list></p><p id="Par113">Most developed countries have their own LVRT profiles, which the operation of modern grid-tied inverters should guarantee [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR38">38</xref>].</p></sec></sec><sec id="Sec15"><title>Simulation results</title><p id="Par114">The overall FCS-MPC system for a three-phase grid-tied string inverter was modelled and investigated in PSIM software®. The simulation parameters are summarised in Table <xref rid="Tab3" ref-type="table">3</xref>. The simulation platform is PSIM and the sampling time is 20 μs (sampling rate is 50 kHz). In this section, the simulation results are categorised in three groups:
<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Simulation parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Parameter</p></th><th><p>Value</p></th></tr></thead><tbody><tr><td><p>Simulation Platform</p></td><td><p>PSIM</p></td></tr><tr><td><p>MPC Sampling time T<sub>S</sub></p></td><td><p>20 μs</p></td></tr><tr><td><p>DC bus voltage V<sub>DC</sub></p></td><td><p>600 V</p></td></tr><tr><td><p>Grid inductor/phase Ls</p></td><td><p>3 mH</p></td></tr><tr><td><p>ESR/phase Rs</p></td><td><p>0.2 Ώ</p></td></tr><tr><td><p>RMS of grid Line voltage</p></td><td><p>380 V</p></td></tr><tr><td><p>Grid frequency</p></td><td><p>50 Hz</p></td></tr><tr><td><p>Peak output power of PV arrays</p></td><td><p>12.8 kW</p></td></tr></tbody></table></table-wrap></p><p id="Par115">(1) Steady-state performance of the elaborated FCS-MPC PQ system at normal operating conditions with quantitative assessment;</p><p id="Par116">(2) Transient response of the FCS-MPC PQ system at normal operating conditions with quantitative assessment;</p><p id="Par117">(3) Transient performance of LVRT under grid voltage sag.</p><sec id="Sec16"><title>Steady state performance</title><p id="Par118"><list list-type="alpha-lower"><list-item><p id="Par119"><bold>Unity PF Operation (P</bold><sub><bold>ref</bold></sub> <bold>= 10 kW, Q</bold><sub><bold>ref</bold></sub> <bold>= 0 VAR)</bold></p></list-item></list></p><p id="Par120">The steady state performance of the investigated 3-Φ grid-tied inverter system was studied for unity PF operation. The reference active power was set to 10 kW, and the reference reactive power was zero. The instantaneous values of the resultant P and Q and the current injected to the grid are plotted in Figs. <xref rid="Fig8" ref-type="fig">8</xref> (a), (b) and (c), respectively. As the reference reactive power was zero, the current injected to the grid was in-phase with the grid voltage. The results shown in Figs. <xref rid="Fig8" ref-type="fig">8</xref> (a) and (b) indicate that both P and Q were well controlled to their desired values. The corresponding harmonic spectra of P, Q and the grid current are illustrated in Figs. <xref rid="Fig9" ref-type="fig">9</xref> (a), (b) and (c), respectively.
<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Steady state response of FCS-MPC at unity PF operation (P<sub>ref</sub> = 10 kW, Q<sub>ref</sub> = 0 VAR). (<bold>a</bold>) Active power P; (<bold>b</bold>) Reactive power Q; (<bold>c</bold>) Grid phase voltage and current (V<sub>an</sub> &amp; i<sub>a</sub>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig8_HTML.png" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Harmonic spectra P, Q and i<sub>a</sub> injected to the grid at unity PF (P<sub>ref</sub> = 10 kW, Q<sub>ref</sub> = 0 VAR). (<bold>a</bold>) Spectrum of the active power P; (<bold>b</bold>) Spectrum of the reactive power Q; (<bold>c</bold>) Spectrum of grid current (i<sub>a</sub>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig9_HTML.png" id="MO9"/></fig></p><sec id="Sec17"><title>Quantitative analysis of steady state performance at unity PF</title><p id="Par121">The quantitative analysis of steady state performance was conducted, and the results are presented in Table <xref rid="Tab4" ref-type="table">4</xref>. The active power injected to the grid was 9.99 kW (desired reference value was 10 kW), while the reactive power was 68 VAR (desired reference value was zero VAR).
<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Quantitative assessment of steady state performance at Unity PF (P<sub>ref</sub> = 10 kW, Q<sub>ref</sub> = 0 VAR)</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"><p>Parameter</p></th><th><p>Value</p></th></tr><tr><th><p>Average value of active power</p></th><th><p>P<sub>AVG</sub> [W]</p></th><th><p>9990</p></th></tr></thead><tbody><tr><td><p>Worst value of active power ripple</p></td><td><p>∆P = (P<sub>ref</sub> - P<sub>actual</sub>) [W]</p></td><td><p>422</p></td></tr><tr><td><p>Percentage of active power ripple</p></td><td><p>100x∆P/P<sub>ref</sub>) [%]</p></td><td><p>4.22</p></td></tr><tr><td><p>Percentage of active power deviation</p></td><td><p>100 x (P<sub>ref</sub> - P<sub>AVG</sub>)/P<sub>ref</sub> [%]</p></td><td><p>0.10</p></td></tr><tr><td><p>Average value of reactive power</p></td><td><p>Q<sub>AVG</sub> [VAR]</p></td><td><p>68</p></td></tr><tr><td><p>Worst value of reactive power ripple</p></td><td><p>∆Q = (Q<sub>ref</sub> - Q<sub>actual</sub> [VAR]</p></td><td><p>529</p></td></tr><tr><td><p>Actual PF</p></td><td><p>Cos [tan<sup>−1</sup>(Q/P)]</p></td><td><p>0.999</p></td></tr><tr><td><p>Total harmonic distortion</p></td><td><p>THD of grid current [%]</p></td><td><p>3.35</p></td></tr></tbody></table></table-wrap></p><p id="Par122">However, it had negligible effect on the resultant PF (in this case, the actual PF was 0.999). Moreover, the computed THD of the grid current was 3.35%.
<list list-type="order"><list-item><p id="Par123"><bold>Zero PF Operation (P</bold><sub><bold>ref</bold></sub> <bold>= 0 W, Q</bold><sub><bold>ref</bold></sub> <bold>= 10 kVAR)</bold></p></list-item></list></p><p id="Par124">The steady-state performance of the FCS-MPS-MPC was investigated for a different operating scenario: the reference active power was zero, while the reference reactive power was − 10 kVAR. The instantaneous values of the corresponding P, Q and the current injected to the grid are depicted in Fig. <xref rid="Fig10" ref-type="fig">10</xref> (a), (b) and (c), respectively. The results indicated that P and Q were controlled to their desired values. As the reference active power was zero (Zero PF), the grid current <italic>i</italic><sub>a</sub> lagged the grid voltage by 90°, as seen in Fig. <xref rid="Fig10" ref-type="fig">10</xref> (c).
<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Steady state response of FCS-MPC at zero PF operation (P<sub>ref</sub> = 0 W, Q<sub>ref</sub> = 10 kVAR). (<bold>a</bold>) Active power P; (<bold>b</bold>) Reactive power Q; (<bold>c</bold>) Grid phase voltage and current (V<sub>an</sub> &amp; i<sub>a</sub>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig10_HTML.png" id="MO10"/></fig></p><p id="Par125">The corresponding harmonic spectra of P, Q and the grid current are depicted in Figs. <xref rid="Fig11" ref-type="fig">11</xref> (a), (b) and (c), respectively.
<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Harmonic spectra P, Q and i<sub>a</sub> injected to the grid at zero PF (P<sub>ref</sub> = 0 W, Q<sub>ref</sub> = 10 kVAR). (<bold>a</bold>) Spectrum of the active power P; (<bold>b</bold>) Spectrum of the reactive power Q; (<bold>c</bold>) Spectrum of grid current (i<sub>a</sub>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig11_HTML.png" id="MO11"/></fig></p></sec><sec id="Sec18"><title>Quantitative analysis of steady state performance at zero PF</title><p id="Par126">Quantitative analysis of the steady state performance was carried out, and the results are presented in Table <xref rid="Tab5" ref-type="table">5</xref>. The reactive power injected to the grid was 10.005 kVAR, while the active power was − 100.6 W. Again, this only had a small effect on the resultant PF (in this case, the actual PF was 0.01). The computed THD of the grid current was 3.12%.
<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Quantitative assessment of steady state performance at Zero PF (P<sub>ref</sub> = 0 W, Q<sub>ref</sub> = 10 kVAR)</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"><p>Parameter</p></th><th><p>Value</p></th></tr><tr><th><p>Average value of reactive power</p></th><th><p>Q<sub>AVG</sub> [VAR]</p></th><th><p>10,005</p></th></tr></thead><tbody><tr><td><p>Worst value of reactive power ripple</p></td><td><p>∆Q = (Q<sub>ref</sub> - Q<sub>actual</sub>) [VAR]</p></td><td><p>480</p></td></tr><tr><td><p>Percentage of reactive power ripple</p></td><td><p>100x∆Q/Q<sub>ref</sub>) [%]</p></td><td><p>4.80</p></td></tr><tr><td><p>Percentage of reactive power deviation</p></td><td><p>100 x (Q<sub>ref</sub> - Q<sub>AVG</sub>)/Q<sub>ref</sub> [%]</p></td><td><p>- 0.05</p></td></tr><tr><td><p>Average value of active power</p></td><td><p>P<sub>AVG</sub> [W]</p></td><td><p>−100.6</p></td></tr><tr><td><p>Worst value of active power ripple</p></td><td><p>∆P = (P<sub>ref</sub> - P<sub>actual</sub>) [W]</p></td><td><p>369</p></td></tr><tr><td><p>Actual PF</p></td><td><p>Cos (tan<sup>−1</sup>[Q/P)]</p></td><td><p>0.01</p></td></tr><tr><td><p>Total harmonic distortion</p></td><td><p>THD of grid current [%]</p></td><td><p>3.12</p></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec19"><title>Transient performance</title><p id="Par127"><list list-type="alpha-lower"><list-item><p id="Par128"><bold>Step change of P</bold><sub><bold>ref</bold></sub><bold>(0</bold> → <bold>10 kW) with Q</bold><sub><bold>ref</bold></sub> <bold>= 0 VAR</bold></p></list-item></list></p><p id="Par129">The transient performance of the FCS-MPC system was investigated for different operating scenarios. In this subsection, the reference active power P<sub>ref</sub> has a step change from 0 to 10 kW, while the reactive power reference Q<sub>ref</sub> is zero.</p><p id="Par130">The transient responses were studied with fixed as well as adjustable weight factors, and the results are illustrated in Figs. <xref rid="Fig12" ref-type="fig">12</xref> and <xref rid="Fig13" ref-type="fig">13</xref>, respectively.
<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>Transient response of FCS-MPC with fixed weight factors. (<bold>a</bold>) Active and reactive power. (<bold>b</bold>) Enlarged graph of reactive power. (<bold>c</bold>) weight factors; (<bold>d</bold>) Phase voltage and current</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig12_HTML.png" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>Transient response of FCS-MPC with variable weight factors. (<bold>a</bold>) Active and reactive power. (<bold>b</bold>) Enlarged graph of reactive power. (<bold>c</bold>) weight factors; (<bold>d</bold>) Phase voltage and current</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig13_HTML.png" id="MO13"/></fig></p><sec id="Sec20"><title>Quantitative analysis of step response of active power P<sub>ref</sub> (0 → 10 kW) with Q<sub>ref</sub> = 0 VAR</title><p id="Par131">A quantitative analysis was conducted of the transient response presented above, and the results are summarised in Table <xref rid="Tab6" ref-type="table">6</xref> for both FCS-MPC systems.
<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>Quantitative assessment of transient performance under step change of active power</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"><p>Mode of operation</p></th><th rowspan="2"><p>Parameter</p></th><th colspan="2"><p>Value</p></th></tr><tr><th><p>Fixed</p><p>weight factors</p></th><th><p>Variable</p><p>weight factors</p></th></tr></thead><tbody><tr><td rowspan="8"><p>Step change in active power</p><p>(P<sub>ref</sub>: 0 → 10 kW)</p><p>(Q<sub>ref</sub> is zero VAR)</p></td><td><p>Settling time [ms]</p></td><td><p>1.77</p></td><td><p>1.82</p></td></tr><tr><td><p>Max.│Cross coupling on Q│ [kVAR]</p></td><td><p>≅ 1.60</p></td><td><p>≅ 0.18</p></td></tr><tr><td><p>Peak overshoot of P</p></td><td><p>nil</p></td><td><p>nil</p></td></tr><tr><td><p>Weight factor <italic>w</italic><sub>p</sub></p></td><td><p>1</p></td><td><p>0.1</p></td></tr><tr><td><p>Weight factor <italic>w</italic><sub>q</sub></p></td><td><p>1</p></td><td><p>1</p></td></tr><tr><td><p>Steady state PF*</p></td><td><p>≅ 0.999</p></td><td><p>≅ 0.999</p></td></tr><tr><td><p>Worst PF during cross coupling</p></td><td><p>≅ 0.982</p></td><td><p>≅ 0.990</p></td></tr><tr><td><p>THD of current* [%]</p></td><td><p>≅ 3.350</p></td><td><p>≅ 3.350</p></td></tr></tbody></table><table-wrap-foot><p>*after settling time</p></table-wrap-foot></table-wrap></p><p id="Par132">As shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(a), the active power with fixed weight factors had a fast transient response with a settling time of less than 2 ms (1.77 ms). Similarly, the observed settling time in the case of variable weight factors was also less than 2 ms (1.82 ms), as illustrated in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(a).</p><p id="Par133">In addition, both FCS-MPC schemes did not produce overshoot for the active power.</p><p id="Par134">However, the reactive power component Q was negatively affected by the active power step change. The results indicated that the Q component was subjected to undesired cross coupling during the transient period in the case of the FCS-MPC scheme with fixed weight factors. This cross coupling on Q was approximately 1.6 kVAR and the time elapsed was 2 ms, as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(b).</p><p id="Par135">The results demonstrated that the proposed FCS-MPC scheme with variable weight factors effectively eliminates the cross coupling and successfully attenuates the disturbance to a negligible level during the transient period, as shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(a) and (b).</p><p id="Par136">Figure <xref rid="Fig12" ref-type="fig">12</xref>(c) indicates that the weight factors were fixed to unity in the case of the fixed weight factors, while with variable weight factors, the weight factor <italic>w</italic><sub>p</sub> (as depicted in.</p><p id="Par137">Figure <xref rid="Fig13" ref-type="fig">13</xref>(c)) was changed according to the adjustment rule previously addressed in both Table <xref rid="Tab2" ref-type="table">2</xref> and Fig. <xref rid="Fig7" ref-type="fig">7</xref> (a). The grid currents sketched in Figs. <xref rid="Fig12" ref-type="fig">12</xref>(d) and <xref rid="Fig13" ref-type="fig">13</xref>(d) indicate the successful operation of both schemes at unity PF during the transients. In addition, once the transient period had passed, both the fixed and variable weight factor schemes resulted in similar PF and THD of the current injected to the grid, as seen in Table <xref rid="Tab6" ref-type="table">6</xref>.
<list list-type="order"><list-item><p id="Par138"><bold>Step change of Q</bold><sub><bold>ref</bold></sub><bold>(0</bold> → <bold>10 kVAR) with P</bold><sub><bold>ref</bold></sub> <bold>= 0 W</bold></p></list-item></list></p><p id="Par139">In this subsection, the transient performance of the FCS-MPC system is investigated in another operating scenario. The reference active power P<sub>ref</sub> was set to zero, while the reactive power reference Q<sub>ref</sub> was step changed from 0 to 10 kVAR. The transient responses were investigated with fixed as well as adjustable weight factors, and the results are illustrated in Figs. <xref rid="Fig14" ref-type="fig">14</xref> and <xref rid="Fig15" ref-type="fig">15</xref>, respectively.
<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>Transient response of FCS-MPC with fixed weight factors. (<bold>a</bold>) Active and reactive power. (<bold>b</bold>) Enlarged graph of reactive power. (<bold>c</bold>) weight factors. (<bold>d</bold>) Phase voltage and current</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig14_HTML.png" id="MO14"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>Transient response of FCS-MPC with variable weight factors. (<bold>a</bold>) Active and reactive power. (<bold>b</bold>) Enlarged graph of reactive power. (<bold>c</bold>) weight factors. (<bold>d</bold>) Phase voltage and current</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig15_HTML.png" id="MO15"/></fig></p></sec><sec id="Sec21"><title>Quantitative analysis of step response of reactive power Q<sub>ref</sub> (0 → 10 kVAR) with P<sub>ref</sub> = 0 W</title><p id="Par140">As shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(a), the reactive power with the FCS-MPC system of fixed weight factors had a fast transient response with a settling time of less than 2 ms (1.57 ms).</p><p id="Par141">In the case of the FCS-MPC system with variable weight factors, the observed settling time was 0.42 ms (much less than the fixed weight factors case), as illustrated in Fig. <xref rid="Fig15" ref-type="fig">15</xref>(a).</p><p id="Par142">Both FCS-MPC schemes did not produce overshoot for the reactive power (as can be observed from Figs. <xref rid="Fig14" ref-type="fig">14</xref>(a) and <xref rid="Fig15" ref-type="fig">15</xref>(a)). However, the FCS-MPC system with fixed weight factors slightly undershot before the reactive power settled down around the reference value, as illustrated in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(a).</p><p id="Par143">In addition, the active power component P was negatively affected by the step change in the Q component.</p><p id="Par144">The results indicated that the P component was subjected to severe undesired cross coupling during the transient period in the case of the fixed weight factors. The active power drop was approximately 2.7 kW, and it elapsed in 1.8 ms, as shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(b).</p><p id="Par145">The results demonstrated that the proposed FCS-MPC scheme with variable weight factors effectively alleviates the cross coupling and successfully attenuates the disturbance to a negligible level during the transient period, as shown in Figs. <xref rid="Fig15" ref-type="fig">15</xref>(a) and (b).</p><p id="Par146">Figure <xref rid="Fig14" ref-type="fig">14</xref>(c) shows the unity weight factors for the fixed weight factors case, while in the case of variable weight factors, the weight factor <italic>w</italic><sub>q</sub> was changed, as depicted in Fig. <xref rid="Fig15" ref-type="fig">15</xref>(c), according to the adjustment rule previously addressed in Table <xref rid="Tab2" ref-type="table">2</xref> and Fig. <xref rid="Fig7" ref-type="fig">7</xref> (b).</p><p id="Par147">The waveforms of the grid current sketched in Figs. <xref rid="Fig14" ref-type="fig">14</xref>(d) and <xref rid="Fig15" ref-type="fig">15</xref>(d) indicate the successful operation of both schemes at zero PF during the transients.</p><p id="Par148">Once the transient period had passed, both schemes (fixed and variable weight factors) resulted in similar PF and THD of the current injected to the grid, as seen in Table <xref rid="Tab7" ref-type="table">7</xref>.
<table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Quantitative assessment of transient performance under step change of reactive power</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"><p>Mode of operation</p></th><th rowspan="2"><p>Parameter</p></th><th colspan="2"><p>Value</p></th></tr><tr><th><p>Fixed</p><p>weight factors</p></th><th><p>Variable</p><p>weight factors</p></th></tr></thead><tbody><tr><td rowspan="8"><p>Step change in reactive power</p><p>(Q<sub>ref</sub> 0 → 10 kVAR)</p><p>(P<sub>ref</sub> is zero W)</p></td><td><p>Settling time [ms]</p></td><td><p>1.57</p></td><td><p>0.42</p></td></tr><tr><td><p>Max. │cross coupling on P│ [kW]</p></td><td><p>≅ 2.70</p></td><td><p>≅ 0.01</p></td></tr><tr><td><p>Peak overshoot of Q</p></td><td><p>nil</p></td><td><p>nil</p></td></tr><tr><td><p>Weight factor <italic>w</italic><sub>p</sub></p></td><td><p>1</p></td><td><p>1</p></td></tr><tr><td><p>Weight factor <italic>w</italic><sub>q</sub></p></td><td><p>1</p></td><td><p>0.04</p></td></tr><tr><td><p>Steady state PF (after settling time)</p></td><td><p>≅ 0.010</p></td><td><p>≅ 0.010</p></td></tr><tr><td><p>Worst PF during cross coupling</p></td><td><p>≅ 0.269</p></td><td><p>≅ 0.011</p></td></tr><tr><td><p>THD of current (after settling time) [%]</p></td><td><p>≅ 3.120</p></td><td><p>≅ 3.120</p></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec22"><title>LVRT mode of the FCS-MPC system under grid voltage sag</title><p id="Par149">The proposed FCS-MPC PQ control scheme is incorporated with an LVRT mode so that it withstands grid voltage sag for a short duration (determined by standard LVRT profiles) to be consistent with the up-to-date grid code standards [<xref ref-type="bibr" rid="CR27">27</xref>].</p><p id="Par150">The operational scenario depends on the level of voltage sag, as explained in Section 3.6 and shown in the flowchart of Fig. <xref rid="Fig6" ref-type="fig">6</xref> (c). The first part of Section 4.3 presents an emulation of grid fault and voltage sag based on a standard LVRT profile. The LVRT profile is presented in Fig. <xref rid="Fig16" ref-type="fig">16</xref>(a), and the corresponding grid voltage sag is plotted in Fig. <xref rid="Fig16" ref-type="fig">16</xref>(b).
<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>LVRT mode of FCS-MPC PQ control scheme</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig16_HTML.png" id="MO16"/></fig></p><p id="Par151">Consequently, the FCS-MPC PQ control unit generates the suitable reference active and reactive powers P<sub>ref</sub> and Q<sub>ref</sub> based on (16), as illustrated in Figs. <xref rid="Fig16" ref-type="fig">16</xref>(c) and (d), respectively. The second part of Section 4.3 illustrates the transient response of the FCS-MPC schemes under grid voltage sag. Figures <xref rid="Fig17" ref-type="fig">17</xref> and <xref rid="Fig18" ref-type="fig">18</xref> present the LVRT performance of the FCS-MPC PQ scheme with fixed and variable weight factors, respectively. Both groups of results prove that the FCS-MPC PQ scheme provides quick response and is able to enhance the LVRT capability of a grid-tied string inverter such that the LVRT option incorporated with the inverter control scheme is consistent with grid codes and standards.
<fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p>LVRT of FCS-MPC with fixed weight factors. a. Active power P. b. Reactive power Q. c. Grid current ia. d. steady state grid currents</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig17_HTML.png" id="MO17"/></fig><fig id="Fig18"><label>Fig. 18</label><caption xml:lang="en"><p>LVRT of FCS-MPC with variable weight factors. a. Active power P. b. Reactive power Q. c. Grid current i<sub>a. d.</sub> steady state grid currents</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_204_Fig18_HTML.png" id="MO18"/></fig></p></sec></sec><sec id="Sec23" sec-type="conclusions"><title>Conclusion</title><p id="Par152">In this paper, an FCS-MPC approach was used to control the operation of a three-phase grid-tied string inverter based on the concept of direct PQ control, providing a decoupled control of both active and reactive powers injected to the grid from the DER.</p><p id="Par153">The cross-coupling problem associated with PQ control loops during transient operation was addressed and investigated, and an efficient method to minimise the undesired cross coupling between the P and Q control loops was proposed. The attenuation of cross coupling was achieved by varying the weight factors of the FCS-MPC cost function during the transient period.</p><p id="Par154">The proposed method can be considered as a feedforward-tuning scheme for weight factors. In addition, the paper deduced empirical formulae to compute and tune the optimum weight factors as functions of reference active and reactive power signals. The relevant mathematical derivations were also presented. Results prove the validity and effectiveness of the proposed method with regard to the attenuation and alleviation of undesired cross coupling between the P and Q components.</p><p id="Par155">The study involved both steady state and transient performances of the FCS-MPC scheme under variable operating scenarios, such as unity PF and zero PF operations. In addition, qualitative and quantitative analyses of the obtained results were carried out.</p><p id="Par156">The elaborated FCS-MPC scheme inherently provided the LVRT mode, as requested by the updated grid codes and standards. The concept of a decoupled PQ control approach was applied to inject the necessary active and reactive powers to the grid during grid faults by modifying the instantaneous reference active and reactive powers based on the instantaneous grid voltage.</p><p id="Par157">The results indicated that the adopted method was successful and able to support the LVRT capability of a grid-tied string inverter.</p><p id="Par158">The results demonstrate the capability of the FCS-MPC approach in achieving a high-performance DER grid integration system that can be operated with different operating conditions, including fault mode</p></sec></body><back><ack><title>Acknowledgements</title><sec><p>The author is grateful to Mr. Bahaaeldin M. A. Moustafa, from Nile University (NU-Egypt) for his effort to download the needed references of the paper. The author is also grateful to Dr. Ali Abou-Sena, from Karlsruhe Institute of Technology (KIT-Germany) for his effort in revising the English language of this paper.</p></sec><sec id="FPar1"><title>List of Symbols</title><p id="Par903"><italic>V</italic><sub><italic>DC</italic></sub> DC bus voltage</p><p id="Par904"><italic>U</italic><sub><italic>S</italic></sub> Inverter voltage space vector</p><p id="Par905"><italic>e</italic><sub><italic>an</italic></sub> Grid voltage of phase <italic>a</italic></p><p id="Par906"><italic>e</italic><sub><italic>bn</italic></sub> Grid voltage of phase <italic>b</italic></p><p id="Par907"><italic>e</italic><sub><italic>cn</italic></sub> Grid voltage of phase <italic>c</italic></p><p id="Par908"><italic>e</italic><sub><italic>α</italic></sub> Grid voltage component of α-axis of (α−β) stationary reference frame</p><p id="Par909"><italic>e</italic><sub><italic>β</italic></sub> Grid voltage component of β-axis of (α−β) stationary reference frame</p><p id="Par910"><italic>V</italic><sub><italic>an</italic></sub> Inverter o/p voltage of phase <italic>a</italic></p><p id="Par911"><italic>V</italic><sub><italic>bn</italic></sub> Inverter o/p voltage of phase <italic>b</italic></p><p id="Par912"><italic>V</italic><sub><italic>cn</italic></sub> Inverter o/p voltage of phase <italic>c</italic></p><p id="Par913"><italic>U</italic><sub><italic>α</italic></sub> Inverter o/p voltage component of α-axis of (α−β) stationary reference frame</p><p id="Par914"><italic>U</italic><sub><italic>β</italic></sub> Inverter o/p voltage component of β-axis of (α−β) stationary reference frame</p><p id="Par915"><italic>L</italic><sub><italic>S</italic></sub> Per-phase grid filter inductor</p><p id="Par916"><italic>R</italic><sub><italic>S</italic></sub> Per-phase ESR of inductor L<sub>S</sub></p><p id="Par917"><italic>i</italic><sub><italic>a</italic></sub> grid current of phase <italic>a</italic></p><p id="Par918"><italic>i</italic><sub><italic>b</italic></sub> grid current of phase <italic>b</italic></p><p id="Par919"><italic>i</italic><sub><italic>c</italic></sub> grid current of phase <italic>c</italic></p><p id="Par920"><italic>i</italic><sub><italic>α</italic></sub> Grid current component of α-axis of (α−β) stationary reference frame</p><p id="Par921"><italic>i</italic><sub><italic>β</italic></sub> Grid current component of β-axis of (α−β) stationary reference frame</p><p id="Par922"><inline-formula id="IEq1"><alternatives><mml:math display="inline" id="IEq1_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {i}_a^{k+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq1.gif"/></alternatives></inline-formula> Predicted current of phase <italic>a</italic> at sample (k+1)</p><p id="Par923"><inline-formula id="IEq2"><alternatives><mml:math display="inline" id="IEq2_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {i}_b^{k+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq2.gif"/></alternatives></inline-formula> Predicted current of phase <italic>b</italic> at sample (k+1)</p><p id="Par924"><inline-formula id="IEq3"><alternatives><mml:math display="inline" id="IEq3_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {i}_c^{k+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq3.gif"/></alternatives></inline-formula> Predicted current of phase <italic>c</italic> at sample (k+1)</p><p id="Par925"><inline-formula id="IEq4"><alternatives><mml:math display="inline" id="IEq4_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {i}_{\alpha}^{k+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq4.gif"/></alternatives></inline-formula> Predicted current component of α-axis at sample (k+1)</p><p id="Par926"><inline-formula id="IEq5"><alternatives><mml:math display="inline" id="IEq5_Math"><mml:msubsup><mml:mi>i</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {i}_{\beta}^{k+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_204_Article_IEq5.gif"/></alternatives></inline-formula> Predicted current component of β-axis at sample (k+1)</p><p id="Par927"><italic>T</italic><sub><italic>S</italic></sub> Sampling period of MPC algorithm</p><p id="Par928"><italic>t</italic><sub><italic>d</italic></sub> Time delay of reference signal</p><p id="Par929"><italic>k</italic> Sample number k</p><p id="Par930"><italic>i</italic> Switching state number (0 → 6)</p><p id="Par931"><italic>P</italic> Inst. value of active power injected to the grid</p><p id="Par932"><italic>Q</italic> Inst. value of reactive power injected to the grid</p><p id="Par933"><italic>P</italic><sup><italic>k</italic> + 1</sup> Predicted value of active power at sample (k+1)</p><p id="Par934"><italic>P</italic><sub><italic>ref</italic></sub> Reference value of active power to be injected to grid</p><p id="Par935"><italic>Q</italic><sup><italic>k</italic> + 1</sup> Predicted value of reactive power at sample (k+1)</p><p id="Par936"><italic>Q</italic><sub><italic>ref</italic></sub> Reference value of reactive power to be injected to grid</p><p id="Par937"><italic>J</italic> Cost function of FCS-MPC</p><p id="Par938"><italic>J</italic><sub><italic>i</italic></sub> Cost function corresponding to switching state <italic>i</italic></p><p id="Par939"><italic>J</italic><sub><italic>i</italic></sub> (k+1) Cost function at the sample (k+1) corresponding to inverter switching state <italic>i</italic></p><p id="Par940"><italic>w</italic><sub><italic>p</italic></sub>, <italic>w</italic><sub><italic>q</italic></sub> Weight factors of MPC cost function</p><p id="Par941"><italic>δ</italic><sub><italic>p</italic></sub> Absolute error between reference and delayed reference active power signals</p><p id="Par942"><italic>δ</italic><sub><italic>q</italic></sub> Absolute error between reference and delayed reference reactive power signals</p><p id="Par943"><italic>V</italic><sub><italic>sag</italic></sub> Per unit value of grid voltage sag</p></sec></ack><sec sec-type="author-contribution"><title>Author’s contributions</title><p>The article has been prepared and edited by a single author “Mohamed Azab” who carried out all tasks of the article. English language revision has been carried out by a colleague from Karlsruhe Institute of Technology (KIT) and the final draft has been revised by a professional proofreading office “Paper True”. The author(s) read and approved the final manuscript.</p></sec><sec><title>Funding</title><p>This research did not receive any external funding.</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>Not applicable.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar4" sec-type="COI-statement"><title>Competing interests</title><p id="Par161">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafti</surname><given-names>HD</given-names></name><name><surname>Maswood</surname><given-names>AI</given-names></name><name><surname>Konstantinou</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Active/reactive power control of photovoltaic grid-tied inverters with peak current limitation and zero active power oscillation during unbalanced voltage sags</article-title><source>IET Power Electron</source><year>2018</year><volume>11</volume><issue>6</issue><fpage>1066</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1049/iet-pel.2017.0210</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Caldognetto</surname><given-names>T</given-names></name><name><surname>Buso</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Review and comparison of grid-tied inverter controllers in microgrids</article-title><source>IEEE Trans Power Electron</source><year>2020</year><volume>35</volume><issue>7</issue><fpage>7624</fpage><lpage>7639</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2957975</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Errouissi</surname><given-names>R</given-names></name><name><surname>Al-Durra</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A novel control technique for grid-tied inverters considering unbalanced grid voltage conditions and control input saturation</article-title><source>IEEE Transact Sustainable Energy</source><year>2019</year><volume>10</volume><issue>4</issue><fpage>2223</fpage><lpage>2234</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2018.2883863</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">S. Sang, N. Gao, X. Cai, <italic>et. al</italic>., “A novel power-voltage control strategy for the grid-tied inverter to raise the rated power injection level in a weak grid,” <ext-link xlink:href="https://ieeexplore.ieee.org/xpl/RecentIssue.jsp?punumber=6245517" ext-link-type="uri">IEEE J Emerg Selected Topics Power Electronics</ext-link>, vol. 6, no.1, pp. 219–232, 2018, DOI: <ext-link xlink:href="10.1109/JESTPE.2017.2715721" ext-link-type="doi">https://doi.org/10.1109/JESTPE.2017.2715721</ext-link>.</mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busada</surname><given-names>CA</given-names></name><name><surname>Jorge</surname><given-names>SG</given-names></name><name><surname>Solsona</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Resonant current controller with enhanced transient response for grid-tied inverters</article-title><source>IEEE Trans Ind Electron</source><year>2018</year><volume>65</volume><issue>4</issue><fpage>2935</fpage><lpage>2944</lpage><pub-id pub-id-type="doi">10.1109/TIE.2017.2750614</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">X. Huang, K. Wang, B. Fan, <italic>et. al.</italic>, “Robust current control of grid-tied inverters for renewable energy integration under non-ideal grid conditions,” <ext-link xlink:href="https://ieeexplore.ieee.org/xpl/RecentIssue.jsp?punumber=5165391" ext-link-type="uri">IEEE Transact Sustainable Energy</ext-link>, vol. 11, no. 1, pp. 477–488, 2020, DOI: <ext-link xlink:href="10.1109/TSTE.2019.2895601" ext-link-type="doi">https://doi.org/10.1109/TSTE.2019.2895601</ext-link>.</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">G. Sun , Y. Li, W. Jin, <italic>et. al</italic>., “A novel low voltage ride-through technique of three-phase grid-connected inverters based on a nonlinear phase-locked loop,” <ext-link xlink:href="https://ieeexplore.ieee.org/xpl/RecentIssue.jsp?punumber=6287639" ext-link-type="uri">IEEE Access</ext-link>, vol. 7, pp. 66609–66622, 2019, DOI: <ext-link xlink:href="10.1109/ACCESS.2019.2912859" ext-link-type="doi">https://doi.org/10.1109/ACCESS.2019.2912859</ext-link>.</mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jain</surname><given-names>S</given-names></name><name><surname>Shadmand</surname><given-names>MB</given-names></name><name><surname>Balog</surname><given-names>RS</given-names></name></person-group><article-title xml:lang="en">Decoupled active and reactive power predictive control for PV applications using a grid-tied quasi-Z-source inverter</article-title><source>IEEE J Emerg Selected Top Power Electronics</source><year>2018</year><volume>6</volume><issue>4</issue><fpage>1769</fpage><lpage>1782</lpage><pub-id pub-id-type="doi">10.1109/JESTPE.2018.2823904</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mojallal</surname><given-names>A</given-names></name><name><surname>Lotfifard</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Enhancement of grid connected PV arrays fault ride through and post fault recovery performance</article-title><source>IEEE Transact Smart Grid</source><year>2019</year><volume>10</volume><issue>1</issue><fpage>546</fpage><lpage>555</lpage><pub-id pub-id-type="doi">10.1109/TSG.2017.2748023</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Y. Geng, K. Yang, Z. Lai, <italic>et. al</italic>., “A novel low voltage ride through control method for current source grid-connected photovoltaic inverters,” IEEE Access, vol. 7, pp. 51735–51748, 2019, DOI: <ext-link xlink:href="10.1109/ACCESS.2019.2911477" ext-link-type="doi">https://doi.org/10.1109/ACCESS.2019.2911477</ext-link>.</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">I. Sefa, S. Ozdemir, H. Komurcugil, <italic>et. al</italic>., “An enhanced Lyapunov-function based control scheme for three-phase grid-tied VSI with LCL filter,” IEEE Transact Sustainable Energy, vol. 10, no. 2, pp. 504–513, 2019, DOI: <ext-link xlink:href="10.1109/TSTE.2018.2833809" ext-link-type="doi">https://doi.org/10.1109/TSTE.2018.2833809</ext-link>.</mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">A. Merabet, L. Labib, A. M. Y. M. Ghias, <italic>et. al</italic>., “Robust feedback linearizing control with sliding mode compensation for a grid-connected photovoltaic inverter system under unbalanced grid voltages,” IEEE J Photovoltaics, vol. 7, no. 3, pp. 828–838, 2017, DOI: <ext-link xlink:href="10.1109/JPHOTOV.2017.2667724" ext-link-type="doi">https://doi.org/10.1109/JPHOTOV.2017.2667724</ext-link>.</mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="other">Y. Cao, Q. Zhao, Y. Ye, <italic>et. al</italic>., “ADRC-based current control for grid-tied inverters: Design, analysis, and verification,” IEEE Transactions on Industrial Electronics, Early Access, 2019. (DOI: <ext-link xlink:href="10.1109/TIE.2019.2949513" ext-link-type="doi">https://doi.org/10.1109/TIE.2019.2949513</ext-link>.</mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Afshari</surname><given-names>E</given-names></name><name><surname>Moradi</surname><given-names>GR</given-names></name><name><surname>Rahimi</surname><given-names>R</given-names></name><name><surname>Farhangi</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name><name><surname>Farhangi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Control strategy for three-phase grid-connected PV inverters enabling current limitation under unbalanced faults</article-title><source>IEEE Transactions on Indus Elect</source><year>2017</year><volume>64</volume><issue>11</issue><fpage>8908</fpage><lpage>8918</lpage><pub-id pub-id-type="doi">10.1109/TIE.2017.2733481</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sochor</surname><given-names>P</given-names></name><name><surname>Tan</surname><given-names>NML</given-names></name><name><surname>Akagi</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Low-voltage-ride-through control of a modular multilevel Single-Delta bridge-cell (SDBC) inverter for utility-scale photovoltaic systems</article-title><source>IEEE Trans Ind Appl</source><year>2018</year><volume>54</volume><issue>5</issue><fpage>4739</fpage><lpage>4751</lpage><pub-id pub-id-type="doi">10.1109/TIA.2018.2845893</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Xiong</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Discrete-time modified UDE-based current control for LCLLCL-type grid-tied inverters</article-title><source>IEEE Trans Ind Electron</source><year>2020</year><volume>67</volume><issue>3</issue><fpage>2143</fpage><lpage>2154</lpage><pub-id pub-id-type="doi">10.1109/TIE.2019.2902829</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>T</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Hui</surname><given-names>SYR</given-names></name></person-group><article-title xml:lang="en">A general design procedure for multi-parallel modular grid-tied inverters system to prevent common and interactive instability</article-title><source>IEEE Trans Power Electron</source><year>2019</year><volume>34</volume><issue>7</issue><fpage>6025</fpage><lpage>6030</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2890842</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez-Estévez</surname><given-names>D</given-names></name><name><surname>Doval-Gandoy</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Grid-tied inverter with AC voltage Sensorless synchronization and soft start</article-title><source>IEEE Trans Ind Appl</source><year>2019</year><volume>55</volume><issue>5</issue><fpage>4920</fpage><lpage>4933</lpage><pub-id pub-id-type="doi">10.1109/TIA.2019.2921707</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahela</surname><given-names>OP</given-names></name><name><surname>Gupta</surname><given-names>N</given-names></name><name><surname>Khosravy</surname><given-names>M</given-names></name><etal/></person-group><article-title xml:lang="en">Comprehensive overview of low voltage ride through methods of grid integrated wind generator</article-title><source>IEEE Access</source><year>2019</year><volume>7</volume><fpage>99299</fpage><lpage>99326</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2019.2930413</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">“Technical requirements for the connection and operation of customer installations to the high-voltage network (draft version),” VDE-AR-N 4120:2017–05, May 2017.</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bak</surname><given-names>Y</given-names></name><name><surname>Lee</surname><given-names>JS</given-names></name><name><surname>Lee</surname><given-names>KB</given-names></name></person-group><article-title xml:lang="en">Low-voltage ride-through control strategy for a grid-connected energy storage system</article-title><source>J Appl Sci</source><year>2018</year><volume>8</volume><issue>57</issue><fpage>1</fpage><lpage>18</lpage></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buso</surname><given-names>S</given-names></name><name><surname>Caldognetto</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name></person-group><article-title xml:lang="en">Analysis and experimental characterization of a large-bandwidth triple-loop controller for grid-tied inverters</article-title><source>IEEE Trans Power Electron</source><year>2019</year><volume>34</volume><issue>2</issue><fpage>1936</fpage><lpage>1949</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2018.2835158</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>PP</given-names></name><name><surname>Chattopadhyay</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A voltage-independent islanding detection method and low-voltage ride through of a two-stage PV inverter</article-title><source>IEEE Trans Ind Appl</source><year>2018</year><volume>54</volume><issue>3</issue><fpage>2773</fpage><lpage>2783</lpage><pub-id pub-id-type="doi">10.1109/TIA.2017.2788433</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>YW</given-names></name><etal/></person-group><article-title xml:lang="en">A distributed power control of series-connected module-integrated inverters for PV grid-tied applications</article-title><source>IEEE Trans Power Electron</source><year>2018</year><volume>33</volume><issue>9</issue><fpage>7698</fpage><lpage>7707</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2769487</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasanien</surname><given-names>HM</given-names></name></person-group><article-title xml:lang="en">An adaptive control strategy for low voltage ride through capability enhancement of grid-connected photovoltaic power plants</article-title><source>IEEE Trans Power Syst</source><year>2016</year><volume>31</volume><issue>4</issue><fpage>3230</fpage><lpage>3237</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2015.2466618</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Reactive power injection strategies for single-phase photovoltaic systems considering grid requirements</article-title><source>IEEE Trans Ind Appl</source><year>2014</year><volume>50</volume><issue>6</issue><fpage>4065</fpage><lpage>4076</lpage><pub-id pub-id-type="doi">10.1109/TIA.2014.2346692</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>D</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Implementation of fault ride-through techniques of grid-connected inverter for distributed energy resources with adaptive low-pass notch PLL</article-title><source>IEEE Trans Power Electron</source><year>2015</year><volume>30</volume><issue>5</issue><fpage>2859</fpage><lpage>2871</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2014.2378792</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>D</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Huang</surname><given-names>AQ</given-names></name></person-group><article-title xml:lang="en">Integration of DC microgrids as virtual synchronous machines into the AC grid</article-title><source>IEEE Trans Ind Electron</source><year>2017</year><volume>64</volume><issue>9</issue><fpage>7455</fpage><lpage>7466</lpage><pub-id pub-id-type="doi">10.1109/TIE.2017.2674621</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sosa</surname><given-names>JL</given-names></name><name><surname>Castilla</surname><given-names>M</given-names></name><name><surname>Miret</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Control strategy to maximize the power capability of PV three-phase inverters during voltage sags</article-title><source>IEEE Trans Power Electron</source><year>2016</year><volume>31</volume><issue>4</issue><fpage>3314</fpage><lpage>3323</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2015.2451674</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">F. El Aamri, H. Maker, D. Sera, <italic>et. al</italic>., “A direct maximum power point tracking method for single-phase grid-connected PV inverters,” IEEE Trans Power Electron, vol. 33, no. 10, pp. 8961–8971, 2018, DOI: <ext-link xlink:href="10.1109/TPEL.2017.2780858" ext-link-type="doi">https://doi.org/10.1109/TPEL.2017.2780858</ext-link>.</mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><collab>IEEE Application Guide for IEEE Standard 1547, IEEE Standard for Interconnecting Distributed Resources with Electric Power Systems</collab></person-group><source>IEEE standard 1547 2–2008</source><year>2009</year><fpage>1</fpage><lpage>207</lpage></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>G</given-names></name><name><surname>Gao</surname><given-names>F</given-names></name><name><surname>Tian</surname><given-names>H</given-names></name><name><surname>Ma</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>G</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Adaptive DC-link voltage control of two-stage photovoltaic inverter during low voltage ride-through operation</article-title><source>IEEE Trans Power Electron</source><year>2016</year><volume>31</volume><issue>6</issue><fpage>4182</fpage><lpage>4194</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2015.2469603</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elazab</surname><given-names>OS</given-names></name><name><surname>Debouza</surname><given-names>M</given-names></name><name><surname>Hasanien</surname><given-names>HM</given-names></name><etal/></person-group><article-title xml:lang="en">Salp swarm algorithm-based optimal control scheme for LVRT capability improvement of grid-connected photovoltaic power plants: Design and experimental validation</article-title><source>IET Renewable Power Generation</source><year>2020</year><volume>14</volume><issue>4</issue><fpage>591</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg.2019.0726</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajeev</surname><given-names>M</given-names></name><name><surname>Agarwal</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Low Voltage Ride-Through Capability of a Novel Grid Connected Inverter Suitable for Transformer-less solar PV grid interface</article-title><source>IEEE Transactions Industry Applications Early Access</source><year>2020</year><volume>56</volume><issue>3</issue><fpage>2799</fpage><lpage>2806</lpage><pub-id pub-id-type="doi">10.1109/TIA.2020.2979134</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Commission Regulation (EU) 2016/631 of 14 April 2016 establishing a network code on requirements for grid connection of generators, pp. 1–68, 2016.</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Islam</surname><given-names>MM</given-names></name><name><surname>Hossain</surname><given-names>E</given-names></name><name><surname>Padmanaban</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">A new perspective of wind power grid codes under unbalanced and distorted grid conditions</article-title><source>IEEE Access</source><year>2020</year><volume>8</volume><fpage>15931</fpage><lpage>15944</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2020.2966907</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><collab>IEEE</collab></person-group><source>Approved Draft Standard Conformance Test Procedures for Equipment Interconnecting Distributed Energy Resources with Electric Power Systems and Associated Interfaces</source><year>2020</year><fpage>1</fpage><lpage>283</lpage><comment>IEEE P1547.1/D9.9–2020</comment></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Din</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>Y</given-names></name><etal/></person-group><article-title xml:lang="en">Impact of grid impedance on LVRT performance of DFIG system with rotor crowbar technology</article-title><source>IEEE Access</source><year>2019</year><volume>7</volume><fpage>127999</fpage><lpage>128008</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2019.2938207</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohapatra</surname><given-names>SR</given-names></name><name><surname>Agarwal</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Model predictive controller with reduced complexity for grid-tied multilevel inverters</article-title><source>IEEE Trans Ind Electron</source><year>2019</year><volume>66</volume><issue>11</issue><fpage>8851</fpage><lpage>8855</lpage><pub-id pub-id-type="doi">10.1109/TIE.2018.2866115</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Azab</surname><given-names>M</given-names></name></person-group><source>“A finite control set model predictive control scheme for single-phase grid-connected inverters,” Renewable and Sustainable Energy Reviews, vol. 135, article 110131, Jan</source><year>2021</year><comment>Elsevier publisher</comment></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>K</given-names></name><name><surname>Feng</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Finite control set model predictive control with feedback correction for power converters</article-title><source>CES Transactions on Electrical Machines and Systems</source><year>2018</year><volume>2</volume><issue>3</issue><fpage>312</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.30941/CESTEMS.2018.00039</pub-id></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lekouagheta</surname><given-names>B</given-names></name><name><surname>Boukaboua</surname><given-names>A</given-names></name><name><surname>Lourcib</surname><given-names>N</given-names></name><etal/></person-group><article-title xml:lang="en">Control of PV grid connected systems using MPC technique and different inverter configuration models</article-title><source>Electric Power Syst Res J</source><year>2017</year><volume>154</volume><fpage>287</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1016/j.epsr.2017.08.027</pub-id></mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>TH</given-names></name><name><surname>Kim</surname><given-names>KH</given-names></name></person-group><article-title xml:lang="en">Finite control set–model predictive control with modulation to mitigate harmonic component in output current for a grid-connected inverter under distorted grid conditions</article-title><source>Energies J</source><year>2017</year><volume>10</volume><issue>7</issue><fpage>1</fpage><lpage>25</lpage></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">O. Machado, P. Martín, F. J. Rodríguez, <italic>et. al</italic>., “A neural network-based dynamic cost function for the implementation of a predictive current controller,” IEEE Transact Industrial Informatics, 13, 6, 2946–2955, 2017, DOI: <ext-link xlink:href="10.1109/TII.2017.2691461" ext-link-type="doi">https://doi.org/10.1109/TII.2017.2691461</ext-link>.</mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falkowski</surname><given-names>P</given-names></name><name><surname>Sikorski</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Finite control set model predictive control for grid-connected AC–DC converters with LCL filter</article-title><source>IEEE Trans Ind Electron</source><year>2018</year><volume>65</volume><issue>4</issue><fpage>2844</fpage><lpage>2852</lpage><pub-id pub-id-type="doi">10.1109/TIE.2017.2750627</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norambuena</surname><given-names>M</given-names></name><name><surname>Lezana</surname><given-names>P</given-names></name><name><surname>Rodriguez</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">A method to eliminate steady-state error of model predictive control in power electronics</article-title><source>IEEE J Emerg Selected Topics Power Electronics</source><year>2019</year><volume>7</volume><issue>4</issue><fpage>2525</fpage><lpage>2530</lpage><pub-id pub-id-type="doi">10.1109/JESTPE.2019.2894993</pub-id></mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragičević</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Model predictive control of power converters for robust and fast operation of AC microgrids</article-title><source>IEEE Trans Power Electron</source><year>2018</year><volume>33</volume><issue>7</issue><fpage>6304</fpage><lpage>6317</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2744986</pub-id></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="other">M. Aguirre, S. Kouro, C. A. Rojas, et. al., “Switching frequency regulation for FCS-MPC based on a period control approach,” IEEE Trans Ind Electron, vol. 65, no. 7, pp. 5764–5773, 2018, DOI: <ext-link xlink:href="10.1109/TIE.2017.2777385" ext-link-type="doi">https://doi.org/10.1109/TIE.2017.2777385</ext-link>.</mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="other">P. Acuna, R. P. Aguilera, A. M. Y. M. Ghias, et. al., “Cascade-free model predictive control for single-phase grid-connected power converters,” IEEE Trans Ind Electron, 64, 1, 285–294, 2017, DOI: <ext-link xlink:href="10.1109/TIE.2016.2599478" ext-link-type="doi">https://doi.org/10.1109/TIE.2016.2599478</ext-link>.</mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Tan</surname><given-names>S</given-names></name><name><surname>Hui</surname><given-names>SYR</given-names></name></person-group><article-title xml:lang="en">Adaptive reference model predictive control with improved performance for voltage-source inverters</article-title><source>IEEE Trans Control Syst Technol</source><year>2018</year><volume>26</volume><issue>2</issue><fpage>724</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1109/TCST.2017.2670529</pub-id></mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Judewicz</surname><given-names>MG</given-names></name><name><surname>González</surname><given-names>SA</given-names></name><name><surname>Echeverría</surname><given-names>NI</given-names></name><etal/></person-group><article-title xml:lang="en">Generalized predictive current control (GPCC) for grid-tie three-phase inverters</article-title><source>IEEE Trans Ind Electron</source><year>2016</year><volume>63</volume><issue>7</issue><fpage>4475</fpage><lpage>4484</lpage><pub-id pub-id-type="doi">10.1109/TIE.2015.2508934</pub-id></mixed-citation></ref><ref id="CR52"><label>52.</label><mixed-citation publication-type="other">C. F. Garcia, M. E. Rivera, J. R. Rodríguez, <italic>et. al</italic>., “Predictive current control with instantaneous reactive power minimization for a four-leg indirect matrix converter,” IEEE Trans Ind Electron, vol. 64, no. 2, pp. 922–929, 2017, DOI: <ext-link xlink:href="10.1109/TIE.2016.2610939" ext-link-type="doi">https://doi.org/10.1109/TIE.2016.2610939</ext-link>.</mixed-citation></ref><ref id="CR53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baidya</surname><given-names>R</given-names></name><name><surname>Aguilera</surname><given-names>RP</given-names></name><name><surname>Acuna</surname><given-names>P</given-names></name><etal/></person-group><article-title xml:lang="en">Multistep model predictive control for cascaded H bridge inverters: Formulation and analysis</article-title><source>IEEE Trans Power Electron</source><year>2018</year><volume>33</volume><issue>1</issue><fpage>876</fpage><lpage>886</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2670567</pub-id></mixed-citation></ref><ref id="CR54"><label>54.</label><mixed-citation publication-type="other">Y. G. Du, J. Wu, S. Y. Li, <italic>et. al</italic>., “Distributed MPC for coordinated energy efficiency utilization in microgrid systems,” IEEE Trans Smart Grid, 10, 2, 1781–1790, 2019, DOI: <ext-link xlink:href="10.1109/TSG.2017.2777975" ext-link-type="doi">https://doi.org/10.1109/TSG.2017.2777975</ext-link>.</mixed-citation></ref><ref id="CR55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Shadmand</surname><given-names>MB</given-names></name><etal/></person-group><article-title xml:lang="en">Model predictive control of a voltage source inverter with seamless transition between islanded and grid-connected operations</article-title><source>IEEE Trans on Ind Elects</source><year>2017</year><volume>64</volume><issue>10</issue><fpage>7906</fpage><lpage>7918</lpage><pub-id pub-id-type="doi">10.1109/TIE.2017.2696459</pub-id></mixed-citation></ref><ref id="CR56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>XJ</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Lee</surname><given-names>KY</given-names></name></person-group><article-title xml:lang="en">Coordinated distributed MPC for load frequency control of power system with wind farms</article-title><source>IEEE Trans Ind Electron</source><year>2017</year><volume>64</volume><issue>6</issue><fpage>5140</fpage><lpage>5150</lpage><pub-id pub-id-type="doi">10.1109/TIE.2016.2642882</pub-id></mixed-citation></ref><ref id="CR57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>HA</given-names></name><name><surname>Perez</surname><given-names>MA</given-names></name><name><surname>Rodriguez</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Analysis of finite-control-set model predictive current control with model parameter mismatch in a three-phase inverter</article-title><source>IEEE Transactions on Indus. Elect.</source><year>2016</year><volume>63</volume><issue>5</issue><fpage>3100</fpage><lpage>3107</lpage><pub-id pub-id-type="doi">10.1109/TIE.2016.2515072</pub-id></mixed-citation></ref><ref id="CR58"><label>58.</label><mixed-citation publication-type="other">M. Tomlinson, H. T. Mouton, R. Kennel, et.al., “A fixed switching frequency scheme for finite-control-set model predictive control concept and algorithm,” IEEE Transact Industrial Electronics, 63, 12, 7662–7670, 2016, DOI: <ext-link xlink:href="10.1109/TIE.2016.2593997" ext-link-type="doi">https://doi.org/10.1109/TIE.2016.2593997</ext-link>.</mixed-citation></ref><ref id="CR59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nauman</surname><given-names>M</given-names></name><name><surname>Hasan</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Efficient implicit model-predictive control of a three-phase inverter with an output LC filter</article-title><source>IEEE Transact Power Electron</source><year>2016</year><volume>31</volume><issue>9</issue><fpage>6075</fpage><lpage>6078</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2016.2535263</pub-id></mixed-citation></ref><ref id="CR60"><label>60.</label><mixed-citation publication-type="other">H. T. Nguyen, E. K. Kim, I. P. Kim, et. al., “Model predictive control with modulated optimal vector for a three-phase inverter with an LC filter,” IEEE Trans Power Electronics, vol. 33, no. 3, pp. 2690–2703, 2018, DOI: <ext-link xlink:href="10.1109/TPEL.2017.2694049" ext-link-type="doi">https://doi.org/10.1109/TPEL.2017.2694049</ext-link>.</mixed-citation></ref><ref id="CR61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guzman</surname><given-names>R</given-names></name><name><surname>de Vicuña</surname><given-names>LG</given-names></name><name><surname>Camacho</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Receding-horizon model-predictive control for a three-phase VSI with an LCL filter</article-title><source>IEEE Trans Ind Electron</source><year>2019</year><volume>66</volume><issue>9</issue><fpage>6671</fpage><lpage>6680</lpage><pub-id pub-id-type="doi">10.1109/TIE.2018.2877094</pub-id></mixed-citation></ref><ref id="CR62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>T</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Su</surname><given-names>T</given-names></name><etal/></person-group><article-title xml:lang="en">Model predictive voltage control based on finite control set with computation time delay compensation for PV systems</article-title><source>IEEE Transactions on Energy Conversion</source><year>2019</year><volume>34</volume><issue>1</issue><fpage>330</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1109/TEC.2018.2876619</pub-id></mixed-citation></ref><ref id="CR63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Dragičević</surname><given-names>T</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Current-Sensorless finite-set model predictive control for LC-filtered voltage source inverters</article-title><source>IEEE Trans Power Electron</source><year>2020</year><volume>35</volume><issue>1</issue><fpage>1086</fpage><lpage>1095</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2914452</pub-id></mixed-citation></ref><ref id="CR64"><label>64.</label><mixed-citation publication-type="other">H. Zheng, J. Wu, W. Wu, <italic>et. al</italic>., “Integrated motion and powertrain predictive control of intelligent fuel cell/battery hybrid vehicles,” IEEE Transact Industrial Informatics, 16, 5, 3397–3406, 2020, DOI: <ext-link xlink:href="10.1109/TII.2019.2956209" ext-link-type="doi">https://doi.org/10.1109/TII.2019.2956209</ext-link>.</mixed-citation></ref><ref id="CR65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Bi</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Model predictive-based shared control for brain-controlled driving</article-title><source>IEEE Trans Intell Transp Syst</source><year>2020</year><volume>21</volume><issue>2</issue><fpage>630</fpage><lpage>640</lpage><pub-id pub-id-type="doi">10.1109/TITS.2019.2897356</pub-id></mixed-citation></ref><ref id="CR66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zarei</surname><given-names>ME</given-names></name><name><surname>Ramírez</surname><given-names>D</given-names></name><name><surname>Nicolas</surname><given-names>CV</given-names></name><etal/></person-group><article-title xml:lang="en">Three-phase four-switch converter for SPMS generators based on model predictive current control for wave energy applications</article-title><source>IEEE Trans Power Electron</source><year>2020</year><volume>35</volume><issue>1</issue><fpage>289</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2911209</pub-id></mixed-citation></ref><ref id="CR67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Guerrero</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">Multi-objective optimal model predictive control for three-level ANPC grid-connected inverter</article-title><source>IEEE Access</source><year>2020</year><volume>8</volume><fpage>59590</fpage><lpage>59598</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2020.2981996</pub-id></mixed-citation></ref><ref id="CR68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Wen</surname><given-names>H</given-names></name><name><surname>Fan</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Xie</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Norambuena</surname><given-names>M</given-names></name><name><surname>Rodriguez</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Multiple-voltage-vector model predictive control with reduced complexity for multilevel inverters</article-title><source>IEEE Transactions on Transportation Electrification</source><year>2020</year><volume>6</volume><issue>1</issue><fpage>105</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1109/TTE.2020.2973045</pub-id></mixed-citation></ref><ref id="CR69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karamanakos</surname><given-names>P</given-names></name><name><surname>Geyer</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Guidelines for the Design of Finite Control set Model Predictive Controllers</article-title><source>IEEE Trans Power Electron</source><year>2020</year><volume>35</volume><issue>7</issue><fpage>7434</fpage><lpage>7450</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2954357</pub-id></mixed-citation></ref><ref id="CR70"><label>70.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>L</given-names></name><name><surname>Jin</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><etal/></person-group><source>“A model predictive control method for grid-connected power converters without AC voltage sensors,” IEEE Transactions on Industrial Electronics</source><year>2020</year><pub-id pub-id-type="doi">10.1109/TIE.2020.2970638</pub-id></mixed-citation></ref><ref id="CR71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>F</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Ye</surname><given-names>T</given-names></name><etal/></person-group><article-title xml:lang="en">Design of Hybrid Control Algorithm for fault ride-through of photovoltaic system</article-title><source>IEEE Access</source><year>2019</year><volume>7</volume><fpage>124196</fpage><lpage>124206</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2019.2937845</pub-id></mixed-citation></ref><ref id="CR72"><label>72.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>HT</given-names></name><name><surname>Kim</surname><given-names>E</given-names></name><name><surname>Kim</surname><given-names>I</given-names></name><name><surname>Choi</surname><given-names>HH</given-names></name><name><surname>Jung</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Model predictive control with modulated optimal vector for a three-phase inverter with an LC filter</article-title><source>IEEE Transactions on Power Electronics</source><year>2018</year><fpage>2690</fpage><lpage>2703</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2694049</pub-id><comment>3</comment></mixed-citation></ref><ref id="CR73"><label>73.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rauf</surname><given-names>U</given-names></name><name><surname>Schütt</surname><given-names>M</given-names></name><name><surname>Eckel</surname><given-names>H</given-names></name></person-group><source>"Model Predictive Control for Space Vector Modulation of a Three-Level ANPC Inverter for Efficient Loss Distribution and Neutral Point Balancing," 2019 21st European Conference on Power Electronics and Applications (EPE '19 ECCE Europe), Genova, Italy</source><year>2019</year><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.23919/EPE.2019.8915514</pub-id></mixed-citation></ref><ref id="CR74"><label>74.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">On the inherent relationship between finite control set model predictive control and SVM-based deadbeat control for power converters</article-title><source>2017 IEEE energy conversion congress and exposition (ECCE), Cincinnati, OH</source><year>2017</year><fpage>4628</fpage><lpage>4633</lpage><pub-id pub-id-type="doi">10.1109/ECCE.2017.8096791</pub-id></mixed-citation></ref><ref id="CR75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><etal/></person-group><article-title xml:lang="en">New insights into model predictive control for three-phase power converters</article-title><source>IEEE Trans Ind Appl</source><year>2019</year><volume>55</volume><issue>2</issue><fpage>1973</fpage><lpage>1982</lpage><pub-id pub-id-type="doi">10.1109/TIA.2018.2873505</pub-id></mixed-citation></ref><ref id="CR76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caseiro</surname><given-names>LMA</given-names></name><name><surname>Mendes</surname><given-names>AMS</given-names></name><name><surname>Cruz</surname><given-names>SMA</given-names></name></person-group><article-title xml:lang="en">Dynamically weighted optimal switching vector model predictive control of power converters</article-title><source>IEEE Trans Ind Electron</source><year>2019</year><volume>66</volume><issue>2</issue><fpage>1235</fpage><lpage>1245</lpage><pub-id pub-id-type="doi">10.1109/TIE.2018.2829689</pub-id></mixed-citation></ref><ref id="CR77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Tan</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">A new geometric vector optimization of predictive direct power control</article-title><source>IEEE Trans Power Electron</source><year>2020</year><volume>35</volume><issue>5</issue><fpage>5427</fpage><lpage>5436</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2944626</pub-id></mixed-citation></ref><ref id="CR78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azab</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Intra-minutes technical impacts of PV grid integration on distribution network operation of a rural community under extreme PV power delivery</article-title><source>J Energy Syst</source><year>2020</year><volume>11</volume><fpage>213</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1007/s12667-018-0307-7</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec24"><title>Supplementary Information</title><p id="Par162"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/41601_2021_204_MOESM1_ESM.docx" position="anchor"><caption xml:lang="en"><p><bold>Additional file 1.</bold></p></caption></media></supplementary-material></p></sec></app></app-group><glossary><title>Abbreviations</title><def-list><def-item><term>ESR</term><def><p id="Par5">Equivalent series resistance</p></def></def-item><def-item><term>DER</term><def><p id="Par6">Distributed energy resources</p></def></def-item><def-item><term>DSP</term><def><p id="Par7">Digital signal processor</p></def></def-item><def-item><term>FCS-MPC</term><def><p id="Par8">Finite control set model predictive control</p></def></def-item><def-item><term>HIL</term><def><p id="Par9">Hardware in the loop</p></def></def-item><def-item><term>KVL</term><def><p id="Par10">Kirchhoff voltage law</p></def></def-item><def-item><term>MPC</term><def><p id="Par11">Model predictive control</p></def></def-item><def-item><term>LVRT</term><def><p id="Par12">Low voltage ride through</p></def></def-item><def-item><term>kW</term><def><p id="Par13">Kilo Watt</p></def></def-item><def-item><term>PCC</term><def><p id="Par14">Point of common coupling</p></def></def-item><def-item><term>PF</term><def><p id="Par15">Power Factor</p></def></def-item><def-item><term>PI</term><def><p id="Par16">Proportional integral controller</p></def></def-item><def-item><term>PLL</term><def><p id="Par17">Phase locked loop</p></def></def-item><def-item><term>SVM</term><def><p id="Par18">Space vector modulation</p></def></def-item><def-item><term>PV</term><def><p id="Par19">Photovoltaic</p></def></def-item><def-item><term>PU</term><def><p id="Par20">Per unit</p></def></def-item><def-item><term>V<sub>sag</sub></term><def><p id="Par21">Per unit value of grid voltage sag</p></def></def-item><def-item><term>THD</term><def><p id="Par22">Total harmonic distortion</p></def></def-item><def-item><term>VSI</term><def><p id="Par23">Voltage source inverter</p></def></def-item><def-item><term>VAR</term><def><p id="Par24">Volt-ampere reactive</p></def></def-item><def-item><term>3-Φ</term><def><p id="Par25">Three-Phase</p></def></def-item></def-list></glossary></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Active power</facet-value><facet-value count="1">Distributed generation</facet-value><facet-value count="1">FCS-MPC</facet-value><facet-value count="1">Finite control set</facet-value><facet-value count="1">Grid-connected inverter</facet-value><facet-value count="1">Low voltage ride through</facet-value><facet-value count="1">LVRT</facet-value><facet-value count="1">Model predictive control</facet-value><facet-value count="1">PQ theory</facet-value><facet-value count="1">Reactive power</facet-value></facet><facet name="pub"><facet-value count="1">Protection and Control of Modern Power Systems</facet-value></facet><facet name="year"><facet-value count="1">2021</facet-value></facet><facet name="country"><facet-value count="1">Egypt</facet-value><facet-value count="1">Saudi Arabia</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
