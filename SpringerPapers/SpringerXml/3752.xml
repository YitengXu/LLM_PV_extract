<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41598-021-82537-1</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41598</journal-id><journal-id journal-id-type="doi">10.1038/41598.2045-2322</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title><abbrev-journal-title abbrev-type="publisher">Sci Rep</abbrev-journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41598-021-82537-1</article-id><article-id pub-id-type="manuscript">82537</article-id><article-id pub-id-type="doi">10.1038/s41598-021-82537-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/704/172/4081</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/166/987</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/631/158</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">System design for inferring colony-level pollination activity through miniature bee-mounted sensors</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><name><surname>Abdel-Raziq</surname><given-names>Haron M.</given-names></name><address><email>hma49@cornell.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41598021825371_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Palmer</surname><given-names>Daniel M.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Koenig</surname><given-names>Phoebe A.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Molnar</surname><given-names>Alyosha C.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Petersen</surname><given-names>Kirstin H.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution content-type="org-division">Department of Electrical and Computer Engineering</institution><institution content-type="org-name">Cornell University</institution></institution-wrap><addr-line content-type="postcode">14850</addr-line><addr-line content-type="city">Ithaca</addr-line><addr-line content-type="state">NY</addr-line><country country="US">USA</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution content-type="org-division">Department of Entomology</institution><institution content-type="org-name">Cornell University</institution></institution-wrap><addr-line content-type="postcode">14850</addr-line><addr-line content-type="city">Ithaca</addr-line><addr-line content-type="state">NY</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><corresp id="IDs41598021825371_cor1"><label>a</label><email>hma49@cornell.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>2</month><year>2021</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2021</year></pub-date><volume>11</volume><issue seq="4239">1</issue><elocation-id>4239</elocation-id><history><date date-type="registration"><day>22</day><month>1</month><year>2021</year></date><date date-type="received"><day>5</day><month>8</month><year>2020</year></date><date date-type="accepted"><day>6</day><month>1</month><year>2021</year></date><date date-type="online"><day>19</day><month>2</month><year>2021</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">In digital agriculture, large-scale data acquisition and analysis can improve farm management by allowing growers to constantly monitor the state of a field. Deploying large autonomous robot teams to navigate and monitor cluttered environments, however, is difficult and costly. Here, we present methods that would allow us to leverage managed colonies of honey bees equipped with miniature flight recorders to monitor orchard pollination activity. Tracking honey bee flights can inform estimates of crop pollination, allowing growers to improve yield and resource allocation. Honey bees are adept at maneuvering complex environments and collectively pool information about nectar and pollen sources through thousands of daily flights. Additionally, colonies are present in orchards before and during bloom for many crops, as growers often rent hives to ensure successful pollination. We characterize existing Angle-Sensitive Pixels (ASPs) for use in flight recorders and calculate memory and resolution trade-offs. We further integrate ASP data into a colony foraging simulator and show how large numbers of flights refine system accuracy, using methods from robotic mapping literature. Our results indicate promising potential for such agricultural monitoring, where we leverage the superiority of social insects to sense the physical world, while providing data acquisition on par with explicitly engineered systems.</p></abstract><funding-group><award-group><funding-source><institution-wrap><institution>NSF Cyber-Physical Systems Program</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">739671</award-id><principal-award-recipient><name><surname>Abdel-Raziq</surname><given-names>Haron M.</given-names></name><name><surname>Palmer</surname><given-names>Daniel M.</given-names></name><name><surname>Koenig</surname><given-names>Phoebe A.</given-names></name><name><surname>Molnar</surname><given-names>Alyosha C.</given-names></name><name><surname>Petersen</surname><given-names>Kirstin H.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>GETTYLABS</institution></institution-wrap></funding-source></award-group><award-group><funding-source><institution-wrap><institution>Packard Fellowships for Science and Engineering</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Portfolio</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>4239</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>22</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41598_2021_Article_82537.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Approximately 75% of flowering plants require some degree of animal pollination, including many economically important agricultural crops<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Global reliance on crop pollination is expanding, yet growers world-wide suffer from increasingly unpredictable yields due to dwindling populations of wild pollinators and unsustainable losses of managed bees<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. With some crops, including many apple varietals, having an effective pollination period of only 2 days<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, even a slight lag in pollinator performance has immediate impacts on yield, and access to information about the state of pollination would allow growers to add pollination services when it is economical. Detecting the presence of small flowers and spurious pollination events in large fields, however, is a task far beyond the current state of the art in autonomous robots<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Here, we propose a novel methodology that enables use of managed colonies of <italic>Apis mellifera</italic>, the Western honey bee, equipped with miniature flight recorders to form inexpensive mobile sensor networks asynchronously gathering, sharing, and refining large pools of environmental information (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Honey bees are the premiere agricultural pollinator, contributing more than 150B USD to the global economy annually, with an estimated 2.4 M colonies in the U.S. alone<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Honey bees are ideal for field monitoring: individual bees can adeptly navigate and locate flowers in complex environments, and colonies of bees can efficiently survey large areas while remaining robust to noise and partial losses<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. First, we engineer a novel, mm-scale sensor technology based on Angle-Sensitive Pixels (ASPs)<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> that can provide coarse trajectory tracking while meeting the strict size and weight constraints posed by the small honey bee body size and carrying capacity (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Second, we combine trajectory data processing and Bayesian estimation techniques to translate this coarse data from many bee flights into refined foraging activity maps. To test our methodology, we implemented a comprehensive foraging simulator based on parameters gathered from literature on honey bees (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), physical orchards, and real sensor calibration.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p>(<bold>a</bold>) Overview of the proposed system to monitor pollination activity through instrumented colonies of managed honey bees. (<bold>b</bold>) Proposed flight recorder chip layout, shown on the right, based on ASP technology, exemplified on the left. (<bold>c</bold>) Table summarizing relevant data pertaining to the Western honey bee.<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR53">53</xref></sup></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par3">The current trend in digital agriculture includes crop monitoring with semi-autonomous ground vehicles and drones, navigating and inspecting fields through a suite of sensors such as GPS, light detection and ranging (LIDAR), cameras, and inertial measurement units, and data analysis through multi-modal processing<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Although these approaches are promising for large and structured fields, robotic monitoring of small scale and temporally brief events in large, cluttered environments is difficult and prohibitively expensive. We have yet to see an autonomous system capable of estimating crop pollination state until after fruit onset. Instead, directly tapping into the abilities and knowledge of the relatively inexpensive insects that perform pollination services is tempting, and previous works have proposed both bio-mimetic<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> and bio-hybrid solutions; the latter ranging from training<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and tracking<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, to indirect control<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and direct control<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. The notion of robotic and cyborg insects is promising in an engineering context, but it has not yet been practically feasible to produce long term autonomous behavior. Indirect control in social insects has been shown through automatic positive reward trainers or by mimicking existing animal communication signals<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>. These are promising means to influence foraging activity, however, these systems do not measure where the bees actually forage.</p><p id="Par4">Tracking bees directly enables estimation of foraging locations, and indirectly, the location and pollination state of blooms. To track bees, researchers have proposed RFID tags with both passive and active transmission<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>, harmonic radar<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, and LIDAR<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. RFID technology suffers from short communication range, and harmonic radar and LIDAR require line-of-sight and expensive equipment. More recently, localization of bumble bees using RF backscatter was demonstrated in a soccer field<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Although smaller scale and more portable than many of the aforementioned methods, this system is restricted by the RF communication range and the volume and weight of the electronics is too large for honey bees.</p><p id="Par5">In this paper, we focus on tracking honey bee foragers to estimate pollination activity in an orchard. Rather than instrumenting the landscape, we propose inexpensive flight recorders glued to the thoraxes of the bees allowing an estimated tracking distance of up to 4 km without regard for line-of-sight. Future enhancement of our flight recorder can provide even further tracking distances. These recorders periodically collect and store information on heading during flight, which is then read using backscatter communication at the hive entrance. To minimize size and weight, and thereby impact on forager behavior, we propose implementing the flight recorder in a millimeter-scale application specific integrated circuit (ASIC) complete with photovoltaic cells for power harvesting, sensors and processing circuitry, a timing clock, and memory. Central to our hypothesis is the use of ASPs to reconstruct the flight path. Through metal gratings, these pixels achieve sensitivity to incident angle of light, on the ASIC itself, without the need for any added lenses or other optical elements. With arrays of differently-oriented ASPs, we can measure the bees’ heading with respect to the sun at fixed intervals using microwatts of power<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. We can use these data along with a motion model to reconstruct the foraging flight and feeding locations. This sampling technique is expected to suffer from quantization error and lost samples due to power dips in shaded regions, but since colonies can conduct tens of thousands of foraging flights per day and bees repeatedly visit the same bloom areas, we show how accumulated data can be processed to generate improved foraging activity maps.</p><p id="Par6">Foraging activity maps may be advantageous for several reasons. Currently, pollination rates are only evident at fruit onset, when it is too late to intervene. Access to real-time foraging activity maps would permit quick and informed intervention. Honey bees are uncontrollable and may have periods of low activity or preference to other fields from where they are deployed. Knowledge about where they forage could help mitigate this loss of pollination, for example, by deploying additional biological or artificial pollinators. Previous research has shown that in apple and pear orchards, higher honey bee flower visitation rates correlate with higher fruit set, seed set, fruit-sugar content, and even increased profits<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Additionally, knowing when and where pollination events take place could inform better pesticide use, and potentially aid studies of disease transmission and the design of pollinator-friendly agricultural landscapes.</p></sec><sec id="Sec2" sec-type="materials|methods"><title>Materials and methods</title><sec id="Sec3"><title>Miniature flight recorders</title><p id="Par7">Honey bees regularly carry a payload of 55–65 mg<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, but a mounted flight recorder should consume only a small fraction of this allowable weight to avoid significantly affecting bee behavior. The dimensions of the recorder must also be small, as the available mounting area on the bee thorax is limited. We propose a flight recorder consisting of a <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>0.3</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 2\times 0.3\,\text {mm}^3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq1.gif"/></alternatives></inline-formula> ASIC mounted on a <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>0.4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times 3\times 0.4\,\text {mm}^3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq2.gif"/></alternatives></inline-formula> printed circuit board, which is similar in size to 3 mm diameter, 1.5 mm tall conventional bee tags (“Queen number set,” Betterbee) and is on par with previous studies using honey bee tagging methods<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The ASIC provides most core functionality including signal detection, memory, power harvesting, and communications circuitry, and the PCB provides a magnetic backscatter coil for near-field wireless communication. The combined weight of our chip-PCB assembly is expected to be at most 10 mg, which is a small fraction of the honey bee payload (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Based on previous studies, we expect this may slightly reduce foraging trip time but not significantly impact flight characteristics, which is the focus of our system<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Furthermore, future iterations of our flight recorder will have smaller size and weight, minimizing the overall impact on honey bees. Power will be harvested from sunlight, which can provide intensity greater than 1 mW/mm<inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq3.gif"/></alternatives></inline-formula>. On-chip photovoltaics can offer power conversion efficiency on the order of 5%, supplying 50 μW of electrical power for the chip. This power budget, while low, is sufficient for the chip, since solar angle measurement and storage of data in memory are not energy-intensive operations and need only occur a few times per second. Furthermore, wireless communication for data upload is only used when the recorder is at the base station, thus allowing the base station to fully power the near-field wireless link. Additionally, IC technology is generally robust to the environmental factors likely to be encountered by honey bees. For instance, the variations in humidity level and temperature experienced by honey bees are not expected to affect chip operation. Our proposed design is a fully power-autonomous, environmentally-robust, miniature flight recorder well-suited to the task of recording honey bee activity.</p><p id="Par8">The orientation of a bee during flight can be described by the <italic>yaw</italic> (<inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq4.gif"/></alternatives></inline-formula>), which represents the absolute heading relative to the sun, and the <italic>angle-of-incidence (AOI)</italic> (<inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi>ψ</mml:mi></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq5.gif"/></alternatives></inline-formula>), which represents the overhead angle between the sun and the sensor (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). To record flights, the chip uses ASPs to measure the AOI of sunlight and stores these measurements in on-chip memory. ASPs achieve AOI-sensitivity via a pair of diffraction gratings stacked over a photodiode (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), wherein the first grating induces a diffraction pattern that shifts laterally across the second grating as AOI is swept, thus passing a periodically-varying intensity of light to the photodiode. The stored AOI measurements can be downloaded to a base station upon return to the hive, and from these data the heading throughout the flight can be extracted. Assuming a constant speed of 6.5 m/s<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, we can use the sequence of recorded headings to reconstruct the honey bee’s trajectory in post-processing.</p><p id="Par9">The data taken by the flight recorder will be subject to measurement errors, and these errors will manifest in the reconstructed trajectory. Here, we identify and explore methods to mitigate the primary sources of error. We posit that errors will stem primarily from finite heading measurement resolution, finite sampling rate, and random fluctuations in sampling rate (<italic>jitter</italic>). Each of these error sources can be suppressed through careful chip design, but improvements in these performance variables can only be made at the expense of larger chip area. For instance, the heading measurement resolution will increase if more ASPs are used to measure AOI, but each pixel consumes significant silicon area and contributes additional data that must be stored in memory. Increasing the sampling rate and decreasing sampling rate jitter requires that more measurements be stored if flight time is unchanged, thus increasing the chip area required for memory. The size of the chip is thus inversely related to the severity of the expected measurement error, and trade-offs between chip size and achievable precision should be examined. A smaller sensor is feasible if trajectory reconstruction performance requirements are relaxed; more stringent requirements will necessitate a larger chip that will increase the burden on the bee. If the relationship between final uncertainty in the reconstructed position of the bee and the core sensor specifications is understood, then chip-level performance goals can be formed based on trajectory-level precision requirements.</p><p id="Par10">To determine required heading resolution, sampling rate, and sampling rate jitter, we first describe the procedure to reconstruct trajectories. We define the timestep estimate <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq6.gif"/></alternatives></inline-formula> as the inverse of the sampling rate, and for known flight speed <italic>v</italic> the sequence of measured heading estimates <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\hat{\gamma }_0, \hat{\gamma }_1, ..., \hat{\gamma }_{n-1}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq7.gif"/></alternatives></inline-formula> can be mapped to position estimate <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mathbf {p}}_n = [\hat{x}_n, \, \hat{y}_n]^T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq8.gif"/></alternatives></inline-formula> as a function of discrete time index <italic>n</italic> via the motion model<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\mathbf {p}}_n = \sum _{i=0}^{n-1} v\, \mathbf {h}(\hat{\gamma }_i) \hat{\Delta t} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ1.gif"/></alternatives></disp-formula>where<bold> h</bold> is a unit vector pointing along the heading of the bee. Each sensor estimate of heading and timestep will be subject to errors, and by modeling these errors as additive white noise, we can evaluate a confidence region for each position estimate <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mathbf {p}}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq9.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a,b). Each analog heading measurement <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\gamma }_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq10.gif"/></alternatives></inline-formula> must be digitized for storage on-chip and will therefore suffer from quantization error, a form of rounding. We denote this error <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{\gamma ,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq11.gif"/></alternatives></inline-formula> and model it as a uniform random variable with variance <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq12.gif"/></alternatives></inline-formula> on the interval <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mrow><mml:mo>±</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm \frac{\Delta \gamma }{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq13.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi></mml:mrow></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq14.gif"/></alternatives></inline-formula> is the heading bin width. Furthermore, the timestep estimate <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq15.gif"/></alternatives></inline-formula> will be subject to random clock jitter that can be modeled as a Gaussian random variable <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{\Delta t,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq16.gif"/></alternatives></inline-formula> with variance <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq17.gif"/></alternatives></inline-formula>. In this model, we posit for simplicity that the random error in timing scales linearly in proportion to oscillator frequency, thus maintaining a fixed ratio of <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\Delta t}/\hat{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq18.gif"/></alternatives></inline-formula>. These measurement errors contribute random error to position estimate <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mathbf {p}}}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq19.gif"/></alternatives></inline-formula>, and thus each position estimate should be viewed as a random variable <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq20.gif"/></alternatives></inline-formula>. The confidence region surrounding <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mathbf {p}}}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq21.gif"/></alternatives></inline-formula> depends on the covariance matrix of <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {p}_n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq22.gif"/></alternatives></inline-formula>, and we evaluate these terms by first using the small-angle approximation to linearize the motion model with respect to <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{\gamma ,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq23.gif"/></alternatives></inline-formula>:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>⊥</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>⊥</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {p}_n = \sum _{i=0}^{n-1} v \, \mathbf {h}(\hat{\gamma }_i + \epsilon _{\gamma ,i}) (\hat{\Delta t}+\epsilon _{\Delta t, i}) &amp;\approx \sum _{i=0}^{n-1} v \, \left( \mathbf {h}(\hat{\gamma }_i) + \mathbf {h}^\perp (\hat{\gamma }_i)\epsilon _{\gamma ,i}\right) (\hat{\Delta t}+\epsilon _{\Delta t, i}) = \sum _{i=0}^{n-1} v \, \mathbf {h}(\hat{\gamma }_i)(\hat{\Delta t}+\epsilon _{\Delta t,i}) + \sum _{i=0}^{n-1} v \, \mathbf {h}^\perp (\hat{\gamma }_i)\epsilon _{\gamma ,i} (\hat{\Delta t} + \epsilon _{\Delta t, i}) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ2.gif"/></alternatives></disp-formula><fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p>(<bold>a</bold>) Sensor measurement errors produce confidence regions surrounding each estimated position shown in an example circular trajectory. (<bold>b</bold>) Zoomed-in view of confidence region at end of flight, with principle components shown. (<bold>c</bold>) The two directed standard deviations grow throughout the duration of the trajectory, and are bounded above and below by the directed standard deviations computed from the case of the straight-line trajectory. (<bold>d</bold>–<bold>f</bold>) Both directional standard deviations characterizing the final error region will depend on all three of the core sensor specs <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\Delta \gamma , \hat{\Delta t}, \sigma _{\Delta t}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq24.gif"/></alternatives></inline-formula>, and the max confidence region dimension will grow if these specs are relaxed. Plots were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig2_HTML.png" id="MO4"/></fig></p><p id="Par11">This approximation is valid if <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{\gamma ,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq25.gif"/></alternatives></inline-formula> is kept small, which can be guaranteed by keeping heading bin width <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq26.gif"/></alternatives></inline-formula> small. The covariance matrix of <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq27.gif"/></alternatives></inline-formula> is then given by<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Cov</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {Cov}(\mathbf {p}_n, \mathbf {p}_n) = \varvec{ \Sigma }_n \approx \sum _{i=0}^{n-1} R(\hat{{\gamma }}_{i}) \begin{bmatrix} v^2\sigma ^2_{\Delta t} &amp;{} 0 \\ 0 &amp;{} v^2\sigma ^2_{\gamma }(\sigma _{\Delta t}^2 + (\hat{\Delta t})^2) \end{bmatrix} {R^T({\hat{\gamma }}_i)} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ3.gif"/></alternatives></disp-formula>where <italic>R</italic> is the standard 2 × 2 rotation matrix (<xref ref-type="supplementary-material" rid="MOESM1">Appendix</xref>: Derivation of Trajectory Precision Equation). By the Central Limit Theorem, after a sufficient number of timesteps <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq29.gif"/></alternatives></inline-formula> will become Gaussian distributed. Thus, the confidence region will be an ellipse with major and minor axes spanned by the eigenvectors <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\mathbf {v}_1, \mathbf {v}_2\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq30.gif"/></alternatives></inline-formula> of <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Sigma }}_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq31.gif"/></alternatives></inline-formula>. The covariances of the confidence region along each of these axes are given by the eigenvalues <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\lambda _1, \lambda _2\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq32.gif"/></alternatives></inline-formula> of <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq33.gif"/></alternatives></inline-formula>, and directed standard deviations can then be defined as <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\sigma _1,\sigma _2\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq34.gif"/></alternatives></inline-formula>. A 99% confidence region for position estimate <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {\hat{p}}}_{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq35.gif"/></alternatives></inline-formula> is given by an ellipse with major and minor axes lengths <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{3\sigma _1\mathbf {v}_1, 3\sigma _2\mathbf {v}_2\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq36.gif"/></alternatives></inline-formula>. We therefore conclude that <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq38.gif"/></alternatives></inline-formula> are critical values defining achievable trajectory reconstruction precision.</p><p id="Par12">These <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq39.gif"/></alternatives></inline-formula>-bounds can be computed for any measured sequence of headings, but general upper and lower bounds for <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq41.gif"/></alternatives></inline-formula> across all possible trajectories can be derived from the <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq43.gif"/></alternatives></inline-formula> given by the case in which the bee flies in a straight line. In the straight-line case, the eigenvalues of <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq44.gif"/></alternatives></inline-formula> are given by <italic>n</italic> times the diagonal entries of the diagonal matrix in Eq. (<xref rid="Equ3" ref-type="disp-formula">3</xref>). The directed <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq45.gif"/></alternatives></inline-formula>-bounds are then<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>3</mml:mn><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mi>v</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 3\sigma _{1,n}^*= &amp; {} 3\sqrt{n} v \sigma _{\Delta t} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ4.gif"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>3</mml:mn><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mi>v</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 3\sigma _{2,n}^*= &amp; {} 3\sqrt{n} v \sigma _{\gamma }\sqrt{\sigma _{\Delta t}^2 + (\hat{\Delta t})^2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ5.gif"/></alternatives></disp-formula>For some values of <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\sigma _{\gamma }, \hat{\Delta t}, \sigma _{\Delta t}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq46.gif"/></alternatives></inline-formula>, <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _{1,n}^*$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq47.gif"/></alternatives></inline-formula> will be larger than <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _{2,n}^*$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq48.gif"/></alternatives></inline-formula>; for others, the converse will be true. These equations provide simple bounds on achievable reconstruction precision that are valid for any trajectory and can be computed from sensor characteristics. Since heading error <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{\gamma _i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq49.gif"/></alternatives></inline-formula> is uniformly distributed, heading variance <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq50.gif"/></alternatives></inline-formula> is defined by heading bin width <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi></mml:mrow></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq51.gif"/></alternatives></inline-formula>, and thus the reconstruction precision is defined by a core suite of sensor specifications: <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\Delta \gamma , \hat{\Delta t}, \sigma _{\Delta t}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq52.gif"/></alternatives></inline-formula>. An illustration of the trajectory reconstruction process, along with confidence regions, is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, as well as the relationship between reconstruction precision and each of the core chip specs.</p><p id="Par13">For a maximum specified chip sensing area, trajectory precision should be optimized through balanced allocation of area to solar AOI detection and to memory (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We evaluate the optimal area allocation by defining the standard deviation upper bound <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{max} = \max (3\sigma _{1,f}^*, 3\sigma _{2,f}^*)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq53.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _{1,f}^*$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _{2,f}^*$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq55.gif"/></alternatives></inline-formula> are the directed <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq56.gif"/></alternatives></inline-formula>-values computed from a straight-line trajectory that is long enough to completely fill the memory. If more area is spent on pixels for AOI detection, heading resolution can be increased, thus causing <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>σ</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq57.gif"/></alternatives></inline-formula> to be reduced and correspondingly lowering <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{2,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq58.gif"/></alternatives></inline-formula>. Conversely, if more area is spent on memory, measurements can be taken more frequently, and timestep and clock jitter can be reduced, thus reducing <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\Delta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq60.gif"/></alternatives></inline-formula>. This will cause <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{1,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq61.gif"/></alternatives></inline-formula> to decrease, but may cause an increase in <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{2,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq62.gif"/></alternatives></inline-formula> since less area is now available for heading sensors. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the upper bound <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{max}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq63.gif"/></alternatives></inline-formula> minimizes when the two counteracting variables <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{1,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{2,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq65.gif"/></alternatives></inline-formula> are equal, and this intersection point prescribes the optimal allocation of sensor area. Our proposed flight recorder features a 4 <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:msup><mml:mrow><mml:mi mathvariant="normal">mm</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {mm}^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq66.gif"/></alternatives></inline-formula> chip, which can offer sensing area of approximately 3 <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msup><mml:mrow><mml:mi mathvariant="normal">mm</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {mm}^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq67.gif"/></alternatives></inline-formula>. When this area is allocated optimally, the heading resolution is <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msup><mml:mn>2</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq68.gif"/></alternatives></inline-formula> and timestep is approximately 240 ms at timestep jitter of <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma _{\Delta t}/\Delta t = 0.03$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq69.gif"/></alternatives></inline-formula>. With these specifications, the maximum recordable trajectory length is approximately 4 km, with <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq70.gif"/></alternatives></inline-formula> uncertainty of <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2.4</mml:mn></mml:mrow></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 2.4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq71.gif"/></alternatives></inline-formula> m.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p>(<bold>a</bold>) Area usage is optimized where <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{1,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma ^*_{2,f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq73.gif"/></alternatives></inline-formula> cross, as this design point co-minimizes the two directional standard deviations characterizing trajectory precision. (<bold>b</bold>) This design point specifies the heading resolution and number of data words in memory that minimize trajectory uncertainty given a fixed sensor area constraint. Plots were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig3_HTML.png" id="MO8"/></fig></p></sec><sec id="Sec4"><title>Sensor calibration and noise modeling</title><p id="Par14">We next examined the output from existing ASP array sensors in order to create a model for future flight recorders. These particular sensors have 96 pixels, or 24 sets of 4 oriented in 90° angles. Specifically, we designed a calibration apparatus that consists of a platform holding the ASP array driven by a custom microcontroller PCB and an arm with a light emitting diode (LED) to imitate the sun. The platform rotates to mimic a change in yaw, while the arm rotates to mimic different AOI solar light at different times of the day (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Using this apparatus, we measured light input in 0.9° increments across the entire hemisphere and record the ASP array response (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a inset) for a total resolution of 40,000 measurements in a single sweep with 200 AOI angles and 200 yaw angles. Measurements sampled by the microcontroller were transmitted to a desktop computer for logging and processing via a custom MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> script. Each ASP array response consists of a 48-bit sequence. To interpret the output, we created a lookup table from the unique 48-bit sequence that is stored for each yaw-AOI angle pair. Future data was then compared to these stored sequences in parallel using an XOR operation and the pair with the least difference in bit values was returned.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p>(<bold>a</bold>) Calibration apparatus with inset example of a measured ASP quadrature response. (<bold>b</bold>) ASP array repeatability over a single sensor (left) and multiple sensors (right). The magenta lines denote the expected operating region. (<bold>c</bold>) Expected system operating region (45°–75°) shown in magenta given the peak foraging hours (10 a.m.–4 p.m.) shown in grey and the AOI solar light during the Summer in Ithaca, NY. Plots in (<bold>a</bold>-inset), (<bold>b</bold>) and (<bold>c</bold>) were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig4_HTML.png" id="MO9"/></fig></p><p id="Par15">We characterized sensor repeatability by repeating a sweep three times with a single ASP array and, similarly, characterized precision by comparing sweeps from two additional ASP arrays. A sample curve from the calibration sweep seen in the inset in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a shows the characteristic angle dependence. The sensor exhibits poor response uniqueness when the sun approaches zenith and when it nears the horizon; upwards of 100<inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq77.gif"/></alternatives></inline-formula> error in yaw near 90<inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq78.gif"/></alternatives></inline-formula> AOI (zenith) and up to 180<inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq79.gif"/></alternatives></inline-formula> error in yaw at 0°–25° AOI (horizon) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The former occurs because the position of a light source directly overhead is ambiguous to the sensor across yaw and consequently, indeterminate. We find that the sensor simply does not operate well in the latter region where light is arriving nearly parallel to the surface of the chip. Furthermore, as is expected, the difference in response is generally greater when comparing different sensors. The horizontal dark bars in the right graph in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b are examples of this increased error. We expect our system to operate under favorable foraging conditions. Based on previously published data, we estimate this operating region to be May through September at an example location of the authors’ hometown of Ithaca, New York, USA, with the most active foraging hours being from 10 a.m. to 4 p.m.<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. During this time, the AOI spans <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:msup><mml:mn>45</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$45^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq81.gif"/></alternatives></inline-formula> to <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:msup><mml:mn>75</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$75^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq82.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). Within this region, we see a significantly reduced same-chip error in yaw with a mean and standard deviation of <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>52</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>23</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.52^\circ \pm 1.23^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq83.gif"/></alternatives></inline-formula>. We compensate for the remaining error within the operating region as discussed in the following sections.</p><p id="Par16">In order to realistically simulate sensor output, we create a lookup table with an error model for each individual AOI value. Similar to our theoretical model, we fit a normal distribution to error in the yaw angle measured at each AOI. We use this error model to inform reconstruction of recorded bee paths as described in the following sections. For this work, we assume that we have access to calibration data for each particular sensor, however, given the low discrepancy between sensors (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b right), we believe that it is possible to avoid individual calibration with more sophisticated data processing. We leave this aspect for future work.</p></sec><sec id="Sec5"><title>Honey bee foraging simulation</title><p id="Par17">To properly develop our methodology for using instrumented bees to monitor the state of pollination and bloom, we designed a colony foraging simulator with an example apple orchard. Central to our approach is an understanding of the behavior and environmental conditions surrounding honey bee foraging, summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>c. The following subsections detail orchard, honey bee motion, and colony foraging models.</p><sec id="Sec6"><title>Orchard model</title><p id="Par18">We modelled the orchard based on common characteristics seen in real orchards (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) as well as those reported by the University of Vermont Cooperative Extension for Growing Fruit Trees<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. Specifically, these include a tree trunk radius of 0.15 m, separation between individual trees in a given planted row as 2.4 m, and separation between rows as 5 m. To make the model realistic to a variety of orchards, we add randomness to the trunk radius (0.15–0.30 m) and to the tree locations (up to 0.5 m in any direction). We further use a 60 × 60 m<sup>2</sup> area with 200 trees, as is representative of the common grower practice utilizing a single colony per acre<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. We account for the fact that trees can be in different stages of bloom by assigning each a randomly generated quality factor between 1 and 10; this quality factor affects the number of feeding events in a flight.</p></sec><sec id="Sec7"><title>Colony foraging model</title><p id="Par19">A high-quality honey bee colony for commercial apple pollination contains a laying queen, developing brood, and 20,000–40,000 worker bees, of which approximately 25% are “foragers”, or those that leave the hive to collect pollen, nectar, resin, and water<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup>. Since resin and water foragers are a small proportion of the forager workforce, we expect our flight dataset to be largely from bees that are visiting flowers<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. For this work, we assume favorable foraging conditions as previously described and a colony size of 35,000, 25% of which are foragers for a total of 8750 foragers conducting ~ 36,000 flights per day (an average of 4 flights per forager)<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>. In our model, a forager can perform either a learning-, return-, or scout flight. Note that we exclude orientation flights, which are conducted by new foragers, under the assumption that these can be easily classified given their tortuous nature<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. A learning flight is when a bee orients to a feeding site it has not previously visited after learning the bearing and distance from one of its sisters in the hive<sup><xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>. A return flight occurs when a bee orients to a feeding site it has previously visited, and can be thought of as an optimized version of the learning flight in terms of distance flown<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. A scout flight occurs when a forager leaves the hive to search independently for new feeding sites. In our model, we make the assumption based on published behavioral research that 20% of foragers are acting as scout foragers and the remaining 80% perform an initial learning flight followed by return flights to the same source<sup><xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref></sup>.</p><p id="Par20">We incorporate that return flights will frequent the same feeding sites and that neighboring trees are likely to bloom together by randomly assigning initial goal locations (trees that bees advertise in the colony as high quality food sources) to 5 neighboring trees. Bees will randomly choose between these 5, then continue feeding on neighboring trees until they have visited trees with quality factors accumulating to at least 10 before returning to the hive. Scout foragers randomly visit trees in the orchard. Realistically, not all bees will be tagged and some tags will be lost. Here, we consider a conservative estimate that at least 430 or 5% of all foragers will be tagged, leading us to 1750 recorded flights per day, and use accumulated data to overcome the loss of tagged bees, which we expect to occur as a result of predation, senescence, stress, and other factors. Note that honey bees have a pronounced division of labor associated with worker age<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, making it easy to tag a cohort and wait for them to become foragers, or to identify foragers and tag them specifically. Tagging 430 bees would take our honey bee technician approximately a day; speeding up this process is an area of future investigation.</p></sec><sec id="Sec8"><title>Honey bee motion model</title><p id="Par21">To better illustrate the characteristics of foraging flights, we recorded activity between a queenright colony with about 10,000 workers and a nearby feeder station (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b–d). Three distinct phases of the bee flights were recorded: an initial orientation flight upon leaving the hive, flights between the hive and the feeder, and search flights near the feeder. Flights near the entrance and the feeder were characterized by rapid turning, whereas flights in between the hive and the feeder were nearly straight “bee lines”. While at the feeder, bees crawl around at a significantly reduced velocity.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p>(<bold>a</bold>) Photo of a honey bee in a conventional apple orchard. (<bold>b</bold>–<bold>d</bold>) Setup to showcase different types of honey bee flights. Still images from videos recorded at the hive entrance, in between, and at the feeder station, with tracked paths overlaid. (<bold>e</bold>–<bold>f</bold>) Recorded heading over the course of a simulated foraging flight and feeding event. Straight line flights are marked in grey, turns in blue, and feeding events in green. Image overlays in (<bold>b</bold>), (<bold>c</bold>) and (<bold>d</bold>) were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Plots in (<bold>e</bold>) and (<bold>f</bold>) were created in Python 3.7.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig5_HTML.png" id="MO10"/></fig></p><p id="Par22">We use this study to inform our foraging simulation. We assume generally straight paths in obstacle-free environments, slow turns when avoiding obstacles, and rapid turns in AOI and yaw when nearing and crawling on a food source. We further base our flight model on the following assumptions, summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>c. (1) We assume the starting location is well known since the flight path will always originate and terminate at the hive entrance. (2) Based on past studies and the fact that our simulation takes place in a dense apple orchard, we assume most flights will be within the 4 km range of our flight recorder<sup><xref ref-type="bibr" rid="CR44">44</xref>–<xref ref-type="bibr" rid="CR46">46</xref></sup>. When leaving the hive, bees will fly an average of ~ 7.5 m/s, but once loaded with nectar, flight speed is reduced to ~ 6.5 m/s<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Here, we assume a constant velocity of ~ 6.5 m/s. (3) Based on prior honey bee tracking studies<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>, we represent flight in only two dimensions. The apple trees in the orchards we model are not tall and bees will therefore experience much greater motion in the horizontal plane than the vertical. Regardless of whether a bee in reality will fly over or under the canopy, we can model this issue in two dimensions. Turns around tree trunks represent the largest source of error for flight reconstruction, therefore by modeling flight under the canopy, we model the “worst case” scenario. (4) We estimate that the AOI of sunlight with respect to the orchard will remain within a quantifiable margin throughout the duration of the simulated flights, as bees have been found to spend an average of 20–45 min on foraging flights<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. (5) We model the yaw of a bee as constant during bee-line flights, i.e. given no nearby obstacles. When the bee changes its heading to circumvent obstacles, this causes a change in yaw. (6) Once implemented on bees, we expect to be able to add sensors near the hive which would help us acquire current temperature and weather patterns as well as other dynamic factors specific to a particular environment for calibrating our model.</p><p id="Par23">To simulate scouting, learning, and return foraging flights, we combine the honey bee motion model previously described, with the Bug2 algorithm and grid-based path planning<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Grid based path planning uses a discrete grid of points over which an agent searches to find obstacle-free path segments. We compute scout and learning flights as follows. Using the Bug2 algorithm, honey bee paths are generated by first assuming direct flight along a known heading from the hive. Once an obstacle is encountered, the bee searches for a path around it, until it can once more move unhindered toward the goal. The process is repeated until all goals are reached and the bee has returned to the hive. Since no two paths are identical in nature, we plan obstacle navigation with a randomly generated grid. Return flights are found by forming a graph of all the points visited during a learning flight and using a Dijkstra’s search algorithm<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to find the shortest path through these points from the hive to the goal. Once paths are generated, we compute the sequence of headings given the 240 ms sensor sampling frequency reported earlier. An example flight is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>e,f. These headings are then discretized based on the ASP calibration data discussed earlier, and noise is added given the error shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c left.</p><p id="Par24">When bees land at a feeding site, they tend to crawl on and among flowers to gather nectar and pollen. We simulate this by generating random motion centered around the feeding site. The average feeding time was reported to be 1–2 min per feeding site<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. To make the simulation more realistic, we randomly generate a feeding time between 60 and 120 s for foragers, and between 20 and 130 s for scouts. We furthermore assume that the AOI of sunlight changes as the honey bee tilts up and down while crawling on flowers.</p></sec></sec><sec id="Sec9"><title>Path reconstruction and generation of foraging activity maps</title><p id="Par25">Path reconstruction inherently depends on the accuracy with which our sensor is able to describe the motion of an instrumented bee. Beyond limited angle resolution, errors related to the sampling rate accumulate when turns occur, at worst <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">loaded</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{loaded} \Delta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq90.gif"/></alternatives></inline-formula> = 1.6
m. To increase the accuracy of our foraging activity maps, we use models of sensor noise and flight speed, and leverage all recorded flights. The full workflow is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, where the foraging simulation portion generates the data we expect if our sensors are placed on actual bees, and the remaining flow is the data processing portion of our methodology.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p>Flow chart combining the colony foraging simulation, simulated flight recorder, path reconstruction, and data processing to output the final foraging activity map. Recorded heading plot made in Python 3.7. Other plots were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig6_HTML.png" id="MO11"/></fig></p><p id="Par26">We first identify feeding and turn features in our path data that stand out above the noise floor. Feeding features consist of crawling behavior in which the bee is moving at much lower speed compared to flying, but with rapidly varying yaw and AOI, inducing an elevated rate of change in measured AOI. A turn is marked by a significant change in yaw. Given the time of day and location, we can find the expected AOI on the orchard and use this to find the yaw from our lookup table. Our algorithm then indexes the sensor noise lookup table to find the related mean and standard deviation and uses this to estimate turns and feeding status. Our method marks a turn for a change greater than three standard deviations in yaw (<inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:mn>6</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>06</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$6.06^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq91.gif"/></alternatives></inline-formula>). A feeding site is marked if the detected AOI deviates more than three standard deviations (<inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>72</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.72^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq92.gif"/></alternatives></inline-formula>) from the one expected, or if two consecutive AOI samples deviate more than 3 standard deviations, adjustable depending on the total flight time. The average detection accuracy of a turn is 99% with a standard deviation of 0.28% and average detection accuracy of a feeding site is 99% with a standard deviation of 0.29%.</p><p id="Par27">We explore three methods to generate activity maps: from the raw data, we classify feeding features using the aforementioned statistical approach and produce maps based on accumulated path reconstructions; in “iteration 1” and “iteration 4” we take a particle filter approach to improve path localization based on knowledge of the hive and frequented feeding sites respectively. Particle filters are used to track a variable of interest over time by creating many representative particles, generating predictions according to dynamics and error models, and then updating them according to observation models<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. In this case, each particle forms a candidate trajectory and predictions are based on speed, sensor readings, and the sensor error model. Assuming that we start without knowledge of the orchard, we build up an observation model by reconstructing and accumulating the raw flight paths (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, raw data). To account for the fact that bees may turn at any point between sensor readings, we then upsample our sensor readings by a factor of 8, essentially producing 8 guesses for where the bee actually turned. Based on the artificially upsampled data and a random sample from the sensor noise distribution at a given AOI, we then generate the displacement in each path segment as follows:<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">noise</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">noise</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{bmatrix} \Delta x_{t} \\ \Delta y_{t} \end{bmatrix} = v \Delta t \begin{bmatrix} \cos {(\gamma _{t} + \gamma _{noise})} \\ \sin {(\gamma _{t} + \gamma _{noise})} \end{bmatrix} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_Equ6.gif"/></alternatives></disp-formula>The final path is found as a cumulative sum of these displacements. We repeat this process to generate 5000 particles for each flight. The choice of 5000 is guided by our variable dimensions; the upsampling rate of 8 was the highest we could handle on a quadcore desktop computer with 16 GB RAM—to truly represent all potential turns we would need a number of particles equal to 8 to the power of the number of turns per flight. For reference, the average number of turns per flight is 13, thus the true representation in our sampling approach would require <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msup><mml:mn>8</mml:mn><mml:mn>13</mml:mn></mml:msup></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$8^{13}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq93.gif"/></alternatives></inline-formula> particles.</p><p id="Par28">In iteration 1, we choose ten of these particles according to proximity to the hive upon return, and use the feeding features from these to form an initial foraging activity map, represented by a discrete grid with computed visit numbers. Note that in a typical localization approach a single particle, or average of several particles, is chosen as the final reconstruction. In our approach, we retain 10 different reconstructions for each individual path in order to better represent the distribution of points in a path due to sensor noise.</p><p id="Par29">After this first pass, we repeat the process, but now filter particles by using the initial activity map as an observation model for the particle filter (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, iteration 2–4). Specifically, we update particle probability at each detected feeding site by assigning the probability of the nearest grid cell in the map to the particle, and then sampling the particles by weight. At the end of the process, the ten particles with the highest probability product are used to construct an updated activity map.</p></sec></sec><sec id="Sec10"><title>Results and discussion</title><p id="Par30">To evaluate our methodology, we simulated (in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>) 50 independent orchard foraging scenarios with randomly assigned goals. We also studied the impact of having fewer instrumented honey bees, 1% and 3% respectively, by sampling 20% and 60% of all generated flights assuming no particular order for scout or regular foraging flights. This comparison also serves to evaluate a scenario where many of the tagged bees leave the hive and do not return, a possible result of high environmental stressors such as weather, predators, or pesticides.</p><p id="Par31">Figure <xref rid="Fig7" ref-type="fig">7</xref>a shows an example outcome from 1750 flights, alongside estimated activity maps in Fig. <xref rid="Fig7" ref-type="fig">7</xref>b–d. We see that bees visit all trees in the orchard, but frequent actual goal sites and their neighboring trees more; this trend is also visible in maps generated from the raw data and iterations 1–4. Iteration 4 increases the computations by 4, but also shows a higher concentration of activity around the goal sites and significantly less activity in the empty areas between trees. This is a direct result of our re-iteration approach, which favors trajectories near high activity regions in the map.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p>Example of generated activity maps. (<bold>a</bold>) the ground truth (<bold>b</bold>) estimated map from the raw data (<bold>c</bold>) estimated map after iteration 1 and (<bold>d</bold>) estimated map after iteration 4. Actual feeding sites are marked in magenta. Plots were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig7_HTML.png" id="MO13"/></fig></p><p id="Par32">We next examine the accuracy of the raw data and iterations 1–4 by comparing the simulated flights with the reconstructed paths. We focus on two metrics: (1) the maximum number of estimated sensor samples compared to the true number of samples per visited tree in the map (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a), and (2) the distance of the reconstructed feeding locations from their true location (Fig. <xref rid="Fig8" ref-type="fig">8</xref>b). In Fig. <xref rid="Fig8" ref-type="fig">8</xref>a, we show data from all iterations, but further break down iteration 1 by the number of tagged foragers in shades of green.<fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p>(<bold>a</bold>) The maximum number of estimated samples associated with a goal as a function of the number of actual samples for the raw data (blue), 1 (green), and 4 (magenta). Note that the linear fit for the raw data coincides with the fit for iteration 1. In iteration 1, data points are colored according to how many forager bees were instrumented: 5% (dark green), 3% (green), and 1% (bright green). (<bold>b</bold>) The distance of estimated visits from their true location as a function of number of visits. Plots were created in MATLAB<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2021_82537_Fig8_HTML.png" id="MO14"/></fig></p><p id="Par33">As expected, Fig. <xref rid="Fig8" ref-type="fig">8</xref>a shows a linear correlation between the number of estimated and true samples. Note that the large quantity of low count samples is due to the stark difference in activity by trees that are visited by scouts and actual goal locations that are visited on regular foraging flights. We see that the coefficient of determination is high (0.9) for iterations 1 and 4, and lower for the raw data (0.8) where measurement errors accumulate in every time step. We also note that the number of estimated and true samples have a higher correlation in iteration 4, although they are still off by an order of magnitude.</p><p id="Par34">Figure <xref rid="Fig8" ref-type="fig">8</xref>b gives insights on the displacement error of the reconstructed feeding locations. We see that the mean and standard deviation, based on the median and interquartile distance, of the error is lowest for sites that have more than 25 visits. Simulations where only 1% or 3% of bees carry flight recorders still have many goals that exceed 25 visits and exhibit similar accuracy. Upon closer examination, trees with less than 25 visits correspond to ones that are most distant from initial goal sites or are visited only on scout flights, and because these visits typically occur late in the flights, they have also accumulated more error. We also note that the maximum outliers are inversely correlated with the number of visits as a result of less-visited goals occurring later in a given flight. We compute mean and standard deviation from the data presented in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b and in comparing the raw data and iterations 1 and 4, find that the raw data always performs the worst with mean errors at more than 25 visits almost exceeding the distance between tree trunks (<inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.3</mml:mn><mml:mo>±</mml:mo><mml:mn>1.2</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>m</mml:mtext></mml:mrow></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon = 2.3 \pm 1.2\; \text{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq94.gif"/></alternatives></inline-formula>). Iteration 1 performs the best (<inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn><mml:mo>±</mml:mo><mml:mn>0.9</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>m</mml:mtext></mml:mrow></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon = 1.4 \pm 0.9 \; \text{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq95.gif"/></alternatives></inline-formula>). Although iteration 4 improves the confidence in the cluster around a goal, it also has the detrimental effect of increasing the absolute error (<inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.8</mml:mn><mml:mo>±</mml:mo><mml:mn>1.2</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>m</mml:mtext></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon = 1.8 \pm 1.2 \; \text{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq96.gif"/></alternatives></inline-formula>). This happens because our re-iteration process does not associate feeding features with particular goals, but rather with any region of higher activity.</p><p id="Par35">Our multi-iteration approach further enables different uses, depending on computational power and desired accuracy. The raw data yields information quickly with a sacrifice in accuracy. Iteration 1 requires longer processing, but offers improved accuracy for both single flights or end-of-day accumulated activity. Iteration 4 trades off accuracy and added computation with a better confidence in areas of activity, and could be combined with knowledge of specific bloom sites or with the information obtained from iteration 1 to better pinpoint activity.</p><p id="Par36">Orchard pollination has strong implications for crop yield and management practices, yet monitoring these sporadic, brief, and spatially distributed events is very challenging. Instead of relying on high-end sensor and robotic technology to overcome this problem, we focused on applying Bayesian inference methods to data accumulated from large numbers of Angle-Sensitive Pixel arrays mounted on bee thoraxes, utilizing the highly cooperative nature of honey bee foragers who recruit other individuals from the colony to strategically exploit attractive food sources. Specifically, we presented system design considerations including (1) a mathematical model to help reason about chip memory versus sensor resolution given the strict limitations on overall chip area and weight given by the photovoltaic power output and honey bee size and payload; and (2) particle filter techniques to produce high level foraging activity maps given the coarse data returned from all sensors. To test our proposed system, we further implemented a comprehensive sensor and foraging simulator. We simulated a commercial colony with a small (<inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;5\%$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2021_82537_Article_IEq97.gif"/></alternatives></inline-formula>) subset of instrumented foragers in a prototypical apple orchard, producing foraging maps that show high activity regions with 1.4–2.3 m accuracy, without assuming availability of standard tracking technology such as GPS, laser, or computer vision. Under the umbrella of digital agriculture, our approach is unique because it allows apple growers to measure honey bee pollination activity, which is correlated to fruit yield and profits, through instrumented colonies of honey bees<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Although we focused specifically on honey bees and orchards, similar potential may exist in other scenarios where swarms of agents (natural or robotic) already exhibit robust navigation in an unknown environment. A major strength of this approach is its cost effective and scalable nature: the data can be processed by a general-performance computer and we estimate that the flight recorder will cost $0.62 at research production level and likely significantly less at commercial scale.</p><p id="Par37">In future work, we intend to test this technology with real colonies of honey bees, addressing the challenges of real flights and behaviors that are not captured in our current model such as changing flight speeds and diverse environmental conditions. This methodology is an important step towards the implementation of an inexpensive and scalable technology for analyzing and monitoring foraging activity in orchards, and represents an important thrust on leveraging natural organisms to complement current engineering practices in digital agriculture.</p></sec></body><back><ack><title>Acknowledgements</title><p>This work was supported by the NSF Cyber-Physical Systems Program under award number #1739671, GETTYLABS, and the Packard Fellowships for Science and Engineering. We further thank Prof. Nils Napp for fruitful discussions related to localization and mapping. We also thank Michael Smith for help in setting up the honey bee observation experiment and for discussions on the planning of this work.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>All authors contributed to the writing and argument of this paper. H.M.A.-R. designed the ASP calibration apparatus, the honey bee foraging simulation, and the foraging map reconstruction algorithms. D.M.P. contributed to the theoretical model and optimization of the flight recorder. P.A.K. added valuable insight on the behavior of honey bees in orchards. A.C.M. aided in chip design, overall concept, and writing. K.H.P. aided on the overall scope, simulation, and algorithms.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par40">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Food &amp; Agriculture Organization of the United Nations. Global Action on Pollination Services for Sustainable Agriculture. <ext-link xlink:href="http://www.fao.org/pollination/en/" ext-link-type="uri">http://www.fao.org/pollination/en/</ext-link> (2019).</mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanbergen</surname><given-names>AJ</given-names></name><name><surname>Initiative</surname><given-names>TIP</given-names></name></person-group><article-title xml:lang="en">Threats to an ecosystem service: Pressures on pollinators</article-title><source>Front. Ecol. Environ.</source><year>2013</year><volume>11</volume><fpage>251</fpage><lpage>259</lpage><pub-id pub-id-type="doi">10.1890/120126</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanzol</surname><given-names>J</given-names></name><name><surname>Herrero</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">The effective pollination period in fruit trees</article-title><source>Sci. Hortic.</source><year>2001</year><volume>90</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1016/S0304-4238(00)00252-1</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shamshiri</surname><given-names>R</given-names></name><etal/></person-group><article-title xml:lang="en">Research and development in agricultural robotics: A perspective of digital farming</article-title><source>Int. J. Agric. Biol. Eng.</source><year>2018</year><volume>11</volume><fpage>1</fpage><lpage>14</lpage></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bromenshenk</surname><given-names>JJ</given-names></name><etal/></person-group><article-title xml:lang="en">Bees as biosensors: Chemosensory ability, honey bee monitoring systems, and emergent sensor technologies derived from the pollinator syndrome</article-title><source>Biosensors</source><year>2015</year><volume>5</volume><fpage>678</fpage><lpage>711</lpage><pub-id pub-id-type="pmid">26529030</pub-id><pub-id pub-id-type="pmcid">4697140</pub-id><pub-id pub-id-type="doi">10.3390/bios5040678</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeley</surname><given-names>TD</given-names></name></person-group><article-title xml:lang="en">Honey bee foragers as sensory units of their colonies</article-title><source>Behav. Ecol. Sociobiol.</source><year>1994</year><volume>34</volume><fpage>51</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1007/BF00175458</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Gill</surname><given-names>P</given-names></name><name><surname>Molnar</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Light field image sensors based on the talbot effect</article-title><source>Appl. Opt.</source><year>2009</year><volume>48</volume><fpage>5897</fpage><lpage>5905</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009ApOpt..48.5897W</pub-id><pub-id pub-id-type="pmid">19881658</pub-id><pub-id pub-id-type="pmcid">2892475</pub-id><pub-id pub-id-type="doi">10.1364/AO.48.005897</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>R</given-names></name><name><surname>Nagpal</surname><given-names>R</given-names></name><name><surname>Wei</surname><given-names>G-Y</given-names></name></person-group><article-title xml:lang="en">Flight of the robobees</article-title><source>Sci. Am.</source><year>2013</year><volume>308</volume><fpage>60</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">23469434</pub-id><pub-id pub-id-type="doi">10.1038/scientificamerican0313-60</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Rodacy, P. J., Bender, S., Bromenshenk, J., Henderson, C. &amp; Bender, G. Training and deployment of honeybees to detect explosives and other agents of harm. In <italic>Detection and Remediation Technologies for Mines and Minelike Targets VII</italic>, Vol. 4742, 474–481 (International Society for Optics and Photonics, 2002).</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Iyer, V., Nandakumar, R., Wang, A., Fuller, S. B. &amp; Gollakota, S. Living iot: A flying wireless platform on live insects. In <italic>The 25th Annual International Conference on Mobile Computing and Networking</italic>, 1–15 (2019).</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landgraf</surname><given-names>T</given-names></name><name><surname>Rojas</surname><given-names>R</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Kriegel</surname><given-names>F</given-names></name><name><surname>Stettin</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Analysis of the waggle dance motion of honeybees for the design of a biomimetic honeybee robot</article-title><source>PLoS ONE</source><year>2011</year><volume>6</volume><fpage>e21354</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011PLoSO...621354L</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhtFWitLbF</pub-id><pub-id pub-id-type="pmid">21857906</pub-id><pub-id pub-id-type="pmcid">3153927</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0021354</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>H</given-names></name><name><surname>Maharbiz</surname><given-names>MM</given-names></name></person-group><article-title xml:lang="en">Recent developments in the remote radio control of insect flight</article-title><source>Front. Neurosci.</source><year>2010</year><volume>4</volume><fpage>199</fpage><pub-id pub-id-type="pmid">21629761</pub-id><pub-id pub-id-type="pmcid">3100638</pub-id><pub-id pub-id-type="doi">10.3389/fnins.2010.00199</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="other">Landgraf, T., Oertel, M., Rhiel, D. &amp; Rojas, R. A biomimetic honeybee robot for the analysis of the honeybee dance communication system. In <italic>2010 IEEE/RSJ International Conference on Intelligent Robots and Systems</italic>, 3097–3102 (IEEE, 2010).</mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koenig</surname><given-names>PA</given-names></name><name><surname>Smith</surname><given-names>ML</given-names></name><name><surname>Horowitz</surname><given-names>LH</given-names></name><name><surname>Palmer</surname><given-names>DM</given-names></name><name><surname>Petersen</surname><given-names>KH</given-names></name></person-group><article-title xml:lang="en">Artificial shaking signals in honey bee colonies elicit natural responses</article-title><source>Sci. Rep.</source><year>2020</year><volume>10</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/s41598-020-60421-8</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXltlKqsb4%3D</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bromenshenk</surname><given-names>JJ</given-names></name><etal/></person-group><article-title xml:lang="en">Can honey bees assist in area reduction and landmine detection?</article-title><source>J. Mine Action</source><year>2003</year><volume>7</volume><fpage>5</fpage></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>D</given-names></name><name><surname>Riley</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Remote-sensing, telemetric and computer-based technologies for investigating insect movement: A survey of existing and potential techniques</article-title><source>Comput. Electron. Agric.</source><year>2002</year><volume>35</volume><fpage>271</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1016/S0168-1699(02)00023-6</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Streit</surname><given-names>S</given-names></name><name><surname>Bock</surname><given-names>F</given-names></name><name><surname>Pirk</surname><given-names>CW</given-names></name><name><surname>Tautz</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Automatic life-long monitoring of individual insect behaviour now possible</article-title><source>Zoology</source><year>2003</year><volume>106</volume><fpage>169</fpage><lpage>171</lpage><pub-id pub-id-type="pmid">16351902</pub-id><pub-id pub-id-type="doi">10.1078/0944-2006-00113</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname><given-names>M</given-names></name><etal/></person-group><article-title xml:lang="en">A common pesticide decreases foraging success and survival in honey bees</article-title><source>Science</source><year>2012</year><volume>336</volume><fpage>348</fpage><lpage>350</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012Sci...336..348H</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XlslOqtb8%3D</pub-id><pub-id pub-id-type="pmid">22461498</pub-id><pub-id pub-id-type="doi">10.1126/science.1215039</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heidinger</surname><given-names>I</given-names></name><name><surname>Meixner</surname><given-names>M</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Büchler</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Observation of the mating behavior of honey bee (<italic>Apis mellifera</italic> L.) queens using radio-frequency identification (rfid): Factors influencing the duration and frequency of nuptial flights</article-title><source>Insects</source><year>2014</year><volume>5</volume><fpage>513</fpage><lpage>527</lpage><pub-id pub-id-type="pmid">26462822</pub-id><pub-id pub-id-type="pmcid">4592583</pub-id><pub-id pub-id-type="doi">10.3390/insects5030513</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Decourtye</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Honeybee tracking with microchips: A new methodology to measure the effects of pesticides</article-title><source>Ecotoxicology</source><year>2011</year><volume>20</volume><fpage>429</fpage><lpage>437</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhvVWqtbk%3D</pub-id><pub-id pub-id-type="pmid">21267650</pub-id><pub-id pub-id-type="doi">10.1007/s10646-011-0594-4</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Loper, G. M., Wolf, W. W. &amp; Taylor, O. R. Jr. Honey bee drone flyways and congregation areas: radar observations. <italic>J. Kansas Entomol. Soc.</italic> 223–230, (1992).</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loper</surname><given-names>GM</given-names></name><name><surname>Taylor</surname><given-names>OR</given-names><suffix>Jr</suffix></name><etal/></person-group><article-title xml:lang="en">Detection and monitoring of honeybee drone congregation areas by radar</article-title><source>Apidologie</source><year>1987</year><volume>18</volume><fpage>163</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1051/apido:19870206</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Capaldi</surname><given-names>EA</given-names></name><etal/></person-group><article-title xml:lang="en">Ontogeny of orientation flight in the honeybee revealed by harmonic radar</article-title><source>Nature</source><year>2000</year><volume>403</volume><fpage>537</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2000Natur.403..537C</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXht1Shurc%3D</pub-id><pub-id pub-id-type="pmid">10676960</pub-id><pub-id pub-id-type="doi">10.1038/35000564</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osborne</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">A landscape-scale study of bumble bee foraging range and constancy, using harmonic radar</article-title><source>J. Appl. Ecol.</source><year>1999</year><volume>36</volume><fpage>519</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1046/j.1365-2664.1999.00428.x</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Tracking bees with harmonic radar</article-title><source>Nature</source><year>1996</year><volume>379</volume><fpage>29</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996Natur.379...29R</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK28XivVKisA%3D%3D</pub-id><pub-id pub-id-type="doi">10.1038/379029b0</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carlsten</surname><given-names>ES</given-names></name><etal/></person-group><article-title xml:lang="en">Field demonstration of a scanning lidar and detection algorithm for spatially mapping honeybees for biological detection of land mines</article-title><source>Appl. Opt.</source><year>2011</year><volume>50</volume><fpage>2112</fpage><lpage>2123</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011ApOpt..50.2112C</pub-id><pub-id pub-id-type="pmid">21556112</pub-id><pub-id pub-id-type="doi">10.1364/AO.50.002112</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname><given-names>JA</given-names></name><etal/></person-group><article-title xml:lang="en">Polarization lidar measurements of honey bees in flight for locating land mines</article-title><source>Opt. Express</source><year>2005</year><volume>13</volume><fpage>5853</fpage><lpage>5863</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005OExpr..13.5853S</pub-id><pub-id pub-id-type="pmid">19498590</pub-id><pub-id pub-id-type="doi">10.1364/OPEX.13.005853</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffman</surname><given-names>DS</given-names></name><name><surname>Nehrir</surname><given-names>AR</given-names></name><name><surname>Repasky</surname><given-names>KS</given-names></name><name><surname>Shaw</surname><given-names>JA</given-names></name><name><surname>Carlsten</surname><given-names>JL</given-names></name></person-group><article-title xml:lang="en">Range-resolved optical detection of honeybees by use of wing-beat modulation of scattered light for locating land mines</article-title><source>Appl. Opt.</source><year>2007</year><volume>46</volume><fpage>3007</fpage><lpage>3012</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007ApOpt..46.3007H</pub-id><pub-id pub-id-type="pmid">17514251</pub-id><pub-id pub-id-type="doi">10.1364/AO.46.003007</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geslin</surname><given-names>B</given-names></name><etal/></person-group><article-title xml:lang="en">The impact of honey bee colony quality on crop yield and farmers profit in apples and pears</article-title><source>Agric. Ecosyst. Environ.</source><year>2017</year><volume>248</volume><fpage>153</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1016/j.agee.2017.07.035</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Souza</surname><given-names>P</given-names></name><etal/></person-group><article-title xml:lang="en">Low-cost electronic tagging system for bee monitoring</article-title><source>Sensors</source><year>2018</year><volume>18</volume><fpage>2124</fpage><pub-id pub-id-type="doi">10.3390/s18072124</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmid-Hempel</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Do honeybees get tired? The effect of load weight on patch departure</article-title><source>Anim. Behav.</source><year>1986</year><volume>34</volume><fpage>1243</fpage><lpage>1250</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(86)80183-X</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wenner</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">The flight speed of honeybees: A quantitative approach</article-title><source>J. Apic. Res.</source><year>1963</year><volume>2</volume><fpage>25</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1080/00218839.1963.11100053</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">MathWorks. MATLAB R2019a. <ext-link xlink:href="https://www.mathworks.com/products/matlab.html" ext-link-type="uri">https://www.mathworks.com/products/matlab.html</ext-link> (2019).</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abou-Shaara</surname><given-names>H</given-names></name><name><surname>Owayss</surname><given-names>AA</given-names></name><name><surname>Ibrahim</surname><given-names>Y</given-names></name><name><surname>Basuny</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">A review of impacts of temperature and relative humidity on various activities of honey bees</article-title><source>Insectes Sociaux</source><year>2017</year><volume>64</volume><fpage>455</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1007/s00040-017-0573-8</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">University of Vermont. Tree fruit: Practical guide for organic apple production. <ext-link xlink:href="http://www.uvm.edu/%7efruit/?Page=treefruit/tf_organicbasics/PracticalGuideOrganic/PracticalGuideOrganicHorticulture.html&amp;SM=tf_submenu.html" ext-link-type="uri">http://www.uvm.edu/~fruit/?Page=treefruit/tf_organicbasics/PracticalGuideOrganic/PracticalGuideOrganicHorticulture.html&amp;SM=tf_submenu.html</ext-link> (2019).</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jentsch</surname><given-names>P</given-names></name><name><surname>Acimovic</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Scaffolds update on pest management and crop development</article-title><source>Scaffolds Fruit J.</source><year>2020</year><volume>29</volume><fpage>1</fpage><lpage>6</lpage></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Seeley</surname><given-names>TD</given-names></name></person-group><source>The Wisdom of the Hive: The Social Physiology of Honey Bee Colonies</source><year>2009</year><publisher-loc>Harvard</publisher-loc><publisher-name>Harvard University Press</publisher-name><pub-id pub-id-type="doi">10.2307/j.ctv1kz4h15</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>MR</given-names></name><name><surname>Khan</surname><given-names>MR</given-names></name></person-group><article-title xml:lang="en">The role of honey bees <italic>Apis mellifera</italic> L. (hymenoptera: Apidae) in pollination of apple</article-title><source>Pak. J. Biol. Sci.</source><year>2004</year><volume>7</volume><fpage>359</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.3923/pjbs.2004.359.362</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pankiw</surname><given-names>T</given-names></name><name><surname>Page</surname><given-names>RE</given-names><suffix>Jr</suffix></name></person-group><article-title xml:lang="en">Response thresholds to sucrose predict foraging division of labor in honeybees</article-title><source>Behav. Ecol. Sociobiol.</source><year>2000</year><volume>47</volume><fpage>265</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1007/s002650050664</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fewell</surname><given-names>JH</given-names></name><name><surname>Winston</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">Colony state and regulation of pollen foraging in the honey bee, <italic>Apis mellifera</italic> L</article-title><source>Behav. Ecol. Sociobiol.</source><year>1992</year><volume>30</volume><fpage>387</fpage><lpage>393</lpage><pub-id pub-id-type="doi">10.1007/BF00176173</pub-id></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeley</surname><given-names>TD</given-names></name></person-group><article-title xml:lang="en">Division of labor between scouts and recruits in honeybee foraging</article-title><source>Behav. Ecol. Sociobiol.</source><year>1983</year><volume>12</volume><fpage>253</fpage><lpage>259</lpage><pub-id pub-id-type="doi">10.1007/BF00290778</pub-id></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chittka</surname><given-names>L</given-names></name><name><surname>Geiger</surname><given-names>K</given-names></name><name><surname>Kunze</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">The influences of landmarks on distance estimation of honey bees</article-title><source>Anim. Behav.</source><year>1995</year><volume>50</volume><fpage>23</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1006/anbe.1995.0217</pub-id></mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>C</given-names></name><name><surname>Rafalko</surname><given-names>S</given-names></name><name><surname>Dyer</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Deciding to learn: Modulation of learning flights in honeybees, <italic>Apis mellifera</italic></article-title><source>J. Compar. Physiol. A</source><year>2002</year><volume>188</volume><fpage>725</fpage><lpage>737</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BD38njsl2rtg%3D%3D</pub-id><pub-id pub-id-type="doi">10.1007/s00359-002-0346-2</pub-id></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beekman</surname><given-names>M</given-names></name><name><surname>Sumpter</surname><given-names>D</given-names></name><name><surname>Seraphides</surname><given-names>N</given-names></name><name><surname>Ratnieks</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Comparing foraging behaviour of small and large honey-bee colonies by decoding waggle dances made by foragers</article-title><source>Funct. Ecol.</source><year>2004</year><volume>18</volume><fpage>829</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1111/j.0269-8463.2004.00924.x</pub-id></mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visscher</surname><given-names>PK</given-names></name><name><surname>Seeley</surname><given-names>TD</given-names></name></person-group><article-title xml:lang="en">Foraging strategy of honeybee colonies in a temperate deciduous forest</article-title><source>Ecology</source><year>1982</year><volume>63</volume><fpage>1790</fpage><lpage>1801</lpage><pub-id pub-id-type="doi">10.2307/1940121</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waddington</surname><given-names>KD</given-names></name><name><surname>Herbert</surname><given-names>TJ</given-names></name><name><surname>Visscher</surname><given-names>PK</given-names></name><name><surname>Richter</surname><given-names>MR</given-names></name></person-group><article-title xml:lang="en">Comparisons of forager distributions from matched honey bee colonies in suburban environments</article-title><source>Behav. Ecol. Sociobiol.</source><year>1994</year><volume>35</volume><fpage>423</fpage><lpage>429</lpage><pub-id pub-id-type="doi">10.1007/BF00165845</pub-id></mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>JR</given-names></name><name><surname>Greggers</surname><given-names>U</given-names></name><name><surname>Smith</surname><given-names>AD</given-names></name><name><surname>Reynolds</surname><given-names>DR</given-names></name><name><surname>Menzel</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">The flight paths of honeybees recruited by the waggle dance</article-title><source>Nature</source><year>2005</year><volume>435</volume><fpage>205</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005Natur.435..205R</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXktVWhtLY%3D</pub-id><pub-id pub-id-type="pmid">15889092</pub-id><pub-id pub-id-type="doi">10.1038/nature03526</pub-id></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eckert</surname><given-names>C</given-names></name><name><surname>Winston</surname><given-names>M</given-names></name><name><surname>Ydenberg</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">The relationship between population size, amount of brood, and individual foraging behaviour in the honey bee, <italic>Apis mellifera</italic> L.</article-title><source>Oecologia</source><year>1994</year><volume>97</volume><fpage>248</fpage><lpage>255</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994Oecol..97..248E</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BC1czot1Cntw%3D%3D</pub-id><pub-id pub-id-type="pmid">28313936</pub-id><pub-id pub-id-type="doi">10.1007/BF00323157</pub-id></mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Choset</surname><given-names>HM</given-names></name><etal/></person-group><source>Principles of Robot Motion: Theory, Algorithms, and Implementation</source><year>2005</year><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1081.68700</pub-id></mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="other">Thrun, S. Particle filters in robotics. In <italic>Proceedings of the Eighteenth conference on Uncertainty in artificial intelligence</italic>, 511–518 (Morgan Kaufmann Publishers Inc., 2002).</mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="other">Burdine, J. D., Plummer, E., Seidel, M. &amp; McCluney, K. E. Mass-length relationships for 3 bee species in northwest ohio. <italic>Ohio J. Sci.</italic><bold>31</bold>, (2018).</mixed-citation></ref><ref id="CR52"><label>52.</label><mixed-citation publication-type="other">Kolmes, S. A. &amp; Sam, Y. Relationships between sizes of morphological features in worker honey bees (<italic>Apis mellifera</italic>). <italic>J. N. Y. Entomol. Soc.</italic> 684–690, (1991).</mixed-citation></ref><ref id="CR53"><label>53.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Winston</surname><given-names>ML</given-names></name></person-group><source>The Biology of the Honey Bee</source><year>1991</year><publisher-loc>Harvard</publisher-loc><publisher-name>Harvard University Press</publisher-name></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec15"><title>Supplementary Information</title><p id="Par43"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41598_2021_82537_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary Information.</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1038/s41598-021-82537-1" ext-link-type="doi">https://doi.org/10.1038/s41598-021-82537-1</ext-link>.</p></notes><notes notes-type="Misc"><title>Publisher's note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Scientific Reports</facet-value></facet><facet name="year"><facet-value count="1">2021</facet-value></facet><facet name="country"><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
