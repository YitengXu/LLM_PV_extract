<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41524-018-0108-5</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" specific-use="web-only" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41524</journal-id><journal-title-group><journal-title>npj Computational Materials</journal-title><abbrev-journal-title abbrev-type="publisher">npj Comput Mater</abbrev-journal-title></journal-title-group><issn pub-type="epub">2057-3960</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41524-018-0108-5</article-id><article-id pub-id-type="manuscript">108</article-id><article-id pub-id-type="doi">10.1038/s41524-018-0108-5</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/1034/1037</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/1005/1007</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Microstructure design using graphs</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Du</surname><given-names>Pengfei</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Zebrowski</surname><given-names>Adrian</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Zola</surname><given-names>Jaroslaw</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au4"><name><surname>Ganapathysubramanian</surname><given-names>Baskar</given-names></name><address><email>baskarg@iastate.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4152401801085_cor4">d</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au5"><name><surname>Wodo</surname><given-names>Olga</given-names></name><address><email>olgawodo@buffalo.edu</email></address><xref ref-type="aff" rid="Aff4">4</xref><xref ref-type="corresp" rid="IDs4152401801085_cor5">e</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7312</institution-id><institution-id institution-id-type="GRID">grid.34421.30</institution-id><institution content-type="org-division">Department of Mechanical Engineering</institution><institution content-type="org-name">Iowa State University</institution></institution-wrap><addr-line content-type="city">Ames</addr-line><addr-line content-type="state">IA</addr-line><country country="US">USA</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9887</institution-id><institution-id institution-id-type="GRID">grid.273335.3</institution-id><institution content-type="org-division">Department of Mechanical and Aerospace Engineering</institution><institution content-type="org-name">University at Buffalo</institution></institution-wrap><addr-line content-type="city">Buffalo</addr-line><addr-line content-type="state">NY</addr-line><country country="US">USA</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9887</institution-id><institution-id institution-id-type="GRID">grid.273335.3</institution-id><institution content-type="org-division">Department of Computer Science and Engineering</institution><institution content-type="org-name">University at Buffalo</institution></institution-wrap><addr-line content-type="city">Buffalo</addr-line><country country="US">USA</country></aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9887</institution-id><institution-id institution-id-type="GRID">grid.273335.3</institution-id><institution content-type="org-division">Department of Materials Design and Innovation</institution><institution content-type="org-name">University at Buffalo</institution></institution-wrap><addr-line content-type="city">Buffalo</addr-line><addr-line content-type="state">NY</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><fn fn-type="con"><p>These authors contributed equally: Pengfei Du, Adrian Zebrowski.</p></fn><corresp id="IDs4152401801085_cor4"><label>d</label><email>baskarg@iastate.edu</email></corresp><corresp id="IDs4152401801085_cor5"><label>e</label><email>olgawodo@buffalo.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>7</day><month>9</month><year>2018</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2018</year></pub-date><volume>4</volume><issue seq="50">1</issue><elocation-id>50</elocation-id><history><date date-type="registration"><day>24</day><month>8</month><year>2018</year></date><date date-type="received"><day>5</day><month>5</month><year>2018</year></date><date date-type="rev-recd"><day>15</day><month>8</month><year>2018</year></date><date date-type="accepted"><day>23</day><month>8</month><year>2018</year></date><date date-type="online"><day>7</day><month>9</month><year>2018</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2018</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Thin films with tailored microstructures are an emerging class of materials with applications such as battery electrodes, organic electronics, and biosensors. Such thin film devices typically exhibit a multi-phase microstructure that is confined, and show large anisotropy. Current approaches to microstructure design focus on optimizing bulk properties, by tuning features that are statistically averaged over a representative volume. Here, we report a tool for morphogenesis posed as a graph-based optimization problem that evolves microstructures recognizing confinement and anisotropy constraints. We illustrate the approach by designing optimized morphologies for photovoltaic applications, and evolve an initial morphology into an optimized morphology exhibiting substantially improved short circuit current (68% improvement over a conventional bulk-heterojunction morphology). We show optimized morphologies across a range of thicknesses exhibiting self-similar behavior. Results suggest that thicker films (250 nm) can be used to harvest more incident energy. Our graph based morphogenesis is broadly applicable to microstructure-sensitive design of batteries, biosensors and related applications.</p></abstract><abstract xml:lang="en" id="Abs2" abstract-type="LongSummary" specific-use="web-only"><title>MATERIALS DESIGN: The power of graphs</title><p id="Par2">Representing microstructures with graphs, and mapping their properties mathematically, can help improve material properties. Morphogenesis is the process of optimizing performance in devices; representing the candidate structure with an appropriate mathematical framework in order to probe their properties and then mapping the structure to a property. Current approaches rely on computationally heavy methods for both stages, but now a team from Iowa State University and University at Buffalo simplify the process by representing the structures with labelled, weighted, undirected graphs. On this basis, one can create a “surrogate” model through generic physics graph descriptors (e.g. path lengths, domain sizes) and weighting functions for the particular property of interest. This approach reveals new designs for improved organic solar cells, but could expanded to other devices.</p></abstract><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Research</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>8</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>24</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41524_2018_Article_108.pdf</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Materials Science</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Materials Science, general</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Characterization and Evaluation of Materials</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical and Computational Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Theoretical, Mathematical and Computational Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computational Intelligence</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical Modeling and Industrial Mathematics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Chemistry and Materials Science</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Microstructure design, or morphogenesis, is the decision making process of determining material distribution to optimize performance.<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> Since the microstructure critically affects transport of mass,<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> charge<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> as well as reaction rate,<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> there has been a sustained focus on microstructure-sensitive design. The design goal here is to identify tailored microstructures that result in maximization of desired properties. Examples include designing the porous structure of membranes to enhance the filtering process for water reclamation,<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> designing the electrode microstructure in batteries to improve energy transport,<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> and controlling the microstructure in thin film organic electronics to improve energy harvesting<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> or sensing<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> capabilities.</p><p id="Par4">Morphogenesis can broadly be decomposed into two distinct stages: the representation stage and the mapping stage. The first stage (representation stage) is to carefully construct a mathematical framework for representing and, most importantly, synthetically generating microstructures (by ‘synthetically’ we mean generated in silico). The second stage is to build the mathematical construct that maps the microstructure to a property. The first stage allows sampling candidate microstructures and perturbing them, while the second stage enables evaluating the performance of a microstructure. These two stages are then wrapped into an optimization framework to iteratively identify a microstructure with extreme performance. Current approaches to morphogenesis are limited in two ways: (a) the use of computationally complex methods for microstructure representation<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>—field based (phase field, level set, random fields), or feature based approaches—which make reconstruction or perturbing microstructures non-trivial,<sup><xref ref-type="bibr" rid="CR13">12</xref></sup> and (b) the necessity of solving complex, non-linear partial differential equations based mappers<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR12">13</xref></sup> for evaluating the property of a microstructure. These limitations bottleneck rapid exploration of the search space, especially for geometrically constrained (thin films) and anisotropic systems where the number of constraints make exploration quite non-trivial.</p><p id="Par5">Here, we show how morphogenesis can be substantially simplified and generalized by using concepts from graph theory. Labeled, weighted, undirected graphs can be used to represent microstructures. They provide a fast, accurate and extensible way to represent, perturb and generate microstructures. Furthermore, graph measures (or queries) can be used to construct viable surrogates for the microstructure-property mappers, which enable fast and efficient property evaluation. This is especially useful when considering microstructure-sensitive processes (like transport and reactions) that can be naturally represented in terms of pathways, connected components and interfaces, which are foundational concepts in graph theory. Additionally, expert intuition, available knowledge and data trends can be naturally fused into these surrogate graph metrics allowing easy integration of domain knowledge with data.</p><p id="Par6">Finally, a graph based approach merges both stages of morphogenesis (microstructure representation and structure-property mapping) in a computationally elegant and efficient way. We show that one can frame morphogenesis as a graph optimization problem and illustrate the approach by designing optimized morphologies for photovoltaic applications.<sup><xref ref-type="bibr" rid="CR13">14</xref></sup> We demonstrate how this fast approach allows us to evolve an initial morphology into an optimized morphology exhibiting substantially improved short circuit current. We show optimized morphologies for thicker films (∼250 nm) than currently prevalent, which allows harvesting more incident energy. Our graph based morphogenesis is broadly applicable for microstructure-sensitive design for batteries, biosensors and filtration.</p></sec><sec id="Sec2" sec-type="results"><title>Results and discussion</title><sec id="Sec3"><title>Graph-based microstructure design framework</title><p id="Par7">Standard approaches for computationally predicting the performance of microstructure sensitive systems involve interrogating the microstructure of interest using computationally intensive frameworks. Incorporating these strategies into any inverse design problem becomes computationally intractable. We address this challenge in two stages. In the first stage, we develop a physics-based ‘graph surrogate model’ of the performance of the device. The ‘surrogate model’ extracts the microstructure-aware performance measures and is built (a) using the underlying equivalence between a multi phase morphology and a labeled, weighted, undirected, graph, (b) using concepts and algorithms from graph theory, (c) to seamlessly allow incorporating domain expert knowledge and intuition. In the second stage, this simple and fast surrogate model is linked with a parallel probabilistic optimization algorithm that enables the inverse design of morphologies to maximize certain performance criteria. The choice of the probabilistic approach again allows seamless incorporation of domain knowledge in terms of the prior distribution (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Elements of graph-based microstructure design framework. <bold>a</bold> The concept of representing morphology as an equivalent graph allows construction of fast graph based surrogates to full-physics based device performance indicators; <bold>b</bold> Scheme of population based incremental learning: An initial (or prior) distribution is sampled to generate candidate graphs (i.e., microstructures), which are rapidly evaluated and ranked. This ranked information is used to update the distribution. Iterating this process evolves the distribution towards graphs exhibiting better performance. Such an approach naturally allows incorporation of expert information into the prior</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2018_108_Fig1_HTML.png"/></fig></p><p id="Par8">The key idea here is to represent microstructure as a graph. A graph-based representation allows us to leverage well studied algorithms from graph theory along with their optimized implementations. We note that graphs have been used in many material science models ranging from molecular structure<sup><xref ref-type="bibr" rid="CR14">15</xref>,<xref ref-type="bibr" rid="CR15">16</xref></sup> to grain boundaries<sup><xref ref-type="bibr" rid="CR16">17</xref>,<xref ref-type="bibr" rid="CR17">18</xref></sup> and porous microstructure.<sup><xref ref-type="bibr" rid="CR18">19</xref></sup></p><p id="Par9">Discretized microstructure is represented as a labeled, weighted, undirected graph <italic>G</italic> = (<italic>V,E,W,L</italic>) (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The graph captures all imperative information inherent to a digitized morphology. Each pixel (or voxel) in the microstructure becomes a graph vertex, with <italic>V</italic> being the set of all vertices in the microstructure. An associated labeling function, <italic>L</italic>, assigns a label to each vertex in <italic>V</italic>. For instance, considering a two-phase microstructure, <italic>L</italic> could associate a color (red) to represent one phase, and another color (blue) to represent the second phase. Thus <italic>L</italic> acts on each vertex in <italic>V</italic>. It should be noted that the set of vertex labels can be easily extended to account for multi phase system or to represent multiple characteristics (like electrical, thermal and magnetic properties, or crystalline vs amorphous properties) of each vertex. Each vertex is connected to its neighboring vertices through edges. The set of all edges in the graph is denoted as <italic>E</italic>. Finally, the weight function, <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mo>:</mml:mo><mml:mi>E</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W:E \to R_ +$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq1.gif"/></alternatives></inline-formula>, assigns a non-negative real weight to each edge in <italic>E</italic>. For instance, the weight function could simply encode the physical distance between voxels. Alternate weight functions could encode hopping frequencies of charge/mass/momentum transfer between vertices or other transport characteristics. This <italic>G</italic> = (<italic>V,E,W,L</italic>) based representation provides a lot of flexibility in representing a variety of microstructures and associated spatially varying properties. On top of the versatility of this graph representation of a microstructure, we gain the ability to use very efficient graph algorithms to extensively characterize the graph (morphology). In general, most transport and reaction characteristics that depend on the underlying morphology can be recast as graph measures.<sup><xref ref-type="bibr" rid="CR18">19</xref>,<xref ref-type="bibr" rid="CR19">20</xref></sup></p><p id="Par10">Given graph-based representation of the microstructure, a surrogate model of material properties is constructed directly on the graph-based representation. Traditionally, there have been a spectrum of approaches for constructing a mapping from a given microstructure to its associated device performance indicator. On one end of the (complexity) spectrum are the full-physics based approaches that use detailed microstructure-aware property-structure simulators as the mapping function. These typically come at a very high computational cost precluding optimization except on large computing resources. On the other end of the spectrum are the approaches that use a small set of salient microstructural features from the microstructural data that is then mapped to the performance indicator. These features encode domain knowledge, are intuition driven and/or a result of carefully designed hypothesis driven structure-property studies. A classic example of the latter approach is the Hall-Petch relationship, where the average grain size (salient feature) governs the yield strength of the material.<sup><xref ref-type="bibr" rid="CR20">21</xref></sup> We emphasize that representing a digitized morphology as an equivalent graph allows one to construct a ‘graph surrogate model’ (based on graph metrics) that can span this full spectrum of structure-property mappers.</p><p id="Par11">A surrogate model is an approximate (but fast) mapping from the microstructure to the output, usually constructed with the aid of statistical and/or data-driven approaches.<sup><xref ref-type="bibr" rid="CR21">22</xref></sup> If a small set of full-physics structure-property simulation results are available, the surrogate model is created using this limited set of results. The surrogate model construction (or ‘training’) can be done by extracting a large set of graph descriptors/measures from the graph and identifying the best set of features that create a good regression to the full-physics predictions.<sup><xref ref-type="bibr" rid="CR22">23</xref></sup> Representing the full microstructure as a graph helps avoid any a priori feature extraction, and builds the surrogate model on the same graph-based representation. Additionally, intuition driven or domain knowledge based features can be easily represented as graph metrics and incorporated into a surrogate mapper.<sup><xref ref-type="bibr" rid="CR19">20</xref></sup> Examples include evaluating the connectivity in porous media as graph connectivity metrics and graph paths, domain sizes in ceramics and alloys as graph connected components, among several other examples that originated from network-based computational models for characterizing transport properties.<sup><xref ref-type="bibr" rid="CR23">24</xref>–<xref ref-type="bibr" rid="CR25">26</xref></sup></p><p id="Par12">To keep the approach generic and allow diverse applications to a variety of problem specific traits, we separate construction of the surrogate model into two steps: defining a set of physics relevant graph descriptors that are generic (i.e., application agnostic), and weighting functions that encapsulate the specifics of the property of interest (i.e., application dependent). The generic graph descriptors include traits such as path lengths (from specific locations, say, boundaries to all the internal nodes or from one phase to another), centrality measures (of, say, reactants or initiators), connectivity measures (of, say, phases in the microstructure with the boundary or to each other), domain sizes, among others.<sup><xref ref-type="bibr" rid="CR26">27</xref>,<xref ref-type="bibr" rid="CR27">28</xref></sup> Next, weighting functions are constructed to capture the detailed trends (say, kinetics aspects, or material specific aspects) of the transport. For example, effect of Brownian motion (or random walks) can be encoded by defining a weighting function that associates smaller weights with larger distances that an ion/charge/molecule has to travel on the graph. This is integrated with the graph path length measures to construct a viable surrogate for the property of interest. This generality provides substantial flexibility to creatively construct reliable surrogate mappers.</p></sec><sec id="Sec4"><title>Probabilistic graph-based optimization</title><p id="Par13">The graph based surrogate model provides an efficient map from microstructure to performance. We link this surrogate model with a probabilistic optimization algorithm. We specifically choose a probabilistic approach for the following reasons: (a) the outcome of the optimization is a distribution, i.e., a microstructure class (rather than specific microstructure), (b) such probabilistic approaches perform global searches in a gradient free manner and are embarrassingly parallelizable, (c) it is straightforward to encode domain knowledge as a prior distribution, and (d) the optimization is performed directly on graphs, hence eliminating any conversion steps.</p><p id="Par14">In this work, we use a probabilistic optimizer called population-based incremental learning (PbIL).<sup><xref ref-type="bibr" rid="CR28">29</xref></sup> The basic steps of the algorithm are outlined in Fig. <xref rid="Fig1" ref-type="fig">1 (b)</xref>. PbIL is an optimization algorithm that estimates the explicit distribution of the optimal solution rather than searching for a specific solution, as in typical meta-heuristics (e.g., genetic algorithms,<sup><xref ref-type="bibr" rid="CR29">30</xref></sup> hill-climbing<sup><xref ref-type="bibr" rid="CR30">31</xref></sup> or simulated annealing<sup><xref ref-type="bibr" rid="CR30">31</xref></sup>). The multi variate probability distribution is stored as a probability vector <bold>P</bold> of vertex labeling. In particular, with each vertex in the graph (variable) we associate the probability of a given phase (or component, or more generally the label, <italic>L</italic>) appearing at this location in the morphology. The probability vector <bold>P</bold> is updated in each iteration of the optimization based on the feedback from the cost functional. The optimization starts with a given probability vector of vertex labeling (step S1 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>), which is either uniform or reflects domain expert knowledge (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In each iteration, <italic>n</italic> morphology realizations (i.e., instances of a colored graph) are sampled from the current probability vector <bold>P</bold> (step S2 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>). For each realization, <italic>j</italic>, the graph surrogate model is deployed to evaluate the performance indicator (cost functional), <italic>f</italic>(j) (step S3 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>). The <italic>n</italic><sub><italic>b</italic></sub> best samples <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>≪</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {n_b \ll n} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq2.gif"/></alternatives></inline-formula> are identified (step S4 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>). These best samples are used to calculate the update vector, <bold>P</bold><sub><italic>u</italic></sub>, of the probability distribution (step S5 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>). Specifically, the update vector <bold>P</bold><sub><italic>u</italic></sub> represents the maximum likelihood estimation of vertex labeling from the <italic>n</italic><sub><italic>b</italic></sub> best samples. An iteration ends by updating the probability vector <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">P</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{P}} = {\mathbf{P}} \cdot (1 - l_r) + {\mathbf{P}}_u \cdot l_r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>l</italic><sub><italic>r</italic></sub> is the learning rate (step S6 in Fig. <xref rid="Fig1" ref-type="fig">1(b)</xref>). Intuitively, the update reinforces features present in the morphology, and dampens those missing, at the constant rate prescribed by <italic>l</italic><sub><italic>r</italic></sub>. The algorithm iterates until standard termination criteria are met (iteration limits, improvement bounds). The resulting method has a small memory footprint with only one vector of vertex labels being stored and updated at each iteration. The method is also embarrassingly parallel, since multiple samples drawn from the evolving distribution vector <bold>P</bold> can be evaluated simultaneously. The cost functional <italic>f</italic> expresses a single objective to optimize. However, we note that in practical settings, <italic>f</italic> can encapsulate multiple criteria, as we demonstrate in the next section.</p></sec><sec id="Sec5"><title>Application-specific exploration</title><p id="Par15">We illustrate the power of this approach by optimizing the morphology of organic solar cells (OSC). OSCs have the potential for widespread usage due to their low cost-per-watt, mechanical flexibility, and ease of manufacturability.<sup><xref ref-type="bibr" rid="CR13">14</xref></sup> Their widespread use and commercialization, however, are bottlenecked primarily by relatively low solar efficiencies. Efficiency can be improved either by changing the material chemistry (molecular engineering), microstructure tailoring (microstructure engineering) or architecture (device engineering). It has been argued that most advantages from tuning material energy levels (i.e., molecular engineering) have already been achieved,<sup><xref ref-type="bibr" rid="CR31">32</xref></sup> leaving microstructure design as a promising avenue for efficiency increase.<sup><xref ref-type="bibr" rid="CR32">33</xref>,<xref ref-type="bibr" rid="CR33">34</xref></sup></p><p id="Par16">Traditional approaches to microstructure engineering in OSC have relied on systematic trial-and-error experiments to generate diverse microstructures and their device performance (which is resource intensive), or via using computationally intensive simulators to virtually interrogate the candidate morphologies to identify features that an optimal morphology should exhibit.<sup><xref ref-type="bibr" rid="CR34">35</xref>,<xref ref-type="bibr" rid="CR35">36</xref></sup> It is generally believed that an interdigitated columnar morphology (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) is an optimal morphology. This is because the interdigitated morphology exhibits a graceful combination of two competing requirements—having a large donor–acceptor interface to enable efficient exciton dissociation, while still providing straight, fully connected domains to enable efficient charge transfer and collection. We substantially improve upon this current state-of-the-art using our graph based morphogenesis (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) and show that a whole class of morphologies exist that not only exhibit a much higher photovoltaic performance, but which may also be easier to fabricate.</p><p id="Par17">Following the template for graph based morphogenesis outlined in subsection 'Graph-based microstructure design framework', we represent a OSC microstructure—consisting of two phases, electron-donating and electron-accepting—as an labeled, weighted, undirected graph.<sup><xref ref-type="bibr" rid="CR19">20</xref></sup> We then utilize a finite set of full physics simulations to identify three physically meaningful graph descriptors that together produce an exceptional surrogate for device performance (specifically, the short circuit current)<sup><xref ref-type="bibr" rid="CR22">23</xref></sup> (see <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref> for more details). Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates the quality of the graph surrogate model. Our surrogate for the short circuit current produced by a morphology is given as: <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F = f_{abs}\;f_{diss}\;f_{out}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq4.gif"/></alternatives></inline-formula>, where these three descriptors are:<list list-type="order"><list-item><p id="Par18"><italic>f</italic><sub><italic>abs</italic></sub>: weighted fraction of photoactive material. This accounts for that fraction of the microstructure that absorbs incident light and produces excitons. This also accounts for decaying light intensity as light propagates through a semi-transparent media (light intensity decays with distance from the top electrode);<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{abs} = \mathop {\sum}\limits_{i = 0}^{n_D} w_{abs}(d_H)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_Equ1.gif"/></alternatives></disp-formula>where <italic>n</italic><sub><italic>D</italic></sub> is the total number of electron donor vertices, <italic>d</italic><sub><italic>H</italic></sub> is the distance to the top surface, <italic>w</italic><sub><italic>abs</italic></sub> is the weighting function that encodes the probability of light absorption. We consider three scenarios here: <italic>w</italic><sub><italic>abs</italic></sub> = 1 homogeneous light absorption, <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{abs} = exp( - d_H/\lambda )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{abs} = \mathop {\sum}\nolimits_{p = 1}^P a_p(d_H)^p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq6.gif"/></alternatives></inline-formula> is the polynomial of order <italic>p</italic> fitted to the results of Maxwell equation for varying thickness of the device and reflection from the bottom surface accounted for (details provided in <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref>).</p></list-item><list-item><p id="Par19"><italic>f</italic><sub><italic>diss</italic></sub> : weighted fraction of donor with weighting based on the distance to the donor–acceptor interface. This feature accounts for the ability of the microstructure to successfully dissociate the produced excitons. Excitons generated in the donor phase diffuse (i.e., via Brownian motion) and are dissociated only if they reach a boundary. This graph based metric accounts for the average (weighted) distance from any donor vertex to the nearest donor-acceptor interface;<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{diss} = \mathop {\sum}\limits_{i = 0}^{n_D} w_{diss}(d_I)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_Equ2.gif"/></alternatives></disp-formula>where <italic>d</italic><sub><italic>I</italic></sub> is the shortest distance from any donor vertex to the nearest acceptor, <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{diss} = exp( - d_I/L_d)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq7.gif"/></alternatives></inline-formula> is the weighting function that encodes the probability of exciton reaching the interface, and <italic>L</italic><sub><italic>d</italic></sub> is the exitonic diffusion length. Note how domain knowledge (the exciton dissociation length) is gracefully incorporated into the surrogate model.</p></list-item><list-item><p id="Par20"><italic>f</italic><sub><italic>out</italic></sub>: fraction of complementary paths to the electrodes. This graph feature encodes the availability (and length) of charge transport pathways for the produced electrons and holes to move through microstructure and reach the electrodes where they are collected to form useful current:<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{out} = \mathop {\sum}\limits_{i = 0}^{n_D^C} w_{tort}(\tau _D) + \mathop {\sum}\limits_{i = i}^{n_A^C} w_{tort}(\tau _A)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_D^C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq8.gif"/></alternatives></inline-formula> is the total number of donor vertices that are connected to anode, <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_A^C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq9.gif"/></alternatives></inline-formula> is the total number of acceptor vertices connected to cathode. Both set of vertices are identified using the connected component algorithm,<sup><xref ref-type="bibr" rid="CR26">27</xref></sup> which is a standard graph algorithm. For each vertex the shortest path towards the respective electrode is determined along with the tortuosity. Tortuosity is defined as the ratio between the shortest path via the appropriate domain (donor or acceptor) versus the shortest straight path without any obstacles. A tortuosity of one corresponds to a straight rising path, where the shortest path is equivalent to the straight path without any obstacles. The tortuosity is calculated for each vertex and subsequently weighted by the function <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{tort} = exp( - 4(\tau - 1))$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq10.gif"/></alternatives></inline-formula>. The weighting function penalizes the curvy pathways where more recombination can occur and reinforce the straight paths.</p></list-item></list><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Correlations between surrogate model and physics based performance characteristics. (Left) correlation between device performance metric (short circuit current in mA/cm<sup>2</sup>) and descriptors <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {f = f_{abs}f_{diss}f_{out}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2018_108_Article_IEq11.gif"/></alternatives></inline-formula>, (Middle and right) Individual contributions from graph features describing exciton dissociation and charge transport, respectively. These results are consistent across different graph sizes</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2018_108_Fig2_HTML.png"/></fig></p><p id="Par21">To demonstrate the robustness of the surrogate model, Fig. <xref rid="Fig2" ref-type="fig">2</xref> depicts the correlation between graph-based descriptors (surrogate model) and performance metrics from exitonic drift diffusion model (physics-based model).<sup><xref ref-type="bibr" rid="CR36">37</xref></sup> We plot three metrics, full performance evaluation and two major contributions to the performance, namely exciton dissociation and charge transport. The correlation coefficient for three metrics are 96.65%, 96.95% and 58.81%, respectively. In each subplot, we plot data for three resolutions of the adaptive exploration: 20 × 20, 40 × 40, and 80 × 80. One data point corresponds to one iteration of the optimization. This analysis was performed on data collected during optimization. In particular, for each iteration of the optimization, we saved the best performing intermediate candidate morphology and run the physics-based simulation. Our correlation studies show that the surrogate model is well correlated with the physics-based model at all stages of the optimization.</p><p id="Par22">Figure <xref rid="Fig3" ref-type="fig">3</xref> (top panel) illustrates results for the evolution of the morphology from an initially uniform random distribution. We consider a device thickness of 100 nm, which is typical for OSC devices. We assumed a homogeneous light absorption scenario (i.e., a non-reflecting bottom surface). The PbIL algorithm identifies a dendritic type structure, which is uncommon in OSC’s. Interestingly, this structure exhibits a bicontinuous interpenetrated network of well balanced donor and acceptor domains with domain size comparable to the exciton diffusion length (which is set as <italic>L</italic><sub><italic>d</italic></sub> = 10 nm). This dendritic structure exhibits a graceful combination of two competing requirements—having a large donor–acceptor interface to enable efficient exciton dissociation, while still providing straight, fully connected domains to enable efficient charge transfer and collection. In fact, the currently believed optimal morphology—an interdigitated columnar morphology—is though to be optimal for precisely this reason.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Microstructure optimization for a typical organic solar cell device configuration. (Top) The morphogenesis from an initial guess towards the final optimized structure. (Bottom) Effect of initial probability field on the morphogenesis outcome. Three initial probability fields: bilayer, uniform and interdigitated initial field evolve towards consistently similar morphologies with statistically similar properties and fractal dimensions</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2018_108_Fig3_HTML.png"/></fig></p><p id="Par23">We virtually interrogate the dendritic microstructure using a morphology-aware physics-based device simulator.<sup><xref ref-type="bibr" rid="CR36">37</xref></sup> The device simulator calculates the short circuit current density, <italic>J</italic><sub><italic>sc</italic></sub> by solving the associated exciton-drift-diffusion equations (see <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref>). The predicted <italic>J</italic><sub><italic>sc</italic></sub> for the dendritic structure is 8.9 mA cm<sup>−2</sup>, which is substantially larger than the <italic>J</italic><sub><italic>sc</italic></sub> = 5.28 mA cm<sup>−2</sup> exhibited by the interdigitated columnar morphology. As anticipated, this is due to enhanced exciton dissociation with minimal increase in recombination. More specifically, the increased donor–acceptor interfacial area results in enhanced exciton dissociation, while the charge transport pathways remain relatively non-tortuous, resulting in minimal performance degradation due to recombination.</p></sec><sec id="Sec6"><title>Incorporating domain knowledge into morphogenesis</title><p id="Par24">We next account for domain knowledge about features of an optimal microstructure into the graph based optimization. Instead of starting from a random initial distribution, we repeat the morphogenesis by initializing the material distribution with the interdigitated columnar morphology (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The ensuing optimized microstructure improves upon the initial guess, and exhibits a <italic>J</italic><sub><italic>sc</italic></sub> = 9 mA cm<sup>−2</sup>. Interestingly, the optimization only changes the material distribution very slightly (see movie <xref ref-type="supplementary-material" rid="MOESM2">M1</xref> in <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref>) by creating the secondary dendritic arms that increase the donor–acceptor interfacial area. We also used a bad initial guess by using a bilayer morphology (which exhibits a <italic>J</italic><sub><italic>sc</italic></sub> = 0.8 mA cm<sup>−2</sup>) as the initial distribution. Here, the optimization produces both primary and secondary dendrites (see movie <xref ref-type="supplementary-material" rid="MOESM3">M2</xref> in <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref>) as the optimization proceeds (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p></sec><sec id="Sec7"><title>Universal scaling</title><p id="Par25">Searching for a distribution rather than a specific solution seems to make the framework agnostic to initial distributions, with all three optima exhibiting similar <italic>J</italic><sub><italic>sc</italic></sub>. We qualitatively check this by rerunning the optimization five times, with different random seeds, for each of the three initial distributions considered (random, bilayer, interdigitated). All 15 morphologies exhibited very similar <italic>J</italic><sub><italic>sc</italic></sub> with a 3% variability across the optima. While visually dissimilar, all exhibited similar statistical properties, especially a fractal dimension around 1.5. This suggests that a whole class of morphologies could potentially be optimal. Moreover, we found the fractal dimension to be close to that of quadratic cross (1.49<sup><xref ref-type="bibr" rid="CR37">38</xref></sup>). This is consistent with dendritic structure where perpendicular side branches mimic quadratic cross topology. Although morphologies we report in this paper have columnar dendritic structure, it is interesting to see consistent fractal dimension with quadratic cross topology.</p></sec><sec id="Sec8"><title>Effect of changing device architecture</title><p id="Par26">We next explore variations in the optimal morphology when light reflecting boundary conditions are imposed at the bottom electrode. As we emphasized earlier, accounting for this new aspect of physical phenomena is trivial: we simply augment the graph surrogate with a weighting term that encodes a thickness dependent light intensity (see <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref> for details). Figure <xref rid="Fig4" ref-type="fig">4</xref> depicts the optimized microstructure for this scenario. Notice that the absorption of the reflected light favors more donor phase in the middle of the active layer. However, the morphology still exhibits a dendritic structure with nearly the same fractal dimensions.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Effect of changing device architecture: light absorption scenario and device thickness. Two device thicknesses and three light reflection scenarios evolve towards consistently similar morphologies. Optimized morphologies demonstrate superior properties for a range of device configurations</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2018_108_Fig4_HTML.png"/></fig></p></sec><sec id="Sec9"><title>Optimal morphology for thicker devices</title><p id="Par27">We finally explore variations in the optimized microstructure with increasing device thickness. This is a pressing problem in commercializing OSCs as increasing the device thickness can potentially enable absorbing (and converting) more incident radiation, but usually results in poor performance due to the concomitant increased recombination resulting from increased charge transport pathways. Figure <xref rid="Fig4" ref-type="fig">4</xref> compares the optimized microstructures for thin (100 nm) and thicker devices (250 nm). The thicker device has 28.9% more incident radiation that is absorbed. Interestingly, most of this additional incident energy is converted to collected current, with the short circuit current improving from <italic>J</italic><sub><italic>sc</italic></sub> = 8.05 mA cm<sup>−2</sup> for the 100 nm device to <italic>J</italic><sub><italic>sc</italic></sub> = 10.09 mA cm<sup>−2</sup> for thicker devices. Notice that the morphology for the thicker device exhibits a similar dendritic structure with similar fractal dimensions (∼1.5). However, we notice two types of dendrites within the thicker devices. Dendrites with only first order side branches are promoted close to the top, while higher order branching is promoted in the bottom of the device. The fractal dimension of this structure is marginally larger than that exhibited by the thinner device, due to this complexity. The heterogeneity of the optimized structure demonstrates the robustness of the surrogate model in the search of structures with spatially varying complexity.</p><p id="Par28">In summary, microstructure-sensitive design has become an indispensable part of the materials discovery paradigm. However, the identification of optimal microstructures (morphogenesis) has traditionally been hindered by twin bottlenecks, namely non-trivial approaches for microstructure perturbations (i.e., searching the microstructure space), and complex approaches for microstructure-to-property mappings. Here, we illustrate how both these issues can be efficiently resolved via a graph-based strategy. Treating microstructures as graphs allows efficient, modular, and extensible representation which results in simple approaches to perturb and explore the microstructure space. Simultaneously, graph based measures (that can be rapidly, and efficiently computed) make excellent surrogates of microstructure-to-property mapping. This graph based representation and graph-to-property surrogate mapper can be integrated with a probabilistic optimization strategy to efficiently identify optimal microstructures. A graph based approach furthermore allows natural incorporation of domain knowledge into the design process. We illustrate a proof-of-concept application by designing the optimal structure for OSC. This resulted in the identification of a new class of microstructures that exhibit better performance than the currently hypothesized optimal microstructure. We anticipate and look forward to widespread use of this microstructure design strategy by the materials community.</p></sec></sec><sec id="Sec10" sec-type="methods"><title>Methods</title><p id="Par29">For the design framework, an in-house C++ code is used that implements probabilistic graph-based optimization. In each iteration of the optimization, <italic>n</italic> = 4000 samples are generated from the current distribution. Each realization is evaluated according to the cost function, and <italic>n</italic><sub><italic>b</italic></sub> = 100 best microstructures are chosen to compute the update vector <bold>P</bold><sub><italic>u</italic></sub>. The learning rate is set as 0.1. The search terminates when no improvement in cost is recorded over 100 consecutive iterations. The cost function is defined through the surrogate model evaluated directly on the graph as discussed in the text. The model is constructed to approximate a short circuit current of the device. Specifically, the full model consists of the exitonic drift diffusion model and is used to calculate the short circuit current <italic>J</italic><sub><italic>sc</italic></sub>. More details can be found in<sup><xref ref-type="bibr" rid="CR22">23</xref></sup> and <xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref>. To determine statistical similarity, all microstructures are characterized with fractal dimension. In particular, the Hausdorff (box-counting) fractal dimension has been computed for binary image using MATLAB function hausDim. More details are given in Supplementary Information.</p></sec></body><back><ack><title>Acknowledgements</title><p>This work was supported by National Science Foundation (award number 1435587). The simulations were performed at the Center for Computational Research at the University at Buffalo.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>P.D. and A.Z. contributed to results generation and subsequent analysis. J.Z., B.G., and O.W. contributed to problem formulations and project oversight. All authors contributed to the manuscript preparation.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>The data that support the findings of this study are available from the corresponding author upon reasonable request.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par30">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aage</surname><given-names>N</given-names></name><name><surname>Andreassen</surname><given-names>E</given-names></name><name><surname>Lazarov</surname><given-names>BS</given-names></name><name><surname>Sigmund</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">Giga-voxel computational morphogenesis for structural design</article-title><source>Nature</source><year>2017</year><volume>550</volume><fpage>84</fpage><pub-id pub-id-type="doi">10.1038/nature23911</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fullwood</surname><given-names>DT</given-names></name><name><surname>Niezgoda</surname><given-names>SR</given-names></name><name><surname>Adams</surname><given-names>BL</given-names></name><name><surname>Surya</surname><given-names>RK</given-names></name></person-group><article-title xml:lang="en">Microstructure sensitive design for performance optimization</article-title><source>Prog. Mater. Sci.</source><year>2010</year><volume>55</volume><fpage>477</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1016/j.pmatsci.2009.08.002</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Torquato, S. <italic>Random Heterogeneous Materials: Microstructure and Macroscopic Properties</italic>, Volume 16 (Springer Science &amp; Business Media: New York, 2013).</mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alberto Salleo</surname><given-names>RJ</given-names></name><name><surname>Kline</surname><given-names>DM</given-names></name><name><surname>DeLongchamp</surname></name><name><surname>Michael</surname><given-names>LC</given-names></name></person-group><article-title xml:lang="en">Microstructural characterization and charge transport in thin films of conjugated polymers</article-title><source>Adv. Mater.</source><year>2010</year><volume>22</volume><fpage>3812</fpage><lpage>3838</lpage><pub-id pub-id-type="doi">10.1002/adma.200903712</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>JR</given-names></name><etal/></person-group><article-title xml:lang="en">Three-dimensional reconstruction of a solid-oxide fuel-cell anode</article-title><source>Nat. Mater.</source><year>2006</year><volume>5</volume><fpage>541</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1038/nmat1668</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quirk</surname><given-names>JP</given-names></name></person-group><article-title xml:lang="en">The significance of the threshold and turbidity concentrations in relation to sodicity and microstructure</article-title><source>Soil Res.</source><year>2001</year><volume>39</volume><fpage>1185</fpage><lpage>1217</lpage><pub-id pub-id-type="doi">10.1071/SR00050</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garca</surname><given-names>RE</given-names></name><name><surname>Chiang</surname><given-names>YM</given-names></name><name><surname>Carter</surname><given-names>WC</given-names></name><name><surname>Limthongkul</surname><given-names>P</given-names></name><name><surname>Bishop</surname><given-names>CM</given-names></name></person-group><article-title xml:lang="en">Microstructural modeling and design of rechargeable lithium-ion batteries</article-title><source>J. Electrochem. Soc.</source><year>2005</year><volume>152</volume><fpage>A255</fpage><lpage>A263</lpage><pub-id pub-id-type="doi">10.1149/1.1836132</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>John</surname><given-names>EA</given-names></name></person-group><article-title xml:lang="en">Organic electronics: addressing challenges</article-title><source>Nat. Mater.</source><year>2014</year><volume>13</volume><fpage>773</fpage><lpage>775</lpage><pub-id pub-id-type="doi">10.1038/nmat4034</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>HB</given-names></name><etal/></person-group><article-title xml:lang="en">A flexible and highly pressure-sensitive graphene-polyurethane sponge based on fractured microstructure design</article-title><source>Adv. Mater.</source><year>2013</year><volume>25</volume><fpage>6692</fpage><lpage>6698</lpage><pub-id pub-id-type="doi">10.1002/adma.201303041</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalidindi</surname><given-names>SR</given-names></name><name><surname>Landi</surname><given-names>G</given-names></name><name><surname>Fullwood</surname><given-names>DT</given-names></name></person-group><article-title xml:lang="en">Spectral representation of higher-order localization relationships for elastic behavior of polycrystalline cubic materials</article-title><source>Acta Mater.</source><year>2008</year><volume>56</volume><fpage>3843</fpage><lpage>3853</lpage><pub-id pub-id-type="doi">10.1016/j.actamat.2008.01.058</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saheli</surname><given-names>G</given-names></name><name><surname>Garmestani</surname><given-names>H</given-names></name><name><surname>Adams</surname><given-names>BL</given-names></name></person-group><article-title xml:lang="en">Microstructure design of a two phase composite using two-point correlation functions</article-title><source>J. Comput.-Aided Mater. Des.</source><year>2004</year><volume>11</volume><fpage>103</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1007/s10820-005-3164-3</pub-id></mixed-citation></ref><ref id="CR38"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeong</surname><given-names>CLY</given-names></name><name><surname>Salvatore</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Reconstructing random media</article-title><source>Phys. Rev. E</source><year>1998</year><volume>57</volume><fpage>495</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.57.495</pub-id></mixed-citation></ref><ref id="CR12"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzue</surname><given-names>Y</given-names></name><name><surname>Shikazono</surname><given-names>N</given-names></name><name><surname>Kasagi</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Micro modeling of solid oxide fuel cell anode based on stochastic reconstruction</article-title><source>J. Power Sources</source><year>2008</year><volume>184</volume><fpage>52</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2008.06.029</pub-id></mixed-citation></ref><ref id="CR13"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brabec</surname><given-names>CJ</given-names></name><etal/></person-group><article-title xml:lang="en">Plastic solar cells</article-title><source>Adv. Funct. Mater.</source><year>2001</year><volume>11</volume><fpage>15</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1002/1616-3028(200102)11:1&lt;15::AID-ADFM15&gt;3.0.CO;2-A</pub-id></mixed-citation></ref><ref id="CR14"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blatov</surname><given-names>VA</given-names></name><name><surname>Shevchenko</surname><given-names>AP</given-names></name><name><surname>Proserpio</surname><given-names>DM</given-names></name></person-group><article-title xml:lang="en">Applied topological analysis of crystal structures with the program package topospro</article-title><source>Cryst. Growth Des.</source><year>2014</year><volume>14</volume><fpage>3576</fpage><lpage>3586</lpage><pub-id pub-id-type="doi">10.1021/cg500498k</pub-id></mixed-citation></ref><ref id="CR15"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sumpter</surname><given-names>BG</given-names></name><name><surname>Noid</surname><given-names>DW</given-names></name></person-group><article-title xml:lang="en">Neural networks and graph theory as computational tools for predicting polymer properties</article-title><source>Macromol. Theory Simul.</source><year>1994</year><volume>3</volume><fpage>363</fpage><lpage>378</lpage><pub-id pub-id-type="doi">10.1002/mats.1994.040030207</pub-id></mixed-citation></ref><ref id="CR16"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>OK</given-names></name><name><surname>Lund</surname><given-names>JM</given-names></name><name><surname>Critchfield</surname><given-names>TR</given-names></name></person-group><article-title xml:lang="en">Spectral graph theory for characterization and homogenization of grain boundary networks</article-title><source>Acta Mater.</source><year>2018</year><volume>146</volume><fpage>42</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1016/j.actamat.2017.11.054</pub-id></mixed-citation></ref><ref id="CR17"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moghadam</surname><given-names>MM</given-names></name><name><surname>Rickman</surname><given-names>JM</given-names></name><name><surname>Harmer</surname><given-names>MP</given-names></name><name><surname>Chan</surname><given-names>HM</given-names></name></person-group><article-title xml:lang="en">The role of boundary variability in polycrystalline grain-boundary diffusion</article-title><source>J. Appl. Phys.</source><year>2015</year><volume>117</volume><fpage>045311</fpage><pub-id pub-id-type="doi">10.1063/1.4906778</pub-id></mixed-citation></ref><ref id="CR18"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cecen</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Microstructure analysis tools for quantification of key structural properties of fuel cell materials</article-title><source>ECS Trans.</source><year>2011</year><volume>41</volume><fpage>679</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1149/1.3635602</pub-id></mixed-citation></ref><ref id="CR19"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wodo</surname><given-names>O</given-names></name><name><surname>Tirthapura</surname><given-names>S</given-names></name><name><surname>Chaudhary</surname><given-names>S</given-names></name><name><surname>Ganapathysubramanian</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">A graph-based formulation for computational characterization of bulk heterojunction morphology</article-title><source>Org. Electron.</source><year>2012</year><volume>13</volume><fpage>1105</fpage><lpage>1113</lpage><pub-id pub-id-type="doi">10.1016/j.orgel.2012.03.007</pub-id></mixed-citation></ref><ref id="CR20"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armstrong</surname><given-names>RW</given-names></name><name><surname>Codd</surname><given-names>I</given-names></name><name><surname>Douthwaite</surname><given-names>RM</given-names></name><name><surname>Petch</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">The plastic deformation of polycrystalline aggregates</article-title><source>Philos. Mag.</source><year>1962</year><volume>7</volume><fpage>45</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1080/14786436208201857</pub-id></mixed-citation></ref><ref id="CR21"><label>22.</label><mixed-citation publication-type="other">Forrester, A. et al. <italic>Engineering Design via Surrogate Modelling: A Practical Guide.</italic> (John Wiley &amp; Sons: West Sussex, United Kingdom, 2008).</mixed-citation></ref><ref id="CR22"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wodo</surname><given-names>O</given-names></name><name><surname>Zola</surname><given-names>J</given-names></name><name><surname>Pokuri</surname><given-names>BSS</given-names></name><name><surname>Du</surname><given-names>P</given-names></name><name><surname>Ganapathysubramanian</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Automated, high throughput exploration of process-structure-property relationships using the mapreduce paradigm</article-title><source>Mater. Discov.</source><year>2015</year><volume>1</volume><fpage>21</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1016/j.md.2015.12.001</pub-id></mixed-citation></ref><ref id="CR23"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryant</surname><given-names>SL</given-names></name><name><surname>Mellor</surname><given-names>DW</given-names></name><name><surname>Christopher</surname><given-names>AC</given-names></name></person-group><article-title xml:lang="en">Physically representative network models of transport in porous media</article-title><source>AIChE J.</source><year>1993</year><volume>39</volume><fpage>387</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1002/aic.690390303</pub-id></mixed-citation></ref><ref id="CR24"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cecen</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">3-d microstructure analysis of fuel cell materials: spatial distributions of tortuosity, void size and diffusivity</article-title><source>J. Electrochem. Soc.</source><year>2012</year><volume>159</volume><fpage>B299</fpage><lpage>B307</lpage><pub-id pub-id-type="doi">10.1149/2.068203jes</pub-id></mixed-citation></ref><ref id="CR25"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogel</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">A numerical experiment on pore size, pore connectivity, water retention, permeability, and solute transport using network models</article-title><source>Eur. J. Soil Sci.</source><year>2000</year><volume>51</volume><fpage>99</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1046/j.1365-2389.2000.00275.x</pub-id></mixed-citation></ref><ref id="CR26"><label>27.</label><mixed-citation publication-type="other">Cormen, T. H. <italic>Introduction to Algorithms.</italic> (MIT press: Cambridge, Massachusetts, 2009).</mixed-citation></ref><ref id="CR27"><label>28.</label><mixed-citation publication-type="other">West, D. B. et al. <italic>Introduction to Graph Theory</italic>, Volume 2 (Prentice Hall: Upper Saddle River, New Jersey 2001).</mixed-citation></ref><ref id="CR28"><label>29.</label><mixed-citation publication-type="other">Baluja, S. Population-based incremental learning: A method for integrating genetic search based function optimization and competitive learning. Technical report, School of Computer Science, Carnegie Mellon University, 1994.</mixed-citation></ref><ref id="CR29"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoecklein</surname><given-names>D</given-names></name><name><surname>Wu</surname><given-names>CY</given-names></name><name><surname>Kim</surname><given-names>Donghyuk</given-names></name><name><surname>Carlo</surname><given-names>DD</given-names></name><name><surname>Ganapathysubramanian</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Optimization of micropillar sequences for fluid flow sculpting</article-title><source>Phys. Fluids</source><year>2016</year><volume>28</volume><fpage>012003</fpage><pub-id pub-id-type="doi">10.1063/1.4939512</pub-id></mixed-citation></ref><ref id="CR30"><label>31.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Russell</surname><given-names>SJ</given-names></name><name><surname>Norvig</surname><given-names>P</given-names></name></person-group><source>Artificial intelligence: a modern approach</source><year>2016</year><publisher-loc>Malaysia</publisher-loc><publisher-name>Pearson Education Limited</publisher-name></mixed-citation></ref><ref id="CR31"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>NE</given-names></name><name><surname>Savoie</surname><given-names>BM</given-names></name><name><surname>Chen</surname><given-names>LX</given-names></name><name><surname>Ratner.</surname><given-names>MA</given-names></name></person-group><article-title xml:lang="en">A simple index for characterizing charge transport in molecular materials</article-title><source>J. Phys. Chem. Lett.</source><year>2015</year><volume>6</volume><fpage>1018</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1021/acs.jpclett.5b00135</pub-id></mixed-citation></ref><ref id="CR32"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eperon</surname><given-names>GE</given-names></name><name><surname>Burlakov</surname><given-names>VM</given-names></name><name><surname>Docampo</surname><given-names>P</given-names></name><name><surname>Goriely</surname><given-names>A</given-names></name><name><surname>Henry</surname><given-names>JS</given-names></name></person-group><article-title xml:lang="en">Morphological control for high performance, solution-processed planar heterojunction perovskite solar cells</article-title><source>Adv. Funct. Mater.</source><year>2014</year><volume>24</volume><fpage>151</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1002/adfm.201302090</pub-id></mixed-citation></ref><ref id="CR33"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Kramer</surname><given-names>EJ</given-names></name><name><surname>Heeger</surname><given-names>AJ</given-names></name><name><surname>Bazan.</surname><given-names>GC</given-names></name></person-group><article-title xml:lang="en">Bulk heterojunction solar cells: morphology and performance relationships</article-title><source>Chem. Rev.</source><year>2014</year><volume>114</volume><fpage>7006</fpage><lpage>7043</lpage><pub-id pub-id-type="doi">10.1021/cr400353v</pub-id></mixed-citation></ref><ref id="CR34"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">High-efficiency solution processable polymer photovoltaic cells by self-organization of polymer blends</article-title><source>Nat. Mater.</source><year>2005</year><volume>4</volume><fpage>864</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1038/nmat1500</pub-id></mixed-citation></ref><ref id="CR35"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaheen</surname><given-names>SE</given-names></name><etal/></person-group><article-title xml:lang="en">2.5% efficient organic plastic solar cells</article-title><source>Appl. Phys. Lett.</source><year>2001</year><volume>78</volume><fpage>841</fpage><lpage>843</lpage><pub-id pub-id-type="doi">10.1063/1.1345834</pub-id></mixed-citation></ref><ref id="CR36"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kodali</surname><given-names>HK</given-names></name><name><surname>Ganapathysubramanian</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">A computational framework to investigate charge transport in heterogeneous organic photovoltaic devices</article-title><source>Comput. Methods Appl. Mech. Eng.</source><year>2012</year><volume>247</volume><fpage>113</fpage><lpage>129</lpage><pub-id pub-id-type="doi">10.1016/j.cma.2012.08.012</pub-id></mixed-citation></ref><ref id="CR37"><label>38.</label><mixed-citation publication-type="other">Vicsek, T. S. <italic>Fractal Growth Phenomena</italic> (World scientific, 1992).</mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec12"><title>Electronic supplementary material</title><p id="Par31"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41524_2018_108_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary information</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Electronic supplementary material"><media mimetype="video" mime-subtype="x-msvideo" xlink:href="MediaObjects/41524_2018_108_MOESM2_ESM.avi" position="anchor"><caption xml:lang="en"><p>Movie M1: Supplementary information</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Electronic supplementary material"><media mimetype="video" mime-subtype="x-msvideo" xlink:href="MediaObjects/41524_2018_108_MOESM3_ESM.avi" position="anchor"><caption xml:lang="en"><p>Movie M2: Supplementary information</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Electronic supplementary material</title><p><bold>Supplementary information</bold> accompanies the paper on the <italic>npj Computational Materials</italic> website (<ext-link xlink:href="10.1038/s41524-018-0108-5" ext-link-type="doi">https://doi.org/10.1038/s41524-018-0108-5</ext-link>).</p></notes><notes notes-type="Misc"><p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Characterization and Evaluation of Materials</facet-value><facet-value count="1">Computational Intelligence</facet-value><facet-value count="1">Materials Science</facet-value><facet-value count="1">Materials Science, general</facet-value><facet-value count="1">Mathematical and Computational Engineering</facet-value><facet-value count="1">Mathematical Modeling and Industrial Mathematics</facet-value><facet-value count="1">Theoretical, Mathematical and Computational Physics</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">npj Computational Materials</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
