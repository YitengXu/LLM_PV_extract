<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41467-020-15273-1</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" specific-use="web-only" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41467</journal-id><journal-id journal-id-type="doi">10.1038/41467.2041-1723</journal-id><journal-title-group><journal-title>Nature Communications</journal-title><abbrev-journal-title abbrev-type="publisher">Nat Commun</abbrev-journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41467-020-15273-1</article-id><article-id pub-id-type="manuscript">15273</article-id><article-id pub-id-type="doi">10.1038/s41467-020-15273-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/624/1075/1081</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/624/399/1015</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/132</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Surface-wave-assisted nonreciprocity in spatio-temporally modulated metasurfaces</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Cardin</surname><given-names>Andrew E.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Silva</surname><given-names>Sinhara R.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Vardeny</surname><given-names>Shai R.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7734-8847</contrib-id><name><surname>Padilla</surname><given-names>Willie J.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Saxena</surname><given-names>Avadh</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au6"><name><surname>Taylor</surname><given-names>Antoinette J.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au7"><name><surname>Kort-Kamp</surname><given-names>Wilton J. M.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au8"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2014-7571</contrib-id><name><surname>Chen</surname><given-names>Hou-Tong</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au9"><name><surname>Dalvit</surname><given-names>Diego A. R.</given-names></name><address><email>dalvit@lanl.gov</email></address><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="corresp" rid="IDs41467020152731_cor9">j</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au10"><name><surname>Azad</surname><given-names>Abul K.</given-names></name><address><email>aazad@lanl.gov</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41467020152731_cor10">k</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0428 3079</institution-id><institution-id institution-id-type="GRID">grid.148313.c</institution-id><institution content-type="org-name">Center for Integrated Nanotechnologies, Los Alamos National Laboratory</institution></institution-wrap><addr-line content-type="postcode">87545</addr-line><addr-line content-type="city">Los Alamos</addr-line><addr-line content-type="state">NM</addr-line><country country="US">USA</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7961</institution-id><institution-id institution-id-type="GRID">grid.26009.3d</institution-id><institution content-type="org-division">Department of Electrical and Computer Engineering</institution><institution content-type="org-name">Duke University</institution></institution-wrap><addr-line content-type="postcode">27708</addr-line><addr-line content-type="city">Durham</addr-line><addr-line content-type="state">NC</addr-line><country country="US">USA</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0428 3079</institution-id><institution-id institution-id-type="GRID">grid.148313.c</institution-id><institution content-type="org-name">Theoretical Division, Los Alamos National Laboratory</institution></institution-wrap><addr-line content-type="postcode">87545</addr-line><addr-line content-type="city">Los Alamos</addr-line><addr-line content-type="state">NM</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><corresp id="IDs41467020152731_cor9"><label>j</label><email>dalvit@lanl.gov</email></corresp><corresp id="IDs41467020152731_cor10"><label>k</label><email>aazad@lanl.gov</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>3</month><year>2020</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2020</year></pub-date><volume>11</volume><issue seq="1469">1</issue><elocation-id>1469</elocation-id><history><date date-type="registration"><day>3</day><month>3</month><year>2020</year></date><date date-type="received"><day>13</day><month>2</month><year>2020</year></date><date date-type="accepted"><day>28</day><month>2</month><year>2020</year></date><date date-type="online"><day>19</day><month>3</month><year>2020</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2020</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Emerging photonic functionalities are mostly governed by the fundamental principle of Lorentz reciprocity. Lifting the constraints imposed by this principle could circumvent deleterious effects that limit the performance of photonic systems. Most efforts to date have been limited to waveguide platforms. Here, we propose and experimentally demonstrate a spatio-temporally modulated metasurface capable of complete violation of Lorentz reciprocity by reflecting an incident beam into far-field radiation in forward scattering, but into near-field surface waves in reverse scattering. These observations are shown both in nonreciprocal beam steering and nonreciprocal focusing. We also demonstrate nonreciprocal behavior of propagative-only waves in the frequency- and momentum-domains, and simultaneously in both. We develop a generalized Bloch-Floquet theory which offers physical insights into Lorentz nonreciprocity for arbitrary spatial phase gradients, and its predictions are in excellent agreement with experiments. Our work opens exciting opportunities in applications where free-space nonreciprocal wave propagation is desired.</p></abstract><abstract xml:lang="en" id="Abs2" abstract-type="ShortSummary"><p id="Par2">Overcoming reciprocity is important for novel functionalities. Here, the authors demonstrate a spatio-temporally modulated metasurface capable of complete violation of Lorentz reciprocity by reflecting an incident beam into far-field radiation in forward scattering, but into near-field surface waves in reverse scattering.</p></abstract><funding-group><award-group><funding-source><institution-wrap><institution>DOE | LDRD | Los Alamos National Laboratory (Los Alamos Lab)</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">https://doi.org/10.13039/100008902</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">20180062DR</award-id><principal-award-recipient><name><surname>Dalvit</surname><given-names>Diego A. R.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Research</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41467_2020_Article_15273.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">The electromagnetic Lorentz reciprocity theorem<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup> states that in a linear, time-independent system with symmetric constitutive optical tensors, the ratio between received and transmitted fields are the same for forward and time-reversed propagation directions. While most electromagnetic and photonic devices operate under this principle, there are circumstances in which reciprocity has undesirable effects, e.g., photovoltaic cells re-emitting absorbed solar energy or antennas listening to their own echo. In order to break reciprocity, any of the conditions assumed by the Lorentz theorem must be violated. The use of magneto-optical media breaks time-inversion symmetry and results in an asymmetric scattering matrix, thereby accomplishing optical isolation<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>; however, bulky magnets are required for external bias rendering this conventional approach infeasible for systems integration. Incorporating nonlinear materials and using the electric field self-biasing effect can also result in optical isolation<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>, but the degree of nonreciprocity is power-dependent and typically requires significant interaction lengths. Breakdown of Lorentz reciprocity has also been demonstrated using spatio-temporally modulated waveguides<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup> and leaky-wave antennas<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>. The space-time modulation approach can be particularly attractive when applied in metasurface platforms due to its advantages in reduced size, improved integrability, and attaining surface-wave-assisted nonreciprocal behavior.</p><p id="Par4">The advent of metasurfaces<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup> has allowed enhanced light-matter interactions within ultra-thin structures, enabling tailored scattering amplitude, phase, and polarization, as well as facilitating the integration of functional materials to accomplish active control<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. Spatially varying phase profiles in judiciously designed static gradient metasurfaces have provided a powerful means to manipulate the momentum harmonic contents of scattered light, ushering in a novel class of flat optics. In addition, active metasurfaces have been shown to be capable of either switching wave-front profiles whenever needed<sup><xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>, or modulating in time the amplitude and phase of scattered light<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>. However, a fully tailored electromagnetic response requires metasurfaces that can continuously alter their scattering properties simultaneously in time and space. These functionalities can be achieved in spatio-temporally modulated metasurfaces<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> (STMMs), which have the potential to revolutionize fundamental and applied photonics, including nonreciprocity<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>, through on-demand control of frequency and momentum harmonic contents of scattered light. For example, an STMM can focus a collimated beam (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>), but the time-reversed process is not allowed (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). At microwave frequencies, STMMs can be realized with sub-wavelength metasurface resonators embedded with active elements, such as positive-intrinsic-negative diodes or varactors, which are locally modulated through programmable space-time voltage biases. This concept has been employed for frequency-multiplexed directional scattering within waveguide systems containing time-varying Huygens’ metadevices<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. For free-space waves, spatio-temporally modulated coding microwave metasurfaces<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup> have recently been exploited for nonreciprocal beam steering; however, nonreciprocity limited only to the frequency-domain was accomplished. Also, near-infrared non-linear Kerr metasurfaces<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> have recently been reported for breakdown of the Lorentz theorem; the setup is limited to frequency-domain nonreciprocal beam steering achieved via a two-beam Bragg configuration, which is difficult to generalize to arbitrary spatio-temporal modulations. A truly multifunctional STMM that can achieve nonreciprocal propagation of arbitrary wave-fronts, and that can even reach photon-to-photon conversion in forward scattering but photon-to-surface wave conversion in reverse scattering has not been experimentally demonstrated to date. In this sense, we call this an “extreme” breakdown of Lorentz reciprocity as the very nature of the photonic modes is modified in the scattering process, and would lead to giant optical isolation as no propagative modes are radiated in reverse scattering.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><title>Spatio-temporally modulated metasurfaces.</title><p><bold>a</bold> An incident beam impinging on an STMM is converted into a different frequency harmonic that can be focused at any desired focal point. <bold>b</bold> Breakdown of Lorentz reciprocity can be shown by probing the time-reversed process. <bold>c</bold> Photograph of our STMM. <bold>d</bold> Top view and cross-section of the unit cell. All geometrical parameters are in mm.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2020_15273_Fig1_HTML.png"/></fig></p><p id="Par5">Here, we present a spatio-temporally modulated metasurface reflectarray capable of dynamically imprinting arbitrary wave-fronts of free-space electromagnetic waves and demonstrate surface-wave-assisted maximum breakdown of the Lorentz theorem through nonreciprocal mode conversion. We exemplify the flexibility of our STMM platform by achieving dynamical beam steering in forward scattering and, when the forward reflection angle is above a certain threshold, we demonstrate nonreciprocity and complete free-space optical isolation by photon-to-surface wave conversion in reverse scattering. Even below threshold, using propagative-only modes we measure nonreciprocal beam steering behavior both in the frequency-domain and momentum-domain, as well as simultaneously in both. In addition, our STMM platform can produce various other kinds of spatial phase distributions, including dynamical focusing. We show nonreciprocal focusing through co-existence of photon-to-surface wave and photon-to-photon excitations in reverse scattering, the former conversion processes overwhelming the latter ones. Importantly, the resulting optical isolation is quasi-optimal and takes place without the need of surpassing any threshold in forward scattering. To model the experimental results, an analytical generalized Bloch-Floquet theory valid for arbitrary spatial phase distributions is developed, which successfully predicts various phenomena measured in the photon-to-surface waves reverse scattering regime. This work can potentially impact emerging technologies benefiting from free-space dynamical wave-front shaping and nonreciprocity, including adaptive optics, Doppler-like frequency translation, echo-immune antennas, and isolated on-chip communications enabled by robust one-way coupling to surface waves.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Experimental design</title><p id="Par6">A conceptual illustration of an STMM is shown in Fig. <xref rid="Fig1" ref-type="fig">1a, b</xref>, where each unit cell contains active elements that can be independently modulated to impart an arbitrary two-dimensional (2D) phase profile in reflection. In this work, we consider STMMs working at microwave frequencies and varactors as the active elements. Each varactor at position <bold><italic>r</italic></bold> on the STMM is subjected to a time-dependent harmonic voltage modulation <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi>V</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">op</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">sin</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V\left( {{\boldsymbol{r}},t} \right)\,=\,V_{{\mathrm{op}}} + \Delta _V\,{\mathrm{sin}}[\varphi ({\boldsymbol{r}}) - {\mathrm{\Omega }}t]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>V</italic><sub>op</sub> is the operating voltage (or off-set bias), Δ<sub><italic>V</italic></sub> is the voltage modulation amplitude, <italic>φ</italic>(<bold><italic>r</italic></bold>) is the spatial phase distribution, and Ω is the modulation frequency. The voltage modulation translates into a corresponding modulation of the capacitance <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">var</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">op</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">sin</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{\mathrm{var}}}\left( {{\boldsymbol{r}},t} \right)\,=\,C_{{\mathrm{op}}} + \Delta _C\,{\mathrm{sin}}[\varphi ({\boldsymbol{r}}) - {\mathrm{\Omega }}t]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq2.gif"/></alternatives></inline-formula> as long as a linear relationship between <italic>C</italic><sub>var</sub> and <italic>V</italic> holds near <italic>V</italic><sub>op</sub>.</p><p id="Par7">We design and fabricate an STMM on a commercially available double copper clad FR-4 substrate (Fig. <xref rid="Fig1" ref-type="fig">1c, d</xref>). The resonators incorporate two varactor diodes and two capacitors in order to keep a small form factor of the unit cell while providing the required tunability. For simplicity, we restrict the modulation to one dimension by connecting resonators in each column, resulting in spatial modulation among different columns, i.e., along the <italic>x</italic>-direction, but invariant among rows, i.e., <italic>y</italic>-direction (phase delays along this direction can be ignored for Ω ≪ 2π<italic>c</italic>/<italic>L</italic><sub><italic>y</italic></sub>, where <italic>c</italic> is the speed of light in vacuum and <italic>L</italic><sub><italic>y</italic></sub> is the lateral size of the STMM along <italic>y</italic>). Each column is modulated with a desired voltage and phase using a programmable multi-output function generator. Relative phase shifts among channels can be induced by simultaneous triggering of the system, thereby generating arbitrary digitally constructed waveforms (see Methods and Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1</xref>).</p><p id="Par8">The reflectivity of the unmodulated metasurface is characterized inside an anechoic chamber at a 10° incidence angle as a function of frequency for various static bias voltages uniformly applied to all varactors. Figure <xref rid="Fig2" ref-type="fig">2a</xref> shows measurements for <italic>p</italic>-polarized waves, with the magnetic field component along the <italic>y</italic>-direction. At the operating voltage <italic>V</italic><sub>op </sub>= 2 V a resonance appears around 6.6 GHz. The optimal working frequency for the modulated STMM, however, is not exclusively determined by the intrinsic resonances of the unmodulated metasurface, but results from an interplay between the unit cell design and the amplitude and phase of the modulation. Indeed, working away from the 6.6 GHz resonance increases the modulation efficiency (see Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">3c</xref>) and thereby the conversion into frequency harmonics (see Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">4</xref>); however, moving too far from the resonance degrades phase dispersion and breaks the linear <italic>C</italic><sub>var</sub> vs. <italic>V</italic> relationship (see Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">3d</xref>). For our designed STMM and modulation protocol (Δ<sub><italic>V</italic></sub>= 1 V, Ω = 2<italic>π</italic> × 50 kHz), we choose our operational frequency as <italic>ω</italic><sub>in</sub> = 2<italic>π</italic> × 6.9 GHz (<italic>λ</italic><sub>in </sub>= 4.3 cm), which is a good compromise between reflection efficiency, phase dispersion, and linearity.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><title>Dynamical wave-front shaping.</title><p><bold>a</bold> Reflectance measurements for the unmodulated metasurface. <bold>b</bold> Measured on-demand dynamical beam steering of the <italic>n</italic> = +1 harmonic. <bold>c</bold> Calculated spatial distribution of the electric field for on-axis focusing for the <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = \bar n = + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq3.gif"/></alternatives></inline-formula> frequency harmonic (infinite-sized STMM). <bold>d</bold> Measured power for on-axis focusing. <bold>e</bold> Calculated (finite-sized STMM, <italic>L</italic><sub><italic>x</italic></sub> = 19 cm) and measured gain as a function of <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq4.gif"/></alternatives></inline-formula> for off-axis focusing. Error bars are determined by the standard deviation of gain over a narrow angular range within the focal region. <bold>f</bold> Measured power for off-axis focusing. In <bold>b</bold>–<bold>f</bold>, <bold><italic>k</italic></bold><sub>in</sub> = 0, <italic>ω</italic><sub>in</sub> = 2<italic>π</italic> × 6.9 GHz and Ω = 2<italic>π</italic> × 50 kHz. Input power in the experiments is 6.3 mW. Focusing parameters are (<italic>x</italic><sub><italic>f</italic></sub>, <italic>z</italic><sub><italic>f</italic></sub>) = (0,15) cm and (6,15) cm for on-axis and off-axis, respectively.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2020_15273_Fig2_HTML.png"/></fig></p><p id="Par9">To test the nonreciprocal functionalities of our spatio-temporally modulated metasurface, we first perform forward scattering measurements by dynamically imprinting appropriate phase delays <italic>φ</italic>(<bold><italic>r</italic></bold>) among the STMM columns. When applying a linear phase delay, we measure the steered beam as a function of scanning angle and frequency in the far-field, while for focusing we apply a parabolic phase profile for a selected frequency harmonic and map the resulting spatial distribution of the scattered power. Subsequently, the corresponding reverse scattering measurements are performed by effectively time-reversing the output wave-fronts of the forward processes, and measuring the far-field scattered power.</p></sec><sec id="Sec4"><title>Theoretical formulation</title><p id="Par10">We describe the response of the full array of sub-wavelength resonators with an effective 2D conductivity <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi>σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">op</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">sin</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma \left( {{\boldsymbol{r}},\omega ;t} \right) = \sigma _{{\mathrm{op}}}\left( \omega \right) + \Delta \sigma \left( \omega \right){\mathrm{sin}}\left[ {\varphi \left( {\boldsymbol{r}} \right) - {\mathrm{\Omega }}t} \right].$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq5.gif"/></alternatives></inline-formula> Here, <italic>σ</italic><sub>op</sub>(<italic>ω</italic>) is the unmodulated complex conductivity at the operating voltage <italic>V</italic><sub>op</sub> and Δ<italic>σ</italic>(<italic>ω</italic>) is the complex modulation amplitude. We extract <italic>σ</italic><sub>op</sub>(<italic>ω</italic>) and estimate Δ<italic>σ</italic>(<italic>ω</italic>) from reflectivity measurements and standard Fresnel equations for multilayered systems (see Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">3</xref>). When an incident plane wave <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{E}}_\xi ^{{\mathrm{in}}}\left( {{\boldsymbol{r}},z,t} \right) = E^{{\mathrm{in}}} {\hat{\boldsymbol{e}}}_\xi ^ - \left( {{\boldsymbol{k}}_{{\mathrm{in}}}} \right) e^{i({\boldsymbol{r}} \cdot {\boldsymbol{k}}_{{\mathrm{in}}} - z k_{z{\mathrm{v}},{\mathrm{in}}} - \omega _{{\mathrm{in}}}t)}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq6.gif"/></alternatives></inline-formula> with momentum <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\boldsymbol{k}}_{{\mathrm{in}}}, - k_{z{\mathrm{v}},{\mathrm{in}}}{\hat{\mathbf{z}}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq7.gif"/></alternatives></inline-formula> impinges on the STMM, the reflected field for an arbitrary spatial phase distribution <italic>φ</italic>(<bold><italic>r</italic></bold>) on the STMM is given as<disp-formula id="Equ1"><label>1</label><alternatives><mml:math id="Equ1_Math"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">refl</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msup><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mo>∫</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{E}}_\xi ^{{\mathrm{refl}}}\left( {{\boldsymbol{r}},z,t} \right) = E^{{\mathrm{in}}}\mathop {\sum}\limits_{n = - \infty }^\infty {{\int} {\frac{{d^2{\boldsymbol{k}}}}{{\left( {2\pi } \right)^2}}} } {\hat{\boldsymbol{e}}}_\xi ^ + \left( {{\boldsymbol{k}}_n} \right)\tilde {\cal{E}}_{\xi ,n}[{\boldsymbol{k}}_{{\mathrm{in}}},{\boldsymbol{k}}_n,\omega _n;{\boldsymbol{r}}]e^{i({\boldsymbol{r}} \cdot {\boldsymbol{k}}_n + zk_{z{\mathrm{v}},n} - \omega _nt)}.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_Equ1.gif"/></alternatives></disp-formula></p><p id="Par11">Here, <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\boldsymbol{e}}}_\xi ^ \pm \left( {\boldsymbol{k}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq8.gif"/></alternatives></inline-formula> are the <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi = s,p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq9.gif"/></alternatives></inline-formula> polarization unit vectors with ‘+’ and ‘−’ corresponding to waves propagating in the positive and negative <italic>z</italic> directions, respectively; <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _n = \omega _{{\mathrm{in}}} + n{\mathrm{\Omega }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq10.gif"/></alternatives></inline-formula> and <bold><italic>k</italic></bold><sub><italic>n</italic></sub> = <bold><italic>k</italic></bold> + <italic>n</italic>∇<italic>φ</italic>(<bold><italic>r</italic></bold>) are frequency and momentum harmonics, and <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}},n} = \sqrt {(\omega _n/c)^2 - {\boldsymbol{k}}_n^2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq11.gif"/></alternatives></inline-formula>. To compute the reflected field, we develop an analytic Bloch-Floquet approach based on a local derivative expansion of <italic>φ</italic>(<bold><italic>r</italic></bold>), valid for smooth but otherwise general spatial phase distributions. The field amplitude <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq12.gif"/></alternatives></inline-formula> is a functional of both <italic>φ</italic>(<bold><italic>r</italic></bold>) and its gradient ∇<italic>φ</italic>(<bold><italic>r</italic></bold>),<disp-formula id="Equ2"><label>2</label><alternatives><mml:math id="Equ2_Math"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">FT</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">sg</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">sg</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>⋅</mml:mo><mml:mo>∇</mml:mo><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n} = \,R_{\xi ,n}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right)\left\{ {\delta _{n,0}\delta ({\boldsymbol{k}} - {\boldsymbol{k}}_{{\mathrm{in}}}) + \frac{{({1 - \delta _{n,0}} ){\mathrm{FT}}[e^{i{\mathrm{sg}}\left( n \right)\varphi \left( {\boldsymbol{r}} \right)}]}}{{e^{i{\mathrm{sg}}\left( n \right)[\varphi \left( {\boldsymbol{r}} \right) - {\boldsymbol{r}} \cdot \nabla \varphi \left( {\boldsymbol{r}} \right)]}}}{\mathrm{\Lambda }}_{\xi ,n}\left[ {{\boldsymbol{k}}_{{\mathrm{in}}},{\boldsymbol{k}}_n,\omega _n;{\boldsymbol{r}}} \right]} \right\}.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_Equ2.gif"/></alternatives></disp-formula></p><p id="Par12">Here, <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\xi ,n}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq13.gif"/></alternatives></inline-formula> is the reflection coefficient corresponding to the scattering process <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\boldsymbol{k}},\omega _{{\mathrm{in}}}) \to \left( {{\boldsymbol{k}}_n,\omega _n} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq14.gif"/></alternatives></inline-formula> at position <bold><italic>r</italic></bold>, the 2D Fourier transform <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mi mathvariant="normal">FT</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">sg</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{FT}}[e^{i{\mathrm{sg}}(n)\varphi ({\boldsymbol{r}})}]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq15.gif"/></alternatives></inline-formula> is evaluated at <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">sg</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∇</mml:mo><mml:mi>φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{k}} - {\boldsymbol{k}}_{{\mathrm{in}}} + {\mathrm{sg}}(n)\nabla \varphi ({\boldsymbol{r}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq16.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\Lambda }}_{\xi ,n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq17.gif"/></alternatives></inline-formula> is defined in the Methods section (see also Supplementary Notes <xref ref-type="supplementary-material" rid="MOESM1">1</xref>–<xref ref-type="supplementary-material" rid="MOESM1">3</xref> for a derivation of the forward scattered fields and the reflection coefficients). Finally, we mention that when the modulation takes place only over a finite-sized region of the metasurface, the reflected field is still given by Eq. (1) after the Fourier transform in Eq. (2) is replaced by <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mi mathvariant="normal">FT</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">sg</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{FT}}[ {\tilde \theta \left( {\boldsymbol{r}} \right)e^{i{\mathrm{sg}}\left( n \right)\varphi \left( {\boldsymbol{r}} \right)}} ]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq18.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde \theta \left( {\boldsymbol{r}} \right) = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq19.gif"/></alternatives></inline-formula> if <bold><italic>r</italic></bold> belongs to the modulated region and is zero otherwise (see Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">4</xref> for the generalization of our theory to finite-sized STMMs).</p></sec><sec id="Sec5"><title>Dynamical wave-front shaping</title><p id="Par13">In the simplest case of a linear phase distribution <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">steer</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x01d6c3;</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi ^{{\mathrm{steer}}}\left( {\boldsymbol{r}} \right) = {\mathbf{\upbeta }} \cdot {\boldsymbol{r}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq20.gif"/></alternatives></inline-formula> required for beam steering, the amplitude is <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">steer</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">steer</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mi>δ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n}^{{\mathrm{steer}}} = \left( {2\pi } \right)^2R_{\xi ,n}^{{\mathrm{steer}}}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};0} \right)\delta \left( {{\boldsymbol{k}} - {\boldsymbol{k}}_{{\mathrm{in}}}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq21.gif"/></alternatives></inline-formula>. In this case the derivative expansion is exact, and the reflected field is given by a single sum over discrete frequency and momentum harmonics for the scattering processes <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>&#x01d6c3;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\boldsymbol{k}}_{{\mathrm{in}}},\omega _{{\mathrm{in}}}) \to ({\boldsymbol{k}}_{{\mathrm{in}}} + n{\mathbf{\upbeta }},\omega _{{\mathrm{in}}} + n{\mathrm{\Omega }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq22.gif"/></alternatives></inline-formula>. The azimuthal and polar steering angles are, respectively, given by <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>&#x01d6c3;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>&#x01d6c3;</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cos \phi _n = {\boldsymbol{k}}_{{\mathrm{in}}} \cdot ({\boldsymbol{k}}_{{\mathrm{in}}} + n{\mathbf{\upbeta }})/\left[ {\left| {{\boldsymbol{k}}_{{\mathrm{in}}}} \right|\left| {{\boldsymbol{k}}_{{\mathrm{in}}} + n{\mathbf{\upbeta }}} \right|} \right]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mi>sin</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>&#x01d6c3;</mml:mi></mml:mrow></mml:mfenced><mml:mi>c</mml:mi><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sin \theta _n = \left| {{\boldsymbol{k}}_{{\mathrm{in}}} + n{\mathbf{\upbeta }}} \right|c/\omega _n.$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq24.gif"/></alternatives></inline-formula> For large enough momentum “kicks” <italic>n</italic><bold><italic>β</italic></bold>, <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mo>∣</mml:mo><mml:mi>sin</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\sin \theta _n|$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq25.gif"/></alternatives></inline-formula> can become larger than 1 (<inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}},n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq26.gif"/></alternatives></inline-formula> purely imaginary) resulting in surface waves, which we later utilize to achieve photon-to-surface waves conversion in reverse scattering. We first demonstrate the multifunctional beam manipulation capability of our STMM by imprinting arbitrary beam steering phase distributions (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). We vary the phase gradient <bold><italic>β</italic></bold> along the <italic>x</italic>-direction and show beam steering of the +1 harmonic from +40° to −40°. We observe high quality beam steering with low sidebands and consistent amplitude for a wide range of angles.</p><p id="Par14">To test the flexibility of our STMM for imprinting arbitrary reflection phases, we demonstrate dynamical focusing, a functionality that is relevant, e.g., in compact satellite technologies. The required phase distribution to focus a specific frequency harmonic <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mspace width="0.25em"/><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar n\, \ne\, 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq27.gif"/></alternatives></inline-formula> at an arbitrary focal point <bold><italic>R</italic></bold><sub><italic>f</italic></sub> = (<italic>x</italic><sub><italic>f</italic></sub>, <italic>y</italic><sub><italic>f</italic></sub>, <italic>z</italic><sub><italic>f</italic></sub>) is<disp-formula id="Equ3"><label>3</label><alternatives><mml:math id="Equ3_Math"><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _{\bar n}^{{\mathrm{focus}}}\left( {{\boldsymbol{k}}_{{\mathrm{in}}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right) = - \frac{1}{{\bar n}}\left\{ {\frac{{\omega _{\bar n}}}{c}\left( {\left| {{\boldsymbol{r}} - {\boldsymbol{R}}_f} \right| - z_f} \right) + {\boldsymbol{k}}_{{\mathrm{in}}} \cdot \left( {{\boldsymbol{r}} - {\boldsymbol{R}}_f} \right)} \right\}.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_Equ3.gif"/></alternatives></disp-formula></p><p id="Par15">All other harmonics <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:mi>n</mml:mi><mml:mspace width="0.25em"/><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \,\ne\, \bar n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq28.gif"/></alternatives></inline-formula> do not result in perfect focusing, and the case <italic>n</italic> = 0 always undergoes specular reflection in STMMs. In contrast to the steering case, the momentum kicks <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mi>n</mml:mi><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\nabla \varphi _{\bar n}^{{\mathrm{focus}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq29.gif"/></alternatives></inline-formula> vary as a function of position and the amplitude <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n}^{{\mathrm{focus}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq30.gif"/></alternatives></inline-formula> is not proportional to a delta function. These properties hold for any nonlinear phase distribution <italic>φ</italic><sub>NL</sub>(<bold><italic>r</italic></bold>). Importantly, the phase of the reflected field in Eq. (1) arises from an intricate interplay among the phases of each plane-wave component in the momentum integral. Only for the <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = \bar n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq31.gif"/></alternatives></inline-formula> frequency harmonic does the resulting reflection phase turn out to be precisely given by the focusing distribution Eq. (3) (see Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">3</xref> for a discussion of the phase of the total reflection coefficient for the different harmonics). Using our theoretical approach, we first model an infinite-sized STMM subjected to our focusing modulation protocol, that produces a 1D focal line along the <italic>y</italic>-direction, and compute the field distribution for the <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = \bar n = + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq32.gif"/></alternatives></inline-formula> harmonic (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>).</p><p id="Par16">In Fig. <xref rid="Fig2" ref-type="fig">2d, f</xref> we show the experimental results demonstrating the dynamical focusing capability of our STMM (see Methods). Unlike beam steering, which is largely aperture agnostic, focusing requires consideration of the metasurface’s overall dimensions. With a surface in the electric field direction measuring <italic>L</italic><sub><italic>x</italic></sub> = 19 cm (≈ 4.4 <italic>λ</italic><sub>in</sub>), a short focal length is necessary for measurable gain, otherwise weak focusing effects are indistinguishable from the usual plane wave like character of the harmonics. For the on-axis focusing case, it is apparent that focusing has been achieved by examination of the increased power and rapid falloff of the signal. At distances <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>12</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell &lt; 12\,{\mathrm{cm}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq33.gif"/></alternatives></inline-formula> (measured from the STMM center along the focal axis) we observe interference due to near-field coupling between the scanning monopole and the STMM, evident in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>. For the off-axis experiment, we measure a much tighter focus due to minimized interference and shadowing effects. To evaluate the quality of the focusing we estimate the gain along the focal axis. We define gain as the ratio between the power of the focused beam at frequency <italic>ω</italic><sub>+1</sub> and that of a beam steered at the same frequency <italic>ω</italic><sub>+1</sub> into the direction of the focal axis. Figure <xref rid="Fig2" ref-type="fig">2e</xref> compares the experimental gain for the off-axis case with the theoretical predictions using the extension of our theory approach to finite-sized STMMs. The experimental data and the theory display the same shape along the focal axis, showing strong agreement. For <italic>x</italic><sub><italic>f</italic></sub> = 6 cm and <italic>z</italic><sub><italic>f</italic></sub> = 15 cm, the expected focal length is <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _f = 16\,{\mathrm{cm}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq34.gif"/></alternatives></inline-formula>. However, due to the finite size of our metasurface, the gain peaks around <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell = 13\,{\mathrm{cm}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq35.gif"/></alternatives></inline-formula>, both in experiment and theory (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). At this point, theory predicts a gain of 5.24 dB while the measured value is (5.8 ± 0.6) dB.</p></sec><sec id="Sec6"><title>Breakdown of Lorentz reciprocity via near-field surface-waves</title><p id="Par17">We turn our attention to nonreciprocal excitation of surface waves both in beam steering and focusing. In Fig. <xref rid="Fig3" ref-type="fig">3a</xref> we report the <italic>n</italic> = +1 beam steered to <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>8</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{ + 1} \approx + 18^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq36.gif"/></alternatives></inline-formula> (<italic>β</italic><sub><italic>x</italic></sub> = 44 m<sup>−1</sup>) from a normally incident plane wave (<bold><italic>k</italic></bold><sub>in </sub>= 0). In the reverse experiment we send the time-reversed <italic>n</italic> = +1 beam (−<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in </sub>+ Ω) onto the STMM (see Methods). A frequency down-conversion and a momentum up-conversion must take place in order for the scattering process to be reciprocal. However, this is not permitted due to the traveling-wave nature of the modulation. There exist three dominant reverse reflection pathways: (i) a frequency down-conversion leading to (−<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in </sub>+ Ω) → (−2<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in</sub>), clearly breaking reciprocity in the momentum-domain. The measured reverse reflection is shown in Fig. <xref rid="Fig3" ref-type="fig">3b</xref>, with a reflection angle ≈ −36° (in contrast to the 0° reciprocal case) in excellent agreement with the theory prediction of −37.5°; (ii) a frequency up-conversion (−<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in </sub>+ Ω) → (0, <italic>ω</italic><sub>in </sub>+ 2Ω), resulting in nonreciprocity in the frequency-domain (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>); and iii) a specular process (−<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in</sub>+Ω) → (−<bold><italic>β</italic></bold>, <italic>ω</italic><sub>in </sub>+ Ω), violating reciprocity both in the frequency-domain and momentum-domain (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>), with measured reflection angle ≈ −18°. Finally, we mention that the input wave (<bold><italic>k</italic></bold><sub>in</sub>, <italic>ω</italic><sub>in</sub>) can also undergo frequency-conserving specular reflection in the forward experiment, and that in general the backwards specularly reflected field (−<bold><italic>k</italic></bold><sub>in</sub>, <italic>ω</italic><sub>in</sub>) satisfies reciprocity. However, under a specific set of parameters it is still possible to attain nonreciprocity in amplitude (not shown). When the magnitude of the phase gradient surpasses a certain threshold (<inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:mi>&#x01d6c3;</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>72.31</mml:mn><mml:mspace width="0.25em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {\mathbf{\upbeta }} \right| &gt; \omega _{{\mathrm{in}}}/2c = 72.31\,{\mathrm{m}}^{ - 1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq37.gif"/></alternatives></inline-formula> for <bold><italic>k</italic></bold><sub>in </sub>= 0, corresponding to a forward reflection angle of +30°), the reverse scattered beam at frequency ω<sub>in</sub> does not reflect off the STMM at all. Instead, surface waves are launched on the metasurface as <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">REV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">steer</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>4</mml:mn><mml:mo>∣</mml:mo><mml:mi>&#x01d6c3;</mml:mi><mml:msup><mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}}, - 1}^{{\mathrm{REV}},{\mathrm{steer}}} = i\left[ {4|{\mathbf{\upbeta }}|^2 - (\omega _{{\mathrm{in}}}/c)^2} \right]^{1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq38.gif"/></alternatives></inline-formula> is purely imaginary, resulting in photon-to-surface wave conversion, i.e., complete free-space optical isolation. In Fig. <xref rid="Fig3" ref-type="fig">3e, g</xref> we present nonreciprocity measurements for <italic>β</italic><sub><italic>x</italic></sub> = 96 m<sup>−1</sup> (<inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{ + 1} \approx + 43^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq39.gif"/></alternatives></inline-formula>), and in Fig. <xref rid="Fig3" ref-type="fig">3f, h</xref> the corresponding theory calculations. By scattering an incident beam into far-field collimated radiation in the forward process but into near-field evanescent modes in the reverse case, we demonstrate extreme breakdown of Lorentz reciprocity.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><title>Nonreciprocity in beam steering.</title><p><bold>a</bold> A normally-incident (<bold><italic>k</italic></bold><sub>in </sub>= 0) beam is up-converted to <italic>ω</italic><sub>in</sub> + Ω and steered to an angle ≈ +18° with a phase gradient <italic>β</italic><sub><italic>x</italic> </sub>= 44 m<sup>−1</sup>. Three dominant reverse pathways are allowed (<bold>b</bold>–<bold>d</bold>). <bold>b</bold> Momentum nonreciprocity: Reflection from +18° of the up-converted beam undergoes a down-conversion to <italic>ω</italic><sub>in</sub> and is steered to ≈ −36°. <bold>c</bold> Frequency nonreciprocity: Reflection from +18° undergoes an up-conversion to <italic>ω</italic><sub>in </sub>+ 2Ω and is normally reflected. <bold>d</bold> Frequency and momentum nonreciprocity: Beam from +18° is specularly reflected at <italic>ω</italic><sub>in</sub> + Ω, differing both in frequency and direction of propagation from the original input beam. <bold>e</bold> Forward measured reflection beyond threshold: the input beam is steered to ≈ +43° for <italic>β</italic><sub><italic>x</italic> </sub>= 96 m<sup>−1</sup>, which is larger than the +30° threshold. <bold>f</bold> Computed reflected Poynting vector distribution for the forward process in <bold>e</bold>. <bold>g</bold> Measured reverse scattering to <italic>ω</italic><sub>in</sub> resulting in photon-to-surface wave conversion and complete optical isolation. <bold>h</bold> Calculated profile of evanescent surface waves corresponding to the reverse process in <bold>g</bold>. In all panels <italic>ω</italic><sub>in </sub>= 2<italic>π</italic> × 6.9 GHz and Ω = 2<italic>π</italic> × 50 kHz.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2020_15273_Fig3_HTML.png"/></fig></p><p id="Par18">We now report optical isolation in dynamical focusing. In the forward process a plane wave (0, <italic>ω</italic><sub>in</sub>) can focus at frequency <italic>ω</italic><sub>+1</sub> using the <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _{\bar n = + 1}^{{\mathrm{focus}}}\left( {0,\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq40.gif"/></alternatives></inline-formula> phase profile. Figure <xref rid="Fig4" ref-type="fig">4a</xref> shows the measured power profile of the forward reflected off-axis focused beam as a function of <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq41.gif"/></alternatives></inline-formula> and the angle <italic>α</italic> between the surface normal and the detector. We investigate the scattered field at <italic>ω</italic><sub>in</sub> after the focused beam at <italic>ω</italic><sub>+1</sub> is time-reversed in order to probe nonreciprocity in the momentum-domain. To grasp some physical insight, we show in Fig. <xref rid="Fig4" ref-type="fig">4b</xref> a snapshot of the electric field distribution for the particular scattering process <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$( - \nabla \varphi _{\bar n = + 1}^{{\mathrm{focus}}},\omega _{{\mathrm{in}}} + {\mathrm{\Omega }}) \to ( - 2\nabla \varphi _{\bar n = + 1}^{{\mathrm{focus}}},\omega _{{\mathrm{in}}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq42.gif"/></alternatives></inline-formula> for the infinite-sized STMM, similarly to what is done above for nonreciprocal beam steering (see Methods). Also shown is the corresponding time-averaged Poynting vector. The reverse scattered field does not collimate back into the direction of the original input beam, but instead shows a “ribbon-like” region (centered at <italic>x</italic><sub><italic>f</italic></sub> and of width <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2z_f/\sqrt 3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq43.gif"/></alternatives></inline-formula> for the chosen process) containing propagative modes (<inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">REV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>∣</mml:mo><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}}, - 1}^{{\mathrm{REV}},{\mathrm{focus}}} = \left[ {(\omega _{{\mathrm{in}}}/c)^2 - 4|\nabla \varphi _{\bar n = + 1}^{{\mathrm{focus}}}|^2} \right]^{1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq44.gif"/></alternatives></inline-formula> is real) that radiate away from the metasurface, and is flanked by a region of surface waves with purely imaginary <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">REV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}}, - 1}^{{\mathrm{REV}},{\mathrm{focus}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq45.gif"/></alternatives></inline-formula> (these latter modes move along the STMM and weakly manifest in Fig. <xref rid="Fig4" ref-type="fig">4b</xref> due to their strong decay). Other choices of scattering processes also present the same nonreciprocal characteristics. The total reverse scattered field is the sum of all those possible scattering processes and results in maximum breakdown of Lorentz reciprocity (see Supplementary Notes <xref ref-type="supplementary-material" rid="MOESM1">5</xref> and <xref ref-type="supplementary-material" rid="MOESM1">6</xref> for further details of Lorentz nonreciprocity for infinite-sized STMM with arbitrary nonlinear spatial phase distributions, including focusing).<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><title>Surface-wave-assisted nonreciprocity in focusing.</title><p><bold>a</bold> Measured reflected field power at <italic>ω</italic><sub>+1</sub> in the forward off-axis focusing experiment (<bold><italic>k</italic></bold><sub>in</sub> = 0). <bold>b</bold> Calculated snapshot of the reflected electric field distribution for the reverse scattering process <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>∇</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$( - \nabla \varphi _{\bar n = + 1}^{{\mathrm{focus}}},\omega _{{\mathrm{in}}} + {\mathrm{\Omega }}) \to ( - 2\nabla \varphi _{\bar n = + 1}^{{\mathrm{focus}}},\omega _{{\mathrm{in}}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq46.gif"/></alternatives></inline-formula> for the infinite-sized STMM. The black line represents the time-averaged Poynting vector for the same scattering process. <bold>c</bold> Measured power at <italic>ω</italic><sub>in</sub> in the far-field for the reverse process is mainly confined within the wedge-shaped region. Data at given radii of the arc sector correspond to different locations <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq47.gif"/></alternatives></inline-formula> of the monopole source. Indicated are the calculated main directions of radiative emission from the right and left edges of the STMM and angles subtended between their crossings with the arc and its center, respectively given by <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>53.2</mml:mn><mml:msup><mml:mrow><mml:mn>7</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{\mathrm{R}}^{{\mathrm{th}}} = + 53.27^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>20.3</mml:mn><mml:msup><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{\mathrm{L}}^{{\mathrm{th}}} = - 20.36^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq49.gif"/></alternatives></inline-formula>. The measured scanning angles for the main peaks on the right-side and left-side are <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mn>54</mml:mn><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _ + ^{{\mathrm{exp}}} = ( + 54 \pm 1)^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>26</mml:mn><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _ - ^{{\mathrm{exp}}} = ( - 26 \pm 1)^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq51.gif"/></alternatives></inline-formula>. <bold>d</bold> Same as <bold>c</bold> but as a function of the scanning angle and <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq52.gif"/></alternatives></inline-formula>. Parameters are <italic>x</italic><sub><italic>f</italic></sub> = 6 cm and <italic>z</italic><sub><italic>f</italic></sub> = 15 cm <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\ell _f = 16\,{\mathrm{cm}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq53.gif"/></alternatives></inline-formula>. In all panels <italic>ω</italic><sub>in</sub> = 2<italic>π</italic> × 6.9 GHz and Ω = 2<italic>π</italic> × 50 kHz.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2020_15273_Fig4_HTML.png"/></fig></p><p id="Par19">For a finite-sized STMM our calculations indicate that a similar physics takes place, the most important difference being that the propagative modes are asymmetrically radiated from the STMM for the off-axis focusing configuration (see Methods and Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">7</xref> for a discussion of the Poynting vector in reverse scattering). In Fig. <xref rid="Fig4" ref-type="fig">4c, d</xref> we experimentally validate these theoretical predictions by exciting the metasurface with a monopole antenna located at the focal point and emitting at frequency <italic>ω</italic><sub>+1</sub>, and detect the far-field scattered radiation from the STMM at frequency <italic>ω</italic><sub>in</sub>. The measured power map bears little resemblance to the original input plane wave. It shows a concave wedge-shaped region with low radiated power at the center, two peaks at asymmetric angular locations, and an outer region of negligible radiated power (displaying similarities to the Poynting vector depicted in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). All these properties of the reverse scattered field are in stark contrast to the input Gaussian profile for the forward process and in excellent agreement with the theory calculations for finite-sized STMMs. In particular, the differences in the measured angular positions of the peaks and in their strengths are due to the inherent asymmetry of off-axis focusing in finite-sized STMMs (see Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">7</xref> for a discussion of photon-to-hybrid modes (surface waves and photons) conversion in reverse scattering for finite-sized STMMs for focusing). For positive scanning angles, there is a main peak located at <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>+</mml:mo><mml:mn>54</mml:mn><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _ + ^{{\mathrm{exp}}} = \left( { + 54 \pm 1} \right)^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq54.gif"/></alternatives></inline-formula>, while for negative scanning angles there is a much weaker peak at <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>26</mml:mn><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _ - ^{{\mathrm{exp}}} = ( - 26 \pm 1)^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq55.gif"/></alternatives></inline-formula>.</p><p id="Par20">An extensive discussion of how the STMM emits radiation in reverse scattering can be found in the Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">7</xref>, where we consider the analytical aspects for the radiative power spectrum in reverse scattering for the focusing functionality. Here, we briefly describe the main results. The structures observed in Fig. <xref rid="Fig4" ref-type="fig">4c, d</xref> result from the superposition of emitted radiation from every point on the metasurface. For example, the right-edge at <italic>x</italic> = <italic>L</italic><sub><italic>x</italic></sub>/2 emits radiation mainly in the direction shown in Fig. <xref rid="Fig4" ref-type="fig">4c</xref> with a predicted angle <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>53.2</mml:mn><mml:msup><mml:mrow><mml:mn>7</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{\mathrm{R}}^{{\mathrm{th}}} = + 53.27^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq56.gif"/></alternatives></inline-formula>, in very close agreement with the measurement. Points on the metasurface between <italic>x</italic><sub><italic>f</italic></sub> and <italic>L</italic><sub><italic>x</italic></sub>/2 also contribute to that same peak, resulting in the observed broadening. The second peak seen on the right side of Fig. <xref rid="Fig4" ref-type="fig">4c</xref> at a measured position <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ER</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mn>36</mml:mn><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{{\mathrm{ER}}2}^{{\mathrm{exp}}} = ( + 36 \pm 1)^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq57.gif"/></alternatives></inline-formula> arises from secondary emissions from points in the range [<italic>x</italic><sub><italic>f</italic></sub>, <italic>L</italic><sub><italic>x</italic></sub>/2] on the STMM. For example, the right-edge of the structure has a secondary emission direction forming a predicted angle <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ER</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>34.6</mml:mn><mml:msup><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{{\mathrm{ER}}2}^{{\mathrm{th}}} = + 34.66^{\mathrm{o}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq58.gif"/></alternatives></inline-formula>, again in very close agreement with observations. On the other hand, the left-edge of the STMM at <italic>x</italic> = −<italic>L</italic><sub><italic>x</italic></sub>/2 emits radiation mainly in the direction shown in Fig. <xref rid="Fig4" ref-type="fig">4c</xref> with a predicted angle <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>20.3</mml:mn><mml:msup><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{\mathrm{L}}^{{\mathrm{th}}} = - 20.36^\circ$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq59.gif"/></alternatives></inline-formula>, which is slightly off from the measured position of the peak on the left side of Fig. <xref rid="Fig4" ref-type="fig">4c</xref>. The reason for this discrepancy is that all points between −<italic>L</italic><sub><italic>x</italic></sub>/2 and <italic>x</italic><sub><italic>f</italic></sub> contribute to the peak and its broadening, and there is a given point on the metasurface in the [−<italic>L</italic><sub><italic>x</italic></sub>/2, <italic>x</italic><sub><italic>f</italic></sub>] range that emits precisely in the direction of the peak. Also, in the Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">7</xref> we depict the structure of the Poynting vector in reverse scattering, showing a complex co-existence of propagative and evanescent features. In contrast to nonreciprocal beam steering, there is no threshold to launch surface waves in nonreciprocal focusing and evanescent modes overwhelm propagative ones. Just as in nonreciprocal steering, this represents a large violation of the Lorentz reciprocity theorem since in forward scattering there is a photon-to-photon conversion but in reverse scattering there is a photon-to-photon/surface wave hybrid conversion. The measurements reported in Fig. <xref rid="Fig4" ref-type="fig">4c, d</xref> constitute the first experimental demonstration of extreme nonreciprocal focusing functionality using STMMs.</p><p id="Par21">In contrast to the case of STMMs modulated with a linear phase <italic>φ</italic><sub>L</sub>(<bold><italic>r</italic></bold>) = <bold><italic>β</italic></bold> · <bold><italic>r</italic></bold>, for which surface waves in reverse scattering are launched only when its gradient surpasses a certain threshold, no such constraint exists on any nonlinear phase <italic>φ</italic><sub>NL</sub>(<bold><italic>r</italic></bold>) dynamically imprinted on the metasurface. In this sense, extreme breakdown of Lorentz reciprocity and giant optical isolation are robust properties occurring in space-time metasurfaces under arbitrary nonlinear spatial modulations (see Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">8</xref> for a discussion of nonreciprocity in arbitrary nonlinear phase distributions).</p></sec></sec><sec id="Sec7" sec-type="discussion"><title>Discussion</title><p id="Par22">In summary, we have introduced an STMM platform for complete violation of Lorentz reciprocity by photon-to-photon conversion in forward scattering, but photon-to-surface wave conversion in reverse scattering. This represents an extreme breakdown of Lorentz reciprocity as the very nature of the photonic modes is modified in the scattering process, leading to giant optical isolation as no propagative modes are radiated in reverse scattering. We also showed that our STMM allows beam-steering nonreciprocity in the frequency-domain, momentum-domain, and simultaneously in both. Our approach enables dynamical arbitrary wave-front shaping by offering substantial flexibility in the manipulation of frequency-momentum harmonic contents of free-space electromagnetic waves when compared to standard phase-gradient and nonlinear optical systems. We have also developed an analytical method to model STMMs with arbitrary spatial phase distributions and its predictions are in excellent agreement with experiment, shedding light on the underlying physics of STMMs with complex phase distributions without resorting to full-wave numerical simulations.</p><p id="Par23">Our goal in this paper is to demonstrate complete breakdown of Lorentz reciprocity via mode-conversion, in the sense explained above. As such, we did not attempt to optimize our structure to achieve either large reflectivity or high efficiency for harmonics conversion. As is clear from Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, most of the impinging power gets absorbed by the structure, the reflectivity of the fundamental harmonic is about 4%, and the conversion efficiency into the <italic>n</italic> = +1 harmonic is ~ 0.1%. All these features are a direct consequence of the need to achieve a broad phase dispersion in our designed STMM, which forces us to work close to the near-zero reflection dip (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). Despite the low reflectivity and conversion efficiencies in the forward processes, our nonreciprocal beam steering experiment shows that, beyond a certain threshold, the time-reversed propagative output signal in forward scattering gets completely transformed into evanescent surface waves on the STMM in reverse scattering, thereby achieving extreme nonreciprocity in the direction of propagation and changing the very nature of the photonic modes involved. Similarly, our nonreciprocal focusing measurements show a complete violation of the Lorentz theorem. Tailored metasurfaces with high reflectivity while maintaining a broad phase dispersion can be designed and fabricated for practical applications, as the ones discussed below. However, this by itself does not solve the challenge of substantially enhancing conversion efficiencies into up-converted or down-converted frequency harmonics, as most of the reflected power will still reside in the fundamental harmonic. These limitations can be addressed by using non-harmonic asymmetric time-modulation protocols and higher modulation frequencies, opening opportunities for efficiency improvement, momentum-frequency harmonic mode selectivity, and advanced wave-front manipulation. Using these more general modulation protocols one can in principle attain conversion efficiencies larger than 80%, provided that the complex modulations can be implemented by the electronic controller.</p><p id="Par24">Maximum breakdown of Lorentz reciprocity can occur for any kind of linear or nonlinear spatial phase distributions dynamically imprinted on the metasurface, highlighting that extreme nonreciprocity is a generic property of STMMs. Furthermore, by independently addressing each individual resonator, our platform can be extended to achieve fully three-dimensional dynamical wave-front shaping. STMMs based on our proof-of-concept demonstration with improved designs and complex time-modulation protocols will enable a new architecture for compact and flat multifunctional optical components with built-in isolators, reducing stringent size, weight, and power requirements for wireless communications and remote sensing. In addition, such a spatio-temporally modulated platform can be used to compensate for Doppler shifts induced by relative motion in inter-satellite and Earth-to-satellite communications. Extension of STMMs to the THz and IR frequency range is possible by use of alternative materials and active elements, including back-gate modulated graphene-based resonators, and electro-optic and photo-acoustic media. Finally, our demonstration of maximum violation of Lorentz reciprocity for arbitrary wave-fronts supports emerging technologies benefiting from free-space optical isolation, such as nonreciprocal wireless information transmission.</p></sec><sec id="Sec8" sec-type="methods"><title>Methods</title><sec id="Sec9"><title>Device fabrication</title><p id="Par25">The metasurface of dimensions <italic>L</italic><sub><italic>x</italic></sub> = <italic>L</italic><sub><italic>y</italic></sub> = 19 cm was fabricated using 12″ × 12″ double sided FR-4 circuit boards, with a thickness <italic>h</italic> = 1.6 mm and 1 oz copper. The top side of the board was milled yielding an array of unit cells on one side, and a continuous ground plane separated by the FR-4 spacer. After milling, the varactors (SMV1405) and capacitors (SMD 0.6 pF) were added by reflow soldering and electrical connections were made to the columns for external control. The voltage signals being fed into each column of the STMM were sourced from a high-density signal generator that is installed on a National Instruments PCI eXtensions for Instrumentation (PXIe) chassis. Each waveform was digitally constructed and uploaded to the onboard buffer of the control system. Both the PXIe chassis and the signal generators have synchronized sample clocks, thus preventing relative phase drift in time and enabling the triggering of all channels to within 10 ns. See Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1a</xref> for a photograph of the fabricated sample with control lines.</p></sec><sec id="Sec10"><title>Measurements</title><p id="Par26">The fabricated metasurface was characterized inside an anechoic chamber using a broad-band horn antenna (SAS-571) and a quarter wave monopole antenna (see Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b, d</xref> for a schematic of the experimental set-ups for dynamical steering and focusing, and Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1c, e</xref> for nonreciprocal steering and focusing). A vector network analyzer (VNA-Agilent N5230A) was used for data collection. First, the reflectivity of the unmodulated metasurface was measured at a 10° incidence angle with <italic>p</italic>-polarized light with all varactors uniformly biased (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">2</xref>). These measurements were carried out with broadband antennas as the source and receiver, and the VNA was used for a conventional S21 measurement with the source and receiver swept across the band of interest (5.5–8 GHz). We then characterized the spatio-temporally modulated metasurface. For these measurements the source (6.3 mW input power) is in continuous wave (CW) operation at 6.9 GHz with a 100 Hz resolution, and the detector was swept in frequency with corresponding 100 Hz resolution to measure the generated frequency harmonics. For beam steering measurements both the source and the detector were broadband horn antennas; however, for the focusing experiments a monopole antenna was used instead of one of the horn antennas. In the forward experiments the source (CW at ω<sub>in</sub>) was placed on-axis with the metasurface normal <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(x = 0,y = 0,z = 1.3)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq60.gif"/></alternatives></inline-formula> m, and the receiver was placed on a computer-controlled gimbal which scanned the reflected power in the <italic>x</italic>−<italic>z</italic> plane. In the beam steering case this yielded radiation patterns of the harmonics scanned along a constant radius (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b</xref>); for focusing experiments a large portion of the <italic>x</italic>−<italic>z</italic> plane was scanned yielding a 2D map of forward radiated power in the harmonics (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1d</xref>). For the reverse nonreciprocity experiments the detector and source are swapped, and the new source operates in continuous wave at <italic>ω</italic><sub>+1</sub> (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1c, e</xref>). The detector measures a frequency sweep as explained above, centered this time at <italic>ω</italic><sub>in</sub>, capturing harmonics generated around this frequency. The receiver is again scanned in angle as in the forward experiment to measure reflected power over the area of interest.</p></sec><sec id="Sec11"><title>Theory</title><p id="Par27">The reflected field by the STMM is described by means of a generalized Bloch-Floquet approach based on a derivative expansion of the spatial phase distributions. It is given by Eq. (1), where <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq61.gif"/></alternatives></inline-formula> is defined in Eq. (2) with <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">sg</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">sg</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\Lambda }}_{\xi ,n} = [ {R_{\xi ,n - {\mathrm{sg}}\left( n \right)}\left( {{\boldsymbol{k}}_{{\mathrm{in}}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right) \pm \delta _{\left| n \right|,1}} ]/[R_{\xi ,n - {\mathrm{sg}}\left( n \right)}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right) \pm \delta _{\left| n \right|,1}]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq62.gif"/></alternatives></inline-formula>. Here, the ‘+’ and ‘−’ signs correspond to <italic>ξ</italic> = <italic>s</italic> and <italic>ξ</italic> = <italic>p</italic> polarizations, respectively. The reflection coefficients <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\xi ,n}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq63.gif"/></alternatives></inline-formula> are obtained by using the local derivative expansion in Maxwell equations and solving numerically (or via continued fractions) an infinite set of coupled equations <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{\xi ,n - 1}^ + {\cal{R}}_{\xi ,n - 1} + A_{\xi ,n}{\cal{R}}_{\xi ,n} + \eta _{\xi ,n + 1}^ - {\cal{R}}_{\xi ,n + 1} = 2B_{\xi ,n}\delta _{n,0}.$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq64.gif"/></alternatives></inline-formula> For <italic>p</italic>-polarization, <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{R}}_{p,n}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right) = R_{p,n}\left( {{\boldsymbol{k}},\omega _{{\mathrm{in}}};{\boldsymbol{r}}} \right) - \delta _{n,0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq65.gif"/></alternatives></inline-formula>, <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>∓</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>⋅</mml:mo><mml:mo>∇</mml:mo><mml:mi>φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{p,n}^ \pm = \mp i(Z_{\mathrm{s}}/2)(k_{z{\mathrm{v}},n}/k_{{\mathrm{v}},n})\Delta \sigma \left( {\omega _n} \right)e^{ \pm i[\varphi \left( {\boldsymbol{r}} \right) - {\boldsymbol{r}} \cdot \nabla \varphi \left( {\boldsymbol{r}} \right)]}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq66.gif"/></alternatives></inline-formula>, <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">op</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>cot</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{p,n} = Z_{\mathrm{s}}\sigma _{{\mathrm{op}}}\left( {\omega _n} \right)(k_{z{\mathrm{v}},n}/k_{{\mathrm{v}},n}) + i(k_{z{\mathrm{v}},n}k_{{\mathrm{s}},n}/k_{{\mathrm{v}},n}k_{z{\mathrm{s}},n})\cot ( {hk_{z{\mathrm{s}},n}} ) + Z_{\mathrm{s}}/Z_{\mathrm{v}},$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{p,n} = - Z_{\mathrm{s}}/Z_{\mathrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq68.gif"/></alternatives></inline-formula>. In these expressions, <italic>Z</italic><sub>s</sub> is the spacer impedance, <italic>h</italic> is the thickness of the spacer, <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>c</mml:mi></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{{\mathrm{v}},n} = \omega _n/c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{v}},n} = \sqrt {k_{{\mathrm{v}},n}^2 - {\boldsymbol{k}}_n^2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq70.gif"/></alternatives></inline-formula> are the magnitudes of the wave-vector and its <italic>z</italic>-component in vacuum for the <italic>n</italic>-th harmonic, and similarly <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{{\mathrm{s}},n} = k_{{\mathrm{v}},n}/Z_{\mathrm{s}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq71.gif"/></alternatives></inline-formula> and <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{z{\mathrm{s}},n} = \sqrt {k_{{\mathrm{s}},n}^2 - {\boldsymbol{k}}_n^2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq72.gif"/></alternatives></inline-formula> are the corresponding quantities in the spacer. The reverse scattered field is given by a double summation over incoming and outgoing frequency harmonics, and a double integral over the respective incoming and outgoing plane-wave components: <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">scatt</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">REV</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>′</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>⊙</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>̂</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>×</mml:mo></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{E}}_\xi ^{{\mathrm{scatt}},{\mathrm{REV}}}\left( {{\boldsymbol{r}},z,t} \right) = E^{{\mathrm{in}}}{\sum}_{n^{\prime} ,n = - \infty }^\infty {{\int} {d^2} } {\boldsymbol{k}}\prime {\int} {d^2} {\boldsymbol{k}}\left( {2\pi } \right)^{ - 4}\left[ {{\hat{\boldsymbol{e}}}_\xi ^ + \left( {{\boldsymbol{k}}_{n\prime }^\prime } \right) \odot {\hat{\boldsymbol{e}}}_\xi ^ - \left( { - {\boldsymbol{k}}_n} \right)} \right] \times $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq73.gif"/></alternatives></inline-formula><inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>̃</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>z</mml:mi><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal{E}}_{\xi ,n\prime }[ - {\boldsymbol{k}}_n,{\boldsymbol{k}}_{n\prime }^\prime ,\omega _{n + n\prime };{\boldsymbol{r}}]\tilde {\cal{E}}_{\xi ,n}[{\boldsymbol{k}}_{{\mathrm{in}}},{\boldsymbol{k}}_n,\omega _n;{\boldsymbol{r}}]e^{i[{\boldsymbol{r}} \cdot {\boldsymbol{k}}_{n\prime }^\prime + zk_{z{\mathrm{v}},n\prime }^\prime - \omega _{n + n\prime }t]}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq74.gif"/></alternatives></inline-formula> (the ⊙ product gives a vector whose components are the product of the Cartesian components of the two polarization unit vectors). For our nonreciprocal beam steering and focusing experiments of Fig. <xref rid="Fig3" ref-type="fig">3b, g</xref> and Fig. <xref rid="Fig4" ref-type="fig">4c, d</xref>, only the <italic>n</italic> = +1 and <italic>n</italic>′ = −1 terms should be considered, rendering the output frequency equal to <italic>ω</italic><sub>in</sub>. For Fig. <xref rid="Fig3" ref-type="fig">3c</xref>, <italic>n</italic> = <italic>n</italic>′ = +1, and for Fig. <xref rid="Fig3" ref-type="fig">3d</xref>, <italic>n</italic> = +1 and <italic>n</italic>′ = 0. The calculated scanning angles <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arcos</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">tan</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{{\mathrm{R}},{\mathrm{L}}}^{{\mathrm{th}}} = {\mathrm{arcos}}\left\{ {\frac{{ - \left( {L_x/2d} \right){\mathrm{tan}}\left( {g_ \pm ^{{\mathrm{th}}}} \right) + \sqrt {{\mathrm{tan}}^2\left( {g_ \pm ^{{\mathrm{th}}}} \right) + \left[ {1 - \left( {L_x/2d} \right)^2} \right]{\mathrm{tan}}^4\left( {g_ \pm ^{{\mathrm{th}}}} \right)} }}{{1 + {\mathrm{tan}}^2\left( {g_ \pm ^{{\mathrm{th}}}} \right)}}} \right\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq75.gif"/></alternatives></inline-formula> in Fig. <xref rid="Fig4" ref-type="fig">4c</xref> are the angles formed between STMM vertical and the crossings of the main directions of emission from the right and left edges of the STMM with the measurement arc. Here, the “+” (“−”) sign corresponds to <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{\mathrm{R}}^{{\mathrm{th}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq76.gif"/></alternatives></inline-formula><inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\alpha _{\mathrm{L}}^{{\mathrm{th}}}} \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq77.gif"/></alternatives></inline-formula>, <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arccos</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>±</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>∕</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">focus</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mspace width="0.3em"/><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_ \pm ^{{\mathrm{th}}} = {\mathrm{arccos}}[1 \pm (\omega _{{\mathrm{in}}}/c)^{ - 1}(d/dx)\varphi _{\bar n = + 1}^{{\mathrm{focus}}}(\!\pm L_x/2)],$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41467_2020_15273_Article_IEq78.gif"/></alternatives></inline-formula><italic>L</italic><sub><italic>x</italic></sub> is the size of the STMM along the <italic>x</italic>-direction, and <italic>d</italic> is the distance between the detector and the center of the STMM.</p></sec></sec></body><back><ack><title>Acknowledgements</title><p>We are grateful to the ISR Fab-Lab at LANL for mounting the varactors on the metasurface. D.D. thanks Lukasz Cincio for computational assistance. Research presented in this paper was supported by the Laboratory Directed Research and Development program of Los Alamos National Laboratory under project number 20180062DR. Part of this work was performed at the Center for Integrated Nanotechnologies, a U.S. Department of Energy, Office of Basic Energy Sciences user facility. LANL is operated by Triad National Security, LLC, for the National Nuclear Security Administration of the U.S. Department of Energy (Contract No. 89233218CNA000001).</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>A.A., H.T.C., D.D. and W.K.K. conceived the idea of this work. A.A. and A.C. designed the experiments. A.C. and S.S. fabricated samples and performed the measurements. S.V. designed the electronic control system. D.D. and W.K.K. developed the theory and conducted numerical simulations. A.A., A.C., H.T.C., D.D., W.K.K., W.P., A.S. and A.T. contributed to the writing of the paper. A.A. and D.D. supervised the entire study.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>The data that support the plots within this paper and other findings of this study are available from the corresponding authors upon reasonable request.</p></sec><sec sec-type="data-availability"><title>Code availability</title><p>The codes are available from the corresponding authors upon reasonable request.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par28">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Lorentz, H. A. The theorem of Poynting concerning the energy in the electromagnetic field and two general propositions concerning the propagation of light. <italic>Versl. K. Akad. W. Amsterdam</italic><bold>4</bold>, 1–11 (1896).</mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potton</surname><given-names>RJ</given-names></name></person-group><article-title xml:lang="en">Reciprocity in optics</article-title><source>Rep. Prog. Phys.</source><year>2004</year><volume>67</volume><fpage>717</fpage><lpage>754</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004RPPh...67..717P</pub-id><pub-id pub-id-type="doi">10.1088/0034-4885/67/5/R03</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sounas</surname><given-names>DL</given-names></name><name><surname>Alù</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Non-reciprocal photonics based on time modulation</article-title><source>Nat. Photonics</source><year>2017</year><volume>1</volume><fpage>774</fpage><lpage>783</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017NaPho..11..774S</pub-id><pub-id pub-id-type="doi">10.1038/s41566-017-0051-x</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caloz</surname><given-names>C</given-names></name><etal/></person-group><article-title xml:lang="en">Electromagnetic nonreciprocity</article-title><source>Phys. Rev. Appl</source><year>2018</year><volume>10</volume><fpage>047001</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXltVGnsbg%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018PhRvP..10d7001C</pub-id><pub-id pub-id-type="doi">10.1103/PhysRevApplied.10.047001</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamagnone</surname><given-names>M</given-names></name><etal/></person-group><article-title xml:lang="en">Near optimal graphene terahertz non-reciprocal isolator</article-title><source>Nat. Commun.</source><year>2016</year><volume>7</volume><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28Xls1Kgtbo%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016NatCo...711216T</pub-id><pub-id pub-id-type="doi">10.1038/ncomms11216</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Silva</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Talbayev</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">A one-way mirror: high-performance terahertz optical isolator based on magneto-plasmonics</article-title><source>Adv. Opt. Mater.</source><year>2018</year><volume>6</volume><fpage>1800572</fpage><pub-id pub-id-type="doi">10.1002/adom.201800572</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahmoud</surname><given-names>AM</given-names></name><name><surname>Davoyan</surname><given-names>AR</given-names></name><name><surname>Engheta</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">All-passive nonreciprocal metastructure</article-title><source>Nat. Commun.</source><year>2015</year><volume>6</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015NatCo...6.8359M</pub-id><pub-id pub-id-type="doi">10.1038/ncomms9359</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Limitations of nonlinear optical isolators due to dynamic reciprocity</article-title><source>Nat. Photonics</source><year>2015</year><volume>9</volume><fpage>388</fpage><lpage>392</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXht1ajt7rN</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015NaPho...9..388S</pub-id><pub-id pub-id-type="doi">10.1038/nphoton.2015.79</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>DR</given-names><suffix>III</suffix></name><name><surname>Dionne</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Nonreciprocal flat optics with silicon metasurfaces</article-title><source>Nano Lett.</source><year>2018</year><volume>18</volume><fpage>1104</fpage><lpage>1109</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhslyqur8%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018NanoL..18.1104L</pub-id><pub-id pub-id-type="doi">10.1021/acs.nanolett.7b04646</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Complete optical isolation created by indirect interband photonic transitions</article-title><source>Nat. Photonics</source><year>2009</year><volume>3</volume><fpage>91</fpage><lpage>94</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXht1ansL4%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009NaPho...3...91Y</pub-id><pub-id pub-id-type="doi">10.1038/nphoton.2008.273</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lira</surname><given-names>H</given-names></name><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name><name><surname>Lipson</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Electrically driven nonreciprocity induced by interband photonic transition on a silicon chip</article-title><source>Phys. Rev. Lett.</source><year>2012</year><volume>109</volume><fpage>033901</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012PhRvL.109c3901L</pub-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.033901</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sounas</surname><given-names>DL</given-names></name><name><surname>Caloz</surname><given-names>C</given-names></name><name><surname>Alù</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Giant non-reciprocity at the subwavelength scale using angular momentum-biased metamaterials</article-title><source>Nat. Commun.</source><year>2013</year><volume>4</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013NatCo...4.2407S</pub-id><pub-id pub-id-type="doi">10.1038/ncomms3407</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadad</surname><given-names>Y</given-names></name><name><surname>Soric</surname><given-names>JC</given-names></name><name><surname>Alù</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Breaking temporal symmetries for emission and absorption</article-title><source>Proc. Natl Acad. Sci.</source><year>2016</year><volume>113</volume><fpage>3471</fpage><lpage>3475</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XktlKitbw%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016PNAS..113.3471H</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1517363113</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taravati</surname><given-names>S</given-names></name><name><surname>Caloz</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Mixer-duplexer antenna leaky-wave system based on periodic space-time modulation</article-title><source>IEEE Trans. Antennas Propag.</source><year>2017</year><volume>65</volume><fpage>442</fpage><lpage>452</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ITAP...65..442T</pub-id><pub-id pub-id-type="doi">10.1109/TAP.2016.2632735</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>NF</given-names></name><etal/></person-group><article-title xml:lang="en">Light propagation with phase discontinuities: generalized laws of reflection and refraction</article-title><source>Science</source><year>2011</year><volume>334</volume><fpage>333</fpage><lpage>337</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhtlahsr3M</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011Sci...334..333Y</pub-id><pub-id pub-id-type="doi">10.1126/science.1210713</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grady</surname><given-names>NK</given-names></name><etal/></person-group><article-title xml:lang="en">Terahertz metamaterials for linear polarization conversion and anomalous refraction</article-title><source>Science</source><year>2013</year><volume>340</volume><fpage>1304</fpage><lpage>1307</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXptFKjsr8%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013Sci...340.1304G</pub-id><pub-id pub-id-type="doi">10.1126/science.1235399</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Fan</surname><given-names>P</given-names></name><name><surname>Hasman</surname><given-names>E</given-names></name><name><surname>Brongersma</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">Dielectric gradient metasurface optical elements</article-title><source>Science</source><year>2014</year><volume>345</volume><fpage>298</fpage><lpage>302</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXhtFCqs7nI</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014Sci...345..298L</pub-id><pub-id pub-id-type="doi">10.1126/science.1253213</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arbabi</surname><given-names>A</given-names></name><name><surname>Horie</surname><given-names>Y</given-names></name><name><surname>Bagheri</surname><given-names>M</given-names></name><name><surname>Faraon</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Dielectric metasurfaces for complete control of phase and polarization with subwavelength spatial resolution and high transmission</article-title><source>Nat. Nanotechnol.</source><year>2015</year><volume>10</volume><fpage>937</fpage><lpage>943</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhsVahtbrO</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015NatNa..10..937A</pub-id><pub-id pub-id-type="doi">10.1038/nnano.2015.186</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kildishev</surname><given-names>AV</given-names></name><name><surname>Boltasseva</surname><given-names>A</given-names></name><name><surname>Shalaev</surname><given-names>VM</given-names></name></person-group><article-title xml:lang="en">Planar photonics with metasurfaces</article-title><source>Science</source><year>2013</year><volume>339</volume><fpage>1232009</fpage><pub-id pub-id-type="doi">10.1126/science.1232009</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>HT</given-names></name><name><surname>Taylor</surname><given-names>AJ</given-names></name><name><surname>Yu</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">A review of metasurfaces: physics and applications</article-title><source>Rep. Prog. Phys.</source><year>2016</year><volume>79</volume><fpage>076401</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016RPPh...79g6401C</pub-id><pub-id pub-id-type="doi">10.1088/0034-4885/79/7/076401</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H-T</given-names></name><etal/></person-group><article-title xml:lang="en">Active terahertz metamaterial devices</article-title><source>Nature</source><year>2006</year><volume>444</volume><fpage>597</fpage><lpage>600</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xht1KjurnP</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006Natur.444..597C</pub-id><pub-id pub-id-type="doi">10.1038/nature05343</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Driscoll</surname><given-names>T</given-names></name><etal/></person-group><article-title xml:lang="en">Memory metamaterials</article-title><source>Science</source><year>2009</year><volume>325</volume><fpage>1518</fpage><lpage>1521</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhtFanur3L</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009Sci...325.1518D</pub-id><pub-id pub-id-type="doi">10.1126/science.1176580</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hess</surname><given-names>O</given-names></name><etal/></person-group><article-title xml:lang="en">Active nanoplasmonic metamaterials</article-title><source>Nat. Mater.</source><year>2012</year><volume>11</volume><fpage>573</fpage><lpage>584</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XovVamsLg%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012NatMa..11..573H</pub-id><pub-id pub-id-type="doi">10.1038/nmat3356</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>SH</given-names></name><etal/></person-group><article-title xml:lang="en">Switching terahertz waves with gate-controlled active graphene metamaterials</article-title><source>Nat. Mater.</source><year>2012</year><volume>11</volume><fpage>936</fpage><lpage>941</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhsVaqsbvO</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012NatMa..11..936L</pub-id><pub-id pub-id-type="doi">10.1038/nmat3433</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sleasman</surname><given-names>T</given-names></name><name><surname>Mohammadreza</surname><given-names>FI</given-names></name><name><surname>Gollub</surname><given-names>JN</given-names></name><name><surname>Smith</surname><given-names>DR</given-names></name></person-group><article-title xml:lang="en">Microwave imaging using a disordered cavity with a dynamically tunable impedance surface</article-title><source>Phys. Rev. Appl.</source><year>2016</year><volume>6</volume><fpage>054019</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016PhRvP...6e4019S</pub-id><pub-id pub-id-type="doi">10.1103/PhysRevApplied.6.054019</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname><given-names>TJ</given-names></name><name><surname>Qi</surname><given-names>MQ</given-names></name><name><surname>Wan</surname><given-names>X</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Cheng</surname><given-names>Q</given-names></name></person-group><article-title xml:lang="en">Coding metamaterials, digital metamaterials and programmable metamaterials</article-title><source>Light Sci. Appl.</source><year>2014</year><volume>3</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014LSA.....3E.218C</pub-id><pub-id pub-id-type="doi">10.1038/lsa.2014.99</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Electromagnetic reprogrammable coding-metasurface holograms</article-title><source>Nat. Commun.</source><year>2017</year><volume>8</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017NatCo...8..197L</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-00164-9</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu.</surname><given-names>PC</given-names></name><etal/></person-group><article-title xml:lang="en">Dynamic beam steering with all-dielectric electro-optic III-V multiple-quantum-well metasurfaces</article-title><source>Nat. Commun.</source><year>2019</year><volume>10</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019NatCo..10.3654W</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-11598-8</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>HT</given-names></name><etal/></person-group><article-title xml:lang="en">A metamaterial solid-state terahertz phase modulator</article-title><source>Nat. Photonics</source><year>2009</year><volume>3</volume><fpage>148</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXisVCht78%3D</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009NaPho...3..148C</pub-id><pub-id pub-id-type="doi">10.1038/nphoton.2009.3</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>B</given-names></name><etal/></person-group><article-title xml:lang="en">Hybrid graphene metasurfaces for high-speed mid-infrared light modulation and single-pixel imaging</article-title><source>Light Sci. Appl.</source><year>2018</year><volume>7</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018LSA.....7...51Z</pub-id><pub-id pub-id-type="doi">10.1038/s41377-018-0055-4</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaltout</surname><given-names>AM</given-names></name><name><surname>Shalaev</surname><given-names>VM</given-names></name><name><surname>Brongersma</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">Spatiotemporal light control with active metasurfaces</article-title><source>Science</source><year>2019</year><volume>364</volume><fpage>648</fpage><pub-id pub-id-type="doi">10.1126/science.aat3100</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadad</surname><given-names>Y</given-names></name><name><surname>Sounas</surname><given-names>DL</given-names></name><name><surname>Alù</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Space-time gradient metasurfaces</article-title><source>Phys. Rev. B</source><year>2015</year><volume>92</volume><fpage>100304</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015PhRvB..92j0304H</pub-id><pub-id pub-id-type="doi">10.1103/PhysRevB.92.100304</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zang</surname><given-names>JW</given-names></name><etal/></person-group><article-title xml:lang="en">Nonreciprocal wave-front engineering with time-modulated gradient metasurfaces</article-title><source>Phys. Rev. Appl</source><year>2019</year><volume>11</volume><fpage>054054</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhtFKlsLjL</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019PhRvP..11e4054Z</pub-id><pub-id pub-id-type="doi">10.1103/PhysRevApplied.11.054054</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Powell</surname><given-names>DA</given-names></name><name><surname>Zarate</surname><given-names>Y</given-names></name><name><surname>Shadrivov</surname><given-names>IV</given-names></name></person-group><article-title xml:lang="en">Huygens’ metadevices for parametric waves</article-title><source>Phys. Rev. X</source><year>2018</year><volume>8</volume><fpage>031077</fpage></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Space-time-coding digital metasurfaces</article-title><source>Nat. Commun.</source><year>2018</year><volume>9</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018NatCo...9.4334Z</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-06802-0</pub-id></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Breaking reciprocity with space‐time‐coding digital metasurfaces</article-title><source>Adv. Mater.</source><year>2019</year><volume>31</volume><fpage>1904069</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhsF2mtL7K</pub-id><pub-id pub-id-type="doi">10.1002/adma.201904069</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Duan</surname><given-names>Y</given-names></name><name><surname>Ni</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Nonreciprocal metasurface with space-time phase modulation</article-title><source>Light Sci. Appl.</source><year>2019</year><volume>8</volume><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXisVeitrnK</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019LSA.....8..123G</pub-id><pub-id pub-id-type="doi">10.1038/s41377-019-0225-z</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec12"><title>Supplementary information</title><p id="Par29"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41467_2020_15273_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary Information</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary information</title><p><bold>Supplementary information</bold> is available for this paper at <ext-link xlink:href="10.1038/s41467-020-15273-1" ext-link-type="doi">https://doi.org/10.1038/s41467-020-15273-1</ext-link>.</p></notes><notes notes-type="Misc"><p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work.</p></notes><notes notes-type="Misc"><p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Nature Communications</facet-value></facet><facet name="year"><facet-value count="1">2020</facet-value></facet><facet name="country"><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
