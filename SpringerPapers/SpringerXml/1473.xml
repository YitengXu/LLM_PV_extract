<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s40565-017-0290-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40565</journal-id><journal-title-group><journal-title>Journal of Modern Power Systems and Clean Energy</journal-title><abbrev-journal-title abbrev-type="publisher">J. Mod. Power Syst. Clean Energy</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2196-5625</issn><issn pub-type="epub">2196-5420</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40565-017-0290-3</article-id><article-id pub-id-type="manuscript">290</article-id><article-id pub-id-type="doi">10.1007/s40565-017-0290-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">A robust optimization method for energy management of CCHP microgrid</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>LUO</surname><given-names>Zhao</given-names></name><address><email>waiting.1986@live.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar1"><title>Zhao LUO</title><p id="Par1">received his M.Eng in Electrical Engineering from Southeast University, China, in 2013. He is currently pursuing a Ph.D. degree in Electrical Engineering at Southeast University. His research interests include renewable energy technology and microgrids.</p></sec></bio></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><name><surname>GU</surname><given-names>Wei</given-names></name><address><email>wgu@seu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4056501702903_cor2">b</xref><bio><sec id="FPar2"><title>Wei GU</title><p id="Par2">received his B.Eng. and Ph.D. degrees in Electrical Engineering from Southeast University, China, in 2001 and 2006, respectively. From 2009 to 2010, he was a Visiting Scholar in the Department of Electrical Engineering, Arizona State University, Tempe, AZ, USA. He is now a professor in the School of Electrical Engineering at Southeast University. His research interests include distributed generation and microgrids, active distribution networks, and power quality.</p></sec></bio></contrib><contrib contrib-type="author" id="Au3"><name><surname>WU</surname><given-names>Zhi</given-names></name><address><email>zwu@seu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><bio><sec id="FPar3"><title>Zhi WU</title><p id="Par3">received the B.Eng. degree in mathematics from Southeast University, China in 2009. And he received the M.Sc. degree in Electrical Engineering at the School of Electrical Engineering, Southeast University, in 2012. He received the Ph.D. degree from University of Birmingham, UK in 2016.Currently he is working as a lecturer in Southeast University. His research interests include renewable energy, planning and optimization techniques.</p></sec></bio></contrib><contrib contrib-type="author" id="Au4"><name><surname>WANG</surname><given-names>Zhihe</given-names></name><address><email>wzhihew@163.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar4"><title>Zhihe WANG</title><p id="Par4">received a B.Eng. in Electrical Engineering from China University of Mining and Technology, China, in 2013. He is currently pursuing an M.Eng in Electrical Engineering at Southeast University, China. His research interests are renewable energy technology and economic dispatch of microgrids.</p></sec></bio></contrib><contrib contrib-type="author" id="Au5"><name><surname>TANG</surname><given-names>Yiyuan</given-names></name><address><email>tangyiyuan19@126.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar5"><title>Tiyuan TANG</title><p id="Par5">received a B.Eng. in Electrical Engineering from Southeast University, China, in 2013. She is currently pursuing an M.Eng in Electrical Engineering at Southeast University, China. Her research interests are renewable energy technology and economic dispatch of microgrids.</p></sec></bio></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1761 0489</institution-id><institution-id institution-id-type="GRID">grid.263826.b</institution-id><institution content-type="org-division">School of Electrical Engineering</institution><institution content-type="org-name">Southeast University</institution></institution-wrap><addr-line content-type="city">Nanjing</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7486</institution-id><institution-id institution-id-type="GRID">grid.6572.6</institution-id><institution content-type="org-division">School of Electronic, Electrical and Systems Engineering</institution><institution content-type="org-name">University of Birmingham</institution></institution-wrap><addr-line content-type="city">Birmingham</addr-line><country country="GB">UK</country></aff></contrib-group><author-notes><corresp id="IDs4056501702903_cor2"><label>b</label><email>wgu@seu.edu.cn</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>14</day><month>6</month><year>2017</year></pub-date><pub-date date-type="pub" publication-format="print"><month>1</month><year>2018</year></pub-date><volume>6</volume><issue seq="12">1</issue><fpage>132</fpage><lpage>144</lpage><history><date date-type="registration"><day>18</day><month>4</month><year>2017</year></date><date date-type="received"><day>23</day><month>3</month><year>2016</year></date><date date-type="accepted"><day>15</day><month>12</month><year>2016</year></date><date date-type="online"><day>14</day><month>6</month><year>2017</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2017</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par6">Energy management is facing new challenges due to the increasing supply and demand uncertainties, which is caused by the integration of variable generation resources, inaccurate load forecasts and non-linear efficiency curves. To meet these challenges, a robust optimization method incorporating piecewise linear thermal and electrical efficiency curve is proposed to accommodate the uncertainties of cooling, thermal and electrical load, as well as photovoltaic (PV) output power. Case study results demonstrate that the robust optimization model performs better than the deterministic optimization model in terms of the expected operation cost. The fluctuation of net electrical load has greater effect on the dispatching results of the combined cooling, heating and power (CCHP) microgrid than the fluctuation of the cooling and thermal load. The day-ahead schedule is greatly affected by the uncertainty budget of the load demand. The economy of the optimal decision could be achieved by adjusting different uncertainty budget levels according to control the conservatism of the model.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Combined cooling</kwd><kwd>Heating and power (CCHP)</kwd><kwd>Microgrid</kwd><kwd>Piecewise linear</kwd><kwd>Robust optimization</kwd><kwd>Uncertainty</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>National Science Foundation of China</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">51277027</award-id><principal-award-recipient><name><surname>GU</surname><given-names>Wei</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>National Science and Technology Support Program of China</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">2015BAA01B01</award-id><principal-award-recipient><name><surname>GU</surname><given-names>Wei</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>State Grid Corporation of China</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">SGTYHT/14-JS-188</award-id><principal-award-recipient><name><surname>GU</surname><given-names>Wei</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2017</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>18</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40565_2017_Article_290.pdf</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>22</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>SC17</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="Misc"><p>CrossCheck date: 30 November 2016</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par7">The energy crisis and rising air pollution have led to a greater worldwide focus on energy efficiency methods. A promising approach for domestic power generation is a combined cooling, heating and power (CCHP) system [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>], that can simultaneously provide cooling, heating and power energy. CCHP systems have also been referred to as tri-generation systems, and have been widely applied in hospitals, supermarkets, and schools [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. CCHP microgrid is a complex system with many operation conditions, a variety of structures, and highly coupled characteristics caused by the physical connections among components. The optimal control strategy relies on the load profile and RES generation, which might show different patterns in the terms of different time scales, such as daily/weekly/monthly/seasonal patterns. It is also difficult to characterize the performance of the components because of the nonlinearity of their efficiency curves, which cannot be expressed as deterministic values. Considering these obstacles, energy management of a CCHP microgrid is challenging.</p><p id="Par8">Many researches have been carried out about optimizing CCHP microgrid operation using different strategies and optimization methods. The performance of CCHP systems following a hybrid electric-thermal load (FHL) is compared with the performance of a CCHP following the electric load (FEL) and the thermal load (FTL) [<xref ref-type="bibr" rid="CR8">8</xref>]. To compensate prediction error, an online optimal operation approach for CCHP microgrids based on model predictive control with feedback correction was proposed in [<xref ref-type="bibr" rid="CR9">9</xref>]. A comparison between the CCHP systems and traditional systems was carried out in [<xref ref-type="bibr" rid="CR10">10</xref>], in terms of the energy-saving ratio and the cost-saving ratio. Chance constrained programming and particle swarm optimization were used in [<xref ref-type="bibr" rid="CR11">11</xref>] to optimize economic dispatch of combined heat and power (CHP) system. The optimization model for planning operation of CCHP systems was presented in [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>], and the mixed integer nonlinear programming model was then converted into a linear programming model by appropriate piecewise linear approximation of the nonlinear performance curve.</p><p id="Par9">Any solution must address the impacts of uncertainties on optimal CCHP system operation. Stochastic optimization [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], chance-constrained stochastic optimization [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], fuzzy programs [<xref ref-type="bibr" rid="CR21">21</xref>], and quantitative uncertainty analysis [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref>] have been applied in power generation and irrigation systems. However, the computational solutions to the stochastic optimization problem are intractable and only an approximate model can be used. Moreover, the probabilistic distribution or precise data parameters of the uncertainty parameters must be given, which is problematic in real-world applications.</p><p id="Par10">Recently, the robust optimization has received significant attention in [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] as a modelling framework for optimization under parameter uncertainty. The robust optimization seeks the commitment and dispatch of generation resources for immunizing against all possible uncertain situations. In [<xref ref-type="bibr" rid="CR27">27</xref>], a robust optimization approach was proposed to accommodate the uncertainties of wind power and provide a robust unit commitment schedule for thermal generators under the worst wind power output scenario. Hajimiragha et al. [<xref ref-type="bibr" rid="CR28">28</xref>] applied a robust model to analyze the electricity and transport sectors by considering the most relevant planning uncertainties and determining the impact of estimation errors on the parameters of the planning model. In considering the worst-case amount of harvested RES, [<xref ref-type="bibr" rid="CR29">29</xref>] introduced a robust optimization approach to maintain the supply demand balance arising from intermittent RES. In [<xref ref-type="bibr" rid="CR30">30</xref>], an inexact two-stage stochastic robust programming was proposed for residential micro-grid management-based on random demand. In [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], a robust optimization method was introduced to determine the optimum capacity of distributed generation technologies for buildings under uncertain energy demands. The work in [<xref ref-type="bibr" rid="CR33">33</xref>] used a robust optimization model for managing combined heat and power systems via linear decision rules. In [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>], a utilized robust optimization model was utilized to manage building energy system with CHP systems considering the randomness of electrical and thermal load, as well as solar power production. However, [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>] did not consider battery cost, piecewise linear approximate the non-linear efficiency curves of the MT and their influence on dispatching results. Ramp limits and component operational and maintenance cost were also not considered. In addition, few research considered the situation that the fluctuation of different load have effect on the dispatching results of a CCHP microgrid under different robustness budget.</p><p id="Par11">To deal with these problem, we employ the robust optimization approach incorporating a piecewise linear thermal and electrical efficiency curve to hedge the uncertainties of the power (cooling load, thermal load, electric load, and PV outputs) in this paper. Specifically, the uncertainties of the load and output PV in each period are within an interval defined by their lower and upper bounds and can be obtained based on the historical data or estimated with a confidence interval. This problem can be formulated as a min-max problem with the objective of minimizing the total cost under the worst scenario. We apply a tractable solution approach to solve robust optimization problem and verify the effectiveness of the proposed approach with computational results in this paper.</p><p id="Par12">The remainder of this paper is organized as follows. Section <xref rid="Sec2" ref-type="sec">2</xref> formulates the deterministic optimization model for energy management of a CCHP microgrid. Section <xref rid="Sec3" ref-type="sec">3</xref> presents a detailed expression of the worst-case optimization model and the proposed robust interval optimization model for energy management of CCHP Microgrid. Section <xref rid="Sec6" ref-type="sec">4</xref> presents numerical case study results, and conclusions are drawn in Section <xref rid="Sec10" ref-type="sec">5</xref>.</p></sec><sec id="Sec2"><title>Deterministic optimal dispatching model for a CCHP microgrid</title><p id="Par13">A schematic of the energy flows for the CCHP microgrid is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This paper considers a CCHP microgrid that includes a PV cell, a battery, an MT, a gas boiler, an absorption chiller, an electric chiller, and heat exchanger, along with cooling, heating and power load.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Schematic of a CCHP microgrid</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig1_HTML.gif" id="MO1"/></fig><list list-type="order"><list-item><p id="Par14">Optimization objective: The objective function contains cost and incomes:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{min}\,C = \sum\limits_{t = 1}^{T} {C_{grid} { + }C_{ng} + C_{bt} + C_{rm} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ1.gif"/></alternatives></disp-formula><list list-type="order"><list-item><p id="Par15">Cost of interacting with the grid:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{grid}^{t} { = }(R_{grid}^{t} P_{grid}^{t} - R_{excess}^{t} P_{excess}^{t} )\Delta t$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ2.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par16">Aging Cost of the battery [<xref ref-type="bibr" rid="CR34">34</xref>]:<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{bt}^{t} = R_{bt} (U_{bt,dis*}^{t} + U_{bt,chr*}^{t} )\Delta t$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ3.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par17">Natural gas cost:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{ng}^{t} = R_{ng}^{t} (F_{mt}^{t} + F_{b}^{t} )\Delta t$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ4.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par18">Running and maintenance cost:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mtext>/</mml:mtext><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mrow/><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mtext>)</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mtext>)</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{rm}^{t} = \left[ \begin{aligned} P_{mt}^{t} R_{mt,rm} \text{ + }H_{b}^{t} R_{b,rm} \text{ + }H_{h}^{t} \text{/}\eta_{he} R_{he,rm} \text{ + } \hfill \\ \begin{array}{*{20}l} {\begin{array}{*{20}l} {} \hfill \\ \end{array} } \hfill \\ \end{array} \begin{array}{*{20}l} {} \hfill \\ \end{array} H_{ac}^{t} R_{ac,rm} \text{ + }P_{ec}^{t} R_{ec,rm} \text{ + }P_{pv}^{t} R_{pv,rm} \text{ + } \hfill \\ (P_{bt,chr}^{t} + P_{bt,dis}^{t} \text{)}R_{bt,rm} \text{ + }(H_{tst,chr}^{t} + H_{tst,dis}^{t} \text{)}R_{tst,rm} \hfill \\ \end{aligned} \right]\Delta t$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ5.gif"/></alternatives></disp-formula></p></list-item></list>where <italic>C</italic><sub arrange="stack"><italic>ng</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>C</italic><sub arrange="stack"><italic>grid</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>C</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>C</italic><sub arrange="stack"><italic>rm</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the natural gas cost, the cost of interacting with the grid, the aging cost function of the battery, and the running and maintenance cost of the system in time period <italic>t</italic>, respectively; <italic>R</italic><sub arrange="stack"><italic>ng</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the tariff for natural gas; <italic>F</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>F</italic><sub arrange="stack"><italic>b</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the fuel consumption of the MT and the boiler in period <italic>t</italic>, respectively; <italic>R</italic><sub arrange="stack"><italic>grid</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the tariff for purchasing power from the main grid; <italic>R</italic><sub arrange="stack"><italic>excess</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the tariff for selling power to the main grid; <italic>P</italic><sub arrange="stack"><italic>grid</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>excess</italic></sub><sup arrange="stack"><italic>t</italic></sup> are power provided by the main grid and sold to the main grid in period <italic>t</italic>, respectively; <italic>R</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>t</italic></sup> is charge/discharge of battery cycles cost; <italic>U</italic><sub arrange="stack"><italic>c,bt*</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>U</italic><sub arrange="stack"><italic>disc,bt*</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the status flag transferring from charging to discharging and from discharging to charging of the battery in period <italic>t</italic>; <italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the power and heat produced by the MT in period <italic>t</italic>; <italic>P</italic><sub arrange="stack"><italic>bt,chr</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>bt,dis</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the charge/discharge power of BT in period <italic>t</italic>; <italic>H</italic><sub arrange="stack"><italic>tst,chr</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>tst,dis</italic></sub><sup arrange="stack"><italic>t</italic></sup> are the thermal power stored/released by TST in period <italic>t</italic>; <italic>H</italic><sub arrange="stack"><italic>ac</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the heat required by the absorption chiller when handling the users’ cooling requirements in period <italic>t</italic>; <italic>P</italic><sub arrange="stack"><italic>ec</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the electricity demand of the electric chiller when handling the users’ cooling requirements in period <italic>t</italic>; <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the PV output in period <italic>t</italic>; and <italic>R</italic><sub><italic>rm</italic></sub> is the running and maintenance cost of the unit.</p></list-item><list-item><p id="Par19">Constraints on the system: constraints include cooling balances, heating balances, electricity balances and operational constraints for each device.<list list-type="order"><list-item><p id="Par20">Cooling balance:<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$COP_{ac} \cdot H_{ac}^{t} + COP_{ec} \cdot P_{ec}^{t} - Q_{c}^{t} = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ6.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par21">Thermal balance:<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{re}^{t} + H_{b}^{t} - H_{ac}^{t} - H_{tst,dis}^{t} + H_{tst,chr}^{t} = H_{h}^{t} /\eta_{he}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ7.gif"/></alternatives></disp-formula>where the recovered thermal energy <italic>H</italic><sub arrange="stack"><italic>re</italic></sub><sup arrange="stack"><italic>t</italic></sup> from the MT can be estimated as:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{re}^{t} = H_{mt}^{t} \eta_{re}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ8.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par22">Electric power balance:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{mt}^{t} + P_{grid}^{t} + P_{ec}^{t} + P_{bt,dich}^{t} - P_{bt,chr}^{t} - P_{excess}^{t} = P_{l}^{t} - P_{pv}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ9.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par23">Micro gas turbine:</p><p id="Par24">The relationship between the fuel energy (<italic>F</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup>) and the power output (<italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup>) can be modeled using a straight line [<xref ref-type="bibr" rid="CR1">1</xref>].<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">α</mml:mi><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="italic">β</mml:mi><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{mt}^{t} = \alpha P_{mt}^{t} + \beta U_{mt}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ10.gif"/></alternatives></disp-formula>where <italic>α</italic>, <italic>β</italic> are fuel-to-electric-energy conversion parameter, respectively; and <italic>U</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the binary variable that is equal to 1 if the MT is on in period <italic>t</italic> and 0 otherwise. The capacity and ramp rate constraints are define by (<xref rid="Equ9" ref-type="disp-formula">9</xref>)–(<xref rid="Equ11" ref-type="disp-formula">11</xref>):<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{mt}^{t} P_{mt}^{\hbox{min} } \le P_{mt}^{t} \le U_{mt}^{t} P_{mt}^{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ11.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{mt}^{t} P_{mt}^{down} \le P_{mt}^{t} - P_{mt}^{t - 1} \le U_{mt}^{t} P_{mt}^{up}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par25">For each unit in the system, the input variables (consumed fuel and electricity) are related to the output variables (generated heat, electricity, cooling) by means of the nonlinear performance curves. Usually, low load results in low efficiency. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the thermal and electrical efficiency of the MT is defined in (<xref rid="Equ13" ref-type="disp-formula">13</xref>)–(<xref rid="Equ16" ref-type="disp-formula">16</xref>) through piecewise linearization [<xref ref-type="bibr" rid="CR12">12</xref>]. Because the nonlinear efficiency curve is changed to several line segments, the control problem can be modelled as a MILP:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{mt}^{t} = U_{mt}^{t} B_{mt}^{1} + \sum\limits_{k = 1}^{{L_{mt} }} {D_{mt}^{t,k} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{mt}^{t} = \sum\limits_{k = 1}^{{L_{mt} }} {v_{mt}^{t,k} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mfrac><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum\limits_{j = k + 1}^{{L_{mt} }} {v_{mt}^{t,k} } \le \frac{{D_{mt}^{t,k} }}{{B_{mt}^{k + 1} - B_{mt}^{k} }} \le \sum\limits_{j = k}^{{L_{mt} }} {v_{mt}^{t,k} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ15.gif"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{mt}^{t} = U_{mt}^{t} A_{mt}^{1} + \sum\limits_{k = 1}^{{L_{mt} }} {g_{mt}^{k} } D_{mt}^{t,k}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ16.gif"/></alternatives></disp-formula>where <italic>H</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t</italic></sup> is the heat produced by the MT; <italic>A</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>k</italic></sup> is the coefficient of the thermal and electrical efficiency curve; <italic>B</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>k</italic></sup> is the block limit of the thermal and electrical efficiency curve; <italic>g</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>k</italic></sup> is the slope of block <italic>k</italic> of the thermal and electrical efficiency curve; <italic>v</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>t,k</italic></sup> is the binary variable encoding the thermal and electrical efficiency curve of the MT; and <italic>L</italic><sub><italic>mt</italic></sub> is the index set of the piecewise linear thermal and electrical efficiency curve.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Piecewise linear approximation of thermal and electrical efficiency curve of the MT</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig2_HTML.gif" id="MO18"/></fig></p></list-item><list-item><p id="Par26">Storage battery: The MIP formulation of the battery energy model is represented by:<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} U_{bt,chr}^{t} P_{bt,chr}^{\hbox{min} } \le P_{bt,chr}^{t} \le U_{bt,chr}^{t} P_{bt,chr}^{\hbox{max} } \hfill \\ U_{bt,dis}^{t} P_{bt,dis}^{\hbox{min} } \le P_{bt,dis}^{t} \le U_{bt,dis}^{t} P_{bt,dis}^{\hbox{max} } \hfill \\ U_{bt,dis}^{t} + U_{bt,chr}^{t} \le 1 \hfill \\ W_{bt}^{t} = W_{bt}^{t - 1} (1 - \sigma_{bt} ) + (\eta_{bt}^{chr} P_{bt,chr}^{t} - P_{bt,dis}^{t} /\eta_{bt}^{dis} )\Delta t \hfill \\ W_{bt}^{\hbox{min} } \le W_{bt}^{t + 1} \le W_{bt}^{\hbox{max} } \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ17.gif"/></alternatives></disp-formula></p><p id="Par27">Equations (<xref rid="Equ14" ref-type="disp-formula">14</xref>)–(<xref rid="Equ15" ref-type="disp-formula">15</xref>) represent the ramp rate constraints of the charging/discharging battery:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{bt,chr}^{down} \le P_{bt,chr}^{t + 1} - P_{bt,chr}^{t - 1} \le P_{bt,chr}^{up}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ18.gif"/></alternatives></disp-formula><disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{bt,dis}^{down} \le P_{bt,dis}^{t + 1} - P_{bt,dis}^{t} \le P_{bt,dis}^{up}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ19.gif"/></alternatives></disp-formula></p><p id="Par28">Equations (<xref rid="Equ16" ref-type="disp-formula">16</xref>)–(<xref rid="Equ17" ref-type="disp-formula">17</xref>) represent the status-transfer flag of the charging/discharging battery:<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{bt,chr}^{t + 1} - U_{bt,chr}^{t} \le U_{bt,chr*}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{bt,dis}^{t + 1} - U_{bt,dis}^{t} \le U_{bt,dis*}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ21.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par29">Thermal storage tank (TST):<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} U_{tst,dis}^{t} H_{tst,dis}^{\hbox{min} } \le H_{tst,dis}^{t} \le U_{tst,dis}^{t} H_{tst,dis}^{\hbox{max} } \hfill \\ U_{tst,chr}^{t} H_{tst,chr}^{\hbox{min} } \le H_{tst,chr}^{t} \le U_{tst,chr}^{t} H_{tst,chr}^{\hbox{max} } \hfill \\ U_{tst,chr}^{t} + U_{tst,dis}^{t} \le 1 \hfill \\ H_{ts}^{t} = H_{ts}^{t - 1} \left( {1 - \sigma_{tst} } \right) + (\eta_{tst}^{chr} H_{tst,chr}^{t} - H_{tst,dis}^{t} /\eta_{tst}^{dis} )\Delta t \hfill \\ H_{tst}^{\hbox{min} } \le H_{tst}^{t} \le H_{{_{tst} }}^{\hbox{max} } \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ22.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par30">Power exchange between the main grid and microgrid:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{l} 0 \le P_{grid}^{t} \le U_{grid}^{t} P_{grid}^{\hbox{max} } \hfill \\ 0 \le P_{excess}^{t} \le U_{excess}^{t} P_{grid}^{\hbox{max} } \hfill \\ \end{array} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ23.gif"/></alternatives></disp-formula></p><p id="Par31">Mutual exclusion of status:<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{grid}^{t} + U_{excess}^{t} \le 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ24.gif"/></alternatives></disp-formula></p></list-item></list></p></list-item></list></p></sec><sec id="Sec3"><title>Solution methodology</title><sec id="Sec4"><title>Robust decision-making model</title><p id="Par32">A typical MILP model is defined in the following form:<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{min}\begin{array}{*{20}c} {} \\ \end{array} \sum\limits_{j = 1}^{n} {c_{j} x_{j} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ25.gif"/></alternatives></disp-formula><disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtext>s.t.</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{s.t.}}\begin{array}{*{20}c} {} \\ \end{array} \begin{array}{*{20}c} {} \\ \end{array} \sum\limits_{j = 1}^{n} {a_{ij} x_{j} \le b_{j} } ,\forall i = 1,2, \cdots ,m$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ26.gif"/></alternatives></disp-formula><disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \ge 0,\forall j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ27.gif"/></alternatives></disp-formula><disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>for some</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \in \left\{ {0,1} \right\}\;\;\;{\text{for some }}j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ28.gif"/></alternatives></disp-formula></p><p id="Par33">The uncertainty may reside in the coefficient <italic>a</italic><sub><italic>ij</italic></sub>, the objective function <italic>c</italic> or the right-hand side <italic>b</italic>. If these coefficients are unknown constants within known bounds, a meaningful robust MILP can be formulated. Unlike the modeling of uncertainty in stochastic programming, the uncertainty model in robust optimization is typically depicted as an uncertainty range. Each coefficient <italic>a</italic><sub><italic>ij</italic></sub> in the constraints of the constraints of the formulation (i.e., the coefficient of the <italic>j</italic><sup><italic>th</italic></sup> variable in the <italic>i</italic><sup><italic>th</italic></sup> constraint) is an independent, symmetrical and bounded random variable that can assume a value from the interval <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\bar{a}_{ij} - \hat{a}_{ij} ,\bar{a}_{ij} + \hat{a}_{ij} ]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_IEq1.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{a}_{ij}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_IEq2.gif"/></alternatives></inline-formula> is the nominal value and <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{a}_{ij}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_IEq3.gif"/></alternatives></inline-formula> is the maximum deviation from the nominal value. The scaled deviation of <italic>a</italic><sub><italic>ij</italic></sub> can be denoted by <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{ij} = (\bar{a}_{ij} - \hat{a}_{ij} )/\bar{a}_{ij}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_IEq4.gif"/></alternatives></inline-formula> or <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{ij} = (\bar{a}_{ij} + \hat{a}_{ij} )/\bar{a}_{ij}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_IEq5.gif"/></alternatives></inline-formula>, which is defined as the relative value of the forecast error and the realization of the uncertainty. In addition, when formulating a robust MILP problem [<xref ref-type="bibr" rid="CR26">26</xref>], it is necessary to define an integer control parameter denoted by <italic>Γ</italic><sub><italic>i</italic></sub> with values in the interval [0, |<italic>J</italic><sub><italic>i</italic></sub>|]; this is called the budget of uncertainty. <italic>Γ</italic><sub><italic>i</italic></sub> = 0 yields the nominal problem and thus does not incorporate uncertainty, whereas <italic>Γ</italic><sub><italic>i</italic></sub> = |<italic>J</italic><sub><italic>i</italic></sub>| corresponds to interval-based uncertainty sets and leads to the most conservative case. The <italic>η</italic><sub><italic>ij</italic></sub> value is constrained as:<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="italic">Γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum\limits_{{j \in J_{i} }} {\eta_{ij} \le \varGamma_{i} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ29.gif"/></alternatives></disp-formula></p><p id="Par34">A robust optimization formulation seeks for optimal solutions that optimize the objective function and meet the problem requirements for all possible uncertainties in constraint coefficients. As a result, the variables are independent of the uncertain parameters. In a worst-case analysis that accounts for uncertainty, we consider the following problem (<xref rid="Equ30" ref-type="disp-formula">30</xref>)–(<xref rid="Equ33" ref-type="disp-formula">33</xref>):<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ \hbox{min} }\begin{array}{*{20}c} {} \\ \end{array} \sum\limits_{j = 1}^{n} {c_{j} x_{j} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ30.gif"/></alternatives></disp-formula><disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{s}} . {\text{t}} .\begin{array}{*{20}c} {} \\ \end{array} \begin{array}{*{20}c} {} \\ \end{array} \sum\limits_{j = 1}^{n} {a_{ij} x_{j} + { \hbox{max} }\sum\limits_{{j \in J_{i} }} {\hat{a}_{ij} \eta_{ij} x_{j} } \le b_{j} } ,\forall i = 1,2, \cdots ,m$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ31.gif"/></alternatives></disp-formula><disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \ge 0,\forall j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ32.gif"/></alternatives></disp-formula><disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>for some</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \in \left\{ {0,1} \right\}\;\;{\text{for some }}j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ33.gif"/></alternatives></disp-formula></p><p id="Par35">For the <italic>i</italic><sup>th</sup> constraint, the auxiliary problem (<xref rid="Equ34" ref-type="disp-formula">34</xref>)–(<xref rid="Equ36" ref-type="disp-formula">36</xref>) is shown as follows:<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ \hbox{max} }\begin{array}{*{20}l} {} \hfill \\ \end{array} \sum\limits_{{j \in J_{i} }} {\hat{a}_{ij} \eta_{ij} \left| {x_{j} } \right|}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ34.gif"/></alternatives></disp-formula><disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="italic">Γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{s}} . {\text{t}} .\begin{array}{*{20}c} {} &amp; {\sum\limits_{{j \in J_{i} }} {\eta_{ij} \le \varGamma_{i} } } \\ \end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ35.gif"/></alternatives></disp-formula><disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \le \eta_{ij} \le 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ36.gif"/></alternatives></disp-formula></p><p id="Par36">Accordingly, the dual of problem (<xref rid="Equ34" ref-type="disp-formula">34</xref>)–(<xref rid="Equ36" ref-type="disp-formula">36</xref>) is shown as problem (<xref rid="Equ37" ref-type="disp-formula">37</xref>)–(<xref rid="Equ40" ref-type="disp-formula">40</xref>):<disp-formula id="Equ37"><label>37</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">Γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ \hbox{min} }\begin{array}{*{20}l} {} \hfill \\ \end{array} z_{i} \varGamma_{i} + \sum\limits_{{j \in J_{i} }} {p_{ij} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ37.gif"/></alternatives></disp-formula><disp-formula id="Equ38"><label>38</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{s} .t.\begin{array}{*{20}c} {} &amp; {z_{i} + p_{ij} \ge \hat{a}_{ij} y_{j} ,\forall i,\,j \in J_{i} } \\ \end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ38.gif"/></alternatives></disp-formula><disp-formula id="Equ39"><label>39</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {x_{j} } \right| \le y_{j}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ39.gif"/></alternatives></disp-formula><disp-formula id="Equ40"><label>40</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{i} ,p_{ij} ,y_{j} \ge 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ40.gif"/></alternatives></disp-formula>where <italic>z</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub> are the dual decision variables for constraints (<xref rid="Equ35" ref-type="disp-formula">35</xref>)–(<xref rid="Equ36" ref-type="disp-formula">36</xref>) of the auxiliary problem. When incorporating model (<xref rid="Equ37" ref-type="disp-formula">37</xref>)–(<xref rid="Equ40" ref-type="disp-formula">40</xref>) into the original problem (<xref rid="Equ30" ref-type="disp-formula">30</xref>)–(<xref rid="Equ33" ref-type="disp-formula">33</xref>), the robust linear counterpart is formulated as:<disp-formula id="Equ41"><label>41</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ \hbox{min} }\begin{array}{*{20}c} {} \\ \end{array} \sum\limits_{j = 1}^{n} {c_{j} x_{j} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ41.gif"/></alternatives></disp-formula><disp-formula id="Equ42"><label>42</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">Γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{s}} . {\text{t}} .\begin{array}{*{20}c} {} &amp; {\sum\limits_{{j \in J_{i} }} {a_{ij} x_{j} } + z_{i} \varGamma_{i} + \sum\limits_{{j \in J_{i} }} {p_{ij} } \le b_{i} } \\ \end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ42.gif"/></alternatives></disp-formula><disp-formula id="Equ43"><label>43</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \ge 0,\forall j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ43.gif"/></alternatives></disp-formula><disp-formula id="Equ44"><label>44</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>for some</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{j} \in \left\{ {0,1} \right\}\;\;{\text{for some }}j = 1,2, \cdots ,n$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ44.gif"/></alternatives></disp-formula><disp-formula id="Equ45"><label>45</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{i} + p_{ij} \ge \hat{a}_{ij} y_{j} ,\forall i,j \in J_{i}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ45.gif"/></alternatives></disp-formula><disp-formula id="Equ46"><label>46</label><alternatives><mml:math display="block" id="Equ46_Math"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {x_{j} } \right| \le y_{j}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ46.gif"/></alternatives></disp-formula><disp-formula id="Equ47"><label>47</label><alternatives><mml:math display="block" id="Equ47_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{i} ,p_{ij} ,y_{j} \ge 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ47.gif"/></alternatives></disp-formula></p></sec><sec id="Sec5"><title>Uncertain energy output formulation</title><p id="Par37">In general, the optimal operation of a CCHP microgrid is associated with uncertainties from cooling, thermal and electrical load, and the PV output. The randomness of cooling and thermal load is affected by the weather surrounding the buildings; the electrical load in the buildings are influenced by the level of consumer activities, and the power output of a PV unit can be impacted by the radiation of the sun and the ambient weather. Because of these factors, it is difficult to precisely characterise their power value. In this paper, we assume that these power values fall within the intervals of <italic>Q</italic><sub arrange="stack"><italic>c,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> ∈ [<italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup> − <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ld</italic></sup><italic>, Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup> + <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ud</italic></sup>], <italic>H</italic><sub arrange="stack"><italic>h,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> ∈ [<italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup><italic>− H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ld</italic></sup><italic>, H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup> + <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ud</italic></sup>], <italic>P</italic><sub arrange="stack"><italic>l,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> ∈ [<italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>t</italic></sup> − <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ld</italic></sup><italic>, P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>t</italic></sup> + <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ud</italic></sup>], and <italic>P</italic><sub arrange="stack"><italic>pv,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> ∈ [<italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup> − <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ld</italic></sup><italic>, P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup> + <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ud</italic></sup>], with <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>t</italic></sup> and <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup> representing the predicted value in period <italic>t</italic> and <italic>Q</italic><sub arrange="stack"><italic>c,u</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h,u</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>l,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> and <italic>P</italic><sub arrange="stack"><italic>pv,u</italic></sub><sup arrange="stack"><italic>t</italic></sup> representing sets of possible cooling, thermal and electrical load and the output PV. <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ud</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ud</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ud</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ld</italic></sup> and <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ud</italic></sup> representing the allowed maximum deviations above and below <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>t</italic></sup> and <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup>, respectively, which can take any values with their uncertain interval. For this approach, <italic>Γ</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>Γ</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>Γ</italic><sub arrange="stack"><italic>nl</italic></sub><sup arrange="stack"><italic>t</italic></sup> represent cardinality budgets [<xref ref-type="bibr" rid="CR26">26</xref>] introduced to adjust the ranges of uncertainty for the cooling, thermal and net electricity load (<italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>t</italic></sup> − <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>t</italic></sup>) in period <italic>t</italic> by the system operators, respectively; these affect the robustness of the problem against the level of conservatism of the solution.</p><p id="Par38">The worst-case scenario is the key aspect of the robust interval optimization model; it is a set of parameter values such that the security for any other scenarios can be guaranteed if and only if there is a feasible solution under this scenario [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR35">35</xref>]. Therefore, the expressions in (<xref rid="Equ48" ref-type="disp-formula">48</xref>), (<xref rid="Equ51" ref-type="disp-formula">51</xref>) and (<xref rid="Equ54" ref-type="disp-formula">54</xref>), can be interpreted as the security requirements of the CCHP microgrid under the worst-case scenarios of uncertain parameters (cooling, thermal, electrical load and PV output):<disp-formula id="Equ48"><label>48</label><alternatives><mml:math display="block" id="Equ48_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} COP_{ac} \cdot H_{ac}^{t} + COP_{ec} \cdot P_{ec}^{t} = \hbox{max} Q_{c,u}^{t} \hfill \\ \begin{array}{*{20}c} {\begin{array}{*{20}c} {} &amp; {} \\ \end{array} } &amp; {} \\ \end{array} = Q_{c}^{t} + \hbox{max} \{ \eta_{c}^{ld} Q_{c}^{ld} + \eta_{c}^{ud} Q_{c}^{ud} \} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ48.gif"/></alternatives></disp-formula><disp-formula id="Equ49"><label>49</label><alternatives><mml:math display="block" id="Equ49_Math"><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{c}^{ld} + \eta_{c}^{ud} \le \varGamma_{c}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ49.gif"/></alternatives></disp-formula><disp-formula id="Equ50"><label>50</label><alternatives><mml:math display="block" id="Equ50_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \le \eta_{c}^{ld} ,\eta_{c}^{ud} \le 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ50.gif"/></alternatives></disp-formula><disp-formula id="Equ51"><label>51</label><alternatives><mml:math display="block" id="Equ51_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H_{re}^{t} + H_{b}^{t} - H_{ac}^{t} - H_{tst,dis}^{t} + H_{tst,chr}^{t} = \hbox{max} (H_{h,u}^{t} )/\eta_{he} \hfill \\ \begin{array}{*{20}c} {} &amp; {} &amp; {} \\ \end{array} = H_{h}^{t} /\eta_{he} + \hbox{max} \{ \eta_{h}^{ld} H_{h}^{ld} + \eta_{h}^{ud} H_{h}^{ud} \} /\eta_{he} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ51.gif"/></alternatives></disp-formula><disp-formula id="Equ52"><label>52</label><alternatives><mml:math display="block" id="Equ52_Math"><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{h}^{ld} + \eta_{h}^{ud} \le \varGamma_{h}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ52.gif"/></alternatives></disp-formula><disp-formula id="Equ53"><label>53</label><alternatives><mml:math display="block" id="Equ53_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \le \eta_{h}^{ld} ,\eta_{h}^{ud} \le 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ53.gif"/></alternatives></disp-formula><disp-formula id="Equ54"><label>54</label><alternatives><mml:math display="block" id="Equ54_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{mt}^{t} + P_{grid}^{t} + P_{bt,chr}^{t} + P_{ec}^{t} - P_{excess}^{t} - P_{bt,dis}^{t} = \hbox{max} (P_{l,u}^{t} - P_{pv,u}^{t} ) \hfill \\ = P_{l}^{t} - P_{pv}^{t} + \hbox{max} \left\{ {\eta_{l}^{ld} P_{l}^{ld} + \eta_{l}^{ud} P_{l}^{ud} - \eta_{pv}^{ld} P_{pv}^{ld} - \eta_{pv}^{ud} P_{pv}^{ud} } \right\} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ54.gif"/></alternatives></disp-formula><disp-formula id="Equ55"><label>55</label><alternatives><mml:math display="block" id="Equ55_Math"><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{l}^{ld} + \eta_{l}^{ud} + \eta_{pv}^{ld} + \eta_{pv}^{ud} \le \varGamma_{nl}^{t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ55.gif"/></alternatives></disp-formula><disp-formula id="Equ56"><label>56</label><alternatives><mml:math display="block" id="Equ56_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \le \eta_{l}^{ld} ,\eta_{l}^{ud} ,\eta_{pv}^{ld} ,\eta_{pv}^{ud} \le 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ56.gif"/></alternatives></disp-formula>where <italic>η</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>η</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ud</italic></sup> are the scaled deviations for the random cooling load; <italic>η</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>η</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ud</italic></sup> are the scaled deviations for the random thermal load. Similarly, <italic>η</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>η</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ud</italic></sup>, <italic>η</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ld</italic></sup>, <italic>η</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ud</italic></sup> are the scaled deviations for the random electrical load and the PV output.</p><p id="Par39">Identifying the worst-case scenarios when cooling, thermal, and electric load and PV vary within their uncertain intervals requires transforming (<xref rid="Equ21" ref-type="disp-formula">21</xref>), (<xref rid="Equ22" ref-type="disp-formula">22</xref>) and (<xref rid="Equ24" ref-type="disp-formula">24</xref>) into an equivalent max optimization problem (<xref rid="Equ48" ref-type="disp-formula">48</xref>), (<xref rid="Equ51" ref-type="disp-formula">51</xref>) and (<xref rid="Equ53" ref-type="disp-formula">53</xref>) for calculating the worst-case scenarios.</p><p id="Par40">Thus, a CCHP microgrid economic dispatch model is a min-max optimization problem. To make the above problem tractable, (57), (63) and (69) must be converted into corresponding dual problems (60), (66) and (72) by introducing dual variables <italic>λ</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>π</italic><sub arrange="stack"><italic>c1</italic></sub><sup arrange="stack"><italic>t</italic>+</sup>, <italic>π</italic><sub arrange="stack"><italic>c1</italic></sub><sup arrange="stack"><italic>t</italic>−</sup>, <italic>λ</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>π</italic><sub arrange="stack"><italic>h1</italic></sub><sup arrange="stack"><italic>t</italic>+</sup>, <italic>π</italic><sub arrange="stack"><italic>h1</italic></sub><sup arrange="stack"><italic>t</italic>−</sup>, <italic>λ</italic><sub arrange="stack"><italic>nl</italic></sub><sup arrange="stack"><italic>t</italic></sup>, <italic>π</italic><sub arrange="stack"><italic>l1</italic></sub><sup arrange="stack"><italic>t</italic>+</sup>, <italic>π</italic><sub arrange="stack"><italic>l1</italic></sub><sup arrange="stack"><italic>t</italic>−</sup>, <italic>π</italic><sub arrange="stack"><italic>pv2</italic></sub><sup arrange="stack"><italic>t</italic>+</sup>, and <italic>π</italic><sub arrange="stack"><italic>pv2</italic></sub><sup arrange="stack"><italic>t</italic>−</sup>.<disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>max</mml:mtext><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>57</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>58</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>59</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo stretchy="false">⇒</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>min</mml:mtext><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>60</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>61</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>62</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\{ {\begin{array}{*{20}c} {\hbox{max} \;\eta_{c}^{ld} Q_{c}^{ld} + \eta_{c}^{ud} Q_{c}^{ud} } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\eta_{c}^{ld} + \eta_{c}^{ud} \le \varGamma_{c}^{t} } \\ \end{array} } \\ {\;\;\begin{array}{*{20}c} {} &amp; {0 \le \eta_{c}^{ld} ,\eta_{c}^{ud} \le 1} \\ \end{array} } \\ \end{array} \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\begin{array}{*{20}c} {(57)} \\ {(58)} \\ {(59)} \\ \end{array} } \right.\begin{array}{*{20}l} {} \hfill \\ \end{array} \hfill \\ \Rightarrow \left\{ {\begin{array}{*{20}c} {\hbox{min} \lambda_{c}^{t} \varGamma_{c}^{t} + \pi_{c1}^{t + } + \pi_{c1}^{t - } } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\lambda_{c}^{t} + \pi_{c1}^{t - } \ge Q_{c}^{ld} ,\lambda_{c}^{t} + \pi_{c2}^{t + } \ge Q_{c}^{ud} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {\lambda_{c}^{t} ,\pi_{c1}^{t + } ,\pi_{c1}^{t - } \ge 0} \\ \end{array} } \\ \end{array} } \right.\begin{array}{*{20}c} {(60)} \\ {(61)} \\ {(62)} \\ \end{array} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equa.gif"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><mml:math display="block" id="Equb_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>63</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>64</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>65</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo stretchy="false">⇒</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>min</mml:mtext><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>66</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>67</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>68</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\{ {\begin{array}{*{20}c} {\hbox{max} (\eta_{h}^{ld} H_{h}^{ld} + \eta_{h}^{ud} H_{h}^{ud} )/\eta_{he} } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\eta_{u}^{ld} + \eta_{h}^{ud} \le \varGamma_{h}^{t} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {0 \le \eta_{h}^{ld} ,\eta_{h}^{ud} \le 1} \\ \end{array} } \\ \end{array} } \right.\;\;\;\;\;\;\;\;\;\;\;\;\;\;\begin{array}{*{20}c} {(63)} \\ {(64)} \\ {(65)} \\ \end{array} \hfill \\ \Rightarrow \left\{ {\begin{array}{*{20}c} {\hbox{min} \lambda_{h}^{t} \varGamma_{h}^{t} + \pi_{h1}^{t + } + \pi_{h1}^{t - } } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\lambda_{c}^{t} + \pi_{h1}^{t - } \ge H_{h}^{ld} ,\lambda_{h}^{t} + \pi_{h1}^{t + } \ge H_{h}^{ud} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {\lambda_{h}^{t} ,\pi_{h1}^{t + } ,\pi_{h1}^{t - } \ge 0} \\ \end{array} } \\ \end{array} } \right.\begin{array}{*{20}c} {(66)} \\ {(67)} \\ {(68)} \\ \end{array} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equb.gif"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><mml:math display="block" id="Equc_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>max</mml:mtext><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>69</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>71</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo stretchy="false">⇒</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>min</mml:mtext><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>72</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>73</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>74</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>75</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equc_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\{ {\begin{array}{*{20}c} {\hbox{max} \;\eta_{l}^{ld} P_{l}^{ld} + \eta_{l}^{ud} P_{l}^{ud} - \eta_{pv}^{ld} P_{pv}^{ld} - \eta_{pv}^{ud} P_{pv}^{ud} } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\eta_{l}^{ld} + \eta_{l}^{ud} + \eta_{pv}^{ld} + \eta_{pv}^{ud} \le \varGamma_{nl}^{t} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {0 \le \eta_{l}^{ld} ,\eta_{l}^{ud} ,\eta_{pv}^{ld} ,\eta_{pv}^{ud} \le 1} \\ \end{array} } \\ \end{array} \begin{array}{*{20}c} {(69)} \\ {(70)} \\ {(71)} \\ \end{array} } \right. \hfill \\ \Rightarrow \left\{ {\begin{array}{*{20}c} {\hbox{min}\, \lambda_{nl}^{t} \varGamma_{nl}^{t} + \pi_{l1}^{t + } + \pi_{l1}^{t - } + \pi_{pv2}^{t + } + \pi_{pv2}^{t - } } \\ {\begin{array}{*{20}c} {{\text{s}} . {\text{t}} .} &amp; {\lambda_{nl}^{t} + \pi_{l1}^{t - } \ge P_{l}^{ld} ,\lambda_{nl}^{t} + \pi_{l2}^{t + } \ge P_{l}^{ud} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {\lambda_{nl}^{t} + \pi_{pv}^{t - } \ge - P_{pv}^{ld} ,\lambda_{nl}^{t} + \pi_{pv}^{t + } \ge - P_{pv}^{ud} } \\ \end{array} } \\ {\begin{array}{*{20}c} {} &amp; {\lambda_{nl}^{t} ,\pi_{l1}^{t + } ,\pi_{l1}^{t - } \pi_{pv2}^{t + } ,\pi_{pv2}^{t - } \ge 0} \\ \end{array} } \\ \end{array} } \right.\begin{array}{*{20}c} {(72)} \\ {(73)} \\ {(74)} \\ {(75)} \\ \end{array} \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equc.gif"/></alternatives></disp-formula></p><p id="Par41">Finally, a tractable robust model can be formulated as:<disp-formula id="Equ57"><label>76</label><alternatives><mml:math display="block" id="Equ57_Math"><mml:mrow><mml:mtext>min</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{min}\, C = C_{grid} { + }C_{f} + C_{bt} + C_{rm}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ57.gif"/></alternatives></disp-formula><disp-formula id="Equ58"><label>77</label><alternatives><mml:math display="block" id="Equ58_Math"><mml:mrow><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$COP_{ac} \cdot H_{ac}^{t} + COP_{ec} \cdot P_{ec}^{t} = Q_{c}^{t}+\lambda_{c}^{t} \varGamma_{c}^{t} + \pi_{c1}^{t + } + \pi_{c1}^{t - }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ58.gif"/></alternatives></disp-formula><disp-formula id="Equ59"><label>78</label><alternatives><mml:math display="block" id="Equ59_Math"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{re}^{t} + H_{b}^{t} - H_{ac}^{t} - H_{tst,dis}^{t} + H_{tst,chr}^{t} = (H_{h}^{t}+\lambda_{h}^{t} \varGamma_{h}^{t} + \pi_{h1}^{t + } + \pi_{h1}^{t - } )/\eta_{he}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ59.gif"/></alternatives></disp-formula><disp-formula id="Equ60"><label>79</label><alternatives><mml:math display="block" id="Equ60_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">Γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{mt}^{t} + P_{grid}^{t} + P_{bt,chr}^{t} + P_{ec}^{t} - P_{excess}^{t} - P_{bt,dis}^{t} = P_{l,u}^{t} - P_{pv,u}^{t} \hfill \\ \begin{array}{*{20}l} {\begin{array}{*{20}l} {} \hfill \\ \end{array} } \hfill \\ \end{array} \begin{array}{*{20}l} {} \hfill \\ \end{array} = P_{l}^{t} - P_{pv}^{t} + \lambda_{nl}^{t} \varGamma_{nl}^{t} + \pi_{l1}^{t + } + \pi_{l1}^{t - } + \pi_{pv2}^{t + } + \pi_{pv2}^{t - } \hfill \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ60.gif"/></alternatives></disp-formula>along with (<xref rid="Equ1" ref-type="disp-formula">1</xref>)–(<xref rid="Equ20" ref-type="disp-formula">20</xref>), (23), (60)–(62), and (66)–(68), (73)–(75).</p></sec></sec><sec id="Sec6"><title>Case study</title><p id="Par43">To verify the performance of the proposed algorithm, a CCHP building in Shanghai, China, was used in a case study. The building has twelve floors with a total square footage of 6000 m<sup>2</sup> and an average floor height of 3.8 m. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the hourly PV output and the cooling, heating, and power load for representative days during the summer.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Hourly PV power, and cooling, heating, and power load of the building</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig3_HTML.gif" id="MO66"/></fig></p><p id="Par44">The CCHP system consists of a photovoltaic system (80 kW), a battery (200 kWh), a gas micro turbine (200 kW), a boiler (258 kW), an electric chiller (100 kW), an absorption chiller (200 kW), a heat exchanger (200 kW), and a thermal storage tank (150 kWh), as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Table <xref rid="Tab1" ref-type="table">1</xref> is the peak-valley price of the double system electricity price in summer and selling prices at different times of the day [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. The fuel we chose here is a widely used fuel, which is natural gas, and its price is 0.4561 $/m<sup>3</sup>. Table <xref rid="Tab2" ref-type="table">2</xref> lists the remaining parameters used in this study as referenced by [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Time-of-use price</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Period</p></th><th align="left"><p>Time</p></th><th align="left"><p>Purchase price ($/kWh)</p></th><th align="left"><p>Sell price ($/kWh)</p></th></tr></thead><tbody><tr><td align="left" rowspan="3"><p>Peak load period</p></td><td align="left"><p>8:00–10:59</p></td><td char="." align="char" rowspan="3"><p>0.1974</p></td><td char="." align="char" rowspan="3"><p>0.099</p></td></tr><tr><td align="left"><p>13:00–14:59</p></td></tr><tr><td align="left"><p>18:00–20:59</p></td></tr><tr><td align="left" rowspan="4"><p>Flat load period</p></td><td align="left"><p>6:00–7:59</p></td><td char="." align="char" rowspan="4"><p>0.123</p></td><td char="." align="char" rowspan="4"><p>0.099</p></td></tr><tr><td align="left"><p>11:00–12:59</p></td></tr><tr><td align="left"><p>15:00–17:59</p></td></tr><tr><td align="left"><p>21:00–21:59</p></td></tr><tr><td align="left"><p>Off-peak load period</p></td><td align="left"><p>22:00–5:59</p></td><td char="." align="char"><p>0.0585</p></td><td char="." align="char"><p>0.099</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Parameters values</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameters</p></th><th align="left"><p>Value</p></th><th align="left"><p>Parameters</p></th><th align="left"><p>Value</p></th></tr></thead><tbody><tr><td align="left"><p><italic>α</italic>, <italic>β</italic></p></td><td align="left"><p>2.67, 11.43</p></td><td align="left"><p><italic>K</italic><sub><italic>om,pv</italic></sub></p></td><td align="left"><p>0.00205 $/kWh</p></td></tr><tr><td align="left"><p><italic>η</italic><sub><italic>b</italic></sub></p></td><td align="left"><p>0.73</p></td><td align="left"><p><italic>K</italic><sub><italic>om,bt</italic></sub></p></td><td align="left"><p>0.00106 $/kWh</p></td></tr><tr><td align="left"><p><italic>η</italic><sub><italic>hr</italic></sub></p></td><td align="left"><p>0.75</p></td><td align="left"><p><italic>K</italic><sub><italic>om,tst</italic></sub></p></td><td align="left"><p>0.0031 $/kWh</p></td></tr><tr><td align="left"><p><italic>η</italic><sub><italic>he</italic></sub></p></td><td align="left"><p>0.9</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>30 kW</p></td></tr><tr><td align="left"><p><italic>COP</italic><sub><italic>ec</italic></sub></p></td><td align="left"><p>4</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>200 kW</p></td></tr><tr><td align="left"><p><italic>COP</italic><sub><italic>ac</italic></sub></p></td><td align="left"><p>0.9</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>b</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p><italic>η</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>chr</italic></sup></p></td><td align="left"><p>0.95</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>b</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>258 kW</p></td></tr><tr><td align="left"><p><italic>η</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>dis</italic></sup></p></td><td align="left"><p>0.95</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>grid</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p><italic>σ</italic><sub><italic>bt</italic></sub></p></td><td align="left"><p>0.02</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>grid</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>200 kW</p></td></tr><tr><td align="left"><p><italic>η</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack"><italic>chr</italic></sup></p></td><td align="left"><p>0.9</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>170 kW</p></td></tr><tr><td align="left"><p><italic>η</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack"><italic>dis</italic></sup></p></td><td align="left"><p>0.9</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>−250 kW</p></td></tr><tr><td align="left"><p><italic>σ</italic><sub><italic>tst</italic></sub></p></td><td align="left"><p>0.1</p></td><td align="left"><p><italic>W</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>100 kWh</p></td></tr><tr><td align="left"><p><italic>R</italic><sub><italic>ng</italic></sub></p></td><td align="left"><p>0.4561 $/m<sup>3</sup></p></td><td align="left"><p><italic>W</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>500 kWh</p></td></tr><tr><td align="left"><p><italic>H</italic><sub><italic>ng</italic></sub></p></td><td align="left"><p>9.78 kWh/m<sup>3</sup></p></td><td align="left"><p><italic>H</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>−200 kW</p></td></tr><tr><td align="left"><p><italic>K</italic><sub><italic>om,mt</italic></sub></p></td><td align="left"><p>0.026 $/kWh</p></td><td align="left"><p><italic>H</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>200 kW</p></td></tr><tr><td align="left"><p><italic>K</italic><sub><italic>om,b</italic></sub></p></td><td align="left"><p>0.0027 $/kWh</p></td><td align="left"><p><italic>W</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack">min</sup></p></td><td align="left"><p>0 kW</p></td></tr><tr><td align="left"><p><italic>K</italic><sub><italic>om,he</italic></sub></p></td><td align="left"><p>0.001 $/kWh</p></td><td align="left"><p><italic>W</italic><sub arrange="stack"><italic>tst</italic></sub><sup arrange="stack">max</sup></p></td><td align="left"><p>500 kW</p></td></tr><tr><td align="left"><p><italic>K</italic><sub><italic>om,ac</italic></sub></p></td><td align="left"><p>0.0024 $/kWh</p></td><td align="left"><p><italic>R</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>t</italic></sup></p></td><td align="left"><p>8.05 $</p></td></tr><tr><td align="left"><p><italic>K</italic><sub><italic>om,ec</italic></sub></p></td><td align="left"><p>0.0016 $/kWh</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>up</italic></sup></p></td><td align="left"><p>60 kWh</p></td></tr><tr><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>up</italic></sup>, <italic>P</italic><sub arrange="stack"><italic>bt</italic></sub><sup arrange="stack"><italic>down</italic></sup></p></td><td align="left"><p>40 kWh</p></td><td align="left"><p><italic>P</italic><sub arrange="stack"><italic>mt</italic></sub><sup arrange="stack"><italic>down</italic></sup></p></td><td align="left"><p>60 kWh</p></td></tr></tbody></table></table-wrap></p><p id="Par45">Based on the observation of historical data, it has been shown that hourly PV power and cooling, heating, and power load follow a normal distribution with a mean value <italic>μ</italic> and standard deviation <italic>σ</italic> during for representative days in summer,as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="Tab11" ref-type="table">11</xref>. To estimate the uncertainties of PV power and the cooling, heating, and power load, the fluctuation of the uncertainties are defined as:<disp-formula id="Equ61"><label>80</label><alternatives><mml:math display="block" id="Equ61_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi mathvariant="italic">θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="italic">ρ</mml:mi></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta_{i,t} = \frac{{\sigma_{i,t} }}{{\sqrt {1 - \rho } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_290_Article_Equ61.gif"/></alternatives></disp-formula>where Δ<italic>θ</italic><sub><italic>i,t</italic></sub> is the fluctuation range of the <italic>i</italic>-th uncertainty (including the PV output and the cooling, heating, and power load). The upper fluctuation of each uncertainty is expressed as Δ<italic>θ</italic><sub><italic>i,t</italic></sub> (i.e., <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ud</italic></sup> = Δ<italic>θ</italic><sub><italic>c,t</italic></sub>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ud</italic></sup> = Δ<italic>θ</italic><sub><italic>h,t</italic></sub>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ud</italic></sup> = Δ<italic>θ</italic><sub><italic>l,t</italic></sub> and <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ud</italic></sup> = Δ<italic>θ</italic><sub><italic>pv,t</italic></sub>), whereas the lower fluctuation of the each uncertainty is modelled as −Δ<italic>θ</italic><sub><italic>i,t</italic></sub> (i.e., <italic>Q</italic><sub arrange="stack"><italic>c</italic></sub><sup arrange="stack"><italic>ld</italic></sup> = −Δ<italic>θ</italic><sup><italic>c,t</italic></sup>, <italic>H</italic><sub arrange="stack"><italic>h</italic></sub><sup arrange="stack"><italic>ld</italic></sup> = −Δ<italic>θ</italic><sub><italic>h,t</italic></sub>, <italic>P</italic><sub arrange="stack"><italic>l</italic></sub><sup arrange="stack"><italic>ld</italic></sup> = −Δ<italic>θ</italic><sub><italic>l,t</italic></sub>, <italic>P</italic><sub arrange="stack"><italic>pv</italic></sub><sup arrange="stack"><italic>ld</italic></sup> = −Δ<italic>θ</italic><sub><italic>pv,t</italic></sub>). The fluctuation interval can be controlled effectively by adjusting the parameter value of <italic>ρ</italic><sub><italic>it</italic></sub>.</p><p id="Par46">To demonstrate the effectiveness of the uncertain set in the robust optimization model, a Monte-Carlo simulation was adopted to sample the cooling, heating and electrical power randomly. We then determined the probability of each interval that fell into the uncertain interval and calculated the average probability of each interval.</p><p id="Par47">It can be seen from Table <xref rid="Tab3" ref-type="table">3</xref> that with the decrease of <italic>ρ</italic>, the probability that the cooling, heating and electrical power and PV output are included in the uncertain set also decreases. When the value of <italic>ρ</italic> reaches 0.9, it can be guaranteed that the probability will reach 97%; however, when the value decreases to 0.1, the probability decreases to 67%. Therefore, the conservativeness of robust optimization model can be controlled effectively by adjusting the parameter value of <italic>ρ</italic>.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Average probability of potential power falling into uncertainty set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>ρ</italic></p></th><th align="left"><p>Probability</p></th></tr></thead><tbody><tr><td align="left"><p>0.9</p></td><td char="." align="char"><p>0.973</p></td></tr><tr><td align="left"><p>0.7</p></td><td char="." align="char"><p>0.947</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>0.836</p></td></tr><tr><td align="left"><p>0.3</p></td><td char="." align="char"><p>0.743</p></td></tr><tr><td align="left"><p>0.1</p></td><td char="." align="char"><p>0.674</p></td></tr></tbody></table></table-wrap></p><p id="Par48">To analyze the effectiveness of the proposed model, five cases are studied and simulated as shown in Table <xref rid="Tab4" ref-type="table">4</xref>, in which ‘✓’ means that source is in the CCHP microgrid. The MILP robust optimization model is solved by Cplex [<xref ref-type="bibr" rid="CR40">40</xref>]. The PSO approach was applied to solve the case 5, which used nonlinear efficiency curves [<xref ref-type="bibr" rid="CR11">11</xref>].<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Five cases for energy management of CCHP microgrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>Case</p></th><th align="left" colspan="2"><p>Efficiency curves</p></th><th align="left" colspan="3"><p>Model</p></th></tr><tr><th align="left"><p>Constant</p></th><th align="left"><p>Nonlinear</p></th><th align="left"><p>Piecewise linear</p></th><th align="left"><p>Deterministic</p></th><th align="left"><p>Robust</p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td align="left"><p>✓</p></td><td align="left"/><td align="left"/><td align="left"><p>✓</p></td><td align="left"/></tr><tr><td align="left"><p>2</p></td><td align="left"><p>✓</p></td><td align="left"/><td align="left"/><td align="left"/><td align="left"><p>✓</p></td></tr><tr><td align="left"><p>3</p></td><td align="left"/><td align="left"/><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"/></tr><tr><td align="left"><p>4</p></td><td align="left"/><td align="left"/><td align="left"><p>✓</p></td><td align="left"/><td align="left"><p>✓</p></td></tr><tr><td align="left"><p>5</p></td><td align="left"/><td align="left"><p>✓</p></td><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table></table-wrap></p><sec id="Sec7"><title>Comparison of three efficiency models under deterministic optimization</title><p id="Par49">Table <xref rid="Tab5" ref-type="table">5</xref> summarizes the operating cost and computing times of the three aforementioned approaches when an optimality parameter was specified. The three methods yield similar solutions in terms of total operating cost, though Case 3 obtained a lower operating cost than Case 1 and 5 because a global optimization result was guaranteed for the MILP. Meanwhile, Case 3 achieved a more accurate system operating status than Case 1 and 5, without sacrificing computational advantage.<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Comparison three efficiency curves</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Case</p></th><th align="left"><p>Operation cost ($)</p></th><th align="left"><p>Computing time (s)</p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td char="." align="char"><p>500.07</p></td><td align="left"><p>0.87</p></td></tr><tr><td align="left"><p>3</p></td><td char="." align="char"><p>496.5</p></td><td align="left"><p>1.31</p></td></tr><tr><td align="left"><p>5</p></td><td char="." align="char"><p>498.76</p></td><td align="left"><p>138</p></td></tr></tbody></table></table-wrap></p><p id="Par50">As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, compared with Case 3, there were different MT optimization results for the CCHP microgrid in Cases 1 and 5. In Case 1, the MT provided its rated power in periods 12 to 19 but operated at rated power during periods 14 to 18 in Case 3. In all time periods, the scheduling curves of the MT were extremely similar for both Case 3 and Case 5. In Case 5, the power generated by the MT was greater than Case 3 in periods 7 to 13 and 19 to 24, which could not determine global optimization results through comparing the optimization results for both deterministic and robust cases when considering the piecewise linear efficiency curve model in detail.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Comparison of the MT power considering constant, piecewise linear and nonlinear efficiency curve model</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig4_HTML.gif" id="MO68"/></fig></p></sec><sec id="Sec8"><title>Comparison of constant efficiency model and piecewise linear efficiency curve model under robust optimization</title><p id="Par51">Table <xref rid="Tab6" ref-type="table">6</xref> provides the simulated running cost under different load and PV uncertainties, using constant and piecewise linear efficiency curves, respectively. It shows that when the fluctuation interval of the uncertainties increases, the running cost of the robust case increases.<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>Comparison of different efficiency curves under robust models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>ρ</italic></p></th><th align="left"><p>Case 2 ($)</p></th><th align="left"><p>Case 4 ($)</p></th></tr></thead><tbody><tr><td align="left"><p>0.9</p></td><td char="." align="char"><p>545.90</p></td><td char="." align="char"><p>542.94</p></td></tr><tr><td align="left"><p>0.7</p></td><td char="." align="char"><p>541.13</p></td><td char="." align="char"><p>537.48</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>530.52</p></td><td char="." align="char"><p>528.36</p></td></tr><tr><td align="left"><p>0.3</p></td><td char="." align="char"><p>525.18</p></td><td char="." align="char"><p>522.13</p></td></tr><tr><td align="left"><p>0.1</p></td><td char="." align="char"><p>513.35</p></td><td char="." align="char"><p>510.24</p></td></tr></tbody></table></table-wrap></p><p id="Par52">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the operating conditions of the MT, the exchange power with the main grid, the electric chiller power, and the gas boiler power during the entire scheduling horizon at different uncertainty levels during the summer when <italic>ρ</italic> = 0.9. When coping with the fluctuation of load and PV output, the power generated by the MT in the robust case was always greater than in the corresponding deterministic case due to the response of the MT to the uncertainty of the cooling, thermal and electrical energy requests. Meanwhile, the CCHP microgrid sold less extra power to the main grid, and coordinated the power of the electric chiller and absorption chiller. In considering the aging cost, the scheduling curves of the battery were extremely similar for both the deterministic and robust cases in all time periods.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Comparison of the deterministic and robust case for CCHP microgrid (<italic>ρ</italic> = 0.9)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig5_HTML.gif" id="MO69"/></fig></p><p id="Par53">Compared with the constant efficiency model, there were different dispatching results for the CCHP microgrid in the piecewise linear efficiency model. In Case 2, the MT provided rated power during periods 11 to 19 but operated at rated power during periods 13 to 19 in Case 4. In Cases 3 and 4, the CCHP microgrid sold almost no extra power to the main grid during periods 9 to 11; however, it sold more extra power to the main grid during these periods in Cases 1 and 2. The TST charged more heating power during periods 1 to 6 and 22 to 24, charged less heating power during periods 9 to 12 and discharged more heating power during periods 18 to 21 than in the constant efficiency model. In all time periods, the scheduling curves of the electric chiller were extremely similar for both Case 1 and Case 2, but the power of the electric chiller was greater than in the piecewise linear efficiency model during periods 11 to 18. In addition, the power of the absorption chiller provided more cooling power during periods 12 to 18 in piecewise linear efficiency model.</p><p id="Par54">To show the effectiveness of robust optimization and its applicability in a real-time environment, Monte Carlo simulation is applied to generate different realizations of load and RES generation. The size of the sample is set to be 1000. The expected intra-day operation cost of the robust optimization and the deterministic optimization can be calculated under the day-ahead schedule. The expected operation cost of two optimization models are shown in Table <xref rid="Tab7" ref-type="table">7</xref>. It can be seen from Table <xref rid="Tab7" ref-type="table">7</xref> that with the increase of <italic>ρ</italic>, compared with robust optimization, the operating cost of deterministic optimization was increasing. When <italic>ρ</italic> equals to 0.1/0.3, the expected cost of deterministic approach is almost the same with robust optimization approach, only increased by 0.18%/0.27%, respectively. When <italic>ρ</italic> equals to 0.5/0.7/0.9, expected cost of the deterministic approach is more than robust optimization approach, increased by 1.85%/2.54%/3.25%, respectively. The economy of the optimal decision could be achieved by adjusting the fluctuation interval of uncertainty set to control the conservatism of the model.<table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Expected cost of robust model and deterministic model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>ρ</italic></p></th><th align="left"><p>Case 4 ($)</p></th><th align="left"><p>Case 3 ($)</p></th><th align="left"><p>Increased (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0.1</p></td><td char="." align="char"><p>502.58</p></td><td char="." align="char"><p>503.47</p></td><td char="." align="char"><p>0.18</p></td></tr><tr><td align="left"><p>0.3</p></td><td char="." align="char"><p>510.83</p></td><td char="." align="char"><p>514.22</p></td><td char="." align="char"><p>0.27</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>517.26</p></td><td char="." align="char"><p>526.85</p></td><td char="." align="char"><p>1.85</p></td></tr><tr><td align="left"><p>0.7</p></td><td char="." align="char"><p>526.87</p></td><td char="." align="char"><p>540.24</p></td><td char="." align="char"><p>2.54</p></td></tr><tr><td align="left"><p>0.9</p></td><td char="." align="char"><p>538.46</p></td><td char="." align="char"><p>555.96</p></td><td char="." align="char"><p>3.25</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec9"><title>Influence of uncertainty budget levels on the system fluctuation (<italic>ρ</italic> = 0.9)</title><p id="Par55">Compared with no fluctuation of the cooling, thermal and net electrical load, Figs. <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig8" ref-type="fig">8</xref> shows the adjusted power of the MT and the exchange power with the main grid in different robustness budgets in controlling the uncertain ranges of cooling, thermal and net electricity load when ρ = 0.9. In Fig. <xref rid="Fig6" ref-type="fig">6</xref>, <italic>Γ</italic><sub><italic>h</italic></sub> and <italic>Γ</italic><sub><italic>nl</italic></sub> are fixed at 1 and 2, respectively, to ensure the worst-case thermal and net electrical load. <italic>Γ</italic><sub><italic>c</italic></sub> is adjusted from 0 to 1. <italic>Γ</italic><sub><italic>c</italic></sub> =0 denotes there are no cooling load fluctuation; <italic>Γ</italic><sub><italic>c</italic></sub> = 1 denotes the worst-case cooling load. Table <xref rid="Tab8" ref-type="table">8</xref> shows the change of operating cost with the increase of robustness budget <italic>Γ</italic><sub><italic>c</italic></sub>.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Effect of robustness budget in controlling the uncertain ranges of cooling load</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig6_HTML.gif" id="MO70"/></fig><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Effect of robustness budget in controlling the uncertain ranges of thermal load</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig7_HTML.gif" id="MO71"/></fig><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Effect of robustness budget in controlling the uncertain ranges of electrical load and PV</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_290_Fig8_HTML.gif" id="MO72"/></fig><table-wrap id="Tab8"><label>Table 8</label><caption xml:lang="en"><p>Operating cost with various <italic>Γ</italic><sub><italic>c</italic></sub> (<italic>Γ</italic><sub><italic>h</italic></sub> = 1, <italic>Γ</italic><sub><italic>nl</italic></sub> = 2)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>Γ</italic><sub><italic>c</italic></sub></p></th><th align="left"><p>Case 4 ($)</p></th><th align="left"><p>Increased (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0</p></td><td char="." align="char"><p>530.6</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>536.74</p></td><td align="left"><p>1.16</p></td></tr><tr><td align="left"><p>0.8</p></td><td char="." align="char"><p>540.45</p></td><td align="left"><p>1.86</p></td></tr><tr><td align="left"><p>1</p></td><td char="." align="char"><p>542.94</p></td><td align="left"><p>2.33</p></td></tr></tbody></table></table-wrap></p><p id="Par56">In Fig. <xref rid="Fig7" ref-type="fig">7</xref>, <italic>Γ</italic><sub><italic>c</italic></sub> and <italic>Γ</italic><sub><italic>nl</italic></sub> are fixed at 1 and 2, respectively, to ensure the worst-case cooling and net electricity load; the uncertainty set of the thermal load is enlarged by increasing the robustness <italic>Γ</italic><sub><italic>h</italic></sub> from 0 to 1. Table <xref rid="Tab9" ref-type="table">9</xref> shows the change of operating cost as the robustness budget <italic>Γ</italic><sub><italic>h</italic></sub> increase.<table-wrap id="Tab9"><label>Table 9</label><caption xml:lang="en"><p>Operating cost with various <italic>Γ</italic><sub><italic>h</italic></sub> (<italic>Γ</italic><sub><italic>c</italic></sub> = 1, <italic>Γ</italic><sub><italic>nl</italic></sub> = 2)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>Γ</italic><sub><italic>h</italic></sub></p></th><th align="left"><p>Case 4 ($)</p></th><th align="left"><p>Increased (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0</p></td><td char="." align="char"><p>539.3</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>541.11</p></td><td align="left"><p>0.03</p></td></tr><tr><td align="left"><p>0.8</p></td><td char="." align="char"><p>542.21</p></td><td align="left"><p>0.05</p></td></tr><tr><td align="left"><p>1</p></td><td char="." align="char"><p>542.94</p></td><td align="left"><p>0.07</p></td></tr></tbody></table></table-wrap></p><p id="Par57">In Fig. <xref rid="Fig8" ref-type="fig">8</xref>, <italic>Γ</italic><sub><italic>c</italic></sub> and <italic>Γ</italic><sub><italic>h</italic></sub> are fixed at 1 and 1, respectively, to ensure the worst-case cooling and thermal load; the uncertainty set of the net electrical load are enlarged by increasing the robustness <italic>Γ</italic><sub><italic>nl</italic></sub> from 0 to 2. Table <xref rid="Tab10" ref-type="table">10</xref> shows the change of operating cost as the robustness budget <italic>Γ</italic><sub><italic>nl</italic></sub> increase.<table-wrap id="Tab10"><label>Table 10</label><caption xml:lang="en"><p>Operating cost with various <italic>Γ</italic><sub><italic>nl</italic></sub> (<italic>Γ</italic><sub><italic>c</italic></sub> = 1, <italic>Γ</italic><sub><italic>h</italic></sub> = 1)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><italic>Γ</italic><sub><italic>nl</italic></sub></p></th><th align="left"><p>Case 4 ($)</p></th><th align="left"><p>Increased (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0</p></td><td char="." align="char"><p>512.49</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>0.5</p></td><td char="." align="char"><p>523.55</p></td><td align="left"><p>2.16</p></td></tr><tr><td align="left"><p>0.8</p></td><td char="." align="char"><p>530.22</p></td><td align="left"><p>3.46</p></td></tr><tr><td align="left"><p>1</p></td><td char="." align="char"><p>534.65</p></td><td align="left"><p>4.52</p></td></tr><tr><td align="left"><p>1.3</p></td><td char="." align="char"><p>537.14</p></td><td align="left"><p>4.81</p></td></tr><tr><td align="left"><p>1.6</p></td><td char="." align="char"><p>539.62</p></td><td align="left"><p>5.29</p></td></tr><tr><td align="left"><p>1.8</p></td><td char="." align="char"><p>541.28</p></td><td align="left"><p>5.62</p></td></tr><tr><td align="left"><p>2</p></td><td char="." align="char"><p>542.94</p></td><td align="left"><p>5.94</p></td></tr></tbody></table></table-wrap></p><p id="Par58">Tables <xref rid="Tab8" ref-type="table">8</xref>, <xref rid="Tab9" ref-type="table">9</xref> and <xref rid="Tab10" ref-type="table">10</xref> show that with the increase of the robustness budget <italic>Γ</italic> (<italic>Γ</italic><sub><italic>c</italic></sub>, <italic>Γ</italic><sub><italic>h</italic></sub> and <italic>Γ</italic><sub><italic>nl</italic></sub>), the operating cost of the robust case increases. When <italic>Γ</italic><sub><italic>c</italic></sub> is adjusted from 0 to 1 (<italic>Γ</italic><sub><italic>h</italic></sub> = 1 and <italic>Γ</italic><sub><italic>nl</italic></sub> = 2), the operating cost increases by 2.33%. When <italic>Γ</italic><sub><italic>h</italic></sub> is adjusted from 0 to 1 (<italic>Γ</italic><sub><italic>c</italic></sub> = 1 and <italic>Γ</italic><sub><italic>nl</italic></sub> = 2), the operating cost increases by 0.07%. When <italic>Γ</italic><sub><italic>nl</italic></sub> is adjusted from 0 to 2 (<italic>Γ</italic><sub><italic>c</italic></sub> = 1 and <italic>Γ</italic><sub><italic>h</italic></sub> = 1), the operating cost increases by 5.94%. The differences in the operating cost show that the fluctuation of net electrical load has the more significantly effect on the operating cost of the CCHP microgrid than the fluctuation of the cooling or thermal.</p><p id="Par59">Figures <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig8" ref-type="fig">8</xref> show that with the increase of the robustness budget <italic>Γ</italic> (<italic>Γ</italic><sub><italic>c</italic></sub>, <italic>Γ</italic><sub><italic>h</italic></sub> and <italic>Γ</italic><sub><italic>nl</italic></sub>), there are different dispatching results for the CCHP microgrid under different uncertainty budget levels of different energy (cooling, thermal and electrical). The fluctuation of net electrical load have the greater effect on the dispatching results of the CCHP microgrid than the fluctuation of the cooling or thermal.</p><p id="Par60">In general, these dispatching results demonstrate that uncertainties in the load and PV outputs are mitigated by the MT, the exchange power with the main grid, and other components.The thermal fluctuation during the summer subtly change the dispatching results, which reduce the impact on the superior power grid. When the fluctuation in cooling load, electrical load and PV become increase, the exchange power with the main grid will change with the system electric power fluctuation, which have impacts on the superior grid. These fluctuation can be suppressed not only by adjusting the MT but also coordinating other equipment.</p></sec></sec><sec id="Sec10" sec-type="conclusion"><title>Conclusion</title><p id="Par61">This paper presented a robust optimization method that considered piecewise linear thermal and electrical efficiency curves to hedge the uncertainties of the cooling, thermal, and electrical load and solar power generation for the energy management of a CCHP microgrid. A worst-case security-constrained economic optimization model was developed and a strong duality theory was used to transform the problem into a MILP formulation. The robustness could also be adjusted to control the conservativeness of the proposed model.</p><p id="Par62">By characterizing a piecewise linear thermal and electrical efficiency curve model instead of constant efficiencies or non-fixed efficiency models, the operating status of the system could be reflected exactly without sacrificing problem linearity.</p><p id="Par63">The simulation results showed that fluctuation of the system have less effect on the dispatching results of the battery when considering the aging cost. Meanwhile, the robust optimization approach performs better than the deterministic optimization mode, and decreases the expected operation cost. Furthermore, compared with fluctuation of the cooling and thermal load, fluctuation of net electrical load has a greater influence on the operating cost and conditions of the system.</p><p id="Par64">The demand response can mitigate the variability of renewable resources and partial user demand by allowing user demand to be controllable. Thus, future research should be focus on combining the robust optimization method with demand response to address the uncertainties of the CCHP microgrid.</p></sec></body><back><ack><title>Acknowledgments</title><p>This work was supported by the National Science Foundation of China (No. 51277027), the National Science and Technology Support Program of China (No. 2015BAA01B01) and the State Grid Corporation of China (SGTYHT/14-JS-188).</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>H</given-names></name><name><surname>Mago</surname><given-names>PJ</given-names></name><name><surname>Luck</surname><given-names>R</given-names></name><etal/></person-group><article-title xml:lang="en">Evaluation of CCHP systems performance based on operational cost, primary energy consumption, and carbon dioxide emission by utilizing an optimal operation scheme</article-title><source>Appl Energy</source><year>2009</year><volume>86</volume><issue>12</issue><fpage>2540</fpage><lpage>2549</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2009.04.012</pub-id></mixed-citation></ref><ref id="CR2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Fang</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Combined cooling, heating and power systems: a survey</article-title><source>Renew Sustain Energy Rev</source><year>2014</year><volume>35</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2014.03.054</pub-id></mixed-citation></ref><ref id="CR3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Bo</surname><given-names>R</given-names></name><etal/></person-group><article-title xml:lang="en">Modeling, planning and optimal energy management of combined cooling, heating and power microgrid: a review</article-title><source>Int J Electr Power Energy Syst</source><year>2014</year><volume>54</volume><issue>1</issue><fpage>26</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1016/j.ijepes.2013.06.028</pub-id></mixed-citation></ref><ref id="CR4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arcuri</surname><given-names>P</given-names></name><name><surname>Florio</surname><given-names>G</given-names></name><name><surname>Fragiacomo</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">A mixed integer programming model for optimal design of trigeneration in a hospital complex</article-title><source>Energy</source><year>2007</year><volume>32</volume><issue>8</issue><fpage>1430</fpage><lpage>1447</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2006.10.023</pub-id></mixed-citation></ref><ref id="CR5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ge</surname><given-names>YT</given-names></name><name><surname>Tassou</surname><given-names>SA</given-names></name><name><surname>Chaer</surname><given-names>I</given-names></name><etal/></person-group><article-title xml:lang="en">Performance evaluation of a tri-generation system with simulation and experiment</article-title><source>Appl Energy</source><year>2009</year><volume>86</volume><issue>11</issue><fpage>2317</fpage><lpage>2326</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2009.03.018</pub-id></mixed-citation></ref><ref id="CR6"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Cai</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">A two-stage optimal planning and design method for combined cooling, heat and power microgrid system</article-title><source>Energy Convers Manag</source><year>2013</year><volume>74</volume><issue>10</issue><fpage>433</fpage><lpage>445</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2013.06.051</pub-id></mixed-citation></ref><ref id="CR7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>P</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal sizing, operating strategy and operational experience of a stand-alone microgrid on Dongfushan Island</article-title><source>Appl Energy</source><year>2014</year><volume>113</volume><issue>2</issue><fpage>1656</fpage><lpage>1666</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2013.09.015</pub-id></mixed-citation></ref><ref id="CR8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mago</surname><given-names>PJ</given-names></name><name><surname>Chamra</surname><given-names>LM</given-names></name><name><surname>Ramsay</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Micro-combined cooling, heating and power systems hybrid electric-thermal load following operation</article-title><source>Appl Therm Eng</source><year>2010</year><volume>30</volume><issue>8–9</issue><fpage>800</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1016/j.applthermaleng.2009.12.008</pub-id></mixed-citation></ref><ref id="CR9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><etal/></person-group><article-title xml:lang="en">An online optimal dispatch schedule for CCHP microgrids based on model predictive control</article-title><source>IEEE Trans Smart Grid</source><year>2016</year></mixed-citation></ref><ref id="CR10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gang</surname><given-names>H</given-names></name><name><surname>You</surname><given-names>S</given-names></name><name><surname>Ye</surname><given-names>T</given-names></name><etal/></person-group><article-title xml:lang="en">Analysis of combined cooling, heating, and power systems under a compromised electric–thermal load strategy</article-title><source>Energy Build</source><year>2014</year><volume>84</volume><fpage>586</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1016/j.enbuild.2014.09.006</pub-id></mixed-citation></ref><ref id="CR11"><label>[11]</label><mixed-citation publication-type="other">Wu Z, Gu W, Wang R et al (2011) Economic optimal schedule of CHP microgrid system using chance constrained programming and particle swarm optimization. In: Proceedings of the 2011 IEEE power and energy society general meeting, vol 35(8), San Diego CA, 24–29 July 2011, pp 1–11</mixed-citation></ref><ref id="CR12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bischi</surname><given-names>A</given-names></name><name><surname>Taccari</surname><given-names>L</given-names></name><name><surname>Martelli</surname><given-names>E</given-names></name><etal/></person-group><article-title xml:lang="en">A detailed MILP optimization model for combined cooling, heat and power system operation planning</article-title><source>Energy</source><year>2014</year><volume>74</volume><issue>5</issue><fpage>12</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2014.02.042</pub-id></mixed-citation></ref><ref id="CR13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milan</surname><given-names>C</given-names></name><name><surname>Stadler</surname><given-names>M</given-names></name><name><surname>Cardoso</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Modeling of non-linear CHP efficiency curves in distributed energy systems</article-title><source>Appl Energy</source><year>2015</year><volume>148</volume><fpage>334</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.03.053</pub-id></mixed-citation></ref><ref id="CR14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Yin</surname><given-names>W</given-names></name><name><surname>Abdollahi</surname><given-names>E</given-names></name><etal/></person-group><article-title xml:lang="en">Modelling and optimization of CHP based district heating system with renewable energy production and energy storage</article-title><source>Appl Energy</source><year>2015</year><volume>159</volume><issue>1</issue><fpage>401</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.09.020</pub-id></mixed-citation></ref><ref id="CR15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Singh</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Stochastic combined heat and power dispatch based on multi-objective particle swarm optimization</article-title><source>Int J Electr Power Energy Syst</source><year>2008</year><volume>30</volume><issue>3</issue><fpage>226</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1016/j.ijepes.2007.08.002</pub-id></mixed-citation></ref><ref id="CR16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piperagkas</surname><given-names>GS</given-names></name><name><surname>Anastasiadis</surname><given-names>AG</given-names></name><name><surname>Hatziargyriou</surname><given-names>ND</given-names></name></person-group><article-title xml:lang="en">Stochastic PSO-based heat and power dispatch under environmental constraints incorporating CHP and wind power units</article-title><source>Electr Power Syst Res</source><year>2011</year><volume>81</volume><issue>1</issue><fpage>209</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1016/j.epsr.2010.08.009</pub-id></mixed-citation></ref><ref id="CR17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Optimization of a combined heat and power system with wind turbines</article-title><source>Int J Electr Power Energy Syst</source><year>2012</year><volume>43</volume><issue>1</issue><fpage>1421</fpage><lpage>1426</lpage><pub-id pub-id-type="doi">10.1016/j.ijepes.2012.07.022</pub-id></mixed-citation></ref><ref id="CR18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marquez</surname><given-names>AC</given-names></name><name><surname>Heguedas</surname><given-names>AS</given-names></name><name><surname>Iung</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Monte Carlo-based assessment of system availability. A case study for cogeneration plants</article-title><source>Reliab Eng Syst Saf</source><year>2005</year><volume>88</volume><issue>3</issue><fpage>273</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/j.ress.2004.07.018</pub-id></mixed-citation></ref><ref id="CR19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">A hybrid method for optimal scheduling of short-term electric power generation of cascaded hydroelectric plants based on particle swarm optimization and chance-constrained programming</article-title><source>IEEE Trans Power Syst</source><year>2008</year><volume>23</volume><issue>4</issue><fpage>1570</fpage><lpage>1579</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2008.2004748</pub-id></mixed-citation></ref><ref id="CR20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Wen</surname><given-names>F</given-names></name><name><surname>Ledwich</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Optimal siting and sizing of distributed generators in distribution systems considering uncertainties</article-title><source>IEEE Trans Power Deliv</source><year>2011</year><volume>26</volume><issue>4</issue><fpage>2541</fpage><lpage>2551</lpage><pub-id pub-id-type="doi">10.1109/TPWRD.2011.2165972</pub-id></mixed-citation></ref><ref id="CR21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moradi</surname><given-names>MH</given-names></name><name><surname>Hajinazari</surname><given-names>M</given-names></name><name><surname>Jamasb</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">An energy management system (EMS) strategy for combined heat and power (CHP) systems based on a hybrid optimization method employing fuzzy programming</article-title><source>Energy</source><year>2013</year><volume>49</volume><issue>1</issue><fpage>86</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2012.10.005</pub-id></mixed-citation></ref><ref id="CR22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A</given-names></name><name><surname>Luck</surname><given-names>R</given-names></name><name><surname>Mago</surname><given-names>PJ</given-names></name></person-group><article-title xml:lang="en">Analysis of a combined cooling, heating, and power system model under different operating strategies with input and model data uncertainty</article-title><source>Energy Build</source><year>2010</year><volume>42</volume><issue>11</issue><fpage>2231</fpage><lpage>2240</lpage><pub-id pub-id-type="doi">10.1016/j.enbuild.2010.07.019</pub-id></mixed-citation></ref><ref id="CR23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valipour</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Optimization of neural networks for precipitation analysis in a humid region to detect drought and wet year alarms</article-title><source>Meteorol Appl</source><year>2015</year><volume>23</volume><issue>1</issue><fpage>91</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1002/met.1533</pub-id></mixed-citation></ref><ref id="CR24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khasraghi</surname><given-names>MM</given-names></name><name><surname>Sefidkouhi</surname><given-names>MA</given-names></name><name><surname>Valipour</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Simulation of open- and closed-end border irrigation systems using SIRMOD</article-title><source>Arch Agron Soil Sci</source><year>2015</year><volume>61</volume><issue>7</issue><fpage>929</fpage><lpage>941</lpage><pub-id pub-id-type="doi">10.1080/03650340.2014.981163</pub-id></mixed-citation></ref><ref id="CR25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Tal</surname><given-names>A</given-names></name><name><surname>Nemirovski</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Robust solutions of linear programming problems contaminated with uncertain data</article-title><source>Math Program</source><year>2000</year><volume>88</volume><issue>3</issue><fpage>411</fpage><lpage>421</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1782149</pub-id><pub-id pub-id-type="doi">10.1007/PL00011380</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0964.90025</pub-id></mixed-citation></ref><ref id="CR26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Ding</surname><given-names>R</given-names></name><name><surname>Floudas</surname><given-names>CA</given-names></name></person-group><article-title xml:lang="en">A comparative theoretical and computational study on robust counterpart optimization: I. Robust linear optimization and robust mixed integer linear optimization</article-title><source>Ind Eng Chem Res</source><year>2011</year><volume>50</volume><issue>18</issue><fpage>10567</fpage><lpage>10603</lpage><pub-id pub-id-type="doi">10.1021/ie200150p</pub-id></mixed-citation></ref><ref id="CR27"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Robust unit commitment with wind power and pumped storage hydro</article-title><source>IEEE Trans Power Syst</source><year>2012</year><volume>27</volume><issue>2</issue><fpage>800</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2011.2169817</pub-id></mixed-citation></ref><ref id="CR28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimiragha</surname><given-names>AH</given-names></name><name><surname>Canizares</surname><given-names>CA</given-names></name><name><surname>Fowler</surname><given-names>MW</given-names></name><etal/></person-group><article-title xml:lang="en">A robust optimization approach for planning transition to plug-in hybrid electric vehicles</article-title><source>IEEE Trans Power Syst</source><year>2011</year><volume>26</volume><issue>4</issue><fpage>2264</fpage><lpage>2274</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2011.2108322</pub-id></mixed-citation></ref><ref id="CR29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Gatsis</surname><given-names>N</given-names></name><name><surname>Giannakis</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Robust energy management for microgrids with high-penetration renewables</article-title><source>IEEE Trans Sustain Energy</source><year>2013</year><volume>4</volume><issue>4</issue><fpage>944</fpage><lpage>953</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2013.2255135</pub-id></mixed-citation></ref><ref id="CR30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>L</given-names></name><name><surname>Niu</surname><given-names>DX</given-names></name><name><surname>Huang</surname><given-names>GH</given-names></name></person-group><article-title xml:lang="en">An inexact two-stage stochastic robust programming for residential micro-grid management-based on random demand</article-title><source>Energy</source><year>2014</year><volume>67</volume><fpage>186</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2014.01.099</pub-id></mixed-citation></ref><ref id="CR31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rezvan</surname><given-names>AT</given-names></name><name><surname>Gharneh</surname><given-names>NS</given-names></name><name><surname>Gharehpetian</surname><given-names>GB</given-names></name></person-group><article-title xml:lang="en">Robust optimization of distributed generation investment in buildings</article-title><source>Energy</source><year>2014</year><volume>67</volume><fpage>186</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2014.01.099</pub-id></mixed-citation></ref><ref id="CR32"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akbari</surname><given-names>K</given-names></name><name><surname>Nasiri</surname><given-names>MM</given-names></name><name><surname>Jolai</surname><given-names>F</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal investment and unit sizing of distributed energy systems under uncertainty: a robust optimization approach</article-title><source>Energy Build</source><year>2014</year><volume>85</volume><issue>85</issue><fpage>275</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/j.enbuild.2014.09.009</pub-id></mixed-citation></ref><ref id="CR33"><label>[33]</label><mixed-citation publication-type="other">Zugno M, Morales JM, Madsen H (2014) Robust management of combined heat and power systems via linear decision rules. In: 2014 International IEEE energy conference (ENERGYCON), Cavta, Italian, 13–16 May 2014, pp 479–486</mixed-citation></ref><ref id="CR34"><label>[34]</label><mixed-citation publication-type="other">Liu P, Fu Y (2013) Optimal operation of energy-efficiency building: a robust optimization approach. In: Proceedings of the 2013 IEEE power and energy society general meeting, Vancouver, BC 21–25 July 2013, pp 1–5</mixed-citation></ref><ref id="CR35"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Xiao</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">A robust optimization approach for energy generation scheduling in microgrids</article-title><source>Energy Convers Manag</source><year>2015</year><volume>106</volume><issue>5</issue><fpage>597</fpage><lpage>607</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3410415</pub-id><pub-id pub-id-type="doi">10.1016/j.enconman.2015.09.066</pub-id></mixed-citation></ref><ref id="CR36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Jiao</surname><given-names>B</given-names></name><name><surname>Guo</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Robust scheduling of building energy system under uncertainty</article-title><source>Appl Energy</source><year>2016</year><volume>167</volume><fpage>366</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.09.070</pub-id></mixed-citation></ref><ref id="CR37"><label>[37]</label><mixed-citation publication-type="other">Shanghai Municipal Development &amp; Reform Commission <ext-link xlink:href="http://www.shdrc.gov.cn/gk/xxgkml/zcwj/jgl/20805.htm" ext-link-type="uri">http://www.shdrc.gov.cn/gk/xxgkml/zcwj/jgl/20805.htm</ext-link>. Accessed 6 Jan 2016</mixed-citation></ref><ref id="CR38"><label>[38]</label><mixed-citation publication-type="other">Shanghai Municipal Development &amp; Reform Commission <ext-link xlink:href="http://www.shdrc.gov.cn/xxgk/cxxxgk/15073.htm" ext-link-type="uri">http://www.shdrc.gov.cn/xxgk/cxxxgk/15073.htm</ext-link>. Accessed 4 Dec 2015</mixed-citation></ref><ref id="CR39"><label>[39]</label><mixed-citation publication-type="other">Miao Y, Jiang Q, Cao Y (2012) Battery switch station modeling and its economic evaluation in microgrid. In: Proceedings of the 2012 IEEE power and energy society general meeting, San Diego CA, 22–26 July 2012, pp 1–11</mixed-citation></ref><ref id="CR40"><label>[40]</label><mixed-citation publication-type="other">IBM ILOG CPLEX V12.1 User’s manual for CPLEX. <ext-link xlink:href="ftp://public.dhe.ibm.com/software/websphere/ilog/docs/optimizati" ext-link-type="uri">ftp://public.dhe.ibm.com/software/websphere/ilog/docs/optimizati</ext-link></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1"><sec id="Sec11"><title>Appendix A</title><p id="Par65">See Table <xref rid="Tab11" ref-type="table">A1</xref>.<table-wrap id="Tab11"><label>Table A1</label><caption xml:lang="en"><p>Average probability of potential power falling into uncertainty set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Time</p></th><th align="left"><p>Cooling (<italic>σ</italic><sub><italic>c</italic></sub>)</p></th><th align="left"><p>Heat (<italic>σ</italic><sub><italic>h</italic></sub>)</p></th><th align="left"><p>Power (<italic>σ</italic><sub><italic>l</italic></sub>)</p></th><th align="left"><p>PV (<italic>σ</italic><sub><italic>pv</italic></sub>)</p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td char="." align="char"><p>2.33</p></td><td char="." align="char"><p>0.59</p></td><td char="." align="char"><p>2.13</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>2</p></td><td char="." align="char"><p>2.21</p></td><td char="." align="char"><p>0.28</p></td><td char="." align="char"><p>2.01</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>3</p></td><td char="." align="char"><p>1.98</p></td><td char="." align="char"><p>0.11</p></td><td char="." align="char"><p>1.98</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>4</p></td><td char="." align="char"><p>1.85</p></td><td char="." align="char"><p>0.32</p></td><td char="." align="char"><p>2.09</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>5</p></td><td char="." align="char"><p>1.79</p></td><td char="." align="char"><p>0.96</p></td><td char="." align="char"><p>2.13</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>6</p></td><td char="." align="char"><p>2.38</p></td><td char="." align="char"><p>1.97</p></td><td char="." align="char"><p>2.76</p></td><td align="left"><p>0.10</p></td></tr><tr><td align="left"><p>7</p></td><td char="." align="char"><p>2.57</p></td><td char="." align="char"><p>1.87</p></td><td char="." align="char"><p>3.28</p></td><td align="left"><p>0.67</p></td></tr><tr><td align="left"><p>8</p></td><td char="." align="char"><p>3.56</p></td><td char="." align="char"><p>1.63</p></td><td char="." align="char"><p>3.63</p></td><td align="left"><p>1.11</p></td></tr><tr><td align="left"><p>9</p></td><td char="." align="char"><p>4.53</p></td><td char="." align="char"><p>1.54</p></td><td char="." align="char"><p>4.03</p></td><td align="left"><p>1.72</p></td></tr><tr><td align="left"><p>10</p></td><td char="." align="char"><p>4.67</p></td><td char="." align="char"><p>1.91</p></td><td char="." align="char"><p>4.36</p></td><td align="left"><p>2.23</p></td></tr><tr><td align="left"><p>11</p></td><td char="." align="char"><p>5.95</p></td><td char="." align="char"><p>1.27</p></td><td char="." align="char"><p>4.55</p></td><td align="left"><p>2.57</p></td></tr><tr><td align="left"><p>12</p></td><td char="." align="char"><p>9.13</p></td><td char="." align="char"><p>1.52</p></td><td char="." align="char"><p>4.59</p></td><td align="left"><p>2.69</p></td></tr><tr><td align="left"><p>13</p></td><td char="." align="char"><p>9.27</p></td><td char="." align="char"><p>1.70</p></td><td char="." align="char"><p>4.61</p></td><td align="left"><p>3.01</p></td></tr><tr><td align="left"><p>14</p></td><td char="." align="char"><p>10.46</p></td><td char="." align="char"><p>1.58</p></td><td char="." align="char"><p>4.60</p></td><td align="left"><p>2.89</p></td></tr><tr><td align="left"><p>15</p></td><td char="." align="char"><p>10.01</p></td><td char="." align="char"><p>1.61</p></td><td char="." align="char"><p>4.70</p></td><td align="left"><p>1.89</p></td></tr><tr><td align="left"><p>16</p></td><td char="." align="char"><p>9.81</p></td><td char="." align="char"><p>1.79</p></td><td char="." align="char"><p>4.65</p></td><td align="left"><p>1.72</p></td></tr><tr><td align="left"><p>17</p></td><td char="." align="char"><p>9.23</p></td><td char="." align="char"><p>1.95</p></td><td char="." align="char"><p>4.83</p></td><td align="left"><p>1.12</p></td></tr><tr><td align="left"><p>18</p></td><td char="." align="char"><p>8.92</p></td><td char="." align="char"><p>2.30</p></td><td char="." align="char"><p>4.76</p></td><td align="left"><p>0.82</p></td></tr><tr><td align="left"><p>19</p></td><td char="." align="char"><p>9.02</p></td><td char="." align="char"><p>3.04</p></td><td char="." align="char"><p>4.66</p></td><td align="left"><p>0.27</p></td></tr><tr><td align="left"><p>20</p></td><td char="." align="char"><p>8.67</p></td><td char="." align="char"><p>3.63</p></td><td char="." align="char"><p>4.24</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>21</p></td><td char="." align="char"><p>5.68</p></td><td char="." align="char"><p>3.77</p></td><td char="." align="char"><p>3.83</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>22</p></td><td char="." align="char"><p>3.06</p></td><td char="." align="char"><p>3.20</p></td><td char="." align="char"><p>3.86</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>23</p></td><td char="." align="char"><p>2.78</p></td><td char="." align="char"><p>2.04</p></td><td char="." align="char"><p>2.61</p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p>24</p></td><td char="." align="char"><p>3.02</p></td><td char="." align="char"><p>0.90</p></td><td char="." align="char"><p>2.33</p></td><td align="left"><p>0</p></td></tr></tbody></table></table-wrap></p></sec></app></app-group></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Combined cooling</facet-value><facet-value count="1">Heating and power (CCHP)</facet-value><facet-value count="1">Microgrid</facet-value><facet-value count="1">Piecewise linear</facet-value><facet-value count="1">Robust optimization</facet-value><facet-value count="1">Uncertainty</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Modern Power Systems and Clean Energy</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value><facet-value count="1">United Kingdom</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
