<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s40668-020-00033-7</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40668</journal-id><journal-title-group><journal-title>Computational Astrophysics and Cosmology</journal-title><journal-subtitle>Simulations, Data Analysis and Algorithms</journal-subtitle><abbrev-journal-title abbrev-type="publisher">Comput. Astrophys. Cosmol.</abbrev-journal-title></journal-title-group><issn pub-type="epub">2197-7909</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40668-020-00033-7</article-id><article-id pub-id-type="manuscript">33</article-id><article-id pub-id-type="doi">10.1186/s40668-020-00033-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Technologies for supporting high-order geodesic mesh frameworks for computational astrophysics and space sciences</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><name><surname>Florinski</surname><given-names>Vladimir</given-names></name><address><email>vaf0001@uah.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs40668020000337_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Balsara</surname><given-names>Dinshaw S.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Garain</surname><given-names>Sudip</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Gurski</surname><given-names>Katharine F.</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.265893.3</institution-id><institution-id institution-id-type="ISNI">0000 0000 8796 4945</institution-id><institution content-type="org-division">Space Science Department</institution><institution content-type="org-name">University of Alabama in Huntsville</institution></institution-wrap><addr-line content-type="city">Huntsville</addr-line><country country="US">USA</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.131063.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2168 0066</institution-id><institution content-type="org-division">Physics and ACMS Departments</institution><institution content-type="org-name">University of Notre Dame</institution></institution-wrap><addr-line content-type="city">Notre Dame</addr-line><country country="US">USA</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.54642.31</institution-id><institution-id institution-id-type="ISNI">0000 0000 8608 6140</institution-id><institution content-type="org-name">Korea Astronomy and Space Science Institute</institution></institution-wrap><addr-line content-type="city">Daejeon</addr-line><country country="KR">Republic of Korea</country></aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.257127.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 0547 4545</institution-id><institution content-type="org-division">Mathematics Department</institution><institution content-type="org-name">Howard University</institution></institution-wrap><addr-line content-type="city">Washington</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><corresp id="IDs40668020000337_cor1"><label>a</label><email>vaf0001@uah.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>27</day><month>3</month><year>2020</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2020</year></pub-date><volume>7</volume><issue seq="1">1</issue><elocation-id>1</elocation-id><history><date date-type="registration"><day>17</day><month>3</month><year>2020</year></date><date date-type="received"><day>5</day><month>9</month><year>2019</year></date><date date-type="accepted"><day>17</day><month>3</month><year>2020</year></date><date date-type="online"><day>27</day><month>3</month><year>2020</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2020</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Many important problems in astrophysics, space physics, and geophysics involve flows of (possibly ionized) gases in the vicinity of a spherical object, such as a star or planet. The geometry of such a system naturally favors numerical schemes based on a spherical mesh. Despite its orthogonality property, the polar (latitude-longitude) mesh is ill suited for computation because of the singularity on the polar axis, leading to a highly non-uniform distribution of zone sizes. The consequences are (a) loss of accuracy due to large variations in zone aspect ratios, and (b) poor computational efficiency from a severe limitations on the time stepping. Geodesic meshes, based on a central projection using a Platonic solid as a template, solve the anisotropy problem, but increase the complexity of the resulting computer code. We describe a new finite volume implementation of Euler and MHD systems of equations on a triangular geodesic mesh (TGM) that is accurate up to fourth order in space and time and conserves the divergence of magnetic field to machine precision. The paper discusses in detail the generation of a TGM, the domain decomposition techniques, three-dimensional conservative reconstruction, and time stepping.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Geodesic mesh</kwd><kwd>Finite volume scheme</kwd><kwd>Divergence free MHD</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>National Aeronautics and Space Administration</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/100000104</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">NNX17AB85G</award-id><principal-award-recipient><name><surname>Florinski</surname><given-names>Vladimir</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>National Science Foundation</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/100000001</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">DMS-1361219</award-id><award-id award-type="FundRef grant">ACI-1533850</award-id><award-id award-type="FundRef grant">DMS-1622457</award-id><award-id award-type="FundRef grant">ACI-1713765</award-id><award-id award-type="FundRef grant">DMS-1821242</award-id><principal-award-recipient><name><surname>Gurski</surname><given-names>Katharine F.</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>Balsara</surname><given-names>Dinshaw S.</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>Balsara</surname><given-names>Dinshaw S.</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>Balsara</surname><given-names>Dinshaw S.</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>Balsara</surname><given-names>Dinshaw S.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>17</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40668_2020_Article_33.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Astronomy, Astrophysics and Cosmology</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computational Mathematics and Numerical Analysis</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Numeric Computing</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Physics and Astronomy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Objects in the universe tend to assume a spherical shape owing to the central nature of the gravitational force. Common examples include globular star clusters, stars and stellar-like objects, planets, and the larger planetary satellites. Modeling such objects’ interior, surface, or atmospheric processes is most conveniently done in a spherical coordinate system because it is perfectly adapted to the shape of the object. A three-dimensional spherical coordinate system has radial distance from the center of the sphere as one of its coordinates. In a spherical <italic>polar</italic> coordinate system the two remaining coordinates are the polar angle, or co-latitude, and the azimuthal angle. Implementing a computational mesh based on the polar spherical system incurs only a modest increase in algorithmic complexity compared with Cartesian meshes because both meshes are logically orthogonal. Unfortunately, this simplicity comes at a price: spherical polar meshes have a singularity on the polar axis where the planes of constant azimuth converge to a single line. As a result the sizes of the computational zones become progressively smaller toward the poles. A polar mesh therefore provides a very non-uniform coverage of the surface of the sphere, which is a highly undesirable property. Because the time step used in a simulation is proportional to the smallest dimension of the zone, a simulation based on a polar mesh is quite inefficient.</p><p id="Par3">Polar singularities can be avoided by using a composite mesh, consisting of multiple partially overlapping patches of structured mesh, where each patch is singularity free (Phillips <xref ref-type="bibr" rid="CR52">1959</xref>; Browning et al. <xref ref-type="bibr" rid="CR15">1989</xref>; Kageyama and Sato <xref ref-type="bibr" rid="CR42">2004</xref>; Feng et al. <xref ref-type="bibr" rid="CR26">2010</xref>; Usmanov et al. <xref ref-type="bibr" rid="CR61">2012</xref>). In this approach the different meshes must be synchronized in their regions of overlap, which involves interpolation and could result in a loss of accuracy or conservation. Another approach, first introduced in the work of Sadourny et al. (<xref ref-type="bibr" rid="CR57">1968</xref>), uses a mesh that covers the surface of the sphere without gaps or overlaps, known as a tesselation. Each “tile” in the tesselatation is a spherical polygon such as a triangle, a quadrilateral, a pentagon, or a hexagon. The lines connecting adjacent vertices on the sphere are usually (but not always) great circle arcs, which are geodesic lines on the sphere (hence the name, “geodesic mesh”). A well chosen tesselation method can provide a nearly uniform coverage of the surface of the sphere which greatly improves computational efficiency.</p><p id="Par4">A geodesic mesh is constructed from a regular polyhedron (Platonic solid) inscribed inside a sphere used as a template. The most common method of generating such a mesh is to project the edges of the polyhedron to the sphere and recursively subdivide each spherical polygon into smaller polygonal faces until the desired level of discretization is achieved. A cube can be used to generate a cube-sphere mesh whose faces are quadrilaterals (Ronchi et al. <xref ref-type="bibr" rid="CR55">1996</xref>; Koldoba et al. <xref ref-type="bibr" rid="CR44">2002</xref>; Choblet et al. <xref ref-type="bibr" rid="CR16">2007</xref>; Putman and Lin <xref ref-type="bibr" rid="CR54">2007</xref>; Ivan et al. <xref ref-type="bibr" rid="CR40">2015</xref>; Ullrich and Taylor <xref ref-type="bibr" rid="CR60">2015</xref>). Such a mesh is topologically Cartesian within each of the six faces of the cube, requiring special treatment only in the vicinity of the eight corners. It is also possible to construct a mesh out of triangles using an octahedron (Feng et al. <xref ref-type="bibr" rid="CR27">2007</xref>), dodecahedron (Nakamizo et al. <xref ref-type="bibr" rid="CR49">2009</xref>), or an icosahedron (Giraldo <xref ref-type="bibr" rid="CR30">1997</xref>; Pudykiewicz <xref ref-type="bibr" rid="CR53">2006</xref>; Bernard et al. <xref ref-type="bibr" rid="CR14">2009</xref>) as the base solid. A variation of this approach uses a hexagon based dual tesselation, obtained by replacing the vertices of the triangular mesh with face circumcenters and vice versa (Heikes and Randall <xref ref-type="bibr" rid="CR37">1995a</xref>; Du et al. <xref ref-type="bibr" rid="CR19">2003</xref>; Feng et al. <xref ref-type="bibr" rid="CR27">2007</xref>; Miura <xref ref-type="bibr" rid="CR47">2007</xref>; Florinski et al. <xref ref-type="bibr" rid="CR28">2013</xref>).</p><p id="Par5">Non geodesic tesselations also exist; one prominent example being the HEALPix mesh used for numerical analysis of astrophysical data on the sphere (Gorski et al. <xref ref-type="bibr" rid="CR31">2005</xref>). For three-dimensional problems the tesselation is extruded radially, producing a three-dimensional spherical geodesic mesh. A 3D mesh based on a geodesic tesselation has a very useful property that some of its faces (the so-called r-faces, see below) are flat, which greatly simplifies the numerical scheme. By contrast, all faces of non-geodesic meshes are curved, making such meshes less convenient for use with 3D problems.</p><p id="Par6">In this paper we describe a powerful new framework for finite volume simulations on a triangular geodesic mesh (TGM) with second, third, and fourth orders of accuracy. At this time the software is developed to solve MHD problems with up to fourth order of accuracy in space and time, while conserving the divergence of the magnetic field down to machine precision. Several of the underlying numerical algorithms have been previously published and we refer the interested reader to these papers. However, implementation of these algorithms on a geodesic mesh requires a novel perspective. This is because a geodesic mesh possesses properties of both structured and unstructured meshes. A number of innovative techniques need to be brought together in order to efficiently carry out CFD type simulations on TGMs. The goal of this paper is to describe in detail the techniques that enable efficient implementation of MHD algorithms on spherical geodesic meshes.</p></sec><sec id="Sec2"><title>Mesh construction</title><p id="Par7">The choice of spherical polygons used to tile the sphere consists of triangles, quadrilaterals, and hexagons (with a small mix of pentagons), but not all combinations result in a high quality mesh. It is desirable to have a mesh that is both highly uniform (or isotropic) and nestable. The first property demands that the faces should be approximately of the same shape and size, while the second ensures strict parent-child relationship between the recursive subdivisions, which is a critical property for domain decomposition (and hence efficient parallelization) as well as adaptive refinement. A regular polyhedron is perfectly uniform: the edges are all of equal length, the faces have the same area, and the vertex angles are the same (see the upper left panel in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). However, the very first subdivision breaks this perfect symmetry because the four daughter faces are of a slightly different shape and size. For example, in a triangular mesh shown in the lower left panel of Fig. <xref rid="Fig1" ref-type="fig">1</xref> the daughter face in the middle of the parent face is slightly different in size from the three daughter faces at the corners. Consequently, higher division meshes are somewhat less uniform that those at lower division. This departure from uniformity is greatest near the vertices of the base polyhedron. In addition, the uniform connectivity of the mesh is violated near these singular points. As an example, consider a mesh constructed from a base hexahedron with quadrilateral faces (i.e., the cube sphere). While commonly each vertex is shared by four faces, only three meet at the eight singular points. As a result the quadrilaterals adjacent to these vertices are diamond shaped, rather than square. <fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p>Recursive icosahedral mesh generation. Shown are the inscribed icosahedron (top left) and the division 0 (top right), 1(bottom left), and 2(bottom right) triangular tesselations. The edges of the tesselation are repeatedly bisected until a desired level of refinement is reached</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig1_HTML.png"/></fig></p><p id="Par8">The mesh described in this paper is constructed from an icosahedron and has triangular shaped faces. The upper right panel in Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows that there are twelve singular points in this mesh, where five triangles meet instead of the usual six, but the anisotropy so introduced is not as prominent because the defects are distributed over a larger number of sites. This is the reason that an icosahedron produces a superior mesh compared to a tetrahedron or an octahedron. A dodecahedron can in principle be used, but it lacks a division 0 triangular tesselation, consisting instead of pentagons, and is less convenient for practical use. A hexagonal mesh like that used by Florinski et al. (<xref ref-type="bibr" rid="CR28">2013</xref>) has good uniformity, but is not nestable.</p><p id="Par9">Construction of a TGM begins with inscribing an icosahedron inside a sphere (in the rest of this paper we will always assume that the sphere has a unit radius, unless stated otherwise) and centrally projecting its edges to the surface of the sphere, see the top row of Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This projection generates a <italic>division</italic> 0 tesselation that includes 12 vertices, 20 triangular faces, called <italic>t-faces</italic> and 30 edges, called <italic>t-edges</italic> (these names are chosen to distinguish them from the faces and edges oriented in the radial direction produced by the radial extrusion of the mesh that bear the prefix “r”). For the sake of efficiency, all calculations on the sphere are performed in Cartesian coordinates using vector operations on the vertices. The input to the mesh generator consists of the coordinates of the icosahedron’s vertices, vertex-vertex (VV) neighbor information, and face-vertex (FV) connectivity information.</p><p id="Par10">At each division, the complete mesh connectivity information is computed and stored. For vertices, this includes the list (VV) of six neighbor vertices (five at division 0), six(five) t-edges meeting at the vertex (VE) and six(five) t-faces sharing the vertex (VF). For edges, connectivity information includes the two vertices at the ends (EV) and the two t-faces sharing this t-edge (EF). Finally, for faces we compute the list of three vertices at the corners (FV), the list of three edges (FE) and the list of three face neighbors (FF), for the total of eight connectivity tables. Table <xref rid="Tab1" ref-type="table">1</xref> shows the order of connectivity table generation and the methods used for construction. Note that at division zero the VV and FV information is already available and steps 1 and 3 are therefore omitted. To facilitate search operations FV, FE, FF, and VF lists are ordered in the counter-clockwise direction, while the remaining tables are not ordered. None of the steps of the mesh generation process require a full search, and the algorithm is linear in the number of elements. <table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Connectivity table construction methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Step</p></th><th><p>Table</p></th><th><p>Prerequisite</p></th><th><p>Method of construction</p></th></tr></thead><tbody><tr><td><p>1</p></td><td><p>VV</p></td><td><p>parent division</p></td><td><p>Based on numbering scheme</p></td></tr><tr><td><p>2</p></td><td><p>EV</p></td><td><p>VV</p></td><td><p>Insert edge per VV entry with no duplicates</p></td></tr><tr><td><p>3</p></td><td><p>FV</p></td><td><p>parent division</p></td><td><p>Based on numbering scheme</p></td></tr><tr><td><p>4</p></td><td><p>VE</p></td><td><p>EV</p></td><td><p>Inverse of EV</p></td></tr><tr><td><p>5</p></td><td><p>VF</p></td><td><p>FV</p></td><td><p>Inverse of FV</p></td></tr><tr><td><p>6</p></td><td><p>EF</p></td><td><p>EV, VF</p></td><td><p>Match two faces sharing this edge’s vertices</p></td></tr><tr><td><p>7</p></td><td><p>FE</p></td><td><p>EF</p></td><td><p>Inverse of EF</p></td></tr><tr><td><p>8</p></td><td><p>FF</p></td><td><p>EF, FE</p></td><td><p>Find the other face sharing each edge</p></td></tr></tbody></table></table-wrap></p><p id="Par11">To produce a division 1 tesselation shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (bottom-left) new vertices are inserted at the midpoints of division 0 edges. These vertices are then connected with new edges (great circle arcs) that divide each spherical triangle into four smaller triangles. The process is repeated until the desired level of refinement is achieved. It can be easily verified that the number of vertices, edges, and faces in the tesselation at division <italic>d</italic> are <disp-formula id="Equ1"><label>1</label><alternatives><mml:math id="Equ1_Math"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>30</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{gathered} N_{v}(d)=2+10\times 2^{2d},\quad\quad N_{e}(d)=30 \times 2^{2d}, \\ N_{f}(d)=20 \times 2^{2d}. \end{gathered} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ1.gif"/></alternatives></disp-formula> It should be pointed out that the mesh construction algorithm described above is not restricted to icosahedral meshes, but can in principle start with any one of the five Platonic solids. Only steps 1 and 3 in Table <xref rid="Tab1" ref-type="table">1</xref> need to be adjusted. This property permits writing highly modular geodesic mesh generation algorithms for the sphere.</p><p id="Par12">The nonuniformity of the mesh can be assessed by computing the ratios between the largest and the smallest measurement of edge lengths, vertex angles, and face areas. A high quality mesh would have these ratios as close to unity as possible. Table <xref rid="Tab2" ref-type="table">2</xref> documents the properties of triangular icosahedral tesselations at divisions zero through eight. Note that the ratios quickly converge to their asymptotic values. The largest face is only 30% larger than the smallest face, so the disparity in zone sizes will not noticeably affect the time step. Figure <xref rid="Fig2" ref-type="fig">2</xref> compares the geometric properties of the icosahedral TGM and the hexahedral quadrilateral geodesic mesh (QGM), also known as the gnomonic cube sphere. Shown are the edge, angle, and area largest-to-smallest ratios that should be a close to unity as possible. One can see that the icosahedral mesh has superior uniformity of every property compared with the QGM. <fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p>Uniformity measures of the icosahedral mesh (triangles) and the hexahedral mesh (squares) for division 0–8 (former) and 0–9 (latter). Blue lines show edge ratios, red angle ratios, and green area ratios. The icosahedral TGM is measurably more uniform than the gnomonic cube sphere</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig2_HTML.png"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Triangular geodesic mesh properties at divisions 0–8</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Div</p></th><th align="left"><p>Vertices</p></th><th align="left"><p>Edges</p></th><th align="left"><p>Faces</p></th><th align="left"><p>Avg. edge</p></th><th><p>Avg. angle</p></th><th><p>Average area</p></th><th><p>Edge ratio</p></th><th><p>Angle ratio</p></th><th><p>Area ratio</p></th></tr></thead><tbody><tr><td><p>0</p></td><td><p>12</p></td><td><p>30</p></td><td><p>20</p></td><td><p>63.4<sup>∘</sup></p></td><td><p>72.0<sup>∘</sup></p></td><td><p>6.28 × 10<sup>−1</sup></p></td><td><p>1.00</p></td><td><p>1.00</p></td><td><p>1.00</p></td></tr><tr><td><p>1</p></td><td><p>42</p></td><td><p>120</p></td><td><p>80</p></td><td><p>33.9<sup>∘</sup></p></td><td><p>63.0<sup>∘</sup></p></td><td><p>1.57 × 10<sup>−1</sup></p></td><td><p>1.14</p></td><td><p>1.24</p></td><td><p>1.20</p></td></tr><tr><td><p>2</p></td><td><p>162</p></td><td><p>480</p></td><td><p>320</p></td><td><p>17.2<sup>∘</sup></p></td><td><p>60.8<sup>∘</sup></p></td><td><p>3.93 × 10<sup>−2</sup></p></td><td><p>1.18</p></td><td><p>1.31</p></td><td><p>1.28</p></td></tr><tr><td><p>3</p></td><td><p>642</p></td><td><p>1920</p></td><td><p>1280</p></td><td><p>8.64<sup>∘</sup></p></td><td><p>60.2<sup>∘</sup></p></td><td><p>9.82 × 10<sup>−3</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.29</p></td></tr><tr><td><p>4</p></td><td><p>2562</p></td><td><p>7680</p></td><td><p>5120</p></td><td><p>4.33<sup>∘</sup></p></td><td><p>60.0<sup>∘</sup></p></td><td><p>2.45 × 10<sup>−3</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.30</p></td></tr><tr><td><p>5</p></td><td><p>10,242</p></td><td><p>30,720</p></td><td><p>20,480</p></td><td><p>2.16<sup>∘</sup></p></td><td><p>60.0<sup>∘</sup></p></td><td><p>6.14 × 10<sup>−4</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.30</p></td></tr><tr><td><p>6</p></td><td><p>40,962</p></td><td><p>122,880</p></td><td><p>81,920</p></td><td><p>1.08<sup>∘</sup></p></td><td><p>60.0<sup>∘</sup></p></td><td><p>1.53 × 10<sup>−4</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.30</p></td></tr><tr><td><p>7</p></td><td><p>163,842</p></td><td><p>491,520</p></td><td><p>327,680</p></td><td><p>0.54<sup>∘</sup></p></td><td><p>60.0<sup>∘</sup></p></td><td><p>3.84 × 10<sup>−5</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.30</p></td></tr><tr><td><p>8</p></td><td><p>655,362</p></td><td><p>1,966,080</p></td><td><p>1,310,720</p></td><td><p>0.27<sup>∘</sup></p></td><td><p>60.0<sup>∘</sup></p></td><td><p>1.16 × 10<sup>−5</sup></p></td><td><p>1.19</p></td><td><p>1.33</p></td><td><p>1.30</p></td></tr></tbody></table></table-wrap></p><p id="Par13">The simple mesh does have a few deficiencies, mainly related to the fact that the centroids of the faces are distinct from the circumcenters, as pointed out by Heikes and Randall (<xref ref-type="bibr" rid="CR38">1995b</xref>). Several numerical optimization algorithms have been proposed to improve the mesh, including the spring dynamics model (Tomita et al. <xref ref-type="bibr" rid="CR59">2001</xref>) and the centroidal generation algorithm (Du et al. <xref ref-type="bibr" rid="CR18">1999</xref>). Numerical optimization methods usually improve a certain mesh property at the expense of another. For example, an algorithm could trade face area uniformity for vertex angle disparity. Another problem with numerically modified meshes is that the optimization process is specific to each division and the resulting meshes lose their nestable property, i.e., become unsuitable for mesh refinement (Putman and Lin <xref ref-type="bibr" rid="CR54">2007</xref>). Because we anticipate such development in the future, and because we have not observed any adverse effects from using the simple recursive mesh, it is our preferred method of construction.</p><p id="Par14">The triangular tesselation is extruded radially over a number of concentric spherical layers called shells, to produce the three-dimensional TGM. The software stores the reciprocal connectivity tables for every element on the sphere (vertex, edge, or face) at all divisions, up to the maximum allowed. In addition, there are tree structures describing the parent-child relationships between the faces. For the purpose of domain decomposition, a face subdivided into higher division faces is called a <italic>sector</italic> and a layer of consecutive shells is called a <italic>slab</italic>. An intersection between a sector and a slab is called a <italic>block</italic>, which is the computational unit on this mesh. Each computational zone has the shape of a truncated triangular pyramid also known as a <italic>frustum</italic>.</p><p id="Par15">Locating an arbitrary vector (i.e., finding the zone containing the vector) on the TGM follows a simple procedure valid for any nested polyhedral tesselation. Once the shell number has been determined (via a mapping function or bisection search), the vector is normalized to unity. The nearest division 0 vertex is found by computing the largest scalar product with all 12 vertices at that division. Next, the algorithm tests which of the five surrounding t-faces the vector belongs to, and then recursively tests the four daughter faces at each division. A test for the t-face interior consists of computing the triple products of the vector with two consecutive vertices (1–2, 2–3, and 3–1). If all three triple products are positive, the point belongs to the interior of the t-face with counter-clockwise vertex ordering.</p><p id="Par16">Partitioning the mesh into sectors and slabs enables efficient domain decomposition and offers many opportunities for parallelization. The software framework uses MPI and MPI-derived libraries and achieves essentially linear weak scaling (Balsara et al. <xref ref-type="bibr" rid="CR6">2019</xref>). We will next concentrate on a single triangular block and describe its partitioning into computational zones, generating stencils, and performing reconstruction of zone based mesh variables with a desired order of accuracy.</p></sec><sec id="Sec3"><title>Grid blocks</title><p id="Par17">The tree numbering system for the faces, edges, and vertices is too slow to be used for zone access within a sector, for which we introduce a flat, two-dimensional “triangular addressing scheme”, or TAS. The face numbering pattern is illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref> which shows one block of a mesh whose sector division <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq1.gif"/></alternatives></inline-formula> is three less than its face division (<inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta d=d-d_{s}=3$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq2.gif"/></alternatives></inline-formula>). In this example the sector has two layers of ghost zones around its interior. The numbering starts from the base vertex identified by the tesselation; the sector is always drawn in an orientation where the principal vertex is in the SW corner. The first coordinate index runs from W to E and the second index runs from SE to NW. The alternating color shading in Fig. <xref rid="Fig3" ref-type="fig">3</xref> is used to distinguish faces with opposite orientations; many of the vector operations are performed with the opposite signs for the shaded (yellow) and unshaded (white) faces. <fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p>A single sector of the mesh. In this example the face division is equal to the sector division plus three. The black arrows show the directions of the first and second TAS coordinates. Two layers of ghost faces are visible. The three trapezoidal and nine small triangular pieces marked with different border colors are the areas subject to boundary exchange with neighboring blocks</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig3_HTML.png"/></fig></p><p id="Par18">The number of vertices, t-edges, and t-faces in a sector with <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{g}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq3.gif"/></alternatives></inline-formula> layers of ghost zones are <disp-formula id="Equ2"><label>2</label><alternatives><mml:math id="Equ2_Math"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{gathered} N_{v}=\frac{(L+1)(L+2)}{2},\quad\quad N_{e}= \frac{3L(L+1)}{2}, \\ N_{f}=L^{2}, \end{gathered} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ2.gif"/></alternatives></disp-formula> where <disp-formula id="Equ3"><label>3</label><alternatives><mml:math id="Equ3_Math"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L=2^{\Delta d}+3N_{g} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ3.gif"/></alternatives></disp-formula> is the length of the side of the sector. Note that the number of t-edges is three times the number of unshaded faces; it is often convenient to access the edges using a loop on unshaded faces only. The numbering scheme used for the t-edges and vertices is similar to that used for the faces. The edges are numbered in a specific order: first all NE edges, then all NW edges, and finally all S edges (relative to the respective unshaded t-face).</p><p id="Par19">Figure <xref rid="Fig3" ref-type="fig">3</xref> draws with different colors the boundaries of the blocks of ghost zones used to exchange information with the neighboring sectors. The boundary exchange process is discussed in some detail in Sect. <xref rid="Sec21" ref-type="sec">8</xref>. Here we only mention that the grey bordered triangular regions may be absent if the block contains one or more <italic>penta-corners</italic>, which are the vertices of the original icosahedron. These vertices have only five neighbor elements rather than six, and care must be taken to adjust stencil generation procedure and boundary exchanges between blocks near these special points. For example, if the principal vertex of the block shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> is a penta-corner, t-faces 6, 7, 8, and 13 are absent, and the mesh must be closed along the <italic>cut line</italic> that appears in place of the missing faces.</p><p id="Par20">Grid blocks also maintain a set of local connectivity tables similar to those listed in Table <xref rid="Tab2" ref-type="table">2</xref>. These tables have a very regular pattern and are much simpler to construct than the tesselation tables; all neighbors are ordered in counter-clockwise direction. The t-edge orientation is defined with respect to its unshaded neighbor face, which fixes the directions of the normal and tangent vectors on the mesh.</p><p id="Par21">Each grid block needs to know the coordinates of every vertex in the local grid. Because the tesselation numbers its t-faces and vertices differently from the grid blocks, a routine is provided to assemble a list of vertices that lie in a requested sector with ghost cells in the TAS format. The convention is that the base vertex is the first vertex in the FV set of the sector. The mapping routine walks the sector, including the ghost t-faces, from W to E and from SE to NW, storing the coordinates of the vertices encountered along the path. Three step operators are defined, all relative to the base vertex of the t-face, shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. A type 1 step moves from the initial t-face (<inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq4.gif"/></alternatives></inline-formula>) to the final face (<inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{f}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq5.gif"/></alternatives></inline-formula>) in the S direction and the new base vertex (<inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v_{f}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq6.gif"/></alternatives></inline-formula>) is to the E of the old base vertex (<inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq7.gif"/></alternatives></inline-formula>) on the common edge. A type 2 step moves diagonally to the NE, and the new base vertex is opposite to the initial base vertex. Finally, a type 3 step moves to the NW, but the new base vertex belongs to the common edge. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the vertex moves are shown with orange arrows and the face moves with red arrows. These three operations apply to unshaded to shaded t-face movement. The shaded to unshaded step operators are algorithmically identical to those, and correspond to switching the initial and the final t-faces and vertices, and reversing the arrow directions. <fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p>Step operators on the mesh. The three unshaded to shaded step operators shown are used to walk the sector with its ghost t-faces. The step is from the vertex-face pair <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq9.gif"/></alternatives></inline-formula> to <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v_{f}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq10.gif"/></alternatives></inline-formula>, <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{f}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq11.gif"/></alternatives></inline-formula>. The shaded to unshaded steps are obtained by switching the origin and destination vertex-face pairs</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig4_HTML.png"/></fig></p><p id="Par22">The sector walk routine works as follows. From the base vertex of the sector, the code first walks to the NW until it encounters the left side of the block (t-face 25 in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Then the code walks to the SW until it reaches the corner of the grid block (face number 1 in the grid block’s numbering scheme). From there, the code makes a step to the right followed by <italic>i</italic> steps diagonally (SE-NW), where <italic>i</italic> is the index of the horizontal step. That way every cell in the block is visited once. Note that the alternating pattern of shaded and unshaded t-faces is broken across the cut line, and special versions of the step operators are needed to move between the faces of the same shading.</p></sec><sec id="Sec4"><title>Representing spherical geometry</title><p id="Par23">In principle, it is possible to perform all calculations on a TGM by directly using spherical geometry. We found, however, that using isoparametric mapping from a reference zone, which in this case is a right triangular (equilateral) prism, offers significant advantages. In particular, integration on spherical triangles is difficult, requiring a large number of quadrature points at higher orders (Beckmann et al. <xref ref-type="bibr" rid="CR13">2012</xref>). Integration on the reference element is straightforward by comparison.</p><p id="Par24">The physical zone and its reference image are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The left panel shows the physical zone that has the shape of a truncated triangular pyramid, also called a frustum. The spherical top and bottom caps are the t-faces, and the annular sides are the r-faces. The frustum therefore has three r-faces and two t-faces. The edges of the t-faces are called t-edges, and the edges connecting the bottom and top t-faces are called r-edges. There are six t-edges, three r-edges, and six vertices per zone. The vertices belonging to a t-face are numbered counter-clockwise in its connectivity tables, 1 through 3, and the t-edges of each t-face are also numbered counter-clockwise, 1 through 3. By convention, a vertex has the same index as the opposite t-edge. <fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p>A computational zone (left) and the reference element (right). The reference shape is a right equilateral triangular prism which is mapped into the frustum in physical space</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig5_HTML.png"/></fig></p><p id="Par25">A point in reference space is addressed with a coordinate triplet (<italic>ξ</italic>, <italic>η</italic>, <italic>ζ</italic>). The bottom and the top faces of the prism lie in the planes <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\zeta =0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\zeta =1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq13.gif"/></alternatives></inline-formula>, respectively. The area of the t-face in reference coordinates is <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt{3}/4$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq14.gif"/></alternatives></inline-formula>, the area of the r-face is one, and the volume of the prism is <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt{3}/4$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq15.gif"/></alternatives></inline-formula>. It is convenient to work with barycentric coordinates in the <italic>ξη</italic> plane (<inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq16.gif"/></alternatives></inline-formula>, <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq18.gif"/></alternatives></inline-formula>), defined in Chap. 8 of Zienkiewicz et al. (<xref ref-type="bibr" rid="CR63">2013</xref>) as <disp-formula id="Equ4"><label>4</label><alternatives><mml:math id="Equ4_Math"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>ξ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \xi =\varLambda _{1}\xi _{1}+\varLambda _{2}\xi _{2}+\varLambda _{3}\xi _{3}, \\&amp; \eta =\varLambda _{1}\eta _{1}+\varLambda _{2}\eta _{2}+\varLambda _{3}\eta _{3}, \\&amp; 1=\varLambda _{1}+\varLambda _{2}+\varLambda _{3}, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ4.gif"/></alternatives></disp-formula> where <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\xi _{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$i=1,2,3$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq21.gif"/></alternatives></inline-formula>, are the <italic>ξ</italic> and <italic>η</italic> components of the vertices of the triangle in the reference space. The barycentric coordinates are equal to the partial areas of the sub-triangles formed by the point <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\xi , \eta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq22.gif"/></alternatives></inline-formula> and the three vertices of the reference triangle (please note that this is not true for the areas of the respective curved triangles). For the equilateral reference triangle the inverse of (<xref rid="Equ4" ref-type="disp-formula">4</xref>) is <disp-formula id="Equ5"><label>5</label><alternatives><mml:math id="Equ5_Math"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>η</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>η</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>η</mml:mi></mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \varLambda _{1}=1-\xi -\frac{\eta }{\sqrt{3}}, \\&amp; \varLambda _{2}=\xi -\frac{\eta }{\sqrt{3}}, \\&amp; \varLambda _{3}=\frac{2\eta }{\sqrt{3}}. \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ5.gif"/></alternatives></disp-formula></p><p id="Par26">We next introduce a set of two-dimensional linearly independent Lagrange basis functions associated with the nodal points on the curved triangular faces that fix the mapping from reference space to the physical space. It is convenient to compute the nodal point coordinates on the unit sphere; the physical coordinates are obtained simply by rescaling to the desired radial distance. We denote vectors that lie on the unit sphere with the superscript “<italic>u</italic>”. All coordinates are factored as <disp-formula id="Equ6"><label>6</label><alternatives><mml:math id="Equ6_Math"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{x}(\xi ,\eta ,\zeta )=r(\zeta )\mathbf{x}^{u}(\xi ,\eta ), $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ6.gif"/></alternatives></disp-formula> where <disp-formula id="Equ7"><label>7</label><alternatives><mml:math id="Equ7_Math"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">[</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r(\zeta )=r_{b}+\zeta (r_{t}-r_{b})=r_{b} \bigl[1+\zeta (\rho -1)\bigr], $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ7.gif"/></alternatives></disp-formula> where <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{b}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{t}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq24.gif"/></alternatives></inline-formula> are the radial distances of the nodal points on the bottom and the top t-face, respectively, and <italic>ρ</italic> is their ratio. As discussed below, this factoring enables a more efficient implementation of the reconstruction algorithm on the TGM compared with fully unstructured tetrahedral meshes. To perform integration we also require a set of curvilinear unnormalized basis vectors <disp-formula id="Equ8"><label>8</label><alternatives><mml:math id="Equ8_Math"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ξ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>η</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{gathered} \mathbf{h}_{\xi }=\frac{\partial \mathbf{x}}{\partial \xi }=r \frac{\partial \mathbf{x}^{u}}{\partial \xi },\quad\quad \mathbf{h}_{\eta }= \frac{\partial \mathbf{x}}{\partial \eta }=r \frac{\partial \mathbf{x}^{u}}{\partial \eta }, \\ \mathbf{h}_{\zeta }=\frac{\partial \mathbf{x}}{\partial \zeta }=(r_{t}-r_{b}) \mathbf{x}^{u}. \end{gathered} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ8.gif"/></alternatives></disp-formula></p><p id="Par27">Given <italic>N</italic> nodal points on a triangle, there are <italic>N</italic> Lagrange basis functions <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\psi _{i}(\xi ,\eta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq25.gif"/></alternatives></inline-formula> that satisfy <disp-formula id="Equ9"><label>9</label><alternatives><mml:math id="Equ9_Math"><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \psi _{i}(\xi _{j},\eta _{j})=\delta _{ij}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ9.gif"/></alternatives></disp-formula> where <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\xi _{j},\eta _{j})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq26.gif"/></alternatives></inline-formula> are the coordinates of nodal point <italic>j</italic> on the unit sphere. A position vector <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{x}^{u}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq27.gif"/></alternatives></inline-formula> can be represented as an expansion over the basis functions <disp-formula id="Equ10"><label>10</label><alternatives><mml:math id="Equ10_Math"><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>u</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi>i</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{x}^{u}(\xi ,\eta )=\sum_{i=1}^{N} \mathbf{v}^{u}_{i}\psi _{i}( \xi ,\eta ). $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ10.gif"/></alternatives></disp-formula> The coefficients in this expansion are the physical coordinates of the nodal points <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msubsup><mml:mi mathvariant="bold">v</mml:mi><mml:mi>i</mml:mi><mml:mi>u</mml:mi></mml:msubsup></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{v}^{u}_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq28.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the locations of the nodes on the reference triangle. These elements use <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N=3$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq29.gif"/></alternatives></inline-formula>, 6, and 10 for linear, quadratic, and cubic basis functions, respectively. The explicit formulas for the basis functions on the equilateral triangle are given in Appendix <xref rid="Sec24" ref-type="sec">A</xref>. Note that the maps from two adjacent t-faces are continuous at the shared t-edge by virtue of the use of barycentric coordinates for their construction. <fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p>Node locations on t-faces and t-edges for linear (left), quadratic (middle), and cubic (right) mapping. The first order surface element contains three nodes coincident with the vertices. The second order surface element includes all nodes from the first order elements plus the edge midpoints for the total of 6 nodes. The third order surface element includes all nodes from the first order elements plus the points at the thirds of each edge and the centroid, 10 nodes in total. The nodes of line elements representing t-edges are shown below each surface element</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig6_HTML.png"/></fig></p><p id="Par28">An expansion similar to (<xref rid="Equ10" ref-type="disp-formula">10</xref>) is used for the t-edges. Points from the surface element lying on that edge are used (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>) and the corresponding basis functions are simply restriction of the facial bases functions for one of the barycentric coordinate equal to zero. It is convenient to introduce an auxilliary variable <italic>δ</italic> that measures distance along the edge in the counter-clocksise direction. Its relation to barycentric coordinates is shown in Table <xref rid="Tab3" ref-type="table">3</xref>. The basis functions <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi _{i}(\delta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq30.gif"/></alternatives></inline-formula> for the edges can be also found in Appendix <xref rid="Sec24" ref-type="sec">A</xref>. <table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>The choice of the auxilliary variable <italic>δ</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>t-edge/r-face</p></th><th><p><inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq31.gif"/></alternatives></inline-formula></p></th><th><p><inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq32.gif"/></alternatives></inline-formula></p></th><th><p><inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varLambda _{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq33.gif"/></alternatives></inline-formula></p></th></tr></thead><tbody><tr><td><p>1</p></td><td><p>0</p></td><td><p>1 − <italic>δ</italic></p></td><td><p><italic>δ</italic></p></td></tr><tr><td><p>2</p></td><td><p><italic>δ</italic></p></td><td><p>0</p></td><td><p>1 − <italic>δ</italic></p></td></tr><tr><td><p>3</p></td><td><p>1 − <italic>δ</italic></p></td><td><p><italic>δ</italic></p></td><td><p>0</p></td></tr></tbody></table></table-wrap></p><p id="Par29">It is instructive to evaluate the disparity between the mapped surface given by Eq. (<xref rid="Equ10" ref-type="disp-formula">10</xref>) and the ideal surface, i.e., the unit sphere. Below we compute the error in the radial coordinate, <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mi>u</mml:mi></mml:msup></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$1-r^{u}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq34.gif"/></alternatives></inline-formula> for a mapped equilateral spherical triangle with a circumcircle radius of 5<sup>∘</sup>. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the error distribution for element orders one, two, and three. Obviously, the first order element with its planar faces is unable to reproduce the spherical shape resulting in a large error near the center. Switching to the second order element improves the accuracy by three orders of magnitude, while going to third order yields another factor of ∼20. It is evident that both second or third order elements reproduce spherical geometry with remarkable accuracy. <fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p>Linear (left), quadratic (center), and cubic (right) mapping accuracy. Shown is the distance between the mapped surface and the perfect sphere computed for an equilateral triangle with a circumcircle radius of 5<sup>∘</sup></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig7_HTML.png"/></fig></p><p id="Par30">It is worth mentioning that Ivan et al. (<xref ref-type="bibr" rid="CR39">2013</xref>) have previously developed an isoparametric cube sphere model based on a cubic reference element. However, their trilinear mapping anchored at the four corners of the quadrilateral t-face is not capable of truly reproducing a spherical surface because it has only one extra degree of freedom compared with the linear map. For example, when all four vertices lie in the same plane, the trilinear map yields a surface that is flat instead of curved.</p></sec><sec id="Sec5"><title>Evaluation of integrals on a geodesic mesh</title><p id="Par31">A finite volume scheme requires evaluating multi-dimensional integrals in the initial setup phase and during time updates of the conserved variables. This requires, at a minimum, volume and surface integrals. The use of constrained transport scheme to advance the magnetic field requires, in addition, evaluation of integrals along the edges (see Sect. <xref rid="Sec15" ref-type="sec">7</xref> below). We will therefore define the following integral operations: volume integration over a zone, surface integration on t-faces and r-faces, and line integration on t-edges and r-edges. For a three-dimensional vector variable <bold>V</bold> these are defined as <disp-formula id="Equ11"><label>11</label><alternatives><mml:math id="Equ11_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>∭</mml:mo><mml:mtext>zone</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mo>∭</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ξ</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>η</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>ξ</mml:mi><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>η</mml:mi><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \begin{aligned}[b] &amp; \iiint _{\text{zone}}\mathbf{V}(\mathbf{x})\,dV \\ &amp;\quad = \iiint \mathbf{V}( \xi ,\eta ,\zeta ) (\mathbf{h}_{\xi }\times \mathbf{h}_{\eta })\cdot \mathbf{h}_{\zeta }\,d\xi \,d\eta \,d\zeta , \end{aligned} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ11.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><mml:math id="Equ12_Math"><mml:msub><mml:mo>∬</mml:mo><mml:mtext>t-face</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∬</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ξ</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>η</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>ξ</mml:mi><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \iint _{\text{t-face}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dS}= \iint _{\Delta }\mathbf{V}(\xi ,\eta )\cdot (\mathbf{h}_{\xi } \times \mathbf{h}_{\eta })\,d\xi \,d\eta , \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ12.gif"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><mml:math id="Equ13_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>∬</mml:mo><mml:mtext>r-face</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>δ</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>δ</mml:mi><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \begin{aligned}[b] &amp;\iint _{\text{r-face}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dS} \\ &amp;\quad = \int _{0}^{1} \int _{0}^{1}\mathbf{V}(\delta ,\zeta ) \cdot ( \mathbf{h}_{\delta }\times \mathbf{h}_{\zeta })\,d\delta \,d\zeta , \end{aligned} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math id="Equ14_Math"><mml:msub><mml:mo>∫</mml:mo><mml:mtext>t-edge</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dl</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>δ</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>δ</mml:mi><mml:mo>,</mml:mo></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \int _{\text{t-edge}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dl}= \int _{0}^{1}\mathbf{V}(\delta )\cdot \mathbf{h}_{\delta }\,d \delta , \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math id="Equ15_Math"><mml:msub><mml:mo>∫</mml:mo><mml:mtext>r-edge</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dl</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \int _{\text{r-edge}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dl}= \int _{0}^{1}\mathbf{V}(\zeta )\cdot \mathbf{h}_{\zeta }\,d\zeta , \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ15.gif"/></alternatives></disp-formula> where the symbol ‘Δ’ designates integration over a triangle. We will now describe our strategy for evaluating the integrals using quadrature rules. Consider a single zone in the mesh addressed with a t-face index <italic>f</italic> whose top and bottom vertices lie at <italic>r</italic> and <italic>ρr</italic>, respectively. Further, suppose <italic>e</italic> is the index of one of the t-edges of the zone, and <italic>v</italic> is one of the vertices.</p><sec id="Sec6"><title>Integration on r-edges</title><p id="Par32">R-edges are addressed by the vertex index with specified <italic>r</italic> and <italic>ρ</italic>. Because r-faces are always straight, the integrals can be evaluated directly using Gauss–Legendre quadrature points. Define such set of points on the reference interval <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\zeta =[0,1]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq35.gif"/></alternatives></inline-formula> as <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{1r}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq36.gif"/></alternatives></inline-formula>. Each quadrature point <italic>q</italic> has position <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\zeta _{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq37.gif"/></alternatives></inline-formula> and weight <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq38.gif"/></alternatives></inline-formula>. Then it is evident that <disp-formula id="Equ16"><label>16</label><alternatives><mml:math id="Equ16_Math"><mml:msub><mml:mo>∫</mml:mo><mml:mtext>r-edge</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dl</mml:mi><mml:mo>≈</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>v</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \int _{\text{r-edge}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dl} \approx r( \rho -1)\sum_{q\in Q_{1r}}w_{q}\mathbf{V}\bigl(r \zeta '_{q} \mathbf{x}^{u}_{q}\bigr) \cdot \mathbf{x}^{u}_{v}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ16.gif"/></alternatives></disp-formula> where <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>v</mml:mi><mml:mi>u</mml:mi></mml:msubsup></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{x}^{u}_{v}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq39.gif"/></alternatives></inline-formula> is the position of the vertex <italic>v</italic> on the unit sphere and <disp-formula id="Equ17"><label>17</label><alternatives><mml:math id="Equ17_Math"><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \zeta '_{q}=1+(\rho -1)\zeta _{q} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ17.gif"/></alternatives></disp-formula> is the elevated radial position. The code uses 1 quadrature point for integrating polynomials of degrees zero and one, 2 points for degrees two and three, 3 points for fourth and fifth degree polynomials, etc.</p></sec><sec id="Sec7"><title>Integration on t-edges</title><p id="Par33">T-edges are addressed by the edge index with fixed <italic>r</italic>. These edges are curved (except when using linear basis functions) and the quadrature weights are therefore multiplied by the Jacobian equal to the length of the tangent vector <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>δ</mml:mi></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{h}_{\delta }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq40.gif"/></alternatives></inline-formula>. Again, designate the set of Gauss–Legendre points on the reference interval <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta =[0,1]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq41.gif"/></alternatives></inline-formula> as <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{1t}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq42.gif"/></alternatives></inline-formula> (which may or may not be the same as <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{1r}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq43.gif"/></alternatives></inline-formula>). Using the definition (<xref rid="Equ8" ref-type="disp-formula">8</xref>) we can write <disp-formula id="Equ18"><label>18</label><alternatives><mml:math id="Equ18_Math"><mml:msub><mml:mo>∫</mml:mo><mml:mtext>t-edge</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dl</mml:mi><mml:mo>≈</mml:mo><mml:mi>r</mml:mi><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \int _{\text{t-edge}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dl} \approx r\sum _{q\in Q_{1r}}w_{q}\mathbf{V}\bigl(r \mathbf{x}^{u}_{q}\bigr) \cdot \frac{\partial \mathbf{x}^{u}_{e}(\delta _{q})}{\partial \delta }, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ18.gif"/></alternatives></disp-formula> where <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta _{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq44.gif"/></alternatives></inline-formula> are the locations of the quadrature points on the reference interval and <disp-formula id="Equ19"><label>19</label><alternatives><mml:math id="Equ19_Math"><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{x}^{u}_{q}=\mathbf{x}^{u}_{e}( \delta _{q}). $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ19.gif"/></alternatives></disp-formula> Here the subscript ‘<italic>e</italic>’ refers to the fact that the map specific for edge <italic>e</italic> is used to evaluate the coordinate and its derivative. We use the same number of points for t-edge integration as for r-edge integration. In practice, the values of the point coordinates and tangent vectors on the unit sphere are precomputed for each t-edge at the start of a simulation for fast retrieval.</p></sec><sec id="Sec8"><title>Integration on r-faces</title><p id="Par34">R-faces are addressed by the edge index with specified <italic>r</italic> and <italic>ρ</italic> and approximate annular regions (trapezoids for elements of order 1). The position is specified via the <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\delta ,\zeta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq45.gif"/></alternatives></inline-formula> pair of coordinates. We now introduce quadrature points on the reference square <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\delta ,\zeta )=[0,1]\times [0,1]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq46.gif"/></alternatives></inline-formula> as <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{2r}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq47.gif"/></alternatives></inline-formula>. These points are conveniently computed as tensor products of the Gauss–Legendre quadrature points. The quadrature rule for r-faces can be written as <disp-formula id="Equ20"><label>20</label><alternatives><mml:math id="Equ20_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mo>∫</mml:mo><mml:mtext>r-face</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi><mml:mo>≈</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>⋅</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{aligned}[b] \int _{\text{r-face}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dS} \approx{}&amp; r^{2}(\rho -1)\sum_{q\in Q_{2r}}w_{q} \zeta '_{q}\mathbf{V}\bigl(r \zeta '_{q} \mathbf{x}^{u}_{q}\bigr) \\ &amp;{}\cdot \biggl( \frac{\partial \mathbf{x}^{u}_{e}(\delta _{q})}{\partial \delta } \times \mathbf{x}^{u}_{q} \biggr) \end{aligned} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ20.gif"/></alternatives></disp-formula> with <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{x}^{u}_{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq48.gif"/></alternatives></inline-formula> given by Eq. (<xref rid="Equ19" ref-type="disp-formula">19</xref>).</p><p id="Par35">The right panel of Fig. <xref rid="Fig8" ref-type="fig">8</xref> shows the locations of the points on the reference square. On a rectangle, three points are sufficient for exactly integrating a quadratic polynomial, four for cubic, and six for quartic. However, it is our intention to maintain exact polynomial integration rules for first order elements, where the r-face is a trapezoid. Its Jacobian is linear in the <italic>ζ</italic> coordinate, and the order of accuracy is reduced by one. For this reason we use four, six, and nine point rules to integrate polynomials of degrees two, three, and four, respectively. <fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p>Quadrature points on t-faces (left) and r-faces (right) of the prism. Three and four points are used to integrate a quadratic function exactly on t-faces and r-faces, respectively, four and six for cubic, six and nine for quartic, seven and twelve for quintic, and twelve and sixteen for sextic functions. The four point rule is not used on t-faces; instead the six point rule is used for third degree polynomials</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig8_HTML.png"/></fig></p></sec><sec id="Sec9"><title>Integration on t-faces</title><p id="Par36">T-faces are addressed by the face index with fixed <italic>r</italic>. They approximate spherical triangles (flat triangles for linear coordinate transformation). The position is specified via the <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\xi ,\eta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq49.gif"/></alternatives></inline-formula> pair of coordinates, and the set of quadrature points defined on a unit equilateral triangle is designated as <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{2t}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq50.gif"/></alternatives></inline-formula>. Here we use the symmetric quadrature rules given in Dunavant (<xref ref-type="bibr" rid="CR23">1985</xref>) with quadrature point locations shown in the left panel of Fig. <xref rid="Fig8" ref-type="fig">8</xref>. The integration algorithm for t-faces is <disp-formula id="Equ21"><label>21</label><alternatives><mml:math id="Equ21_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>∫</mml:mo><mml:mtext>t-face</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>≈</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>⋅</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{aligned}[b] &amp; \int _{\text{t-face}}\mathbf{V}(\mathbf{x})\cdot \mathbf{dS} \\ &amp;\quad \approx r^{2}\sum_{q\in Q_{2t}}w_{q}\mathbf{V} \bigl(r\mathbf{x}^{u}_{q}\bigr) \\ &amp;\quad\quad{} \cdot \biggl( \frac{\partial \mathbf{x}^{u}_{f}(\xi _{q},\eta _{q})}{\partial \xi } \times \frac{\partial \mathbf{x}^{u}_{f}(\xi _{q},\eta _{q})}{\partial \eta } \biggr), \end{aligned} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ21.gif"/></alternatives></disp-formula> where <disp-formula id="Equ22"><label>22</label><alternatives><mml:math id="Equ22_Math"><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{x}^{u}_{q}=\mathbf{x}^{u}_{f}( \xi _{q},\eta _{q}). $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ22.gif"/></alternatives></disp-formula> Three, four, and six points are sufficient to integrate a quadratic, cubic, and quartic polynomial exactly on a flat triangle. The four-point rule should be avoided because it has a negative weight, and we use the six point rule at third order. These points and the normal vectors are also precomputed for each t-face.</p></sec><sec id="Sec10"><title>Integration on frustums</title><p id="Par37">A frustum can be addressed by the face index with specified <italic>r</italic> and <italic>ρ</italic>. Defining a position requires all three reference coordinates <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\xi ,\eta ,\zeta )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq51.gif"/></alternatives></inline-formula>. We arrange the quadrature points in <italic>p</italic> “planes”, where each plane corresponds to a triangular quadrature rule with a set of points <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{2t}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq52.gif"/></alternatives></inline-formula> described in the previous subsection. The planes themselves are located at <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\zeta _{p}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq53.gif"/></alternatives></inline-formula> corresponding to the Gauss–Legendre points on <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$[0,1]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq54.gif"/></alternatives></inline-formula> that we designate as <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq55.gif"/></alternatives></inline-formula> with the plane weights given by <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{p}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq56.gif"/></alternatives></inline-formula>. Then a volume integral can be evaluated as <disp-formula id="Equ23"><label>23</label><alternatives><mml:math id="Equ23_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>∫</mml:mo><mml:mtext>zone</mml:mtext></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>≈</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msup><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>p</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mn>2</mml:mn></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>p</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \begin{aligned}[b] &amp; \int _{\text{zone}}\mathbf{V}(\mathbf{x})\,dV \\ &amp;\quad \approx r^{3}( \rho -1) \sum_{p\in P_{1}}w_{p}{\zeta '_{p}}^{2}\sum_{q\in Q_{2t}}w_{q} \mathbf{V}\bigl(r\zeta '_{p}\mathbf{x}^{u}_{q} \bigr) \biggl( \frac{\partial \mathbf{x}^{u}_{f}(\xi _{q},\eta _{q})}{\partial \xi } \\ &amp;\quad\quad{} \times \frac{\partial \mathbf{x}^{u}_{f}(\xi _{q},\eta _{q})}{\partial \eta } \biggr)\cdot \mathbf{x}^{u}_{q}, \end{aligned} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ23.gif"/></alternatives></disp-formula> where <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msubsup></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{x}^{u}_{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq57.gif"/></alternatives></inline-formula> is given by Eq. (<xref rid="Equ22" ref-type="disp-formula">22</xref>). We use two quadrature planes for polynomials of degrees 0 and 1, three for polynomials of degrees 2 and 3 and four for degrees 4 and 5.</p><p id="Par38">In curved spaces the total degree of the reconstruction polynomial increases significantly upon transformation to the reference coordinates. For example, a third degree polynomial in <bold>x</bold> on a quadratic surface element gives an integrand or degree <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{2}+2=8$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq58.gif"/></alternatives></inline-formula> in <italic>α</italic> and <italic>β</italic>, where the Jacobian adds two extra powers. The same polynomial on a cubic element gives an integrand of degree <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{3}+4=13$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq59.gif"/></alternatives></inline-formula>. However, it is quite unnecessary to match the order of the quadrature algorithm to the resulting total degree of the polynomial in the reference space because the truncation error decreases at the rate imposed by the quadrature scheme alone. The magnitude of error depends on the details of the coordinate mapping, but the order of convergence does not.</p></sec></sec><sec id="Sec11"><title>Conservative reconstruction on a geodesic mesh</title><p id="Par39">The TGM framework presented here is intended to be used primarily with finite volume schemes for systems of PDEs. These methods usually operate on conserved (extrinsic) physical variables associated with each zone in the mesh. Conserved variables are advanced in time using the fluxes evaluated at the zone boundaries. The fluxes may be generated by means of a Riemann solver that computes, often approximately, the self-similar wave pattern developed from an interaction of two or more constant states. The Riemann solver may be invoked for a set of points in each face, and the total flux is evaluated as the average over these points. The invocation of multiple Riemann solvers at suitably placed quadrature points within each face of the mesh contributes to the high order accuracy of the scheme.</p><p id="Par40">The constant states fed to the Riemann solver are obtained via high-order spatial reconstruction of the conserved variables, which amounts to finding a functional form of the variable within each zone consistent with a given piecewise distribution at the beginning of the time step. Reconstruction is performed on a set of stencils associated with each zone (the principal zone of that stencil) that include zones in a certain proximity to the principal. We use conservative polynomial reconstruction (known in one-dimensional or directionally split applications as reconstruction via primitive functions) from multiple stencils for each computational zone.</p><sec id="Sec12"><title>Stencil construction</title><p id="Par41">We now discuss the reconstruction strategy focusing on the TGM specific issues. At the start of a simulation a set of stencils is built for each computational zone. The number of zones in a stencil cannot be smaller than the number of degrees of freedom in the polynomial reconstruction, given by <disp-formula id="Equ24"><label>24</label><alternatives><mml:math id="Equ24_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>6</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D(M)=\frac{(M+1)(M+2)(M+3)}{6}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ24.gif"/></alternatives></disp-formula> where <italic>M</italic> is the degree of the reconstruction polynomial. It has been argued that using the number of zones in the stencil equal to <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq60.gif"/></alternatives></inline-formula> does not always produce satisfactory results (Ollivier-Gooch and Van Altena <xref ref-type="bibr" rid="CR50">2002</xref>). For this reason we use over-determined stencils that are larger than the minimal size. With such stencils the conservative property of the reconstruction is enforced in the least squares sense.</p><p id="Par42">The zones in the TGM are arranged in a regular pattern (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>) allowing us to design universal stencils valid on any mesh. The zones in a stencil are arranged in “planes” that correspond to different radial shells. Each plane consists of a two-dimensional t-face stencil. The principal plane contains the largest 2D stencil and the other planes contain progressively smaller stencils. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the choice of 2D stencils available in the code. In addition to the symmetric central stencil that is used in regions where the solution is smooth (top row of Fig. <xref rid="Fig9" ref-type="fig">9</xref>), twelve directional stencils are defined to be used in situations where the central stencil produces a large variation due to a sharp gradient or discontinuity in the solution (Käser and Iske <xref ref-type="bibr" rid="CR43">2005</xref>). Directional stencils can point in the in- or outward radial direction and along six directions in a plane (three forward-biased and three backward-biased, see Käser and Iske (<xref ref-type="bibr" rid="CR43">2005</xref>) for the explanation of these terms). We use three, five, and seven planes per central stencil and two, three, and four planes per directional stencil for <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M=1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq61.gif"/></alternatives></inline-formula>, 2, and 3, respectively. The code can use all thirteen stencils, but can also be run without backward stencils which nearly halves the execution time of the reconstruction step. <fig id="Fig9"><label>Figure 9</label><caption xml:lang="en"><p>Stencil shapes in the plane. The top, middle, and bottom rows show the central, forward-biased, and backward-biased stencils, respectively. The principal zone is shown in red. Green, blue, and purple colors represent first, second, and third von Neumann neighbors of the principal zone, respectively</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig9_HTML.png"/></fig></p><p id="Par43">Contrary to the fully unstructured meshes, stencils on the TGM can be generated using pre-defined patterns and in principle need not rely on mesh connectivity information. The exception to this rule are the penta-corners, where some of the neighbors may be missing. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows some examples of stencils in the principal plane that could be used for third order polynomial reconstruction. The central stencil, shown in the top panel, clearly contains a penta-corner. The middle row shows the forward and the bottom row the backward stencils. Notice how the first of the backward stencils has a different shape than the other two. If a stencil is found to be defective (i.e., contains fewer zones than required), the software will repeatedly upgrade to the next largest stencil until the order condition is fulfilled. <fig id="Fig10"><label>Figure 10</label><caption xml:lang="en"><p>Stencils of one selected face at division four near a penta-corner. Shown are the central stencil (top), the forward stencils (middle row) and the backward stencils (bottom row). The principal face is drawn with thick lines. Because of the penta-corner to the right of the principal face, some of the stencils have a different shape</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig10_HTML.png"/></fig></p><p id="Par44">Consider a conservative mesh variable <bold>U</bold> defined via its averages over each zone <italic>i</italic>, <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar{\mathbf{U}}_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq62.gif"/></alternatives></inline-formula>. A reconstruction of this variable in zone <italic>i</italic> using <italic>M</italic>th degree polynomials can be written as <disp-formula id="Equ25"><label>25</label><alternatives><mml:math id="Equ25_Math"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{U}_{i}(\mathbf{x})=\sum_{ \vert \alpha \vert =0}^{D(M)-1} \mathbf{U}_{i}^{\alpha } \bigl(x^{\alpha }-\bigl\langle x^{\alpha }\bigr\rangle _{i} \bigr), $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ25.gif"/></alternatives></disp-formula> where multi-index notation is used with <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha =(\alpha _{1},\alpha _{2},\alpha _{3})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq63.gif"/></alternatives></inline-formula>, <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vert \alpha \vert =\alpha _{1}+\alpha _{2}+\alpha _{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq64.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mn>3</mml:mn><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msubsup></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x^{\alpha }=x_{1}^{\alpha _{1}}x_{2}^{\alpha _{2}}x_{3}^{\alpha _{3}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq65.gif"/></alternatives></inline-formula>. The term <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:msub><mml:mrow><mml:mo stretchy="false">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo stretchy="false">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle x^{\alpha }\rangle _{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq66.gif"/></alternatives></inline-formula> denotes the moment of zone <italic>i</italic>, divided by the volume of the zone, and <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msubsup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{U}_{i}^{\alpha }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq67.gif"/></alternatives></inline-formula> is the coefficient (or mode) in the reconstruction. To enforce the conservation property <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msub><mml:mrow><mml:mo stretchy="false">〈</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle \mathbf{U}(\mathbf{x})\rangle _{i}=\mathbf{U}^{(0,0,0)}_{i}= \bar{\mathbf{U}}_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq68.gif"/></alternatives></inline-formula> one must formally set <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:msub><mml:mrow><mml:mo stretchy="false">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle x^{(0,0,0)}\rangle _{i}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq69.gif"/></alternatives></inline-formula> in (<xref rid="Equ25" ref-type="disp-formula">25</xref>). The remaining moments are computed using high order quadratures given by Eq. (<xref rid="Equ23" ref-type="disp-formula">23</xref>). The moments are computed in Cartesian coordinates. These moments are transformed into the center of mass frame of the zone using the parallel axis theorem (for details, see Balsara et al. <xref ref-type="bibr" rid="CR6">2019</xref>) and scaled by the characteristic length determined by the dimensions of the zone.</p><p id="Par45">An optimal choice of stencils should achieve a balance between accuracy and performance. To find this balance we have performed a statistical study of error in the reconstruction with cubic polynomials (i.e., at fourth order of accuracy) using only the central stencil, as a function of the number of zones in the stencil. The results, presented in Appendix <xref rid="Sec25" ref-type="sec">B</xref>, demonstrated that where as the <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq70.gif"/></alternatives></inline-formula> error can become unacceptably large for the minimal stencil, the deficiency is cured by increasing the stencil size by as little as 15%. Past this point, both the <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq71.gif"/></alternatives></inline-formula> and the maximum errors have a weak increasing trend previously noted in Ivan et al. (<xref ref-type="bibr" rid="CR40">2015</xref>). Based on these results, we introduced an adjustable parameter in the code to set the minimum number of zones in the stencil to be slightly larger than <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq72.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec13"><title>Utilizing radial similarity</title><p id="Par46">A spherical mesh commonly has shell thickness varying with radial distance to satisfy the needs of the particular computational problem. Let us introduce a dimensionless variable <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mi>χ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\chi \in [0,1]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq73.gif"/></alternatives></inline-formula> and a mapping <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>χ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r(\chi )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq74.gif"/></alternatives></inline-formula> that satisfies <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r(0)=r_{\mathrm{min}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq75.gif"/></alternatives></inline-formula>, <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r(1)=r_{\mathrm{max}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq76.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{min}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{max}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq78.gif"/></alternatives></inline-formula> are the inner and the outer boundaries of the entire simulation domain, not including the ghost shells. One example of such a mapping is a power law <disp-formula id="Equ26"><label>26</label><alternatives><mml:math id="Equ26_Math"><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>χ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">{</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">[</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">]</mml:mo></mml:mrow><mml:mi>χ</mml:mi><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">}</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r(\chi )=r_{\mathrm{min}} \biggl\lbrace 1+ \biggl[ \biggl( \frac{r_{\mathrm{max}}}{r_{\mathrm{min}}} \biggr)^{1/b}-1 \biggr]\chi \biggr\rbrace ^{b}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ26.gif"/></alternatives></disp-formula> where <italic>b</italic> is some positive real number. The interior of the simulation domain is partitioned into <italic>L</italic> shells of equal width <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \chi =L^{-1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq79.gif"/></alternatives></inline-formula> that map physical shells of variable widths <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta r(r)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq80.gif"/></alternatives></inline-formula>. Suppose the zone <italic>i</italic> is indexed by shell <italic>s</italic> and face <italic>f</italic>. In physical coordinates the zones corresponding to the same <italic>f</italic> but different <italic>s</italic> have different aspect ratios. For example, for the mapping (<xref rid="Equ26" ref-type="disp-formula">26</xref>) the zones closer to the origin will be more radially elongated than those at larger distances (for <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b&gt;1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq81.gif"/></alternatives></inline-formula>).</p><p id="Par47">One particular function of <italic>χ</italic> preserves the zone aspect ratio, such that <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">const</mml:mi></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta r/r=\mathrm{const}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq82.gif"/></alternatives></inline-formula>. This is the exponential mapping, <disp-formula id="Equ27"><label>27</label><alternatives><mml:math id="Equ27_Math"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>χ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mi>χ</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r'(\chi )=r_{\mathrm{min}} \biggl(\frac{r_{\mathrm{max}}}{r_{\mathrm{min}}} \biggr)^{\chi }, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ27.gif"/></alternatives></disp-formula> (e.g., Koldoba et al. <xref ref-type="bibr" rid="CR44">2002</xref>), that also satisfies <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r'(0)=r_{\mathrm{min}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq83.gif"/></alternatives></inline-formula>, <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r'(1)=r_{\mathrm{max}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq84.gif"/></alternatives></inline-formula>. One can then introduce exponential coordinates given by <disp-formula id="Equ28"><label>28</label><alternatives><mml:math id="Equ28_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mi>x</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msubsup><mml:mi>x</mml:mi><mml:mn>2</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mi>x</mml:mi><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msubsup><mml:mi>x</mml:mi><mml:mn>3</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x_{1}'=r' x^{u}_{1}, \quad\quad x_{2}'=r' x^{u}_{2}, \quad\quad x_{3}'=r' x^{u}_{3}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ28.gif"/></alternatives></disp-formula> where, as before, the coordinates with the superscript ‘<italic>u</italic>’ are measured on the unit sphere.</p><p id="Par48">A conserved mesh variable <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{U}(\mathbf{x})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq85.gif"/></alternatives></inline-formula> is defined via <disp-formula id="Equ29"><label>29</label><alternatives><mml:math id="Equ29_Math"><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \int _{(i)}\mathbf{U}(\mathbf{x})r^{2} \,dr \,d \varOmega =\bar{\mathbf{U}}_{i}V_{i}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ29.gif"/></alternatives></disp-formula> Integration over the solid angle <italic>Ω</italic> corresponds to integration on the unit sphere. Equation (<xref rid="Equ29" ref-type="disp-formula">29</xref>) can be rewritten in exponential coordinates as <disp-formula id="Equ30"><label>30</label><alternatives><mml:math id="Equ30_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>χ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>Ω</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>Ω</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>ln</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{aligned}[b] &amp; \int _{(i)}\mathbf{U}(\mathbf{x})\frac{r^{2}}{r^{\prime 3}} \frac{dr}{d\chi }r^{\prime 2}\,dr'\,d \varOmega \\ &amp;\quad = \frac{\varOmega _{f}(r_{s+1}^{3}-r_{s}^{3})}{3}\ln \biggl( \frac{r_{\mathrm{max}}}{r_{\mathrm{min}}} \biggr)\bar{\mathbf{U}}_{i}, \end{aligned} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ30.gif"/></alternatives></disp-formula> where <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msub><mml:mi>Ω</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varOmega _{f}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq86.gif"/></alternatives></inline-formula> is the area of face <italic>f</italic> on the unit sphere. We next introduce a three-dimensional polynomial reconstruction of the quantity <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>χ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{W}=\mathbf{U}r^{2}/r^{\prime 3}(dr/d\chi )$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq87.gif"/></alternatives></inline-formula> in the zone <italic>i</italic><disp-formula id="Equ31"><label>31</label><alternatives><mml:math id="Equ31_Math"><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>s</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{W}_{i}(\tilde{\mathbf{x}}_{s})=\sum _{ \vert \alpha \vert =0}^{D(M)-1} \mathbf{W}_{i}^{\alpha } \bigl(\tilde{x}_{s}^{\alpha }-\bigl\langle \tilde{x}^{\alpha } \bigr\rangle _{f} \bigr), $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ31.gif"/></alternatives></disp-formula> where <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{\mathbf{x}}_{s}=\mathbf{x}'/r'_{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq88.gif"/></alternatives></inline-formula> is the position vector expressed in the exponential normalized coordinates (ENC). Here they are normalized to the exponential distance to the bottom of the zone. The moments of any zone with a face index <italic>f</italic> are <disp-formula id="Equ32"><label>32</label><alternatives><mml:math id="Equ32_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo stretchy="false">〈</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">〉</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:msub><mml:mi>Ω</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{aligned}[b] \langle \cdots\rangle _{f} &amp; = \frac{3}{\varOmega _{f}[(1+\Delta \tilde{r})^{3}-1)]} \\&amp;\quad{}\times \int _{1}^{1+\Delta \tilde{r}}\tilde{r}^{2}\,d\tilde{r} \int _{(f)}(\cdots)\,d\varOmega , \end{aligned} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ32.gif"/></alternatives></disp-formula> where <disp-formula id="Equ33"><label>33</label><alternatives><mml:math id="Equ33_Math"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Delta \tilde{r}=\frac{r'_{s+1}-r'_{s}}{r'_{s}}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ33.gif"/></alternatives></disp-formula> which is the same for all shells <italic>s</italic>. In the ENC the moments are independent of the shell, so the index <italic>s</italic> is dropped for them. It is evident that <disp-formula id="Equ34"><label>34</label><alternatives><mml:math id="Equ34_Math"><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{W}^{(0,0,0)}_{i}= \frac{r_{s+1}^{3}-r_{s}^{3}}{{r'}_{s}^{3}[(1+\Delta \tilde{r})^{3}-1)]} \ln \biggl( \frac{r_{\mathrm{max}}}{r_{\mathrm{min}}} \biggr) \bar{\mathbf{U}}_{i}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ34.gif"/></alternatives></disp-formula> To obtain the remaining modes a geometry matrix is computed for each three-dimensional stencil. Suppose <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq89.gif"/></alternatives></inline-formula> denotes the set of zones comprising the stencil, and that the zone <italic>j</italic> that belongs to this stencil, <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in S_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq90.gif"/></alternatives></inline-formula>, <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\neq i$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq91.gif"/></alternatives></inline-formula> is indexed by shell <italic>σ</italic> and face <italic>ϕ</italic>. Using the fact that <disp-formula id="Equ35"><label>35</label><alternatives><mml:math id="Equ35_Math"><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>s</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msubsup><mml:mi>r</mml:mi><mml:mi>σ</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>σ</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{x}_{s}^{\alpha }= \biggl(\frac{r'_{\sigma }}{r'_{s}} \biggr)^{ \vert \alpha \vert }\tilde{x}_{\sigma }^{\alpha }, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ35.gif"/></alternatives></disp-formula> averaging (<xref rid="Equ31" ref-type="disp-formula">31</xref>) over a given zone in the stencil, which uses the ENC specific for its own shell <italic>σ</italic>, rather than the principal shell <italic>s</italic>, yields <disp-formula id="Equ36"><label>36</label><alternatives><mml:math id="Equ36_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd/><mml:mtd><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{aligned}[b] &amp; \sum_{ \vert \alpha \vert =0}^{D(M)-1}\mathbf{W}_{i}^{\alpha } \bigl[(1+ \Delta \tilde{r})^{ \vert \alpha \vert (\sigma -s)}\bigl\langle \tilde{x}^{\alpha } \bigr\rangle _{\phi }-\bigl\langle \tilde{x}^{\alpha }\bigr\rangle _{f} \bigr] \\ &amp;\quad = \mathbf{W}_{j}^{(0,0,0)}- \mathbf{W}_{i}^{(0,0,0)}. \end{aligned} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ36.gif"/></alternatives></disp-formula> This is a linear system for <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msubsup></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{W}_{i}^{\alpha }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq92.gif"/></alternatives></inline-formula>. The geometry matrix on the LHS has the number of rows equal to the number of zones in the stencil, without counting the principal zone, and its column count is <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)-1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq93.gif"/></alternatives></inline-formula>. The geometry matrix’s coefficients only depend on the relative shell displacement in the stencil, <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma -s$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq94.gif"/></alternatives></inline-formula>, and are identical for any zone with the same face index because the corresponding stencils all have the same structure.</p><p id="Par49">The advantage of the described scheme is that the amount of storage is significantly reduced (by the factor equal to the number of shells in the block) compared with the method that treats each zone as unique. Only a single copy of each moment and the geometry matrix are needed per t-face. This also permits us to precompute the LU decomposition or inverse of each geometry matrix and store it to perform reconstruction with a different RHS in (<xref rid="Equ36" ref-type="disp-formula">36</xref>) at each time step. The physical variable is then recovered via <disp-formula id="Equ37"><label>37</label><alternatives><mml:math id="Equ37_Math"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>χ</mml:mi></mml:mrow></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{U}_{i}(\mathbf{x})=\mathbf{W}_{i}(\tilde{ \mathbf{x}}_{s}) \frac{{r'}^{3}}{r^{2}} \biggl(\frac{dr}{d\chi } \biggr)^{-1}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ37.gif"/></alternatives></disp-formula></p></sec><sec id="Sec14"><title>Limiting the reconstruction</title><p id="Par50">The code performs reconstruction on all thirteen (or seven) stencils and stores the resulting modes for each stencil. The solutions from multiple stencils are combined in a nonlinear fashion into a single reconstruction polynomial using the weighted essentially non-oscillatory (WENO) method (Harten and Osher <xref ref-type="bibr" rid="CR36">1987</xref>; Shu and Osher <xref ref-type="bibr" rid="CR58">1988</xref>; Liu et al. <xref ref-type="bibr" rid="CR46">1994</xref>; Jiang and Shu <xref ref-type="bibr" rid="CR41">1995</xref>; Friedrich <xref ref-type="bibr" rid="CR29">1998</xref>; Balsara and Shu <xref ref-type="bibr" rid="CR10">2000</xref>; Dumbser and Käser <xref ref-type="bibr" rid="CR22">2007</xref>). The nonlinear hybridization helps to stabilize the WENO scheme when local discontinuities develop in the flow.</p><p id="Par51">Suppose there are <italic>S</italic> stencils associated with face <italic>i</italic>, with the central stencil bearing the index 1, and the directional stencils numbered 2 through <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>13</mml:mn></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S=7,13$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq95.gif"/></alternatives></inline-formula>. The central stencil is the most accurate and therefore carries the largest linear weight, <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.85</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{1}=\in [0.85,0.95]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq96.gif"/></alternatives></inline-formula>, where as the remaining stencils have <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{s}=(1-\gamma _{1})/(S-1)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq97.gif"/></alternatives></inline-formula>. Suppose we need to perform a reconstruction of a scalar variable <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$U(\mathbf{x})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq98.gif"/></alternatives></inline-formula>. The WENO procedure computes a weighted average of the reconstruction polynomials derived on each of the stencils with preference given to stencils achieving a smoother reconstruction (roughly speaking, having smaller absolute values of the modes <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$U^{\alpha }_{is}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq99.gif"/></alternatives></inline-formula> where <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vert \alpha \vert &gt;0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq100.gif"/></alternatives></inline-formula> and <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s=1,\ldots,S$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq101.gif"/></alternatives></inline-formula>). The scheme is biased by the smoothness indicators that can be estimated simply as <disp-formula id="Equ38"><label>38</label><alternatives><mml:math id="Equ38_Math"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>α</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \beta _{is}=\sum_{\alpha } \bigl(U_{is}^{\alpha }\bigr)^{2}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ38.gif"/></alternatives></disp-formula></p><p id="Par52">We have implemented plain second and third order WENO schemes and an adaptive order WENO-AO(4,3) scheme within the TGM framework. The plain WENO procedure computes the nonlinear weights as <disp-formula id="Equ39"><label>39</label><alternatives><mml:math id="Equ39_Math"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>,</mml:mo></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ w_{is}=\frac{\gamma _{s}}{(\beta _{is}+\epsilon )^{2}}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ39.gif"/></alternatives></disp-formula> where <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\epsilon \sim 10^{-12}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq102.gif"/></alternatives></inline-formula> is used to avoid possible division by zero. The weights are then normalized so that they add up to unity. The normalized weights are obtained as <disp-formula id="Equ40"><label>40</label><alternatives><mml:math id="Equ40_Math"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{w}_{is}=\frac{w_{is}}{\sum_{s=1}^{S} w_{is}}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ40.gif"/></alternatives></disp-formula> The coefficients of the hybrid reconstruction polynomial are computed as <disp-formula id="Equ41"><label>41</label><alternatives><mml:math id="Equ41_Math"><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>WENO</mml:mtext></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ U^{\alpha }_{i, \text{WENO}}=\sum_{s=1}^{S} \bar{w}_{is}U^{\alpha }_{is}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ41.gif"/></alternatives></disp-formula></p><p id="Par53">At fourth order of accuracy we have used an adaptive order method to avoid the excessive computational cost of performing high order reconstruction on all thirteen stencils. The WENO-AO method has been described in great detail in Balsara et al. (<xref ref-type="bibr" rid="CR8">2016</xref>), while its implementation on unstructured meshes was presented in Balsara et al. (<xref ref-type="bibr" rid="CR6">2019</xref>, <xref ref-type="bibr" rid="CR7">2020</xref>). Here we only discuss some specifics of its implementation on the geodesic mesh. The WENO-AO(4,3) method uses, in addition to the set of stencils used to perform third-order reconstruction, a large central stencil that we assign the index of 0 to avoid relabeling of the third-order stencils. This large stencil is used to perform reconstruction of polynomial degree 3 and carries the linear weight <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.85</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{0}=\in [0.85,0.95]$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq103.gif"/></alternatives></inline-formula>. For example, the third order central stencil may be the stencil shown in the fourth or fifth column of Fig. <xref rid="Fig9" ref-type="fig">9</xref>, while the fourth-order stencil will be from column seven or eight of that figure. The linear weights <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma '_{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq104.gif"/></alternatives></inline-formula> of the adaptive order scheme are given by <disp-formula id="Equ42"><label>42</label><alternatives><mml:math id="Equ42_Math"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>γ</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mi>γ</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{gathered} \gamma '_{0}=\gamma _{0},\quad\quad \gamma '_{1}=(1-\gamma _{0})\gamma _{1}, \\ \gamma '_{s}=\frac{(1-\gamma _{0})(1-\gamma _{1})}{S-1}, \quad s=2, \ldots,S \end{gathered} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ42.gif"/></alternatives></disp-formula> (note that the number of stencils used in this case is <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S+1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq105.gif"/></alternatives></inline-formula>). The smoothness indicators and nonlinear weights are obtained according to (<xref rid="Equ38" ref-type="disp-formula">38</xref>) and (<xref rid="Equ39" ref-type="disp-formula">39</xref>), respectively using <inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma '_{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq106.gif"/></alternatives></inline-formula> in place of <inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq107.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s=0,\ldots,S$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq108.gif"/></alternatives></inline-formula>. The normalized nonlinear weights are given by <disp-formula id="Equ43"><label>43</label><alternatives><mml:math id="Equ43_Math"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{w}_{is}=\frac{w_{is}}{\sum_{s=0}^{S} w_{is}}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ43.gif"/></alternatives></disp-formula> The coefficients of the hybrid reconstruction polynomial in the adaptive case are computed as <disp-formula id="Equ44"><label>44</label><alternatives><mml:math id="Equ44_Math"><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>WENO-AO</mml:mtext></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>γ</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfrac><mml:mrow><mml:mo maxsize="6.6ex" minsize="6.6ex" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo maxsize="6.6ex" minsize="6.6ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ U^{\alpha }_{i, \text{WENO-AO}}=\frac{\bar{w}_{i0}}{\gamma '_{0}} \Biggl(U^{\alpha }_{i0}- \sum_{s=1}^{S}\gamma '_{s} U^{\alpha }_{is} \Biggr)+\sum_{s=1}^{S} \bar{w}_{is}U^{\alpha }_{is}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ44.gif"/></alternatives></disp-formula> Expression (<xref rid="Equ44" ref-type="disp-formula">44</xref>) reduces to <inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$U^{\alpha }_{i0}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq109.gif"/></alternatives></inline-formula> in the limit that the solution is smooth on all stencils and therefore <inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar{w}_{is}\to \gamma '_{s}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq110.gif"/></alternatives></inline-formula>. This choice yields the most accurate reconstruction because it is based entirely on the large central stencil.</p><p id="Par54">The reconstruction procedure is carried out in each zone lying in the interior of the block and in two more layers of ghost zones. The latter is needed by the slope flattening procedure that scales down the reconstruction coefficients within the zones lying near strong density enhancements. The stencils shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref> extend a distance equal to the degree of the reconstruction polynomial beyond the principal zone. As a result we use three layers of ghost zones at second order of accuracy, four at third order and five at fourth order.</p></sec></sec><sec id="Sec15"><title>Constrained reconstruction of the magnetic field</title><p id="Par55">For MHD problems, it is essential to keep the magnetic field divergence free. The most successful technique to maintain <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\nabla \cdot \mathbf{B}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq111.gif"/></alternatives></inline-formula> is the constrained transport method (Evans and Hawley <xref ref-type="bibr" rid="CR25">1988</xref>; DeVore <xref ref-type="bibr" rid="CR17">1991</xref>; Ryu et al. <xref ref-type="bibr" rid="CR56">1998</xref>; Balsara and Spicer <xref ref-type="bibr" rid="CR11">1999</xref>) that is based on the Yee type staggered mesh. In this approach the magnetic field is a face based variable, unlike the zone averaged mass, momentum, and total energy conserved variables. More specifically, the variable is a normally projected, face averaged value of the magnetic field that will be called <italic>B̄</italic>, possibly with a subscript of the face where it is defined. This magnetic field is initialized using the vector potential <disp-formula id="Equ45"><label>45</label><alternatives><mml:math id="Equ45_Math"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{B}=\nabla \times \mathbf{A}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ45.gif"/></alternatives></disp-formula> and is updated in time via Faraday’s law, <disp-formula id="Equ46"><label>46</label><alternatives><mml:math id="Equ46_Math"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mo>,</mml:mo></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{\partial \mathbf{B}}{\partial t}=-\nabla \times \mathbf{E}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ46.gif"/></alternatives></disp-formula> where <bold>E</bold> is the electric field and SI units are used. Integrating equations (<xref rid="Equ45" ref-type="disp-formula">45</xref>) and (<xref rid="Equ46" ref-type="disp-formula">46</xref>) requires edge based vector potential and electric field, respectively, in applying the Stokes theorem.</p><p id="Par56">Let us focus on a single zone with index <italic>i</italic> in the mesh. Denote by <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq112.gif"/></alternatives></inline-formula> the set of faces that belong to this zone. The set can be further partitioned into three r-faces (set <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$R_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq113.gif"/></alternatives></inline-formula>) and two t-faces (set <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq114.gif"/></alternatives></inline-formula>). By convention, the normals <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">n</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat{\mathbf{n}}_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq115.gif"/></alternatives></inline-formula> for <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in R_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq116.gif"/></alternatives></inline-formula> are directed outward as viewed from a zone corresponding to an unshaded t-face (and hence inward as viewed from a shaded face, see Fig. <xref rid="Fig3" ref-type="fig">3</xref>), where as the normals for <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in T_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq117.gif"/></alternatives></inline-formula> always point in the outward direction (direction of increasing <italic>r</italic>). Further, suppose <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq118.gif"/></alternatives></inline-formula> is the set of edges that comprise the boundary of face <italic>j</italic>. For <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in R_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq119.gif"/></alternatives></inline-formula>, the boundary consists of two t-edges and two r-edges; while faces <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in T_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq120.gif"/></alternatives></inline-formula> have three t-edges. The tangent vectors to the t-edges are assumed to be directed counter-clockwise relative to the unshaded face while the r-edge tangents point outward.</p><p id="Par57">Using the above conventions, the face-based magnetic field initialization procedure is written as <disp-formula id="Equ47"><label>47</label><alternatives><mml:math id="Equ47_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∬</mml:mo><mml:mrow><mml:mtext>face </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mtext>edge </mml:mtext><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dl</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{B}_{j}S_{j}= \iint _{\text{face }j}\mathbf{B}\cdot \mathbf{dS}=\sum _{k\in E_{j}} \int _{\text{edge }k}\mathbf{A} \cdot \mathbf{dl}=\sum _{k\in E_{j}}\bar{A}_{k} l_{k}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ47.gif"/></alternatives></disp-formula> where <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq121.gif"/></alternatives></inline-formula> is the area of face <italic>j</italic>, <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$l_{k}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq122.gif"/></alternatives></inline-formula> is the length of the edge <italic>k</italic>, and <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar{A}_{k}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq123.gif"/></alternatives></inline-formula> is the average over the edge <italic>k</italic> of the vector potential dotted with the tangent vector to that edge. The line integral in (<xref rid="Equ47" ref-type="disp-formula">47</xref>) is evaluated using formulae (<xref rid="Equ16" ref-type="disp-formula">16</xref>) and (<xref rid="Equ18" ref-type="disp-formula">18</xref>). In addition, the integral divergence free condition for <inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:mi mathvariant="script">D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">B</mml:mi></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal{D}=\nabla \cdot \mathbf{B}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq124.gif"/></alternatives></inline-formula> may be written as <disp-formula id="Equ48"><label>48</label><alternatives><mml:math id="Equ48_Math"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mo>∬</mml:mo><mml:mrow><mml:mtext>face </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{\mathcal{D}}_{i}V_{i}=\sum _{j\in F_{i}} \iint _{ \text{face }j}\mathbf{B}\cdot \mathbf{dS}=\sum _{j\in F_{i}}\bar{B}_{j} S_{j}=0, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ48.gif"/></alternatives></disp-formula> where <inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$V_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq125.gif"/></alternatives></inline-formula> is the volume of zone <italic>i</italic>. In practice, the numerical code defines variables of zone, face, and edge types and the curl and divergence integral operations to perform “conversions” between the types.</p><p id="Par58">Following Balsara and Dumbser (<xref ref-type="bibr" rid="CR4">2015a</xref>) the model presented here uses a supplementary zone based vector variable <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq126.gif"/></alternatives></inline-formula>. At the start of the simulation, this variable must be initialized in each zone <italic>i</italic> in some way consistent with the primary field <italic>B̄</italic> defined on <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq127.gif"/></alternatives></inline-formula>. One possibility is to use the least squares fit <disp-formula id="Equ49"><label>49</label><alternatives><mml:math id="Equ49_Math"><mml:msub><mml:mo>∬</mml:mo><mml:mrow><mml:mtext>face </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">dS</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \iint _{\text{face }j}\mathbf{B}'_{i}\cdot \mathbf{dS}= \bar{B}_{j} S_{j}, \quad j\in F_{i}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ49.gif"/></alternatives></disp-formula> The integral in the above equation is evaluated using (<xref rid="Equ20" ref-type="disp-formula">20</xref>) and (<xref rid="Equ21" ref-type="disp-formula">21</xref>), giving five equations (one per face) for the three unknown field components. The alternative is to initialize <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq128.gif"/></alternatives></inline-formula> directly as a zone variable using the expression for the field rather than the potential. The resulting <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq129.gif"/></alternatives></inline-formula> is subsequently treated like any other zone variable. In particular, it is subjected to the same volume reconstruction procedure described in the previous section. This reconstruction is not functionally divergence free, and an additional procedure, described below, is applied to obtain a constrained reconstruction. This approach represents a low computational cost alternative to a face based reconstruction.</p><p id="Par59">Suppose the preliminary, non-divergence-free reconstruction, computed as discussed in the previous section, is given by <disp-formula id="Equ50"><label>50</label><alternatives><mml:math id="Equ50_Math"><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{B}'_{i}(\mathbf{x})=\sum _{ \vert \alpha \vert =0}^{D(M)-1} \mathbf{B}_{i}^{\prime \alpha } \bigl(x^{\alpha }-\bigl\langle x^{\alpha }\bigr\rangle _{i} \bigr), $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ50.gif"/></alternatives></disp-formula> where <inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}_{i}^{\prime \alpha }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq130.gif"/></alternatives></inline-formula> are the modes. We seek a constrained polynomial reconstruction for the magnetic field <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{\mathbf{B}}(\mathbf{r})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq131.gif"/></alternatives></inline-formula> as <disp-formula id="Equ51"><label>51</label><alternatives><mml:math id="Equ51_Math"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \tilde{B}_{1i}(\mathbf{x})=\sum_{ \substack{ \vert \alpha \vert =0 \\ \alpha _{2},\alpha _{3}\leq M}}^{D(M+1)-1} \tilde{B}_{1i}^{\alpha } \bigl(x^{\alpha }-\bigl\langle x^{\alpha }\bigr\rangle _{i} \bigr), \\&amp; \tilde{B}_{2i}(\mathbf{x})=\sum_{ \substack{ \vert \alpha \vert =0 \\ \alpha _{1},\alpha _{3}\leq M}}^{D(M+1)-1} \tilde{B}_{2i}^{\alpha } \bigl(x^{\alpha }-\bigl\langle x^{\alpha }\bigr\rangle _{i} \bigr), \\&amp; \tilde{B}_{3i}(\mathbf{x})=\sum_{ \substack{ \vert \alpha \vert =0 \\ \alpha _{1},\alpha _{2}\leq M}}^{D(M+1)-1} \tilde{B}_{3i}^{\alpha } \bigl(x^{\alpha }-\bigl\langle x^{\alpha }\bigr\rangle _{i} \bigr). \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ51.gif"/></alternatives></disp-formula> These reconstructions have <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{D}(M)=2D(M)-D(M-1)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq132.gif"/></alternatives></inline-formula> degree of freedoms, which is larger than <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq133.gif"/></alternatives></inline-formula>. While the degree of the reconstruction polynomials (<xref rid="Equ51" ref-type="disp-formula">51</xref>) is one higher than of (<xref rid="Equ50" ref-type="disp-formula">50</xref>), not every additional high order mode is present. The need for the extra modes will be demonstrated shortly. We now describe the five separate constraints imposed on the magnetic field modes that ensure that the magnetic field remains divergence-free not only in the integral sense (zero total flux through all faces of a zone), but also functionally at any location within the zone.</p><sec id="Sec16"><title>Constraint 1</title><p id="Par60">This step ensures that the polynomial reconstruction of the magnetic field has zero divergence everywhere in the zone. Taking the divergence of Eq. (<xref rid="Equ51" ref-type="disp-formula">51</xref>) and making the resulting polynomial expression equal to zero yields <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq134.gif"/></alternatives></inline-formula> equations of the form <disp-formula id="Equ52"><label>52</label><alternatives><mml:math id="Equ52_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha _{1}\tilde{B}_{1i}^{\alpha _{1}}+\alpha _{2}\tilde{B}_{2i}^{ \alpha _{2}}+\alpha _{3} \tilde{B}_{3i}^{\alpha _{3}}=0. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ52.gif"/></alternatives></disp-formula> Clearly, <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq135.gif"/></alternatives></inline-formula>, <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq136.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq137.gif"/></alternatives></inline-formula> modes with <inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{1}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq138.gif"/></alternatives></inline-formula>, <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{2}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq139.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{3}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq140.gif"/></alternatives></inline-formula>, respectively, do not contribute to (<xref rid="Equ52" ref-type="disp-formula">52</xref>). Only the extra modes that contain powers of <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq141.gif"/></alternatives></inline-formula> for <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq142.gif"/></alternatives></inline-formula>, <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq143.gif"/></alternatives></inline-formula> for <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq144.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq145.gif"/></alternatives></inline-formula> for <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{B}_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq146.gif"/></alternatives></inline-formula> are included. For instance, at third order of accuracy (<inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M=2$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq147.gif"/></alternatives></inline-formula>) the extra modes present in the first equation of (<xref rid="Equ51" ref-type="disp-formula">51</xref>) are those containing <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1}^{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq148.gif"/></alternatives></inline-formula>, <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1}^{2} x_{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq149.gif"/></alternatives></inline-formula>, <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1}^{2} x_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq150.gif"/></alternatives></inline-formula>, <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1} x_{2}^{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq151.gif"/></alternatives></inline-formula>, <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1} x_{2} x_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq152.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1} x_{3}^{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq153.gif"/></alternatives></inline-formula>, where as the second equation includes <inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1}^{2} x_{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq154.gif"/></alternatives></inline-formula>, <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1} x_{2}^{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq155.gif"/></alternatives></inline-formula>, <inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{1} x_{2} x_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq156.gif"/></alternatives></inline-formula>, <inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{2}^{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq157.gif"/></alternatives></inline-formula>, <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{2}^{2} x_{3}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq158.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{2} x_{3}^{2}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq159.gif"/></alternatives></inline-formula> terms. The remaining high order modes do not contribute to the local divergence-free conditions.</p></sec><sec id="Sec17"><title>Constraint 2</title><p id="Par61">The second constraint imposed on the reconstruction (<xref rid="Equ51" ref-type="disp-formula">51</xref>) is the requirement that its normal component, evaluated from any two adjacent zones sharing the face <italic>j</italic> and averaged over that face must be equal to <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar{B}_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq160.gif"/></alternatives></inline-formula>, namely <disp-formula id="Equ53"><label>53</label><alternatives><mml:math id="Equ53_Math"><mml:msub><mml:mo>∬</mml:mo><mml:mrow><mml:mtext>face </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \iint _{\text{face } j}(\tilde{B}_{1i}\,dS_{1}+ \tilde{B}_{2i}\,dS_{2}+ \tilde{B}_{3i} \,dS_{3})=\bar{B}_{j}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ53.gif"/></alternatives></disp-formula> where the integral is evaluated according to the rules (<xref rid="Equ20" ref-type="disp-formula">20</xref>)–(<xref rid="Equ21" ref-type="disp-formula">21</xref>). This is the requirement of zero divergence in the integral sense. The order of the quadrature rule need not be very high, but only sufficient to match the order of the overall scheme. For example, for a third order scheme that uses polynomials of up to third degree, we use six point quadratures on all faces.</p><p id="Par62">It should be pointed out that because of (<xref rid="Equ53" ref-type="disp-formula">53</xref>) one constraint in (<xref rid="Equ52" ref-type="disp-formula">52</xref>) is redundant. This is readily demonstrated by computing the divergence of <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde{\mathbf{B}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq161.gif"/></alternatives></inline-formula> (Eq. (<xref rid="Equ51" ref-type="disp-formula">51</xref>)) analytically, integrating over the volume of the zone, and setting the integral to zero. For the sake of symmetry, we chose to discard the first equation in (<xref rid="Equ52" ref-type="disp-formula">52</xref>), so that system’s equation count is reduced to <inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(M)-1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq162.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec18"><title>Constraint 3</title><p id="Par63">Balsara and Dumbser (<xref ref-type="bibr" rid="CR4">2015a</xref>) proposed a method seeking to match, at each face, complete polynomial reconstructions of the normal component of the magnetic field. Here we use a weaker requirement that the reconstructions of the normal component should approximately match at the facial quadrature points used to perform integration on that face. This procedure nonetheless ensures a very close matching of the modes of the magnetic field within each face.</p><p id="Par64">The matching procedure starts by evaluating <inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'_{i}(\mathbf{x})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq163.gif"/></alternatives></inline-formula> from (<xref rid="Equ51" ref-type="disp-formula">51</xref>) at each quadrature point of face <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in F_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq164.gif"/></alternatives></inline-formula> and projecting it onto the unit normal to the face at that point. Initially this normal component is not continuous at the zone boundaries, so there are two values of the normal component, <inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{iq}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{kq}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq166.gif"/></alternatives></inline-formula>, at each facial quadrature point <italic>q</italic> contributed by two adjacent zones <italic>i</italic> and <italic>k</italic>, where <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in F_{i},F_{k}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq167.gif"/></alternatives></inline-formula>. The common normal component at each quadrature point <italic>q</italic>, <inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{q}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq168.gif"/></alternatives></inline-formula>, is evaluated in two steps as <disp-formula id="Equ54"><label>54</label><alternatives><mml:math id="Equ54_Math"><mml:msubsup><mml:mi>B</mml:mi><mml:mi>q</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>q</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">minmod</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; B^{*}_{q}=\bar{B}_{q}+\mathrm{minmod}(B_{iq}- \bar{B}_{j},B_{kq}- \bar{B}_{j}), \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ54.gif"/></alternatives></disp-formula><disp-formula id="Equ55"><label>55</label><alternatives><mml:math id="Equ55_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>q</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〈</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo maxsize="2.4ex" minsize="2.4ex" stretchy="true">〉</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; B_{q}=B^{*}_{q}-\bigl\langle B^{*} \bigr\rangle _{j}+\bar{B}_{j}, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ55.gif"/></alternatives></disp-formula> where <inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B^{*}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq169.gif"/></alternatives></inline-formula> is the intermediate value of the common normal component of the field at the interface and the angular brackets denote its average over the face <italic>j</italic>. The normal component of the magnetic field given by (<xref rid="Equ55" ref-type="disp-formula">55</xref>) is continuous and its average over the face matches the respective value of the primary variable <inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar{B}_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq170.gif"/></alternatives></inline-formula>. Therefore, the third set of constraints can be written as <disp-formula id="Equ56"><label>56</label><alternatives><mml:math id="Equ56_Math"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{B}_{1i}(\mathbf{x}_{q})\hat{n}_{1}+ \tilde{B}_{2i}(\mathbf{x}_{q}) \hat{n}_{2}+ \tilde{B}_{3i}(\mathbf{x}_{q})\hat{n}_{3}\approx B_{q}, $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ56.gif"/></alternatives></disp-formula> for each quadrature point <italic>q</italic>, with <inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in F_{i}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq171.gif"/></alternatives></inline-formula>. The number of conditions in (<xref rid="Equ56" ref-type="disp-formula">56</xref>) is equal to the total number of quadrature points on all five faces of the frustum.</p></sec><sec id="Sec19"><title>Constraint 4</title><p id="Par65">Next, we demand that the divergence-free reconstruction (<xref rid="Equ51" ref-type="disp-formula">51</xref>) should be as close to the volume reconstruction of <inline-formula id="IEq172"><alternatives><mml:math id="IEq172_Math"><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq172_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq172.gif"/></alternatives></inline-formula> as possible, i.e., <disp-formula id="Equ57"><label>57</label><alternatives><mml:math id="Equ57_Math"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{gathered} \tilde{B}_{1i}^{\alpha }\approx B_{1i}^{\prime \alpha }, \quad \tilde{B}_{2i}^{ \alpha }\approx B_{2i}^{\prime \alpha }, \quad \tilde{B}_{3i}^{\alpha } \approx B_{3i}^{\prime \alpha }, \quad \vert \alpha \vert &lt; D(M). \end{gathered} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ57.gif"/></alternatives></disp-formula> Equation (<xref rid="Equ52" ref-type="disp-formula">52</xref>) is based on the observation that the initial (unconstrained) volume reconstruction is the best possible starting point for determining the constrained modes. With this condition the convergence order of the constrained reconstruction stays close to the order of convergence of the unconstrained volume reconstruction.</p></sec><sec id="Sec20"><title>Constraint 5</title><p id="Par66">In the same spirit it is desirable that the “extra” high order modes should be small, i.e., <disp-formula id="Equ58"><label>58</label><alternatives><mml:math id="Equ58_Math"><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≥</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{B}_{1i}^{\alpha }\approx 0,\quad\quad \tilde{B}_{2i}^{\alpha } \approx 0,\quad\quad \tilde{B}_{3i}^{\alpha }\approx 0,\quad \vert \alpha \vert \geq D(M). $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ58.gif"/></alternatives></disp-formula></p><p id="Par67">Table <xref rid="Tab4" ref-type="table">4</xref> provides the counts of the degrees of freedom and the number of equations contributed by formulae (<xref rid="Equ52" ref-type="disp-formula">52</xref>), (<xref rid="Equ53" ref-type="disp-formula">53</xref>), (<xref rid="Equ56" ref-type="disp-formula">56</xref>), (<xref rid="Equ57" ref-type="disp-formula">57</xref>), and (<xref rid="Equ58" ref-type="disp-formula">58</xref>) for schemes of second, third, and fourth orders of spatial convergence. Since there are more equations than unknowns, only the local and global divergence-free conditions (<xref rid="Equ52" ref-type="disp-formula">52</xref>) and (<xref rid="Equ53" ref-type="disp-formula">53</xref>) are strictly enforced; the remaining conditions can only be satisfied approximately, in the least squares sense (in principle, at third and fourth order of accuracy the constraints (<xref rid="Equ56" ref-type="disp-formula">56</xref>) can also be strictly imposed). This constitutes a constrained linear least square (CLSQ) problem. Figure <xref rid="Fig11" ref-type="fig">11</xref> illustrates the structure of the LLS and constraints matrices at fourth order. From Table <xref rid="Tab3" ref-type="table">3</xref>, the rank of the Karush–Kuhn–Tucker (KKT) matrix of the CLSQ problem is 29, 62, and 114 at second, third, and fourth order of accuracy. Note that despite the sparsity of the LLS and the constraint matrices, the KKT matrix is largely dense. <fig id="Fig11"><label>Figure 11</label><caption xml:lang="en"><p>Matrix structure for divergence-free reconstruction. The left panel shows the nonzero elements (marked with x’s) of the least squares matrix and the right panel shows the same for the constraint matrix for fourth order reconstruction. The corresponding KKT matrix is <inline-formula id="IEq173"><alternatives><mml:math id="IEq173_Math"><mml:mn>114</mml:mn><mml:mo>×</mml:mo><mml:mn>114</mml:mn></mml:math><tex-math id="IEq173_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$114\times 114$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq173.gif"/></alternatives></inline-formula></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig11_HTML.png"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>The number of unknowns (the “Unknowns” column) vs. the number of conditions of each type (C1 through C5) in magnetic field reconstruction</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Order</p></th><th align="left"><p><italic>D</italic>(<italic>M</italic>)</p></th><th align="left"><p><italic>D̄</italic>(<italic>M</italic>)</p></th><th><p>Unknowns</p></th><th align="left"><p>C1</p></th><th><p>C2</p></th><th><p>C3</p></th><th><p>C4</p></th><th align="left"><p>C5</p></th></tr></thead><tbody><tr><td><p>2</p></td><td><p>4</p></td><td><p>7</p></td><td><p>21</p></td><td><p>3</p></td><td><p>5</p></td><td><p>15</p></td><td><p>12</p></td><td><p>9</p></td></tr><tr><td><p>3</p></td><td><p>10</p></td><td><p>16</p></td><td><p>48</p></td><td><p>9</p></td><td><p>5</p></td><td><p>24</p></td><td><p>30</p></td><td><p>18</p></td></tr><tr><td><p>4</p></td><td><p>20</p></td><td><p>30</p></td><td><p>90</p></td><td><p>19</p></td><td><p>5</p></td><td><p>30</p></td><td><p>60</p></td><td><p>30</p></td></tr></tbody></table></table-wrap></p><p id="Par68">Based on the results of the previous section, it may be expected that only a single KKT matrix needs to be constructed and inverted per t-face. Unfortunately, the difficulty here is with the global divergence-free condition (Constraint 1), which is, in general, incompatible with the reconstruction (<xref rid="Equ31" ref-type="disp-formula">31</xref>). Coordinate factorization is still possible, but only if the mesh is directly exponentially rationed, i.e., <inline-formula id="IEq174"><alternatives><mml:math id="IEq174_Math"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq174_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r=r'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq174.gif"/></alternatives></inline-formula> and <inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold">U</mml:mi></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{W}=\ln (r_{\mathrm{max}}/r_{\mathrm{min}})\mathbf{U}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq175.gif"/></alternatives></inline-formula>. This is the mesh that was used for all MHD applications discussed below.</p><p id="Par69">At the end of the magnetic field reconstruction step, the previously obtained unconstrained modes are discarded and replaced with the constrained version. This ensures synchronization between the primary and supplementary magnetic field variables used by the code.</p></sec></sec><sec id="Sec21"><title>Time advance and boundary exchange</title><p id="Par70">The complete finite volume method is implemented as follows. First, the zone-based variables (including <inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:msup><mml:mi mathvariant="bold">B</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}'$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq176.gif"/></alternatives></inline-formula>) are reconstructed to the quadrature points on the faces as described in the previous two sections. Pairs of states from each side of the interface are fed into a Riemann solver. We employ the HLL family of nonlinear solvers (Harten et al. <xref ref-type="bibr" rid="CR35">1983</xref>; Einfeldt <xref ref-type="bibr" rid="CR24">1988</xref>) that are very robust and usually positivity preserving as long as the speeds of the extremal waves are properly estimated. The popular HLLC solver (Batten et al. <xref ref-type="bibr" rid="CR12">1997</xref>; Gurski <xref ref-type="bibr" rid="CR34">2004</xref>; Li <xref ref-type="bibr" rid="CR45">2005</xref>) consists of four states separated by two fast shocks and a tangential discontinuity. The HLLD solver (Miyoshi and Kusano <xref ref-type="bibr" rid="CR48">2005</xref>) adds a pair of rotational discontinuities, and is therefore less dissipative than HLLC, but is somewhat less robust and can fail for certain combinations of input states. Our approach is to start with the least diffusive solver, downgrading to the more dissipative solver when the former fails to deliver a positive resolved state. The fluxes are evaluated at each quadrature point and combined together to obtain the total flux through a face. These fluxes update the conserved variables in the zone using a TVD Runge–Kutta scheme (Shu and Osher <xref ref-type="bibr" rid="CR58">1988</xref>). A version of the code is also available that uses the so-called arbitrary derivative (ADER) update technique (Dumbser et al. <xref ref-type="bibr" rid="CR21">2008</xref>; Balsara et al. <xref ref-type="bibr" rid="CR9">2009</xref>). The ADER implementation on the geodesic mesh has been reported elsewhere (Balsara et al. <xref ref-type="bibr" rid="CR6">2019</xref>).</p><p id="Par71">Unlike the zone variables, the magnetic fields are reconstructed to the quadrature points lying on the <italic>edges</italic>. A single point is sufficient at second order and two points at third and fourth orders. The constrained magnetic field is used here in place of the non-constrained reconstruction. Each t-edge receives four states and each r-face five or six states depending on whether it is a penta-corner or not. These states are fed into a multi-state two-dimensional Riemann solver (Balsara <xref ref-type="bibr" rid="CR1">2010</xref>, <xref ref-type="bibr" rid="CR2">2012</xref>, <xref ref-type="bibr" rid="CR3">2014</xref>; Balsara and Dumbser <xref ref-type="bibr" rid="CR5">2015b</xref>) generating the electric field at the edges (the remaining flux components are discarded). The 2D Riemann solver used here is of the HLLI type (Dumbser and Balsara <xref ref-type="bibr" rid="CR20">2016</xref>) that can include every MHD wave, including the Alfvén and slow magnetosonic waves. The face-based magnetic field is updated via the same Runge–Kutta procedure. This operation conserves the divergence of <bold>B</bold> to the machine precision.</p><p id="Par72">A correct implementation of the above scheme must ensure that all variables are properly synchronized at the block boundaries. Each block can have up to 38 neighbors which at some point in the calculation must send some of their zone, face, or edge based boundary data and received equivalent data in return to fill in the ghost mesh element or synchronize the common boundaries. The implementation described here does not use neighbor lists, instead delegating all bookkeeping tasks to the message passing library.</p><p id="Par73">Figure <xref rid="Fig12" ref-type="fig">12</xref> demonstrates the typical mesh topology. Ten out of 20 blocks are shown in this cutout view, shaded using different colors. This corresponds to the smallest decomposition of the computational domain, confined between two concentric spheres with <inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{max}}/r_{\mathrm{min}}=2$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq177.gif"/></alternatives></inline-formula>, and using a single slab. <fig id="Fig12"><label>Figure 12</label><caption xml:lang="en"><p>Cutout view of the mesh showing ten blocks out of 20 (the smallest number of blocks on this mesh, consisting of a single slab and 20 division 0 sectors). Each block is shaded using a unique color</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40668_2020_33_Fig12_HTML.jpg"/></fig></p><p id="Par74">To formalize our communication strategy we define the concept of “exchange site” that could be a face, edge, or corner (vertex) of the block. Each exchange site maintains a list of blocks that share the site. The list consists of two elements for any face site, four for a t-edge, six or five for an r-edge, and twelve or ten for a vertex site. Each site further defines a number of exchanges that occur at the site as lists of participant blocks. A block maintains a list of exchanges it needs to perform during a time step and its own order in that exchange. All exchanges of the same kind are started at once on every participating block in the non-blocking regime; we therefore rely on the message passing library’s own scheduling facilities to achieve optimal utilization of the interconnection network.</p><p id="Par75">A block maintains a set of buffers and corresponding rules to pack a part of the block destined for exchange into contiguous memory of the buffer as well as the inverse (unpack) operation. Because neighboring blocks can have any of the three possible orientations, packing and unpacking must be done in a way that is independent of the choice of the base vertex. Care must also be taken to synchronize the variables at locations that are shared among blocks, such as face-based magnetic field values and fluxes, and edge-based electric fields. This synchronization is needed to eliminate possible divergence between neighboring blocks owing to roundoff errors.</p><p id="Par76">Figure <xref rid="Fig13" ref-type="fig">13</xref> shows the block surrounded by twelve neighbors that belong to the same slab. The large yellow triangle is the interior area of the block, while the surrounding smaller trapezoidal or triangular areas represent the <italic>receive buffers</italic> that correspond to the ghost zones of the block. To extract the data received from each neighbor from the corresponding buffer requires rotated TAS coordinates that are represented in Fig. <xref rid="Fig13" ref-type="fig">13</xref> by pairs of black arrows showing the directions of the first and the second TAS coordinates, respectively. The convention for packing and unpacking a trapezoid is that the principal vertex is in the lower left corner with the trapezoid resting on its wider base. For small triangles, the principal vertex is the vertex shared with the block’s interior. This convention automatically ensures that unpacking of a buffer is done in the same order as it was packed by the neighbor block. <fig id="Fig13"><label>Figure 13</label><caption xml:lang="en"><p>Neighbor arrangement around a block. The pairs of arrows indicate the directions of the first and the second TAS coordinates, respectively. The different rotations of the TAS are shown with different color shading</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig13_HTML.png"/></fig></p><p id="Par77">Figure <xref rid="Fig14" ref-type="fig">14</xref> shows the structure of the complete simulation loop based on the Runge–Kutta time advance. The initial setup involving pre-computing the geometry matrices is time consuming, but the subsequent computation is sped up dramatically as a result. <fig id="Fig14"><label>Figure 14</label><caption xml:lang="en"><p>Sequence of steps in one iteration of the time loop</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig14_HTML.png"/></fig></p><p id="Par78">The production version of the code was written in Fortran, and a development version writen in C++ is also available. The input and output is handled by the open source SILO library (<ext-link xlink:href="https://wci.llnl.gov/simulation/computer-codes/silo" ext-link-type="uri">https://wci.llnl.gov/simulation/computer-codes/silo</ext-link>). The library features a simple parallel I/O implementation that groups the blocks (which could number in the hundreds of thousands) into a smaller number of SILO files. An assembly file is then generated describing the relationship between the blocks for the visualizer. We use the VisIt visualizer (<ext-link xlink:href="https://wci.llnl.gov/simulation/computer-codes/visit" ext-link-type="uri">https://wci.llnl.gov/simulation/computer-codes/visit</ext-link>) for 3D rendering of the model output; several of the figures in this paper were produced with VisIt.</p></sec><sec id="Sec22"><title>Numerical tests</title><p id="Par79">Here we present two simple tests validating the accuracy of the model. The first test in the “manufactured” solution of Ivan et al. (<xref ref-type="bibr" rid="CR39">2013</xref>) that describes an interaction between a point source and a uniform flow; which is the most basic model of an astrosphere (an interface produced by a stellar wind expanding into a moving interstellar medium). This steady state, current-free field-aligned flow is given by <disp-formula id="Equ59"><label>59</label><alternatives><mml:math id="Equ59_Math"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>r</mml:mi></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \rho =\rho _{0} \biggl(\frac{r_{0}}{r} \biggr)^{5/2}, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ59.gif"/></alternatives></disp-formula><disp-formula id="Equ60"><label>60</label><alternatives><mml:math id="Equ60_Math"><mml:mi mathvariant="bold">u</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \mathbf{u}=\frac{u_{0}\mathbf{x}}{(r_{0}r)^{1/2}}+u_{1} \biggl( \frac{r}{r_{0}} \biggr)^{5/2}\hat{\mathbf{e}}_{3}, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ60.gif"/></alternatives></disp-formula><disp-formula id="Equ61"><label>61</label><alternatives><mml:math id="Equ61_Math"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>r</mml:mi></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; p=p_{0} \biggl(\frac{r_{0}}{r} \biggr)^{5/2}, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ61.gif"/></alternatives></disp-formula><disp-formula id="Equ62"><label>62</label><alternatives><mml:math id="Equ62_Math"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math><tex-math id="Equ62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \mathbf{B}=\frac{B_{0}r_{0}^{2}\mathbf{x}}{r^{3}}+ \frac{B_{0}u_{1}}{u_{0}}\hat{\mathbf{e}}_{3}. \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ62.gif"/></alternatives></disp-formula> The source terms corresponding to Eqs. (<xref rid="Equ59" ref-type="disp-formula">59</xref>)–(<xref rid="Equ62" ref-type="disp-formula">62</xref>) that appear in the conservative MHD equations are <disp-formula id="Equ63"><label>63</label><alternatives><mml:math id="Equ63_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mi>ρ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><tex-math id="Equ63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; Q_{\rho }=0, \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ63.gif"/></alternatives></disp-formula><disp-formula id="Equ64"><label>64</label><alternatives><mml:math id="Equ64_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">Q</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">[</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>r</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>z</mml:mi></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">]</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mn>7</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \begin{aligned}[b] \mathbf{Q}_{u}={}&amp; \biggl[\rho _{0} u_{0} \biggl( \frac{u_{0}}{r}- \frac{u_{1}z}{r^{2}} \biggr)-\frac{5p_{0}r_{0}}{r^{2}} \biggr] \frac{r_{0}^{3/2}\mathbf{x}}{2r^{5/2}}\\&amp;{}+ \biggl(7u_{0}+ \frac{5u_{1}zr}{r_{0}^{2}} \biggr) \frac{\rho _{0}u_{1}\hat{\mathbf{e}}_{3}}{2(r_{0}r)^{1/2}}, \end{aligned} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ64.gif"/></alternatives></disp-formula><disp-formula id="Equ65"><label>65</label><alternatives><mml:math id="Equ65_Math"><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>Q</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>7</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>z</mml:mi></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>7</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mi>z</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \begin{aligned}[b] Q_{e}={}&amp;\frac{\rho _{0}u_{0}^{2}}{2r} \biggl(\frac{u_{0}r_{0}}{r}+ \frac{7u_{1}z}{r_{0}} \biggr)+ \frac{\rho _{0}u_{0}u_{1}^{2}(7r^{2}+4z^{2})}{r_{0}^{3}} \\ &amp;{} + \frac{5\rho _{0}u_{1}^{3}zr^{3}}{2r_{0}^{5}}, \end{aligned} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ65.gif"/></alternatives></disp-formula><disp-formula id="Equ66"><label>66</label><alternatives><mml:math id="Equ66_Math"><mml:msub><mml:mi mathvariant="bold">Q</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:math><tex-math id="Equ66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \mathbf{Q}_{B}=0. \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ66.gif"/></alternatives></disp-formula></p><p id="Par80">The analytic solution is independent of the adiabatic index <italic>γ</italic>. Following Ivan et al. (<xref ref-type="bibr" rid="CR39">2013</xref>), the zero-subscripted constants are all set to unity, <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.017</mml:mn></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$u_{1}/u_{0}=0.017$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq180.gif"/></alternatives></inline-formula>, <inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma =1.4$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq181.gif"/></alternatives></inline-formula>, and the simulation is performed in the region between <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{min}}=2$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq182.gif"/></alternatives></inline-formula> and <inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3.5</mml:mn></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{max}}=3.5$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq183.gif"/></alternatives></inline-formula>. The radial shell width has an exponential dependence on <italic>r</italic>. Figure <xref rid="Fig15" ref-type="fig">15</xref> shows the rate of convergence for the <inline-formula id="IEq184"><alternatives><mml:math id="IEq184_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq184_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq184.gif"/></alternatives></inline-formula> and <inline-formula id="IEq185"><alternatives><mml:math id="IEq185_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq185_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq185.gif"/></alternatives></inline-formula> norms of the error in the density, total energy and one component of the magnetic field. Simulations were performed on division 5 through division 8 meshes with 32 through 256 radial shells and the same number of zones per sector side. <fig id="Fig15"><label>Figure 15</label><caption xml:lang="en"><p><inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq178.gif"/></alternatives></inline-formula> (solid lines) and <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq179.gif"/></alternatives></inline-formula> (dashed lines) norms of the error of density, total energy, and the <italic>x</italic> component of the magnetic field for the manufactured solution on division 4–7 TGM. The three panels correspond to second through fourth order schemes</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig15_HTML.png"/></fig></p><p id="Par81">As is demonstrated in Fig. <xref rid="Fig15" ref-type="fig">15</xref>, the <inline-formula id="IEq199"><alternatives><mml:math id="IEq199_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq199_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq199.gif"/></alternatives></inline-formula> error decreases at the nominal convergence rate of the scheme in each case. The <inline-formula id="IEq200"><alternatives><mml:math id="IEq200_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq200_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq200.gif"/></alternatives></inline-formula> norm displays the nominal convergence rate at second order, but decreases slower than the nominal rate and third and fourth order. This is further quantified in Tables <xref rid="Tab5" ref-type="table">5</xref> through <xref rid="Tab7" ref-type="table">7</xref> that show the numerical values of the order of convergence for the manufactured solution problem. The rates for density and energy (both zone based variables) are very similar, while magnetic field shows a different behavior. The imposition of constraints described in Sect. <xref rid="Sec15" ref-type="sec">7</xref> affects the accuracy of reconstruction. It seems to be detrimental at lower order of accuracy but is surprisingly beneficial at fourth order. <table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Actual order of convergence for the manufactured solution problem using the nominally second order scheme. Density (<italic>ρ</italic>), total energy (<italic>e</italic>), and one component of magnetic field (<inline-formula id="IEq186"><alternatives><mml:math id="IEq186_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq186_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq186.gif"/></alternatives></inline-formula>) are shown</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="3"><p><italic>ρ</italic></p></th><th colspan="3"><p><italic>e</italic></p></th><th colspan="3"><p><inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq187.gif"/></alternatives></inline-formula></p></th></tr><tr><th><p>Division</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th></tr></thead><tbody><tr><td><p><inline-formula id="IEq188"><alternatives><mml:math id="IEq188_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq188_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq188.gif"/></alternatives></inline-formula></p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td></tr><tr><td><p><inline-formula id="IEq189"><alternatives><mml:math id="IEq189_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq189_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq189.gif"/></alternatives></inline-formula></p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>1.8</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>2.0</p></td><td><p>1.8</p></td><td><p>1.8</p></td><td><p>1.8</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>Actual order of convergence for the manufactured solution problem using the nominally third order scheme. Density (<italic>ρ</italic>), total energy (<italic>e</italic>), and one component of magnetic field (<inline-formula id="IEq190"><alternatives><mml:math id="IEq190_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq190_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq190.gif"/></alternatives></inline-formula>) are shown</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="3"><p><italic>ρ</italic></p></th><th colspan="3"><p><italic>e</italic></p></th><th colspan="3"><p><inline-formula id="IEq191"><alternatives><mml:math id="IEq191_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq191_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq191.gif"/></alternatives></inline-formula></p></th></tr><tr><th><p>Division</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th></tr></thead><tbody><tr><td><p><inline-formula id="IEq192"><alternatives><mml:math id="IEq192_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq192_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq192.gif"/></alternatives></inline-formula></p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td><td><p>3.0</p></td></tr><tr><td><p><inline-formula id="IEq193"><alternatives><mml:math id="IEq193_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq193_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq193.gif"/></alternatives></inline-formula></p></td><td><p>3.0</p></td><td><p>2.7</p></td><td><p>2.6</p></td><td><p>3.0</p></td><td><p>2.7</p></td><td><p>2.5</p></td><td><p>2.3</p></td><td><p>2.3</p></td><td><p>2.3</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Actual order of convergence for the manufactured solution problem using the nominally fourth order scheme. Density (<italic>ρ</italic>), total energy (<italic>e</italic>), and one component of magnetic field (<inline-formula id="IEq194"><alternatives><mml:math id="IEq194_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq194_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq194.gif"/></alternatives></inline-formula>) are shown</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="3"><p><italic>ρ</italic></p></th><th colspan="3"><p><italic>e</italic></p></th><th colspan="3"><p><inline-formula id="IEq195"><alternatives><mml:math id="IEq195_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq195_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B_{x}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq195.gif"/></alternatives></inline-formula></p></th></tr><tr><th><p>Division</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th><th><p>5</p></th><th><p>6</p></th><th><p>7</p></th></tr></thead><tbody><tr><td><p><inline-formula id="IEq196"><alternatives><mml:math id="IEq196_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq196_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq196.gif"/></alternatives></inline-formula></p></td><td><p>4.3</p></td><td><p>4.1</p></td><td><p>4.0</p></td><td><p>4.3</p></td><td><p>4.1</p></td><td><p>4.0</p></td><td><p>4.1</p></td><td><p>4.0</p></td><td><p>4.0</p></td></tr><tr><td><p><inline-formula id="IEq197"><alternatives><mml:math id="IEq197_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math><tex-math id="IEq197_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{\infty }$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq197.gif"/></alternatives></inline-formula></p></td><td><p>4.0</p></td><td><p>3.1</p></td><td><p>3.0</p></td><td><p>4.1</p></td><td><p>3.1</p></td><td><p>2.9</p></td><td><p>3.1</p></td><td><p>3.3</p></td><td><p>3.6</p></td></tr></tbody></table></table-wrap></p><p id="Par82">Figure <xref rid="Fig16" ref-type="fig">16</xref> shows the velocity magnitude (left panel) and the distribution of the error on the sphere at <inline-formula id="IEq201"><alternatives><mml:math id="IEq201_Math"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2.75</mml:mn></mml:math><tex-math id="IEq201_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r=2.75$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq201.gif"/></alternatives></inline-formula> for a simulation on a division 6 mesh using the fourth order scheme. The flow geometry resembles that of a potential flow of gas around a point source, although the velocity field is not irrotational here. The right panel shows the error distribution in one spherical layer. In common with other geodesic meshes, the error distribution shows a distinctive imprint of the mesh. The errors are the largest near the penta-corners and at the boundaries of division 0 and division 1 sectors. Similar phenomena have been reported by Tomita et al. (<xref ref-type="bibr" rid="CR59">2001</xref>), Weller et al. (<xref ref-type="bibr" rid="CR62">2012</xref>) and Peixoto and Barros (<xref ref-type="bibr" rid="CR51">2013</xref>) in the context of the shallow water equations. <fig id="Fig16"><label>Figure 16</label><caption xml:lang="en"><p>Left: velocity magnitude isosurfaces from the manufactured solution problem. The solution has a resemblance to an interaction between a stellar wind an a uniform flow. A fourth order scheme was used on division 6 mesh with 64 radial shells. Right: density error distribution in a spherical layer at <inline-formula id="IEq198"><alternatives><mml:math id="IEq198_Math"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2.75</mml:mn></mml:math><tex-math id="IEq198_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r=2.75$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq198.gif"/></alternatives></inline-formula></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40668_2020_33_Fig16_HTML.jpg"/></fig></p><p id="Par83">It is expected that the error becomes more concentrated near singular points with increasing refinement. For any division mesh, only 60 zones have a singular point as a vertex. Because the ratio of the number of large error zones to the total number of zones decreases with increased resolution, the <inline-formula id="IEq202"><alternatives><mml:math id="IEq202_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq202_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq202.gif"/></alternatives></inline-formula> norm is not affected even if the convergence order in high error zones is one lower than elsewhere in the mesh; this is supported by the numbers from Table <xref rid="Tab7" ref-type="table">7</xref>.</p><p id="Par84">The second test is a time-dependent blast problem from (Florinski et al. <xref ref-type="bibr" rid="CR28">2013</xref>). The initial conditions are piecewise constant within each of the two concentric shells, <inline-formula id="IEq203"><alternatives><mml:math id="IEq203_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq203_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{min}}\leq r\leq r_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq203.gif"/></alternatives></inline-formula> and <inline-formula id="IEq204"><alternatives><mml:math id="IEq204_Math"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:math><tex-math id="IEq204_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{1}\leq r\leq r_{\mathrm{max}}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq204.gif"/></alternatives></inline-formula>. Both states have <inline-formula id="IEq205"><alternatives><mml:math id="IEq205_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq205_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\rho _{0}=1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq205.gif"/></alternatives></inline-formula> and <inline-formula id="IEq206"><alternatives><mml:math id="IEq206_Math"><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><tex-math id="IEq206_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{u}_{0}=0$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq206.gif"/></alternatives></inline-formula>, while the pressure is set to <inline-formula id="IEq207"><alternatives><mml:math id="IEq207_Math"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="IEq207_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{0}=10$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq207.gif"/></alternatives></inline-formula> (<inline-formula id="IEq208"><alternatives><mml:math id="IEq208_Math"><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq208_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r&lt; r_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq208.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq209"><alternatives><mml:math id="IEq209_Math"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math><tex-math id="IEq209_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{0}=0.1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq209.gif"/></alternatives></inline-formula> (<inline-formula id="IEq210"><alternatives><mml:math id="IEq210_Math"><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq210_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r&gt;r_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq210.gif"/></alternatives></inline-formula>). The initial magnetic field is a superposition of a dipole and a uniform fields, <disp-formula id="Equ67"><label>67</label><alternatives><mml:math id="Equ67_Math"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo maxsize="5.2ex" minsize="5.2ex" stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><tex-math id="Equ67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathbf{B}=\mathbf{B}_{0} \biggl(1+\frac{r_{0}^{3}}{2r^{3}} \biggr)- \frac{3r_{0}^{3}(\mathbf{B}_{0}\cdot \mathbf{x})\mathbf{x}}{2r^{5}}. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ67.gif"/></alternatives></disp-formula> We set <inline-formula id="IEq211"><alternatives><mml:math id="IEq211_Math"><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">e</mml:mi><mml:mo stretchy="false">ˆ</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><tex-math id="IEq211_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{B}_{0}=10/\sqrt{3}(\hat{\mathbf{e}}_{1}+\hat{\mathbf{e}}_{2}+ \hat{\mathbf{e}}_{3})$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq211.gif"/></alternatives></inline-formula>, <inline-formula id="IEq212"><alternatives><mml:math id="IEq212_Math"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn></mml:math><tex-math id="IEq212_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma =1.4$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq212.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq213"><alternatives><mml:math id="IEq213_Math"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math><tex-math id="IEq213_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{1}=0.1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq213.gif"/></alternatives></inline-formula>. The simulation was performed in the region between <inline-formula id="IEq214"><alternatives><mml:math id="IEq214_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math><tex-math id="IEq214_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{min}}=r_{0}=0.01$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq214.gif"/></alternatives></inline-formula> and <inline-formula id="IEq215"><alternatives><mml:math id="IEq215_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math><tex-math id="IEq215_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{max}}=0.5$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq215.gif"/></alternatives></inline-formula> until the time <inline-formula id="IEq216"><alternatives><mml:math id="IEq216_Math"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:math><tex-math id="IEq216_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t=0.07$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq216.gif"/></alternatives></inline-formula> with third order reconstruction on a division 6 mesh with 256 exponentially spaced radial shells. A reflective condition was used at the internal boundary and the fixed initial state maintained at the external boundary.</p><p id="Par85">The magnetic field obtained for this problem is shown in Fig. <xref rid="Fig17" ref-type="fig">17</xref>. The flow consists of a fast shock wave and two dense shells of material elongated along the magnetic field. The result is in excellent agreement with that reported in Florinski et al. (<xref ref-type="bibr" rid="CR28">2013</xref>). <fig id="Fig17"><label>Figure 17</label><caption xml:lang="en"><p>Magnitude of the magnetic field from the solution to the blast wave problem at <inline-formula id="IEq217"><alternatives><mml:math id="IEq217_Math"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:math><tex-math id="IEq217_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t=0.07$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq217.gif"/></alternatives></inline-formula>. A linear color scale is used</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40668_2020_33_Fig17_HTML.jpg"/></fig></p></sec><sec id="Sec23"><title>Summary</title><p id="Par86">This paper documents many of the original techniques and innovations that were incorporated into our newly developed computational model for MHD equations based on an icosahedral triangular geodesic mesh. The new geodesic framework features numerous improvements compared with our earlier icosahedral hexagonal model reported in Florinski et al. (<xref ref-type="bibr" rid="CR28">2013</xref>) that was used successfully to simulate the interaction between the solar wind and the surrounding interstellar medium (Guo and Florinski <xref ref-type="bibr" rid="CR32">2016</xref>; Guo et al. <xref ref-type="bibr" rid="CR33">2018</xref>). These improvements are summarized below.</p><p id="Par87"><italic>Triangle based mesh.</italic> Using triangles instead of hexagons paved the way to efficient decomposition of the computational domain into sectors in addition to radial shells (shell decomposition was the only one available in Florinski et al. (<xref ref-type="bibr" rid="CR28">2013</xref>)). As a result, the new code scales up to tens of thousands of CPU cores with almost linear weak scaling (Balsara et al. <xref ref-type="bibr" rid="CR6">2019</xref>). The second advantage of the TGM is that it is amenable to adaptive mesh refinement, which is not possible with a hexagonal mesh.</p><p id="Par88"><italic>Increased order of accuracy.</italic> The new framework provides second, third, and fourth orders of accuracy for the MHD equations. High accuracy was achieved by using larger stencils and multiple families of stencils including symmetric central and asymmetric directional stencils. This is a major improvement over our earlier geodesic model that was only second order capable. The only other fourth order geodesic mesh MHD model we are aware of was reported in Ivan et al. (<xref ref-type="bibr" rid="CR40">2015</xref>); however it was based on a cube-sphere rather than a TGM.</p><p id="Par89"><italic>Accurate representation of spherical geometry.</italic> The new framework uses linear, quadratic, and cubic Lagrangian basis function to perform coordinate transformations from a reference element (a right prism) to the physical computational zone. These maps are based on the serendipity family of triangular finite elements with three, six, and ten nodes, respectively. This approach allows a very accurate representation of the spherical surface without the drawback of dealing directly with spherical coordinates. While the accuracy of the geometry representation does not improve the convergence order of the scheme, it could be potentially very important for the models of thin shells, such as planetary atmospheres.</p><p id="Par90"><italic>Divergence free MHD.</italic> The new model features the first implementation of the constraint transport method on a geodesic mesh. In this approach the magnetic field is maintained divergence free because of exact cancellation of all contributions to divergence in a zone during the time update. In addition, the model features pointwise and functional divergence-free reconstruction of the magnetic field.</p><p id="Par91"><italic>Implementation flexibility.</italic> All geodesic meshes are based on the same set of underlying principles used in mesh generation and spatial reconstruction. We have found that the present framework can be adapted, with a very limited number of changes, to build a model around any of the five regular polyhedra. We have developed an initial implementation of the geometry framework component for the hexahedral QGM. This will eventually permit a direct comparison between geodesic meshes of different types.</p></sec></body><back><ack><sec id="FPar3"><title>Acknowledgements</title><p id="Par139">Not applicable.</p></sec><sec id="FPar4"><title>Availability of data and materials</title><p id="Par140">Data used to produce the figures in this paper are available from the authors on request.</p></sec></ack><sec sec-type="author-contribution"><title>Authors’ contributions</title><p>VF co-developed the mathematical models, implemented them in a C++ code, and wrote most of the paper. DSB co-developed the mathematical models and designed the Fortran version of the code. SG wrote parts of the Fortran code and performed test simulations. KFG developed numerical quadrature algorithms used by the code. All authors read and approved the final manuscript.</p></sec><sec><title>Funding</title><p>This work was supported, in part, by NSF grant DMS-1361219 and by NASA grant NNX17AB85G. DBS acknowledges support via NSF grants ACI-1533850, DMS-1622457, ACI-1713765 and DMS-1821242. Support from a grant by Notre Dame International is also acknowledged.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par137">The authors declare that they have no competing interests.</p></sec></sec><glossary><title>Abbreviations</title><def-list><def-item><term>2D</term><def><p id="Par95">Two dimensional</p></def></def-item><def-item><term>3D</term><def><p id="Par96">Three dimensional</p></def></def-item><def-item><term>ADER</term><def><p id="Par97">Arbitrary high order scheme using Riemann problem to advect high-order Derivatives</p></def></def-item><def-item><term>CFD</term><def><p id="Par98">Computational Fluid Dynamics</p></def></def-item><def-item><term>CLSQ</term><def><p id="Par99">Constrained Least Square (system)</p></def></def-item><def-item><term>CPU</term><def><p id="Par100">Central Processing Unit</p></def></def-item><def-item><term>E</term><def><p id="Par101">East</p></def></def-item><def-item><term>EF</term><def><p id="Par102">Edge-face (connectivity)</p></def></def-item><def-item><term>ENC</term><def><p id="Par103">Exponential Normalized Coordinates</p></def></def-item><def-item><term>EV</term><def><p id="Par104">Edge-vertex (connectivity)</p></def></def-item><def-item><term>FE</term><def><p id="Par105">Face-edge (connectivity)</p></def></def-item><def-item><term>FF</term><def><p id="Par106">Face-face (connectivity)</p></def></def-item><def-item><term>FV</term><def><p id="Par107">Face-vertex (connectivity)</p></def></def-item><def-item><term>HLL</term><def><p id="Par108">Harten–Lax–van Leer (Riemann solver)</p></def></def-item><def-item><term>HLLC</term><def><p id="Par109">Harten–Lax–van Leer with Contact discontinuity (Riemann solver)</p></def></def-item><def-item><term>HLLD</term><def><p id="Par110">Harten–Lax–van Leer with multiple Discontinuities (Riemann solver)</p></def></def-item><def-item><term>HLLI</term><def><p id="Par111">Harten–Lax–van Leer with Intermediate characteristic fields (Riemann solver)</p></def></def-item><def-item><term>KKT</term><def><p id="Par112">Karush–Kuhn–Tucker (matrix)</p></def></def-item><def-item><term>LHS</term><def><p id="Par113">Left Hand Side</p></def></def-item><def-item><term>LLS</term><def><p id="Par114">Linear Least Square (system)</p></def></def-item><def-item><term>LU</term><def><p id="Par115">Lower–Upper</p></def></def-item><def-item><term>MHD</term><def><p id="Par116">Magneto-hydrodynamic</p></def></def-item><def-item><term>MPI</term><def><p id="Par117">Message Passing Interface</p></def></def-item><def-item><term>N</term><def><p id="Par118">North</p></def></def-item><def-item><term>NE</term><def><p id="Par119">North-East</p></def></def-item><def-item><term>NW</term><def><p id="Par120">North-West</p></def></def-item><def-item><term>PDE</term><def><p id="Par121">Partial Differential Equation</p></def></def-item><def-item><term>QGM</term><def><p id="Par122">Quadrilateral Geodesic Mesh</p></def></def-item><def-item><term>RHS</term><def><p id="Par123">Right Hand Side</p></def></def-item><def-item><term>S</term><def><p id="Par124">South</p></def></def-item><def-item><term>SE</term><def><p id="Par125">South-East</p></def></def-item><def-item><term>SI</term><def><p id="Par126">Système International</p></def></def-item><def-item><term>SW</term><def><p id="Par127">South-West</p></def></def-item><def-item><term>TAS</term><def><p id="Par128">Triangular Addressing Scheme</p></def></def-item><def-item><term>TGM</term><def><p id="Par129">Triangular Geodesic Mesh</p></def></def-item><def-item><term>TVD</term><def><p id="Par130">Total Variation Diminishing</p></def></def-item><def-item><term>VE</term><def><p id="Par131">Vertex-edge (connectivity)</p></def></def-item><def-item><term>VF</term><def><p id="Par132">Vertex-face (connectivity)</p></def></def-item><def-item><term>VV</term><def><p id="Par133">Vertex-vertex (connectivity)</p></def></def-item><def-item><term>W</term><def><p id="Par134">West</p></def></def-item><def-item><term>WENO</term><def><p id="Par135">Weighted Essentially Non-Oscillatory</p></def></def-item><def-item><term>WENO-AO</term><def><p id="Par136">Weighted Essentially Non-Oscillatory—Adaptive Order</p></def></def-item></def-list></glossary><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name></person-group><article-title xml:lang="en">Multidimensional HLLE Riemann solver: application to Euler and magnetohydrodynamic flows</article-title><source>J. Comput. Phys.</source><year>2010</year><volume>229</volume><fpage>1970</fpage><lpage>1993</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2010JCoPh.229.1970B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2586232</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2009.11.018</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1303.76140</pub-id></mixed-citation></ref><ref id="CR2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name></person-group><article-title xml:lang="en">A two-dimensional HLLC Riemann solver for conservation laws: application to Euler and magnetohydrodynamic flows</article-title><source>J. Comput. Phys.</source><year>2012</year><volume>231</volume><fpage>7476</fpage><lpage>7503</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012JCoPh.231.7476B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2972844</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2011.12.025</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1284.76261</pub-id></mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name></person-group><article-title xml:lang="en">Multidimensional Riemann problem with self-similar internal structure. Part I—application to hyperbolic conservation laws on structured meshes</article-title><source>J. Comput. Phys.</source><year>2014</year><volume>277</volume><fpage>163</fpage><lpage>200</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014JCoPh.277..163B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3254229</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2014.07.053</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1349.76303</pub-id></mixed-citation></ref><ref id="CR4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Dumbser</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">Divergence-free MHD on unstructured meshes using high order finite volume schemes based on multidimensional Riemann solvers</article-title><source>J. Comput. Phys.</source><year>2015</year><volume>299</volume><fpage>687</fpage><lpage>715</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015JCoPh.299..687B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3384747</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2015.07.012</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1351.76092</pub-id></mixed-citation></ref><ref id="CR5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Dumbser</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">Multidimensional Riemann problem with self-similar internal structure. Part II—application to hyperbolic conservation laws on unstructured meshes</article-title><source>J. Comput. Phys.</source><year>2015</year><volume>287</volume><fpage>269</fpage><lpage>292</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015JCoPh.287..269B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3319412</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2014.11.004</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1351.76091</pub-id></mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Florinski</surname><given-names>V.</given-names></name><name><surname>Garain</surname><given-names>S.</given-names></name><name><surname>Subramanian</surname><given-names>S.</given-names></name><name><surname>Gurski</surname><given-names>K.F.</given-names></name></person-group><article-title xml:lang="en">Efficient, divergence-free, high order MHD on 3D spherical meshes with optimal geodesic meshing</article-title><source>Mon. Not. R. Astron. Soc.</source><year>2019</year><volume>487</volume><fpage>1283</fpage><lpage>1314</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019MNRAS.487.1283B</pub-id><pub-id pub-id-type="doi">10.1093/mnras/stz1263</pub-id></mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Garain</surname><given-names>S.</given-names></name><name><surname>Florinski</surname><given-names>V.</given-names></name><name><surname>Boscheri</surname><given-names>W.</given-names></name></person-group><article-title xml:lang="en">An efficient class of WENO schemes with adaptive order for unstructured meshes</article-title><source>J. Comput. Phys.</source><year>2020</year><volume>404</volume><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">4044720</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2019.109062</pub-id></mixed-citation></ref><ref id="CR8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Garain</surname><given-names>S.</given-names></name><name><surname>Shu</surname><given-names>C.-W.</given-names></name></person-group><article-title xml:lang="en">An efficient class of WENO schemes with adaptive order</article-title><source>J. Comput. Phys.</source><year>2016</year><volume>326</volume><fpage>780</fpage><lpage>804</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016JCoPh.326..780B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3554165</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2016.09.009</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1422.65146</pub-id></mixed-citation></ref><ref id="CR9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Rumpf</surname><given-names>T.</given-names></name><name><surname>Dumbser</surname><given-names>M.</given-names></name><name><surname>Munz</surname><given-names>C.-D.</given-names></name></person-group><article-title xml:lang="en">Efficient, high accuracy ADER-WENO schemes for hydrodynamics and divergence-free magnetohydrodynamics</article-title><source>J. Comput. Phys.</source><year>2009</year><volume>228</volume><fpage>2480</fpage><lpage>2516</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009JCoPh.228.2480B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2501694</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2008.12.003</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1275.76169</pub-id></mixed-citation></ref><ref id="CR10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Shu</surname><given-names>C.-W.</given-names></name></person-group><article-title xml:lang="en">Monotonicity peserving weighted essentially non-oscillatory schemes with increasingly high order of accuracy</article-title><source>J. Comput. Phys.</source><year>2000</year><volume>160</volume><fpage>405</fpage><lpage>452</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2000JCoPh.160..405B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1763821</pub-id><pub-id pub-id-type="doi">10.1006/jcph.2000.6443</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0961.65078</pub-id></mixed-citation></ref><ref id="CR11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Spicer</surname><given-names>D.S.</given-names></name></person-group><article-title xml:lang="en">A staggered mesh algorithm using high order Godunov fluxes to ensure solenoidal magnetic fields in magnetohydrodynamic simulations</article-title><source>J. Comput. Phys.</source><year>1999</year><volume>149</volume><fpage>270</fpage><lpage>292</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1999JCoPh.149..270B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1672743</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1998.6153</pub-id></mixed-citation></ref><ref id="CR12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Batten</surname><given-names>P.</given-names></name><name><surname>Clarke</surname><given-names>N.</given-names></name><name><surname>Lambert</surname><given-names>C.</given-names></name><name><surname>Causon</surname><given-names>D.M.</given-names></name></person-group><article-title xml:lang="en">On the choice of wavespeeds for the HLLC Riemann solver</article-title><source>SIAM J. Sci. Comput.</source><year>1997</year><volume>18</volume><fpage>1553</fpage><lpage>1570</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1480624</pub-id><pub-id pub-id-type="doi">10.1137/S1064827593260140</pub-id></mixed-citation></ref><ref id="CR13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beckmann</surname><given-names>J.</given-names></name><name><surname>Mhaskar</surname><given-names>H.N.</given-names></name><name><surname>Prestin</surname><given-names>J.</given-names></name></person-group><article-title xml:lang="en">Quadrature formulas for integration of multivariate trigonometric polynomials on spherical triangles</article-title><source>GEM Int. J. Geomath.</source><year>2012</year><volume>3</volume><fpage>119</fpage><lpage>138</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2915951</pub-id><pub-id pub-id-type="doi">10.1007/s13137-012-0035-4</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1258.65028</pub-id></mixed-citation></ref><ref id="CR14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernard</surname><given-names>P.-E.</given-names></name><name><surname>Remacle</surname><given-names>J.-F.</given-names></name><name><surname>Comblen</surname><given-names>R.</given-names></name><name><surname>Legat</surname><given-names>V.</given-names></name><name><surname>Hillewaert</surname><given-names>K.</given-names></name></person-group><article-title xml:lang="en">High-order discontinuous Galerkin schemes on general 2D manifolds applied to the shallow water equations</article-title><source>J. Comput. Phys.</source><year>2009</year><volume>228</volume><fpage>6514</fpage><lpage>6535</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009JCoPh.228.6514B</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2549854</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2009.05.046</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1261.76026</pub-id></mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>G.L.</given-names></name><name><surname>Hack</surname><given-names>J.J.</given-names></name><name><surname>Swarztrauber</surname><given-names>P.N.</given-names></name></person-group><article-title xml:lang="en">A comparison of three numerical methods for solving differential equations on the sphere</article-title><source>Mon. Weather Rev.</source><year>1989</year><volume>117</volume><fpage>1058</fpage><lpage>1075</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1989MWRv..117.1058B</pub-id><pub-id pub-id-type="doi">10.1175/1520-0493(1989)117&lt;1058:ACOTNM&gt;2.0.CO;2</pub-id></mixed-citation></ref><ref id="CR16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choblet</surname><given-names>G.</given-names></name><name><surname>Čadek</surname><given-names>O.</given-names></name><name><surname>Couturier</surname><given-names>F.</given-names></name><name><surname>Dumoulin</surname><given-names>C.</given-names></name></person-group><article-title xml:lang="en">ŒDIPUS: a new tool to study the dynamics of planetary interiors</article-title><source>Geophys. J. Int.</source><year>2007</year><volume>170</volume><fpage>9</fpage><lpage>30</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007GeoJI.170....9C</pub-id><pub-id pub-id-type="doi">10.1111/j.1365-246X.2007.03419.x</pub-id></mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeVore</surname><given-names>C.R.</given-names></name></person-group><article-title xml:lang="en">Flux-corrected transport trchniques for multidimensional compressible magnetohydrodynamics</article-title><source>J. Comput. Phys.</source><year>1991</year><volume>92</volume><fpage>142</fpage><lpage>160</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1991JCoPh..92..142D</pub-id><pub-id pub-id-type="doi">10.1016/0021-9991(91)90295-V</pub-id></mixed-citation></ref><ref id="CR18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>Q.</given-names></name><name><surname>Faber</surname><given-names>V.</given-names></name><name><surname>Gunzburger</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">Centroidal Voronoi tessellations: applications and algorithms</article-title><source>SIAM Rev.</source><year>1999</year><volume>41</volume><fpage>637</fpage><lpage>676</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1999SIAMR..41..637D</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1722997</pub-id><pub-id pub-id-type="doi">10.1137/S0036144599352836</pub-id></mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>Q.</given-names></name><name><surname>Gunzburger</surname><given-names>M.D.</given-names></name><name><surname>Ju</surname><given-names>L.</given-names></name></person-group><article-title xml:lang="en">Voronoi-based finite volume methods, optimal Voronoi meshes, and PDEs on the sphere</article-title><source>Comput. Methods Appl. Mech. Eng.</source><year>2003</year><volume>192</volume><fpage>3933</fpage><lpage>3957</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003CMAME.192.3933D</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1997836</pub-id><pub-id pub-id-type="doi">10.1016/S0045-7825(03)00394-3</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1046.65094</pub-id></mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dumbser</surname><given-names>M.</given-names></name><name><surname>Balsara</surname><given-names>D.S.</given-names></name></person-group><article-title xml:lang="en">A new efficient formulation of the HLLEM Riemann solver for general conservative and non-conservative hyperbolic systems</article-title><source>J. Comput. Phys.</source><year>2016</year><volume>304</volume><fpage>275</fpage><lpage>319</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016JCoPh.304..275D</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3422412</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2015.10.014</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1349.76603</pub-id></mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dumbser</surname><given-names>M.</given-names></name><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Toro</surname><given-names>E.F.</given-names></name><name><surname>Munz</surname><given-names>C.-D.</given-names></name></person-group><article-title xml:lang="en">A unified framework for the construction of one-step finite volume and discontinuous Galerkin schemes on unstructured meshes</article-title><source>J. Comput. Phys.</source><year>2008</year><volume>227</volume><fpage>8209</fpage><lpage>8253</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008JCoPh.227.8209D</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2446488</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2008.05.025</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1147.65075</pub-id></mixed-citation></ref><ref id="CR22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dumbser</surname><given-names>M.</given-names></name><name><surname>Käser</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">Arbitrary high order non-oscillatory finite volume schemes on unstructured meshes for linear hyperbolic systems</article-title><source>J. Comput. Phys.</source><year>2007</year><volume>221</volume><fpage>693</fpage><lpage>723</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007JCoPh.221..693D</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2293146</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2006.06.043</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1110.65077</pub-id></mixed-citation></ref><ref id="CR23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunavant</surname><given-names>D.A.</given-names></name></person-group><article-title xml:lang="en">High degree efficient symmetrical Gaussian quadrature rules for the triangle</article-title><source>Int. J. Numer. Methods Eng.</source><year>1985</year><volume>21</volume><fpage>1129</fpage><lpage>1148</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">794241</pub-id><pub-id pub-id-type="doi">10.1002/nme.1620210612</pub-id></mixed-citation></ref><ref id="CR24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einfeldt</surname><given-names>B.</given-names></name></person-group><article-title xml:lang="en">On Godunov-type methods for gas dynamics</article-title><source>SIAM J. Numer. Anal.</source><year>1988</year><volume>25</volume><fpage>294</fpage><lpage>318</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1988SJNA...25..294E</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">933726</pub-id><pub-id pub-id-type="doi">10.1137/0725021</pub-id></mixed-citation></ref><ref id="CR25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>C.R.</given-names></name><name><surname>Hawley</surname><given-names>J.F.</given-names></name></person-group><article-title xml:lang="en">Simulation of magnetohydrodynamic flows—a constrained transport method</article-title><source>Astrophys. J.</source><year>1988</year><volume>332</volume><fpage>659</fpage><lpage>677</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1988ApJ...332..659E</pub-id><pub-id pub-id-type="doi">10.1086/166684</pub-id></mixed-citation></ref><ref id="CR26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X.</given-names></name><name><surname>Yang</surname><given-names>L.</given-names></name><name><surname>Xiang</surname><given-names>C.</given-names></name><name><surname>Wu</surname><given-names>S.T.</given-names></name><name><surname>Zhou</surname><given-names>Y.</given-names></name><name><surname>Zhong</surname><given-names>D.</given-names></name></person-group><article-title xml:lang="en">Three-dimensional solar wind modeling from the Sun to Earth by a SIP-CESE MHD model with a six-component grid</article-title><source>Astrophys. J.</source><year>2010</year><volume>723</volume><fpage>300</fpage><lpage>319</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2010ApJ...723..300F</pub-id><pub-id pub-id-type="doi">10.1088/0004-637X/723/1/300</pub-id></mixed-citation></ref><ref id="CR27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X.</given-names></name><name><surname>Zhou</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>S.T.</given-names></name></person-group><article-title xml:lang="en">A novel numerical implementation for solar wind modeling by the modified conservation element/solution wlement method</article-title><source>Astrophys. J.</source><year>2007</year><volume>655</volume><fpage>1110</fpage><lpage>1126</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007ApJ...655.1110F</pub-id><pub-id pub-id-type="doi">10.1086/510121</pub-id></mixed-citation></ref><ref id="CR28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Florinski</surname><given-names>V.</given-names></name><name><surname>Guo</surname><given-names>X.</given-names></name><name><surname>Balsara</surname><given-names>D.S.</given-names></name><name><surname>Meyer</surname><given-names>C.</given-names></name></person-group><article-title xml:lang="en">Magnetohydrodynamic modeling of solar system processes on geodesic grids</article-title><source>Astrophys. J. Suppl. Ser.</source><year>2013</year><volume>205</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ApJS..205...19F</pub-id><pub-id pub-id-type="doi">10.1088/0067-0049/205/2/19</pub-id></mixed-citation></ref><ref id="CR29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedrich</surname><given-names>O.</given-names></name></person-group><article-title xml:lang="en">Weighted essentially non-oscillatory schemes for the interpolation of mean values on unstructured grids</article-title><source>J. Comput. Phys.</source><year>1998</year><volume>144</volume><fpage>194</fpage><lpage>212</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998JCoPh.144..194F</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1633049</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1998.5988</pub-id></mixed-citation></ref><ref id="CR30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giraldo</surname><given-names>F.X.</given-names></name></person-group><article-title xml:lang="en">Lagrange–Galerkin methods on spherical geodesic grids</article-title><source>J. Comput. Phys.</source><year>1997</year><volume>136</volume><fpage>197</fpage><lpage>213</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1997JCoPh.136..197G</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1468632</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1997.5771</pub-id></mixed-citation></ref><ref id="CR31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorski</surname><given-names>K.M.</given-names></name><name><surname>Hivon</surname><given-names>E.</given-names></name><name><surname>Banday</surname><given-names>A.J.</given-names></name><name><surname>Wandelt</surname><given-names>B.D.</given-names></name><name><surname>Hansen</surname><given-names>F.K.</given-names></name><name><surname>Reinecke</surname><given-names>M.</given-names></name><name><surname>Bartelmann</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">HEALPix: a framework for high-resolution discretization and fast analysis of data distributed on the sphere</article-title><source>Astrophys. J.</source><year>2005</year><volume>622</volume><fpage>759</fpage><lpage>771</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005ApJ...622..759G</pub-id><pub-id pub-id-type="doi">10.1086/427976</pub-id></mixed-citation></ref><ref id="CR32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X.</given-names></name><name><surname>Florinski</surname><given-names>V.</given-names></name></person-group><article-title xml:lang="en">Galactic cosmic-ray intensity modulation by corotating interaction region stream interfaces at 1 AU</article-title><source>Astrophys. J.</source><year>2016</year><volume>826</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...826...65G</pub-id><pub-id pub-id-type="doi">10.3847/0004-637X/826/1/65</pub-id></mixed-citation></ref><ref id="CR33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X.</given-names></name><name><surname>Florinski</surname><given-names>V.</given-names></name><name><surname>Wang</surname><given-names>C.</given-names></name></person-group><article-title xml:lang="en">Effects of anomalous cosmic rays on the structure of the outer heliosphere</article-title><source>Astrophys. J.</source><year>2018</year><volume>859</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...859..157G</pub-id><pub-id pub-id-type="doi">10.3847/1538-4357/aabf42</pub-id></mixed-citation></ref><ref id="CR34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurski</surname><given-names>K.F.</given-names></name></person-group><article-title xml:lang="en">An HLLC-type approximate Riemann solver for ideal magnetohydrodynamics</article-title><source>SIAM J. Sci. Comput.</source><year>2004</year><volume>25</volume><fpage>2165</fpage><lpage>2187</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2086836</pub-id><pub-id pub-id-type="doi">10.1137/S1064827502407962</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1133.76358</pub-id></mixed-citation></ref><ref id="CR35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harten</surname><given-names>A.</given-names></name><name><surname>Lax</surname><given-names>P.D.</given-names></name><name><surname>van Leer</surname><given-names>B.</given-names></name></person-group><article-title xml:lang="en">On upstream differencing and Godunov-type schemes for hyperbolic conservation laws</article-title><source>SIAM Rev.</source><year>1983</year><volume>25</volume><fpage>35</fpage><lpage>61</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">693713</pub-id><pub-id pub-id-type="doi">10.1137/1025002</pub-id></mixed-citation></ref><ref id="CR36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harten</surname><given-names>A.</given-names></name><name><surname>Osher</surname><given-names>S.</given-names></name></person-group><article-title xml:lang="en">Uniformly high-order accurate nonoscillatory schemes. I</article-title><source>SIAM J. Numer. Anal.</source><year>1987</year><volume>2</volume><fpage>279</fpage><lpage>309</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">881365</pub-id><pub-id pub-id-type="doi">10.1137/0724022</pub-id></mixed-citation></ref><ref id="CR37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heikes</surname><given-names>R.</given-names></name><name><surname>Randall</surname><given-names>D.A.</given-names></name></person-group><article-title xml:lang="en">Numerical integration of the shallow-water equations on a twisted icosahedral grid. Part I. Basic design and results of tests</article-title><source>Mon. Weather Rev.</source><year>1995</year><volume>123</volume><fpage>1862</fpage><lpage>1880</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995MWRv..123.1862H</pub-id><pub-id pub-id-type="doi">10.1175/1520-0493(1995)123&lt;1862:NIOTSW&gt;2.0.CO;2</pub-id></mixed-citation></ref><ref id="CR38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heikes</surname><given-names>R.</given-names></name><name><surname>Randall</surname><given-names>D.A.</given-names></name></person-group><article-title xml:lang="en">Numerical integration of the shallow-water equations on a twisted icosahedral grid. Part II. A detailed description of the grid and an analysis of numerical accuracy</article-title><source>Mon. Weather Rev.</source><year>1995</year><volume>123</volume><fpage>1881</fpage><lpage>1887</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995MWRv..123.1881H</pub-id><pub-id pub-id-type="doi">10.1175/1520-0493(1995)123&lt;1881:NIOTSW&gt;2.0.CO;2</pub-id></mixed-citation></ref><ref id="CR39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivan</surname><given-names>L.</given-names></name><name><surname>De Sterck</surname><given-names>H.</given-names></name><name><surname>Northrup</surname><given-names>S.A.</given-names></name><name><surname>Groth</surname><given-names>C.P.T.</given-names></name></person-group><article-title xml:lang="en">Multi-dimensional finite-volume scheme for hyperbolic conservation laws on three-dimensional solution-adaptive cubed-sphere grids</article-title><source>J. Comput. Phys.</source><year>2013</year><volume>255</volume><fpage>205</fpage><lpage>227</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013JCoPh.255..205I</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3109785</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2013.08.008</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1349.76340</pub-id></mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivan</surname><given-names>L.</given-names></name><name><surname>De Sterck</surname><given-names>H.</given-names></name><name><surname>Susanto</surname><given-names>A.</given-names></name><name><surname>Groth</surname><given-names>C.P.T.</given-names></name></person-group><article-title xml:lang="en">High-order central ENO finite-volume scheme for hyperbolic conservation laws on three-dimensional cubed-sphere grids</article-title><source>J. Comput. Phys.</source><year>2015</year><volume>282</volume><fpage>157</fpage><lpage>182</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015JCoPh.282..157I</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3291447</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2014.11.002</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1352.65281</pub-id></mixed-citation></ref><ref id="CR41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>G.-S.</given-names></name><name><surname>Shu</surname><given-names>C.-W.</given-names></name></person-group><article-title xml:lang="en">Efficient implementation of weighted ENO schemes</article-title><source>J. Comput. Phys.</source><year>1995</year><volume>126</volume><fpage>202</fpage><lpage>228</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996JCoPh.126..202J</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1391627</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1996.0130</pub-id></mixed-citation></ref><ref id="CR42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kageyama</surname><given-names>A.</given-names></name><name><surname>Sato</surname><given-names>T.</given-names></name></person-group><article-title xml:lang="en">“Yin–Yang grid”: an overset grid in spherical geometry</article-title><source>Geochem. Geophys. Geosyst.</source><year>2004</year><volume>5</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004GGG.....5.9005K</pub-id><pub-id pub-id-type="doi">10.1029/2004GC000734</pub-id></mixed-citation></ref><ref id="CR43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Käser</surname><given-names>M.</given-names></name><name><surname>Iske</surname><given-names>A.</given-names></name></person-group><article-title xml:lang="en">ADER schemes on adaptive triangular meshes for scalar conservation laws</article-title><source>J. Comput. Phys.</source><year>2005</year><volume>205</volume><fpage>486</fpage><lpage>508</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005JCoPh.205..486K</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2134991</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2004.11.015</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1072.65116</pub-id></mixed-citation></ref><ref id="CR44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koldoba</surname><given-names>A.V.</given-names></name><name><surname>Romanova</surname><given-names>M.M.</given-names></name><name><surname>Ustyugova</surname><given-names>G.V.</given-names></name><name><surname>Lovelace</surname><given-names>R.V.E.</given-names></name></person-group><article-title xml:lang="en">Three-dimensional magnetohydrodynamic simulations of accretion to an inclined rotator: the “cubed sphere” method</article-title><source>Astrophys. J.</source><year>2002</year><volume>576</volume><fpage>L53</fpage><lpage>L56</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002ApJ...576L..53K</pub-id><pub-id pub-id-type="doi">10.1086/342780</pub-id></mixed-citation></ref><ref id="CR45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S.</given-names></name></person-group><article-title xml:lang="en">An HLLC Riemann solver for magneto-hydrodynamics</article-title><source>J. Comput. Phys.</source><year>2005</year><volume>203</volume><fpage>344</fpage><lpage>357</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005JCoPh.203..344L</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2104400</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2004.08.020</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1299.76302</pub-id></mixed-citation></ref><ref id="CR46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X.-D.</given-names></name><name><surname>Osher</surname><given-names>S.</given-names></name><name><surname>Chan</surname><given-names>T.</given-names></name></person-group><article-title xml:lang="en">Weighted essentially non-oscillatory schemes</article-title><source>J. Comput. Phys.</source><year>1994</year><volume>115</volume><fpage>200</fpage><lpage>212</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994JCoPh.115..200L</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1300340</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1994.1187</pub-id></mixed-citation></ref><ref id="CR47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miura</surname><given-names>H.</given-names></name></person-group><article-title xml:lang="en">An upwind-biased conservative advection scheme for spherical hexagonal–pentagonal grids</article-title><source>Mon. Weather Rev.</source><year>2007</year><volume>135</volume><fpage>4038</fpage><lpage>4044</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007MWRv..135.4038M</pub-id><pub-id pub-id-type="doi">10.1175/2007MWR2101.1</pub-id></mixed-citation></ref><ref id="CR48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyoshi</surname><given-names>T.</given-names></name><name><surname>Kusano</surname><given-names>K.</given-names></name></person-group><article-title xml:lang="en">A multi-state HLL approximate Riemann solver for ideal magnetohydrodynamics</article-title><source>J. Comput. Phys.</source><year>2005</year><volume>208</volume><fpage>315</fpage><lpage>344</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005JCoPh.208..315M</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2144700</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2005.02.017</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1114.76378</pub-id></mixed-citation></ref><ref id="CR49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakamizo</surname><given-names>A.</given-names></name><name><surname>Tanaka</surname><given-names>T.</given-names></name><name><surname>Kubo</surname><given-names>Y.</given-names></name><name><surname>Kamei</surname><given-names>S.</given-names></name><name><surname>Shimazu</surname><given-names>H.</given-names></name><name><surname>Shinagawa</surname><given-names>H.</given-names></name></person-group><article-title xml:lang="en">Development of the 3-D MHD model of the solar corona-solar wind combining system</article-title><source>J. Geophys. Res.</source><year>2009</year><volume>114</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009JGRA..114.7109N</pub-id><pub-id pub-id-type="doi">10.1029/2008JA013844</pub-id></mixed-citation></ref><ref id="CR50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ollivier-Gooch</surname><given-names>C.</given-names></name><name><surname>Van Altena</surname><given-names>M.</given-names></name></person-group><article-title xml:lang="en">A high-order-accurate unstructured mesh finite-volume scheme for the advection-diffusion equation</article-title><source>J. Comput. Phys.</source><year>2002</year><volume>181</volume><fpage>729</fpage><lpage>752</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002JCoPh.181..729O</pub-id><pub-id pub-id-type="doi">10.1006/jcph.2002.7159</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1178.76251</pub-id></mixed-citation></ref><ref id="CR51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>P.S.</given-names></name><name><surname>Barros</surname><given-names>S.R.M.</given-names></name></person-group><article-title xml:lang="en">Analysis of grid imprinting on geodesic spherical icosahedral grids</article-title><source>J. Comput. Phys.</source><year>2013</year><volume>237</volume><fpage>61</fpage><lpage>78</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013JCoPh.237...61P</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3020021</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2012.11.041</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1286.65118</pub-id></mixed-citation></ref><ref id="CR52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>N.A.</given-names></name></person-group><article-title xml:lang="en">Numerical integration of the primitive equations on the hemisphere</article-title><source>Mon. Weather Rev.</source><year>1959</year><volume>87</volume><fpage>333</fpage><lpage>345</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1959MWRv...87..333P</pub-id><pub-id pub-id-type="doi">10.1175/1520-0493(1959)087&lt;0333:NIOTPE&gt;2.0.CO;2</pub-id></mixed-citation></ref><ref id="CR53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pudykiewicz</surname><given-names>J.A.</given-names></name></person-group><article-title xml:lang="en">Numerical solution of the reaction-advection-diffusion equation on the sphere</article-title><source>J. Comput. Phys.</source><year>2006</year><volume>213</volume><fpage>358</fpage><lpage>390</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006JCoPh.213..358P</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2203444</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2005.08.021</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1089.65095</pub-id></mixed-citation></ref><ref id="CR54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Putman</surname><given-names>W.M.</given-names></name><name><surname>Lin</surname><given-names>S.-J.</given-names></name></person-group><article-title xml:lang="en">Finite-volume transport on various cubed-sphere grids</article-title><source>J. Comput. Phys.</source><year>2007</year><volume>227</volume><fpage>55</fpage><lpage>78</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007JCoPh.227...55P</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2361517</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2007.07.022</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1126.76038</pub-id></mixed-citation></ref><ref id="CR55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronchi</surname><given-names>C.</given-names></name><name><surname>Iacono</surname><given-names>R.</given-names></name><name><surname>Paolucci</surname><given-names>P.S.</given-names></name></person-group><article-title xml:lang="en">The “cubed sphere”: a new method for the solution of partial differential equations in spherical geometry</article-title><source>J. Comput. Phys.</source><year>1996</year><volume>124</volume><fpage>93</fpage><lpage>114</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996JCoPh.124...93R</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1378553</pub-id><pub-id pub-id-type="doi">10.1006/jcph.1996.0047</pub-id></mixed-citation></ref><ref id="CR56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>D.</given-names></name><name><surname>Miniati</surname><given-names>F.</given-names></name><name><surname>Jones</surname><given-names>T.W.</given-names></name><name><surname>Frank</surname><given-names>A.</given-names></name></person-group><article-title xml:lang="en">A divergence-free upwind code for multidimensional magnetohydrodynamic flows</article-title><source>Astrophys. J.</source><year>1998</year><volume>509</volume><fpage>244</fpage><lpage>255</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...509..244R</pub-id><pub-id pub-id-type="doi">10.1086/306481</pub-id></mixed-citation></ref><ref id="CR57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadourny</surname><given-names>R.</given-names></name><name><surname>Arakawa</surname><given-names>A.</given-names></name><name><surname>Mintz</surname><given-names>Y.</given-names></name></person-group><article-title xml:lang="en">Integration of the nondivergent barotropic vorticity equation with an icosahedral-hexagonal grid for the sphere</article-title><source>Mon. Weather Rev.</source><year>1968</year><volume>96</volume><fpage>351</fpage><lpage>356</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1968MWRv...96..351S</pub-id><pub-id pub-id-type="doi">10.1175/1520-0493(1968)096&lt;0351:IOTNBV&gt;2.0.CO;2</pub-id></mixed-citation></ref><ref id="CR58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>C.-W.</given-names></name><name><surname>Osher</surname><given-names>S.</given-names></name></person-group><article-title xml:lang="en">Efficient implementation of essentially non-oscillatory shock-capturing schemes</article-title><source>J. Comput. Phys.</source><year>1988</year><volume>77</volume><fpage>439</fpage><lpage>471</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1988JCoPh..77..439S</pub-id><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">954915</pub-id><pub-id pub-id-type="doi">10.1016/0021-9991(88)90177-5</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0653.65072</pub-id></mixed-citation></ref><ref id="CR59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomita</surname><given-names>H.</given-names></name><name><surname>Tsugawa</surname><given-names>M.</given-names></name><name><surname>Satoh</surname><given-names>M.</given-names></name><name><surname>Goto</surname><given-names>K.</given-names></name></person-group><article-title xml:lang="en">Shallow water model on a modified icosahedral geodesic grid by using spring dynamics</article-title><source>J. Comput. Phys.</source><year>2001</year><volume>174</volume><fpage>579</fpage><lpage>613</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001JCoPh.174..579T</pub-id><pub-id pub-id-type="doi">10.1006/jcph.2001.6897</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1056.76058</pub-id></mixed-citation></ref><ref id="CR60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ullrich</surname><given-names>P.A.</given-names></name><name><surname>Taylor</surname><given-names>M.A.</given-names></name></person-group><article-title xml:lang="en">Arbitrary-order conservative and consistent remapping and a theory of linear maps: part I</article-title><source>Mon. Weather Rev.</source><year>2015</year><volume>143</volume><fpage>2419</fpage><lpage>2440</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015MWRv..143.2419U</pub-id><pub-id pub-id-type="doi">10.1175/MWR-D-14-00343.1</pub-id></mixed-citation></ref><ref id="CR61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Usmanov</surname><given-names>A.V.</given-names></name><name><surname>Goldstein</surname><given-names>M.L.</given-names></name><name><surname>Matthaeus</surname><given-names>W.H.</given-names></name></person-group><article-title xml:lang="en">Three-dimensional magnetohydrodynamic modeling of the solar wind including pickup protons and turbulence transport</article-title><source>Astrophys. J.</source><year>2012</year><volume>754</volume><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012ApJ...754...40U</pub-id><pub-id pub-id-type="doi">10.1088/0004-637X/754/1/40</pub-id></mixed-citation></ref><ref id="CR62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weller</surname><given-names>H.</given-names></name><name><surname>Thuburn</surname><given-names>J.</given-names></name><name><surname>Cotter</surname><given-names>C.J.</given-names></name></person-group><article-title xml:lang="en">Computational modes and grid imprinting on five quasi-uniform spherical C grids</article-title><source>Mon. Weather Rev.</source><year>2012</year><volume>140</volume><fpage>2734</fpage><lpage>2755</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012MWRv..140.2734W</pub-id><pub-id pub-id-type="doi">10.1175/MWR-D-11-00193.1</pub-id></mixed-citation></ref><ref id="CR63"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zienkiewicz</surname><given-names>O.C.</given-names></name><name><surname>Taylor</surname><given-names>R.L.</given-names></name><name><surname>Zhu</surname><given-names>J.Z.</given-names></name></person-group><source>The Finite Element Method: Its Basis and Fundamentals</source><year>2013</year><edition>5</edition><publisher-loc>Oxford</publisher-loc><publisher-name>Butterworth</publisher-name><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1307.74005</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1"><sec id="Sec24"><title>Appendix A: Basis functions for triangular faces</title><p id="Par92">Linear elements: nodal points at vertices, <disp-formula id="Equ68"><label>68</label><alternatives><mml:math id="Equ68_Math"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \psi _{1}=1-\xi -\frac{1}{\sqrt{3}}\eta , \\&amp; \psi _{2}=\xi -\frac{1}{\sqrt{3}}\eta , \\&amp; \psi _{3}=\frac{2}{\sqrt{3}}\eta , \\&amp; \phi _{1}=1-\delta , \\&amp; \phi _{2}=\delta . \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ68.gif" position="anchor"/></alternatives></disp-formula> Quadratic elements: nodal points at vertices and edge midpoints, <disp-formula id="Equ69"><label>69</label><alternatives><mml:math id="Equ69_Math"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>8</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>8</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>8</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ψ</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned}&amp; \psi _{1} = 1-3\xi -\sqrt{3}\eta +2\xi ^{2}+ \frac{4}{\sqrt{3}}\xi \eta +\frac{2}{3}\eta ^{2}, \\&amp; \psi _{2} = -\xi +\frac{1}{\sqrt{3}}\eta +2\xi ^{2}- \frac{4}{\sqrt{3}}\xi \eta +\frac{2}{3}\eta ^{2}, \\&amp; \psi _{3} = -\frac{2}{\sqrt{3}}\eta +\frac{8}{3}\eta ^{2}, \\&amp; \psi _{4} = \frac{8}{\sqrt{3}}\xi \eta -\frac{8}{3}\eta ^{2}, \\&amp; \psi _{5} = \frac{8}{\sqrt{3}}\eta -\frac{8}{\sqrt{3}}\xi \eta - \frac{8}{3}\eta ^{2}, \\&amp; \psi _{6} = 4\xi -\frac{4}{\sqrt{3}}\eta -4\xi ^{2}+ \frac{4}{3}\eta ^{2}, \\&amp; \phi _{1} = 1-3\delta +2\delta ^{2}, \\&amp; \phi _{2} = -\delta +2\delta ^{2}, \\&amp; \phi _{3} = 4\delta -4\delta ^{2}. \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ69.gif" position="anchor"/></alternatives></disp-formula> Cubic elements: nodal points at vertices, edge thirds, and geometric center, <disp-formula id="Equ70"><label>70</label><alternatives><mml:math id="Equ70_Math"><mml:mtable><mml:mtr><mml:mtd><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>11</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mfrac><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>18</mml:mn><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>18</mml:mn><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>21</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>18</mml:mn><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>6</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>15</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>15</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>18</mml:mn><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mn>9</mml:mn><mml:mi>ξ</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>45</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>15</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>27</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnalign="right left" columnspacing="0.2em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>18</mml:mn><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>27</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>ξ</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>18</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>ξ</mml:mi><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>18</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>18</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>η</mml:mi><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>η</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>45</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>27</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mn>18</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>27</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \begin{gathered} \begin{aligned} \psi _{1} = {}&amp;1-\frac{11}{2}\xi - \frac{11}{2\sqrt{3}}\eta +9\xi ^{2}+6 \sqrt{3}\xi \eta +3\eta ^{2}-\frac{9}{2}\xi ^{3} \\ &amp;{} -\frac{9\sqrt{3}}{2} \xi ^{2}\eta -\frac{9}{2}\xi \eta ^{2}-\frac{\sqrt{3}}{2} \eta ^{3}, \end{aligned} \\ \begin{aligned} \psi _{2} = {}&amp;\xi -\frac{1}{\sqrt{3}}\eta -\frac{9}{2}\xi ^{2}+3\sqrt{3} \xi \eta -\frac{3}{2}\eta ^{2}+ \frac{9}{2}\xi ^{3}- \frac{9\sqrt{3}}{2}\xi ^{2}\eta \\ &amp;{} + \frac{9}{2}\xi \eta ^{2}- \frac{\sqrt{3}}{2}\eta ^{3}, \end{aligned} \\ \psi _{3} = \frac{2}{\sqrt{3}}\eta -6\eta ^{2}+4\sqrt{3}\eta ^{3}, \\ \psi _{4} = -3\sqrt{3}\xi \eta +3\eta ^{2}+9\sqrt{3}\xi ^{2}\eta -18 \xi \eta ^{2}+3\sqrt{3}\eta ^{3}, \\ \psi _{5} = -3\sqrt{3}\xi \eta +3\eta ^{2}+18\xi \eta ^{2}-6\sqrt{3} \eta ^{3}, \\ \psi _{6} = -3\sqrt{3}\eta +3\sqrt{3}\xi \eta +21\eta ^{2}-18\xi \eta ^{2}-6\sqrt{3}\eta ^{3}, \\ \begin{aligned} \psi _{7} = {}&amp;6\sqrt{3}\eta -15\sqrt{3}\xi \eta -15\eta ^{2}+9\sqrt{3} \xi ^{2}\eta +18\xi \eta ^{2} \\ &amp;{}+3 \sqrt{3}\eta ^{3}, \end{aligned} \\ \begin{aligned} \psi _{8} = {}&amp;9\xi -3\sqrt{3}\eta -\frac{45}{2}\xi ^{2}+\frac{15}{2} \eta ^{2}+\frac{27}{2}\xi ^{3}+\frac{9\sqrt{3}}{2}\xi ^{2}\eta \\ &amp;{}- \frac{9}{2}\xi \eta ^{2}-\frac{3\sqrt{3}}{2}\eta ^{3}, \end{aligned} \\ \begin{aligned} \psi _{9} &amp;= -\frac{9}{2}\xi +3\frac{3\sqrt{3}}{2}\eta +18\xi ^{2}-9 \sqrt{3}\xi \eta +3\eta ^{2}-\frac{27}{2}\xi ^{3} \\ &amp;\quad{} +\frac{9\sqrt{3}}{2} \xi ^{2}\eta +\frac{9}{2}\xi \eta ^{2}-\frac{3\sqrt{3}}{2}\eta ^{3}, \end{aligned} \\ \psi _{10} = 18\sqrt{3}\xi \eta -18\eta ^{2}-18\sqrt{3}\xi ^{2}\eta -6 \sqrt{3}\eta ^{3}, \\ \phi _{1} = 1-\frac{11}{2}\delta +9\delta ^{2}- \frac{9}{2}\delta ^{3}, \\ \phi _{2} = \delta -\frac{9}{2}\delta ^{2}+ \frac{9}{2}\delta ^{3}, \\ \phi _{3} = 9\delta -\frac{45}{2}\delta ^{2}+ \frac{27}{2}\delta ^{3}, \\ \phi _{4} = -\frac{9}{2}\delta +18\delta ^{2}- \frac{27}{2}\delta ^{3}. \end{gathered} \end{aligned}$$ \end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ70.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec25"><title>Appendix B: Reconstruction accuracy vs. stencil size</title><p id="Par93">To determine whether the stencil configuration affects the accuracy of the reconstructed solution, we conducted a statistical test by initializing a single grid block with an ensemble of <inline-formula id="IEq218"><alternatives><mml:math id="IEq218_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="IEq218_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{w}=10$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq218.gif"/></alternatives></inline-formula> waves with isotropically distributed wavevectors <inline-formula id="IEq219"><alternatives><mml:math id="IEq219_Math"><mml:msub><mml:mi mathvariant="bold">k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq219_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf{k}_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq219.gif"/></alternatives></inline-formula> and random phases <inline-formula id="IEq220"><alternatives><mml:math id="IEq220_Math"><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq220_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varphi _{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq220.gif"/></alternatives></inline-formula>, <disp-formula id="Equ71"><label>71</label><alternatives><mml:math id="Equ71_Math"><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:munderover><mml:mo>cos</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math><tex-math id="Equ71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ U(\mathbf{x})=\frac{1}{N_{w}}\sum_{j=1}^{N_{w}} \cos (\mathbf{k}_{j} \cdot \mathbf{x}+\varphi _{j}), $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_Equ71.gif" position="anchor"/></alternatives></disp-formula> where <italic>U</italic> is the scalar variable to be reconstructed. The wavelengths <inline-formula id="IEq221"><alternatives><mml:math id="IEq221_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><tex-math id="IEq221_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\lambda _{j}=2\pi /k_{j}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq221.gif"/></alternatives></inline-formula> were logarithmically distributed between <inline-formula id="IEq222"><alternatives><mml:math id="IEq222_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><tex-math id="IEq222_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\lambda _{\mathrm{min}}=1$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq222.gif"/></alternatives></inline-formula> and <inline-formula id="IEq223"><alternatives><mml:math id="IEq223_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math><tex-math id="IEq223_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\lambda _{\mathrm{max}}=10$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq223.gif"/></alternatives></inline-formula>. For this test we used fourth order of accuracy because it offers the largest choice of stencils. A single division 1 block with 16 shells, <inline-formula id="IEq224"><alternatives><mml:math id="IEq224_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.71</mml:mn></mml:math><tex-math id="IEq224_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{min}}=1.71$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq224.gif"/></alternatives></inline-formula>, <inline-formula id="IEq225"><alternatives><mml:math id="IEq225_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2.92</mml:mn></mml:math><tex-math id="IEq225_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\mathrm{max}}=2.92$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq225.gif"/></alternatives></inline-formula>, and division 5 t-faces was used. Shell spacing was exponential as given by Eq. (<xref rid="Equ27" ref-type="disp-formula">27</xref>).</p><p id="Par94">Figure <xref rid="Fig18" ref-type="fig">18</xref> shows the average <inline-formula id="IEq227"><alternatives><mml:math id="IEq227_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq227_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq227.gif"/></alternatives></inline-formula> error, its standard deviation, and the largest error over all trials, as a function of the number of zones in the stencil that varied between <inline-formula id="IEq228"><alternatives><mml:math id="IEq228_Math"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math><tex-math id="IEq228_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D(3)=20$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq228.gif"/></alternatives></inline-formula> and <inline-formula id="IEq229"><alternatives><mml:math id="IEq229_Math"><mml:mn>3</mml:mn><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:math><tex-math id="IEq229_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3D(3)=60$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq229.gif"/></alternatives></inline-formula>. Interestingly, both the average and the maximum errors are slowly increasing with the stencil size, although a zero trend would also be consistent with the error bars. This trend was previously observed by Ivan et al. (<xref ref-type="bibr" rid="CR40">2015</xref>), who suggested that smaller stencils provide higher accuracy because the reconstruction data is more local to the zone. The only exception is the first point corresponding to the stencil of the smallest possible size. It would seem reasonable, then, to use smaller stencils as long as they have a few extra zones to benefit from the least square procedure. One has to remember, however, that this result may not hold for every problems or mesh configuration. <fig id="Fig18"><label>Figure 18</label><caption xml:lang="en"><p>Fourth order reconstruction error for different size stencils. Average of <inline-formula id="IEq226"><alternatives><mml:math id="IEq226_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq226_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L_{1}$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40668_2020_33_Article_IEq226.gif"/></alternatives></inline-formula> reconstruction error (circles) with standard deviation, shown as error bars, and the largest error, shown with square symbols, on a division 1 block with division 5 faces and 16 radial shells. Averaging was done over 1000 trials, each initialized with a random ensemble of ten waves with isotropically distributed wavevectors. Stencil configuration is color-coded; the value of <italic>X</italic> can be deduced by subtracting the sum of zones in all planes, save the principal plane, from the total number of zones on the horizontal axis</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40668_2020_33_Fig18_HTML.png" position="anchor"/></fig></p></sec></app></app-group></back></article></records><facets><facet name="subject"><facet-value count="1">Astronomy, Astrophysics and Cosmology</facet-value><facet-value count="1">Computational Mathematics and Numerical Analysis</facet-value><facet-value count="1">Numeric Computing</facet-value><facet-value count="1">Physics</facet-value></facet><facet name="keyword"><facet-value count="1">Divergence free MHD</facet-value><facet-value count="1">Finite volume scheme</facet-value><facet-value count="1">Geodesic mesh</facet-value></facet><facet name="pub"><facet-value count="1">Computational Astrophysics and Cosmology</facet-value></facet><facet name="year"><facet-value count="1">2020</facet-value></facet><facet name="country"><facet-value count="1">South Korea</facet-value><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
