<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s13705-016-0071-2</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" specific-use="web-only" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">13705</journal-id><journal-id journal-id-type="doi">10.1007/13705.2192-0567</journal-id><journal-title-group><journal-title>Energy, Sustainability and Society</journal-title><abbrev-journal-title abbrev-type="publisher">Energ Sustain Soc</abbrev-journal-title></journal-title-group><issn pub-type="epub">2192-0567</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s13705-016-0071-2</article-id><article-id pub-id-type="manuscript">71</article-id><article-id pub-id-type="doi">10.1186/s13705-016-0071-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">RBF neural network-based online intelligent management of a battery energy storage system for stand-alone microgrids</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Kerdphol</surname><given-names>Thongchart</given-names></name><address><email>n589504k@mail.kyutech.jp</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs1370501600712_cor1">a</xref></contrib><contrib contrib-type="author"><name><surname>Qudaih</surname><given-names>Yaser</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Watanabe</surname><given-names>Masayuki</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mitani</surname><given-names>Yasunori</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.258806.1</institution-id><institution-id institution-id-type="ISNI">0000000121101386</institution-id><institution content-type="org-division">Department of Electrical and Electronics Engineering</institution><institution content-type="org-name">Kyushu Institute of Technology</institution></institution-wrap><addr-line content-type="street">1-1, Sensui-cho, Tobata-ku, Kitakyushu-shi</addr-line><addr-line content-type="postcode">804-8550</addr-line><addr-line content-type="city">Fukuoka</addr-line><country country="JP">Japan</country></aff></contrib-group><author-notes><corresp id="IDs1370501600712_cor1"><label>a</label><email>n589504k@mail.kyutech.jp</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>23</day><month>2</month><year>2016</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2016</year></pub-date><volume>6</volume><issue seq="5">1</issue><elocation-id>5</elocation-id><history><date date-type="registration"><day>3</day><month>2</month><year>2016</year></date><date date-type="received"><day>1</day><month>10</month><year>2015</year></date><date date-type="accepted"><day>3</day><month>2</month><year>2016</year></date><date date-type="online"><day>23</day><month>2</month><year>2016</year></date></history><permissions><copyright-statement content-type="compact">© Kerdphol et al. 2016</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Kerdphol et al.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><sec id="ASec1"><title>Background</title><p id="Par1">An offline optimization approach based on energy storage management response in a microgrid was not fast and not reliable enough to control and adjust the system efficiently after the loss of the utility grid. Thus, it causes system inefficiency and collapse in the presence of violent changes of loads or outage of distributed generations. To solve such a problem, more real-time management is needed. Any changes in loads/generations should be compensated successfully by a battery energy storage system (BESS) in a short period of time.</p></sec><sec id="ASec2"><title>Methods</title><p id="Par2">This paper presents a new method for the intelligent online management of both active and reactive power of a BESS based on a radial basis function neural network (RBFNN) incorporating particle swarm optimization (PSO) to prevent the stand-alone microgrid from instability and system collapse. BESS is centrally controlled by a controller developed by the proposed RBFNN. PSO is used to determine the optimized active and reactive power at every load/generation changing situation to monitor the effect of system frequency, voltage, and reference power regulation. These optimized power data are then employed as target data for the RBFNN generalization and training process. To enable the online updating of the operating parameters, the proposed RBFNN is implemented in the management process. With an appropriate RBFNN training, the optimum active and reactive power can directly be obtained without the necessity of performing the PSO optimization process at any change of load/generation.</p></sec><sec id="ASec3"><title>Results</title><p id="Par3">The results show that the predictive results of the proposed RBFNN model only slightly differed from the target results based on PSO and have a minimum statistical error compared to the predictive results based on the multilayer perceptron neural network (MLPNN) model.</p></sec><sec id="ASec4"><title>Conclusions</title><p id="Par4">The proposed RBFNN is suitable for the online estimation of the active and reactive power of BESS and can be used for real-time energy storage management as an online controller.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>RBF neural network</kwd><kwd>Battery energy storage system</kwd><kwd>Energy management</kwd><kwd>Frequency and voltage control</kwd><kwd>Microgrid</kwd><kwd>Optimization</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/13705_2016_Article_71.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Sustainable Development</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Policy, Economics and Management</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Policy, Economics and Management</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Background</title><p id="Par5">During the great earthquake and tsunami in March 2011 and the heavy snowfall disaster in Tokushima, Japan, in December 2014, thousands of people had no access to electricity. IP telephone systems using the Internet which spreads in almost all families were not able to operate at that time. It caused difficulties to rescue teams for providing assistance. Moreover, victims who lived in their homes could not get warm as their heaters were not able to operate at the time of the disaster [<xref ref-type="bibr" rid="CR1">1</xref>]. To solve such a situation, facilities are needed to provide electricity at the time of a blackout or disaster. Battery energy storage systems (BESS) can offer a good solution to such a system. Advantages of BESS include an improvement of the system frequency, especially when BESS is used for system frequency control. For small disturbances, BESS is discharging when the system frequency is lower than the nominal frequency of 50 or 60 Hz. On the other hand, BESS is charging when the system frequency is higher than the nominal frequency of 50 or 60 Hz. For large disturbances, BESS can enhance the performance of the system frequency control by integrating BESS with an under-frequency load shedding scheme or an under- or over-frequency generation trip. With these different functions, it can be concluded that BESS is a rapid and flexible element for power systems [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>].</p><p id="Par6">After the 2011 Japan earthquake and tsunami in the Tōhoku area, a micro/smart grid developed in Japan has been focused on resilience. As a solution of micro/smart grids, it promised to simplify the wide penetration of renewable energy sources (RESs) and BESS units into the power system and increase the reliability of electrical supply to consumers, but decrease system losses and greenhouse gas emissions. Due to their potential benefits of providing secure, reliable, efficient, sustainable, and environmentally friendly electricity from RESs, micro/smart grids have received great attention and became remarkable in electricity [<xref ref-type="bibr" rid="CR5">5</xref>].</p><p id="Par7">A concept of a micro/smart grid is demonstrated as a system that can intelligently integrate the actions of all users incorporating generators or loads in a manner suitable for providing an economically sustainable and secure power system [<xref ref-type="bibr" rid="CR6">6</xref>]. All signals at loads/generations will be processed by the system management and react to the situations which occurred optimally. By an intelligent management of the active and reactive power of BESS for a stand-alone microgrid, this technique can prevent the stand-alone microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations. In a number of studies, the aspect of a managing reference power of distributed generations in the distribution system has been presented [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. In [<xref ref-type="bibr" rid="CR10">10</xref>], the management of BESS power for the typical 4Q-load has been proposed and analyzed. Furthermore, an offline optimization approach based on a real-time energy storage management was proposed in [<xref ref-type="bibr" rid="CR11">11</xref>]. To control the system as efficiently as possible, more real-time management is needed. Any changes in loads/generations should be compensated successfully by the BESS in a short period of time. To perform the real-time online management operation in this study, radial basis function neural networks (RBFNNs) seem to be most suitable for such an online modeling method in terms of a fast time calculation process and instant responses. The advantages of RBFNN are two major issues: the training processes are substantially faster than the multilayer perceptron neural networks (MLPNN) and RBFNN does not encounter with the local minima problems [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. RBFNN provides a very significant tool for optimization tasks as they are extremely powerful computational devices with the capability of parallel processing, learning, generalization, and universal approximation [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p><p id="Par8">This paper deals with the online intelligent management of active and reactive power of the BESS installed in the microgrid to prevent the microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations after the loss of the utility grid (e.g., blackout or disaster). The BESS is centrally controlled by a controller developed by the proposed RBFNN. The active and reactive power of the BESS are managed by using the RBFNN incorporating a particle swarm optimization (PSO) process with the objective of maintaining the frequency and voltage of the stand-alone microgrid within acceptable ranges. First, the optimum settings of the BESS which are the optimized active and reactive power are determined by PSO. The PSO process has to reply to every change in load/generation to achieve the optimum operating conditions for the entire system. These optimized operating data are then applied as target data for RBFNN generalization and training processes. To enable the online updating of the operating parameters, the proposed RBFNN is implemented in the management process, and the database extracted from the PSO process is used as target data in the RBFNN generalization and training. With an appropriate RBFNN training, the well-trained RBFNN can be employed as the online mode where the system is using new input data. By applying the proposed RBFNN approach in the system, the optimum active and reactive power of the BESS can directly be obtained without the necessity of performing the optimization process-based PSO at any change in load/generation. The predictive results of the proposed RBFNN are compared with the predictive results of the MLPNN, and it is clearly shown that the proposed RBFNN-based online management method gave the best performance in predicting the optimum active and reactive power of the BESS for the microgrid.</p><p id="Par9">This paper, compared to other previous research contributions, deals with the ability to control the system as efficiently as possible by designing and implementing the real-time/online management of the BESS based on the proposed RBFNN for using it as an online controller to control, manage, and prevent the microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations after the loss of the utility grid.</p><sec id="Sec2"><title>System configuration</title><sec id="Sec3"><title>Microgrid study system</title><p id="Par10">The microgrid structure considered in this study consists of four major power sources: the 1.2-MW mini-hydro generator, the 2-MW hydro generator, the 3-MW solar photovoltaic sources, and the BESS as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Each distributed generation unit has its own local controller to handle the relevant electrical variables. This system also consists of a group of feeders which could be a part of the distribution design. The commercial loads 1 and 4 are the critical loads with a peak power of 1.85 and 1.9 MW, respectively. Office load 2, residential load 3, and residential load 5 are the non-critical loads with a peak power of 1.7, 1.75, and 2.4 MW, respectively.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>The typical microgrid system</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig1_HTML.gif" id="MO1"/></fig></p></sec></sec><sec id="Sec4"><title>Solar photovoltaic generation</title><p id="Par11">The output power of solar photovoltaic (PV) is uncertain as it is mostly affected by environmental factors, particularly environmental random changes inevitably leading to a constant change of the output power of solar PV [<xref ref-type="bibr" rid="CR16">16</xref>]. In order to illustrate the solar PV characteristics under the operating conditions, the influence of solar radiation and atmosphere temperature are designed. The temperature effect is denoted using a temperature coefficient of <italic>T</italic><sub>co</sub> (1/c°). The efficiency of the inverter is multiplied by the DC output converting DC to the AC output as in (1):<disp-formula id="Equ1"><label>1</label><alternatives><mml:math id="Equ1_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">ratePV</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mn>25</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{\mathrm{PV}}={n}_{\mathrm{PV}}{P}_{\mathrm{ratePV}}\left(G/{G}_0\right)\left(1-{T}_{\mathrm{co}}\left({T}_{\mathrm{A}}-{25}^{\circ}\right)\right){\eta}_{\mathrm{inv}}{\eta}_{\mathrm{rel}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ1.gif"/></alternatives></disp-formula>where <italic>n</italic><sub>PV</sub> is the PV module number, <italic>P</italic><sub>rate PV</sub> is the PV array rated power (W), <italic>G</italic> is the global insolation on PV array (W/m<sup>2</sup>), <italic>G</italic><sub>0</sub> is the standard amount of the insolation rating capacity of PV modules (W/m<sup>2</sup>), <italic>T</italic><sub>A</sub> is the ambient temperature, <italic>T</italic><sub>CO</sub> is the temperature coefficient of the maximum power of PV, <italic>ɳ</italic><sub>rel</sub> is the relative efficiency of the PV modules, and <italic>ɳ</italic><sub>inv</sub> is the efficiency of the inverter.</p></sec><sec id="Sec5"><title>BESS</title><p id="Par13">RESs are depending on weather conditions. Thus, a BESS is used to store surplus electrical energy to maintain the system frequency and voltage and supplies the power for loading into a microgrid in the case of low solar ratio or load changes. Moreover, the BESS can smooth the fluctuation of solar radiation and enhance the load availability. A more detailed BESS information, along with the most BESS models, is presented in various research papers, for instance in [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p><p id="Par14">The structure of the BESS comprises power converters, battery cells, and control parts, which are shown in Fig <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>The structure of the BESS in an interconnection diagram</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig2_HTML.gif" id="MO2"/></fig></p><p id="Par15">In this study, in the case of a grid-connected mode, in which the power generated by the microgrid system is higher than the load demand, the surplus power can be stored in a BESS for future uses. On the contrary, when there is any shortage in the power generation of the microgrid, the stored power is used to supply the load. For a stand-alone mode, the main purpose of the BESS is to stabilize the microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p><p id="Par16">From the BESS structure, the output of the DC voltage is expressed as:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math id="Equ2_Math"><mml:mi>Δ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">do</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>6</mml:mn><mml:msqrt><mml:mn>6</mml:mn></mml:msqrt></mml:mrow><mml:mi>π</mml:mi></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varDelta {E}_{\mathrm{do}}=\frac{6\sqrt{6}}{\pi }{E}_t $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ2.gif"/></alternatives></disp-formula>where <italic>E</italic><sub><italic>t</italic></sub> is the AC voltage between a line and neutral.</p><p id="Par18">The equivalent circuit analysis of a BESS consists of a converter connected to an equivalent battery, as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The terminal voltage of the equivalent battery is calculated from:<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Equivalent circuit of the BESS [<xref ref-type="bibr" rid="CR18">18</xref>]</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig3_HTML.gif" id="MO3"/></fig><disp-formula id="Equ3"><label>3</label><alternatives><mml:math id="Equ3_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">do</mml:mi></mml:msub><mml:mo>cos</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2.5em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>6</mml:mn></mml:msqrt></mml:mrow><mml:mi>π</mml:mi></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mo>cos</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mn>6</mml:mn><mml:mi>π</mml:mi></mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{E}_{\mathrm{bt}}=\varDelta {E}_{\mathrm{do}} \cos \alpha -{r}_c{I}_{\mathrm{BESS}}\\ {}\kern2.5em =\frac{3\sqrt{6}}{\pi }{E}_t\left( \cos {\alpha}_1- \cos {\alpha}_2\right)-\frac{6}{\pi }{X}_{\mathrm{co}}{I}_{\mathrm{BESS}}\end{array} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ3.gif"/></alternatives></disp-formula></p><p id="Par19">According to the equivalent circuit of the BESS, the expression of the DC current flowing into the battery is expressed as:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math id="Equ4_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {I}_{\mathrm{BESS}}=\frac{E_{\mathrm{b}\mathrm{t}}-{E}_{\mathrm{b}\mathrm{oc}}-{E}_{\mathrm{b}1}}{r_{\mathrm{b}\mathrm{t}}+{r}_{\mathrm{b}\mathrm{s}}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ4.gif"/></alternatives></disp-formula>where<disp-formula id="Equ5"><label>5</label><alternatives><mml:math id="Equ5_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">bp</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mi mathvariant="normal">bp</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{\mathrm{boc}}=\frac{r_{\mathrm{bp}}}{1+{\mathrm{ST}}_{\mathrm{bp}}}{I}_{\mathrm{BESS}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math id="Equ6_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{\mathrm{b}1}=\frac{r_{\mathrm{b}1}}{1+{\mathrm{ST}}_{\mathrm{b}1}}{I}_{\mathrm{BESS}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ6.gif"/></alternatives></disp-formula>where<disp-formula id="Equ7"><label>7</label><alternatives><mml:math id="Equ7_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">bp</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">bp</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">bp</mml:mi></mml:msub></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {T}_{\mathrm{bp}}={r}_{\mathrm{bp}}{C}_{\mathrm{bp}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><mml:math id="Equ8_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {T}_{\mathrm{b}1}={r}_{\mathrm{b}1}{C}_{\mathrm{b}1} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ8.gif"/></alternatives></disp-formula></p><p id="Par22">According to the converter circuit analysis, the active and reactive power injected or absorbed by the BESS are:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math id="Equ9_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>6</mml:mn></mml:msqrt></mml:mrow><mml:mi>π</mml:mi></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>cos</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{\mathrm{BESS}}=\frac{3\sqrt{6}}{\pi }{E}_t{I}_{\mathrm{BESS}}\left( \cos {\alpha}_1+ \cos {\alpha}_2\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ9.gif"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><mml:math id="Equ10_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>6</mml:mn></mml:msqrt></mml:mrow><mml:mi>π</mml:mi></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">BESS</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>sin</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>sin</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Q}_{\mathrm{BESS}}=\frac{3\sqrt{6}}{\pi }{E}_t{I}_{\mathrm{BESS}}\left( \sin {\alpha}_1+ \sin {\alpha}_2\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ10.gif"/></alternatives></disp-formula>where <italic>α</italic><sub><italic>i</italic></sub> is the firing delay angle of the converter <italic>i</italic>, <italic>E</italic><sub>do</sub> is the maximum DC voltage of the batteries, <italic>E</italic><sub>b1</sub> is the battery resistance, <italic>E</italic><sub>bt</sub> is the phase voltage of the battery side, <italic>E</italic><sub>boc</sub> is the battery open circuit voltage, <italic>I</italic><sub>BESS</sub> is the DC current through the battery, <italic>P</italic><sub>BESS</sub> is the active power provided by the batteries, <italic>Q</italic><sub>BESS</sub> is the reactive power provided by the batteries, <italic>r</italic><sub>c</sub> is the battery overvoltage, <italic>r</italic><sub>bt</sub> is the terminal voltage of the battery, <italic>r</italic><sub>bs</sub> is the battery internal resistance, <italic>r</italic><sub>bp</sub> is the self-discharge resistance, and <italic>r</italic><sub>b1</sub> is the overvoltage resistance [<xref ref-type="bibr" rid="CR19">19</xref>].</p><p id="Par24">By performing the offline optimization process, the optimized active and reactive power set points of the BESS are obtained. These optimized data are then used as target data for RBFNN/MLPNN generalization and the training process in the online optimization. With an appropriate RBFNN/MLPNN training process, the well-trained RBFNN/MLPNN can be used as the online mode where the system is using new input data and then the optimum active and reactive power of the BESS will be obtained and remotely adjusted via the communication link to the BESS.</p></sec><sec id="Sec6"><title>Test system explanation</title><p id="Par25">The proposed online management approach is applied to the typical microgrid system illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. To achieve a smart grid system with online capability, the microgrid is integrated in a highly developed communication technology which is also connected with the BESS as well as distributed generations and loads, thus enabling the coordinated control between generations and loads. The microgrid will be scanned by a data acquisition device for every half an hour of load demand for a 24-h operation. The data acquisition device measures the power output of solar PV and all load profiles. The acquired information is used to control the optimum operation of the BESS in subsequent intervals. The optimum active and reactive power of the BESS will be calculated by the control system so that they can be remotely adjusted via the communication link instantly after the loss of the utility grid.</p><p id="Par26">Three types of loads are involved in the studied microgrid, which are the residential, office, and commercial loads as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The load profile depends on the peaks and dips according to the various electricity usage situations. For the residential loads, a peak load occurs from 7 pm to 9 pm; for the office and commercial loads, a peak load occurs from 9 am to 5 pm every day, owing to the electricity usage during the office hours.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Load demand profiles</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig4_HTML.gif" id="MO4"/></fig></p></sec></sec><sec id="Sec7" sec-type="materials|methods"><title>Methods</title><sec id="Sec8"><title>ANN-based online optimum active and reactive power of the BESS</title><p id="Par27">The proposed approach for an intelligent online managing of active and reactive power of BESS consists of a two-stage method based on the PSO optimization process (stage 1) and the RBFNN or MLPNN approach (stage 2). The first step before performing the optimization process is to obtain both load data and solar PV power output data as the inputs of the PSO process. The optimization process is applied offline using PSO in the first stage in order to define the optimum daily performance of the BESS. In this study, the fluctuations of solar PV due to unpredicted weather conditions are considered in the case of both a sunny and a rainy day for both the RBFNN and MLPNN test systems as shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. By performing the optimization process using PSO, the optimized active and reactive power of the BESS are evaluated. These optimized data are then used as target data for the RBFNN/MLPNN generalization and the training process during the second stage.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>The solar PV power output for the RBFNN and MLPNN testing stage</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig5_HTML.gif" id="MO5"/></fig></p></sec><sec id="Sec9"><title>PSO-based offline optimization (stage 1)</title><p id="Par28">The offline optimization process can be performed by many methods such as using either a genetic algorithm (GA), or linear programming, or PSO, etc. However, according to [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>], the advantages of PSO include simplicity, ease of use, high convergence rates, and minimal storage requirements. Especially, PSO will be less dependent on the set of the initial points compared to other methods, which implies that the convergence algorithm is robust. Thus, the offline optimization process is performed by using PSO during the first stage in order to evaluate the optimum daily performance of the BESS as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Afterwards, these optimized parameters are used in the second stage for the RBFNN/MLPNN offline training process.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>A conceptual structure of the proposed PSO for stage 1</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig6_HTML.gif" id="MO6"/></fig></p><p id="Par29">The PSO process has to reply to every change in the load/PV generation in order to achieve the optimum operating conditions for the overall system. Hence, after any change of the load/PV data, the optimized power setting of the BESS will also be changed, with the result that a new optimization process is needed.</p><p id="Par30">PSO is an approach for evaluating the optimal parameters of complicated search spaces. PSO is initiated with a group of random particles to search for these optimal parameters by updating the generations. At each iteration step, each particle is improved by two values. These values are called <italic>P</italic><sub>best</sub> and <italic>G</italic><sub>best</sub>, respectively. <italic>P</italic><sub>best</sub> is the best solution acquired by each particle itself in all of the previous generations. <italic>G</italic><sub>best</sub> is the best value obtained by any particle during all previous iterations [<xref ref-type="bibr" rid="CR23">23</xref>]. This value is called the best global solution. Each particle improves its position and velocity by using (11) and (12):<disp-formula id="Equ11"><label>11</label><alternatives><mml:math id="Equ11_Math"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">best</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">best</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {v}_{i+1}={v}_i+{c}_1{r}_1\left({P}_{\mathrm{best}}-{x}_i\right)+{c}_2{r}_2\left({G}_{\mathrm{best}}-{x}_i\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ11.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><mml:math id="Equ12_Math"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{i+1}={v}_{i+1}+{x}_i $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ12.gif"/></alternatives></disp-formula>where <italic>i</italic> = 1, 2,…, <italic>N</italic>, <italic>N</italic> is the iteration number, <italic>v</italic><sub><italic>i</italic></sub> is the velocity of a particle at iteration <italic>i</italic>, <italic>x</italic><sub><italic>i</italic></sub> is the position of a particle at iteration <italic>i</italic>, <italic>P</italic><sub>best</sub> is the best solution at iteration <italic>i</italic>, <italic>G</italic><sub>best</sub> is the best global solution at iteration <italic>i</italic>, <italic>r</italic><sub>1</sub> is the random number one between 0 and 1, <italic>r</italic><sub>2</sub> is the random number two between 0 and 1, and <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> are the learning factors.</p><p id="Par32">The learning factors have important effects on the algorithm convergence rate. Future information for PSO can be found in [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. In this study, the number of iteration is 30. Learning factors are <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> which are equal to 1.4940. The inertia weight is 0.7920.</p><p id="Par33">For the PSO offline optimization approach, the aim of this part is to determine the optimized active and reactive power of the BESS during every change in the load/generation based on frequency and voltage control in the stand-alone microgrid. The final objective function is chosen and expressed as:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math id="Equ13_Math"><mml:mi mathvariant="normal">Minimize</mml:mi><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Minimize}\ f = {\lambda}_1{J}_1 + {\lambda}_2{J}_2 $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ13.gif"/></alternatives></disp-formula>where <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub> are the objective function representing the active and reactive power of the BESS from (9) and (10), respectively, and <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> are the weight associated to <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub>, respectively.</p><p id="Par35">The active and reactive power dispatched from BESS are used as the control variables in this study. The constraints imposed on the optimization problem are shown as follows:<disp-formula id="Equ14"><label>14</label><alternatives><mml:math id="Equ14_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{\min}\le P(t)\le {P}_{\max } $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ14.gif"/></alternatives></disp-formula>where <italic>P</italic>(<italic>t</italic>) is the rated active power of the BESS (MW), <italic>P</italic><sub>min</sub> is the allowed minimum rated active power, and <italic>P</italic><sub>max</sub> is the allowed maximum rated active power of the BESS.<disp-formula id="Equ15"><label>15</label><alternatives><mml:math id="Equ15_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mi>Q</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Q}_{\min}\le Q(t)\le {Q}_{\max } $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ15.gif"/></alternatives></disp-formula>where <italic>Q</italic>(<italic>t</italic>) is the rated reactive power of the BESS (Mvar), <italic>Q</italic><sub>min</sub> is the allowed minimum rated reactive power, and <italic>Q</italic><sub>max</sub> is the allowed maximum rated reactive power of the BESS.<disp-formula id="Equ16"><label>16</label><alternatives><mml:math id="Equ16_Math"><mml:msub><mml:mi>ω</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mi>ω</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\omega}_{\min}\le \omega (t)\le {\omega}_{\max } $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ16.gif"/></alternatives></disp-formula>where <italic>ω</italic>(<italic>t</italic>) is the nominal frequency of the isolated microgrid (Hz), <italic>ω</italic><sub>min</sub> is the allowed minimum nominal frequency of the isolated microgrid, and <italic>ω</italic><sub>max</sub> is the allowed maximum nominal frequency of the isolated microgrid.<disp-formula id="Equ17"><label>17</label><alternatives><mml:math id="Equ17_Math"><mml:msub><mml:mi>u</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mi>u</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {u}_{\min}\le u(t)\le {u}_{\max } $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ17.gif"/></alternatives></disp-formula>where <italic>u</italic>(<italic>t</italic>) is the nominal voltage of the isolated microgrid (pu), <italic>u</italic><sub>min</sub> is the allowed minimum nominal voltage of the isolated microgrid, and <italic>u</italic><sub>max</sub> is the allowed maximum nominal voltage of the isolated microgrid.</p></sec><sec id="Sec10"><title>Artificial neural network-based online optimization (stage 2)</title><p id="Par40">Artificial neural network (ANN) is simulating the brain of humans in processing information through a series of interconnected neurons. It is one of the famous prediction models as it has the remarkable ability of mapping complex and highly non-linear input-output patterns without the knowledge of the actual model structure. The RBFNN and the MLPNN are widely used in ANN structures, and their roles affect the network performance. Nowadays, a performance comparison of the RBFNN and the MLPNN in several applications has attracted the attention of researches [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]. Nevertheless, no comparison has been carried out so far between the intelligent management of active and reactive power of the BESS for a microgrid management system. Hence, this work proposed the RBFNN-based online management of the BESS and selected the MLPNN-based online management of the BESS for the performance comparison in the system. To enable the online updating of the operating parameters, the RBFNN/MLPNN is proposed and implemented in the management process for the second stage. Afterwards, the output performance of the RBFNN and the MLPNN were investigated and compared in the ANN training and testing results. During this stage, the database extracted from the PSO process was used as a target data in the RBFNN/MLPNN generalization and training process.</p></sec><sec id="Sec11"><title>RBFNN-based online management of the BESS</title><p id="Par41">The RBFNN is a type of feedforward neural network which learns using a supervised training method. Radial functions are a special class of functions, and their characteristic feature is that the response decreases or increases with the distance from a center point. It is obvious that the RBFNN is able to approximate any reasonable continuous function mapping with a satisfactory level of accuracy [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. In this paper, the proposed RBFNN consists of three layers of neurons: an input layer, a hidden layer, and an output layer.</p><p id="Par42">To enable online updating of the operating parameters, the proposed RBFNN is implemented in stage 2 of the management process as illustrated in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. During the second stage, the database extracted from stage 1 is used as a target data in the RBFNN generalization capability. There will be 12 inputs and 2 outputs. The inputs of the system will be the active and reactive power of commercial load 1 (<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>), respectively, the active and reactive power of office load 2 (<italic>X</italic><sub>3</sub>, <italic>X</italic><sub>4</sub>), respectively, the active and reactive power of residential load 3 (<italic>X</italic><sub>5</sub>, <italic>X</italic><sub>6</sub>), respectively, the active and reactive power of commercial load 4 (<italic>X</italic><sub>7</sub>, <italic>X</italic><sub>8</sub>), respectively, the active and reactive power of residential load 5 (<italic>X</italic><sub>9</sub>, <italic>X</italic><sub>10</sub>), respectively, and the active and reactive power of the solar PV system (<italic>X</italic><sub>11</sub>, <italic>X</italic><sub>12</sub>), respectively. The outputs of the system are the active and reactive power of the BESS (<italic>Y</italic><sub>1</sub>, <italic>Y</italic><sub>2</sub>), respectively. Afterwards, the proposed RBFNN-based online optimum active and reactive power of the BESS are demonstrated as a function that maps the input vector <italic>X =</italic> [<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3</sub>, <italic>X</italic><sub>4</sub>, <italic>X</italic><sub>5</sub>, <italic>X</italic><sub>6</sub>, <italic>X</italic><sub>7</sub>, <italic>X</italic><sub>8</sub>, <italic>X</italic><sub>9</sub>, <italic>X</italic><sub>10</sub>, <italic>X</italic><sub>11</sub>, <italic>X</italic><sub>12</sub>] to the output vector <italic>Y =</italic> [<italic>Y</italic><sub>1</sub>, <italic>Y</italic><sub>2</sub>]<italic>.</italic><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Description of inputs and outputs of the RBFNN-based online intelligent management of the BESS</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig7_HTML.gif" id="MO7"/></fig></p><p id="Par43">The input vector <italic>X</italic> is applied to all neurons in the hidden layer. The hidden layer is composed of number <italic>q</italic> RBFNNs that are directly connected to all the elements in the output layer. A node in the hidden layer will produce a greater output when the presented input pattern is close to its center. The output of such a node will reduce, as the distance from the center increases, assuming that a symmetrical basis function is applied. Hence, for a given input pattern, only neurons whose centers are close to the input pattern will produce non-zero activation values to the input stimulus. The basis function for the <italic>j</italic>th node in the hidden layer is determined by a Gaussian exponential function as follows:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math id="Equ18_Math"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="false"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mfenced><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="false"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {b}_j\left(\overline{X}\right)= \exp \left(\frac{-{\left(\overline{X}-{\mu}_j\right)}^2}{2{\sigma}_j^2}\right),\kern0.5em \mathrm{f}\mathrm{o}\mathrm{r}\ j = 1,\ 2,\dots, q $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ18.gif"/></alternatives></disp-formula>where <italic>μ</italic><sub><italic>j</italic></sub> is the respective center of the <italic>j</italic>th neuron in the hidden layer and <italic>σ</italic><sub><italic>j</italic></sub> is the wide of the Gaussian potential function of the <italic>j</italic>th neuron in the hidden layer.</p><p id="Par45">The network output <italic>Y</italic> is formed by a linearly weighted sum of the number of basis functions in the hidden layer. The values for the output nodes are calculated as follows:<disp-formula id="Equ19"><label>19</label><alternatives><mml:math id="Equ19_Math"><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="false"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>2</mml:mn></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_k={\displaystyle \sum_{j=1}^q{W}_{kj}{b}_j\left(\overline{X}\right)},\ \mathrm{f}\mathrm{o}\mathrm{r}\ k = 1,\ 2 $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ19.gif"/></alternatives></disp-formula>where <italic>Y</italic><sub><italic>k</italic></sub> is the output of the <italic>k</italic>th node in the output layer, <italic>W</italic><sub>kj</sub> is weight between the <italic>j</italic>th node in the hidden layer and the <italic>k</italic>th node in the output layer, and <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="false"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mfenced></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {b}_j\left(\overline{X}\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_IEq1.gif"/></alternatives></inline-formula> is the output of the <italic>j</italic>th node in the hidden layer.</p></sec><sec id="Sec12"><title>MLPNN-based online management of the BESS</title><p id="Par47">The MLPNN belongs to the class of feedforward networks. In the MLPNN structure, this structure is established in a layered feedforward network and is contained by an input layer, one or more hidden layers, and an output layer. The weight total of the input data and the chosen bias are passed through a transfer function to obtain the output data. The number of hidden layers is able to be changed based on the problem data in the training process [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. In this paper, the MLPNN consists of three layers of neurons, which demonstrates that only one hidden layer is included, and one type of activation function is used in the hidden layer and one output layer is contained.</p><p id="Par48">To enable an online updating of the operating parameters, the MLPNN is implemented in stage 2 of the management process as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. During the second stage, the database extracted from stage 1 is used as a target data in the MLPNN generalization capability. There will be 12 inputs and 2 outputs. The inputs of the system will be the active and reactive power of commercial load 1 (<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>), respectively, the active and reactive power of office load 2 (<italic>X</italic><sub>3</sub>, <italic>X</italic><sub>4</sub>), respectively, the active and reactive power of residential load 3 (<italic>X</italic><sub>5</sub>, <italic>X</italic><sub>6</sub>), respectively, the active and reactive power of commercial load 4 (<italic>X</italic><sub>7</sub>, <italic>X</italic><sub>8</sub>), respectively, the active and reactive power of residential load 5 (<italic>X</italic><sub>9</sub>, <italic>X</italic><sub>10</sub>), respectively, and the active and reactive power of the solar PV system (<italic>X</italic><sub>11</sub>, <italic>X</italic><sub>12</sub>), respectively. The outputs of the system are both the active and reactive power of both the BESS (<italic>Y</italic><sub>1</sub>, <italic>Y</italic><sub>2</sub>)<italic>.</italic> Afterwards, the proposed MLPNN-based online optimum active and reactive power of the BESS is demonstrated as a function that maps the input vector <italic>X =</italic> [<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3</sub>, <italic>X</italic><sub>4</sub>, <italic>X</italic><sub>5</sub>, <italic>X</italic><sub>6</sub>, <italic>X</italic><sub>7</sub>, <italic>X</italic><sub>8</sub>, <italic>X</italic><sub>9</sub>, <italic>X</italic><sub>10</sub>, <italic>X</italic><sub>11</sub>, <italic>X</italic><sub>12</sub>] to the output vector <italic>Y =</italic> [<italic>Y</italic><sub>1</sub>, <italic>Y</italic><sub>2</sub>]<italic>.</italic><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Description inputs and outputs of the MLPNN-based online intelligent management of the BESS</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig8_HTML.gif" id="MO8"/></fig></p><p id="Par49">Each hidden layer summarizes its weighted inputs, which can be expressed as:<disp-formula id="Equ20"><label>20</label><alternatives><mml:math id="Equ20_Math"><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>h</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_h(n)={\displaystyle \sum_{i=1}^{Ni}{W}_{ih}}(n){X}_i(n)+{b}_h^H $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ20.gif"/></alternatives></disp-formula>where <italic>W</italic><sub><italic>ih</italic></sub> (<italic>i</italic> = 1, 2,…, <italic>N</italic><sub><italic>i</italic></sub>, <italic>h</italic> = 1, 2,…, <italic>N</italic><sub><italic>h</italic></sub>) are the weights of the connections between the input and hidden layers, <italic>X</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1,2,…,<italic>N</italic><sub><italic>i</italic></sub>) are the input signals, <italic>b</italic><sub><italic>h</italic></sub><sup><italic>H</italic></sup> (<italic>h</italic> = 1,2,…,<italic>N</italic><sub><italic>h</italic></sub>) are the biases at the hidden layer, <italic>N</italic><sub><italic>i</italic></sub> is the number of the inputs, and <italic>N</italic><sub><italic>h</italic></sub> is the number of neurons in the hidden layer.</p><p id="Par51">The function form of the MLPNN-based online intelligent optimum active and reactive power of the BESS (i.e., the outputs from the hidden layers) can be presented as follows:<disp-formula id="Equ21"><label>21</label><alternatives><mml:math id="Equ21_Math"><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced><mml:mo>⋅</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_k(n)={\displaystyle \sum_{h=1}^{Nh}{W}_{hk}(n)\cdot f\left({y}_h(n)\right)+{b}_k^0} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ21.gif"/></alternatives></disp-formula>where<disp-formula id="Equ22"><label>22</label><alternatives><mml:math id="Equ22_Math"><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">sigmoid</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f\left({y}_h(n)\right)={f}_{\mathrm{sigmoid}}\left({y}_h(n)\right)=\frac{1}{1+{e}^{-\left({y}_h(n)\right)}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ22.gif"/></alternatives></disp-formula>where <italic>Y</italic><sub><italic>k</italic></sub> (<italic>k</italic> = 1, 2,…, <italic>N</italic><sub><italic>k</italic></sub>) are the output signals, <italic>W</italic><sub><italic>hk</italic></sub> (<italic>h</italic> = 1, 2,…, <italic>N</italic><sub><italic>h</italic></sub>, <italic>k</italic> = 1, 2,…, <italic>N</italic><sub><italic>k</italic></sub>) are the weights of the connections between the hidden and output layers, <italic>b</italic><sub><italic>k</italic></sub><sup>0</sup> (<italic>k</italic> = 1, 2,…, <italic>N</italic><sub><italic>k</italic></sub>) are the biases at the output layer nodes, <italic>f</italic>(<italic>y</italic><sub><italic>h</italic></sub>(<italic>n</italic>)) is the hidden activation transfer function, <italic>N</italic><sub><italic>h</italic></sub> is the number of neurons in the hidden layer, and <italic>N</italic><sub><italic>k</italic></sub> is the number of the outputs.</p><p id="Par54">Based on Table <xref rid="Tab1" ref-type="table">1</xref>, the parameter details for the optimum online active and reactive power of the BESS are shown and used in the training and the testing database.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Artificial neural network parameters</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th><p>Parameters</p></th><th><p>RBFNN</p></th><th><p>MLPNN</p></th></tr></thead><tbody><tr valign="top"><td><p>Goal (RMSE)</p></td><td><p>0.001</p></td><td><p>0.001</p></td></tr><tr valign="top"><td><p>Inputs</p></td><td><p>12</p></td><td><p>12</p></td></tr><tr valign="top"><td><p>Outputs</p></td><td><p>2</p></td><td><p>2</p></td></tr><tr valign="top"><td><p>Hidden layer</p></td><td><p>1</p></td><td><p>1</p></td></tr><tr valign="top"><td><p>Training data</p></td><td><p>940</p></td><td><p>940</p></td></tr><tr valign="top"><td><p>Testing data</p></td><td><p>202</p></td><td><p>202</p></td></tr><tr valign="top"><td><p>Validation data</p></td><td><p>202</p></td><td><p>202</p></td></tr><tr valign="top"><td><p>Hidden layer neurons</p></td><td><p>30</p></td><td><p>30</p></td></tr><tr valign="top"><td><p>Output layer neurons</p></td><td><p>2</p></td><td><p>2</p></td></tr><tr valign="top"><td><p>Activation function</p></td><td><p>Gaussian exponential</p></td><td><p>Sigmoid</p></td></tr></tbody></table><table-wrap-foot><p><italic>RMSE</italic> root mean square error, <italic>RBFNN</italic> radial basis function neural network, <italic>MLPNN</italic> multilayer perceptron neural network</p></table-wrap-foot></table-wrap></p><p id="Par55">Figure <xref rid="Fig9" ref-type="fig">9</xref> depicts the description of inputs and outputs for estimating the active and reactive power of the BESS that have been used for the RBFNN/MLPNN training and testing process. The RBFNN/MLPNN which is trained and tested offline has been accomplished to recognize the pattern and the optimum behavior for the stand-alone microgrid. Later, the well-trained RBFNN/MLPNN can be used onsite in the online mode where the system is applied using new input data. With applying the well-trained RBFNN/MLPNN in the system, the optimization of optimum active and reactive power can be directly evaluated without the necessity of performing the optimization process-based PSO after any change of load/generation. The overall process of stage 2 is described as follows:<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Structure of inputs and outputs of the proposed RBFNN/MLPNN for stage 2</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig9_HTML.gif" id="MO9"/></fig><list list-type="bullet"><list-item><p id="Par56">Step 1. Obtain input data and target from the PSO process.</p></list-item><list-item><p id="Par57">Step 2. Create the RBFNN/MLPNN network and train the network until the conditions of the network setting parameters are reached.</p></list-item><list-item><p id="Par58">Step 3. Test the network and control the regression analysis.</p></list-item><list-item><p id="Par59">Step 4. Store the trained network. Afterwards, the trained network is ready to be tested by using new input data for this online process. Please consider that step 1 to step 4 belong to the offline process.</p></list-item><list-item><p id="Par60">Step 5. Process new input data to the online process and obtain the optimum power data of the BESS.</p></list-item></list></p></sec><sec id="Sec13"><title>Results and discussion</title><p id="Par61">This part describes the results of the proposed online predictive power management of the BESS with the objective of frequency and voltage control of the stand-alone microgrid by using the proposed RBFNN. Thus, the proposed RBFNN approach will automatically determine the optimum power of the BESS in order to prevent the isolated microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations. Afterwards, the predictive results of the proposed RBFNN model are compared with the MLPNN model, considering the error efficiency and positional accuracy.</p></sec><sec id="Sec14"><title>ANN training results</title><p id="Par62">There are 12 inputs being the time step of the five load demands and the solar PV data which were fed into the RBFNN/MLPNN controller. The outputs of the neural network will be the predictive results of the optimum active and reactive power of the BESS which will determine the optimum operation of the BESS for the stand-alone microgrid.</p><p id="Par63">After the inputs and targets for the training data are initiated, the next process is the separation of the data for training, validation, and test. During this stage, 70 % of the sample data are used for the training process (i.e., 940 data), 15 % of the sample data are used for validation (i.e., 202 data), and 15 % for the test data (i.e., 202 data).</p><p id="Par64">In the training results, the correlation coefficient (<italic>R</italic>) is employed to measure the fitness, where a value closer to 1 indicates a better fit. From Figs. <xref rid="Fig10" ref-type="fig">10</xref> and <xref rid="Fig11" ref-type="fig">11</xref>, it is evident that the correlation coefficient of the proposed RBFNN is higher than the correlation coefficient of the MLPNN and almost equal to 1 (i.e., 0.9999), which means that the targets are equal to the outputs of the training data. This reason indicates a strong correlation between the optimization data and the neural network output. Hence, it is obvious that the proposed RBFNN approach allows achieving the highest accuracy compared to the MLPNN approach.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Regression analysis between the network outputs and the optimization targets based on the MLPNN</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig10_HTML.gif" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Regression analysis between the network outputs and the optimization targets based on the RBFNN</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig11_HTML.gif" id="MO11"/></fig></p></sec><sec id="Sec15"><title>ANN testing results</title><p id="Par65">The proposed RBFNN/MLPNN has been trained and tested using the typical microgrid system, load demand profiles, and solar PV output data during a sunny and a rainy day for online applications. The active and reactive power estimated online by the RBFNN/MLPNN are compared with the data obtained from the PSO optimization conducted offline as shown in Figs. <xref rid="Fig12" ref-type="fig">12</xref>, <xref rid="Fig13" ref-type="fig">13</xref>, <xref rid="Fig14" ref-type="fig">14</xref>, and <xref rid="Fig15" ref-type="fig">15</xref> for the case of a sunny day and a rainy day, respectively. Based on Figs. <xref rid="Fig12" ref-type="fig">12</xref>, <xref rid="Fig13" ref-type="fig">13</xref>, <xref rid="Fig14" ref-type="fig">14</xref> and <xref rid="Fig15" ref-type="fig">15</xref>, the proposed RBFNN approach is better than the MLPNN approach as far as the accuracy and efficiency are concerned. The MLPNN capability is poor when compared to the proposed RBFNN. It is obvious that the proposed RBFNN is able to follow the target pattern-based PSO at almost every time step mentioned. Compared with the MLPNN model, the outputs of the proposed RBFNN model are only slightly different from the optimization target-based PSO optimization. It can be concluded that the proposed RBFNN can accurately determine the optimal active and reactive power of the BESS for the isolated microgrid.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>The optimum active power of the BESS during a sunny day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig12_HTML.gif" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>The optimum reactive power of the BESS during a sunny day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig13_HTML.gif" id="MO13"/></fig><fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>The optimum active power of the BESS during a rainy day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig14_HTML.gif" id="MO14"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>The optimum reactive power of the BESS during a rainy day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig15_HTML.gif" id="MO15"/></fig></p><p id="Par66">In this study, three adopted error indexes are used to estimate the RBFNN/MLPNN training performance, including the mean absolute error (MAE), the mean relative error (MRE), and the root mean square error (RMSE). These indexes show the learning and generalization error of the normalized values of the online intelligent management of the BESS. The computation of these three error indexes can be expressed as:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math id="Equ23_Math"><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{M}\mathrm{A}\mathrm{E}=\frac{1}{n}{\displaystyle \sum_1^n\left|{T}_i-{O}_i\right|} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ23.gif"/></alternatives></disp-formula><disp-formula id="Equ24"><label>24</label><alternatives><mml:math id="Equ24_Math"><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{M}\mathrm{R}\mathrm{E}=\frac{1}{n}{\displaystyle \sum_1^n\frac{\left|{T}_i-{O}_i\right|}{T_i}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ24.gif"/></alternatives></disp-formula><disp-formula id="Equ25"><label>25</label><alternatives><mml:math id="Equ25_Math"><mml:mi mathvariant="normal">RMSE</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{RMSE}=\sqrt{\frac{1}{n-1}{\displaystyle \sum_1^n{\left({T}_i-{O}_i\right)}^2}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13705_2016_71_Article_Equ25.gif"/></alternatives></disp-formula>where <italic>T</italic><sub><italic>i</italic></sub> is the target vector, <italic>O</italic><sub><italic>i</italic></sub> is the output vector, and <italic>n</italic> is the number of training data or the data for each test in the testing data set.</p><p id="Par68">Compared with the MLPNN model, Table <xref rid="Tab2" ref-type="table">2</xref> demonstrates that the proposed RBFNN model has a minimum statistical error in terms of MAE, MRE, and RMSE. It is concluded that the proposed RBFNN is an effective way to improve the prediction accuracy. In addition, the proposed RBFNN is able to accurately predict the optimum active and reactive power of the BESS with minimal errors.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Error indexes for online optimum BESS management</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th><p>Output</p></th><th><p>MAE</p></th><th><p>MRE</p></th><th><p>RMSE</p></th></tr></thead><tbody><tr valign="top"><td><p><italic>Y</italic><sub>1</sub>-based RBF (active power)</p></td><td char="." align="char"><p>0.0004270</p></td><td char="." align="char"><p>0.0001935</p></td><td><p>9.947 × 10<sup>−7</sup></p></td></tr><tr valign="top"><td><p><italic>Y</italic><sub>2</sub>-based RBF (reactive power)</p></td><td char="." align="char"><p>0.0001770</p></td><td char="." align="char"><p>0.0001762</p></td><td><p>7.821 × 10<sup>−7</sup></p></td></tr><tr valign="top"><td><p><italic>Y</italic><sub>1</sub>-based MLP (active power)</p></td><td char="." align="char"><p>0.01485</p></td><td char="." align="char"><p>0.00636</p></td><td><p>0.00067</p></td></tr><tr valign="top"><td><p><italic>Y</italic><sub>2</sub>-based MLP (reactive power)</p></td><td char="." align="char"><p>0.01696</p></td><td char="." align="char"><p>0.02231</p></td><td><p>0.00064</p></td></tr></tbody></table><table-wrap-foot><p><italic>MAE</italic> mean absolute error, <italic>MRE</italic> mean relative error, <italic>RMSE</italic> root mean square error, <italic>RBF</italic> radial basis function, <italic>MLP</italic> multilayer perceptron</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec16"><title>Frequency and voltage of stand-alone microgrids</title><p id="Par69">Frequency and voltage profiles are important criteria which have to be monitored to ensure that the frequency and voltage of the isolated microgrid are satisfied within the required limit in order to prevent the isolated microgrid from instability and collapse in the presence of violent changes of loads or outage of distributed generations. Looking at the frequency and voltage variation evident in Figs. <xref rid="Fig16" ref-type="fig">16</xref>, <xref rid="Fig17" ref-type="fig">17</xref>, <xref rid="Fig18" ref-type="fig">18</xref> and <xref rid="Fig19" ref-type="fig">19</xref>, it can be seen that the frequency and voltage variation of the proposed RBFNN are within acceptable ranges from 49.95 to 50.05 Hz for frequency regulation and from 0.99 pu to 1 pu for voltage regulation. On the other hand, the frequency variation of the MLPNN exceeds the acceptable range of frequency regulation in some parts of time duration. It is obvious that the proposed RBFNN approach would achieve better performance in terms of frequency and voltage regulation compared to the MLPNN approach.<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>Frequency variation of the stand-alone microgrid during a sunny day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig16_HTML.gif" id="MO16"/></fig><fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p>Frequency variation of the stand-alone microgrid during a rainy day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig17_HTML.gif" id="MO17"/></fig><fig id="Fig18"><label>Fig. 18</label><caption xml:lang="en"><p>Voltage variation of the stand-alone microgrid during a sunny day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig18_HTML.gif" id="MO18"/></fig><fig id="Fig19"><label>Fig. 19</label><caption xml:lang="en"><p>Voltage variation of the stand-alone microgrid during a rainy day</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13705_2016_71_Fig19_HTML.gif" id="MO19"/></fig></p></sec></sec><sec id="Sec17" sec-type="conclusion"><title>Conclusions</title><p id="Par70">In this paper, a novel method for the optimum online intelligent management of active and reactive power of the BESS for the isolated microgrid is proposed. The entire BESS is centrally controlled by a controller developed using the proposed RBFNN model. The results show that the proposed RBFNN is able to follow the optimum target-based PSO at almost every time step mentioned under the changes of typical loads and solar PV generation with the profiles of a sunny and a rainy day. Compared with the MLPNN model, the proposed RBFNN model provides superior performance, when the error efficiency and positional accuracy are considered. It can be summarized that the proposed RBFNN model is appropriate for the online prediction of active and reactive power of the BESS differing only slightly from the optimal target result-based PSO and can consequently be used for real-time energy storage management as an online controller.</p></sec></body><back><ack><title>Acknowledgements</title><p>The authors are grateful for the feedback of two anonymous reviewers and the editors of this journal; their comments helped us a lot in improving the quality of this paper. We would like to thank Dagmar Fiedler, Editorial Manager for the revisions.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marnay</surname><given-names>C</given-names></name><name><surname>Aki</surname><given-names>H</given-names></name><name><surname>Hirose</surname><given-names>K</given-names></name><name><surname>Kwasinski</surname><given-names>A</given-names></name><name><surname>Ogura</surname><given-names>S</given-names></name><name><surname>Shinji</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">How two microgrid fared after the 2011 earthquake</article-title><source>IEEE Power Energy Magazine</source><year>2015</year><volume>13</volume><issue>3</issue><fpage>44</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1109/MPE.2015.2397333</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Dragicevic</surname><given-names>T</given-names></name><name><surname>Vasquez</surname><given-names>J</given-names></name><name><surname>Guerrero</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Autonomous active power control for islanded AC microgrid with photovoltaic generation and energy storage system, IEEE Trans</article-title><source>Energy Conversion</source><year>2014</year><volume>29</volume><issue>4</issue><fpage>882</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1109/TEC.2014.2358612</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Moghadam</surname><given-names>MRV</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Ma</surname><given-names>RTB</given-names></name></person-group><article-title xml:lang="en">Randomized response electric vehicles for distributed frequency control in smart grid</article-title><source>proceeding of IEEE International conf. on Smart Grid Communications</source><year>2013</year><fpage>139</fpage><lpage>144</lpage></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nan</surname><given-names>Z</given-names></name><name><surname>Qian</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Auxiliary frequency and voltage regulation in microgrid via intelligent electric vehicle charging</article-title><source>proceeding of IEEE International conf. on Smart Grid Communications</source><year>2014</year><fpage>662</fpage><lpage>667</lpage></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inthamoussou</surname><given-names>F</given-names></name><name><surname>Pegueroles-Queralt</surname><given-names>J</given-names></name><name><surname>Bianchi</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Control of a supercapacitor energy storage system for microgrid application, IEEE Trans</article-title><source>Power Systems</source><year>2013</year><volume>28</volume><issue>3</issue><fpage>690</fpage><lpage>697</lpage></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cecati</surname><given-names>C</given-names></name><name><surname>Mokryani</surname><given-names>G</given-names></name><name><surname>Piccolo</surname><given-names>A</given-names></name><name><surname>Siano</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">An overview on the smart grid concept</article-title><source>Proceeding of Conf. on 36<sup>th</sup> annual IEEE Industrial Electronics Society</source><year>2010</year><fpage>3322</fpage><lpage>3327</lpage></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Toma</surname><given-names>S</given-names></name><name><surname>Senjyu</surname><given-names>T</given-names></name><name><surname>Miyazato</surname><given-names>Y</given-names></name><name><surname>Yona</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Decentralized voltage control in distribution system using neural network</article-title><source>proceeding of Conf. on 2<sup>nd</sup> IEEE International Conference</source><year>2008</year><fpage>1557</fpage><lpage>1562</lpage></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hatta</surname><given-names>H</given-names></name><name><surname>Kobayashi</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">A study of centralized voltage control method for distribution system with distributed generation</article-title><source>proceeding of Conf. on 19<sup>th</sup> CIRED International Conference on Electricity Distribution</source><year>2007</year><fpage>1</fpage><lpage>4</lpage></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcela</surname><given-names>M</given-names></name><name><surname>Sumper</surname><given-names>A</given-names></name><name><surname>Gomis</surname><given-names>O</given-names></name><name><surname>Sudra</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Reactive power dispatch in wind farms using particle swarm optimization technique and feasible solutions search</article-title><source>Appl Energy</source><year>2011</year><volume>1</volume><fpage>4678</fpage><lpage>4686</lpage></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baalbergen</surname><given-names>F</given-names></name><name><surname>Baber</surname><given-names>P</given-names></name><name><surname>Ferreira</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Energy storage and power management for typical 4Q-load</article-title><source>IEEE Trans on Industrial Electronic</source><year>2009</year><volume>56</volume><issue>5</issue><fpage>1485</fpage><lpage>1498</lpage><pub-id pub-id-type="doi">10.1109/TIE.2009.2012416</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahbar</surname><given-names>K</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Real-time energy storage management for renewable integration in microgrid: an off-line optimization approach</article-title><source>IEEE Trans on Smart Grid</source><year>2015</year><volume>6</volume><issue>1</issue><fpage>124</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1109/TSG.2014.2359004</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Na</surname><given-names>J</given-names></name><name><surname>Stoten</surname><given-names>D</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Adaptive neural network feedforward control for dynamically substructured systems, IEEE Trans</article-title><source>Control System Technology</source><year>2014</year><volume>22</volume><issue>3</issue><fpage>944</fpage><lpage>954</lpage><pub-id pub-id-type="doi">10.1109/TCST.2013.2271036</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bianchini</surname><given-names>M</given-names></name><name><surname>Frasconi</surname><given-names>P</given-names></name><name><surname>Gori</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Learning without local minima in radial basis function networks, IEEE Trans</article-title><source>Neural Netw</source><year>1995</year><volume>6</volume><issue>1</issue><fpage>749</fpage><lpage>756</lpage><pub-id pub-id-type="doi">10.1109/72.377979</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Sandberg</surname><given-names>IW</given-names></name></person-group><article-title xml:lang="en">Universal approximation using radial basis functions network</article-title><source>Neural Comput</source><year>1991</year><volume>3</volume><issue>2</issue><fpage>246</fpage><lpage>257</lpage><pub-id pub-id-type="doi">10.1162/neco.1991.3.2.246</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Wong</surname><given-names>WK</given-names></name></person-group><article-title xml:lang="en">Distributed synchronization of coupled neural networks via randomly occurring control</article-title><source>IEEE Trans on Neural Networks and Learning Systems</source><year>2015</year><volume>24</volume><issue>3</issue><fpage>435</fpage><lpage>447</lpage><pub-id pub-id-type="doi">10.1109/TNNLS.2012.2236355</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sitbon</surname><given-names>M</given-names></name><name><surname>Leppaho</surname><given-names>J</given-names></name><name><surname>Suntio</surname><given-names>T</given-names></name><name><surname>Kuperman</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Dynamic of photovoltaic-generator-interfacing voltage-controlled buck power stage</article-title><source>IEEE Journal of Photovoltaics</source><year>2014</year><volume>5</volume><issue>2</issue><fpage>633</fpage><lpage>640</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2014.2379094</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kottick</surname><given-names>D</given-names></name><name><surname>Blau</surname><given-names>M</given-names></name><name><surname>Edelstein</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Battery energy storage for frequency regulation in an island power system, IEEE Trans</article-title><source>Energy Convers</source><year>1993</year><volume>8</volume><issue>3</issue><fpage>455</fpage><lpage>458</lpage><pub-id pub-id-type="doi">10.1109/60.257059</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerdphol</surname><given-names>T</given-names></name><name><surname>Qudaih</surname><given-names>Y</given-names></name><name><surname>Mitani</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Optimal battery energy storage system size using particle swarm optimization for microgrid system</article-title><source>International Review of Electrical Engineering (IREE)</source><year>2015</year><volume>10</volume><issue>2</issue><fpage>277</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.15866/iree.v10i2.5350</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aditya</surname><given-names>SK</given-names></name><name><surname>Das</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Application of battery energy storage system to load frequency control of an isolated power system</article-title><source>Int J Energy Res</source><year>1999</year><volume>23</volume><issue>1</issue><fpage>247</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1099-114X(19990310)23:3&lt;247::AID-ER480&gt;3.0.CO;2-T</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaing</surname><given-names>ZL</given-names></name></person-group><article-title xml:lang="en">A particle swarm optimization approach for optimum design of PID controller in AVR system, IEEE Trans</article-title><source>Energy Conversion</source><year>2004</year><volume>19</volume><issue>2</issue><fpage>284</fpage><lpage>391</lpage></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Esmin</surname><given-names>AA</given-names></name><name><surname>Lambert-Torres</surname><given-names>G</given-names></name><name><surname>Zambroni de Souza</surname><given-names>AC</given-names></name></person-group><article-title xml:lang="en">A hybrid particle swarm optimization applied to loss power minimization, IEEE Trans</article-title><source>Power Systems</source><year>2005</year><volume>20</volume><issue>2</issue><fpage>859</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2005.846049</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaing</surname><given-names>ZL</given-names></name></person-group><article-title xml:lang="en">Particle swarm optimization to solving the economic dispatch considering the generator constraints, IEEE Trans</article-title><source>Power Systems</source><year>2003</year><volume>18</volume><issue>3</issue><fpage>1187</fpage><lpage>1195</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2003.814889</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname><given-names>J</given-names></name><name><surname>Eberhart</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Particle swarm optimization in Proc IEEE Int. Conf</article-title><source>Neural Netw</source><year>1995</year><volume>4</volume><fpage>1942</fpage><lpage>1948</lpage></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zyandehroodi</surname><given-names>H</given-names></name><name><surname>Mohamed</surname><given-names>A</given-names></name><name><surname>Shareef</surname><given-names>H</given-names></name><name><surname>Mohammadjafari</surname><given-names>M</given-names></name></person-group><source>Performance comparison of MLP and RBF neural networks for fault location in distribution networks with DGs, Proceeding of IEEE Int Conf Power Energy</source><year>2010</year><fpage>342</fpage><lpage>345</lpage></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sereno</surname><given-names>F</given-names></name><name><surname>de Sa JP</surname><given-names>M</given-names></name><name><surname>Matos</surname><given-names>A</given-names></name><name><surname>Bernades</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">A comparative study of MLP and RBF neural nets in the estimation of the foetal weight and length</article-title><source>Proceeding of RECPAD</source><year>2000</year><fpage>1</fpage><lpage>9</lpage></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Memarian</surname><given-names>H</given-names></name><name><surname>Balasundram</surname><given-names>SK</given-names></name></person-group><article-title xml:lang="en">Comparison between multi-layer perceptron and radial basis function networks for sediment load estimation in a tropical watershed</article-title><source>Journal of Water Resource and Protection</source><year>2012</year><volume>1</volume><fpage>870</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.4236/jwarp.2012.410102</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karami</surname><given-names>H</given-names></name><name><surname>Mousavi</surname><given-names>MF</given-names></name><name><surname>Shamsipur</surname><given-names>M</given-names></name><name><surname>Riahi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">New dry and wet Zn-polyaniline bipolar batteries and prediction of voltage and capacity by ANN</article-title><source>J Power Sources</source><year>2006</year><volume>154</volume><issue>1</issue><fpage>298</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2005.04.002</pub-id></mixed-citation></ref></ref-list></ref-list><notes notes-type="Misc"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></notes><notes notes-type="Misc"><title>Authors’ contributions</title><p>TK developed the optimization modeling part of this research and also trained and tested the proposed model. YQ conceived of study and participated in its design and coordination and helped to draft the manuscript. MW and YM critically reviewed the paper and gave final approval for the paper to be published. All authors read and approved the final manuscript.</p></notes><notes notes-type="Misc"><title>Authors’ information</title><p>Thongchart Kerdphol is a Ph.D. student sponsored by the Japan Student Services Organization (JASSO honors scholarship) and Kyushu Institute of Technology (KIT) at MITANI laboratory, KIT. His research interests are in the area of the application of artificial intelligence in power systems, power system stability, smart/microgrids, renewable energy, and power system dynamics and controls.</p><p>Yaser Qudaih is currently an assistant professor at the Department of Electrical Engineering and Electronics, Kyushu Institute of Technology (KIT), Japan. His area of interest including power system is renewable energy and Smart Grid applications.</p><p>Masayuki Watanabe is an associate professor at the Department of Electrical Engineering and Electronics, Kyushu Institute of Technology (KIT), Japan. His research interests are in the areas of analysis and control of power systems</p><p>Yasunori Mitani is a professor at the Department of Electrical Engineering and Electronics, Kyushu Institute of Technology (KIT), Japan. His research interests are in the areas of analysis and control of power systems.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Policy, Economics and Management</facet-value><facet-value count="1">Renewable and Green Energy</facet-value><facet-value count="1">Sustainable Development</facet-value></facet><facet name="keyword"><facet-value count="1">Battery energy storage system</facet-value><facet-value count="1">Energy management</facet-value><facet-value count="1">Frequency and voltage control</facet-value><facet-value count="1">Microgrid</facet-value><facet-value count="1">Optimization</facet-value><facet-value count="1">RBF neural network</facet-value></facet><facet name="pub"><facet-value count="1">Energy, Sustainability and Society</facet-value></facet><facet name="year"><facet-value count="1">2016</facet-value></facet><facet name="country"><facet-value count="1">Japan</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
