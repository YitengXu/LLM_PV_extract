<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s13369-021-05916-w</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">13369</journal-id><journal-id journal-id-type="doi">10.1007/13369.2191-4281</journal-id><journal-title-group><journal-title>Arabian Journal for Science and Engineering</journal-title><abbrev-journal-title abbrev-type="publisher">Arab J Sci Eng</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2193-567X</issn><issn pub-type="epub">2191-4281</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s13369-021-05916-w</article-id><article-id pub-id-type="manuscript">5916</article-id><article-id pub-id-type="doi">10.1007/s13369-021-05916-w</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article-Electrical Engineering </subject></subj-group></article-categories><title-group><article-title xml:lang="en">Dual-Mode Power Operation for Grid-Connected PV Systems with Adaptive DC-link Controller</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9036-059X</contrib-id><name><surname>Ahmed</surname><given-names>Mostafa</given-names></name><address><email>mostafa.ahmed@tum.de</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="corresp" rid="IDs1336902105916w_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Harbi</surname><given-names>Ibrahim</given-names></name><address><email>ibrahim.harbi@tum.de</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Kennel</surname><given-names>Ralph</given-names></name><address><email>ralph.kennel@tum.de</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Abdelrahem</surname><given-names>Mohamed</given-names></name><address><email>mohamed.abdelrahem@tum.de</email><email>mohamed.abdelrahem@aun.edu.eg</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution content-type="org-division">Institute for Electrical Drive Systems and Power Electronics</institution><institution content-type="org-name">Technical University of Munich (TUM)</institution></institution-wrap><addr-line content-type="city">Munich</addr-line><country country="DE">Germany</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.252487.e</institution-id><institution-id institution-id-type="ISNI">0000 0000 8632 679X</institution-id><institution content-type="org-division">Electrical Engineering Department, Faculty of Engineering</institution><institution content-type="org-name">Assiut University</institution></institution-wrap><addr-line content-type="city">Assiut</addr-line><country country="EG">Egypt</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.411775.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 0621 4712</institution-id><institution content-type="org-division">Electrical Engineering Department, Faculty of Engineering</institution><institution content-type="org-name">Menoufia University</institution></institution-wrap><addr-line content-type="city">Shebin El-Koum</addr-line><country country="EG">Egypt</country></aff></contrib-group><author-notes><corresp id="IDs1336902105916w_cor1"><label>a</label><email>mostafa.ahmed@tum.de</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>12</day><month>7</month><year>2021</year></pub-date><pub-date date-type="pub" publication-format="print"><month>3</month><year>2022</year></pub-date><volume>47</volume><issue seq="21">3</issue><fpage>2893</fpage><lpage>2907</lpage><history><date date-type="registration"><day>23</day><month>6</month><year>2021</year></date><date date-type="received"><day>6</day><month>1</month><year>2021</year></date><date date-type="accepted"><day>6</day><month>5</month><year>2021</year></date><date date-type="online"><day>12</day><month>7</month><year>2021</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Photovoltaic (PV) power systems are integrated with high penetration levels into the grid. This in turn encourages several modifications for grid codes to sustain grid stability and resilience. Recently, constant power management and regulation is a very common approach, which is used to limit the PV power production. Thus, this article proposes dual-mode power generation algorithm for grid-connected PV systems. The developed system considers the two-stage PV configuration for implementation, where the dual-mode power generation technique is executed within the DC–DC conversion (boost) stage. Most of the techniques adopted for dual-mode power operation employ the conventional perturb and observe method, which is known with unsatisfactory performance at fast-changing atmospheric conditions. Considering this issue, this study suggests a modified maximum power point tracker for power extraction. Furthermore, a new adaptive DC-link controller is developed to improve the DC-link voltage profile at different operating conditions. The adaptive DC-link controller is compared with the traditional PI controller for voltage regulation. The inverter control is accomplished using finite-set model predictive control with two control objectives, namely reference current tracking and switching frequency minimization. The overall control methodology is evaluated at different atmospheric and operating conditions using MATLAB/Simulink software.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>PV systems</kwd><kwd>Dual-mode power generation</kwd><kwd>Adaptive DC-link control</kwd><kwd>Predictive control</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Technische Universität München (1025)</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>12</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>90</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>King Fahd University of Petroleum &amp; Minerals</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>23</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/13369_2021_Article_5916.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>25</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>25</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Engineering, general</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par13">The penetration of renewable energy sources in power system is growing significantly [<xref ref-type="bibr" rid="CR1">1</xref>]. The most commonly utilized renewable energy source is the hydro-power one. Wind energy comes in the second place and then the photovoltaic (PV) power. However, the construction rate of PV power is increasing rapidly. Thus, it is a matter of time till the PV power dominates the renewable energy market. Numerous reasons easify spreading the PV source of energy. For instant, the source of PV power is naturally abundant and universe (the sun), unlike hydro and wind power, which need specific site properties for installation [<xref ref-type="bibr" rid="CR2">2</xref>]. That fast increase necessitates many grid codes’ updates to insure safe operation of the PV systems under different circumstances. Hence, stability and resilience of the PV system are getting more interest. However, the nonlinear behavior of the PV source coming from dependency on the atmospheric conditions (radiation and temperature) makes that task more challenging [<xref ref-type="bibr" rid="CR3">3</xref>].</p><p id="Par14">Among modern grid codes, constant power regulation is considered the most common technique alongside the maximum power point tracking (MPPT) operation [<xref ref-type="bibr" rid="CR4">4</xref>]. For low power scale PV application, it is important to extract the maximum available power from the PV source at various atmospheric conditions, which is known as MPPT [<xref ref-type="bibr" rid="CR5">5</xref>]. However, at high power levels, the MPPT operation is allowed if the PV power is lower than a certain threshold. If the power exceeds this value, the power will be limited and sustained at this level. This operation is known as constant power generation (CPG) [<xref ref-type="bibr" rid="CR6">6</xref>]. The reason for that regulation is to limit the power variation, specially at fast-changing atmospheric conditions. Under these circumstances, if the MPPT is enabled, high power oscillations will occur. Thus, frequency deviations may happen due to the power change in a very short time [<xref ref-type="bibr" rid="CR7">7</xref>].</p><p id="Par15">Furthermore, flexible power regulation, which is desired for grid support, cannot be realized if the MPPT is enabled; thus, constant power generation algorithm can simplify different flexible power regulation schemes for new grid codes [<xref ref-type="bibr" rid="CR4">4</xref>]. To be specific, PV systems are expected to support the grid frequency during any potential disturbances [<xref ref-type="bibr" rid="CR8">8</xref>]. For example, for 50-Hz system, the PV source should produce the full capacity of the system if the operating frequency is within a predefined range (47 Hz to <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq1.gif"/></alternatives></inline-formula>), where <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq2.gif"/></alternatives></inline-formula> is larger than 47 Hz. For frequencies larger than this value (<inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq3.gif"/></alternatives></inline-formula>), a reserved amount of PV power <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\Delta P)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq4.gif"/></alternatives></inline-formula> should be considered. The value of <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq5.gif"/></alternatives></inline-formula> is kept till the frequency rises to a certain value (normally larger than 50 Hz). If the frequency is still increasing, then the PV generator starts to decrease the produced power. The PV power production falls to zero and disconnected from the grid, if the frequency hits the maximum allowable operating frequency (52 Hz) [<xref ref-type="bibr" rid="CR9">9</xref>].</p><p id="Par16">The two-stage grid-connected PV system utilizes a boost converter in the first stage, where the control of the PV power production is accomplished in this stage. Furthermore, the boost converter increases the voltage of the PV side to appropriate voltage level for grid connection. Normally, the MPPT is executed at this level of control [<xref ref-type="bibr" rid="CR10">10</xref>]. However, due to the variable nature of the PV power, an additional power regulation is included with the MPPT function. In the literature, the most popular techniques for MPPT extraction are perturb and observe (P&amp;O) and incremental conductance (INC) methods [<xref ref-type="bibr" rid="CR11">11</xref>]. However, both of them have a poor performance at fast-changing atmospheric conditions [<xref ref-type="bibr" rid="CR12">12</xref>]. Soft computing methods are also addressed for MPPT to consider the partial shading conditions, where the power voltage (P–V) curve exhibits several maxima. Thus, the optimization technique is searching for the global one among them. Numerous techniques are utilized for such purpose, to mention a few, particle swarm optimization [<xref ref-type="bibr" rid="CR13">13</xref>], genetic algorithms [<xref ref-type="bibr" rid="CR14">14</xref>], simulated annealing method [<xref ref-type="bibr" rid="CR15">15</xref>], ant colony technique [<xref ref-type="bibr" rid="CR16">16</xref>], firefly algorithm [<xref ref-type="bibr" rid="CR17">17</xref>], grey wolf optimization [<xref ref-type="bibr" rid="CR18">18</xref>], and bat algorithm [<xref ref-type="bibr" rid="CR19">19</xref>]. However, these methods suffer from high calculation burden and slow transient behavior inherited from their searching nature. Recently, constant power regulation is adopted in conjugation with the MPPT operation. This new regulation can be implemented using additional devices (storage elements) [<xref ref-type="bibr" rid="CR9">9</xref>]. However, the most cost-effective procedure is to modify the MPPT algorithm [<xref ref-type="bibr" rid="CR20">20</xref>].</p><p id="Par17">The second stage of the two-stage system is the inversion stage, which is concerned with active and reactive power regulation. Popularly, the voltage-oriented control (VOC) and direct power control (DPC) are applied for such purpose. On the one side, the VOC relies on the cascaded structure of the voltage and current loops and its performance is mainly dependent on a proper tuning of the PI controllers. On the other side, the DPC avoids the cascaded structure of the VOC. However, it presents higher peak-to-peak ripples in the steady-state waveforms. More recently, predictive control techniques become competitive with the conventional controllers. They are simple to implement and straightforward. Furthermore, additional control objectives and constrains can be easily implemented and included in the quality function design [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR21">21</xref>].</p><p id="Par18">In the literature, some efforts have been made to limit the PV power combining the MPPT algorithm with the constant power concept. In [<xref ref-type="bibr" rid="CR22">22</xref>], single-stage three-phase grid-connected system was introduced, where P&amp;O method has been integrated with the constant power approach. In this method, an extra amount of voltage <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\Delta v)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq6.gif"/></alternatives></inline-formula> is added to the PV voltage to make the system operate at the right side of the maximum power point (MPP) due to the single-stage operation. A similar approach was used in [<xref ref-type="bibr" rid="CR23">23</xref>]. However, two-stage configuration was utilized in this system. A proportional controller (P) was employed for both the MPPT and the CPG operations in [<xref ref-type="bibr" rid="CR24">24</xref>], where the two-stage system is considered. However, the methodology exhibits high ripples at steady state; thus, an adaptive step is suggested in [<xref ref-type="bibr" rid="CR20">20</xref>] to enhance the system’s performance. Furthermore, the operation of the system is restricted to the left side of the MPP to account for sudden drop of the atmospheric conditions, where the system may operate nearly to the open-circuit condition at such situation. Most of the studies in the area of CPG employ the conventional techniques like P&amp;O or INC, which are known with their unsatisfactory performance at fast-changing atmospheric environment. Furthermore, drift can occur during these conditions, resulting in fluctuation of the injected power. Moreover, undesirable offset can happen at the DC-link [<xref ref-type="bibr" rid="CR25">25</xref>].</p><p id="Par19">Considering the aforementioned drawbacks, a modified drift-free MPPT technique is proposed in this paper. The proposed MPPT depends on a newly formulated reference voltage expression for the MPP location. This method is integrated with CPG concept for the two-stage grid-connected system. Furthermore, and to enhance the steady-state performance of the proposed control methodology, an adaptive step size is utilized. The DC-offset associated with the drift problem is totally solved using a new adaptive DC-link controller. The inverter control, to manage the active and reactive power injection, is adopted with the finite-set model predictive control (FS-MPC) technique. The proposed inverter control considers two control objectives for power management, which are current control and switching frequency minimization. The total harmonic distortion (THD) of the injected currents was used as a rule of judgment to tune the weighting factor included in the cost function design. The proposed methodology is compared with the conventional technique at various radiation conditions using simulation results.</p><p id="Par20">The remainder of this paper is organized as follows: Section <xref rid="Sec2" ref-type="sec">2</xref> introduces the model of the two-stage grid-connected PV system. Section <xref rid="Sec6" ref-type="sec">3</xref> proposes the modified drift-free MPPT algorithm with the CPG approach. The adaptive DC-link with the inverter control using FS-MPC technique is investigated in Sect. <xref rid="Sec7" ref-type="sec">4</xref>. Section <xref rid="Sec10" ref-type="sec">5</xref> presents the simulation results, and finally the paper is concluded in Sect. <xref rid="Sec15" ref-type="sec">6</xref>.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Topology of the single-diode model of the PV module</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig1_HTML.png" id="MO50"/></fig></p></sec><sec id="Sec2"><title>Model of the two-stage grid-connected PV system</title><sec id="Sec3"><title>PV source modeling</title><p id="Par21">The single-diode model is commonly used in the literature to describe the behavior of the PV source due to its simplicity and accuracy. Therefore, the current–voltage (I–V) relation of the PV source shown in Figure <xref rid="Fig1" ref-type="fig">1</xref> can be expressed as [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i_\mathrm{pv} = i_\mathrm{ph} - i_o [ e^{(\frac{v_\mathrm{pv}+i_\mathrm{pv}R_\mathrm{s}}{nN_\mathrm{s}v_t})} -1] - \frac{v_\mathrm{pv}+i_\mathrm{pv}R_\mathrm{s}}{R_\mathrm{sh}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ1.gif"/></alternatives></disp-formula>where <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_\mathrm{ph}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq7.gif"/></alternatives></inline-formula> is the photovoltaic current, <italic>n</italic> is the diode ideality factor, <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq8.gif"/></alternatives></inline-formula> is the saturation current of diode, <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq9.gif"/></alternatives></inline-formula> is the module series resistance, <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{sh}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq10.gif"/></alternatives></inline-formula> is the module shunt resistance, <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_t=kT/q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq11.gif"/></alternatives></inline-formula> is the thermal voltage, <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq12.gif"/></alternatives></inline-formula> is the number of series cells in the module, <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq13.gif"/></alternatives></inline-formula> is the output current, and <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq14.gif"/></alternatives></inline-formula> is the output voltage.</p></sec><sec id="Sec4"><title>Boost converter modeling</title><p id="Par22"><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Equivalent circuit of the boost converter when: <bold>a</bold> switch is OFF and <bold>b</bold> switch is ON</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig2_HTML.png" id="MO51"/></fig></p><p id="Par23">Generally, the state-space model of system can be written as [<xref ref-type="bibr" rid="CR10">10</xref>]<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mi>u</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mi>u</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{l} \dot{x} = {\mathbf{A}}x + {\mathbf{B}}u,\\ y = {\mathbf{C}}x + {\mathbf{D}}u, \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ2.gif"/></alternatives></disp-formula>where <italic>x</italic> is the state vector, <italic>u</italic> is the input value or vector, and <italic>y</italic> is the output. Furthermore, <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mi mathvariant="bold">A</mml:mi></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mi mathvariant="bold">B</mml:mi></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{B}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq16.gif"/></alternatives></inline-formula>, <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mi mathvariant="bold">C</mml:mi></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{C}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq17.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mi mathvariant="bold">D</mml:mi></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{D}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq18.gif"/></alternatives></inline-formula> are the system matrices.</p><p id="Par24">The boost converter has two modes of operation specified by the switch condition (ON or OFF). Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the two states of the boost converter. Thus, when the switch is open, <italic>i</italic>.<italic>e</italic>.,  OFF, the behavior of the boost converter can be described as<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\text {d}}i_l}{{\text {d}}t}= \frac{1}{L} (v_\mathrm{pv}- v_\mathrm{dc}), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_l$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq19.gif"/></alternatives></inline-formula> is the inductor current, <italic>L</italic> is the inductance value, and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq20.gif"/></alternatives></inline-formula> is the output capacitor voltage (DC-link).<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\text {d}}v_\mathrm{dc}}{{\text {d}}t}= \frac{1}{c_\mathrm{dc}} (i_{l}- i_{inv}), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ4.gif"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq21.gif"/></alternatives></inline-formula> is the DC-link capacitance, and <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{inv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq22.gif"/></alternatives></inline-formula> is the output current. Furthermore, when the switch is ON (closed), the converter performance can be described as<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\text {d}}i_l}{{\text {d}}t}= &amp; {} \frac{1}{L} v_\mathrm{pv}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\text {d}}v_{{\text {d}}c}}{{\text {d}}t}= &amp; {} -\frac{1}{c_\mathrm{dc}} i_{inv}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ6.gif"/></alternatives></disp-formula>As a conclusion, the full model of the boost converter can be summarized by<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{A}} = \begin{bmatrix} 0&amp;{}\quad { -\frac{1-d}{L}}\\ { \frac{1-d}{c_\mathrm{dc}}}&amp;{}\quad 0 \end{bmatrix}, {\mathbf{B}} = \begin{bmatrix} {\frac{1}{L}}&amp;{}\quad 0\\ 0&amp;{}\quad {-\frac{1}{c_\mathrm{dc}}} \end{bmatrix}, {\mathbf{C}} = \begin{bmatrix} 0&amp;\quad 1 \end{bmatrix}, {\mathbf{D}} = 0,\nonumber \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ7.gif"/></alternatives></disp-formula>where <italic>d</italic> is the duty cycle, <italic>x</italic>= [<inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{l}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq23.gif"/></alternatives></inline-formula><inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq24.gif"/></alternatives></inline-formula>]<inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msup><mml:mrow/><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm{{T}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq25.gif"/></alternatives></inline-formula>, <italic>u</italic> = [<inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq26.gif"/></alternatives></inline-formula><inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{inv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq27.gif"/></alternatives></inline-formula>]<inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msup><mml:mrow/><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm{{T}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq28.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=v_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq29.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec5"><title>Model of the two-level inverter with grid integration</title><p id="Par25">The configuration of the grid-connected inverter is shown in Figure <xref rid="Fig3" ref-type="fig">3</xref>, where a two-level inverter is connected to the grid via an RL filter. The response of this part of the system can be determined from<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_{abc} = u_{abc}+L_\mathrm{f} \frac{{\text {d}}i_{abc}}{{\text {d}}t}+R_\mathrm{f} i_{abc}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ8.gif"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq30.gif"/></alternatives></inline-formula> are the voltages of grid side, <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq31.gif"/></alternatives></inline-formula> are the line currents, <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq32.gif"/></alternatives></inline-formula> are the inverter-side voltages, <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_\mathrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq33.gif"/></alternatives></inline-formula> is the filter inductance, and <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq34.gif"/></alternatives></inline-formula> is the filter resistance. Furthermore, the output voltages of the inverter are deduced as [<xref ref-type="bibr" rid="CR26">26</xref>]<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} u_{abc} = \frac{1}{3} v_\mathrm{dc} T_{abc} S_{abc}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq35.gif"/></alternatives></inline-formula> is the switching states of the two-level inverter, and <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq36.gif"/></alternatives></inline-formula> is the transformation matrix, which can be expressed as<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_{abc} = \begin{bmatrix} 2&amp;{}\quad -1&amp;{}\quad -1\\ -1&amp;{}\quad 2&amp;{}\quad -1\\ -1&amp;{}\quad -1&amp;{}\quad 2 \end{bmatrix}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ10.gif"/></alternatives></disp-formula>In the rotating reference frame (<inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d-q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq37.gif"/></alternatives></inline-formula>), Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) can be rewritten as<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>ω</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{l} v_d = u_d+L_\mathrm{f}\frac{{\text {d}}i_d}{{\text {d}}t}+R_\mathrm{f} i_d- \omega L_\mathrm{f} i_q,\\ v_q = u_q+L_\mathrm{f}\frac{{\text {d}}i_q}{{\text {d}}t}+R_\mathrm{f} i_q+ \omega L_\mathrm{f} i_d,\ \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ11.gif"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">dq</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{dq}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq38.gif"/></alternatives></inline-formula> are the <italic>dq</italic> components of the <italic>abc</italic> voltages, <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">dq</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{dq}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq39.gif"/></alternatives></inline-formula> are the line currents in <italic>dq</italic> reference frame, and <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mi>ω</mml:mi></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq40.gif"/></alternatives></inline-formula> is the angular frequency of the grid. Furthermore, the active and reactive powers are obtained as:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{l} P= \frac{3}{2} (v_{d} i_{d} + v_{q} i_{q} ),\\ Q= \frac{3}{2} (v_{q} i_{d} - v_{d} i_{q} ).\ \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ12.gif"/></alternatives></disp-formula><fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Two-level inverter interfaced with the grid using RL filter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig3_HTML.png" id="MO52"/></fig></p></sec></sec><sec id="Sec6"><title>Modified drift-free MPPT algorithm with constant power generation</title><p id="Par26">The proposed drift-free MPPT depends on the model of the PV source, whereas an expression for the MPP location is pursued in this part of study. Several studies have tried to allocate the locus of the MPPs. In [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>], linear and cubic equations were introduced based on the curve-fitting procedure. Logarithmic function was suggested in [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. However, up to date, there is no straightforward derivation for the locus of the MPP. Considering this gap in the literature, an analogy between the open circuit point and the MPP is used in this work to investigate the effect of both the temperature and radiation on the MPP’s location. It is worth mentioning that the location of the MPP depends on the atmospheric conditions (temperature and radiation). In [<xref ref-type="bibr" rid="CR31">31</xref>], the radiation effect is only considered, while the temperature effect is only regarded in [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. However, the current study is considering both of them.</p><p id="Par27">It should be mentioned that the open-circuit point is intentionally used here due to the simple calculation at this point. The effect of the radiation and temperature on this point will be investigated, and using the similarity principle, the effect of these conditions will be transferred to the MPP. Firstly, to examine the radiation effect, at open-circuit condition (<inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_\mathrm{pv}=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq41.gif"/></alternatives></inline-formula>, <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{pv}=v_\mathrm{oc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq42.gif"/></alternatives></inline-formula>), the behavior of the PV source (the circuit shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) can be formulated as<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0 = i_\mathrm{ph} - i_o \left[ e^{\left( \frac{v_\mathrm{oc}}{nN_\mathrm{s}v_t}\right) } -1\right] - \frac{v_\mathrm{oc}}{R_\mathrm{sh}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ13.gif"/></alternatives></disp-formula>Normally, the value of <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{sh}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq43.gif"/></alternatives></inline-formula> is high; thus, neglecting the current flowing into this resistance, Eq. (<xref rid="Equ13" ref-type="disp-formula">13</xref>) can be further simplified to<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i_\mathrm{ph} = i_o \left[ e^{\left( \frac{v_\mathrm{oc}}{nN_\mathrm{s}v_t}\right) } -1\right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ14.gif"/></alternatives></disp-formula>Solving Eq. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) for <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{oc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq44.gif"/></alternatives></inline-formula>, the following yields<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{oc} = n N_\mathrm{s} v_t {} \ln \left( \frac{I_\mathrm{ph}+i_o}{i_o}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ15.gif"/></alternatives></disp-formula>The value of the saturation current of the diode <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq45.gif"/></alternatives></inline-formula> (in the numerator) can be neglected with respect to <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_\mathrm{ph}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq46.gif"/></alternatives></inline-formula>; thus, Equation (<xref rid="Equ15" ref-type="disp-formula">15</xref>) can be further simplified to<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{oc} = n N_\mathrm{s} v_t {} \ln \left( \frac{I_\mathrm{ph}}{i_o}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ16.gif"/></alternatives></disp-formula>The previous equation is valid at the standard test condition (STC), <italic>i</italic>.<italic>e</italic>.,  <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:msup><mml:mrow><mml:mn>25</mml:mn></mml:mrow><mml:mo>∘</mml:mo></mml:msup><mml:mtext>C</mml:mtext></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${25}^{\circ }{\hbox {C}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mn>1000</mml:mn><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>W</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mtext>m</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${1000}{\hbox { W}/\hbox {m}^{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq48.gif"/></alternatives></inline-formula>. As we now considering the radiation effect, <italic>i</italic>.<italic>e</italic>.,  that temperature is constant. Therefore, taking another operating point, similar formula can be written<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ocn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">phn</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{ocn} = n N_\mathrm{s} v_t {} \ln \left( \frac{I_\mathrm{phn}}{i_o}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ17.gif"/></alternatives></disp-formula>where <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ocn</mml:mi></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{ocn}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq49.gif"/></alternatives></inline-formula> is the open-circuit voltage at the new radiation level, and <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">phn</mml:mi></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_\mathrm{phn}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq50.gif"/></alternatives></inline-formula> is the corresponding photovoltaic current. As <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq52.gif"/></alternatives></inline-formula> are mainly dependent on the temperature, hence, their values will not be updated. Subtracting Eq. (<xref rid="Equ16" ref-type="disp-formula">16</xref>) from (<xref rid="Equ17" ref-type="disp-formula">17</xref>), the open-circuit voltage in comparison with another one can be derived as<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ocn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">phn</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{ocn}= v_\mathrm{oc}+ n N_\mathrm{s} v_t \left[ \ln \left( \frac{I_\mathrm{phn}}{I_\mathrm{ph}}\right) \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ18.gif"/></alternatives></disp-formula>The photovoltaic current is proportional to the radiation (<italic>G</italic>) [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]; thus, replacing the currents with the radiation results in<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">ocn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{ocn}= v_\mathrm{oc}+ n N_\mathrm{s} v_t \left[ \ln \left( \frac{G_{2}}{G_{1}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ19.gif"/></alternatives></disp-formula>where <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq53.gif"/></alternatives></inline-formula> is the radiation at STC, and <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq54.gif"/></alternatives></inline-formula> is the new radiation value. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the power–voltage (P–V) curve of the PV module (KC200GT module) at different radiation conditions. It is clearly obvious that the open-circuit points have a logarithmic relation among each other, where the spacing among these points is small at high radiation conditions. However, the spacing becomes relatively high at low radiation conditions.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>P–V characteristics at numerous radiation values</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig4_HTML.png" id="MO53"/></fig><fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>P–V characteristics at numerous temperature values</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig5_HTML.png" id="MO54"/></fig><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>The proposed dual-mode power generation algorithm with adaptive step-size</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig6_HTML.png" id="MO55"/></fig></p><p id="Par28">Let us transfer the above observation to the MPPs as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. It is quite obvious that the decreasing (falling) manner of the MPPs is smaller than the open-circuit ones; thus, the natural logarithm (to the base <italic>e</italic>) in Eq. (<xref rid="Equ19" ref-type="disp-formula">19</xref>) is replaced with the common one (to the base 10), and hence, it can be rewritten as<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppn</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{mppn}= v_\mathrm{mpp}+ n N_\mathrm{s} v_t \left[ \log \left( \frac{G_{2}}{G_{1}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ20.gif"/></alternatives></disp-formula>where <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppn</mml:mi></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{mppn}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq55.gif"/></alternatives></inline-formula> is the new MPP voltage at certain radiation level, and <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{mpp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq56.gif"/></alternatives></inline-formula> is the MPP voltage at STC.</p><p id="Par29">Secondly, the effect of the temperature on the MPPs will be investigated. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the P–V curve at various temperature conditions, where the open-circuit voltage variation range is linear. The same behavior applies also for the MPP voltage, and hence<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">mppt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_{mppt}= v_\mathrm{mpp}+ k_v (T-T_n), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ21.gif"/></alternatives></disp-formula>where <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">mppt</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{mppt}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq57.gif"/></alternatives></inline-formula> is the modified MPP voltage due to temperature effect, <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_v$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq58.gif"/></alternatives></inline-formula> is the open-circuit voltage temperature constant, and <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq59.gif"/></alternatives></inline-formula> is the temperature at STC. Finally, and combining Eqs. (<xref rid="Equ20" ref-type="disp-formula">20</xref>) and (<xref rid="Equ21" ref-type="disp-formula">21</xref>), to get the impact of both radiation and temperature on the MPP voltage, the following can be deduced<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppl</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{mppl}= v_\mathrm{mpp}+ n N_\mathrm{s} v_t \left[ \log \left( \frac{G_{2}}{G_{1}}\right) \right] +k_v (T-T_n), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ22.gif"/></alternatives></disp-formula>where <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppl</mml:mi></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{mppl}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq60.gif"/></alternatives></inline-formula> is the location of MPP voltage at any atmospheric condition. Further simplification can be subjected to Equation (<xref rid="Equ22" ref-type="disp-formula">22</xref>)<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppl</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub></mml:mfrac><mml:mfenced close="]" open="["><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{mppl}= &amp; {} v_\mathrm{mpp}\left[ 1{+} \frac{n N_\mathrm{s} v_t}{v_\mathrm{mpp}} \left[ \log \left( \frac{G_{2}}{G_{1}}\right) \right] \right] {+}k_v (T{-}T_n), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ23.gif"/></alternatives></disp-formula><disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppl</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mrow/><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_\mathrm{mppl}= &amp; {} v_\mathrm{mpp}\left[ 1+ k {} \log \left( \frac{G_{2}}{G_{1}}\right) \right] +k_v (T-T_n), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ24.gif"/></alternatives></disp-formula>where <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mpp</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k={n N_\mathrm{s} v_t}/{v_\mathrm{mpp}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq61.gif"/></alternatives></inline-formula>. It is quite interesting that <italic>k</italic> is written as a constant (0.0539) in many publications in the literature [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>], and it can be modified for better tuning of the MPP voltages. The reason is that the value of this constant is very small. Therefore, the temperature effect can be neglected. Moreover, the calculated value of this constant for the used PV module is 0.0708.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>The proposed adaptive DC-link controller</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig7_HTML.png" id="MO56"/></fig></p><p id="Par30">So far, the MPP voltage locus is determined using the atmospheric conditions (<italic>G</italic>, <italic>T</italic>). As a next step, the PV voltage of the installed array is sensed with the atmospheric conditions. Then, the error between the estimated voltage from Eq. (<xref rid="Equ24" ref-type="disp-formula">24</xref>) and the sensed one is adjusted adopting adaptive step-size as<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow/><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">mppl</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta d= N_1 {}|v_\mathrm{mppl}-v_\mathrm{pv}|, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ25.gif"/></alternatives></disp-formula>where <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq62.gif"/></alternatives></inline-formula> is the duty cycle change, and <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq63.gif"/></alternatives></inline-formula> is a factor to be calibrated. A similar approach to adjust the duty cycle of the converter at CPG condition can be employed as<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow/><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta d= N_2{} |P_\mathrm{pv}-P_\mathrm{ref}|, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ26.gif"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_\mathrm{ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq64.gif"/></alternatives></inline-formula> is the reference power limit, <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq65.gif"/></alternatives></inline-formula> is a factor to be regulated, and <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq66.gif"/></alternatives></inline-formula> is the output power of the PV source. The final algorithm for dual-mode power generation from the PV source is further illustrated in the flowchart shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.</p></sec><sec id="Sec7"><title>Control of the two-level inverter</title><sec id="Sec8"><title>FS-MPC principle and design</title><p id="Par31"><table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>PV grid-connected system parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th></tr></thead><tbody><tr><td align="left"><p>PV array power (kW)</p></td><td align="left"><p>15</p></td></tr><tr><td align="left"><p>Boost inductance <italic>L</italic> (mH)</p></td><td align="left"><p>5</p></td></tr><tr><td align="left"><p>Switching frequency of the boost <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq67.gif"/></alternatives></inline-formula> (kHz)</p></td><td align="left"><p>10</p></td></tr><tr><td align="left"><p>DC-link capacitance <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq68.gif"/></alternatives></inline-formula> (<inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:mi>μ</mml:mi><mml:mtext>F</mml:mtext></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu \hbox {F}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq69.gif"/></alternatives></inline-formula>)</p></td><td align="left"><p>1000</p></td></tr><tr><td align="left"><p>Filter inductance <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_\mathrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq70.gif"/></alternatives></inline-formula> (mH)</p></td><td align="left"><p>12</p></td></tr><tr><td align="left"><p>Filter resistance <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq71.gif"/></alternatives></inline-formula> (<inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq72.gif"/></alternatives></inline-formula>)</p></td><td align="left"><p>0.25</p></td></tr><tr><td align="left"><p>DC-link reference voltage <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dcref</mml:mi></mml:msub></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\mathrm{dcref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq73.gif"/></alternatives></inline-formula> (V)</p></td><td align="left"><p>700</p></td></tr><tr><td align="left"><p>Grid frequency <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mi>ω</mml:mi></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq74.gif"/></alternatives></inline-formula> (rad/s)</p></td><td align="left"><p><inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\pi \times 50$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq75.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p>Grid voltage <italic>v</italic> (<inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mtext>V</mml:mtext></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {V}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq76.gif"/></alternatives></inline-formula>)</p></td><td align="left"><p>400</p></td></tr></tbody></table></table-wrap></p><p id="Par32"><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Configuration of the proposed two-stage grid-connected system with CPG and adaptive DC-link control</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig8_HTML.png" id="MO57"/></fig></p><p id="Par33">The FS-MPC principle depends on the discrete-time model of the system. Therefore, such model is derived to control the active and reactive powers injected into the grid. Solving Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>) for the current and applying the Euler method for discretization, one gets<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>ω</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i_d (k+1) = (1-\frac{T_\mathrm{s} R_\mathrm{f}}{L_\mathrm{f}}) i_d (k)+ \omega T_\mathrm{s} i_q+ \frac{T_\mathrm{s}}{L_\mathrm{f}}(v_d (k)-u_d (k)), \nonumber \\ i_q (k+1) = (1-\frac{T_\mathrm{s} R_\mathrm{f}}{L_\mathrm{f}}) i_q (k)- \omega T_\mathrm{s} i_d+ \frac{T_\mathrm{s}}{L_\mathrm{f}}(v_q (k)-u_q (k)). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ27.gif"/></alternatives></disp-formula>where <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq77.gif"/></alternatives></inline-formula> is the sampling period. The two-level inverter has 8 switching vectors; hence, according to the cost function design, the best one will be selected. FS-MPC adds flexibility to the design of the cost function; thus, in this work the switching frequency minimization is added as a secondary control objective. Furthermore, the absolute function, which is known with stability issues [<xref ref-type="bibr" rid="CR36">36</xref>], is replaced with the square function as follows<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g= &amp; {} [i_d (k+1)- i_{d\mathrm{ref}} (k+1)]^2+[i_q (k+1)- i_{q\mathrm{ref}} (k+1)]^2 \nonumber \\&amp;+ \lambda \sum _{i=1}^{8}[S_i(k)-S(k-1)]^2, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ28.gif"/></alternatives></disp-formula>where <italic>S</italic>(<italic>k</italic>) is the current switching instant, <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(k-1)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq78.gif"/></alternatives></inline-formula> is the previous one, and <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mi>λ</mml:mi></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq79.gif"/></alternatives></inline-formula> is the weighting factor. It is also recommended to use the square function when considering more than one control objective in the cost function design [<xref ref-type="bibr" rid="CR37">37</xref>]. The predicted reference currents can be evaluated using linear extrapolation as [<xref ref-type="bibr" rid="CR38">38</xref>]<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{l} i_{d\mathrm{ref}}(k+1) = 2{}i_{d\mathrm{ref}}(k)- i_{d\mathrm{ref}}(k-1),\\ i_{q\mathrm{ref}}(k+1) = 2{}i_{q\mathrm{ref}}(k)- i_{q\mathrm{ref}}(k-1).\ \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ29.gif"/></alternatives></disp-formula></p></sec><sec id="Sec9"><title>Adaptive DC-link voltage controller</title><p id="Par34">Normally, the DC-link between the boost converter and the inverter is controlled using PI controller to provide the reference current for the inverter control loop. As mentioned previously, the behavior of the PI controller at rapidly changing atmospheric conditions is poor [<xref ref-type="bibr" rid="CR25">25</xref>]. Furthermore, it has poor disturbance rejection capability [<xref ref-type="bibr" rid="CR39">39</xref>]. Although in [<xref ref-type="bibr" rid="CR25">25</xref>], a modification to the PI controller of the voltage loop is adopted to solve the drift occurrence in the single-stage topology, the DC-link in the two-stage system still suffers from offsets even if the drift problem is solved. This phenomenon is not well-documented in the literature in the area of PV systems. Therefore, a new adaptive DC-link controller is designed in this study to solve this problem. The adaptive step-size of the reference current for the inverter control loop can be evaluated as<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow/><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dcref</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta i_{d\mathrm{ref}}= N_3{} |v_{\mathrm{dcref}}-v_\mathrm{dc}|, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_Equ30.gif"/></alternatives></disp-formula>where <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq80.gif"/></alternatives></inline-formula> is a tuning factor, and <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dcref</mml:mi></mml:msub></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\mathrm{dcref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq81.gif"/></alternatives></inline-formula> is the reference value of the DC-link voltage. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the updating procedure of the adaptive DC-link controller.</p></sec></sec><sec id="Sec10"><title>Simulation results and discussion</title><p id="Par35">The proposed dual-mode power generation system utilizes a 15-kW PV array, which is followed by boost converter for MPPT with CPG. Furthermore, the boost converter increases the PV array voltage to a proper level for the grid connection. The outer PI controller at the DC-link is substituted with the adaptive DC-link controller. The two-level inverter manages the active and reactive power control as a main objective and reduces the switching frequency as a secondary purpose. This is accomplished using a modified cost function design for FS-MPC. Finally, the output of the two-level inverter is interfaced with the grid via RL filter. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the system components and control parameters, and Fig. <xref rid="Fig8" ref-type="fig">8</xref> shows the whole configuration of the system.</p><sec id="Sec11"><title>Weighting factor tuning of the FS-MPC</title><p id="Par36"><fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>THD of the injected currents versus the weighting factor</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig9_HTML.png" id="MO58"/></fig></p><p id="Par37"><fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>The behavior of dual-mode power operation under different step changes of radiation for: <bold>a</bold> the conventional P&amp;O. <bold>b</bold> the proposed drift-free approach</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig10_HTML.png" id="MO59"/></fig></p><p id="Par38">The weighting factor (<inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mi>λ</mml:mi></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq82.gif"/></alternatives></inline-formula>) included in the quality function should be adjusted properly, so as not to deteriorate the main objective of the inverter control (active and reactive power control). The THD of the currents is used to judge and tune the value of the weighting factor. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the THD versus the weighting factor. It is obvious that the THD of the currents within the IEEE standard [<xref ref-type="bibr" rid="CR40">40</xref>] when <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mi>λ</mml:mi></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq83.gif"/></alternatives></inline-formula><inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mo>≤</mml:mo></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq84.gif"/></alternatives></inline-formula> 0.7. However, to maintain the quality of the injected currents, a value of 0.1 is selected. It should be mentioned that the curve shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref> is drawn at low power level; thus, when the power exceeds this level, the THD will be further enhanced.</p></sec><sec id="Sec12"><title>Performance of the dual-mode power generation algorithm under different atmospheric conditions</title><p id="Par39">The performance of the proposed dual-mode power generation technique is investigated under different radiation profiles. For better evaluation, step changes, ramp variations, and sinusoidal ones are created and studied using MATLAB. The ramp profiles with different slopes are suggested by the European efficiency test [<xref ref-type="bibr" rid="CR41">41</xref>] to assess the performance of the PV systems. Furthermore, the atmospheric conditions can follow a random pattern. Thus, and under fast-varying atmospheric conditions, the step changes are simple waveforms to judge the performance of the PV system. This necessitates to develop numerous profiles to describe the changing manner of the atmospheric conditions as near as possible.</p><p id="Par40">Firstly, the performance of the proposed system under different step changes of radiation is investigated and compared with the conventional approach. The conventional approach is implemented using the P&amp;O method in combination with the FS-MPC for inverter control. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows the behavior of the two-mode power operation with the traditional and the proposed algorithms, where the PV power (<inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq85.gif"/></alternatives></inline-formula>), voltage (<inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq86.gif"/></alternatives></inline-formula>), and current (<inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq87.gif"/></alternatives></inline-formula>) are illustrated, respectively. The reference for the CPG mode is assumed to be 70% (about 10 kW for the utilized system) of the rated power according to the regulations adopted in Germany [<xref ref-type="bibr" rid="CR4">4</xref>].</p><p id="Par41">In Figure <xref rid="Fig10" ref-type="fig">10</xref>, and in the first two intervals, where the radiations equal 400 W/m<inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq88.gif"/></alternatives></inline-formula> and 600 W/m<inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq89.gif"/></alternatives></inline-formula>, respectively, the MPPT is enabled and the algorithm tracks the maximum power. As the radiation increases in the following intervals, where the radiations are 800 W/m<inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq90.gif"/></alternatives></inline-formula> and 1000 W/m<inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq91.gif"/></alternatives></inline-formula>, respectively, the CPG is activated. (The PV power exceeds the reference value.) Thus, the power is maintained at 10 kW. The proposed adaptive drift-free MPPT technique has a lower ripple content at steady state in comparison with the traditional P&amp;O, and hence, the gained average power from the PV source increases. It is worth mentioning that the P&amp;O is also designed with adaptive step-size [<xref ref-type="bibr" rid="CR42">42</xref>]. Furthermore, in the power waveform, moderate overshoots exist when the system operates with the CPG, the reason is the abrupt step changes of radiation.<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>The behavior of dual-mode power operation under ramp profile of radiation for: <bold>a</bold> the conventional P&amp;O and <bold>b</bold> the proposed drift-free approach</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig11_HTML.png" id="MO60"/></fig><fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>The behavior of dual-mode power operation under sinusoidal profile of radiation for: <bold>a</bold> the conventional P&amp;O and <bold>b</bold> the proposed drift-free approach</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig12_HTML.png" id="MO61"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>The behavior of inverter control at step changes of radiation for: <bold>a</bold> the traditional FS-MPC and <bold>b</bold> the proposed FS-MPC with adaptive DC-link controller</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig13_HTML.png" id="MO62"/></fig><fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>The behavior of inverter control at ramp waveform of radiation for: <bold>a</bold> the traditional FS-MPC and <bold>b</bold> the proposed FS-MPC with adaptive DC-link controller</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig14_HTML.png" id="MO63"/></fig></p><p id="Par42">It might seem that the two algorithms have a similar behavior under step change of radiation. This proves the aforementioned claim that the step changes are simple to judge the performance of the MPPT and CPG approach. Thus, the behavior of the proposed system is further investigated at more complex and challenging profile like the ramp one. Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the PV power, voltage, and current waveforms, respectively. The P&amp;O method is known with its unsatisfactory performance at gradual increase or decrease of the radiation [<xref ref-type="bibr" rid="CR21">21</xref>]. This is very obvious from the PV voltage (<inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">pv</mml:mi></mml:msub></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{pv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq92.gif"/></alternatives></inline-formula>) in Fig. <xref rid="Fig11" ref-type="fig">11</xref>, where it exhibits a higher ripple. Furthermore, it shows a diverging behavior, which is known as the drift problem [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. This phenomenon causes a significant power drop as shown after the end of CPG span, where the MPPT is expected to operate at the beginning of the descending interval of PV power. On the one hand, the PV voltage at this interval presents a constant behavior. However, the PV current is decreasing causing the same for the PV power. On the other hand, the PV voltage with proposed algorithm is tracking its locus, which leads to an elegant maximum power extraction. Furthermore, with the traditional P&amp;O, the drift problem interferes with the CPG function causing higher ripples in the power as shown at the end of the CPG interval.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Performance summary of the traditional and the proposed inverter control at different step changes of radiation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>Condition</p></th><th align="left" colspan="2"><p>THD</p></th><th align="left" colspan="2"><p>Average switching frequency</p></th></tr><tr><th align="left"><p>Conventional (%)</p></th><th align="left"><p>Proposed (%)</p></th><th align="left"><p>Conventional</p></th><th align="left"><p>Proposed</p></th></tr></thead><tbody><tr><td align="left"><p>400 W/m<inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq93.gif"/></alternatives></inline-formula></p></td><td align="left"><p>4.10</p></td><td align="left"><p>3.99</p></td><td align="left" colspan="2"/></tr><tr><td align="left"><p>600 W/m<inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq94.gif"/></alternatives></inline-formula></p></td><td align="left"><p>2.68</p></td><td align="left"><p>2.57</p></td><td align="left"><p>4.19 kHz</p></td><td align="left"><p>3.48 kHz</p></td></tr><tr><td align="left"><p>800 W/m<inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq95.gif"/></alternatives></inline-formula></p></td><td align="left"><p>2.38</p></td><td align="left"><p>2.39</p></td><td align="left" colspan="2"><p>For all conditions</p></td></tr><tr><td align="left"><p>1000 W/m<inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq96.gif"/></alternatives></inline-formula></p></td><td align="left"><p>2.44</p></td><td align="left"><p>2.38</p></td><td align="left" colspan="2"/></tr></tbody></table></table-wrap></p><p id="Par43"><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>The behavior of inverter control at sinusoidal waveform of radiation for: <bold>a</bold> the traditional FS-MPC and <bold>b</bold> the proposed FS-MPC with adaptive DC-link controller</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig15_HTML.png" id="MO64"/></fig></p><p id="Par44">Figure <xref rid="Fig12" ref-type="fig">12</xref> shows the same results but with sinusoidal radiation profile, where the drift problem is getting worse. The PV voltage presents an approximately constant value corresponding to the descending interval of the sinusoidal profile. Furthermore, the PV current is decreasing in this interval, and the power also is decreasing. At the ascending interval of the sinusoidal waveform, the PV voltage fluctuates in a wide range resulting in a significant drop in the PV power. (The PV power drops to 2.5 kW.) This causes the span of the CPG to be shortened with higher ripples in comparison with the suggested technique, where the transition between the MPPT and the CPG is very smooth without any drift.<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>The behavior of DC-link voltage with the proposed drift-free MPPT incorporating PI and adaptive DC-link controller for: <bold>a</bold> Ramp waveform of radiation and <bold>b</bold> sinusoidal waveform of radiation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig16_HTML.png" id="MO65"/></fig><fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p>The behavior of inverter control at different step changes of filter inductance for: <bold>a</bold> the traditional FS-MPC and <bold>b</bold> the proposed FS-MPC with adaptive DC-link controller</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13369_2021_5916_Fig17_HTML.png" id="MO66"/></fig></p></sec><sec id="Sec13"><title>Investigation of the inverter control using FS-MPC and adaptive DC-link controller</title><p id="Par45">Figure <xref rid="Fig13" ref-type="fig">13</xref> presents the DC-link voltage (<inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">dc</mml:mi></mml:msub></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_\mathrm{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq97.gif"/></alternatives></inline-formula>), the active power (<italic>P</italic>) injected into the grid, reactive power (<italic>Q</italic>), the <italic>d</italic>-axis current (<inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_d$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq98.gif"/></alternatives></inline-formula>), the <italic>q</italic>-axis current (<inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq99.gif"/></alternatives></inline-formula>), and the <italic>abc</italic> currents (<inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">abc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{abc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq100.gif"/></alternatives></inline-formula>), respectively, at different step changes of radiation. The transient behavior of the proposed algorithm is very fast in comparison with the conventional one with PI controller, specially at the start-up. The reason behind that is the proposed adaptive DC-link controller, which utilizes a large step when the DC-link voltage is far from its reference (700 V), and a smaller one as the voltage approaches its reference. Furthermore, the overshoots are approximately negligible in comparison with the traditional PI. The injected active power and the <italic>d</italic>-axis current have a slower transient behavior inherited from the outer PI controller of the traditional scheme. The reactive power and the <italic>q</italic>-axis current have a higher oscillatory behavior in comparison with the proposed algorithm. Moreover, the total harmonic distortion (THD) of the <italic>abc</italic> currents for the proposed algorithm is enhanced despite the reduction in the average switching frequency by approximately 20% in comparison with the traditional one. Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the comparison between the two algorithms.</p><p id="Par46">Figure <xref rid="Fig14" ref-type="fig">14</xref> shows the same results at ramp profile of radiation. For the conventional technique, the DC-link voltage exhibits undesirable offsets in conjunction with the ascending and descending power waveform, where the offset is positive at the increasing interval of power, and negative at the deceasing one. In contrast to the proposed adaptive DC-link controller, no offset can be observed. The active power and the <italic>d</italic>-axis current show a drop as a result of the drift in the P&amp;O method. Furthermore, the ripple content in the reactive power and the <italic>q</italic>-axis current are improved with the proposed algorithm.</p><p id="Par47">The system performance is further investigated at sinusoidal radiation waveform. The inverter results are shown in Fig. <xref rid="Fig15" ref-type="fig">15</xref>, where the DC-link voltage presents a random offset profile. However, it is still positive in accordance with the increasing power waveform and negative with the deceasing one. The high oscillatory behavior of the active power and the <italic>d</italic>-axis current is inherited from the MPPT due to the drift. This in turn affects the interval of the CPG algorithm. The reactive power and the <italic>q</italic>-axis current have higher ripples with the traditional method. Moreover, due to the drift, distorted currents are injected into the grid. On the other side, the proposed algorithm has an efficient MPPT and the dual-mode power generation is very smooth with lower ripples. Furthermore, the injected power into the grid is higher due to drift avoidance.</p><p id="Par48">As mentioned previously, unlike the single stage [<xref ref-type="bibr" rid="CR25">25</xref>], if the drift problem of the MPPT is solved, the DC-link voltage still exhibits unwanted offsets. This is further investigated in Fig. <xref rid="Fig16" ref-type="fig">16</xref>, where the drift-free MPPT with a PI controller for the DC-link is shown in the left-hand side of the figure. In the right one, the drift-free MPPT is utilized with the adaptive DC-link controller. The results show that the DC-link voltage is still having offsets when PI controller is used. The upper part of the figure is at ramp waveform of radiation, and the lower one is at sinusoidal profile. However, the adaptive DC-link controller (left-handed part) is offset-free.</p></sec><sec id="Sec14"><title>Robustness assessment</title><p id="Par49">In this subsection, the effect of the system’s parameters on the performance of the inverter control is investigated. The parameters of the system are the filter resistance and inductance. The impact of the resistance’s variation can be neglected [<xref ref-type="bibr" rid="CR10">10</xref>]. However, the step changes of inductance are studied and shown in Fig. <xref rid="Fig17" ref-type="fig">17</xref>. The mismatch range is assumed to be <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mrow><mml:mo>±</mml:mo><mml:mspace width="0.166667em"/><mml:mn>50</mml:mn></mml:mrow></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm \,50$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13369_2021_5916_Article_IEq101.gif"/></alternatives></inline-formula>%. For the traditional FS-MPC algorithm, the DC-link voltage has some offsets at low inductance values. Furthermore, the active power and the <italic>d</italic>-axis current have very notable fluctuations. On the other side, with the proposed algorithm, no offsets are observed. At low inductance values, the active power and the <italic>d</italic>-axis current have a reasonable ripple content. Also, the oscillation in the reactive power and the <italic>q</italic>-axis current with proposed methodology are lower. Furthermore, distorted <italic>abc</italic> currents are injected into the grid with the conventional FS-MPC.</p></sec></sec><sec id="Sec15" sec-type="conclusions"><title>Conclusion</title><p id="Par50">In this article, the detailed model of the two-stage grid-connected PV system has been presented. The dual-mode power operation is developed by combining the MPPT and the CPG algorithms. The MPPT function is implemented using a modified drift-free method, where the location of the MPP is accurately tracked by a new formulation. The proposed formulation has taken the analogy between the open-circuit point and the MPP into consideration. In both of the MPPT and the CPG regions, an adaptive step-size is adopted to enhance the steady-state performance. The results have shown that the drift problem of P&amp;O method has caused a significant power drop and oscillatory behavior. Furthermore, it has affected and interfered with the CPG algorithm. The inverter control has been accomplished using a FS-MPC algorithm with two objectives for the cost function design. Moreover, the outer PI controller is removed and replaced with a new adaptive DC-link controller to generate the reference current. That adaptive DC-link controller not only enhances the transient behavior but also removes the undesirable offsets at the DC-link side. Furthermore, it simplifies the overall control algorithm. Finally, the proposed methodology is more robust than the traditional FS-MPC against parameter variations.</p></sec></body><back><sec><title>Funding</title><p>Open Access funding enabled and organized by Projekt DEAL.</p></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karimi</surname><given-names>M</given-names></name><name><surname>Mokhlis</surname><given-names>H</given-names></name><name><surname>Naidu</surname><given-names>K</given-names></name><name><surname>Uddin</surname><given-names>S</given-names></name><name><surname>Bakar</surname><given-names>AHA</given-names></name></person-group><article-title xml:lang="en">Photovoltaic penetration issues and impacts in distribution network—A review</article-title><source>Renew. Sustain. Energy Rev.</source><year>2016</year><volume>53</volume><fpage>594</fpage><lpage>605</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2015.08.042</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blaabjerg</surname><given-names>F</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Distributed power-generation systems and protection</article-title><source>Proc. IEEE</source><year>2017</year><volume>105</volume><issue>7</issue><fpage>1311</fpage><lpage>1331</lpage><pub-id pub-id-type="doi">10.1109/JPROC.2017.2696878</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>R</given-names></name><name><surname>Mithulananthan</surname><given-names>N</given-names></name><name><surname>Bansal</surname><given-names>RC</given-names></name><name><surname>Ramachandaramurthy</surname><given-names>VK</given-names></name></person-group><article-title xml:lang="en">A review of key power system stability challenges for large-scale PV integration</article-title><source>Renew. Sustain. Energy Rev.</source><year>2015</year><volume>41</volume><fpage>1423</fpage><lpage>1436</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2014.09.027</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">Tafti, H.D.; Sangwongwanich, A.; Yang, Y.; Konstantinou, G.; Pou, J.; Blaabjerg, F.: A general algorithm for flexible active power control of photovoltaic systems. In: 2018 IEEE Applied Power Electronics Conference and Exposition (APEC), pp. 1115-1121. IEEE (2018)</mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafti</surname><given-names>HD</given-names></name><name><surname>Sangwongwanich</surname><given-names>A</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Pou</surname><given-names>J</given-names></name><name><surname>Konstantinou</surname><given-names>G</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">An adaptive control scheme for flexible power point tracking in photovoltaic systems</article-title><source>IEEE Trans. Power Electron.</source><year>2018</year><volume>34</volume><issue>6</issue><fpage>5451</fpage><lpage>5463</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2018.2869172</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafti</surname><given-names>HD</given-names></name><name><surname>Maswood</surname><given-names>AI</given-names></name><name><surname>Konstantinou</surname><given-names>G</given-names></name><name><surname>Pou</surname><given-names>J</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">A general constant power generation algorithm for photovoltaic systems</article-title><source>IEEE Trans. Power Electron.</source><year>2017</year><volume>33</volume><issue>5</issue><fpage>4088</fpage><lpage>4101</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2724544</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>R</given-names></name><name><surname>Saha</surname><given-names>TK</given-names></name><name><surname>Modi</surname><given-names>N</given-names></name><name><surname>Masood</surname><given-names>NA</given-names></name><name><surname>Mosadeghy</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">The combined effects of high penetration of wind and PV on power system frequency response</article-title><source>Appl. Energy</source><year>2015</year><volume>145</volume><fpage>320</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.02.044</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafti</surname><given-names>HD</given-names></name><name><surname>Konstantinou</surname><given-names>G</given-names></name><name><surname>Townsend</surname><given-names>CD</given-names></name><name><surname>Farivar</surname><given-names>GG</given-names></name><name><surname>Sangwongwanich</surname><given-names>A</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Pou</surname><given-names>J</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Extended functionalities of photovoltaic systems with flexible power point tracking: recent advances</article-title><source>IEEE Trans. Power Electron.</source><year>2020</year><volume>35</volume><issue>9</issue><fpage>9342</fpage><lpage>9356</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2020.2970447</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Tafti, H.D.; Konstantinou, G.; Townsend, C.D.; Farivar, G.G.; Sangwongwanich, A.; Yang, Y.; Pou, J.; Blaabjerg, F.: A comparative study of flexible power point tracking algorithms in photovoltaic systems. In: 2019 IEEE 4th International Future Energy Electronics Conference (IFEEC), pp. 1–6. IEEE (2019)</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmed</surname><given-names>M</given-names></name><name><surname>Abdelrahem</surname><given-names>M</given-names></name><name><surname>Kennel</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Highly efficient and robust grid connected photovoltaic system based model predictive control with Kalman filtering capability</article-title><source>Sustainability</source><year>2020</year><volume>12</volume><issue>11</issue><fpage>4542</fpage><pub-id pub-id-type="doi">10.3390/su12114542</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Ahmed, M.; Abdelrahem, M.; Hackl, C.M.; Kennel, R.: Direct switching maximum power point tracking technique for PV applications. In: PESS 2020; IEEE Power and Energy Student Summit, pp. 1–5. VDE (2020)</mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Ahmed, M.; Abdelrahem, M.; Kennel, R.; Hackl, Christoph, M.: An enhanced maximum power point tracking based finite-control-set model predictive control for PV systems. In: 2020 11th Power Electronics, Drive Systems, and Technologies Conference (PEDSTC), pp. 1–6. IEEE (2020)</mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishaque</surname><given-names>K</given-names></name><name><surname>Salam</surname><given-names>Z</given-names></name><name><surname>Amjad</surname><given-names>M</given-names></name><name><surname>Mekhilef</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">An improved particle swarm optimization (PSO)-based MPPT for PV with reduced steady-state oscillation</article-title><source>IEEE Trans. Power Electron.</source><year>2012</year><volume>27</volume><issue>8</issue><fpage>3627</fpage><lpage>3638</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2012.2185713</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshkar</surname><given-names>SN</given-names></name><name><surname>Dhale</surname><given-names>SB</given-names></name><name><surname>Mukherjee</surname><given-names>JS</given-names></name><name><surname>Babu</surname><given-names>TS</given-names></name><name><surname>Rajasekar</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Solar PV array reconfiguration under partial shading conditions for maximum power extraction using genetic algorithm</article-title><source>Renew. Sustain. Energy Rev.</source><year>2015</year><volume>43</volume><fpage>102</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2014.10.098</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyden</surname><given-names>S</given-names></name><name><surname>Haque</surname><given-names>ME</given-names></name></person-group><article-title xml:lang="en">A simulated annealing global maximum power point tracking approach for PV modules under partial shading conditions</article-title><source>IEEE Trans. Power Electron.</source><year>2015</year><volume>31</volume><issue>6</issue><fpage>4171</fpage><lpage>4181</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2015.2468592</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>LL</given-names></name><name><surname>Maskell</surname><given-names>DL</given-names></name><name><surname>Patra</surname><given-names>JC</given-names></name></person-group><article-title xml:lang="en">A novel ant colony optimization-based maximum power point tracking for photovoltaic systems under partially shaded conditions</article-title><source>Energy Build.</source><year>2013</year><volume>58</volume><fpage>227</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1016/j.enbuild.2012.12.001</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teshome</surname><given-names>DF</given-names></name><name><surname>Lee</surname><given-names>CH</given-names></name><name><surname>Lin</surname><given-names>YW</given-names></name><name><surname>Lian</surname><given-names>KL</given-names></name></person-group><article-title xml:lang="en">A modified firefly algorithm for photovoltaic maximum power point tracking control under partial shading</article-title><source>IEEE J. Emerg. Sel. Top. Power Electron.</source><year>2016</year><volume>5</volume><issue>2</issue><fpage>661</fpage><lpage>671</lpage><pub-id pub-id-type="doi">10.1109/JESTPE.2016.2581858</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohanty</surname><given-names>S</given-names></name><name><surname>Subudhi</surname><given-names>B</given-names></name><name><surname>Ray</surname><given-names>PK</given-names></name></person-group><article-title xml:lang="en">A new MPPT design using grey wolf optimization technique for photovoltaic system under partial shading conditions</article-title><source>IEEE Trans. Sustain. Energy</source><year>2015</year><volume>7</volume><issue>1</issue><fpage>181</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2015.2482120</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaced</surname><given-names>K</given-names></name><name><surname>Larbes</surname><given-names>C</given-names></name><name><surname>Ramzan</surname><given-names>N</given-names></name><name><surname>Bounabi</surname><given-names>M</given-names></name><name><surname>Elabadine Dahmane</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">Bat algorithm based maximum power point tracking for photovoltaic system under partial shading conditions</article-title><source>Solar Energy</source><year>2017</year><volume>158</volume><fpage>490</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2017.09.063</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sangwongwanich</surname><given-names>A</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">High-performance constant power generation in grid-connected PV systems</article-title><source>IEEE Trans. Power Electron.</source><year>2015</year><volume>31</volume><issue>3</issue><fpage>1822</fpage><lpage>1825</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2015.2465151</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmed</surname><given-names>M</given-names></name><name><surname>Abdelrahem</surname><given-names>M</given-names></name><name><surname>Harbi</surname><given-names>I</given-names></name><name><surname>Kennel</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">An adaptive model-based mppt technique with drift-avoidance for grid-connected PV systems</article-title><source>Energies</source><year>2020</year><volume>13</volume><issue>24</issue><fpage>6656</fpage><pub-id pub-id-type="doi">10.3390/en13246656</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Wandhare, R.G.; Agarwal, V.: Precise active and reactive power control of the PV-DGS integrated with weak grid to increase PV penetration. In: 2014 IEEE 40th Photovoltaic Specialist Conference (PVSC), pp. 3150–3155. IEEE (2014)</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Urtasun, A.; Sanchis, P.; Marroyo, L.: Limiting the power generated by a photovoltaic system. In: 10th International Multi-Conferences on Systems, Signals Devices 2013 (SSD13), pp 1–6. IEEE (2013)</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="other">Yang, Y.; Blaabjerg, F.; Wang, H.: Constant power generation of photovoltaic systems considering the distributed grid capacity. In: 2014 IEEE Applied Power Electronics Conference and Exposition-APEC 2014, pp. 379–385. IEEE (2014)</mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kadri</surname><given-names>R</given-names></name><name><surname>Gaubert</surname><given-names>J-P</given-names></name><name><surname>Champenois</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">An improved maximum power point tracking for photovoltaic grid-connected inverter based on voltage-oriented control</article-title><source>IEEE Trans. Ind. Electron.</source><year>2010</year><volume>58</volume><issue>1</issue><fpage>66</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1109/TIE.2010.2044733</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Dirscherl, C.; Hackl, C.; Schechner, K.: Modellierung und Regelung von modernen Windkraftanlagen: Eine Einführung. In: Elektrische Antriebe-Regelung von Antriebssystemen, pp. 1540–1614. Springer, Berlin (2015)</mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y-H</given-names></name><name><surname>Huang</surname><given-names>J-W</given-names></name></person-group><article-title xml:lang="en">A fast and low cost analog maximum power point tracking method for low power photovoltaic systems</article-title><source>Solar Energy</source><year>2011</year><volume>85</volume><issue>11</issue><fpage>2771</fpage><lpage>2780</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2011.08.019</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y-H</given-names></name><name><surname>Liu</surname><given-names>C-L</given-names></name><name><surname>Huang</surname><given-names>J-W</given-names></name><name><surname>Chen</surname><given-names>J-H</given-names></name></person-group><article-title xml:lang="en">Neural-network-based maximum power point tracking methods for photovoltaic systems operating under fast changing environments</article-title><source>Solar Energy</source><year>2013</year><volume>89</volume><fpage>42</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2012.11.017</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ai</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Liao</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Computer-aided design of PV/wind hybrid system</article-title><source>Renew. Energy</source><year>2003</year><volume>28</volume><issue>10</issue><fpage>1491</fpage><lpage>1512</lpage><pub-id pub-id-type="doi">10.1016/S0960-1481(03)00011-9</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Tjukup, M.; Sopian, K.; Daud, W.R.W.; Algoul, M.; Zaharim, A.: Mathematical model for determining the performance characteristics of multi-crystalline photovoltaic modules. In: Proceedings of the 9th WSEAS International Conference on Mathematical and Computational Methods in Science and Engineering. WSEAS Conferences, Trinidad and Tobago (2007)</mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdel-Salam</surname><given-names>M</given-names></name><name><surname>El-Mohandes</surname><given-names>MT</given-names></name><name><surname>El-Ghazaly</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">An efficient tracking of MPP in PV systems using a newly-formulated P&amp;O-MPPT method under varying irradiation levels</article-title><source>J. Electr. Eng. Technol.</source><year>2020</year><volume>15</volume><issue>1</issue><fpage>501</fpage><lpage>513</lpage><pub-id pub-id-type="doi">10.1007/s42835-019-00283-x</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="other">Coelho, R.F.; Concer, F.M.; Martins, D.C.: A MPPT approach based on temperature measurements applied in PV systems. In: 2010 IEEE International Conference on Sustainable Energy Technologies (ICSET), pp. 1–6. IEEE (2010)</mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Vicente, E.M.; Moreno, R.L.; Ribeiro, E.R.: MPPT technique based on current and temperature measurements. Int. J. Photoenergy 2015 (2015)</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmed</surname><given-names>J</given-names></name><name><surname>Salam</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">A modified P&amp;O maximum power point tracking method with reduced steady-state oscillation and improved tracking efficiency</article-title><source>IEEE Trans. Sustain. Energy</source><year>2016</year><volume>7</volume><issue>4</issue><fpage>1506</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2016.2568043</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadeem</surname><given-names>A</given-names></name><name><surname>Sher</surname><given-names>HA</given-names></name><name><surname>Murtaza</surname><given-names>AF</given-names></name><name><surname>Ahmed</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Online current-sensorless estimator for PV open circuit voltage and short circuit current</article-title><source>Solar Energy</source><year>2021</year><volume>213</volume><fpage>198</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2020.11.004</pub-id></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karamanakos</surname><given-names>P</given-names></name><name><surname>Geyer</surname><given-names>T</given-names></name><name><surname>Kennel</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">On the choice of norm in finite control set model predictive control</article-title><source>IEEE Trans. Power Electron.</source><year>2017</year><volume>33</volume><issue>8</issue><fpage>7105</fpage><lpage>7117</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2756092</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rodriguez</surname><given-names>J</given-names></name><name><surname>Cortes</surname><given-names>P</given-names></name></person-group><source>Predictive Control of Power Converters and Electrical Drives</source><year>2012</year><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/9781119941446</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouafia</surname><given-names>A</given-names></name><name><surname>Gaubert</surname><given-names>J-P</given-names></name><name><surname>Krim</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Predictive direct power control of three-phase pulsewidth modulation (PWM) rectifier using space-vector modulation (SVM)</article-title><source>IEEE Trans. Power Electron.</source><year>2009</year><volume>25</volume><issue>1</issue><fpage>228</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2009.2028731</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciobotaru</surname><given-names>M</given-names></name><name><surname>Teodorescu</surname><given-names>R</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Control of single-stage single-phase PV inverter</article-title><source>EPE J.</source><year>2006</year><volume>16</volume><issue>3</issue><fpage>20</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1080/09398368.2006.11463624</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duffey</surname><given-names>CK</given-names></name><name><surname>Stratford</surname><given-names>RP</given-names></name></person-group><article-title xml:lang="en">Update of harmonic standard IEEE-519: IEEE recommended practices and requirements for harmonic control in electric power systems</article-title><source>IEEE Trans. Ind. Appl.</source><year>1989</year><volume>25</volume><issue>6</issue><fpage>1025</fpage><lpage>1034</lpage><pub-id pub-id-type="doi">10.1109/28.44238</pub-id></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">Bründlinger, R.; Henze, N.; Häberlin, H.; Burger, B.; Bergmann, A.; Baumgartner, F.: prEN 50530-The new european standard for performance characterisation of PV inverters. In: 24th EU PV Conference, Hamburg, Germany (2009)</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>F</given-names></name><name><surname>Duan</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Kang</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">A variable step size INC MPPT method for PV systems</article-title><source>IEEE Trans. Ind. Electron.</source><year>2008</year><volume>55</volume><issue>7</issue><fpage>2622</fpage><lpage>2628</lpage><pub-id pub-id-type="doi">10.1109/TIE.2008.920550</pub-id></mixed-citation></ref></ref-list></ref-list><glossary><title>Abbreviations</title><def-list><def-item><term>PV</term><def><p id="Par2">Photovoltaic</p></def></def-item><def-item><term>P&amp;O</term><def><p id="Par3">Perturb and observe</p></def></def-item><def-item><term>MPPT</term><def><p id="Par4">Maximum power point tracking</p></def></def-item><def-item><term>CPG</term><def><p id="Par5">Constant power generation</p></def></def-item><def-item><term>FS-MPC</term><def><p id="Par6">Finite-set model predictive control</p></def></def-item><def-item><term>MPP</term><def><p id="Par7">Maximum power point</p></def></def-item><def-item><term>INC</term><def><p id="Par8">Incremental conductance</p></def></def-item><def-item><term>VOC</term><def><p id="Par9">Voltage-oriented control</p></def></def-item><def-item><term>DPC</term><def><p id="Par10">Direct power control</p></def></def-item><def-item><term>THD</term><def><p id="Par11">Total harmonic distortion</p></def></def-item><def-item><term>STC</term><def><p id="Par12">Standard test conditions</p></def></def-item></def-list></glossary></back></article></records><facets><facet name="subject"><facet-value count="1">Engineering</facet-value><facet-value count="1">Engineering, general</facet-value><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value></facet><facet name="keyword"><facet-value count="1">Adaptive DC-link control</facet-value><facet-value count="1">Dual-mode power generation</facet-value><facet-value count="1">Predictive control</facet-value><facet-value count="1">PV systems</facet-value></facet><facet name="pub"><facet-value count="1">Arabian Journal for Science and Engineering</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">Egypt</facet-value><facet-value count="1">Germany</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
