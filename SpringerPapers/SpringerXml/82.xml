<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s41115-021-00011-1</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="review-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41115</journal-id><journal-title-group><journal-title>Living Reviews in Computational Astrophysics</journal-title><abbrev-journal-title abbrev-type="publisher">Living Rev Comput Astrophys</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2367-3621</issn><issn pub-type="epub">2365-0524</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41115-021-00011-1</article-id><article-id pub-id-type="manuscript">11</article-id><article-id pub-id-type="doi">10.1007/s41115-021-00011-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Review Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Simulations of cosmic ray propagation</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2370-5631</contrib-id><name><surname>Hanasz</surname><given-names>Michał</given-names></name><address><email>mhanasz@umk.pl</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41115021000111_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3799-5489</contrib-id><name><surname>Strong</surname><given-names>Andrew W.</given-names></name><address><email>aws@mpe.mpg.de</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9300-9914</contrib-id><name><surname>Girichidis</surname><given-names>Philipp</given-names></name><address><email>pgirichidis@aip.de</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5374.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0943 6490</institution-id><institution content-type="org-division">Institute of Astronomy</institution><institution content-type="org-name">Nicolaus Copernicus University</institution></institution-wrap><addr-line content-type="street">ul. Grudziadzka 5</addr-line><addr-line content-type="postcode">87-100</addr-line><addr-line content-type="city">Toruń</addr-line><country country="PL">Poland</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.450265.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 1019 2104</institution-id><institution content-type="org-name">Max-Planck-Institut für extraterrestrische Physik</institution></institution-wrap><addr-line content-type="postcode">85748</addr-line><addr-line content-type="city">Garching</addr-line><country country="DE">Germany</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.423694.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0061 1803</institution-id><institution content-type="org-name">Leibniz-Institut für Astrophysik (AIP)</institution></institution-wrap><addr-line content-type="street">An der Sternwarte 16</addr-line><addr-line content-type="postcode">14482</addr-line><addr-line content-type="city">Potsdam</addr-line><country country="DE">Germany</country></aff></contrib-group><author-notes><corresp id="IDs41115021000111_cor1"><label>a</label><email>mhanasz@umk.pl</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>26</day><month>7</month><year>2021</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2021</year></pub-date><volume>7</volume><issue seq="2">1</issue><elocation-id>2</elocation-id><history><date date-type="registration"><day>20</day><month>4</month><year>2021</year></date><date date-type="received"><day>6</day><month>7</month><year>2020</year></date><date date-type="accepted"><day>20</day><month>4</month><year>2021</year></date><date date-type="online"><day>26</day><month>7</month><year>2021</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">We review numerical methods for simulations of cosmic ray (CR) propagation on galactic and larger scales. We present the development of algorithms designed for phenomenological and self-consistent models of CR propagation in kinetic description based on numerical solutions of the Fokker–Planck equation. The phenomenological models assume a stationary structure of the galactic interstellar medium and incorporate diffusion of particles in physical and momentum space together with advection, spallation, production of secondaries and various radiation mechanisms. The self-consistent propagation models of CRs include the dynamical coupling of the CR population to the thermal plasma. The CR transport equation is discretized and solved numerically together with the set of MHD equations in various approaches treating the CR population as a separate relativistic fluid within the two-fluid approach or as a spectrally resolved population of particles evolving in physical and momentum space. The relevant processes incorporated in self-consistent models include advection, diffusion and streaming propagation as well as adiabatic compression and several radiative loss mechanisms. We discuss, applications of the numerical models for the interpretation of CR data collected by various instruments. We present example models of astrophysical processes influencing galactic evolution such as galactic winds, the amplification of large-scale magnetic fields and instabilities of the interstellar medium.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Astroparticle physics</kwd><kwd>Magnetohydrodynamics</kwd><kwd>Plasma</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Narodowe Centrum Nauki</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100004281</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">2015/19/ST9/02959</award-id><principal-award-recipient><name><surname>Hanasz</surname><given-names>Michał</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>European Research Council</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100000781</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">CRAGSMAN-646955</award-id><principal-award-recipient><name><surname>Girichidis</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41115_2021_Article_11.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>18</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>18</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>ReviewPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Astronomy, Astrophysics and Cosmology</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Numerical and Computational Physics, Simulation</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computational Science and Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Physics and Astronomy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><sec id="Sec2"><title>Introduction</title><p id="Par2">Cosmic rays (CRs) are charged particles with non-thermal energy distributions (Strong et al. <xref ref-type="bibr" rid="CR246">2007</xref>; Grenier et al. <xref ref-type="bibr" rid="CR85">2015</xref>; Gabici et al. <xref ref-type="bibr" rid="CR67">2019</xref>). There are both hadronic and leptonic cosmic rays among which protons and electrons are the most abundant particles. In the hadronic component the composition resembles approximately the element distribution in the universe (e.g. Blasi and Amato <xref ref-type="bibr" rid="CR19">2012</xref>; Gaisser et al. <xref ref-type="bibr" rid="CR70">2013</xref>), so protons and helium nuclei are by far most abundant and account for most of the energy stored in high energy particles. Heavier elements and in particular unstable isotopes are rare but provide valuable information on the dynamics of CRs and serve as clocks for CR acceleration and transport. CR electrons are usually negligible for the dynamics but provide important information on the magnetic field via loss processes that produce radio and synchrotron radiation (e.g. Gaisser <xref ref-type="bibr" rid="CR69">1991</xref>). Being high-energy charged particles, CRs mainly interact with the gas via the magnetic field (e.g. Zweibel <xref ref-type="bibr" rid="CR282">2013</xref>). The transport processes and the dynamical interaction with the gas are thus tightly coupled to plasma processes.</p><p id="Par3">The integrated energy in hadronic CRs is large enough to have a dynamical impact. In the interstellar medium the CR proton energy is comparable to the thermal and kinetic counterpart (e.g. Ferrière <xref ref-type="bibr" rid="CR63">2001</xref>). On galactic scales there is evidence that CR protons are an important agent in driving galactic winds (see, e.g. Naab and Ostriker <xref ref-type="bibr" rid="CR164">2017</xref>; Zweibel <xref ref-type="bibr" rid="CR283">2017</xref>). In addition they might have an impact on the distribution of gas in the galactic disc and thus alter the star formation process on molecular cloud scales, even though their dynamical impact on molecular clouds is expected to be much weaker compared to other drivers in the ISM like radiation or supernovae. In the densest part of cloud cores, into which CR protons are able to penetrate they ionize and heat the gas (e.g. Padovani et al. <xref ref-type="bibr" rid="CR171">2020</xref>). If CRs are efficiently coupled to the gas or penetrate into regions dense enough such that direct particle-particle collisions become relevent, they provide a temperature floor, which directly impacts the fragmentation scale and the seeds of star formation.</p></sec><sec id="Sec3"><title>Origin of CRs</title><p id="Par4">Most of the CRs are believed to be produced in shocks via diffusive shock acceleration (DSA). Early theoretical models (Krymskii <xref ref-type="bibr" rid="CR133">1977</xref>; Axford et al. <xref ref-type="bibr" rid="CR6">1977</xref>; Bell <xref ref-type="bibr" rid="CR10">1978</xref>; Blandford and Ostriker <xref ref-type="bibr" rid="CR18">1978</xref>) as well as recent numerical simulations (e.g. Caprioli and Spitkovsky <xref ref-type="bibr" rid="CR34">2014</xref>) confirm this paradigm, see also Marcowith et al. (<xref ref-type="bibr" rid="CR146">2020</xref>) for a recent review. In the Milky Way and most of the star forming galaxies supernova remnants (SNR) are by far the most abundant source of strong shocks that provide the conditions to accelerate CRs up to an energy of approximately <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>15</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">eV</mml:mi></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{15}\,{\mathrm{eV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq1.gif"/></alternatives></inline-formula>, so the particles up to that energy are likely to be of Galactic origin (Ackermann et al. <xref ref-type="bibr" rid="CR1">2013</xref>). CRs are however observed up to energies of <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msup><mml:mn>10</mml:mn><mml:mn>20</mml:mn></mml:msup></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{20}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq2.gif"/></alternatives></inline-formula> eV, which cannot be explained by SNe. Instead, Active Galactic Nuclei (AGN) are an alternative candidate to provide sufficiently energetic environments. In addition, the gyro-radii of those ulta-high energy CRs are larger than the disk of the Milky Way. If coming from a local source within our Galaxy, the individual CRs could therefore be traced back to their origin with an anisotropic distribution on the sky. However, this is not the case and those ultra high energy CRs are thus of extragalactic origin (Kotera and Silk <xref ref-type="bibr" rid="CR129">2016</xref>).</p><p id="Par5">The spectral distribution of CRs shows a peak or a flattening at a few GeV followed by a power law with remarkably little scatter. Up to energies of <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>15</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">eV</mml:mi></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{15}\,{\mathrm{eV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq3.gif"/></alternatives></inline-formula> a spectrum with <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2.7</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E^{-2.7}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq4.gif"/></alternatives></inline-formula> is observed. Above that energy the scaling steepens, which leads to naming the kink at <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>15</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">eV</mml:mi></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{15}\,{\mathrm{eV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq5.gif"/></alternatives></inline-formula> the "knee". At <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>20</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">eV</mml:mi></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{20}\,{\mathrm{eV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq6.gif"/></alternatives></inline-formula> the spectrum flattens again, which is called the "ankle". At the highest energies the spectrum is less clear, mainly due to the small statistics. Due to the steep spectrum, most of the energy can be located in a narrow energy range of from 1 to 10 GeV per nucleon. Models accounting for the dynamical impact of CRs therefore focus on GeV protons.</p></sec><sec id="Sec4"><title>Numerical approaches of CR transport and scope of this review</title><p id="Par7">CRs span a large energetic range from particle energies just exceeding the thermal distribution (~ MeV) up to the GZK cutoff (e.g. Kotera and Olinto <xref ref-type="bibr" rid="CR128">2011</xref>; Amato and Blasi <xref ref-type="bibr" rid="CR5">2018</xref>; Gabici et al. <xref ref-type="bibr" rid="CR67">2019</xref>). Over this range in momentum the dynamical range of the particle distribution function spans approximately 10 orders of magnitude. Consequently, the effective (numerical) models that describe CRs and the interactions with their environment differ. First, we need to distinguish between a <italic>macroscopic</italic> and a <italic>microscopic</italic> perspective; we start with the macroscopic models.</p><p id="Par8">For low-energy CRs with small gyroradii we are often interested in the overall energy of CRs rather than the individual particle trajectories (e.g. Padovani et al. <xref ref-type="bibr" rid="CR171">2020</xref>). On the other hand, for ultra-high-energy CRs with gyro-radii comparable to entire galactic discs the particles’ trajectory is of greater interest (Kotera and Olinto <xref ref-type="bibr" rid="CR128">2011</xref>). Equally important to the energy per particle is the fraction of CR energy compared to the other energies like the magnetic, thermal, radiation or kinetic one for the coupling between the CRs and their environment. If the integrated CR energy is much smaller that the other components, CRs can be treated as tracers without dynamical back-reaction. Depending on the system under consideration the effective transport of the CR tracers can differ from advection with the gas, to diffusion and to free streaming.</p><p id="Par9">This is basically always the case for CR electrons, so CRs can be treated as tracer particles or passive fluid. For the hadronic component we can identify three main regimes, which we outline in more detail in Sect. <xref rid="Sec5" ref-type="sec">1.4</xref>. The low-energy CRs do not significantly contribute to the dynamics via their total pressure, so again a passive tracer fluid or tracer particles are appropriate. The regime around a GeV contains comparable energy densities to other components in galaxies, so the back-reaction onto the dynamics needs to be included. There are several models of different complexity, which we outline in this review, ranging from simply adding another pressure to the hydrodynamical equations up to a more complex way of including plasma processes between CR particles and the hydromagnetic waves. The very steep spectrum results again in an overall negligible integrated energy above <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>100</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">GeV</mml:mi></mml:mrow></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 100\,{\mathrm{GeV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq8.gif"/></alternatives></inline-formula>. The passive treatment is then again appropriate. However, the large gyro-radii combined with the low number of particles favours the treatment as passive individual particles and their trajectories.</p><p id="Par10">In the microscopic CR models the interaction of <italic>individual</italic> particles with the magnetic field is of interest in order to understand plasma processes. This approach is a different numerical class, known as particle-in-cell methods, where the Lorentz force for each particle is computed and the particle distribution function is actually sampled by a large number of CRs. The complexity of this plasma approach exceeds the scope of this review and we would like to highlight the review by Marcowith et al. (<xref ref-type="bibr" rid="CR146">2020</xref>).</p><p id="Par11">The field of CR physics is large ranging from their acceleration at small spatial scales of individual shock fronts up to the trajectory of the highest energy CRs and their specific origin from extra-galactic sources. Depending on the individual setups and environmental conditions, different models are chosen and combined. Among the three main types of models (particle-in-cell, test particle models and an effective fluid description) we mainly cover the last one in different applications.</p><p id="Par12">In this review we distinguish between the following numerical models:<list list-type="bullet"><list-item><p id="Par13">We consider CR propagation described by the canonical Fokker–Planck equation in a static magnetic field, referred to as ‘phenomenological models’, which are discussed in Sects. <xref rid="Sec17" ref-type="sec">3.1</xref> and <xref rid="Sec19" ref-type="sec">3.2</xref>.</p></list-item><list-item><p id="Par14">In the second part we discuss models considering joint solutions of the Fokker–Planck equation for CRs combined with the equations of magneto-hydrodynamics (MHD). These models are referred to as ‘self-consistent models’ (Strong et al. <xref ref-type="bibr" rid="CR246">2007</xref>) and are discussed in Sects. <xref rid="Sec21" ref-type="sec">4.1</xref>–<xref rid="Sec36" ref-type="sec">5.1</xref>. They can be further distinguished in two ways.<list list-type="bullet"><list-item><p id="Par15">The first one covers a dynamical coupling of the CRs to the MHD system by simply including an additional pressure term related to cosmic rays. The interactions between CRs and magnetic fields are included as subgrid models with effective coupling coefficients, i.e. without including the streaming process explicitly in the system. This class of models however, has recently been extended to include spectrally resolved CRs.</p></list-item><list-item><p id="Par16">The latest approach also considers CR generated Alfvén waves together with CR scattering off self-excited waves (streaming) which additionally couple CRs to the energy equation of the thermal plasma through dissipation of Alfvén waves (cosmic ray heating).</p></list-item></list></p></list-item></list></p></sec><sec id="Sec5"><title>Basics and approaches</title><p id="Par17">We begin with some basic concepts of CR propagation, and relating these to observational data. Most of our knowledge of CR propagation comes <italic>via</italic> secondary CRs, with additional information from <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq9.gif"/></alternatives></inline-formula>-rays and synchrotron radiation. It is instructive to point out why secondary nuclei are an ideal probe of CR propagation: the fact that the primary nuclei are measured (albeit only near the solar position) means that the secondary production functions can be computed from primary spectra, cross-sections and interstellar gas densities; the secondaries can then be ‘propagated’ and compared with observations.</p><p id="Par18">Since it became known that CRs fill the Galaxy it has been clear that nuclear interactions imply that their composition contains information on their propagation (Bradt and Peters <xref ref-type="bibr" rid="CR26">1950</xref>). An important breakthrough was the advent of satellite measurements of isotopic Li, Be, B in the 1970’s (Garcia-Munoz et al. <xref ref-type="bibr" rid="CR71">1975</xref>). Since then the subject has expanded continuously with models of increasing degrees of sophistication. The observation that the composition of CRs is different from that of solar, in that rare solar-system nuclei like Boron are abundant in CR, proves the importance of propagation in the interstellar medium. Simplified estimates of the lifetime time of CRs in the interstellar medium conclude that there is a canonical column density of a few ‘few g cm<sup>−2</sup>’ of traversed material before the CRs interact with the gas and lose their energy (see Sect. <xref rid="Sec13" ref-type="sec">2.1</xref>).</p><sec id="Sec6"><title>Particle versus kinetic versus fluid approach</title><p id="Par19">One main distinction of CR transport is the difference between particle and fluid approaches. If the mean free path of CRs is small compared to the characteristic simulated scales, i.e. CRs scatter efficiently, they are often treated as a fluid. On the other hand, if the mean free path is comparable or larger than the system under consideration the trajectory of individual CRs need to be considered. Which approach is more appropriate depends on the spatial scales, the scattering frequency, and the energy of the CRs. To get an order of magnitude estimate of the typical scales we can investigate the gyro-radius<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r_{\mathrm{g}} = \frac{p_{\perp }}{|q|B}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ1.gif"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>p</mml:mi><mml:mo>⊥</mml:mo></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_\perp $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq11.gif"/></alternatives></inline-formula> is the momentum perpendicular to the magnetic field line, |<italic>q</italic>| is the absolute value of the charge and <italic>B</italic> is the magnetic field strength. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the gyro radius of CR protons for different magnetic field strengths as a function of CR momentum together with typical sizes of astrophysical systems. The plot illustrates that for low-energy CRs the gyro-radii are perceptibly smaller than typical astrophysical objects. We would like to highlight that the gyro-radius is not a definite measure for how the CRs need to be treated, but it nicely illustrates the separation of scales.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Gyro-radius of CRs as a function of particle momentum. For gyro-radii much smaller than the system under consideration a fluid approximation seems reasonable</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig1_HTML.png" id="MO2"/></fig></p><p id="Par20">The confinement of CRs is more complicated and depends also on the total energy in CRs compared to the energy of the background system, i.e. whether CRs can be treated as tracer particles moving through the medium or whether CR themselves modify the magnetic field and gas properties. We can broadly separate three different regimes.</p><p id="Par21"><italic>CR momenta</italic><inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mo>≪</mml:mo></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ll $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq12.gif"/></alternatives></inline-formula><italic>GeV/c</italic> The spectrum at low CR energies is not well constrained due to solar modulation (e.g. Webber <xref ref-type="bibr" rid="CR265">1998a</xref>; Potgieter <xref ref-type="bibr" rid="CR185">2013</xref>). The best data of the CR spectrum is based on Voyager (e.g. Cummings et al. <xref ref-type="bibr" rid="CR42">2016</xref>) and AMS-02 (e.g. Aguilar et al. <xref ref-type="bibr" rid="CR3">2014b</xref>, <xref ref-type="bibr" rid="CR2">a</xref>) measurements, which is still in our very local astrophysical neighbourhood. At low energies the cross section of CRs with gas atoms and molecules increases, which leads to efficient losses (Coulomb losses, ionisation losses). On typical scales above a few parsec the gas scatters efficiently and the integrated energy of CRs is low enough such that those CRs are often treated as a diffusing fluid. On scales of star forming regions and protoplanetary discs the individual trajectories might be of interest.</p><p id="Par22"><italic>CR momenta between 0.1 and</italic><inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mo>∼</mml:mo></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq13.gif"/></alternatives></inline-formula><italic>10 GeV/c</italic> This regime of the CR spectrum is the most difficult one because the total integrated CR energy is dominated by the contribution of the GeV particles. With energy densities exceeding the magnetic one, CRs do not just scatter off a background system but heavily influence the magnetic field and—connected via MHD—the local turbulent and thermal properties. Typically the scattering is very efficient, which allows a fluid approach. However, the simple diffusion approximation is likely to be violated. The resulting transfer of energy and the CR losses are complicated by the interplay between Coulomb and ionisation losses, hadronic losses and the interactions between CRs and the magnetic field.</p><p id="Par23"><italic>CR momenta above</italic><inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mo>∼</mml:mo></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq14.gif"/></alternatives></inline-formula><italic>10 GeV/c</italic> At higher momenta each CR is much more energetic than other particles in the universe. However, the spectrum is so steep that the total energy stored in those CRs is subdominant, so they are dynamically irrelevant. The low scattering efficiency makes those CRs a reliable probe of their travel through the magnetised universe. Therefore, in this energy regime CRs are often treated by following individual particles along their trajectories.</p></sec><sec id="Sec7"><title>Grey versus spectrally resolved CR fluids</title><p id="Par24">In order to account for the global effects of CRs in numerical models one often uses a grey approach, i.e. CR properties integrated over the full momentum range of the distribution function. In this simplified approach the CRs are treated as a fluid with global effective transport properties and interaction efficiencies. As in thermal gas dynamics an underlying spectrum needs to be assumed. Spectrally resolved methods allow for a more accurate treatment of the cooling.</p></sec></sec><sec id="Sec8"><title>The canonical CR propagation equation</title><p id="Par25">The canonical CR propagation equation can be written as (Skilling <xref ref-type="bibr" rid="CR228">1971</xref>, <xref ref-type="bibr" rid="CR229">1975a</xref>, <xref ref-type="bibr" rid="CR230">b</xref>, <xref ref-type="bibr" rid="CR231">c</xref>)<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mrow/></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {f}}{{\partial } {t}^{}} +{\varvec{u}} \cdot \nabla f&amp;=  \frac{1}{3} (\nabla \cdot {\varvec{u}}) p \frac{{\partial }^{} {f}}{{\partial } {p}^{}} + \nabla ( {{\mathbf {\mathsf{{D}}}}} \nabla f) \nonumber \\&amp;\quad + \frac{1}{p^2} \frac{{\partial }^{} {}}{{\partial } {p}^{}} \left[ p^2 b_lf +D_{pp} \frac{{\partial }^{} {f}}{{\partial } {p}^{}} \right] + q({\varvec{ r }}, p, t), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ2.gif"/></alternatives></disp-formula>where <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=f({\varvec{ r }},p,t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq15.gif"/></alternatives></inline-formula> is the CR density per unit momentum <italic>p</italic> at position <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ r }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq16.gif"/></alternatives></inline-formula> and at time <italic>t</italic>, <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(p)\,dp = 4\pi p^2 f({\varvec{ p }})\,dp $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq17.gif"/></alternatives></inline-formula> in terms of phase-space density <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({\varvec{ p }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq18.gif"/></alternatives></inline-formula>, <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_l$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq19.gif"/></alternatives></inline-formula> represents mechanical and adiabatic losses and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q({\varvec{ r }}, p, t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq20.gif"/></alternatives></inline-formula> denotes the source terms. The effective CR advection velocity is<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ u }}={\varvec{ v }}_{0} + {\varvec{ v }}_s, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq21.gif"/></alternatives></inline-formula> is the advection velocity of thermal plasma and<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mi mathvariant="normal">sign</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ v }}_s = - {\varvec{ b }} v_{\mathrm {A}} \mathrm{sign}({\varvec{ b }}\cdot \nabla {e_{\text {cr}}}) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ4.gif"/></alternatives></disp-formula>accounts for scattering of CR particles off self-excited Alfvén waves with <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ b }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq22.gif"/></alternatives></inline-formula> denoting the unit vector aligned with magnetic field, and <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq23.gif"/></alternatives></inline-formula> is the Alfvén speed.</p><p id="Par26">The waves are excited due to a resonant coupling with the streaming CR population. The condition for resonance is that the Doppler-shifted wave frequency <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega - k v$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq24.gif"/></alternatives></inline-formula> is an integral multiple of the cyclotron frequency <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mi>Ω</mml:mi></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \varOmega $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq25.gif"/></alternatives></inline-formula> (Kulsrud and Pearce <xref ref-type="bibr" rid="CR137">1969</xref>). For <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq26.gif"/></alternatives></inline-formula> the gyroresonance occurs for waves at the same phase velocity as the particle velocity. If the drift velocity of CRs exceeds the Alfvén speed, the instability occurs for the waves propagating in the same direction. CRs interacting with the wave traveling in the same direction are mainly scattered in pitch angle and give a small amount of energy to the wave. The effect is known as the streaming instability. Although the instability generates directly forward waves propagating along magnetic field in the same direction as cosmic rays, wave-wave interactions imply the existence of backward waves, propagating in the opposite direction (Chin and Wentzel <xref ref-type="bibr" rid="CR36">1972</xref>; Skilling <xref ref-type="bibr" rid="CR229">1975a</xref>).</p><p id="Par27">The spatial diffusion coefficient is generally anisotropic and thus described by a diffusion tensor<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\mathbf {\mathsf{{D}}}}}=D_{xx} {\varvec{ b }}{\varvec{ b }}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ5.gif"/></alternatives></disp-formula>with ‘<inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ b }}{\varvec{ b }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq27.gif"/></alternatives></inline-formula>’ meaning the dyadic product of vector <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ b }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq28.gif"/></alternatives></inline-formula>. In one dimension or for isotropic diffusion this reduces to a diffusion coefficient, <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq29.gif"/></alternatives></inline-formula>, which is given by<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close="〉" open="〈"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mfenced close=")" open="("><mml:msub><mml:mi>ν</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{xx}=v^{2}\left\langle \frac{1-\mu ^{2}}{2\left( \nu _{+}+\nu _{-}\right) }\right\rangle , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ6.gif"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>ν</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _{\pm }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq30.gif"/></alternatives></inline-formula> means the collision frequency against forward (+) and backward (−) waves, <italic>v</italic> is particle velocity and <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu = {\varvec{ p }} \cdot {\varvec{ b }}/ p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq31.gif"/></alternatives></inline-formula> denotes the particle pitch-angle cosine.</p><p id="Par28">Diffusive reacceleration is described as diffusion in momentum space determined by the coefficient<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mfenced close="〉" open="〈"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{pp}=4 \gamma ^{2} m^{2} v_{\mathrm {A}}^{2}\left\langle \frac{1-\mu ^{2}}{2} \frac{\nu _{+} \nu _{-}}{\nu _{+}+\nu _{-}}\right\rangle , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ7.gif"/></alternatives></disp-formula>where <italic>m</italic> is the particle mass and <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq32.gif"/></alternatives></inline-formula> is its Lorentz factor.</p><p id="Par29">CR sources are usually assumed to be concentrated near the Galactic disk and to have a radial distribution like for example supernova remnants (SNR). A source injection spectrum and its isotopic composition are required; the composition is usually initially based on primordial solar but can be determined iteratively from the CR data themselves for later comparison with solar. The spallation part of <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q({\varvec{ r }}, p,t ) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq33.gif"/></alternatives></inline-formula> depends on all progenitor species and their energy-dependent cross-sections, and the gas density <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ({\varvec{ r }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq34.gif"/></alternatives></inline-formula>; it is generally assumed that the spallation products have the same kinetic energy per nucleon as the progenitor. K-electron capture and electron stripping can be included via the time scale for loss by fragmentation <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq35.gif"/></alternatives></inline-formula> and <italic>q</italic>. <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq36.gif"/></alternatives></inline-formula> is in general a function of <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\varvec{ r }}, \beta , p/Z)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq37.gif"/></alternatives></inline-formula> where <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta =v/c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq38.gif"/></alternatives></inline-formula> and <italic>Z</italic> is the charge, and <italic>p</italic>/<italic>Z</italic> determines the gyro-radius in a given magnetic field; <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq39.gif"/></alternatives></inline-formula> may be isotropic, or more realistically anisotropic, and may be influenced by the CR themselves (e.g. in wave-damping models). The coefficient <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq40.gif"/></alternatives></inline-formula> is related to <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq41.gif"/></alternatives></inline-formula> by <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}D_{xx}\propto p^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq42.gif"/></alternatives></inline-formula>, with the proportionality constant depending on the theory of stochastic reacceleration (Berezinskii et al. <xref ref-type="bibr" rid="CR12">1990</xref>, Seo and Ptuskin <xref ref-type="bibr" rid="CR215">1994</xref>) as described in Sect. 2.5. <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ v }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq43.gif"/></alternatives></inline-formula> is a function of <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ r }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq44.gif"/></alternatives></inline-formula> and <italic>t</italic>. The term in <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\nabla }}\cdot {\varvec{ v }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq45.gif"/></alternatives></inline-formula> represents adiabatic momentum gain or loss in the non-uniform flow of gas with a frozen-in magnetic field whose inhomogeneities scatter the CR. <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq46.gif"/></alternatives></inline-formula> depends on the total spallation cross-section and <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ({\varvec{ r }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq47.gif"/></alternatives></inline-formula>. Observationally, the density <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ({\varvec{ r }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq48.gif"/></alternatives></inline-formula> can be based on surveys of atomic and molecular gas, but can also incorporate small-scale variations such as the region of low gas density surrounding the Sun. In hydrodynamical simulations, the density is naturally included in every computational cell. This equation only treats continuous momentum-loss; catastrophic losses can be included via <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq49.gif"/></alternatives></inline-formula> and <italic>q</italic>. CR electrons, positrons and antiprotons propagation constitute just special cases of this equation, differing only in their energy losses and production rates.</p><p id="Par30">The <italic>boundary conditions</italic> depend on the model; often <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq50.gif"/></alternatives></inline-formula> is assumed at the ‘halo boundary’ where particles escape into intergalactic space, but this obviously just an approximation (since the intergalactic flux is not zero) which can be relaxed for models with a physical treatment of the boundary.</p><p id="Par31">Equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is a time-dependent equation; often the steady-state solution is required, which can be obtained either by setting <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial f / \partial t = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq51.gif"/></alternatives></inline-formula> or following the time dependence until a steady state is reached; the latter procedure is much easier to implement numerically. Depending on the model setup the time-dependence of <italic>q</italic> can be neglected unless effects of nearby recent sources or the stochastic nature of sources are being studied. In hydrodynamical models, local sources are easily incorporated in regions of star formation or locally identitfied shocks. By starting with the solution for the heaviest primaries and using this source term to compute the spallation source for their products, the complete system can be solved including secondaries, tertiaries etc. Then the CR spectra at the solar position can be compared with direct observations, including solar modulation if required.</p><p id="Par32">Source abundances are determined iteratively, comparing propagation calculations with data; for nuclei with very small source abundances, the source values are masked by secondaries and cross-section uncertainties and are therefore hard to determine. Webber (<xref ref-type="bibr" rid="CR266">1998b</xref>) gives a ranking from ‘easy’ to ‘impossible’ for the possibility of getting the source abundances using Advanced Composition Explorer (ACE) data. A review of the high-precision abundances from ACE is in Wiedenbeck et al. (<xref ref-type="bibr" rid="CR270">2001</xref>) and for Ulysses in Connell (<xref ref-type="bibr" rid="CR40">2001</xref>). For a useful summary of the various astrophysical abundances relevant to interpreting CR abundances see Binns et al. (<xref ref-type="bibr" rid="CR15">2005</xref>).</p><sec id="Sec9"><title>Streaming and diffusion</title><p id="Par33">Equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) contains the term representing advection of the CR population with the velocity <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{u}}={\varvec{v}}_0+ {\varvec{v}}_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq52.gif"/></alternatives></inline-formula>, given by formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). This includes the streaming velocity along the direction pointing down the CR energy density gradient. This term originates from the consideration of the cyclotron resonance streaming instability, discovered by Kulsrud and Pearce (<xref ref-type="bibr" rid="CR137">1969</xref>), which sets in when a population of CRs move with a bulk speed greater than the Alfvén speed <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{A}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq53.gif"/></alternatives></inline-formula>. Even a slight anisotropy of CRs, which naturally arises in the presence of sources, causes unstable growth of the waves due to momentum transfer from the CRs to waves via pitch-angle scattering. The streaming CRs transfer their energy to Alfvén waves and subsequently scatter off self-generated waves (see e.g. Wiener et al. <xref ref-type="bibr" rid="CR271">2013</xref>, for a detailed introduction). Streaming and diffusion are considered respectively as the first and second order effects in expansion of the distribution function in powers of inverse wave particle scattering frequency <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mi>ν</mml:mi></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq54.gif"/></alternatives></inline-formula> (e.g. Skilling <xref ref-type="bibr" rid="CR228">1971</xref>; Wiener et al. <xref ref-type="bibr" rid="CR273">2017b</xref>).</p><p id="Par34">The waves are subject to damping due to ion-neutral friction, due to wave-particle interactions between thermal ions and the low-frequency beat waves formed by two interfering Alfvén waves (non-linear Landau damping) and due to the cascade of waves to smaller scales (turbulent damping) (see Thomas and Pfrommer <xref ref-type="bibr" rid="CR250">2019</xref>, for a brief summary on this topic). The system reaches equilibrium when the wave damping rate becomes equal to their growth rate due to the streaming instability. The scattering leads to isotropisation of the CR distribution in the reference frame co-moving with the waves, implying that the CRs bulk velocity becomes equal to the Alfvén velocity plus a local fluid velocity.</p><p id="Par35">Scattering of CR particles off Alfvén waves manifests itself as diffusion process in phase space, with spatial and momentum diffusion coefficients given respectively by formulae (<xref rid="Equ6" ref-type="disp-formula">6</xref>) and (<xref rid="Equ7" ref-type="disp-formula">7</xref>). Diffusion of CRs is intrinsically related to the streaming process which depends on local plasma conditions. In a more general case diffusion might be related also to an extrinsic turbulence driven by sources other than CRs. The effective diffusion coefficient depends on the dominant wave damping mechanism.</p><p id="Par36">Wave damping means dissipation of wave energy and heating of the interstellar medium. The heating rate due to dissipation of Alfvén waves is<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Γ</mml:mi><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>wave</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varGamma _{\text { wave}} = - {\varvec{v}}_s \cdot \nabla P_{cr}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ8.gif"/></alternatives></disp-formula>If the coupling of CRs is reduced, due to wave damping mechanisms, the effective propagation speed of the CR population might be higher than the Alfvén speed, however, it is argued that the heating rate is still given by the expression (<xref rid="Equ8" ref-type="disp-formula">8</xref>), because all momentum and energy transfer between the CRs and gas is mediated by hydromagnetic waves which propagate at the speed <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{v}}_A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq55.gif"/></alternatives></inline-formula> (e.g. Zweibel <xref ref-type="bibr" rid="CR282">2013</xref>).</p><p id="Par37">The concept of CR diffusion explains why energetic charged particles have highly isotropic distributions and why they are retained well in the Galaxy. The Galactic magnetic field which tangles the trajectories of particles plays a crucial role in this process. Typical values of the diffusion coefficient found from fitting to CR data is <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>28</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}\sim (3 - 5)\times 10^{28}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq56.gif"/></alternatives></inline-formula><inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msup><mml:mtext>cm</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {cm}^{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq57.gif"/></alternatives></inline-formula><inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {s}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq58.gif"/></alternatives></inline-formula> at an energy of <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mo>∼</mml:mo></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq59.gif"/></alternatives></inline-formula>1 GeV per nucleon and it increases with magnetic rigidity as <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>0.3</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>0.6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{0.3}-R^{0.6}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq60.gif"/></alternatives></inline-formula> in different versions of the empirical diffusion model of CR propagation. Here, the magnetic rigidity is defined as <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>Z</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R=pc/Ze$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq61.gif"/></alternatives></inline-formula> with the momentum <italic>p</italic> and the charge <italic>Ze</italic>. In a given magnetic field configuration, particles with the same rigidity follow the same trajectory.</p><p id="Par38">On the microscopic level the diffusion of CR results from particle scattering off random MHD waves and discontinuities. The effective “collision integral” for charged energetic particles moving in a magnetic field with small random fluctuations <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>B</mml:mi><mml:mo>≪</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta B\ll B$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq62.gif"/></alternatives></inline-formula> is given by the standard quasi-linear theory of plasma turbulence (Kennel and Engelmann <xref ref-type="bibr" rid="CR125">1966</xref>). The wave-particle interaction is of resonant character so that an energetic particle is predominantly scattered by those irregularities of magnetic field which have their projection of the wave vector on the average magnetic field direction equal to <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mi>μ</mml:mi></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\parallel }=\pm s/\left( r_{\mathrm{g}}\mu \right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq63.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq64.gif"/></alternatives></inline-formula> is the particle pitch angle. The integers <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=0,1,2\ldots $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq65.gif"/></alternatives></inline-formula> correspond to cyclotron resonances of different order. The efficiency of scattering depends on the polarization of the waves and on their distribution in <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ k }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq66.gif"/></alternatives></inline-formula>-space. The first-order resonance <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq67.gif"/></alternatives></inline-formula> is the most important for the isotropic and also for the one-dimensional distribution of random MHD waves along the average magnetic field. In some cases—for the calculation of scattering at small <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq68.gif"/></alternatives></inline-formula> and for the calculation of perpendicular diffusion—the broadening of resonances and magnetic mirroring effects should be taken into account. The resulting spatial diffusion is strongly anisotropic locally and goes predominantly along the magnetic field lines. However, strong fluctuations of the magnetic field on large scales of <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\sim 100$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq69.gif"/></alternatives></inline-formula> pc, where the strength of the random field is several times higher than the average field strength, lead to the isotropization of global CR diffusion in the Galaxy. The rigorous treatment of this effect is not trivial, since the field is almost static and the strictly one-dimensional diffusion along the magnetic field lines does not lead to non-zero diffusion perpendicular to <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ B }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq70.gif"/></alternatives></inline-formula>, see Casse et al. (<xref ref-type="bibr" rid="CR35">2002</xref>) and the references therein.</p><p id="Par39">Following several detailed reviews of the theory of CR diffusion (Jokipii <xref ref-type="bibr" rid="CR107">1971</xref>; Toptygin <xref ref-type="bibr" rid="CR252">1985</xref>; Berezinskii et al. <xref ref-type="bibr" rid="CR12">1990</xref>; Schlickeiser <xref ref-type="bibr" rid="CR211">2002</xref>) the diffusion coefficient at <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\mathrm {g}}&lt;L$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq71.gif"/></alternatives></inline-formula> can be roughly estimated as <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mi>δ</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>B</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>v</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}\approx \left( \delta B_{\mathrm {res}}/B\right) ^{-2} vr_{\mathrm {g}}/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq72.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta B_{\mathrm {res}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq73.gif"/></alternatives></inline-formula> is the amplitude of the random field at the resonant wave number <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\mathrm {res}}=1/r_{g}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq74.gif"/></alternatives></inline-formula>. The spectral energy density of interstellar turbulence has a power law form <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>k</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w(k)dk\sim k^{-2+a}dk$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq75.gif"/></alternatives></inline-formula>, <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=1/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq76.gif"/></alternatives></inline-formula> over a wide range of wave numbers <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>20</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/(10^{20}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq77.gif"/></alternatives></inline-formula> cm<inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>8</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$)&lt;k&lt;1/(10^{8}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq78.gif"/></alternatives></inline-formula> cm), see Elmegreen and Scalo (<xref ref-type="bibr" rid="CR54">2004</xref>), and the strength of the random field at the main scale is <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>B</mml:mi><mml:mo>≈</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta B\approx 5$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq79.gif"/></alternatives></inline-formula><inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq80.gif"/></alternatives></inline-formula>G. This gives an estimate of the diffusion coefficient <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo></mml:mrow></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}\approx $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq81.gif"/></alternatives></inline-formula><inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>27</mml:mn></mml:msup><mml:mi>β</mml:mi><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="normal">GV</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 10^{27}\beta R_{_{\mathrm {GV}}}^{1/3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq82.gif"/></alternatives></inline-formula> cm<sup>2</sup> s<sup>−1</sup>  for all CR particles with magnetic rigidities <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>8</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R&lt;10^{8}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq85.gif"/></alternatives></inline-formula> GV, in a fair agreement with the empirical diffusion model (the version with distributed reacceleration). The scaling law <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}\sim R^{1/3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq86.gif"/></alternatives></inline-formula> is determined by the value of the exponent <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=1/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq87.gif"/></alternatives></inline-formula>, typical for a Kolmogorov spectrum. Theoretically (Goldreich and Sridhar <xref ref-type="bibr" rid="CR84">1995</xref>) the Kolmogorov type spectrum might refer only to some part of the MHD turbulence which includes the (Alfvénic) structures strongly elongated along the magnetic-field direction and which are not able to provide the significant scattering and required diffusion of cosmic rays. In parallel, the more isotropic (fast magnetosonic) part of the turbulence, with a smaller value of random field at the main scale and with the exponent <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=1/2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq88.gif"/></alternatives></inline-formula> typical for the Kraichnan type turbulence spectrum, may exist in the interstellar medium (Yan and Lazarian <xref ref-type="bibr" rid="CR278">2004</xref>). The Kraichnan spectrum gives a scaling <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}\sim R^{1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq89.gif"/></alternatives></inline-formula> which is close to the high-energy asymptotic form of the diffusion coefficient obtained in the ‘plain diffusion’ version of the empirical propagation model. Thus the approach based on kinetic theory gives a proper estimate of the diffusion coefficient and predicts a power-law dependence of diffusion on magnetic rigidity, but the determination of the actual diffusion coefficient has to make use of fitting to models of CR propagation in the Galaxy.</p></sec><sec id="Sec10"><title>Convection/advection</title><p id="Par40">The transport of CRs is a combination of the locally advective contribution, where CRs are advected with the flow, plus the diffusive and/or streaming transport relative to the gas. Depending on the system under consideration convection and advection have been distinguished. From a hydrodynamical perspective the CRs are advected with the flow. Historically, global models of galaxies do not resolve the gas flow but cover the turbulent motions in the galaxy and the perturbations globally as a convective system. In the literature we therefore find both terminologies.</p><p id="Par41">While the most frequently considered mode of CR transport is diffusion, the existence of galactic winds in many galaxies suggests that advective transport should also be important. Winds are common in galaxies and can be CR-driven (e.g. Naab and Ostriker <xref ref-type="bibr" rid="CR164">2017</xref>) CRs also play a dynamical role in galactic halos (Breitschwerdt et al. <xref ref-type="bibr" rid="CR27">1991</xref>, <xref ref-type="bibr" rid="CR28">1993</xref>). Convection not only transports CR, it can also produce adiabatic energy losses as the wind speed increases away from the disk. Convection was first considered by Jokipii (<xref ref-type="bibr" rid="CR108">1976</xref>) and followed up by Owens and Jokipii (<xref ref-type="bibr" rid="CR167">1977a</xref>, <xref ref-type="bibr" rid="CR168">b</xref>), Jones (<xref ref-type="bibr" rid="CR109">1978</xref>, <xref ref-type="bibr" rid="CR110">1979</xref>), Bloemen et al. (<xref ref-type="bibr" rid="CR21">1993</xref>). Both 1-zone and 2-zone models have been studied: a 1-zone model has convection and diffusion everywhere, a 2-zone model has diffusion alone up to some distance from the plane, and diffusion plus convection beyond.</p><p id="Par42">For <italic>one-zone</italic> diffusion/convection models a good diagnostic is the energy-dependence of the secondary-to-primary ratio: a purely convective transport would have no energy dependence (apart from the velocity-dependence of the reaction rate), contrary to what is observed. If the diffusion rate decreases with decreasing energy, any convection will eventually take over and cause the secondary-to-primary ratio to flatten at low energy: this is observed but convection does not reproduce e.g. the Boron-to-Carbon ratio (B/C) very well (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>).</p><p id="Par43">Ptuskin et al. (<xref ref-type="bibr" rid="CR191">1997</xref>) studied a self-consistent <italic>two-zone</italic> model with a wind driven by CR and thermal gas in a rotating Galaxy. The CR propagation is entirely diffusive in a zone <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|z|&lt; 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq90.gif"/></alternatives></inline-formula> kpc, and diffusive-convective outside. CR reaching the convective zone do not return, so it acts as a halo boundary with height varying with energy and Galactocentric radius. It is possible to explain the energy-dependence of the secondary-to-primary ratio with this model, and it is also claimed to be consistent with radioactive isotopes. The effect of a Galactic wind on the radial CR gradient has been investigated (Breitschwerdt et al. <xref ref-type="bibr" rid="CR29">2002</xref>); they constructed a self-consistent model with the wind driven by CR, and with anisotropic diffusion. The convective velocities involved in the outer zone are large (~ 100 km s<sup>−1</sup>) but this model is still consistent with radioactive CR nuclei which set a much lower limit (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>), since this limit is only applicable in the inner zone. Observational support of such models would require direct evidence for a Galactic wind in the halo.</p></sec><sec id="Sec11"><title>Reacceleration</title><p id="Par44">In addition to spatial diffusion, the scattering of CR particles on randomly moving MHD waves leads to stochastic acceleration which is described in the transport equation as diffusion in momentum space with some diffusion coefficient <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq93.gif"/></alternatives></inline-formula>. One can estimate it as <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:mn>9</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}=p^{2}V_{\mathrm {a}}^{2}/\left( 9D_{xx}\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq94.gif"/></alternatives></inline-formula> where the Alfvén velocity <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm {a}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq95.gif"/></alternatives></inline-formula> is introduced as a characteristic velocity of weak disturbances propagating in a magnetic field, see Berezinskii et al. (<xref ref-type="bibr" rid="CR12">1990</xref>), Schlickeiser (<xref ref-type="bibr" rid="CR211">2002</xref>) for rigorous formulas.</p></sec></sec></sec><sec id="Sec12"><title>Early models</title><sec id="Sec13"><title>CR propagation - basic relations and motivations</title><p id="Par45">Assuming that CRs are accelerated from the ISM of our Galaxy, we expect a similar composition of CRs and the thermal gas in the ISM. However, their observed abundances show a relative over-abundance of the light elements Li, Be, and B, which must be produced during their transport through the ISM. These elements are produced in spallation processes and are thus secondary particles. A classical measure of the ratio of stable secondaries to primaries is the B/C ratio, which depends on particle energy, but can be approximated to zeroth order to be <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 0.3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq96.gif"/></alternatives></inline-formula>. The grammage is the amount of material that the CRs have to pass through before they interact with an atom in the ISM,<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>l</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \chi = \int \rho (l) dl. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ9.gif"/></alternatives></disp-formula>The grammage can be related to the spallation products by comparing the travelled depth with the mean mass per particle in the ISM <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">ISM</mml:mi></mml:msub></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{\mathrm{ISM}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq97.gif"/></alternatives></inline-formula> and the typical cross section for the spallation of carbon to boron,<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mfrac><mml:mo>∼</mml:mo><mml:mfrac><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">ISM</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>∼</mml:mo><mml:mn>0.3</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\mathrm {B}}{\mathrm {C}}\sim \frac{\chi }{m_{\mathrm{ISM}}/\sigma _{\mathrm {C}\rightarrow \mathrm {B}}} \sim 0.3. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ10.gif"/></alternatives></disp-formula>Using typical numbers for the ISM we find a grammage of <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 10\,\mathrm {g\,cm}^{-2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq98.gif"/></alternatives></inline-formula>. At a disc surface density of approximately <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mi mathvariant="normal">gas</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mo>⊙</mml:mo></mml:msub><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">pc</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varSigma _{\mathrm{gas}}\sim 10\,\mathrm {M}_\odot \,\mathrm {pc}^{-2} = 2\times 10^{-3}\,\mathrm {g\,cm}^{-2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq99.gif"/></alternatives></inline-formula> the CR must cross the disc <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq100.gif"/></alternatives></inline-formula> times, assuming that the grammage is accumulated by travelling through the disc. The associated travel or residence time, which can also be understood as the lifetime of a CR in the Galaxy or its escape time from the disc, is given by<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>χ</mml:mi><mml:msub><mml:mi>Σ</mml:mi><mml:mi mathvariant="normal">gas</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.166667em"/><mml:mfrac><mml:mi>h</mml:mi><mml:mi>v</mml:mi></mml:mfrac><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">yr</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} t_{\mathrm{res}}=\frac{\chi }{\varSigma _{\mathrm{gas}}}\,\frac{h}{v} \sim 10^6\,\mathrm {yr} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ11.gif"/></alternatives></disp-formula>for a gas scale height of <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∼</mml:mo><mml:mn>100</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">pc</mml:mi></mml:mrow></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\sim 100\,\mathrm {pc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq101.gif"/></alternatives></inline-formula> and a CR velocity <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v=c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq102.gif"/></alternatives></inline-formula>.</p><p id="Par46">The linear distance that a CR travels during the residence time is <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub><mml:mi>c</mml:mi><mml:mo>∼</mml:mo><mml:mn>500</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">kpc</mml:mi></mml:mrow></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=t_{\mathrm{res}}c\sim 500\,\mathrm {kpc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq103.gif"/></alternatives></inline-formula>, so much larger than galactic scales and the CRs need to be confined to the Galaxy. In order to estimate escape timescales of the CRs unstable secondaries provide a valuable tool. The longest lived and best measured unstable isotope is <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq104.gif"/></alternatives></inline-formula>Be. Its decay time is <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">decay</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.39</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{\mathrm{decay}}=1.39\,\mathrm {Myr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq105.gif"/></alternatives></inline-formula>, which is of the order of the residence time. The cross sections for the spallation of carbon into stable (<inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msup><mml:mrow/><mml:mn>9</mml:mn></mml:msup></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{9}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq106.gif"/></alternatives></inline-formula>Be) and unstable (<inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq107.gif"/></alternatives></inline-formula>Be) beryllium are similar, <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup><mml:mi mathvariant="normal">Be</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:msup><mml:mrow/><mml:mn>9</mml:mn></mml:msup><mml:mi mathvariant="normal">Be</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\mathrm {C}\rightarrow \mathrm {^{10}Be}}\sim \sigma _{\mathrm {C}\rightarrow \mathrm {^9Be}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq108.gif"/></alternatives></inline-formula>. This means that an initial abundance ratio (<inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq109.gif"/></alternatives></inline-formula>Be/<inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msup><mml:mrow/><mml:mn>9</mml:mn></mml:msup></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{9}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq110.gif"/></alternatives></inline-formula>Be) of unity at production decreases over time by <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">decay</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn></mml:msup><mml:mi mathvariant="normal">Be</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{\mathrm{decay}}(^{10}\mathrm {Be})/t_{\mathrm{res}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq111.gif"/></alternatives></inline-formula>. Measurements of this ratio reveal a residence time of <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:mrow><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10-20\,\mathrm {Myr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq112.gif"/></alternatives></inline-formula>, so larger than the residence time of CRs.</p><p id="Par47">A simple transport equation along the vertical dimension reads<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:mi>D</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial N}{\partial t} = Q_0(p)\delta (z) + \frac{\partial }{\partial z}\left[ D \frac{\partial N}{\partial z}\right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ12.gif"/></alternatives></disp-formula>Here, <italic>N</italic> is the number density of CRs, <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq113.gif"/></alternatives></inline-formula> is the CR source function, <italic>D</italic> is the diffusion coefficient, and <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq114.gif"/></alternatives></inline-formula> is the Dirac-<inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq115.gif"/></alternatives></inline-formula> distribution. By assuming steady state and an injection of CRs close to the midplane at <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq116.gif"/></alternatives></inline-formula>, we can reduce the equation to<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Q_0(p)\delta (z) = D\frac{\partial ^2 N}{\partial z^2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ13.gif"/></alternatives></disp-formula>and find for <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z&gt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq117.gif"/></alternatives></inline-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">const</mml:mi><mml:mo>.</mml:mo></mml:mrow><mml:mo stretchy="false">⇔</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>z</mml:mi><mml:mi>H</mml:mi></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial N}{\partial z} = \mathrm {const.} \Leftrightarrow N(z) = N_0\left( 1-\frac{z}{H}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ14.gif"/></alternatives></disp-formula>where <italic>H</italic> is the size of the halo, which is poorly constrained to a value of approximately <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">kpc</mml:mi></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\,\mathrm {kpc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq118.gif"/></alternatives></inline-formula>. The total grammage <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub><mml:mi>c</mml:mi></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi =\overline{\rho }t_{\mathrm{res}} c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq119.gif"/></alternatives></inline-formula> will be reached by moving though the average density of the total volume (disc plus halo), <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:mover><mml:mi>ρ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">ISM</mml:mi></mml:msub><mml:mi>h</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\rho }=\mu m_{\mathrm{p}}n_{\mathrm{ISM}} h/H$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq120.gif"/></alternatives></inline-formula>, with a disc scale height of <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">pc</mml:mi></mml:mrow></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h=100\,\mathrm {pc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq121.gif"/></alternatives></inline-formula>, an average mean molecular weight of <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn></mml:mrow></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =1.4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq122.gif"/></alternatives></inline-formula>, and an average ISM density of <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\,\mathrm {cm}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq123.gif"/></alternatives></inline-formula>. The diffusion coefficient can be estimated to be<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>D</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">res</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D&amp;= \frac{H^2}{t_{\mathrm{res}}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ15.gif"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mi>μ</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">ISM</mml:mi></mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>χ</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;= \frac{H\mu m_{\mathrm{p}}n_{\mathrm{ISM}} h c}{\chi } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>28</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>H</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">kpc</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>χ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sim 3\times 10^{28} \left( \frac{H}{5\,\mathrm {kpc}}\right) \left( \frac{\chi }{10\,{\mathrm {g\,cm}}^{-2}}\right) ^{-1}{\mathrm {cm}}^2\,{\mathrm {s}}^{-1} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ17.gif"/></alternatives></disp-formula>Even though these estimates are very simplified, they provide two valuable features of GeV CRs that remain valid even with much more complex assumptions. The first is that the CRs are distributed relatively smoothly through the ISM. Locally, the CR density varies, but much less than the gas structures, so molecular clouds are located in an almost uniform sea of GeV CRs. The second is that due to frequent scattering, the CR distribution is locally isotropic.</p></sec><sec id="Sec14"><title>Weighted slabs and leaky boxes</title><p id="Par48">The closely related leaky-box and weighted slab formalisms have provided the basis for most of the literature interpreting CR data.</p><p id="Par49">In the leaky-box model, the diffusion and convection terms are approximated by the leakage term with some characteristic escape time of CR from the Galaxy. The escape time <inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">esc</mml:mi></mml:msub></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _\mathrm{esc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq124.gif"/></alternatives></inline-formula> may be a function of particle energy (momentum), charge, and mass number if needed, but it does not depend on the spatial coordinates. There are two cases when the leaky box equations can be obtained as a correct approximation to the diffusion model: (1) the model with fast CR diffusion in the Galaxy and particle reflection at the CR halo boundaries with some probability to escape (Ginzburg and Syrovatskii <xref ref-type="bibr" rid="CR77">1964</xref>), (2) the formulae for CR density in the Galactic disk in the flat halo model <inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_h \ll R)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq125.gif"/></alternatives></inline-formula> with thin source and gas disks (<inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi mathvariant="normal">gas</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_\mathrm{gas} \ll z_h)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq126.gif"/></alternatives></inline-formula> which are formally equivalent to the leaky-box model formulae in the case when stable nuclei are considered (Ginzburg and Ptuskin <xref ref-type="bibr" rid="CR76">1976</xref>). The nuclear fragmentation is actually determined not by the escape time <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="italic">esc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _ {esc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq127.gif"/></alternatives></inline-formula> but rather by the escape length in g <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {cm}^{-2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq128.gif"/></alternatives></inline-formula>: <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mi>ρ</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">esc</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = v\rho \tau _\mathrm{esc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq129.gif"/></alternatives></inline-formula> , where <inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq130.gif"/></alternatives></inline-formula> is the average gas density of interstellar gas in a galaxy with the volume of the cosmic ray halo included.</p><p id="Par50">The solution of a system of coupled transport equations for all isotopes involved in the process of nuclear fragmentation is required for studying CR propagation. A powerful method, the weighted-slab technique, which consists of splitting the problem into astrophysical and nuclear parts was suggested for this problem (Davis <xref ref-type="bibr" rid="CR45">1960</xref>; Ginzburg and Syrovatskii <xref ref-type="bibr" rid="CR77">1964</xref>) before the modern computer epoch. The nuclear fragmentation problem is solved in terms of the slab model wherein the CR beam is allowed to traverse a thickness <italic>x</italic> of the interstellar gas and these solutions are integrated over all values of <italic>x</italic> weighted with a distribution function <italic>G</italic>(<italic>x</italic>) derived from an astrophysical propagation model. In its standard realization (Protheroe et al. <xref ref-type="bibr" rid="CR187">1981</xref>; Garcia-Munoz et al. <xref ref-type="bibr" rid="CR72">1987</xref>) the weighted-slab method breaks down for low energy CRs where one has strong energy dependence of nuclear cross sections, strong energy losses, and energy dependent diffusion. Furthermore, if the diffusion coefficient depends on the nuclear species the method has rather significant errors. After some modification (Ptuskin et al. <xref ref-type="bibr" rid="CR190">1996</xref>) the weighted-slab method becomes rigorous for the important special case of separable dependence of the diffusion coefficient on particle energy (or rigidity) and position with no convective transport. The modified weighted-slab method was applied to a few simple diffusion models in Jones et al. (<xref ref-type="bibr" rid="CR111">2001a</xref>, <xref ref-type="bibr" rid="CR112">2001b</xref>). The weighted-slab method can also be applied to the solution of the leaky-box equations. It can easily be shown that the leaky-box model has an exponential distribution of path lengths <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(x) \propto \exp (-x/X)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq131.gif"/></alternatives></inline-formula> with the mean grammage equal to the escape length <italic>X</italic>.</p><p id="Par51">In a purely empirical approach, one can try to determine the shape of the distribution function <italic>G</italic>(<italic>x</italic>) which best fits the data on abundances of stable primary and secondary nuclei (Shapiro and Silberberg <xref ref-type="bibr" rid="CR217">1970</xref>). It has been established that the shape of <italic>G</italic>(<italic>x</italic>) is close to exponential: <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(x) \propto \exp (-x/X(R,\beta ))$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq132.gif"/></alternatives></inline-formula>, and this justifies the use of the leaky-box model in this case. There are various calculations of <italic>G</italic>(<italic>x</italic>) (Stephens and Streitmatter <xref ref-type="bibr" rid="CR239">1998</xref>; Davis et al. <xref ref-type="bibr" rid="CR44">2000</xref>; Jones et al. <xref ref-type="bibr" rid="CR111">2001a</xref>, <xref ref-type="bibr" rid="CR112">b</xref>).</p><p id="Par52">The possible existence of truncation, a deficit at small path lengths (below a few g <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {cm}^{-2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq133.gif"/></alternatives></inline-formula> at energies near 1 GeV/n), relative to an exponential path-length distribution, has been discussed for decades (Shapiro and Silberberg <xref ref-type="bibr" rid="CR217">1970</xref>; Garcia-Munoz et al. <xref ref-type="bibr" rid="CR72">1987</xref>; Webber <xref ref-type="bibr" rid="CR264">1993</xref>; Duvernois et al. <xref ref-type="bibr" rid="CR52">1996</xref>). The problem was not solved mainly because of cross-sectional uncertainties. In a consistent theory of CR diffusion and nuclear fragmentation in the cloudy interstellar medium, the truncation occurs naturally if some fraction of CR sources resides inside dense giant molecular clouds (Ptuskin and Soutoul <xref ref-type="bibr" rid="CR188">1990</xref>).</p><p id="Par53">For radioactive nuclei, the classical approach is to compute the ‘surviving fraction’ which is the ratio of the observed abundance to that expected in the case of no decay. Often the result is given in the form of an effective mean gas density, to be compared with the average density in the Galaxy, but this density should not be taken at face value. The surviving fraction can better be related to physical parameters (Ptuskin and Soutoul <xref ref-type="bibr" rid="CR189">1998</xref>). None of these methods can face the complexities of propagation of CR electrons and positrons with their large energy and spatially dependent energy losses.</p></sec><sec id="Sec15"><title>Explicit models</title><p id="Par54">Finally the mathematical effort required to put the 3-D Galaxy into a 1-D formalism becomes overwhelming, and it seems better to work in physical space from the beginning: this approach is intuitively simple and easy to interpret. We can call these ‘explicit models’. The explicit solution approach including secondaries was pioneered by (Ginzburg and Ptuskin <xref ref-type="bibr" rid="CR76">1976</xref>) and applied to newer data by Webber et al. (<xref ref-type="bibr" rid="CR267">1992</xref>), Bloemen et al. (<xref ref-type="bibr" rid="CR21">1993</xref>) with analytical solutions for 2D diffusion-convection models with a cosmic-ray source distribution, which however had many restrictive approximations to make them tractable (no energy losses, simple gas model). More recently a semi-empirical model which is 2D and includes energy-losses and reacceleration has been developed (Maurin et al. <xref ref-type="bibr" rid="CR151">2001</xref>, <xref ref-type="bibr" rid="CR152">2002</xref>). This is a closed-form solution expressed as a Green’s function to be integrated over the sources. It incorporates a radial CR source distribution, but the gas model is a simple constant density within the disk. Taillet et al. (<xref ref-type="bibr" rid="CR247">2004</xref>) give an analytical solution for the time-dependent case with a generalized gas distribution.</p><p id="Par55">A ‘myriad sources model’ (Higdon and Lingenfelter <xref ref-type="bibr" rid="CR98">2003</xref>), which is actually a Green’s function method without energy losses, yields similar results to Strong et al. (<xref ref-type="bibr" rid="CR245">2004</xref>) for the diffusion coefficient and halo size.</p><p id="Par56">The most advanced explicit solutions to date are the fully numerical models described in other sections. Even this has limitations in treating some aspects (e.g. when particle trajectories become important at high energies) so one might ask whether a fully Monte-Carlo approach (as is commonly done for energies <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:mrow><mml:mo>&gt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>15</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;10^{15}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq134.gif"/></alternatives></inline-formula> eV) would not be better in the future, given increasing computing power. This would allow effects like field-line diffusion (important for propagation perpendicular to the Galactic plane) to be explicitly included. However it is still challenging: a GeV particle diffusing with a mean free path of 1 pc in a Galaxy with 4 kpc halo height takes <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:mo>∼</mml:mo></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq135.gif"/></alternatives></inline-formula><inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4000</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(4000/1)^2 \approx 10^7 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq136.gif"/></alternatives></inline-formula> scatterings to leave the Galaxy, which would even now need supercomputers to obtain adequate statistics. Hence we expect a numerical solution of the propagation equations to remain an important approach for the foreseeable future.</p></sec></sec><sec id="Sec16"><title>Phenomenological models</title><sec id="Sec17"><title>GALPROP</title><p id="Par57">The GALPROP project (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>) was invented with the following aims: <list list-type="order"><list-item><p id="Par58">to enable simultaneous predictions of all relevant observations including CR nuclei, electrons and positrons, <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq137.gif"/></alternatives></inline-formula>-rays and synchrotron radiation,</p></list-item><list-item><p id="Par59">to overcome the limitations of analytical and semi-analytical methods, taking advantage of advances in computing power, as CR, <inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq138.gif"/></alternatives></inline-formula>-ray and other data become more accurate,</p></list-item><list-item><p id="Par60">to incorporate the best current information on Galactic structure and CR source distributions,</p></list-item><list-item><p id="Par61">to provide a <italic>publicly-available</italic> code as a basis for further expansion.</p></list-item></list>The first point was the real driving factor, the idea being that all data relate to the same system, the Galaxy, and one cannot for example allow a model which fits CR secondary/primary ratios while not fitting <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq139.gif"/></alternatives></inline-formula>-rays or not being compatible with the known interstellar gas distribution. There are so many simultaneous constraints, and that to find one model satisfying all of them is a challenge, which in fact has not been met up to now. GALPROP has been adopted as the standard for diffuse Galactic <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq140.gif"/></alternatives></inline-formula>-ray emission for NASA’s Fermi-LAT <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq141.gif"/></alternatives></inline-formula>-ray observatory.</p><p id="Par62">We give a very brief summary of GALPROP; for details we refer the reader to the relevant papers (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>; Moskalenko and Strong <xref ref-type="bibr" rid="CR162">1998</xref>; Strong et al. <xref ref-type="bibr" rid="CR244">2000</xref>; Moskalenko et al. <xref ref-type="bibr" rid="CR163">2002</xref>; Strong et al. <xref ref-type="bibr" rid="CR245">2004</xref>; Ptuskin et al. <xref ref-type="bibr" rid="CR192">2006</xref>) and two Annual Reviews articles, (Strong et al. <xref ref-type="bibr" rid="CR246">2007</xref>) with new developments described in Grenier et al. (<xref ref-type="bibr" rid="CR85">2015</xref>). Developments of GALPROP have continued. It is maintained as public software<xref ref-type="fn" rid="Fn1">1</xref> which includes an Explanatory Supplement describing the method in full detail. Recent developments are described in (Porter et al. <xref ref-type="bibr" rid="CR183">2017</xref>, <xref ref-type="bibr" rid="CR184">2019</xref>; Boschini et al. <xref ref-type="bibr" rid="CR24">2020b</xref>).</p><p id="Par64">The CR propagation equation is solved numerically on a spatial grid, either in 2D with cylindrical symmetry in the Galaxy or in full 3D. The boundaries of the model in Galactocentric radius and height above the disk, and the grid spacing, are user-definable. In addition there is a grid in momentum; momentum (not e.g. kinetic energy) is used because it is the natural quantity for propagation. Parameters for all processes in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) can be controlled with input parameters. The distribution of CR sources can be freely chosen, typically to represent supernova remnants (SNR). Source spectral shape and isotopic composition (relative to protons) are input parameters. Interstellar gas distributions are based on current HI and CO surveys, and the interstellar radiation field (ISRF), for lepton energy losses and inverse Compton scattering is based on a separate detailed calculation. CR fragmentation and destruction cross-sections are based on extensive compilations and parameterizations (Mashnik et al. <xref ref-type="bibr" rid="CR147">2004</xref>). The numerical solution proceeds in time until a steady-state is reached; a time-dependent solution is also an option. Checks for convergence are implemented. Starting with the heaviest primary nucleus considered (e.g. <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:msup><mml:mrow/><mml:mn>64</mml:mn></mml:msup></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{64}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq142.gif"/></alternatives></inline-formula>Ni) the propagation solution is used to compute the source term for its spallation products, which are then propagated in turn, and so on down to protons, secondary electrons and positrons, and antiprotons. In this way secondaries, tertiaries etc. are included. (Production of <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq143.gif"/></alternatives></inline-formula>B via the <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:msup><mml:mrow/><mml:mn>10</mml:mn></mml:msup></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq144.gif"/></alternatives></inline-formula>Be-decay channel is important and requires a second iteration of this procedure.) GALPROP includes K-capture and electron stripping processes, where a nucleus with an electron (H-like) is considered a separate species because of the difference in the lifetime. Since H-like atoms have only one K-shell electron, the K-capture decay half-life has to be increased by a factor of 2 compared to the measured half-life value.</p><p id="Par65">Primary electrons are treated separately. Normalization of protons, helium and electrons to experimental data is provided (all other isotopes are determined by the source composition and propagation). <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq145.gif"/></alternatives></inline-formula>-rays and synchrotron are computed using interstellar gas survey data (for pion-decay and bremsstrahlung) and the ISRF model (for inverse Compton). Spectra of all species on the chosen grid and the <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq146.gif"/></alternatives></inline-formula>-ray and synchrotron skymaps are output in a standard astronomical format for comparison with data. Extensions to GALPROP includes non-linear wave damping (Ptuskin et al. <xref ref-type="bibr" rid="CR192">2006</xref>).</p><p id="Par66">We remark that while GALPROP has the ambitious goal of being ‘realistic’, it is obvious that any such model can only be a crude approximation to reality. Some known limitations are: boundary condition (flux set to zero) at the halo boundary is not physical, only energies below <inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:msup><mml:mn>10</mml:mn><mml:mn>15</mml:mn></mml:msup></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{15}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq147.gif"/></alternatives></inline-formula> eV are treated (no trajectory calculations), spatially uniform source abundances are assumed, though stochastic sources in space and time are also implemented.</p><p id="Par67">CR propagation is traditionally treated as a spatially smooth, steady-state process. Because of the rapid diffusion and long containment time-scales in the Galaxy this is to first order a sufficient approximation, but there are cases where it breaks down. The rapid energy loss of electrons and positrons above about 100 GeV and the stochastic nature of their sources produces spatial and temporal variations. Supernovae are stochastic events and each SNR source of CR accelerates for only <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^4 - 10^5$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq148.gif"/></alternatives></inline-formula> years, which leaves an imprint on the distribution of electrons. This leads to large fluctuations in the CR electron/positron density at high energies, so that the lepton spectrum measured near the Sun may not be typical (Strong et al. <xref ref-type="bibr" rid="CR245">2004</xref>). These effects are much smaller for nucleons since there are essentially no energy losses except ionization at low energies, but they are still included. Such effects can influence the B/C ratio (Taillet et al. <xref ref-type="bibr" rid="CR247">2004</xref>; Büsching et al. <xref ref-type="bibr" rid="CR31">2005</xref>). A recent time-dependent GALPROP model is described in Porter et al. (<xref ref-type="bibr" rid="CR184">2019</xref>).</p><p id="Par68">Here we give some technical details of the GALPROP package, taken from the GALPROP Explanatory Supplement supplied with the code. These can be compared with the other approaches described in this review.</p><p id="Par69"><italic>Transport equation.</italic> GALPROP solves the transport equation with a given source distribution and boundary conditions for all cosmic-ray species. This includes Galactic wind (convection), diffusive reacceleration in the interstellar medium, energy losses, nuclear fragmentation, and decay. The numerical solution of the transport equation is based on an implicit second-order scheme (e.g. Press et al. <xref ref-type="bibr" rid="CR186">1992</xref>). The spatial boundary conditions assume either zero CR density at the boundaries or, more physically plausible, free particle escape at the boundaries. Since we have a 3-dimensional (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) or 4-dimentional (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>, <italic>p</italic>) problem (spatial variables plus momentum) we use “operator splitting” to handle the implicit solution.</p><p id="Par70">The propagation equation is written in the form:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi mathvariant="script">N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:mfrac><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mfrac><mml:mi mathvariant="script">N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac><mml:mi mathvariant="script">N</mml:mi><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\partial {\mathcal {N}}\over \partial t}&amp;= q({\varvec{ r }}, p) + {\varvec{\nabla }}\cdot ( D_{xx}{\varvec{\nabla }}{\mathcal {N}}- {\varvec{ V }}{\mathcal {N}}) + {\partial \over \partial p}\, p^2 D_{pp}{\partial \over \partial p}\, {1\over p^2}\, {\mathcal {N}}\nonumber \\&amp;\quad - {\partial \over \partial p} \left[ {\dot{p}} {\mathcal {N}}- {p\over 3} \, ({\varvec{\nabla }}\cdot {\varvec{ V }} ){\mathcal {N}}\right] - {1\over \tau _f}{\mathcal {N}}- {1\over \tau _r}{\mathcal {N}}\ , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ18.gif"/></alternatives></disp-formula>where <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}={\mathcal {N}}({\varvec{ r }},p,t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq149.gif"/></alternatives></inline-formula> is the density per unit of total particle momentum, <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}(p)dp = 4\pi p^2 f({\varvec{ p }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq150.gif"/></alternatives></inline-formula> in terms of phase-space density <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({\varvec{ p }})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq151.gif"/></alternatives></inline-formula>, <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q({\varvec{ r }}, p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq152.gif"/></alternatives></inline-formula> is the source term, <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq153.gif"/></alternatives></inline-formula> is the spatial diffusion coefficient, <inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ V }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq154.gif"/></alternatives></inline-formula> is the convection velocity, reacceleration is described as diffusion in momentum space and is determined by the coefficient <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq155.gif"/></alternatives></inline-formula>, <inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>≡</mml:mo><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{p}}\equiv dp/dt$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq156.gif"/></alternatives></inline-formula> is the momentum loss rate, <inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq157.gif"/></alternatives></inline-formula> is the time scale for fragmentation, and <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq158.gif"/></alternatives></inline-formula> is the time scale for the radioactive decay.</p><p id="Par71">One can estimate <inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:mn>9</mml:mn><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}=p^{2}V_{\mathrm {a}}^{2}/\left( 9 D_{xx}\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq159.gif"/></alternatives></inline-formula> where the Alfvén velocity <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm {a}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq160.gif"/></alternatives></inline-formula> is introduced as a characteristic velocity of weak disturbances propagating in a magnetic field, see (Berezinskii et al. <xref ref-type="bibr" rid="CR12">1990</xref>; Schlickeiser <xref ref-type="bibr" rid="CR211">2002</xref>) for rigorous formulas.</p><p id="Par72">For a given halo size the diffusion coefficient as a function of momentum and the reacceleration or convection parameters is determined by boron-to-carbon ratio data. The spatial diffusion coefficient is taken as <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}= \beta D_0(\rho /\rho _0)^{\delta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq161.gif"/></alternatives></inline-formula> if necessary with a break (<inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =\delta _{1,2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq162.gif"/></alternatives></inline-formula> below/above rigidity <inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq163.gif"/></alternatives></inline-formula>), where the factor <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:mi>β</mml:mi></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq164.gif"/></alternatives></inline-formula> (<inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:mrow><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$= v/c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq165.gif"/></alternatives></inline-formula>) is a consequence of a random-walk process. For the case of reacceleration the momentum-space diffusion coefficient <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq166.gif"/></alternatives></inline-formula> is related to the spatial coefficient <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq167.gif"/></alternatives></inline-formula> where <inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =1/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq168.gif"/></alternatives></inline-formula> for a Kolmogorov spectrum of interstellar turbulences. The convection velocity (in <italic>z</italic>-direction only) <italic>V</italic>(<italic>z</italic>) is assumed to increase linearly with distance from the plane (<inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dV/dz&gt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq169.gif"/></alternatives></inline-formula> for all <italic>z</italic>); this implies a constant adiabatic energy loss. Since the wind cannot blow in both directions at <inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq170.gif"/></alternatives></inline-formula> this formulation requires a zero velocity there. A more general case where the wind starts at zero and reaches a constant value at a specified <italic>z</italic> has therefore been implemented using a tanh function.</p><p id="Par73">The distribution of cosmic-ray sources is parameterized and usually chosen to follow the pulsar distribution from radio observations, since pulsars should be a good tracer of SNR, which are difficult to detect at large distances. The injection spectrum of nucleons is assumed to be a power law in momentum, <inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>∝</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dq(p)/dp \propto p^{-\gamma }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq171.gif"/></alternatives></inline-formula>. Energy losses for nuclei by ionization and Coulomb interactions are included, and for electrons by ionization, Coulomb interactions, bremsstrahlung, inverse Compton, and synchrotron. The code uses cross-section measurements and energy dependent fitting functions.</p><p id="Par75">The code calculates the production and propagation of secondary antiprotons from <italic>pp</italic> collisions. Secondary positrons and electrons in cosmic rays are the final product of decay of charged pions and kaons which in turn created in collisions of cosmic-ray particles with gas. Pion production by <inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mtext>H</mml:mtext><mml:mi>e</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext>He</mml:mtext><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mtext>HeHe</mml:mtext></mml:mrow></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$pp,p{\text {H}e},\text {He}p,\text {HeHe}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq175.gif"/></alternatives></inline-formula> collisions are included.</p><p id="Par76">The nuclei are aligned on the same kinetic energy per nucleon <inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\mathrm{kin}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq176.gif"/></alternatives></inline-formula> since this simplifies the secondary-to-primary computation, where primaries produce secondaries of the same <inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\mathrm{kin}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq177.gif"/></alternatives></inline-formula>. However the basic CR density used has <italic>units</italic> of density per total momentum <italic>p</italic> since this is natural for propagation. The actual units used internally are <inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:mrow><mml:mfrac><mml:mi>c</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c\over 4\pi } {\mathcal {N}}(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq178.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}(p) = d{\mathcal {N}}/dp$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq179.gif"/></alternatives></inline-formula> in units of <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {cm}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq180.gif"/></alternatives></inline-formula><inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:msup><mml:mtext>MeV</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {MeV}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq181.gif"/></alternatives></inline-formula>, i.e. <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}= 4\pi p^2 f(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq182.gif"/></alternatives></inline-formula>.</p><p id="Par77">When the <italic>flux</italic><inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I(E_\mathrm{kin})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq183.gif"/></alternatives></inline-formula> in cm<sup>−2</sup> sr<sup>−1</sup> s<sup>−1</sup> (MeV/nucleon)<inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq187.gif"/></alternatives></inline-formula> is necessary, it can be simply obtained from<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dp</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dp</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>c</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I(E_\mathrm{kin})= {\beta c\over 4\pi } {d{\mathcal {N}}\over dp} {dp\over dE_\mathrm{kin}} = {c\over 4\pi } {\mathcal {N}}(p) A, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ19.gif"/></alternatives></disp-formula>where <italic>A</italic> is the nucleus mass number. This follows from <inline-formula id="IEq188"><alternatives><mml:math id="IEq188_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>A</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mi>d</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq188_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dp = {A\over \beta } dE_\mathrm{kin}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq188.gif"/></alternatives></inline-formula>. The combined requirements of transport and fragmentation are thus elegantly met. The normal units for presentation of CR data are cm<sup>−2</sup> sr<sup>−1</sup> s<sup>−1</sup> (MeV/nucleon)<inline-formula id="IEq192"><alternatives><mml:math id="IEq192_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq192_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq192.gif"/></alternatives></inline-formula>, and with this scheme the conversion is trivial. The nucleus energy scales are logarithmic in <inline-formula id="IEq193"><alternatives><mml:math id="IEq193_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:math><tex-math id="IEq193_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\mathrm{kin}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq193.gif"/></alternatives></inline-formula>.</p><sec id="Sec18"><title>Numerical solution of the propagation equation</title><p id="Par78"><italic>Full explicit method.</italic> The diffusion, reacceleration, convection and loss terms in eq. (<xref rid="Equ18" ref-type="disp-formula">18</xref>) can all be finite-differenced for each dimension (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) or (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>, <italic>p</italic>) in the form<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\partial {\mathcal {N}}_i\over \partial t} = {{\mathcal {N}}^{t+\varDelta t}_i -{\mathcal {N}}^t_i \over \varDelta t} = {\alpha _1{\mathcal {N}}^{t}_{i-1} -\alpha _2{\mathcal {N}}^{t}_i + \alpha _3{\mathcal {N}}^{t}_{i+1}\over \varDelta t}+ q_i \ , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ20.gif"/></alternatives></disp-formula>where all terms are functions of (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) or (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>, <italic>p</italic>).</p><p id="Par79">This is the <italic>fully time-explicit method</italic> (Press et al. <xref ref-type="bibr" rid="CR186">1992</xref>) where the updating scheme is<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {N}}_i^{t+\varDelta t} = {\mathcal {N}}_i^t + \alpha _1 {\mathcal {N}}_{i-1}^{t} - \alpha _2 {\mathcal {N}}_i^{t} +\alpha _3 {\mathcal {N}}_{i+1}^{t} + q_i \varDelta t \ . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ21.gif"/></alternatives></disp-formula>which generalizes simply to any number of dimensions since all the quantities are known from the current step. It gives more accurate solutions, which tend to the exact solution according to the computed diagnostics, but are not unconditionally stable (while Crank–Nicolson is). For this reason it is only applicable for short enough timesteps. Since no solution of matrix equations is required, this method is faster than Crank–Nicolson for the same timesteps, and this compensates for the need for smaller steps.</p><p id="Par80"><italic>Fully implicit method.</italic> The diffusion, reacceleration, convection and loss terms in eq. (<xref rid="Equ18" ref-type="disp-formula">18</xref>) can all be finite-differenced for each dimension (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) or (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>, <italic>p</italic>) in the form<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\partial {\mathcal {N}}_i\over \partial t} = {{\mathcal {N}}^{t+\varDelta t}_i -{\mathcal {N}}^t_i \over \varDelta t} = {\alpha _1{\mathcal {N}}^{t+\varDelta t}_{i-1} -\alpha _2{\mathcal {N}}^{t+\varDelta t}_i + \alpha _3{\mathcal {N}}^{t+\varDelta t}_{i+1}\over \varDelta t}+ q_i \ , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ22.gif"/></alternatives></disp-formula>where all terms are functions of (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) or (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>, <italic>p</italic>).</p><p id="Par81">This is the <italic>fully time-implicit method</italic> where the updating scheme is<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {N}}_i^{t+\varDelta t} = {\mathcal {N}}_i^t + \alpha _1 {\mathcal {N}}_{i-1}^{t+\varDelta t} - \alpha _2 {\mathcal {N}}_i^{t+\varDelta t} +\alpha _3 {\mathcal {N}}_{i+1}^{t+\varDelta t} + q_i \varDelta t \ . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ23.gif"/></alternatives></disp-formula>This method is unconditionally stable for all <inline-formula id="IEq194"><alternatives><mml:math id="IEq194_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq194_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq194.gif"/></alternatives></inline-formula> and <inline-formula id="IEq195"><alternatives><mml:math id="IEq195_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq195_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq195.gif"/></alternatives></inline-formula>, but is only 1st-order accurate in time.</p><p id="Par82">The tridiagonal system of equations<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} - \alpha _1 {\mathcal {N}}_{i-1}^{t+\varDelta t} + ( 1 + \alpha _2) {\mathcal {N}}_i^{t+\varDelta t} - \alpha _3 {\mathcal {N}}_{i+1}^{t+\varDelta t} = {\mathcal {N}}_i^t + q_i \varDelta t , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ24.gif"/></alternatives></disp-formula>is solved for the <inline-formula id="IEq196"><alternatives><mml:math id="IEq196_Math"><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq196_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}_i^{t+\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq196.gif"/></alternatives></inline-formula> by standard methods. Note that for energy losses we use ‘upwind’ differencing to enhance stability, which is possible since we have only <italic>loss</italic> terms (adiabatic energy <italic>gain</italic> is not included here).</p><p id="Par83"><italic>Crank–Nicolson method.</italic> Alternatively, the propagation equation can be finite-differenced in the form<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\partial {\mathcal {N}}_i\over \partial t}&amp;= {{\mathcal {N}}^{t+\varDelta t}_i -{\mathcal {N}}^t_i \over \varDelta t} \nonumber \\&amp;= {\alpha _1{\mathcal {N}}^{t+\varDelta t}_{i-1} -\alpha _2{\mathcal {N}}^{t+\varDelta t}_i + \alpha _3{\mathcal {N}}^{t+\varDelta t}_{i+1}\over 2\varDelta t}\nonumber \\&amp;\quad +{\alpha _1{\mathcal {N}}^{t}_{i-1} -\alpha _2{\mathcal {N}}^{t}_i + \alpha _3{\mathcal {N}}^{t}_{i+1}\over 2\varDelta t} + q_i \ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ25.gif"/></alternatives></disp-formula>This is the <italic>Crank–Nicolson method</italic> where the updating scheme is<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {N}}_i^{t+\varDelta t} = {\mathcal {N}}_i^t&amp;+ {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t+\varDelta t} - {\alpha _2\over 2} {\mathcal {N}}_i^{t+\varDelta t} + {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t+\varDelta t} \nonumber \\&amp;+ {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t} - {\alpha _2\over 2} {\mathcal {N}}_i^{t } + {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t } + q_i\varDelta t \ . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ26.gif"/></alternatives></disp-formula>It thus uses a combination of implicit and explicit terms, forming the time-average of the differentials. Like the fully implicit method, this method is unconditionally stable for all <inline-formula id="IEq197"><alternatives><mml:math id="IEq197_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq197_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq197.gif"/></alternatives></inline-formula> and <inline-formula id="IEq198"><alternatives><mml:math id="IEq198_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq198_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq198.gif"/></alternatives></inline-formula>, but is 2nd-order accurate in time, so that larger time-steps are possible than with the 1st-order scheme.</p><p id="Par84">The tridiagonal system of equations<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;- {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t+\varDelta t} + ( 1 + {\alpha _2\over 2}) {\mathcal {N}}_i^{t+\varDelta t} - {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t+\varDelta t} \nonumber \\&amp;\quad = {\mathcal {N}}_i^t + q_i \varDelta t + {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t} - {\alpha _2\over 2} {\mathcal {N}}_i^{t} + {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ27.gif"/></alternatives></disp-formula>or<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;- {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t+\varDelta t} + ( 1 + {\alpha _2\over 2}) {\mathcal {N}}_i^{t+\varDelta t} - {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t+\varDelta t} \nonumber \\&amp;\quad = {\alpha _1\over 2} {\mathcal {N}}_{i-1}^{t} + (1 - {\alpha _2\over 2}) {\mathcal {N}}_i^{t} + {\alpha _3\over 2} {\mathcal {N}}_{i+1}^{t} + q_i \varDelta t \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ28.gif"/></alternatives></disp-formula>is again solved for the <inline-formula id="IEq199"><alternatives><mml:math id="IEq199_Math"><mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq199_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}_i^{t+\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq199.gif"/></alternatives></inline-formula> by the standard method. Note that the RHS has all known quantities from the current time-step.</p><p id="Par85">The Crank–Nicolson method described above applies to a one-dimensional case; the application to 2 or 3 spatial and one momentum dimension requires a generalization. A straightforward expansion to more dimensions implies solving large matrix equations (no longer tridiagonal); instead the so-called ADI (alternating direction implicit) method is used, in which the implicit solution is applied to each dimension in turn. Each application uses just the operator for that dimension, so the tridiagonal scheme can still be used. This however is not completely valid since it solves a slightly different problem from that with the full operator; however for small enough timesteps the solution is accurate (see Section on Tests of GALPROP in the GALPROP Explanatory Supplement).</p><p id="Par86">The <italic>explicit</italic> method, where the full operator can be used in each timestep without any overhead for solving matrix equations, is also useful for obtaining an accurate solution at the end of a run. Although it is not unconditionally stable, this does not matter provided the timesteps are small enough, which is in any case required for the implicit methods to maximise their accuracy. A suitable mix of explicit and implicit methods to obtain an accurate solution with minimum computing requirements, is the goal.</p><p id="Par87">For 2D, three spatial boundary conditions<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {N}}(R,z_h,p) = {\mathcal {N}}(R,-z_h,p) = {\mathcal {N}}(R_h,z,p) = 0 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ29.gif"/></alternatives></disp-formula>may be imposed at each iteration. This is not physically expected, although it is a common conventional assumption. More physically plausible is free escape at the boundaries, which is not the same. For this, it is sufficient simply to not impose the above conditions in the updating scheme, since the <inline-formula id="IEq200"><alternatives><mml:math id="IEq200_Math"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq200_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \alpha _3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq200.gif"/></alternatives></inline-formula> coefficients do not act outside the boundaries, so there is no diffusive or convective flux inwards at the boundaries. The resulting solutions then have <inline-formula id="IEq201"><alternatives><mml:math id="IEq201_Math"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq201_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}&gt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq201.gif"/></alternatives></inline-formula> at the boundaries. In future more physical boundary conditions could be implemented, e.g. specifying the outward streaming velocity or the escape probability at the boundaries. No boundary conditions are imposed or required at <italic>R</italic> = 0 or in <italic>p</italic>. Grid intervals are typically <inline-formula id="IEq202"><alternatives><mml:math id="IEq202_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq202_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta R = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq202.gif"/></alternatives></inline-formula> kpc, <inline-formula id="IEq203"><alternatives><mml:math id="IEq203_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><tex-math id="IEq203_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta z = 0.1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq203.gif"/></alternatives></inline-formula> kpc; for <italic>p</italic> a logarithmic scale with ratio typically 1.2 is used. Although the model is symmetric around <inline-formula id="IEq204"><alternatives><mml:math id="IEq204_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq204_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq204.gif"/></alternatives></inline-formula> the solution is generated for <inline-formula id="IEq205"><alternatives><mml:math id="IEq205_Math"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq205_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-z_h&lt; z &lt; z_h$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq205.gif"/></alternatives></inline-formula> since this is required for the tridiagonal system to be valid.</p><p id="Par88">For 3D, the spatial boundary conditions<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {N}}(\pm x_h, y, z,p) = {\mathcal {N}}( x, \pm y_h, z,p) = {\mathcal {N}}( x, y,\pm z_h,p) = 0 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ30.gif"/></alternatives></disp-formula>may be imposed at each iteration, and free escape at the boundary is an option as for 2D. Again no boundary conditions are imposed in <italic>p</italic>. Grid intervals are typically <inline-formula id="IEq206"><alternatives><mml:math id="IEq206_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><tex-math id="IEq206_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta x= \varDelta y = 0.5$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq206.gif"/></alternatives></inline-formula> kpc, <inline-formula id="IEq207"><alternatives><mml:math id="IEq207_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><tex-math id="IEq207_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta z = 0.1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq207.gif"/></alternatives></inline-formula> kpc.</p><p id="Par89">Since we have a 3-dimensional (<italic>R</italic>, <italic>z</italic>, <italic>p</italic>) problem we use ‘operator splitting’ to handle the implicit solution, as follows. We apply the implicit updating scheme alternately for the operator in each dimension in turn, keeping the other two coordinates fixed. The source and fragmentation, decay terms are used in every step, so to account for the 3 substeps, <inline-formula id="IEq208"><alternatives><mml:math id="IEq208_Math"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq208_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${1\over 3} q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq208.gif"/></alternatives></inline-formula> and <inline-formula id="IEq209"><alternatives><mml:math id="IEq209_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:math><tex-math id="IEq209_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\over 3\tau $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq209.gif"/></alternatives></inline-formula> are used instead of <inline-formula id="IEq210"><alternatives><mml:math id="IEq210_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq210_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq210.gif"/></alternatives></inline-formula>, <inline-formula id="IEq211"><alternatives><mml:math id="IEq211_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math><tex-math id="IEq211_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/\tau $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq211.gif"/></alternatives></inline-formula> for the source term and the fragmentation, decay terms respectively. The coefficients for 3 spatial dimension are the same except that R is replaced by (x,y) and the finite differencing coefficients have the same form as for z, and <inline-formula id="IEq212"><alternatives><mml:math id="IEq212_Math"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq212_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${1\over 4} q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq212.gif"/></alternatives></inline-formula> and <inline-formula id="IEq213"><alternatives><mml:math id="IEq213_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:math><tex-math id="IEq213_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\over 4\tau $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq213.gif"/></alternatives></inline-formula> are used for the source term and the fragmentation, decay terms respectively, to account for the 4 substeps. With this scheme the solution can be done via the tridiagonal solution for each dimension in turn, as described in Press et al. (<xref ref-type="bibr" rid="CR186">1992</xref>). The spatial 3D scheme is simpler than the 2D one since the diffusion operator is easier to formulate (x,y,z have the same form), and in addition it does not have the problem of the boundary condition at R=0. In the case of anisotropic diffusion, <inline-formula id="IEq214"><alternatives><mml:math id="IEq214_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">zz</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq214_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{zz}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq214.gif"/></alternatives></inline-formula> is used in the <italic>z</italic>-direction.</p><p id="Par90">Finally all nuclei are normalized to the proton flux from the parameter file, using the relative abundances given as parameters. The value of <inline-formula id="IEq215"><alternatives><mml:math id="IEq215_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">kin</mml:mi></mml:msub></mml:math><tex-math id="IEq215_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\mathrm{kin}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq215.gif"/></alternatives></inline-formula> is taken as the reference value for the proton normalization. All results are output to FITS files for comparison with data and further analysis.</p></sec></sec><sec id="Sec19"><title>Other codes</title><p id="Par91">Following the success of the GALPROP approach described above, other projects with similar goals were started. Here we just mention these without details, which can be found in the papers. The DRAGON project (Gaggero et al. <xref ref-type="bibr" rid="CR68">2014</xref>) and references therein which extends the CR propagation to anisotropic and spatially-dependent diffusion. DRAGON is also publicly available.<xref ref-type="fn" rid="Fn2">2</xref> A more physical approach to diffusion with turbulence incorporated in DRAGON is given in Evoli and Yan (<xref ref-type="bibr" rid="CR57">2014</xref>).</p><p id="Par93">USINE is a semi-analytical CR-propagation package, which has the advantage of speed for model parameter explorations, and which has been the basis of many recent investigations. USINE is publicly available<xref ref-type="fn" rid="Fn3">3</xref> as described by Maurin (<xref ref-type="bibr" rid="CR150">2020</xref>). It has been used for many years already (Putze et al. <xref ref-type="bibr" rid="CR193">2011</xref>) and references therein. It has recently been used to study secondary antiprotons (Boudaud et al. <xref ref-type="bibr" rid="CR25">2020</xref>) and the size of the Galactic CR halo (Weinrich et al. <xref ref-type="bibr" rid="CR268">2020</xref>).</p><p id="Par95">The numerical packages mentioned have limitations in terms of both accuracy and speed, and hence the spatial resolution achievable. Hence their use has mainly been restricted to 2D models with cylindrical symmetry. A new approach is implemented in the PICARD model (Werner et al. <xref ref-type="bibr" rid="CR269">2013</xref>; Kissmann <xref ref-type="bibr" rid="CR127">2014</xref>), which is fully 3D in concept and has state-of-the art numerical techniques. This makes it possible to handle models with spiral structure at good (e.g. 10 pc) resolution with reasonable computer resources.</p></sec></sec><sec id="Sec20"><title>Self-consistent models</title><sec id="Sec21"><title>The system of equations</title><p id="Par96">To reduce the physical and computational complexity of the CR propagation problem numerous authors neglected the explicit consideration of the streaming process by eliminating the Alfvén wave-related component from the CR propagation speed <inline-formula id="IEq216"><alternatives><mml:math id="IEq216_Math"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><tex-math id="IEq216_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{u}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq216.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) and by defining the spatial and momentum diffusion coefficients as free parameters of the model. In phenomenological models the values of diffusion coefficient are deduced from secondary to primary CR abundances taken from observational data. Depending on particular needs Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) might be integrated directly or with the aid of its number density or energy density moments. The latter quantities enable construction of numerical solvers in a conservative manner, using finite volume methods both in spatial and in momentum dimensions. In the following considerations we neglect particle acceleration processes, therefore we assume <inline-formula id="IEq217"><alternatives><mml:math id="IEq217_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq217_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp} = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq217.gif"/></alternatives></inline-formula>. We also omit particle acceleration and radioactive decay.</p><sec id="Sec22"><title>CR number density</title><p id="Par97">The number density of CR particles in an arbitrarily chosen range <inline-formula id="IEq218"><alternatives><mml:math id="IEq218_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq218_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[p_{\mathrm{L}}, p_{\mathrm{R}}]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq218.gif"/></alternatives></inline-formula> in momentum space is defined as<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {n_{\text {cr}}^{{\mathrm {LR}}}}({\varvec{x}},t) \equiv \int _{p_{\mathrm{L}}}^{p_{\mathrm{R}}} 4\pi p^2 f({\varvec{x}},p,t) dp. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ31.gif"/></alternatives></disp-formula>We multiply Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) by <inline-formula id="IEq219"><alternatives><mml:math id="IEq219_Math"><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq219_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\pi p^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq219.gif"/></alternatives></inline-formula> and integrate over <italic>p</italic> to get the evolution equation for the particle number density<disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msubsup><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mfenced><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">LR</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {{n_{\text {cr}}^{{\mathrm {LR}}}}}}{{\partial } {t}^{}}&amp;= - \nabla \cdot ({\varvec{u}} {n_{\text {cr}}^{{\mathrm {LR}}}}) + \nabla \left( \langle {{\mathbf {\mathsf{{D}}}}}_n \rangle \nabla {n_{\text {cr}}^{{\mathrm {LR}}}}\right) \nonumber \\&amp;\quad + \left[ \left( \frac{1}{3} (\nabla \cdot {\varvec{u}} ) p + b_l \right) 4\pi p^2 f\right] _{p_{\mathrm{L}}}^{p_{\mathrm{R}}} +Q^{\mathrm {LR}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ32.gif"/></alternatives></disp-formula>where <inline-formula id="IEq220"><alternatives><mml:math id="IEq220_Math"><mml:msup><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">LR</mml:mi></mml:msup></mml:math><tex-math id="IEq220_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q^{\mathrm {LR}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq220.gif"/></alternatives></inline-formula> is the spatial density of CR sources and <inline-formula id="IEq221"><alternatives><mml:math id="IEq221_Math"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math><tex-math id="IEq221_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\langle {{\mathbf {\mathsf{{D}}}}}_n\rangle $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq221.gif"/></alternatives></inline-formula> is the momentum-averaged spatial diffusion tensor of the particle number density (see also Sect. <xref rid="Sec34" ref-type="sec">4.6</xref>). In the limit of <inline-formula id="IEq222"><alternatives><mml:math id="IEq222_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq222_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\mathrm{L}} = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq222.gif"/></alternatives></inline-formula> and <inline-formula id="IEq223"><alternatives><mml:math id="IEq223_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><tex-math id="IEq223_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\mathrm{R}}=\infty $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq223.gif"/></alternatives></inline-formula> we get the conventional form of the diffusion-advection equation for CR particle number density<disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>n</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>Q</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {{n_{\text {cr}}}}}{{\partial } {t}^{}} = - \nabla \cdot ({\varvec{u}} {n_{\text {cr}}}) + \nabla \left( \langle {{\mathbf {\mathsf{{D}}}}}^n \rangle \nabla {n_{\text {cr}}}\right) +Q. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ33.gif"/></alternatives></disp-formula></p></sec><sec id="Sec23"><title>CR energy density</title><p id="Par98">The CR energy density in a section <inline-formula id="IEq224"><alternatives><mml:math id="IEq224_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq224_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({p_{\mathrm{L}}},{p_{\mathrm{R}}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq224.gif"/></alternatives></inline-formula> of the momentum axis is defined as<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {e_{\text {cr}}^{{\mathrm {LR}}}}({\varvec{x}},t) \equiv \int _{p_{\mathrm{L}}}^{p_{\mathrm{R}}} 4\pi p^2 T(p) f({\varvec{x}},p,t) dp. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ34.gif"/></alternatives></disp-formula>Again, we integrate Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) multiplied by <inline-formula id="IEq225"><alternatives><mml:math id="IEq225_Math"><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq225_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\pi p^2 T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq225.gif"/></alternatives></inline-formula> over <italic>p</italic>, where <inline-formula id="IEq226"><alternatives><mml:math id="IEq226_Math"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≡</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq226_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T\equiv \sqrt{p^2 c^2 + m^2 c^4} - m c^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq226.gif"/></alternatives></inline-formula> is kinetic energy and <italic>m</italic> is the rest-mass of CR protons, electrons or other particles. The resulting equation for the CR energy density reads<disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mfenced><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">cp</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi mathvariant="normal">LR</mml:mi></mml:msup><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {{e_{\text {cr}}^{{\mathrm {LR}}}}}}{{\partial } {t}^{}}= &amp; {} - \nabla \cdot ({\varvec{u}} {e_{\text {cr}}^{{\mathrm {LR}}}}) + \nabla \left( \langle D^e_{xx} \rangle \nabla {e_{\text {cr}}^{{\mathrm {LR}}}}\right) + \left[ \left( \frac{1}{3} (\nabla \cdot {\varvec{u}} ) p + b_l \right) 4\pi p^2 fT\right] _{p_\mathrm {L}}^{p_{\mathrm{R}}} \nonumber \\&amp;- \int _{p_\mathrm {L}}^{p_{\mathrm{R}}} \left( \frac{1}{3} (\nabla \cdot {\varvec{u}} ) p + b_l\right) 4\pi p^2 f\frac{c p }{\sqrt{p^2+m^2 c^2}} dp +S^{\mathrm {LR}} \ . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ35.gif"/></alternatives></disp-formula>where <inline-formula id="IEq227"><alternatives><mml:math id="IEq227_Math"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math><tex-math id="IEq227_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\langle {{\mathbf {\mathsf{{D}}}}}_e\rangle $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq227.gif"/></alternatives></inline-formula> denotes the momentum averaged diffusion coefficient (see Sect. <xref rid="Sec34" ref-type="sec">4.6</xref>) of the CR energy and <inline-formula id="IEq228"><alternatives><mml:math id="IEq228_Math"><mml:msup><mml:mi>S</mml:mi><mml:mi mathvariant="normal">LR</mml:mi></mml:msup></mml:math><tex-math id="IEq228_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^{\mathrm {LR}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq228.gif"/></alternatives></inline-formula> sources of CR energy. The CR pressure contribution from particles in the momentum range <inline-formula id="IEq229"><alternatives><mml:math id="IEq229_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq229_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ [{p_\mathrm {L}},{p_{\mathrm{R}}}]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq229.gif"/></alternatives></inline-formula> is<disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow><mml:mi mathvariant="normal">LR</mml:mi></mml:msubsup><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>v</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{cr}^{\mathrm {LR}} \equiv \frac{4\pi }{3} \int _{p_\mathrm {L}}^{p_{\mathrm{R}}} p^3 vf dp \ . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ36.gif"/></alternatives></disp-formula>In the limit of <inline-formula id="IEq230"><alternatives><mml:math id="IEq230_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq230_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_\mathrm {L} = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq230.gif"/></alternatives></inline-formula>, <inline-formula id="IEq231"><alternatives><mml:math id="IEq231_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><tex-math id="IEq231_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\mathrm{R}}=\infty $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq231.gif"/></alternatives></inline-formula> and <inline-formula id="IEq232"><alternatives><mml:math id="IEq232_Math"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq232_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_l=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq232.gif"/></alternatives></inline-formula> we get the conventional form (see e.g. Schlickeiser and Lerche <xref ref-type="bibr" rid="CR212">1985</xref>) of the momentum-integrated diffusion-advection equation for the CR particle energy density<disp-formula id="Equ37"><label>37</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {{e_{\text {cr}}}}}{{\partial } {t}^{}} = - \nabla \cdot ({\varvec{u}} {e_{\text {cr}}}) + \nabla \left( \langle {{\mathbf {\mathsf{{D}}}}}_e \rangle \nabla {e_{\text {cr}}}\right) - P_{cr} (\nabla \cdot {\varvec{u}} ) +S \ , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ37.gif"/></alternatives></disp-formula>together with an adiabatic equation of state relating the momentum integrated CR pressure to CR energy density <inline-formula id="IEq233"><alternatives><mml:math id="IEq233_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq233_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{cr} = (\gamma _{cr} -1) {e_{\text {cr}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq233.gif"/></alternatives></inline-formula> with adiabatic index equal to 4/3 for a relativistic gas or its value is in the range [4/3, 5/3] if the trans-relativistic population of CR particles is significant.</p></sec></sec><sec id="Sec24"><title>Two-fluid diffusion-advection models</title><p id="Par99">The development of self-consistent methods for the CR transport equation started with theoretical work by Drury and Voelk (<xref ref-type="bibr" rid="CR49">1981</xref>), Axford et al. (<xref ref-type="bibr" rid="CR7">1982</xref>) who integrated the kinetic equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) in momentum space to get a single equation for the total CR pressure. They supplemented the resulting equation to the set of fluid equations for the conventional gas. The two components, thermal gas and the population of the nonthermal CR particles were coupled by the CR pressure term. The resulting two-fluid system was applied in analytical studies of hydrodynamic shock structure in the presence of CRs. These preliminary studies have shown that even for moderately strong shock waves most of the upstream energy flux in the background plasma is transferred to cosmic rays, and thus demonstrated the importance of the CR induced dynamical effects in the system composed of CRs and thermal plasma. Schlickeiser and Lerche (<xref ref-type="bibr" rid="CR212">1985</xref>) used the two-fluid system of equations for studies of the dynamics of interstellar gas in galactic disks.</p><p id="Par100">Drury and Falle (<xref ref-type="bibr" rid="CR48">1986</xref>) presented a first numerical algorithm to model the propagation of CRs together with thermal gas in 1-D. The algorithm, based on the solution of an appropriate Riemann problem (see Sect. <xref rid="Sec26" ref-type="sec">4.3.1</xref>) has been used to study the stability of CR-modified shocks.</p><p id="Par101">Kang and Jones (<xref ref-type="bibr" rid="CR121">1990</xref>) extended the two-fluid model of diffusive shock acceleration by inclusion of an in-situ CR injection at steady state shocks. In a companion paper Jones and Kang (<xref ref-type="bibr" rid="CR113">1990</xref>) presented the results of time-dependent numerical simulations of CR-mediated shocks based on the two-fluid model. By means of the piecewise parabolic method (PPM) Colella and Woodward (<xref ref-type="bibr" rid="CR37">1984</xref>) modelled the evolution of plane parallel, piston-driven shocks and spherical adiabatic blast waves. They investigated shocks that sweep up ambient cosmic rays as well as those that inject the cosmic rays directly. Jones and Kang (<xref ref-type="bibr" rid="CR114">1993</xref>) developed a time-dependent two fluid model of CR acceleration during the impact of shocks on dense two-dimensional clouds.</p><p id="Par102">Diffusive shock acceleration of relativistic protons and their dynamical feedback on the background flow was included in the two-fluid model of Jones et al. (<xref ref-type="bibr" rid="CR116">1994</xref>) who simulated the dynamical evolution of cosmic gas clouds moving supersonically through a uniform low-density medium. In their simulations more than 10% of the initial kinetic energy of the flow was converted into a combination of thermal and CR energy. The fraction of energy going to CRs exceeded in some cases the energy transfered to gas.</p><p id="Par103">Frank et al. (<xref ref-type="bibr" rid="CR65">1994</xref>) carried out numerical simulations with a new conservative total variation diminishing (TVD) MHD scheme based on a Godunov-type method by Ryu and Jones (<xref ref-type="bibr" rid="CR203">1995</xref>), Ryu et al. (<xref ref-type="bibr" rid="CR204">1995</xref>). They treated CRs as a massless, diffusive fluid governed by a conservation equation for the CR energy derived from the momentum-dependent diffusion-advection equation (Skilling <xref ref-type="bibr" rid="CR229">1975a</xref>). The CR energy equation was solved using a second order monotonic advection and Crank–Nicolson scheme. The paper demonstrated first results of time-dependent two-fluid CR modified shock simulations in one spatial dimension.</p><p id="Par104">Frank et al. (<xref ref-type="bibr" rid="CR66">1995</xref>) performed dynamical simulations of oblique MHD cosmic-ray (CR)-modified plane shock evolution. They solved the system of two-fluid CR-MHD equations and also a more complete system consisting of MHD equations and the momentum dependent diffusion-advection equation. The authors compare the results of two-fluid and momentum-dependent diffusion-advection approaches.</p><p id="Par105">A comprehensive discussion of the strength and weakness of the two-fluid model was presented by Kang and Jones (<xref ref-type="bibr" rid="CR122">1997</xref>). They found a good agreement of the two-fluid model with the dynamical properties of the more detailed diffusion-advection results. They also found that the validity of the two-fluid formalism does not necessarily mean that steady state two-fluid models provide a reliable tool for predicting the efficiency of particle acceleration in real shocks.</p><p id="Par106">Hanasz and Lesch (<xref ref-type="bibr" rid="CR89">2003</xref>) presented a new numerical algorithm for two-fluid diffusion-advection propagation of CRs coupled dynamically with thermal plasma, with anisotropic, magnetic field-aligned diffusion. The algorithm was implemented into the MHD code ZEUS-3D (Stone and Norman <xref ref-type="bibr" rid="CR240">1992a</xref>, <xref ref-type="bibr" rid="CR241">b</xref>). The paper focussed on the development of a stable algorithm for anisotropic diffusion of CRs along magnetic field vectors defined on a staggered mesh. Details of the anisotropic diffusion algorithm are presented in Sect. <xref rid="Sec37" ref-type="sec">5.2</xref>. The CR propagation algorithm, involving an explicit diffusion algorithm coupled to the MHD system, has been demonstrated to be stable within the standard CFL time-step restriction <inline-formula id="IEq234"><alternatives><mml:math id="IEq234_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math><tex-math id="IEq234_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t \le 0.5 (\varDelta x)^2/D $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq234.gif"/></alternatives></inline-formula>, where <italic>D</italic> is the diffusion coefficient. The algorithm was applied in simulations of the Parker instability triggered by cosmic rays injected by a SN remnant and subsequently in numerical experiments of the CR-driven dynamo process (Hanasz et al. <xref ref-type="bibr" rid="CR90">2004</xref>, <xref ref-type="bibr" rid="CR93">2009b</xref>) and in numerical models of CR-driven winds (Hanasz et al. <xref ref-type="bibr" rid="CR94">2013</xref>).</p><p id="Par107">Snodin et al. (<xref ref-type="bibr" rid="CR234">2006</xref>) realized that the usual Fickian approach to the diffusion, which assumes that the flux of the diffusive quantity is proportional to its instantaneous gradient, leads to several problems. They noted that the anisotropic part of CR diffusion tensor becomes singular at magnetic X-points, leading to infinite CR propagation speeds, and consequently limits the timestep of an explicit time-stepping algorithm to zero. In order to ensure finite propagation speed they modified the equation for the diffusive flux to a non-Fickian form motivated by the turbulent transport of passive scalars (Blackman and Field <xref ref-type="bibr" rid="CR17">2003</xref>). The resulting equation for the diffusive quantity was reduced to the form of telegraph equation containing an extra second time-derivative, which acts as the displacement current in electrodynamics. The new term was included with an artificially reduced speed of light in order to reduce the propagation speed to numerically acceptable values.</p></sec><sec id="Sec25"><title>Dynamical CR MHD models</title><sec id="Sec26"><title>Riemann problem</title><p id="Par108">The aim of this section is to introduce the Riemann problem as well as the principle of the Godunov method to clarify the terms we use in subsequent sections. The basis for the dynamical CR models are the fluid equations for the thermal gas, which can be expressed in <italic>primitive</italic> (<inline-formula id="IEq235"><alternatives><mml:math id="IEq235_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq235_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq235.gif"/></alternatives></inline-formula>, <italic>u</italic>, <italic>P</italic>) or <italic>conserved</italic> quantities (<inline-formula id="IEq236"><alternatives><mml:math id="IEq236_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq236_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq236.gif"/></alternatives></inline-formula>, <inline-formula id="IEq237"><alternatives><mml:math id="IEq237_Math"><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:math><tex-math id="IEq237_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq237.gif"/></alternatives></inline-formula>, <inline-formula id="IEq238"><alternatives><mml:math id="IEq238_Math"><mml:mi>ϵ</mml:mi></mml:math><tex-math id="IEq238_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq238.gif"/></alternatives></inline-formula>). The differential equations of fluid dynamics in primitive form and one spatial dimension read<disp-formula id="Equ38"><label>38</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho _t+(\rho u)_x&amp;=0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ38.gif"/></alternatives></disp-formula><disp-formula id="Equ39"><label>39</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>ρ</mml:mi></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} u_t+uu_x+\frac{p_x}{\rho }&amp;=0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ39.gif"/></alternatives></disp-formula><disp-formula id="Equ40"><label>40</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mi>ρ</mml:mi></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon _t+u\epsilon _x+\frac{p}{\rho }u_x&amp;=0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ40.gif"/></alternatives></disp-formula>where we use the short notation <inline-formula id="IEq239"><alternatives><mml:math id="IEq239_Math"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mi>∂</mml:mi><mml:mi>q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq239_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_t\equiv \partial q/\partial t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq239.gif"/></alternatives></inline-formula>. The three equations describe the conservation of mass, momentum and total energy. We define <inline-formula id="IEq240"><alternatives><mml:math id="IEq240_Math"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">tot</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq240_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\rm tot}=\rho (\frac{1}{2}u^2+\epsilon )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq240.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq241"><alternatives><mml:math id="IEq241_Math"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq241_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon =\frac{p}{(\gamma -1)\rho }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq241.gif"/></alternatives></inline-formula> and <inline-formula id="IEq242"><alternatives><mml:math id="IEq242_Math"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq242_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma =\frac{C_p}{C_v}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq242.gif"/></alternatives></inline-formula>. The equivalent set of HD equations in conservative form is<disp-formula id="Equ41"><label>41</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;U_t+F(U)_x=0 . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ41.gif"/></alternatives></disp-formula><disp-formula id="Equ42"><label>42</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>ρ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">tot</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>f</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>ρ</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">tot</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;U=\left[ \begin{array}{c} u_1\\ u_2\\ u_3 \end{array}\right] \equiv \left[ \begin{array}{c} \rho \\ \rho u\\ e_{tot} \end{array}\right] ,\ \ F=\left[ \begin{array}{c} f_1\\ f_2\\ f_3 \end{array}\right] \equiv \left[ \begin{array}{c} \rho u\\ \rho u^2+p\\ u(e_{tot}+p) \end{array}\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ42.gif"/></alternatives></disp-formula>where <italic>U</italic> is the vector of conservative quantities, <italic>F</italic> is the vector of corresponding fluxes. The equations of hydrodynamics are hyperbolic partial differential equations (see, e.g. LeVeque <xref ref-type="bibr" rid="CR143">2002</xref>; Toro <xref ref-type="bibr" rid="CR253">2009</xref>; Balsara <xref ref-type="bibr" rid="CR1000">2017</xref>), whose time dependent solutions are given by the so-called charateristics. The characteristic curves are lines in space-lime along which <italic>U</italic> stays constant. Their slope is given by eigenvalues of the Jacobian <inline-formula id="IEq243"><alternatives><mml:math id="IEq243_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>∂</mml:mi></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq243_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\partial F_i / \partial x_j |$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq243.gif"/></alternatives></inline-formula>. For the advection equation of quantity <italic>q</italic> with constant velocity <italic>u</italic> in one dimension,<disp-formula id="Equ43"><label>43</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial q}{\partial t} + u_0 \frac{\partial q}{\partial x} = 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ43.gif"/></alternatives></disp-formula>the characteristcs are linear functions that simply translate the quantity <italic>q</italic>. More generally we find solutions by geometrical translation of the initial state to a given point along characteristic lines. In the full set of equations we find that besides advection the system is influenced by the pressure in the gas and the corresponding sound waves <inline-formula id="IEq244"><alternatives><mml:math id="IEq244_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math><tex-math id="IEq244_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_0 = \sqrt{\gamma P_{0} / \rho _{0}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq244.gif"/></alternatives></inline-formula>. The system yields three different characteristcs,<disp-formula id="Equ44"><label>44</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{-1}&amp;=u_{0}-\sqrt{\gamma P_{0} / \rho _{0}} = u_{0}-c_{0} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ44.gif"/></alternatives></disp-formula><disp-formula id="Equ45"><label>45</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{0}&amp;=u_{0} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ45.gif"/></alternatives></disp-formula><disp-formula id="Equ46"><label>46</label><alternatives><mml:math display="block" id="Equ46_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{+1}&amp;=u_{0}+\sqrt{\gamma P_{0} / \rho _{0}} = u_{0}+c_{0} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ46.gif"/></alternatives></disp-formula>which are the ones for advection (<inline-formula id="IEq245"><alternatives><mml:math id="IEq245_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq245_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq245.gif"/></alternatives></inline-formula>), the advected fluid and a left-going sound wave (<inline-formula id="IEq246"><alternatives><mml:math id="IEq246_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq246_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq246.gif"/></alternatives></inline-formula>) as well as the advection and a right-going sound wave (<inline-formula id="IEq247"><alternatives><mml:math id="IEq247_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq247_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq247.gif"/></alternatives></inline-formula>). The characteristics of this problem are illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Visualisation of the characteristics of the sound waves. The left side shows the subsonic case the right side the supersonic case</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig2_HTML.png" id="MO48"/></fig></p><p id="Par109">In numerical setups we discretize the domain into cells <italic>i</italic> and use the discretized form of conservation laws. Integration over a control volume—a finite section of space and time—leads to the evolution equation (Godunov method)<disp-formula id="Equ47"><label>47</label><alternatives><mml:math display="block" id="Equ47_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} U_i^{n+1}=U_i^n+\frac{\varDelta t}{\varDelta x}\left[ F_{i-\frac{1}{2}}-F_{i+\frac{1}{2}}\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ47.gif"/></alternatives></disp-formula>where <inline-formula id="IEq248"><alternatives><mml:math id="IEq248_Math"><mml:msubsup><mml:mi>U</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math><tex-math id="IEq248_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_i^n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq248.gif"/></alternatives></inline-formula> are averaged conservative quantities over the cell volume and <inline-formula id="IEq249"><alternatives><mml:math id="IEq249_Math"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq249_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{i\pm \frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq249.gif"/></alternatives></inline-formula> are the fluxes between cells averaged over the timestep.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Shock tube solution at late time. One can clearly distringush between the unperturbed states at the very left and right, the rarafaction wave, the contact discontinuity and the shock front. Image reproduced with permission from LeVeque (<xref ref-type="bibr" rid="CR143">2002</xref>), copyright by CUP</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig3_HTML.png" id="MO50"/></fig></p><p id="Par110">The <italic>Riemann problem</italic> describes an initial value problem using a discontinuous initial state <italic>S</italic> with piecewise constant values on either side of the interface <inline-formula id="IEq250"><alternatives><mml:math id="IEq250_Math"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq250_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq250.gif"/></alternatives></inline-formula><disp-formula id="Equ48"><label>48</label><alternatives><mml:math display="block" id="Equ48_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S = {\left\{ \begin{array}{ll} S_\mathrm {1} &amp;{} x\le x_0 \\ S_\mathrm {2} &amp;{} x&gt;x_0, \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ48.gif"/></alternatives></disp-formula>The time evolution is described by three types of wave structures, namely <italic>shocks</italic>, <italic>rarefaction waves</italic> and <italic>contact discontinuities</italic>. The solutions can be found by solving the so-called Rankine–Hugoniot jump conditions which represent conservation laws across discontinuities<disp-formula id="Equ49"><label>49</label><alternatives><mml:math display="block" id="Equ49_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>ρ</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {[\rho v]}&amp;=0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ49.gif"/></alternatives></disp-formula><disp-formula id="Equ50"><label>50</label><alternatives><mml:math display="block" id="Equ50_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfenced close="]" open="["><mml:mi>ρ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>P</mml:mi></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\left[ \rho v^{2}+P\right] }&amp;=0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ50.gif"/></alternatives></disp-formula><disp-formula id="Equ51"><label>51</label><alternatives><mml:math display="block" id="Equ51_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:mi>ρ</mml:mi></mml:mfrac></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ \frac{1}{2} v^{2}+\epsilon +\frac{P}{\rho } \right]&amp;= 0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ51.gif"/></alternatives></disp-formula>which is explicitly written as<disp-formula id="Equ52"><label>52</label><alternatives><mml:math display="block" id="Equ52_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho _1 v_1&amp;= \rho _2 v_2 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ52.gif"/></alternatives></disp-formula><disp-formula id="Equ53"><label>53</label><alternatives><mml:math display="block" id="Equ53_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho _1 v_1^{2}+P_1&amp;=\rho _2 v_2^{2}+P_2 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ53.gif"/></alternatives></disp-formula><disp-formula id="Equ54"><label>54</label><alternatives><mml:math display="block" id="Equ54_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{1}{2} v_1^{2}+\epsilon _1+\frac{P_1}{\rho _1}&amp;= \frac{1}{2} v_2^{2}+\epsilon _2+\frac{P_2}{\rho _2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ54.gif"/></alternatives></disp-formula>Using the Mach number<disp-formula id="Equ55"><label>55</label><alternatives><mml:math display="block" id="Equ55_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {M}}_{1} \equiv \frac{v_{1}}{c_{1}}=\sqrt{\frac{\rho _{1} v_{1}^{2}}{\gamma P_{1}}}=\sqrt{\frac{{\bar{m}} v_{1}^{2}}{\gamma k_{\mathrm {B}} T_{1}}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ55.gif"/></alternatives></disp-formula>we can write the ratios of densities, pressures and temperatures as follows<disp-formula id="Equ56"><label>56</label><alternatives><mml:math display="block" id="Equ56_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mover><mml:mo stretchy="false">⟶</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mover><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\rho _{2}}{\rho _{1}}&amp;=\frac{v_{1}}{v_{2}}=\frac{(\gamma +1) {\mathcal {M}}_{1}^{2}}{(\gamma -1) {\mathcal {M}}_{1}^{2}+2}&amp;{\mathop {\longrightarrow }\limits ^{\gamma =1}} {\mathcal {M}}_{1}^{2} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ56.gif"/></alternatives></disp-formula><disp-formula id="Equ57"><label>57</label><alternatives><mml:math display="block" id="Equ57_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mover><mml:mo stretchy="false">⟶</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mover><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{P_{2}}{P_{1}}&amp;=\frac{\rho _{2} k_{\mathrm {B}} T_{2}}{\rho _{1} k_{\mathrm {B}} T_{1}}=\frac{2 \gamma {\mathcal {M}}_{1}^{2}-(\gamma -1)}{\gamma +1}&amp;{\mathop {\longrightarrow }\limits ^{\gamma =1}} {\mathcal {M}}_{1}^{2} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ57.gif"/></alternatives></disp-formula><disp-formula id="Equ58"><label>58</label><alternatives><mml:math display="block" id="Equ58_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mfenced><mml:mfenced close="]" open="["><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi mathvariant="script">M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mover><mml:mo stretchy="false">⟶</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mover><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{T_{2}}{T_{1}}&amp;=\frac{\left[ (\gamma -1) {\mathcal {M}}_{1}^{2}+2\right] \left[ 2 \gamma {\mathcal {M}}_{1}^{2}-(\gamma -1)\right] }{(\gamma +1)^{2} {\mathcal {M}}_{1}^{2}}&amp;{\mathop {\longrightarrow }\limits ^{\gamma =1}} 1 . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ58.gif"/></alternatives></disp-formula>Exact solutions can be found with some help of numerical root finding. In numerical practice it is computationally less expensive to compute approximate solutions which do not rely on root finding routines, but instead rely on purely algebraical methods, using explicitely Rankine–Hugoniot conditions (HLL). A particularly important setup is the Sod shock tube (Sod <xref ref-type="bibr" rid="CR236">1978</xref>) with the initial conditions<disp-formula id="Equ59"><label>59</label><alternatives><mml:math display="block" id="Equ59_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1.0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>1.0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0.0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.125</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0.0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} \rho _\mathrm {1} \\ P_\mathrm {1} \\ v_\mathrm {1} \end{array}\right) =\left( \begin{array}{c} 1.0 \\ 1.0 \\ 0.0 \end{array}\right) ,\left( \begin{array}{c} \rho _\mathrm {2} \\ P_\mathrm {2} \\ v_\mathrm {2} \end{array}\right) =\left( \begin{array}{c} 0.125 \\ 0.1 \\ 0.0 \end{array}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ59.gif"/></alternatives></disp-formula>The most prominent example is a shock tube, with four important interfaces, which are illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. From left to right we highlight the head and the tail of the rarefaction wave, the contact discontinuity as well as the shock front moving to the right.</p><p id="Par111">The system described so far does not include magnetic fields, which extend the set of characteristics by magnetic waves. Despite the importance of the magnetic field for CRs in general we refrain from deriving the additional equations here. This setup is for one simple thermal fluid. CRs can be included in three different manners into this setup. The first and most simple inclusion is simply the advection of the CR fluid with the gas velocity. The second possibility includes the CR pressure into the jump condition and accounts for the possibility of two different adiabatic indices for the different fluids as described in Pfrommer et al. (<xref ref-type="bibr" rid="CR180">2006</xref>). The third possibility does not just include CRs as an existing fluid, but includes the acceleration of CRs in a phenomenological way. A fraction of the dissipated energy at the shock is converted to CRs and treated as a source term in the shocked region. This approach is described in Pfrommer et al. (<xref ref-type="bibr" rid="CR182">2017</xref>).</p></sec><sec id="Sec27"><title>Extensions of the Riemann problem including CRs</title><p id="Par112">To address the question of dynamical importance of shock-injected CRs during the structure formation in the <inline-formula id="IEq251"><alternatives><mml:math id="IEq251_Math"><mml:mi>Λ</mml:mi></mml:math><tex-math id="IEq251_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varLambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq251.gif"/></alternatives></inline-formula>CDM universe (Pfrommer et al. <xref ref-type="bibr" rid="CR180">2006</xref>) derived a complete analytic solution of the Riemann shock-tube problem (Sod <xref ref-type="bibr" rid="CR236">1978</xref>) for the medium composed of thermal gas and relativistic CR component in two-fluid approximation. They applied their solution in smooth particle hydrodynamics (SPH) cosmological simulations designed for studies of CR energy injection at cosmological shocks.</p><p id="Par113">Miniati (<xref ref-type="bibr" rid="CR156">2007</xref>) added the number density moment of the CR propagation equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) to the system of HD equations and performed characteristics analysis of the system of quasilinear equations describing the dynamical evolution of thermal gas combined with a spectral evolution of a CR population. The study focussed on the hydrodynamical part of the momentum-dependent algorithm (see Sect. <xref rid="Sec30" ref-type="sec">4.5</xref> for details) for the evolution of CRs, introduced in the COSMOCR code (Miniati <xref ref-type="bibr" rid="CR155">2001</xref>). The CR population was approximated with a piecewise power-law distribution function. A set of conservation laws for the number density of CR particles in individual spectral bins, treated as passive scalars, has been supplemented to the system of conservation laws for thermal gas density, momentum and total (gas plus CR) energy density. The exchange of energy between the thermal fluid and the CR components is modeled with flux conserving methods both in configuration and in momentum space. The proposed numerical method is based on a combination of Glimm’s method (Glimm <xref ref-type="bibr" rid="CR83">1965</xref>) preserving the discontinuous character of shocks and a higher order Godunov method (Toro <xref ref-type="bibr" rid="CR253">2009</xref>) in the smooth flows.</p><p id="Par114">Kudoh and Hanawa (<xref ref-type="bibr" rid="CR134">2016</xref>) analyzed the CR-MHD equations and proposed a fully conservative approach to the system of equations consisting of the set of MHD equations and the equation describing the number density of CR particles in a two-fluid approach. They proposed a numerical scheme providing solutions that satisfy the Rankine–Hugoniot conditions. By using the CR concentration normalized to the thermal gas density <inline-formula id="IEq252"><alternatives><mml:math id="IEq252_Math"><mml:mrow><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math><tex-math id="IEq252_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi = \rho _{\text {c}r}/\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq252.gif"/></alternatives></inline-formula> they have shown that their conditions are equivalent to those obtained by Pfrommer et al. (<xref ref-type="bibr" rid="CR180">2006</xref>). They derived the corresponding Roe-type MHD solver (Roe <xref ref-type="bibr" rid="CR199">1981</xref>) for the full system of MHD equations (with the total energy including the energy of thermal gas, cosmic rays and magnetic fields) supplemented with the evolution equation for the CR concentration. They found that solutions obtained for different forms for the CR energy equations, with source terms <inline-formula id="IEq253"><alternatives><mml:math id="IEq253_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq253_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{v}} \cdot \varvec{\nabla }p_{\mathrm cr} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq253.gif"/></alternatives></inline-formula> (Kuwabara et al. <xref ref-type="bibr" rid="CR140">2004</xref>) or <inline-formula id="IEq254"><alternatives><mml:math id="IEq254_Math"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq254_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-P_{\text {c}r} \varvec{\nabla } \cdot \varvec{v}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq254.gif"/></alternatives></inline-formula> (Hanasz and Lesch <xref ref-type="bibr" rid="CR89">2003</xref>; Yang et al. <xref ref-type="bibr" rid="CR280">2012</xref>; Dubois and Commerçon <xref ref-type="bibr" rid="CR50">2016</xref>), differ from the Riemann solution between the shock front and the contact discontinuity. They find that the Rankine–Hugoniot relation is seriously violated when the CR pressure dominates in the post-shocked gas.</p><p id="Par115">Gupta et al. (<xref ref-type="bibr" rid="CR87">2021</xref>) found that the standard CR two-fluid model described in terms of three conservation laws (expressing conservation of mass, momentum and total energy) and one additional equation (for the CR pressure) cannot be cast in a satisfactory conservative form. The presence of non-conservative terms with spatial derivatives in the model equations prevents a unique weak solution behind a shock. Nevertheless, all methods converge to a unique result if the energy partition between the thermal and non-thermal fluids at the shock is prescribed a priori. This highlights the closure problem of the two-fluid equations at shocks. They extended the analysis further and made a comprehensive comparison of different discretization strategies. They constructed a full classification of the available discretization options for the two-fluid cosmic-ray hydrodynamics by comparison of numerical aspects of the ’<inline-formula id="IEq255"><alternatives><mml:math id="IEq255_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:math><tex-math id="IEq255_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p{\mathrm{d}}v$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq255.gif"/></alternatives></inline-formula>’ and ’<inline-formula id="IEq256"><alternatives><mml:math id="IEq256_Math"><mml:mrow><mml:mi>v</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq256_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v{\mathrm{d}}p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq256.gif"/></alternatives></inline-formula>’ methods applied for different combinations of mathematically equivalent energy equations. They compared the cases of the gas energy equation with the CR energy equation, the total energy equation with the CR energy equation and total energy equation plus CR entropy equation in two variants including the operator split and unsplit method. After extensive numerical testing, they found that the numerical results are consistent for various reconstruction schemes only with the ’<inline-formula id="IEq257"><alternatives><mml:math id="IEq257_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:math><tex-math id="IEq257_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p{\mathrm{d}}v$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq257.gif"/></alternatives></inline-formula>’ method in a fully unsplit fashion with <italic>v</italic> and <inline-formula id="IEq258"><alternatives><mml:math id="IEq258_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq258_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq258.gif"/></alternatives></inline-formula> computed from the HLL Riemann solver values of momentum and density states.</p></sec><sec id="Sec28"><title>CR injection in SN shocks</title><p id="Par116">A separate issue is how to properly inject CRs in astrophysical shocks. The standard approach is to follow the assumption of Diffusive Shock Acceleration theory (DSA), relating the injection efficiency of CRs at shocks to the Mach number of the shock (Kang and Jones <xref ref-type="bibr" rid="CR123">2007</xref>). They find that the shock Mach number can be determined using Rankine–Hugoniot boundary conditions across shocked cells (Miniati et al. <xref ref-type="bibr" rid="CR157">2000</xref>; Ryu et al. <xref ref-type="bibr" rid="CR206">2003a</xref>; Skillman et al. <xref ref-type="bibr" rid="CR233">2008</xref>; Vazza et al. <xref ref-type="bibr" rid="CR260">2009</xref>). Vazza et al. (<xref ref-type="bibr" rid="CR261">2012a</xref>) implement an algorithm for CR energy injection in the ENZO code and apply an approach based on the differences of the gas and CR pressure between cells. Their algorithm selects candidate shocked cells by requiring that the flow in the cell is converging: <inline-formula id="IEq259"><alternatives><mml:math id="IEq259_Math"><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>v</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq259_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla v &lt; 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq259.gif"/></alternatives></inline-formula>. Then the 3D distribution of cells around the candidate cell is analyzed along the three axes, and it is checked that the gas temperature <italic>T</italic>, and the gas pseudo-entropy, <inline-formula id="IEq260"><alternatives><mml:math id="IEq260_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq260_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S = p \rho ^{-\gamma }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq260.gif"/></alternatives></inline-formula> change in the same direction, <inline-formula id="IEq261"><alternatives><mml:math id="IEq261_Math"><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>S</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>ρ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq261_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla S \cdot \nabla \rho &gt; 0 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq261.gif"/></alternatives></inline-formula> (Ryu et al. <xref ref-type="bibr" rid="CR206">2003a</xref>; Skillman et al. <xref ref-type="bibr" rid="CR233">2008</xref>; Vazza et al. <xref ref-type="bibr" rid="CR260">2009</xref>). The gradient of the temperature then sets the candidate post-shock and pre-shock cells. The Mach number is then evaluated from the information of the pressure jump between cells given by the Rankine–Hugoniot condition<disp-formula id="Equ60"><label>60</label><alternatives><mml:math display="block" id="Equ60_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{P_2}{P_1} = \frac{2 \gamma M^2 - \gamma +1}{\gamma +1} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ60.gif"/></alternatives></disp-formula>If the shock Mach number is known the energy flux of shock accelerated protons can be computed as<disp-formula id="Equ61"><label>61</label><alternatives><mml:math display="block" id="Equ61_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext>C</mml:mtext><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msubsup><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msup><mml:mi>M</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi _{{\text {C}R}} = \eta (M) \frac{\rho _u c_s^3M^3}{2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ61.gif"/></alternatives></disp-formula>where <inline-formula id="IEq262"><alternatives><mml:math id="IEq262_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math><tex-math id="IEq262_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq262.gif"/></alternatives></inline-formula> is the comoving upstream gas density and <inline-formula id="IEq263"><alternatives><mml:math id="IEq263_Math"><mml:mrow><mml:mi>η</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq263_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta (M)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq263.gif"/></alternatives></inline-formula> is a function of <italic>M</italic> (Kang and Jones <xref ref-type="bibr" rid="CR123">2007</xref>). The injected energy density of CRs within each cell results from integration of the CR energy flux over time step<disp-formula id="Equ62"><label>62</label><alternatives><mml:math display="block" id="Equ62_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>C</mml:mtext><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext>C</mml:mtext><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dx</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_{{\text {C}R}} = \frac{\phi _{{\text {C}R}}}{\rho } \frac{dt}{dx}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ62.gif"/></alternatives></disp-formula>where <inline-formula id="IEq264"><alternatives><mml:math id="IEq264_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq264_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq264.gif"/></alternatives></inline-formula> is gas density in the cell, <italic>dx</italic> is the cell size and <italic>dt</italic> is the timestep. The method has been further extended by inclusion of the effects of the upstream CR-to-thermal ratio by Kang and Ryu (<xref ref-type="bibr" rid="CR124">2013</xref>) and the magnetic obliquity by Pais et al. (<xref ref-type="bibr" rid="CR172">2018</xref>).</p><p id="Par117">Pfrommer et al. (<xref ref-type="bibr" rid="CR182">2017</xref>) presented new methods to integrate the CR evolution equations coupled to magneto-hydrodynamics on an unstructured moving mesh of the parallel AREPO code for cosmological simulations. They included an effective recipe for diffusive shock acceleration of CRs at resolved shocks based on Schaal and Springel (<xref ref-type="bibr" rid="CR210">2015</xref>) and at supernova remnants in the interstellar medium. CR losses are included in terms of Coulomb and hadronic interactions, with CR streaming neglected. The accuracy of their model was demonstrated using simulations of plane-parallel shock tubes that were compared to exact solutions of the Riemann shock tube problem for a composite of CRs and thermal gas with effective CR acceleration. Capabilities of the new algorithm have been verified in large scale cosmological simulations and in simulations of galaxy formation.</p></sec></sec><sec id="Sec29"><title>Unified Alfvén wave regulated CR transport</title><p id="Par118">One of the first attempts to incorporate the Alfvén wave regulated CR transport introduced in Sect. <xref rid="Sec9" ref-type="sec">1.5.1</xref> in numerical solutions of CR propagation was undertaken by Breitschwerdt et al. (<xref ref-type="bibr" rid="CR27">1991</xref>) in studies of galactic wind driving mechanisms. Their system of equations, following the analytical work by MacKenzie and Völk (<xref ref-type="bibr" rid="CR145">1982</xref>), included the set of stationary MHD equations extended with the CR propagation (energy balance) equation and with a separate equation for the energy density of the fluctuating field of Alfvén waves propagating down the CR pressure gradient. A further extension of the model by Dorfi and Breitschwerdt (<xref ref-type="bibr" rid="CR47">2012</xref>) discussed time dependent non-stationary solutions of galactic winds.</p><p id="Par119">Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>) incorporated CR energy in the form derived by MacKenzie and Völk (<xref ref-type="bibr" rid="CR145">1982</xref>)<disp-formula id="Equ63"><label>63</label><alternatives><mml:math display="block" id="Equ63_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mfenced><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {P_\mathrm {cr}}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot ({\varvec{v}} P_\mathrm {cr}) + {\varvec{\nabla }} \cdot \left( \frac{4}{3} P_\mathrm {cr} {\varvec{v_{s}}} \right) = -P_\mathrm {cr} \frac{{\varvec{\nabla }}\cdot {\varvec{v}}}{3} - \frac{\left| {\varvec{v}}_s \cdot \nabla P_\mathrm {cr} \right| }{3}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ63.gif"/></alternatives></disp-formula>where <inline-formula id="IEq265"><alternatives><mml:math id="IEq265_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq265_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_\mathrm {cr} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq265.gif"/></alternatives></inline-formula> is the cosmic ray pressure, <inline-formula id="IEq266"><alternatives><mml:math id="IEq266_Math"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:math><tex-math id="IEq266_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq266.gif"/></alternatives></inline-formula> is the plasma velocity and<disp-formula id="Equ64"><label>64</label><alternatives><mml:math display="block" id="Equ64_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{v}}_{s} = - {\varvec{v}}_a \ \frac{ {\varvec{b}} \cdot \nabla P_\mathrm {cr}}{|{{\varvec{b}}}\cdot \nabla {P_{\text {cr}}}|} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ64.gif"/></alternatives></disp-formula>is the streaming velocity with <inline-formula id="IEq267"><alternatives><mml:math id="IEq267_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq267_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{v}}_a = \frac{ {\varvec{B}}}{\sqrt{4\pi \rho }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq267.gif"/></alternatives></inline-formula> representing Alfvén velocity directed down the CR pressure gradient and <inline-formula id="IEq268"><alternatives><mml:math id="IEq268_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><tex-math id="IEq268_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{b}}} = {{\varvec{B}}}/ | {{\varvec{B}}} |$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq268.gif"/></alternatives></inline-formula> is the magnetic unit vector. Equation (<xref rid="Equ63" ref-type="disp-formula">63</xref>) describes the streaming of CR gas along the magnetic field direction down the gradient of its pressure.</p><p id="Par120">Equation (<xref rid="Equ63" ref-type="disp-formula">63</xref>) is challenging for numerical algorithms because the standard upwind time-evolution algorithms with a CFL-limited time-step result in spurious oscillations at the grid scale. These oscillations arise due to unphysically large flux gradients near the minima and maxima and propagate through the computational domain.  Using a hydro-based CFL (<inline-formula id="IEq269"><alternatives><mml:math id="IEq269_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq269_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t=C \varDelta x/v_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq269.gif"/></alternatives></inline-formula>) leads to spurious oscillations which originate from the local extrema even for a smooth initial condition. Monotonicity can be achieved at high computational price for an upwind update by setting the timestep <inline-formula id="IEq270"><alternatives><mml:math id="IEq270_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>∝</mml:mo><mml:mi>Δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq270_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t \propto \varDelta x^3 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq270.gif"/></alternatives></inline-formula>.  Numerical solutions of Eq. (<xref rid="Equ63" ref-type="disp-formula">63</xref>) are unstable even with implicit methods and regularization of the equation by an additional smoothing term, resembling incorporation of explicit viscosity in Euler’s equations is necessary.</p><p id="Par124">Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>) proposed to replace the discontinuous streaming velocity in Eq. (<xref rid="Equ63" ref-type="disp-formula">63</xref>) by its smooth approximation <inline-formula id="IEq271"><alternatives><mml:math id="IEq271_Math"><mml:mrow><mml:mo>tanh</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq271_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tanh (v_s/\epsilon )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq271.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq272"><alternatives><mml:math id="IEq272_Math"><mml:mi>ϵ</mml:mi></mml:math><tex-math id="IEq272_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq272.gif"/></alternatives></inline-formula> is a small parameter. This operation introduces an additional diffusive term to the CR propagation equation with the diffusion coefficient <inline-formula id="IEq273"><alternatives><mml:math id="IEq273_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><tex-math id="IEq273_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_s/\epsilon $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq273.gif"/></alternatives></inline-formula> and numerical stability is achieved for the timestep limitation given by<disp-formula id="Equ65"><label>65</label><alternatives><mml:math display="block" id="Equ65_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta t \le \frac{\varDelta x^2 \epsilon }{2 v_s} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ65.gif"/></alternatives></disp-formula>It has been demonstrated that stable numerical solutions are achievable due to the regularization.</p><p id="Par125">Uhlig et al. (<xref ref-type="bibr" rid="CR255">2012</xref>) and later on Dubois et al. (<xref ref-type="bibr" rid="CR51">2019</xref>) showed that streaming can be recasted into a diffusion term and be solved with an implicit solver for diffusion. The streaming transport term in the CR energy equation <inline-formula id="IEq274"><alternatives><mml:math id="IEq274_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq274_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\nabla }} \cdot [({e_{\text {cr}}}+ {P_{\text {cr}}}) {{\varvec{v}}}_s]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq274.gif"/></alternatives></inline-formula> becomes<disp-formula id="Equ66"><label>66</label><alternatives><mml:math display="block" id="Equ66_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close="]" open="["><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close="]" open="["><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{\nabla }} \cdot {{\varvec{F}}}_{cr,s} = {\varvec{\nabla }} \cdot \left[ - \frac{({e_{\text {cr}}}+ {P_{\text {cr}}})|B|}{{|{\varvec{b}}}\cdot \nabla {e_{\text {cr}}}| \sqrt{4 \pi \rho }} {{\varvec{b}}} ({{\varvec{b}}}\cdot \nabla {e_{\text {cr}}})\right] = {\varvec{\nabla }} \cdot \left[ -D_s {{\varvec{b}}}({{\varvec{b}}}\cdot \nabla {e_{\text {cr}}}) \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ66.gif"/></alternatives></disp-formula>and can be interpreted as anisotropic diffusive term, where <inline-formula id="IEq275"><alternatives><mml:math id="IEq275_Math"><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq275_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq275.gif"/></alternatives></inline-formula> is the diffusion coefficient corresponding to the streaming of CRs along magnetic field lines. The streaming-diffusion process has been modeled with an anisotropic implicit diffusion algorithm and is an interesting alternative to the one proposed by Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>). Characteristic for the solutions obtained with the two different approaches are the flattened extrema apparent in numerical tests, such as those initiated with sinusoidal perturbations (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>The figure shows the flattened maxima typical for the propagation of CRs down their gradient along magnetic field direction. Upper and lower panels show different integration schemes and different timestep choices. Different lines represent different resolutions of the 1D grid adopted for the tests. Image reproduced with permission from Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>), copyright by SIAM</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig4_HTML.png" id="MO70"/></fig></p><p id="Par126">To avoid the ad hoc smoothing Jiang and Oh (<xref ref-type="bibr" rid="CR106">2018</xref>) proposed a new numerical algorithm based on the two-moment methods of radiative transfer under the reduced speed of light approximation. The system of equations for the propagation of CR energy density and flux reads<disp-formula id="Equ67"><label>67</label><alternatives><mml:math display="block" id="Equ67_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>V</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>v</mml:mi><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {e_\mathrm {cr}}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot {\varvec{F}}_\mathrm {cr}= &amp; {} ({\varvec{v}} + {\varvec{v}}_s) \cdot \left( {\varvec{\nabla }} \cdot {\varvec{P}}_\mathrm {cr} \right) + Q, \nonumber \\ \frac{1}{V_m^2} \frac{{\partial }^{} {{\varvec{F}}_\mathrm {cr}}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot {\varvec{P}}_\mathrm {cr}= &amp; {} - \sigma _\mathrm {cr} \cdot \left[ {\varvec{F}}_\mathrm {cr} - v\cdot \left( E_\mathrm {cr} {\varvec{I}} + {\varvec{P}}_\mathrm {cr} \right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ67.gif"/></alternatives></disp-formula>where <inline-formula id="IEq276"><alternatives><mml:math id="IEq276_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><tex-math id="IEq276_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_m$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq276.gif"/></alternatives></inline-formula> is the maximum speed at which CRs can propagate which, for practical reasons, is reduced with respect to the speed of light <italic>c</italic>. The authors demonstrated that their results are not sensitive to the exact value of <inline-formula id="IEq277"><alternatives><mml:math id="IEq277_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><tex-math id="IEq277_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_m$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq277.gif"/></alternatives></inline-formula> as long as it is much larger than the maximum Alfvén and flow velocities in the simulations. On the other hand <inline-formula id="IEq278"><alternatives><mml:math id="IEq278_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><tex-math id="IEq278_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_m$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq278.gif"/></alternatives></inline-formula> can be assumed much smaller than the speed of light, which is important for an effective mitigation of the CFL condition. Essential advantage of the method is that it ensures a stable evolution for isotropic and field aligned streaming and diffusion without any regularization procedure. The timestep given by the standard Courant condition scales linearly with resolution. The full set of equations consists of the standard set of conservative MHD equations extended with the set of the two Eq. (<xref rid="Equ67" ref-type="disp-formula">67</xref>) and with additional CR-related source terms in the momentum and energy equations. The difference with respect to the approach by Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>) is that the interaction coefficient (inverse CR diffusion coefficient) <inline-formula id="IEq279"><alternatives><mml:math id="IEq279_Math"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq279_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq279.gif"/></alternatives></inline-formula> becomes zero when <inline-formula id="IEq280"><alternatives><mml:math id="IEq280_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq280_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\nabla }} P_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq280.gif"/></alternatives></inline-formula> approaches zero. In this regime the term <inline-formula id="IEq281"><alternatives><mml:math id="IEq281_Math"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>V</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq281_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{V_m^2} \frac{{\partial }^{} {{\varvec{F}}_\mathrm {cr}}}{{\partial } {t}^{}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq281.gif"/></alternatives></inline-formula> becomes important, which is the main difference between these two approaches. The flat extrema in the spatial CR distribution can be understood as the result of CR streaming outwards until the flat top develops. CRs cannot stream further to produce an inverted profile because that would require CRs to stream up their gradient. An important element of the approach is the closure relation between the CR pressure tensor and the CR energy density. Jiang and Oh (<xref ref-type="bibr" rid="CR106">2018</xref>) assume that <inline-formula id="IEq282"><alternatives><mml:math id="IEq282_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq282_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{P}}_\mathrm {cr} = {\varvec{I }}e_\mathrm {cr}/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq282.gif"/></alternatives></inline-formula>. This assumption is correct only when CRs are strongly coupled to the gas, but in the case of strong wave dumping CRs may stream freely and the CR pressure can be very anisotropic. The algorithm has been implemented in the publicly available MHD code Athena++ (Stone et al. <xref ref-type="bibr" rid="CR242">2020</xref>).</p><p id="Par127">Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>) developed a new macroscopic transport theory, which includes both diffusion and streaming of CRs in the selfconfinement picture. They incorporated resonant excitation of Alfvén waves through the gyroresonant instability by CRs streaming along magnetic field lines. CR scattering off these waves modulates the macroscopic CR transport. Their approach relies on the system of three equations including an equation for the CR energy density <inline-formula id="IEq283"><alternatives><mml:math id="IEq283_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq283_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq283.gif"/></alternatives></inline-formula> and its flux density <inline-formula id="IEq284"><alternatives><mml:math id="IEq284_Math"><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq284_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_\mathrm {cr} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq284.gif"/></alternatives></inline-formula> in the Eddington approximation of radiative transport and the equation describing the evolution of the energy density of Alfvén waves <inline-formula id="IEq285"><alternatives><mml:math id="IEq285_Math"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq285_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e_{a,\pm }} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq285.gif"/></alternatives></inline-formula> excited by the streaming CRs. The ± signs denote co- and counter-propagating waves with respect to the large scale magnetic field. The Alfvén-wave regulated CR transport equations [eqs. (10-16) in Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>)] in the fluid (comoving) reference frame are<disp-formula id="Equ68"><label>68</label><alternatives><mml:math display="block" id="Equ68_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gri</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gri</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{{\partial }^{} {{e_\mathrm {cr}}}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot \left[ {\varvec{v}} (e_\mathrm {cr} + P_\mathrm {cr}) + {\varvec{b}} F_\mathrm {cr} \right] \nonumber \\&amp;\quad = {\varvec{v}} \cdot {\varvec{\nabla }} P_\mathrm {cr} - {\varvec{v}}_a \cdot {\varvec{g}}_\mathrm {gri,+} + {\varvec{v}}_a \cdot {\varvec{g}}_\mathrm {gri,-} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ68.gif"/></alternatives></disp-formula><disp-formula id="Equ69"><label>69</label><alternatives><mml:math display="block" id="Equ69_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gri</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gri</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{{\partial }^{} {(f_\mathrm {cr}/c^2)}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot \left( {\varvec{v}} F_\mathrm {cr}/c^2 \right) + {\varvec{b}} \cdot {\varvec{\nabla }} P_\mathrm {cr} \nonumber \\&amp;\quad =- \left( {\varvec{b}} \cdot {\varvec{\nabla }} {\varvec{v}} \right) \cdot \left( {\varvec{b}} F_\mathrm {cr}/c^2 \right) -{\varvec{b}} \cdot \left( {\varvec{g}}_\mathrm {gri,+} + {\varvec{g}}_\mathrm {gri,-} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ69.gif"/></alternatives></disp-formula><disp-formula id="Equ70"><label>70</label><alternatives><mml:math display="block" id="Equ70_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gri</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mo>±</mml:mo></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{{\partial }^{} {{e_{a,\pm }}}}{{\partial } {t}^{}} + {\varvec{\nabla }} \cdot \left[ {\varvec{v}} ({e_{a,\pm }} + P_{a,\pm } ) \pm v_a {\varvec{b}} {e_{a,\pm }} \right] \nonumber \\&amp;\quad = {\varvec{v}} \cdot \nabla P_{a,\pm } \pm {\varvec{v}}_a \cdot {\varvec{g}}_\mathrm {gri,\pm } - Q_{\pm }, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ70.gif"/></alternatives></disp-formula>where <inline-formula id="IEq286"><alternatives><mml:math id="IEq286_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq286_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq286.gif"/></alternatives></inline-formula> and <inline-formula id="IEq287"><alternatives><mml:math id="IEq287_Math"><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq287_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq287.gif"/></alternatives></inline-formula>, are measured with respect to the comoving (fluid) frame and the Alfvén wave energy density <inline-formula id="IEq288"><alternatives><mml:math id="IEq288_Math"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq288_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{a,\pm }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq288.gif"/></alternatives></inline-formula> is measured in the lab frame, <inline-formula id="IEq289"><alternatives><mml:math id="IEq289_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><tex-math id="IEq289_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{b}} = {\varvec{B}}/B$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq289.gif"/></alternatives></inline-formula> is the unit vector directed along magnetic field and<disp-formula id="Equ71"><label>71</label><alternatives><mml:math display="block" id="Equ71_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mtext>gri,</mml:mtext><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>κ</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>∓</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{g}}_{\text {gri,}\pm } = \frac{{\varvec{b}}}{3 \kappa _{\pm }} \left[ F_\mathrm {cr} \mp v_a(e_\mathrm {cr} + P_\mathrm {cr} )\right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ71.gif"/></alternatives></disp-formula>are the Lorentz forces due to small-scale magnetic field fluctuations of Alfvén waves.</p><p id="Par128">The subsystem is closed by the grey approximation for the CR diffusion coefficients linking the diffusion of CR energy density directly to the energy density of Alfvénic turbulence<disp-formula id="Equ72"><label>72</label><alternatives><mml:math display="block" id="Equ72_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>κ</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mn>8</mml:mn></mml:mfrac><mml:mfrac><mml:mi>Ω</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{1}{\kappa _\pm } = \frac{9\pi }{8} \frac{\varOmega }{c^2} \frac{e_{a,\pm }}{2\epsilon _B} \left( 1 + \frac{2 v_a}{c^2} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ72.gif"/></alternatives></disp-formula>where <inline-formula id="IEq290"><alternatives><mml:math id="IEq290_Math"><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mi>e</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq290_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varOmega = Ze B/(\gamma m c)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq290.gif"/></alternatives></inline-formula> is the relativistic gyrofrequency of a CR population with charge <italic>Ze</italic> and Lorentz factor <inline-formula id="IEq291"><alternatives><mml:math id="IEq291_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq291_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq291.gif"/></alternatives></inline-formula>.</p><p id="Par129">The scattering rate of CRs particles depends on the Alfvén wave energy density, so this energy density has to be dynamically evolved together with the propagation of CRs. The transport of Alfvén waves depends on several damping processes such as non-linear Landau damping, ion-neutral damping, turbulent and linear Landau damping as well as by sub-Alfvénically streaming CRs.</p><p id="Par130">The CR-Alfvénic subsystem is coupled to the set of ideal MHD equations in a manner ensuring energy and momentum conservation in the non-relativistic limit of MHD<disp-formula id="Equ73"><label>73</label><alternatives><mml:math display="block" id="Equ73_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial \mathbf {U}}{\partial t} + {\varvec{\nabla }}{\varvec{\cdot }}{{\mathbf {\mathsf{{F}}}}} = \mathbf {S} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ73.gif"/></alternatives></disp-formula>with the vector of conserved variables <inline-formula id="IEq292"><alternatives><mml:math id="IEq292_Math"><mml:mi mathvariant="bold">U</mml:mi></mml:math><tex-math id="IEq292_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {U}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq292.gif"/></alternatives></inline-formula>, the fluxes <inline-formula id="IEq293"><alternatives><mml:math id="IEq293_Math"><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mo>≡</mml:mo><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq293_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{F}}}}}\equiv {{\mathbf {\mathsf{{F}}}}}(\mathbf {U})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq293.gif"/></alternatives></inline-formula>, and the source terms <inline-formula id="IEq294"><alternatives><mml:math id="IEq294_Math"><mml:mi mathvariant="bold">S</mml:mi></mml:math><tex-math id="IEq294_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {S}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq294.gif"/></alternatives></inline-formula>. The three vectors can be described as (Thomas and Pfrommer <xref ref-type="bibr" rid="CR250">2019</xref>)<disp-formula id="Equ74"><label>74</label><alternatives><mml:math display="block" id="Equ74_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>ρ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi mathvariant="bold">g</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {U}= &amp; {} \left( \begin{array}{c} \rho \\ \rho {\varvec{ v }} \\ e\\ {\varvec{ B }} \end{array} \right) , \ \ \ \ {{\mathbf {\mathsf{{F}}}}} = \left( \begin{array}{c} \rho {\varvec{ v }} \\ \rho {\varvec{ v }} {\varvec{ v }}^{\mathrm {T}} + P{\varvec{1}} - {\varvec{ B }} {\varvec{ B }}^{\mathrm {T}}/(4\pi ) \\ (e+ P) {\varvec{ v }} - {\varvec{ B }} \left( {\varvec{ v }} {\varvec{\cdot }}{\varvec{ B }} \right) /(4\pi ) \\ {\varvec{ B }} {\varvec{ v }}^{\mathrm {T}} - {\varvec{ v }} {\varvec{ B }}^{\mathrm {T}} \end{array} \right) ,\nonumber \\ \mathbf {S}= &amp; {} \left( \begin{array}{c} 0 \\ {\mathbf {g}} \\ \mathbf {u \cdot g} + Q_{+} + Q_{-} \\ {\mathbf {0}} \end{array} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ74.gif"/></alternatives></disp-formula>Here, <inline-formula id="IEq295"><alternatives><mml:math id="IEq295_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq295_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq295.gif"/></alternatives></inline-formula> is the mass density, <inline-formula id="IEq296"><alternatives><mml:math id="IEq296_Math"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:math><tex-math id="IEq296_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ v }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq296.gif"/></alternatives></inline-formula> is the velocity, and <inline-formula id="IEq297"><alternatives><mml:math id="IEq297_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math><tex-math id="IEq297_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq297.gif"/></alternatives></inline-formula>, <inline-formula id="IEq298"><alternatives><mml:math id="IEq298_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math><tex-math id="IEq298_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq298.gif"/></alternatives></inline-formula> are the source terms of thermal energy due to Alfvén wave energy losses. For the ion-neutral damping <inline-formula id="IEq299"><alternatives><mml:math id="IEq299_Math"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mtext>in</mml:mtext><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Γ</mml:mi><mml:mtext>in</mml:mtext></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq299_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{\text {in}\pm } = \varGamma _{\text {in}} e_{a,\pm } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq299.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq300"><alternatives><mml:math id="IEq300_Math"><mml:msub><mml:mi>Γ</mml:mi><mml:mtext>in</mml:mtext></mml:msub></mml:math><tex-math id="IEq300_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma _{\text {in}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq300.gif"/></alternatives></inline-formula> is the damping rate for Alfvén waves due to ion-neutral collisions. For the nonlinear Landau damping <inline-formula id="IEq301"><alternatives><mml:math id="IEq301_Math"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mtext>nll</mml:mtext><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq301_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{\text {nll}\pm } = \alpha e_{a,\pm }^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq301.gif"/></alternatives></inline-formula>, where the interaction coefficient <inline-formula id="IEq302"><alternatives><mml:math id="IEq302_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt><mml:mn>8</mml:mn></mml:mfrac><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mtext>th</mml:mtext></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq302_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \frac{\sqrt{\pi }}{8}\frac{v_{\text {th}}}{e_B} \langle k \rangle $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq302.gif"/></alternatives></inline-formula> is a function of thermal velocity, magnetic field energy density and an averaged wavenumber. The turbulent damping and linear Landau damping lead to <inline-formula id="IEq303"><alternatives><mml:math id="IEq303_Math"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mtext>turb+ll</mml:mtext><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Γ</mml:mi><mml:mtext>turb</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Γ</mml:mi><mml:mtext>ll</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq303_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{\text {turb+ll}\pm } = (\varGamma _{\text {turb}}+\varGamma _{\text {ll} }) e_{a,\pm }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq303.gif"/></alternatives></inline-formula> with turbulent damping rate given by <inline-formula id="IEq304"><alternatives><mml:math id="IEq304_Math"><mml:mrow><mml:msub><mml:mi>Γ</mml:mi><mml:mtext>turb</mml:mtext></mml:msub><mml:mo>≃</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>,</mml:mo><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mtext>mhd,turb</mml:mtext></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math><tex-math id="IEq304_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma _{\text {turb}} \simeq v_a \sqrt{k_{\parallel ,\text {min}} k_{\text {mhd,turb}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq304.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq305"><alternatives><mml:math id="IEq305_Math"><mml:msub><mml:mi>k</mml:mi><mml:mtext>mhd,turb</mml:mtext></mml:msub></mml:math><tex-math id="IEq305_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\text {mhd,turb}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq305.gif"/></alternatives></inline-formula> is the wavenumber at which the large scale MHD turbulence is driven and <inline-formula id="IEq306"><alternatives><mml:math id="IEq306_Math"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>,</mml:mo><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq306_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\parallel ,\text {min} }\sim 1/r_L$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq306.gif"/></alternatives></inline-formula>, <inline-formula id="IEq307"><alternatives><mml:math id="IEq307_Math"><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math><tex-math id="IEq307_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_L$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq307.gif"/></alternatives></inline-formula> is the Larmor radius [details see Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>), and references therein].</p><p id="Par131">Symbol <inline-formula id="IEq308"><alternatives><mml:math id="IEq308_Math"><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:math><tex-math id="IEq308_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ g }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq308.gif"/></alternatives></inline-formula> represents forces between CRs, Alfvén waves and the thermal gas:<disp-formula id="Equ75"><label>75</label><alternatives><mml:math display="block" id="Equ75_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>Lorentz</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>ponder</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>gri,+</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>gri,-</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{g}} = {\varvec{g}}_{\text {Lorentz}} + {\varvec{g}}_{\text {ponder}} + {\varvec{g}}_{\text {gri,+}} + {\varvec{g}}_{\text {gri,-}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ75.gif"/></alternatives></disp-formula>where<disp-formula id="Equ76"><label>76</label><alternatives><mml:math display="block" id="Equ76_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>Lorentz</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mspace width="4pt"/><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>⊥</mml:mo></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{g}}_{\text {Lorentz}}= &amp; {} - ({\varvec{1}} - {\varvec{b \ b}}) ) \cdot {\varvec{\nabla }}_\perp P_{\text {cr}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ76.gif"/></alternatives></disp-formula><disp-formula id="Equ77"><label>77</label><alternatives><mml:math display="block" id="Equ77_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mtext>ponder</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{g}}_{\text {ponder}}= &amp; {} - {\varvec{\nabla }} (P_{\text {a},+} + P_{\text {a},-}) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ77.gif"/></alternatives></disp-formula>are the Lorentz force due to the large-scale magnetic field and the ponderomotive force respectively, and <inline-formula id="IEq309"><alternatives><mml:math id="IEq309_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq309_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {a},+} + P_{\text {a},-} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq309.gif"/></alternatives></inline-formula> are the ponderomotive pressures.</p><p id="Par132">The thermal and CR energy densities are given by <inline-formula id="IEq310"><alternatives><mml:math id="IEq310_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub></mml:math><tex-math id="IEq310_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {th}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq310.gif"/></alternatives></inline-formula> and <inline-formula id="IEq311"><alternatives><mml:math id="IEq311_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq311_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq311.gif"/></alternatives></inline-formula>, respectively. The total pressure <italic>P</italic> and the total energy density excluding CRs are<disp-formula id="Equ78"><label>78</label><alternatives><mml:math display="block" id="Equ78_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>P</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P&amp;=  P_\mathrm {th} + \frac{{\varvec{ B }}^2}{2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ78.gif"/></alternatives></disp-formula><disp-formula id="Equ79"><label>79</label><alternatives><mml:math display="block" id="Equ79_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>e</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e&amp;=  e_\mathrm {th} + \frac{\rho {\varvec{ v }}^2}{2} + \frac{{\varvec{ B }}^2}{2}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ79.gif"/></alternatives></disp-formula>The system of the equations is closed using an equation of state for both the thermal as well as the CR fluid,<disp-formula id="Equ80"><label>80</label><alternatives><mml:math display="block" id="Equ80_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_\mathrm {th}&amp;=  (\gamma _\mathrm {th}-1)\,e_\mathrm {th}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ80.gif"/></alternatives></disp-formula><disp-formula id="Equ81"><label>81</label><alternatives><mml:math display="block" id="Equ81_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_\mathrm {cr}&amp;=  (\gamma _\mathrm {cr}-1)\,e_\mathrm {cr}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ81.gif"/></alternatives></disp-formula>The adiabatic indices are usually set to the canonical value of <inline-formula id="IEq312"><alternatives><mml:math id="IEq312_Math"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq312_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathrm {th}=5/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq312.gif"/></alternatives></inline-formula> and to <inline-formula id="IEq313"><alternatives><mml:math id="IEq313_Math"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq313_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathrm {cr}=4/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq313.gif"/></alternatives></inline-formula> implying a fully relativistic fluid.</p><p id="Par133">Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>) presented numerical solutions of the new CR-Alfvén wave subsystem in one spatial dimension along the magnetic field. The inclusion of the nonequilibrium kinetic effects in the Alfvén wave propagation advances significantly the treatment of CR propagation over the approaches assuming a fixed Alfvén wave background. One of the tests reported by the authors exhibits the expected property of the system that the non-linear Landau damping process reduces the wave energy, increases the CR flux density and makes the CR transport more diffusive. The formalism itself does not depend on free parameters, since the CR diffusion and the wave Landau damping coefficients are given by MHD quantities and the characteristic gyrofrequency of CR population in the grey approximation. The only tunable parameter—the reduced speed of light—is chosen so that the solution does not depend on its specific value.</p><p id="Par134">The aproach by Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>) recovers the equations of Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>) in the steady-state limit. The major difference between the formalisms of Jiang and Oh (<xref ref-type="bibr" rid="CR106">2018</xref>) and Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>) is that the diffusion coefficient of CRs in the first case is reconstructed from the distribution of <inline-formula id="IEq314"><alternatives><mml:math id="IEq314_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq314_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq314.gif"/></alternatives></inline-formula><disp-formula id="Equ82"><label>82</label><alternatives><mml:math display="block" id="Equ82_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mfenced close="|" open="|"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \kappa = \kappa _0 + \left| \frac{{\partial }^{} {p_\mathrm {cr}}}{{\partial } {x}^{}} \right| ^{-1} v_a (e_\mathrm {cr} + P_\mathrm {cr}), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ82.gif"/></alternatives></disp-formula>while in the latter case it is related to the energy density of Alfvén waves and may be influenced by various damping processes, such as Landau damping, inaccessible directly in the former approach. The results obtained with the method by Jiang and Oh (<xref ref-type="bibr" rid="CR106">2018</xref>) are almost identical to those obtained with the Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>) in a test case initiated with a Gaussian profile of CR energy density, however a similar test involving the Gaussian profile superposed to an initial uniform CR background, shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref> indicates advantages of the separate treatment of Alfveń wave component in the method proposed by Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>).<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Comparison of the time evolution of an isolated Gaussian profile of <inline-formula id="IEq315"><alternatives><mml:math id="IEq315_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq315_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq315.gif"/></alternatives></inline-formula> on top of a homogeneous CR distribution in the approaches by Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>), Jiang and Oh (<xref ref-type="bibr" rid="CR106">2018</xref>) and by Sharma et al. (<xref ref-type="bibr" rid="CR221">2010</xref>). Profiles of the CR energy distribution, energy flux and streaming spead reveal signifficant differences. Image reproduced with permission from Thomas and Pfrommer (<xref ref-type="bibr" rid="CR250">2019</xref>), copyright by the authors</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig5_HTML.png" id="MO87"/></fig></p><p id="Par135">Another interesting alternative for the direct incorporation of the streaming process on large galactic scales has been proposed by Krumholz et al. (<xref ref-type="bibr" rid="CR132">2020</xref>) who develop theoretical models of CR propagation, relating CR diffusion to the streaming process in magnetic field line random walk (FLRW). They describe the FLRW as the macroscopic diffusion coefficient to indicate that (1) the averaging is done over scales larger than the coherence length of MHD turbulence, (2) the process relies on the Alfvén wave regulated transport, which arises from the first-order term in distribution of pitch angles, while diffusion of CR relative to the bulk flow represents a second-order microscopic diffusion. They present an explicit formula for the CR parallel diffusion coefficient (their Eq. <xref rid="Equ20" ref-type="disp-formula">20</xref>) and show its dependence on energy (their Fig. <xref rid="Fig2" ref-type="fig">2</xref>) for three starbust galaxies and the Milky Way. They apply the computed diffusion coefficient to a simple model of CR escape and loss, and show that the resulting <inline-formula id="IEq316"><alternatives><mml:math id="IEq316_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq316_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq316.gif"/></alternatives></inline-formula>-ray spectra are in good agreement with the observed spectra of the starbursts NGC 253, M82, and Arp 220. The model reproduces relatively hard GeV <inline-formula id="IEq317"><alternatives><mml:math id="IEq317_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq317_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq317.gif"/></alternatives></inline-formula>-ray spectra and softer TeV spectra without the need for any fine-tuning of advective escape times or the shape of the CR injection spectrum.</p></sec><sec id="Sec30"><title>Momentum-dependent diffusion-advection models</title><p id="Par136">Up to now we have discussed numerical treatments of the diffusion-advection equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) integrated over momentum space which leads us to the two-fluid approaches applied for the combination of a thermal fluid and CRs treated as a relativistic fluid. Neglecting the evolution of the whole CR population in momentum space is a significant simplification.</p><p id="Par137">However, the Fokker–Planck equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) can be also discretized and solved numerically in both spatial and momentum spaces to determine a time-evolution of the distribution function <inline-formula id="IEq318"><alternatives><mml:math id="IEq318_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq318_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({\varvec{x}}, p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq318.gif"/></alternatives></inline-formula> in a way similar to the approaches implemented in GALPROP (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>), PICARD (Kissmann <xref ref-type="bibr" rid="CR127">2014</xref>), DRAGON2 (Evoli et al. <xref ref-type="bibr" rid="CR58">2017</xref>), but with dynamical coupling to the thermal plasma taken into account.</p><p id="Par138">Including the additional momentum dimensions in full generality becomes computationally demanding because the space of independent variables expands from three to six dimensions. A practical option is to reduce the problem to four dimensions by assuming that the distribution function is isotropic. A standard discretization with piecewise constant values for <italic>f</italic> requires relatively high spectral resolution in order to obtain accurate results. Because of a typically high dynamical range of the power-low distribution function a few hundred bins are necessary to achieve a reasonable accuracy of the numerical integration (see e.g. Winner et al. <xref ref-type="bibr" rid="CR275">2019</xref>; Girichidis et al. <xref ref-type="bibr" rid="CR82">2020b</xref>).</p><p id="Par139">Falle and Giddings (<xref ref-type="bibr" rid="CR60">1987</xref>) and Bell (<xref ref-type="bibr" rid="CR11">1987</xref>) used partial differential equation solvers to investigate the time-dependent structure of plane parallel shocks propagating parallel to the large-scale magnetic field. They solved the CR transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) in momentum space, together with the transport of gas and CRs in one spatial dimension. They used first-order Godunov methods to evolve the gas in a conservative manner together with a non-conservative treatment of the CR population represented by the function <inline-formula id="IEq319"><alternatives><mml:math id="IEq319_Math"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mrow></mml:math><tex-math id="IEq319_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=p^4 f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq319.gif"/></alternatives></inline-formula> on a uniform grid of the independent variable <inline-formula id="IEq320"><alternatives><mml:math id="IEq320_Math"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq320_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=\ln p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq320.gif"/></alternatives></inline-formula>. The effectively smaller dynamical range of <italic>g</italic> resulted in a possibility to reduce resolution of the momentum grid. These authors applied a Lagrangian formalism for advection and diffusion of the CR spectrum and used the Crank-Nicholson method. They included injection of particles at the shock position and assumed a momentum-dependent CR diffusion coefficient.</p><p id="Par140">Another way to reduce the computational cost is to consider CRs as a passive component needed only for observational diagnostics of the simulated object. In this case a smaller spatial resolution of synthetic images is usually sufficient, therefore the spectrum can be evolved for a relatively small set of Lagrangian particles. If dynamical impact of CRs on the thermal fluid is to be taken into account, the spectrum is needed for each computational element of the spatial grid. This would imply the need to process hundreds of momentum bins on multi-dimensional spatial grids leading to very high computational costs of numerical models.</p><p id="Par141">To mitigate the computational demands several methods have been proposed to solve the Fokker–Planck equation using a piecewise power-law representation. The currently popular methods can be classified as one-moment and two-moment approaches, involving number density <inline-formula id="IEq321"><alternatives><mml:math id="IEq321_Math"><mml:msub><mml:mi>n</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq321_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_{\text {cr}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq321.gif"/></alternatives></inline-formula> and/or energy density <inline-formula id="IEq322"><alternatives><mml:math id="IEq322_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq322_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e_{\text {cr}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq322.gif"/></alternatives></inline-formula> moments of the distribution function <italic>f</italic> defined in Sect. <xref rid="Sec21" ref-type="sec">4.1</xref>.</p><sec id="Sec31"><title>One-moment approaches</title><p id="Par142">To achieve a more accurate evolution of the spectrum with a lower number of momentum bins one needs an accurate representation of the spectrum within a single bin. Since the observed spectra of CRs are power-laws to a good approximation, a natural choice is the numerical representation by the piecewise power-low distribution function. Jun and Jones (<xref ref-type="bibr" rid="CR119">1999</xref>) assumed a piece-wise power-law electron spectrum of the type<disp-formula id="Equ83"><label>83</label><alternatives><mml:math display="block" id="Equ83_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(p) = f_{i-1/2} \left( \frac{p}{p_{i-1/2}}\right) ^{-q_i}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ83.gif"/></alternatives></disp-formula>where edges of <italic>i</italic>-th bin are placed at <inline-formula id="IEq323"><alternatives><mml:math id="IEq323_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq323_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i-1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq323.gif"/></alternatives></inline-formula> and the logarythmic slope <inline-formula id="IEq324"><alternatives><mml:math id="IEq324_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq324_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq324.gif"/></alternatives></inline-formula> is attributed to bin centers. They used the number density as the dependent variable representing CRs<disp-formula id="Equ84"><label>84</label><alternatives><mml:math display="block" id="Equ84_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_i = \int _{p_{i-\frac{1}{2}}}^{p_{i+\frac{1}{2}}} 4\pi p^2 f(p) dp \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ84.gif"/></alternatives></disp-formula>to obtain the number density moment of the CR discretized transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>). They noted that only a few bins may capture the basic structure of the spectrum. They assumed a continuous spectrum at the bin boundaries. By imposing the same values of the slope <inline-formula id="IEq325"><alternatives><mml:math id="IEq325_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq325_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq325.gif"/></alternatives></inline-formula> for two lowest bins in the log of momentum space one can solve, with the use of continuity assumption, the system of equations recursively for the entire spectrum.</p><p id="Par143">The method has been combined with the ideal MHD equations for an adiabatic plasma, solved using the ZEUS-3D Eulerian code (Stone and Norman <xref ref-type="bibr" rid="CR240">1992a</xref>, <xref ref-type="bibr" rid="CR241">b</xref>; Jun et al. <xref ref-type="bibr" rid="CR120">1994</xref>). The advection equation for the electron number density was solved by the standard fluid transport algorithm and the adiabatic compression term was updated implicitly for the time-centered number density of electrons in each momentum bin. The CR electrons were treated as a passive population without a significant pressure affecting the thermal plasma component. The diffusion term in the CR propagation and the synchrotron losses were ignored. The code has been used to study the MHD evolution of a Type Ia supernova remnant with CR electrons and for SN interactions with clouds in two spatial dimensions.</p><p id="Par144">Using the piecewise-powerlaw approximation within another code Jones et al. (<xref ref-type="bibr" rid="CR117">1999</xref>) solved the equations of ideal nonrelativistic magnetohydrodynamics (MHD) in cylindrical coordinates. Tregillis et al. (<xref ref-type="bibr" rid="CR254">2001</xref>) used the method combined with 3D MHD simulations of electron transport in radio-galaxies.</p><p id="Par145">The code is an MHD extension of the Harten (<xref ref-type="bibr" rid="CR95">1983</xref>) conservative, second-order finite difference total variation diminishing scheme, as detailed in Ryu and Jones (<xref ref-type="bibr" rid="CR203">1995</xref>), Ryu et al. (<xref ref-type="bibr" rid="CR204">1995</xref>, <xref ref-type="bibr" rid="CR205">1998</xref>). The electron transport equation was derived from the general momentum-dependent diffusion advection equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) with the effects of spatial diffusion neglected. To properly treat the particle density at shock discontinuities their algorithm evolved the normalized concentration of relativistic particles <inline-formula id="IEq326"><alternatives><mml:math id="IEq326_Math"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math><tex-math id="IEq326_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i = n_i/\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq326.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq327"><alternatives><mml:math id="IEq327_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq327_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq327.gif"/></alternatives></inline-formula> is the gas density.</p><p id="Par146">The one-moment piece-wise power-law method proposed by Jun and Jones (<xref ref-type="bibr" rid="CR119">1999</xref>) is relatively straightforward and computationally inexpensive, however, there is a fundamental problem with a continuous description of <italic>f</italic> in particular for a locally varying spectrum. Numerical tests (Girichidis et al. <xref ref-type="bibr" rid="CR82">2020b</xref>) show that if energy is injected at one part of the spectrum, the continuity assumption enforces changes of the local slope across the entire spectrum. The resulting continuous representation then alternates between a concave and a convex spectrum. Artificial oscillations superposed to the initially smooth spectrum have a tendency to grow towards high energy bins revealing a numerical instability of the scheme. To avoid these oscillations, the energy in all bins need to be adjusted. The problem is less severe for a small number of bins, equal or less than 10. An alternative for the continuous spectrum is the discontinuous modeling, which requires to constrain two degrees of freedom. Within the one-moment approach one may consider the additional restriction imposing a constant curvature of the spectrum through the relation <inline-formula id="IEq328"><alternatives><mml:math id="IEq328_Math"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq328_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{i+1} - q_i = q_i - q_{i-1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq328.gif"/></alternatives></inline-formula>, which turns out to be suitable only for CR nucleons, but not for the fast cooling electrons (Miniati <xref ref-type="bibr" rid="CR155">2001</xref>).</p><p id="Par147">An interesting one-moment approach to the propagation of CR electrons, not affected by the numerical instability described above, was proposed by Mimica et al. (<xref ref-type="bibr" rid="CR154">2009</xref>) and implemented in SPEV code and followed by Vaidya et al. (<xref ref-type="bibr" rid="CR256">2018</xref>) who incorporated their algorithm in the PLUTO code. These authors presented a hybrid framework which describes the spectral evolution of highly energetic particles by means of (mesh-less) Lagrangian macro-particles embedded in a classical or relativistic MHD fluid. The main purpose of this work was the inclusion of sub-grid micro-physical processes at macroscopic astrophysical scales where the fluid approximation is adequate. The MHD equations were integrated by means of standard Godunov-type finite-volume schemes, while propagation of macro-particles representing CRs is described by the relativistic version of the cosmic-ray transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>). In the numerical implementation the number density moment of the equation corresponding to Eq. (<xref rid="Equ32" ref-type="disp-formula">32</xref>) was solved for the CR particle number density normalized to the fluid number density <inline-formula id="IEq329"><alternatives><mml:math id="IEq329_Math"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="IEq329_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi _p = n_p/n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq329.gif"/></alternatives></inline-formula> (Vaidya et al. <xref ref-type="bibr" rid="CR256">2018</xref>). Spatial diffusion of CR particles as well as back-reaction from particle to the fluid were not included. The novel aspect of their approach is the Lagrangian approach in momentum space assuming that bin edge positions drift in accordance with the flow of particles in momentum space due to actual cooling and heating processes. Position changes of bin-edges were calculated by means of the method of characteristics in momentum space reducing the problem to the set of ordinary differential equations for each Lagrangian particle moving in physical coordinate space. The Lagrangian discretization in momentum space implies that the particle number within each bins remains constant. The power-law index <italic>q</italic> needed for computing of synchrotron emissivity was computed a posteriori.</p></sec><sec id="Sec32"><title>Two-moment approaches</title><p id="Par148">Another method proposed by Miniati (<xref ref-type="bibr" rid="CR155">2001</xref>) binds the pair of distribution function parameters <inline-formula id="IEq330"><alternatives><mml:math id="IEq330_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq330_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(f_{i - 1/2}, q_i)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq330.gif"/></alternatives></inline-formula> to its two moments: number density <inline-formula id="IEq331"><alternatives><mml:math id="IEq331_Math"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq331_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq331.gif"/></alternatives></inline-formula> and energy density <inline-formula id="IEq332"><alternatives><mml:math id="IEq332_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq332_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq332.gif"/></alternatives></inline-formula>. In absence of energy loss processes (radiative and adiabatic losses) these two moments are conservative quantities and therefore they are suitable for an accurate evolution with conservative transport schemes in both the spatial and momentum domains. A summary of the two-moment piece-wise power-law method is presented in Sect. <xref rid="Sec40" ref-type="sec">5.3</xref>.</p><p id="Par149">Using a similar approach Jones and Kang (<xref ref-type="bibr" rid="CR115">2005</xref>) modelled the propagation of CRs including advection plus diffusion in space and advection in momentum. The propagation equation does not include any strong cooling effects, such as the ionization or synchrotron cooling which act predominantly on one of the edges of the spectrum. Therefore the spectrum can be processed in an arbitrarily chosen range of momentum space, with the momentum boundary condition setting the particle number density to zero at the high energy end. At the low energy range of the spectrum the distribution was matched to the thermal particle distribution. The authors refer to the method as to “Coarse-Grained Momentum finite Volume” or “CGMV”. It extends the ideas introduced in Jones et al. (<xref ref-type="bibr" rid="CR117">1999</xref>), Miniati (<xref ref-type="bibr" rid="CR155">2001</xref>) for the case of CR transport across an Eulerian grid including advection and diffusion.</p><p id="Par150">Jones and Kang (<xref ref-type="bibr" rid="CR115">2005</xref>) extended the CGMV method so that it can be applied to the treatment of fully nonlinear CR modified shocks. The algorithm has been implemented in the CRASH code which is based on the high order Godunov-like shock tracking algorithm. The hydrodynamics routine in that code employs a nonlinear Riemann solver to follow shock discontinuities within the zones of an initially uniform grid. Thus, gas sub-shocks in CR-modified shocks remain discontinuous throughout a simulation, allowing CR transport to be modeled down almost to the scale of the physical shock thickness. CRASH also employs adaptive mesh refinement (AMR) around shocks in order to reduce the computational effort on the spatial grid.</p><p id="Par151">With the aim of studying the Fermi bubbles (kpc-scale gamma-ray features centred on the Galactic Centre) Yang and Ruszkowski (<xref ref-type="bibr" rid="CR279">2017</xref>) develop a new CRSPEC module for FLASH code to track the CR spectrum during MHD simulations. They construct a scenario for the Fermi bubbles resulting from AGN jet activity in the center of Milky Way. The specific features of the Fermi bubble’s spectra including their spatial uniformity, shapes of the spectra and high energy cutoff at 110 GeV suggest a leptonic origin. The physical nature of the problem requires, therefore, a method to evolve the spectra of CR electrons dynamically together with the fluid-dynamical evolution of the expanding bubble. The method they adopted to trace the CR electrons spectral evolution follows the piece-wise power-law approach by Miniati (<xref ref-type="bibr" rid="CR155">2001</xref>). They solve the two-moment set of equations for a population of CR electrons advected along trajectories of a set of tracer particles while CR diffusion neglected. They assumed a hydrodynamical evolution of the thermal component and a fixed magnetic field taken from GALPROP models. In this sense their approach represents a intermediate step between the CR propagation in a fixed plasma background and the self-consistent models.</p><p id="Par152">Winner et al. (<xref ref-type="bibr" rid="CR275">2019</xref>) presented an efficient post-processing code for Cosmic Ray Electron Spectra that are evolved in Time (CREST) on Lagrangian tracer particles. The novel element of their method is the division of the overall spectrum into three parts treated with different methods. They note that for very low momenta the timescale related to the Coulomb cooling process becomes shorter than the typical time step of MHD simulations. Similarly, for very high momenta the synchrotron and inverse Compton energy losses proceed on arbitrarily short timescales. In order to efficiently calculate the CR electron spectrum with time steps similar to the MHD time step, they use analytical solutions for low and high momenta together with the fully numerical treatment for intermediate momenta. The situation is outlined in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Schematic view of characteristic time-scales for electron cooling illustrating the combination of analytical and numerical solutions. The grey area shows the ranges where either Coulomb or inverse Compton plus synchrotron cooling dominate and where analytical solutions can be used. Image reproduced with permission from Winner et al. (<xref ref-type="bibr" rid="CR275">2019</xref>), copyright by the authors</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig6_HTML.png" id="MO90"/></fig></p><p id="Par153">The analytical approach relies on the consideration of the momentum losses corresponding to the cooling terms in the CR transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>). The momentum losses integrated over a time step lead to the change of the distribution function due to the cooling which shifts particles with from <inline-formula id="IEq333"><alternatives><mml:math id="IEq333_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">ini</mml:mi></mml:msub></mml:math><tex-math id="IEq333_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\mathrm{ini}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq333.gif"/></alternatives></inline-formula> to <italic>p</italic> within <inline-formula id="IEq334"><alternatives><mml:math id="IEq334_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq334_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq334.gif"/></alternatives></inline-formula><disp-formula id="Equ85"><label>85</label><alternatives><mml:math display="block" id="Equ85_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">ini</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">ini</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(p,t_0+\varDelta t) = f(p_{\mathrm {ini}}(p,\varDelta t), t_0) \frac{{\dot{p}}(p_{\mathrm {ini}}(p,\varDelta t), t_0+\varDelta t))}{{\dot{p}}(p,t_0)}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ85.gif"/></alternatives></disp-formula>The cooled spectrum can be interpreted as a momentum shift of the initial spectrum at time <inline-formula id="IEq335"><alternatives><mml:math id="IEq335_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq335_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq335.gif"/></alternatives></inline-formula> multiplied with a momentum-dependent cooling factor. In the central part of the spectrum the CR transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is solved with the aid of direct numerical integration relying on the operator split technique. The spectrum is calculated on a discrete momentum grid with piecewise constant values. A cubic interpolation function is used to calculate the analytic solution after a time step <inline-formula id="IEq336"><alternatives><mml:math id="IEq336_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq336_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq336.gif"/></alternatives></inline-formula>.</p><p id="Par154">The combination of analytical and numerical methods enables the integration of the spectra on reasonably large MHD time steps. The hybrid analytical-numerical method is implemented in the CREST module and coupled to the cosmological MHD code AREPO (Springel <xref ref-type="bibr" rid="CR238">2010</xref>; Pakmor et al. <xref ref-type="bibr" rid="CR175">2016c</xref>) with CR protons modeled as a relativistic fluid with a constant adiabatic index of 4/3 in a two-fluid approximation (Pfrommer et al. <xref ref-type="bibr" rid="CR182">2017</xref>). The coupling of CR propagation to the MHD system is done with the aid of Lagrangian tracer particles, which trace the velocity field (Genel et al. <xref ref-type="bibr" rid="CR73">2013</xref>) and are passively advected with the gas. The CR electron transport equation is solved for each particle in a post-processing routine on every MHD time step. The hybrid technique enables modeling of the spectral CR electron evolution such as adiabatic expansion and compression, Coulomb losses, radiative losses: inverse Compton, bremsstrahlung and synchrotron processes, diffusive shock acceleration and re-acceleration, and Fermi-II reaccelleration. The authors demonstrate that the CR electron spectra are efficiently and accurately evolved in shock-tube and Sedov-Taylor blast wave simulations. This technique opens up the possibility to produce self-consistent synthetic observables of non-thermal emission processes in various astrophysical environments like SNR (Winner et al. <xref ref-type="bibr" rid="CR276">2020</xref>).</p><p id="Par155">A similar technique based on a combination of the numerical integration with the aid of piecewise power-law method and the analytical prescription of the Coulomb cooling has been applied by Girichidis et al. (<xref ref-type="bibr" rid="CR82">2020b</xref>). The analytical solution helps to overcome the excessive shortening of the integration timestep whenever the cooling timescale is significantly shorter than the hydrodynamical timescale. The numerical integration scheme incorporated the two-moment approach by Miniati (<xref ref-type="bibr" rid="CR155">2001</xref>). The original algorithm was modified in the part responsible for cooling losses, that were computed through a modification of inter-bin fluxes, rather than by inclusion of source terms (incorporated through the ’R’-term in the original approach, see Sect. <xref rid="Sec35" ref-type="sec">5</xref>) to the evolution equation for the spectral energy density of CRs. The modification enables a more accurate computation of the spectral slope and is a less-diffusive alternative for the propagation of CR population in momentum space. Tests of the algorithm have confirmed that a combination of injection and cooling of CRs including Coulomb and hadronic losses shows a very good agreement with theoretical steady state spectra.</p><p id="Par156">Solutions of the CR transport equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) including advection, diffusion and spectral evolution coupled with the MHD evolution of the thermal plasma turn out to be challenging. Up to now only approaches restricted to a subset of physically relevant processes have been successful. The GALPROP-type codes include an extensive set of physical interactions of CR particles under the assumption of fixed magnetic field, the CGMV method of Jones and Kang (<xref ref-type="bibr" rid="CR115">2005</xref>) is capable of modeling spectral evolution together with diffusion, advection and dynamical coupling of the CR population to the thermal plasma, but cannot cope with the fast cooling processes. Other implementations (Miniati <xref ref-type="bibr" rid="CR155">2001</xref>; Winner et al. <xref ref-type="bibr" rid="CR275">2019</xref>) engaging Lagrangian test particles include particle acceleration and various cooling processes, but ignore diffusion and dynamical coupling to thermal plasma.</p><p id="Par157">Limitations of the original CGMV method become severe in the presence of fast cooling processes, such as synchrotron emission, which naturally tends to evacuate all particles from high energy bins, producing steep spectra near the upper cutoff. To avoid these limitations Ogrodnik et al. (<xref ref-type="bibr" rid="CR166">2021</xref>) extended the CGMV method with movable boundaries, which change in response to CR momentum gains or losses near the extremes of the population distribution. The extension relies on an operational definition of spectral cutoffs which define spectral boundaries of the spectrum. The extension involves a special treatment of momentum bins containing spectral cutoffs. Contrary to the regular bins of fixed width, those bins have variable-width, and their outer edges coincide with spectral cutoffs.</p><p id="Par158">The CR spectra may have different cutoffs in each spatial grid cell, because local cooling conditions (magnetic and velocity fields) are generally different. Due to advective and diffusive propagation of the CRs across the spatial grid, different populations of particles mix in every cell. The essential part of the numerical problem is to estimate an effective cutoff for the mixture of different populations inflowing from neighboring cells with different cutoffs. The cutoff positions are estimated from the particle number density and energy density in the outer bins for an assumed value of an additional parameter <inline-formula id="IEq337"><alternatives><mml:math id="IEq337_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>small</mml:mtext></mml:msub></mml:math><tex-math id="IEq337_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\text {small} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq337.gif"/></alternatives></inline-formula> representing the smallest physically significant level of CR spectral energy density. Estimation of cutoff positions from the number density and energy density moments enables a numerically stable computation of power-law indexes in the active bins, especially those containing the cutoffs, what would not be possible in the case of fixed boundary conditions in momentum space.</p><p id="Par159">The algorithm is designed to follow spectral evolution of CRs coupled with an MHD system on Eulerian grids and is particularly useful for modeling of CR electron population subject to strong synchrotron and inverse Compton cooling in the high-energy part of the spectrum. The algorithm is suitable for studies of CR electron spectrum evolution in MHD simulations of the galactic interstellar medium.</p></sec><sec id="Sec33"><title>Advances in theory of CR propagation</title><p id="Par160">An important development has been to explicitly compute the trajectories of charged particles numerically in the magnetised ISM, thus going beyond the analytical approximations of e.g. the quasi-linear theory. In principle this involves just the Lorentz force and Maxwell’s equations, i.e. very basic physics. This approach was pioneered by Giacalone and Jokipii (<xref ref-type="bibr" rid="CR74">1994</xref>, <xref ref-type="bibr" rid="CR75">1999</xref>). The turbulent magnetic field is modelled as a superposition of modes with a power-law spectrum, using Alfvén waves. The trajectories are computed for large numbers of particles, and then statistical properties—diffusion tensors etc—are calculated (e.g. Reville et al. <xref ref-type="bibr" rid="CR197">2008</xref>). The diffusion coefficient perpendicular to the B-field is found to be much smaller than the parallel coefficient. Casse et al. (<xref ref-type="bibr" rid="CR35">2002</xref>) extended this approach to higher energies and a wider range of environments, including SNR, superbubbles and radio-galaxies.</p><p id="Par161">Desiati and Zweibel (<xref ref-type="bibr" rid="CR46">2014</xref>) show that even simple magnetic nonuniformities combined with pitch angle scattering can enhance cross field line transport by several orders of magnitude, while pitch angle scattering is unnecessary for enhanced transport if the field is chaotic. Perpendicular diffusion remains relatively small compared to parallel diffusion. Snodin et al. (<xref ref-type="bibr" rid="CR235">2016</xref>) study CR diffusion by means of particle simulations in turbulent magnetic fields. They obtain direct estimates of the diffusion tensor from test particle simulations in random magnetic fields, with the Larmor radius scale being fully resolved and find that diffusion coefficients obtained are consistent with existing transport theories that include the random walk of magnetic lines. Shukurov et al. (<xref ref-type="bibr" rid="CR222">2017</xref>) calculate cosmic-ray diffusivity in intermittent dynamo-generated magnetic fields using test particle simulations. The results are compared with those obtained from non-intermittent magnetic fields having identical power spectra. The presence of magnetic intermittency significantly enhances cosmic-ray diffusion over a wide range of particle energies. The authors demonstrate that the results can be interpreted in terms of a correlated random walk. Seta et al. (<xref ref-type="bibr" rid="CR216">2018</xref>) use test particle simulations, tracing the propagation of charged particles (protons) through a random magnetic field, to study the cosmic ray distribution at scales comparable to the correlation scale of the turbulent flow in the interstellar medium (~ 100 pc in spiral galaxies). They find that there is no spatial correlation between the cosmic ray number density and the magnetic field energy density. Low-energy cosmic rays can become trapped between magnetic mirrors, whose location depends more on the structure of the field lines than on the field strength. These results are relevant for interpreting synchrotron emission data which often assume energy equipartition of CRs with the magnetic field energy.</p><p id="Par162">Meanwhile observation-based models of the Galactic magnetic fields and related theory are improving, and these can be input to CR propagation studies, as addressed elsewhere in this review.</p></sec></sec><sec id="Sec34"><title>Spatial diffusion of spectrally resolved CRs</title><p id="Par163">In contrast to advection, spatial diffusion includes an interaction of spatial and spectral changes. Being energy conserving, spatial diffusion itself does not transfer CRs in momentum space at one position in space, i.e., <inline-formula id="IEq339"><alternatives><mml:math id="IEq339_Math"><mml:msub><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq339_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial f/\partial p=0|_{x}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq339.gif"/></alternatives></inline-formula>. But the transport of number and energy density to neighbouring cells depend on the spatial derivatives of <italic>f</italic>. Depending on the values in neighbouring fluid elements and combined with a different diffusion tensor for <italic>n</italic> and <italic>e</italic> will result in changes of both amplitude <inline-formula id="IEq340"><alternatives><mml:math id="IEq340_Math"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq340_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{i-1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq340.gif"/></alternatives></inline-formula> and slope <inline-formula id="IEq341"><alternatives><mml:math id="IEq341_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq341_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq341.gif"/></alternatives></inline-formula> within one spectral bin, and with that the other physical processes in the following evolution. We derive the terms for number and energy density separately. For the former one the spatial diffusion in momentum range <inline-formula id="IEq342"><alternatives><mml:math id="IEq342_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq342_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[p_1, p_2]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq342.gif"/></alternatives></inline-formula> is given by<disp-formula id="Equ86"><label>86</label><alternatives><mml:math display="block" id="Equ86_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">diff</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _t n_\mathrm {diff}&amp;= \int _{p_1}^{p_2} 4\pi {\varvec{\nabla }}{\varvec{\cdot }}({{\mathbf {\mathsf{{D}}}}}{\varvec{\cdot }}{\varvec{\nabla }}f)p^2\,{\mathrm {d}}p\nonumber \\&amp;=4\pi {\varvec{\nabla }}{\varvec{\cdot }}\left[ \int _{p_1}^{p_2} p^2 {{\mathbf {\mathsf{{D}}}}}{\varvec{\cdot }}{\varvec{\nabla }}f\,{\mathrm {d}}p\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ86.gif"/></alternatives></disp-formula>with the diffusion tensor <inline-formula id="IEq343"><alternatives><mml:math id="IEq343_Math"><mml:mi mathvariant="sans-serif">D</mml:mi></mml:math><tex-math id="IEq343_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{D}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq343.gif"/></alternatives></inline-formula>,<disp-formula id="Equ87"><label>87</label><alternatives><mml:math display="block" id="Equ87_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="sans-serif">D</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>31</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>32</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>33</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\mathbf {\mathsf{{D}}}}}&amp;= \left( \begin{array}{ccc} D_{11} &amp;{} D_{12} &amp;{} D_{13}\\ D_{21} &amp;{} D_{22} &amp;{} D_{23}\\ D_{31} &amp;{} D_{32} &amp;{} D_{33} \end{array}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ87.gif"/></alternatives></disp-formula>The components include the orientation of the magnetic fields. The components are chosen to be (Ryu et al. <xref ref-type="bibr" rid="CR207">2003b</xref>),<disp-formula id="Equ88"><label>88</label><alternatives><mml:math display="block" id="Equ88_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{ij} = D_{\perp }\delta _{ij} + (D_{\parallel } - D_{\perp })b_ib_j \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ88.gif"/></alternatives></disp-formula>with normalised components of the magnetic field, <inline-formula id="IEq344"><alternatives><mml:math id="IEq344_Math"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq344_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i=B_i/|{\varvec{ B }}|$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq344.gif"/></alternatives></inline-formula>. The dependency on momentum is expressed as<disp-formula id="Equ89"><label>89</label><alternatives><mml:math display="block" id="Equ89_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mfrac></mml:mfenced><mml:mi>α</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{\parallel }(p)&amp;= D_{\parallel ,10} \left( \frac{p}{p_{10}}\right) ^{\alpha } , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ89.gif"/></alternatives></disp-formula><disp-formula id="Equ90"><label>90</label><alternatives><mml:math display="block" id="Equ90_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo>⊥</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mfrac></mml:mfenced><mml:mi>α</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{\perp }(p)&amp;= D_{\perp ,10} \left( \frac{p}{p_{10}}\right) ^{\alpha }, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ90.gif"/></alternatives></disp-formula>with <inline-formula id="IEq345"><alternatives><mml:math id="IEq345_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="normal">GeV</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq345_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{10} = 10\,\mathrm {GeV/c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq345.gif"/></alternatives></inline-formula>. Parallel and perpendicular diffusion coefficients with respect to the magnetic field are denoted as <inline-formula id="IEq346"><alternatives><mml:math id="IEq346_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq346_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{\parallel ,10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq346.gif"/></alternatives></inline-formula> and <inline-formula id="IEq347"><alternatives><mml:math id="IEq347_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo>⊥</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq347_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{\perp ,10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq347.gif"/></alternatives></inline-formula>. Equation (<xref rid="Equ86" ref-type="disp-formula">86</xref>) can be solved directly by replacing the individual components yielding<disp-formula id="Equ91"><label>91</label><alternatives><mml:math display="block" id="Equ91_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">diff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mspace width="0.166667em"/><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>13</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mi>f</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>22</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>23</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mi>f</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>D</mml:mi><mml:mn>31</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>32</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>33</mml:mn></mml:msub><mml:msub><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mi>f</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\partial _t n_\mathrm {diff}  =4\pi \,{\varvec{\nabla }}{\varvec{\cdot }}\,\int _{p_1}^{p_2}\,p^2\,\left[ \begin{array}{c} D_{11}\partial _xf + D_{12}\partial _yf + D_{13}\partial _zf\\ D_{21}\partial _xf + D_{22}\partial _yf + D_{23}\partial _zf\\ D_{31}\partial _xf + D_{32}\partial _yf + D_{33}\partial _zf \end{array}\right] \,{\mathrm {d}}p. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ91.gif"/></alternatives></disp-formula>Here, <inline-formula id="IEq348"><alternatives><mml:math id="IEq348_Math"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∂</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:math><tex-math id="IEq348_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _k=\partial /\partial k$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq348.gif"/></alternatives></inline-formula> is the partial derivative with <inline-formula id="IEq349"><alternatives><mml:math id="IEq349_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq349_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\in \{x, y, z\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq349.gif"/></alternatives></inline-formula>, so the spatial derivatives of <italic>f</italic> need to be taken into account. Alternatively, we can write<disp-formula id="Equ92"><label>92</label><alternatives><mml:math display="block" id="Equ92_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="normal">diff</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">cr</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial n_\mathrm {diff}}{\partial t}&amp;=\int _{p_1}^{p_2} 4\pi {\varvec{\nabla }}{\varvec{\cdot }}({{\mathbf {\mathsf{{D}}}}}_n{\varvec{\cdot }}{\varvec{\nabla }}f)p^2\,{\mathrm {d}}p\nonumber \\&amp;= {\varvec{\nabla }}{\varvec{\cdot }}\left( \left\langle {{\mathbf {\mathsf{{D}}}}}_n\right\rangle {\varvec{\cdot }}{\varvec{\nabla }}n_{cr}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ92.gif"/></alternatives></disp-formula>where the equation formally takes the form of a simple diffusion equation with only a modified diffusion tensor <inline-formula id="IEq350"><alternatives><mml:math id="IEq350_Math"><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:math><tex-math id="IEq350_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle {{\mathbf {\mathsf{{D}}}}}_n\right\rangle $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq350.gif"/></alternatives></inline-formula>. The individual components of the diffusion tensor take the form<disp-formula id="Equ93"><label>93</label><alternatives><mml:math display="block" id="Equ93_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\langle D_{n,ij}\right\rangle = \frac{\int _{p_1}^{p_2} p^2\,D_{ij}\,\partial _j f\,{\mathrm {d}}p}{\int _{p_1}^{p_2} p^2 \partial _j f\,{\mathrm {d}}p} . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ93.gif"/></alternatives></disp-formula>For <inline-formula id="IEq351"><alternatives><mml:math id="IEq351_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq351_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{ij}=D'_{ij}(p/p_{10})^\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq351.gif"/></alternatives></inline-formula> we find<disp-formula id="Equ94"><label>94</label><alternatives><mml:math display="block" id="Equ94_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:mfrac><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\langle D_{n,ij}\right\rangle = \frac{D'_{ij}}{p_{10}^\alpha }\,\frac{\int _{p_1}^{p_2} p^{2+\alpha }\partial _j f\,{\mathrm {d}}p}{\int _{p_1}^{p_2} p^2 \partial _j f\,{\mathrm {d}}p} . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ94.gif"/></alternatives></disp-formula>In an analogous way we treat the energy density,<disp-formula id="Equ95"><label>95</label><alternatives><mml:math display="block" id="Equ95_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">diff</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _t e_\mathrm {diff}&amp;= \int _{p_1}^{p_2} 4\pi {\varvec{\nabla }}{\varvec{\cdot }}({{\mathbf {\mathsf{{D}}}}}{\varvec{\cdot }}{\varvec{\nabla }}f)p^2T(p)\,{\mathrm {d}}p\nonumber \\&amp;=4\pi {\varvec{\nabla }}{\varvec{\cdot }}\left[ \int _{p_1}^{p_2} p^2T(p) {{\mathbf {\mathsf{{D}}}}}{\varvec{\cdot }}{\varvec{\nabla }}f\,{\mathrm {d}}p\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ95.gif"/></alternatives></disp-formula>with the modified diffusion coefficients<disp-formula id="Equ96"><label>96</label><alternatives><mml:math display="block" id="Equ96_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\langle D_{e,ij}\right\rangle = \frac{\int _{p_1}^{p_2} p^2T(p)\,D_{ij}\,\partial _j f\,{\mathrm {d}}p}{\int _{p_1}^{p_2} p^2T(p) \partial _j f\,{\mathrm {d}}p}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ96.gif"/></alternatives></disp-formula>which can be rewritten to include the scaling with momentum<disp-formula id="Equ97"><label>97</label><alternatives><mml:math display="block" id="Equ97_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="〉" open="〈"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:mfrac><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\langle D_{e,ij}\right\rangle = \frac{D'_{ij}}{p_{10}^\alpha }\,\frac{\int _{p_1}^{p_2} p^{2+\alpha }T(p)\partial _j f\,{\mathrm {d}}p}{\int _{p_1}^{p_2} p^2T(p) \partial _j f\,{\mathrm {d}}p}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ97.gif"/></alternatives></disp-formula>The full computation of the spectrally resolved diffusion involves many derivatives and introduces numerical errors. The usual approach of applying limiters is a very powerful method for conserved quantities. For a simple numerical representation of the particle distribution function, e.g. a piecewise constant representation, a limiter can simply be applied. But if more complex representations are chosen like piecewise powerlaws as in e.g. Girichidis et al. (<xref ref-type="bibr" rid="CR80">2019</xref>), the derivatives include the terms that scale with the spatial derivative of the amplitude as well as the derivative of the slope. Applying limiters to those individual terms are not simply applicable as the quantities are not conserved. A simple approximate solution to the full problem described above is derived in Jones and Kang (<xref ref-type="bibr" rid="CR115">2005</xref>), where the number density weighted diffusion coefficient reads<disp-formula id="Equ98"><label>98</label><alternatives><mml:math display="block" id="Equ98_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>D</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">⇒</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mi>D</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{n_{i}}=\frac{\int _{p_{i}}^{p_{i+1}} p^{2} D \frac{\partial f}{\partial x} \mathrm {d} p}{\int _{p_{i}}^{p_{i+1}} p^{2} \frac{\partial f}{\partial x} \mathrm {d} p} \Rightarrow \frac{\int _{p_{i}}^{p_{i+1}} D f p^{2} \mathrm {d} p}{n_{i}} . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ98.gif"/></alternatives></disp-formula>The corresponding energy weighted counterpart can be expressed as<disp-formula id="Equ99"><label>99</label><alternatives><mml:math display="block" id="Equ99_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mi>D</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">⇒</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mi>D</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_{g_{i}}=\frac{\int _{p_{i}}^{p_{i+1}} D \frac{\partial f}{\partial x} p^{3} \mathrm {d} p}{\int _{p_{i}}^{p_{i+1}} \frac{\partial f}{\partial x} p^{3} \mathrm {d} p} \Rightarrow \frac{\int _{p_{i}}^{p_{i+1}} D f p^{3} \mathrm {d} p}{g_{i}} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ99.gif"/></alternatives></disp-formula>with <inline-formula id="IEq352"><alternatives><mml:math id="IEq352_Math"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mfenced close="〉" open="〈"><mml:mi>D</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msubsup><mml:mi>p</mml:mi><mml:mi>D</mml:mi><mml:mi>f</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq352_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{i}\left\langle D / p^{2}\right\rangle _{i}=\int _{p_{i}}^{p_{i+1}} p D f \mathrm {d} p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq352.gif"/></alternatives></inline-formula> .</p></sec></sec><sec id="Sec35"><title>Numerical details</title><sec id="Sec36"><title>Numerical treatment of CR diffusion</title><p id="Par164">Numerically solving diffusive CR transport faces two main challenges. First of all, the diffusion equation is an elliptic PDE, which means that the solution propagates infinitely fast, i.e. the domain of dependence is the entire domain. Ideally, one would like to solve the diffusion equation with an implicit algorithm including the entire domain. However, this is numerically demanding and approximate solutions are favoured. The solution using an explicit algorithm requires to satisfy the explicit von Neumann stability criterion with a maximum integration time step<disp-formula id="Equ100"><label>100</label><alternatives><mml:math display="block" id="Equ100_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="4pt"/><mml:msub><mml:mi>C</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>D</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta t_\mathrm {max} = 0.5 \ C_{\text {cr} } \frac{\varDelta x^2}{D}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ100.gif"/></alternatives></disp-formula>where <inline-formula id="IEq353"><alternatives><mml:math id="IEq353_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><tex-math id="IEq353_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq353.gif"/></alternatives></inline-formula> is the resolution of an individual cell and <italic>D</italic> is the diffusion coefficient. The second complication is that the diffusion of CRs is highly anisotropic with the largest diffusion parallel to the magnetic field lines. The diffusion coefficient thus extends to a diffusion tensor, with coefficients describing the orientation of a flow with respect to the magnetic field orientation. For an explicit algorithm the time step criterion changes to<disp-formula id="Equ101"><label>101</label><alternatives><mml:math display="block" id="Equ101_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="4pt"/><mml:msub><mml:mi>C</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mspace width="4pt"/><mml:mfrac><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>Δ</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta t_\mathrm {max} = 0.5 \ C_{\text {cr} } \ \frac{\min (\varDelta x,\varDelta y, \varDelta z)^2}{D_{\parallel } + D_{\perp }} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ101.gif"/></alternatives></disp-formula>in the case of a dimensional split numerical scheme, where <inline-formula id="IEq354"><alternatives><mml:math id="IEq354_Math"><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub></mml:math><tex-math id="IEq354_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\parallel $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq354.gif"/></alternatives></inline-formula> and <inline-formula id="IEq355"><alternatives><mml:math id="IEq355_Math"><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub></mml:math><tex-math id="IEq355_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\perp $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq355.gif"/></alternatives></inline-formula> are the parallel and perpendicular diffusion coefficients, repsectively, and <inline-formula id="IEq356"><alternatives><mml:math id="IEq356_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq356_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\text {cr} } &lt; 1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq356.gif"/></alternatives></inline-formula> is the Courant number (e.g. Hanasz and Lesch <xref ref-type="bibr" rid="CR89">2003</xref>). In the case of an unsplit scheme the numerical coefficient changes to 0.3. Whereas the implicit solution for isotropic diffusion can simply be computed using the Green’s function, the anisotropic case does not have a simple form of the Green’s function. Therefore, iterative methods are used.</p></sec><sec id="Sec37"><title>Anisotropic diffusion on a regular mesh</title><p id="Par165">In this section we present details of the implementation of the anisotropic diffusion algorithm presented by Hanasz and Lesch (<xref ref-type="bibr" rid="CR89">2003</xref>). The algorithm has been designed for the staggered mesh setup of the ZEUS-3D MHD code, with the MHD algorithm involving the constraint transport (CT) (Evans &amp; Hawley <xref ref-type="bibr" rid="CR1011">1988</xref>) method to ensure the divergence-free evolution of the magnetic field. The staggered mesh locates the individual components of the magnetic field on different faces of grid cells: <inline-formula id="IEq357"><alternatives><mml:math id="IEq357_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq357_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq357.gif"/></alternatives></inline-formula> on <italic>yz</italic> faces, <inline-formula id="IEq358"><alternatives><mml:math id="IEq358_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><tex-math id="IEq358_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq358.gif"/></alternatives></inline-formula> on <italic>xz</italic> faces and <inline-formula id="IEq359"><alternatives><mml:math id="IEq359_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:math><tex-math id="IEq359_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_z$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq359.gif"/></alternatives></inline-formula> on <italic>xy</italic>. The CR energy density is located in cell centers and fluxes of CRs are located on cell faces. Different centering of the relevant quantities implies the need of interpolation ensuring numerical stability of the anisotropic diffusion algorithm.</p><p id="Par166">The CR diffusion tensor <inline-formula id="IEq360"><alternatives><mml:math id="IEq360_Math"><mml:mi mathvariant="sans-serif">D</mml:mi></mml:math><tex-math id="IEq360_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{D}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq360.gif"/></alternatives></inline-formula> depends on the spatially variable magnetic field <inline-formula id="IEq361"><alternatives><mml:math id="IEq361_Math"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><tex-math id="IEq361_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ B }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq361.gif"/></alternatives></inline-formula>. Let us consider the diffusive part of the diffusion–advection equation (<xref rid="Equ37" ref-type="disp-formula">37</xref>) with the diffusion tensor given by Eq. (<xref rid="Equ88" ref-type="disp-formula">88</xref>):<disp-formula id="Equ102"><label>102</label><alternatives><mml:math display="block" id="Equ102_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _t e_{\text {cr} } + {\varvec{ \nabla }} \cdot {\varvec{ F_{\text {cr} } }} = 0,\qquad {\varvec{ F_{\text {cr} } }} = -{{\mathbf {\mathsf{{D}}}}} {\varvec{ \nabla }} e_{\text {cr} }. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ102.gif"/></alternatives></disp-formula>In the discrete representation, the 3-dimensional conservation law reads<disp-formula id="Equ103"><label>103</label><alternatives><mml:math display="block" id="Equ103_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{ll} e_{\text {cr} ,i,j,k}^{n+1}&amp;=e_{\text {cr} ,i,j,k}^n -\frac{\varDelta t}{\varDelta x} \left( F_{\text {cr} ,i+\frac{1}{2},j,k}-F_{\text {cr} ,i-\frac{1}{2},j,k} \right) \\ &amp;\quad -\frac{\varDelta t}{\varDelta y} \left( F_{\text {cr} ,i,j+\frac{1}{2},k}-F_{\text {cr} ,i,j-\frac{1}{2},k} \right) \\ &amp;\quad -\frac{\varDelta t}{\varDelta z} \left( F_{\text {cr} ,i,j,k+\frac{1}{2}}-F_{\text {cr} ,i,j,k-\frac{1}{2}} \right) , \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ103.gif"/></alternatives></disp-formula>where <inline-formula id="IEq362"><alternatives><mml:math id="IEq362_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math><tex-math id="IEq362_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} ,i,j,k}^n $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq362.gif"/></alternatives></inline-formula> and <inline-formula id="IEq363"><alternatives><mml:math id="IEq363_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq363_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} ,i,j,k}^{n+1} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq363.gif"/></alternatives></inline-formula> are volume averaged CR energy densities in the cell <italic>i</italic>, <italic>j</italic>, <italic>k</italic>, and <inline-formula id="IEq364"><alternatives><mml:math id="IEq364_Math"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq364_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{\text {cr} ,i-\frac{1}{2},j,k}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq364.gif"/></alternatives></inline-formula>, <inline-formula id="IEq365"><alternatives><mml:math id="IEq365_Math"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq365_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{\text {cr} ,i+\frac{1}{2},j,k}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq365.gif"/></alternatives></inline-formula> are the CR fluxes through the left and right cell boundaries, in <italic>x</italic>-direction. The fluxes appearing in equation (<xref rid="Equ103" ref-type="disp-formula">103</xref>) should be understood as time-averaged fluxes through respective cell boundaries. If we approximate these fluxes by their values computed at the time–level <inline-formula id="IEq366"><alternatives><mml:math id="IEq366_Math"><mml:msup><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math><tex-math id="IEq366_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t^n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq366.gif"/></alternatives></inline-formula>, then we obtain an explicit algorithm for the numerical integration of the CR diffusion equation. To compute the diffusion tensor components at cell faces, we need all components of the unit vector <inline-formula id="IEq367"><alternatives><mml:math id="IEq367_Math"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:math><tex-math id="IEq367_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ n }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq367.gif"/></alternatives></inline-formula>, parallel to <inline-formula id="IEq368"><alternatives><mml:math id="IEq368_Math"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><tex-math id="IEq368_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ B }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq368.gif"/></alternatives></inline-formula> at each cell face. We start with computing magnetic field aligned unit vectors at cell–faces perpendicular to the <italic>x</italic>-axis:<disp-formula id="Equ104"><label>104</label><alternatives><mml:math display="block" id="Equ104_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ b }}_{i-\frac{1}{2},j,k} = \frac{\varvec{{\bar{B}}}_{i-\frac{1}{2},j,k} }{|\varvec{{\bar{B}}}_{i-\frac{1}{2},j,k}| }, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ104.gif"/></alternatives></disp-formula>and then do the same for the other faces. The magnetic field component <inline-formula id="IEq369"><alternatives><mml:math id="IEq369_Math"><mml:msup><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:math><tex-math id="IEq369_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B^x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq369.gif"/></alternatives></inline-formula> is already located at proper faces, but the location of <inline-formula id="IEq370"><alternatives><mml:math id="IEq370_Math"><mml:msup><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msup></mml:math><tex-math id="IEq370_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B^y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq370.gif"/></alternatives></inline-formula> and <inline-formula id="IEq371"><alternatives><mml:math id="IEq371_Math"><mml:msup><mml:mi>B</mml:mi><mml:mi>z</mml:mi></mml:msup></mml:math><tex-math id="IEq371_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B^z$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq371.gif"/></alternatives></inline-formula> is different, thus an interpolation is necessary. The linearly interpolated magnetic field vector located at <inline-formula id="IEq372"><alternatives><mml:math id="IEq372_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq372_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(x_{i-\frac{1}{2}},y_j,z_k)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq372.gif"/></alternatives></inline-formula> is therefore<disp-formula id="Equ105"><label>105</label><alternatives><mml:math display="block" id="Equ105_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced open="["><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="]"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi>z</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi>z</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi>z</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi>z</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\bar{\varvec{B}}}_{i-\frac{1}{2},j,k}= &amp; {} \left[ B^x_{i-\frac{1}{2}, j, k}, \frac{1}{4}\left( B^y_{i-1,j-\frac{1}{2},k}+B^y_{i,j-\frac{1}{2},k}+B^y_{i-1,j+\frac{1}{2},k}+B^y_{i,j+\frac{1}{2},k}\right) \right. ,\nonumber \\&amp;\left. \frac{1}{4}\left( B^z_{i-1,j,k-\frac{1}{2}}+B^z_{i,j,k-\frac{1}{2}}+B^z_{i-1,j,k+\frac{1}{2}}+B^z_{i,j,k+\frac{1}{2}}\right) \right] .\end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ105.gif"/></alternatives></disp-formula>The interpolation scheme for <inline-formula id="IEq373"><alternatives><mml:math id="IEq373_Math"><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><tex-math id="IEq373_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq373.gif"/></alternatives></inline-formula>, at the cell–face perpendicular to <italic>x</italic>-axis, is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Interpolation of magnetic–field components to cell–faces shown in 2D projection onto <italic>xy</italic>–plane</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig7_HTML.png" id="MO112"/></fig></p><p id="Par167">To compute the diffusive fluxes of CRs across cell faces, one needs all components of the CR energy density gradient at each cell face. The components of <inline-formula id="IEq374"><alternatives><mml:math id="IEq374_Math"><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq374_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla {e_{\text {cr} }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq374.gif"/></alternatives></inline-formula>, perpendicular to cell faces, are centered at cell–faces, e.g.:<disp-formula id="Equ106"><label>106</label><alternatives><mml:math display="block" id="Equ106_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \partial _x e_{\text {cr} } \right) _{(i-\frac{1}{2},j,k)} \simeq \frac{1}{\varDelta x} (e_{{\text {cr} },i,j,k} - e_{{\text {cr} },i-1,j,k}), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ106.gif"/></alternatives></disp-formula>however, an interpolation is needed for the remaining components of CR energy–density gradient. The procedure follows in three steps, as depicted in Fig. <xref rid="Fig8" ref-type="fig">8</xref>: <list list-type="order"><list-item><p id="Par168">interpolation of <inline-formula id="IEq375"><alternatives><mml:math id="IEq375_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq375_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq375.gif"/></alternatives></inline-formula> to centers of cell faces (1)</p></list-item><list-item><p id="Par169">computation of left– and right finite differences of <inline-formula id="IEq376"><alternatives><mml:math id="IEq376_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq376_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq376.gif"/></alternatives></inline-formula>, with respect to coordinates parallel to cell faces, at positions (2) <disp-formula id="Equ107"><label>107</label><alternatives><mml:math display="block" id="Equ107_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _{y,l} e_{\text {cr} } \equiv \frac{1}{2\varDelta y}\left( (e_{{\text {cr} },i-1,j ,k} {+} e_{{\text {cr} },i ,j ,k }) {-} (e_{{\text {cr} },i-1,j-1,k} {+} e_{{\text {cr} },i ,j-1,k})\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ107.gif"/></alternatives></disp-formula><disp-formula id="Equ108"><label>108</label><alternatives><mml:math display="block" id="Equ108_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _{y,r} e_{\text {cr} } \equiv \frac{1}{2\varDelta y}\left( (e_{{\text {cr} },i-1,j+1,k} {+} e_{{\text {cr} },i ,j+1,k}) {-}(e_{{\text {cr} },i-1,j ,k}{+} e_{{\text {cr} },i ,j ,k})\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ108.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par170">computation of face–centered slopes at positions (3) monotonized with the aid of van Leer slope limiter <disp-formula id="Equ109"><label>109</label><alternatives><mml:math display="block" id="Equ109_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">sign</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \partial _y {e_{\text {cr} }}\right) _{(i-\frac{1}{2},j,k)}\simeq {\frac{1}{4}\left( \partial _{y,l} e_{\text {cr} }+\partial _{y,r} e_{\text {cr} }) (1 + \mathrm{sign}(1, \partial _{y,l} e_{\text {cr} } \ \partial _{y,r} e_{\text {cr} })\right) }. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ109.gif"/></alternatives></disp-formula></p></list-item></list>We note that the monotonization of <inline-formula id="IEq377"><alternatives><mml:math id="IEq377_Math"><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq377_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq377.gif"/></alternatives></inline-formula> components (step 3.), parallel to the considered cell faces, is essential for stability of the overall (CR+MHD) algorithm.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Computation of the monotonized <inline-formula id="IEq378"><alternatives><mml:math id="IEq378_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq378_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq378.gif"/></alternatives></inline-formula> gradient components, shown in 2D projection onto <italic>xy</italic>–plane</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig8_HTML.png" id="MO117"/></fig></p><p id="Par171">The same procedure is applied to get the monotonized slope of <inline-formula id="IEq379"><alternatives><mml:math id="IEq379_Math"><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:math><tex-math id="IEq379_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq379.gif"/></alternatives></inline-formula> in the <italic>z</italic>–direction.<disp-formula id="Equ110"><label>110</label><alternatives><mml:math display="block" id="Equ110_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>∂</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">sign</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mi>∂</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \partial _z {e_{\text {cr} }}\right) _{(i-\frac{1}{2},j,k)}\simeq \frac{1}{4}\left( \partial _{z,l} e_{\text {cr} }+\partial _{z,r} e_{\text {cr} }) (1 + \mathrm{sign}(1, \partial _{z,l} e_{\text {cr} } \ \partial _{z,r} e_{\text {cr} })\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ110.gif"/></alternatives></disp-formula>Computation of <inline-formula id="IEq380"><alternatives><mml:math id="IEq380_Math"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq380_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\varvec{\nabla }}e_{\text {cr} })_{i,j-\frac{1}{2},k}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq380.gif"/></alternatives></inline-formula> and <inline-formula id="IEq381"><alternatives><mml:math id="IEq381_Math"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq381_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\varvec{\nabla }}e_{\text {cr} })_{i,j,k-\frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq381.gif"/></alternatives></inline-formula> follows in the analogous way.</p><p id="Par172">Another variant of transverse flux computation, designed to avoid negative CR energy densities when there is a large gradient, has been applied by Yang et al. (<xref ref-type="bibr" rid="CR280">2012</xref>) following Sharma and Hammett (<xref ref-type="bibr" rid="CR218">2007</xref>). Their implementation relies on a double use of one of the slope-limiters such as minmod, van Leer or monotonized central (MC) limiter.</p><p id="Par173">At this point we are ready to compute all CR–fluxes <inline-formula id="IEq382"><alternatives><mml:math id="IEq382_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mtext>cr</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>cr</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq382_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ F }}_{\text {cr} } = -{{\mathbf {\mathsf{{D}}}}} {\varvec{\nabla }}e_{\text {cr} }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq382.gif"/></alternatives></inline-formula> at all cell–faces. We apply the directional–splitting technique to compute the total diffusive change of CR–energy density, in a single timestep. Subsequent updates of CR–energy density proceed in a directionally split manner:<disp-formula id="Equ111"><label>111</label><alternatives><mml:math display="block" id="Equ111_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_{\text {cr} ,i,j,k}^{n+b}=e_{\text {cr} ,i,j,k}^{n+a}-\frac{\varDelta t}{\varDelta x} \left[ F_{\text {cr} ,i+\frac{1}{2},j,k}-F_{\text {cr} ,i-\frac{1}{2},j,k} \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ111.gif"/></alternatives></disp-formula><disp-formula id="Equ112"><label>112</label><alternatives><mml:math display="block" id="Equ112_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_{\text {cr} ,i,j,k}^{n+c}=e_{\text {cr} ,i,j,k}^{n+b}-\frac{\varDelta t}{\varDelta y} \left[ F_{\text {cr} ,i,j+\frac{1}{2},k}-F_{\text {cr} ,i,j-\frac{1}{2},k} \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ112.gif"/></alternatives></disp-formula><disp-formula id="Equ113"><label>113</label><alternatives><mml:math display="block" id="Equ113_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_{\text {cr} ,i,j,k}^{n+1}=e_{\text {cr} ,i,j,k}^{n+c}-\frac{\varDelta t}{\varDelta z} \left[ F_{\text {cr} ,i,j,k+\frac{1}{2}}-F_{\text {cr} ,i,j,k-\frac{1}{2}} \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ113.gif"/></alternatives></disp-formula>where <inline-formula id="IEq383"><alternatives><mml:math id="IEq383_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq383_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} ,i,j,k}^{n+a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq383.gif"/></alternatives></inline-formula> is CR-energy density after the advection step, <inline-formula id="IEq384"><alternatives><mml:math id="IEq384_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq384_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} ,i,j,k}^{n+b}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq384.gif"/></alternatives></inline-formula> and <inline-formula id="IEq385"><alternatives><mml:math id="IEq385_Math"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>cr</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq385_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\text {cr} ,i,j,k}^{n+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq385.gif"/></alternatives></inline-formula> are CR-energy densities after these quantities have been updated in <italic>x</italic> and <italic>y</italic>-directions, respectively</p><p id="Par174">For more recent models of finite difference and finite volume algorithms for anisotropic diffusion we would like to point to van Es et al. (<xref ref-type="bibr" rid="CR257">2014</xref>, <xref ref-type="bibr" rid="CR258">2016</xref>).</p><sec id="Sec38"><title>A semi-implicit extension</title><p id="Par175">Sharma and Hammett (<xref ref-type="bibr" rid="CR219">2011</xref>) consider purely parallel diffusion along the magnetic field lines, i.e. <inline-formula id="IEq386"><alternatives><mml:math id="IEq386_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq386_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\perp =0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq386.gif"/></alternatives></inline-formula>,<disp-formula id="Equ114"><label>114</label><alternatives><mml:math display="block" id="Equ114_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial e}{\partial t}&amp; =- {\varvec{\nabla }}\cdot {\varvec{ q }}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ114.gif"/></alternatives></disp-formula><disp-formula id="Equ115"><label>115</label><alternatives><mml:math display="block" id="Equ115_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:msub><mml:mi mathvariant="normal">∇</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ q }} &amp;=- D_\parallel {\varvec{ b }} ({\varvec{ b }}\cdot {\varvec{\nabla }}) e= - D_\parallel {\varvec{ b }} \nabla _\parallel e, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ115.gif"/></alternatives></disp-formula>Defining the components of the diffusion operator on the right hand side of Eq. (<xref rid="Equ114" ref-type="disp-formula">114</xref>) as<disp-formula id="Equ116"><label>116</label><alternatives><mml:math display="block" id="Equ116_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\mathbf {\mathsf{{D}}}}}_{ij} = - \frac{\partial }{ \partial x_i} \left( D_\parallel b_i b_j \frac{\partial }{\partial x_j} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ116.gif"/></alternatives></disp-formula>then the method can be formulated as<disp-formula id="Equ117"><label>117</label><alternatives><mml:math display="block" id="Equ117_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="italic">yy</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="italic">yx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="sans-serif">D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e^{n+1} = (1+\varDelta t {{\mathbf {\mathsf{{D}}}}}_{yy})^{-1} (1-\varDelta t {{\mathbf {\mathsf{{D}}}}}_{yx}) (1+\varDelta t {{\mathbf {\mathsf{{D}}}}}_{xx})^{-1} (1 - \varDelta t {{\mathbf {\mathsf{{D}}}}}_{xy}) e^{n}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ117.gif"/></alternatives></disp-formula>An extension to adaptive mesh refinement using an implicit scheme was introduced by Dubois and Commerçon (<xref ref-type="bibr" rid="CR50">2016</xref>) in the <sc>Ramses</sc> code (Teyssier <xref ref-type="bibr" rid="CR249">2002</xref>). In their algorithm the general anisotropic diffusion is split into an isotropic component and a component parallel to the magnetic field,<disp-formula id="Equ118"><label>118</label><alternatives><mml:math display="block" id="Equ118_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>e</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">iso</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial e}{\partial t}=-{\varvec{\nabla }}\left( -D_{\parallel }{\varvec{ b }} ({\varvec{ b }}{\varvec{\nabla }}) e\right) -{\varvec{\nabla }}\left( -D_\mathrm{iso}{\varvec{\nabla }}e\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ118.gif"/></alternatives></disp-formula>The updated CR energy in cell <italic>i</italic>, <italic>j</italic> is given (in 2D) by<disp-formula id="Equ119"><label>119</label><alternatives><mml:math display="block" id="Equ119_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e^{n+1}_{i,j}+\varDelta t \frac{F^{n+1}_{i+\frac{1}{2},j}+F^{n+1}_{i,j+\frac{1}{2}} - F^{n+1}_{i-\frac{1}{2},j} - F^{n+1}_{i,j-\frac{1}{2}}}{\varDelta x}= e^{n}_{i,j}\, , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ119.gif"/></alternatives></disp-formula>for cell position <italic>i</italic>, <italic>j</italic>. These quantities are evaluated with the centred symmetric scheme proposed by Günter et al. (<xref ref-type="bibr" rid="CR86">2005</xref>) for the anisotropic part of the flux. The anisotropic flux at cell interfaces <inline-formula id="IEq387"><alternatives><mml:math id="IEq387_Math"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:math><tex-math id="IEq387_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F^\mathrm{ani}_{i\pm 1/2,j}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq387.gif"/></alternatives></inline-formula> and <inline-formula id="IEq388"><alternatives><mml:math id="IEq388_Math"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:math><tex-math id="IEq388_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F^\mathrm{ani}_{i,j\pm 1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq388.gif"/></alternatives></inline-formula> are evaluated from their cell corner fluxes <inline-formula id="IEq389"><alternatives><mml:math id="IEq389_Math"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:math><tex-math id="IEq389_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F^\mathrm{ani}_{i\pm 1/2,j\pm 1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq389.gif"/></alternatives></inline-formula>, thus<disp-formula id="Equ160"><alternatives><mml:math display="block" id="Equ160_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F^\mathrm{ani}_{i+\frac{1}{2},j}&amp;=  \frac{F^\mathrm{ani}_{i+\frac{1}{2},j-\frac{1}{2}} + F^\mathrm{ani}_{i+\frac{1}{2},j+\frac{1}{2}}}{2}\, , \\ F^\mathrm{ani}_{i,j+\frac{1}{2}}&amp;= \frac{F^\mathrm{ani}_{i-\frac{1}{2},j+\frac{1}{2}} + F^\mathrm{ani}_{i+\frac{1}{2},j+\frac{1}{2}}}{2}\,. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ160.gif"/></alternatives></disp-formula>The anisotropic cell corner flux is<disp-formula id="Equ120"><label>120</label><alternatives><mml:math display="block" id="Equ120_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mi mathvariant="normal">ani</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>x</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>x</mml:mi></mml:msub><mml:mover accent="true"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>y</mml:mi></mml:msub><mml:mover accent="true"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F^\mathrm{ani}_{i+\frac{1}{2},j+\frac{1}{2}}={\bar{\kappa }}_{\parallel } {{\bar{b}}}_{x} \left( {{\bar{b}}}_{x} \bar{\frac{\partial e}{\partial x}} + {{\bar{b}}}_{y} \bar{ \frac{ \partial e}{\partial y} }\right) \, , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ120.gif"/></alternatives></disp-formula>where barred quantities are arithmetic averages over the cells connected to the corner.</p><p id="Par176">The authors use the diffusion algorithm introduced in Commerçon et al. (<xref ref-type="bibr" rid="CR38">2014</xref>) including AMR and adaptive time-stepping on a level-by-level basis. Each refinement level <inline-formula id="IEq390"><alternatives><mml:math id="IEq390_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq390_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq390.gif"/></alternatives></inline-formula> is evolved with a corresponding time step <inline-formula id="IEq391"><alternatives><mml:math id="IEq391_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mi>ℓ</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq391_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t^\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq391.gif"/></alternatives></inline-formula>, where each time step is twice as large for each coarser level <inline-formula id="IEq392"><alternatives><mml:math id="IEq392_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq392_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq392.gif"/></alternatives></inline-formula>, <inline-formula id="IEq393"><alternatives><mml:math id="IEq393_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mi>ℓ</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq393_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t^\ell =\varDelta t^{\ell -1}/2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq393.gif"/></alternatives></inline-formula>. This means that level <inline-formula id="IEq394"><alternatives><mml:math id="IEq394_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq394_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq394.gif"/></alternatives></inline-formula> evolves with two consecutive time steps before one time step of level <inline-formula id="IEq395"><alternatives><mml:math id="IEq395_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq395_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq395.gif"/></alternatives></inline-formula> is applied. Each level of refinement <inline-formula id="IEq396"><alternatives><mml:math id="IEq396_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq396_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq396.gif"/></alternatives></inline-formula> is connected to two types of non-uniform interfaces, namely the fine-to-coarse interface (between level <inline-formula id="IEq397"><alternatives><mml:math id="IEq397_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq397_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq397.gif"/></alternatives></inline-formula> and <inline-formula id="IEq398"><alternatives><mml:math id="IEq398_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq398_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq398.gif"/></alternatives></inline-formula>) and the coarse-to-fine interface (between level <inline-formula id="IEq399"><alternatives><mml:math id="IEq399_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq399_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq399.gif"/></alternatives></inline-formula> and <inline-formula id="IEq400"><alternatives><mml:math id="IEq400_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq400_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell +1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq400.gif"/></alternatives></inline-formula>). Dubois and Commerçon (<xref ref-type="bibr" rid="CR50">2016</xref>) use Dirichlet boundary conditions, where the cell <italic>values</italic> at level boundaries are imposed. On the other hand, for Neumann boundary conditions the <italic>fluxes</italic> are imposed, which are needed to guarantee energy conservation similar to hydrodynamical solvers.</p><p id="Par177">At the interface from fine-to-coarse, Dubois and Commerçon (<xref ref-type="bibr" rid="CR50">2016</xref>) use the values of <inline-formula id="IEq401"><alternatives><mml:math id="IEq401_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq401_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq401.gif"/></alternatives></inline-formula> at time <italic>n</italic> as an imposed boundary condition for level <inline-formula id="IEq402"><alternatives><mml:math id="IEq402_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq402_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq402.gif"/></alternatives></inline-formula>. They use the minmod scheme (van Leer <xref ref-type="bibr" rid="CR259">1979</xref>) and interpolate the values of level <inline-formula id="IEq403"><alternatives><mml:math id="IEq403_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq403_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq403.gif"/></alternatives></inline-formula> on a finer virtual grid at level <inline-formula id="IEq404"><alternatives><mml:math id="IEq404_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq404_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq404.gif"/></alternatives></inline-formula> to determine the fine-to-coarse boundary. For the coarse-to-fine interface they use values of <inline-formula id="IEq405"><alternatives><mml:math id="IEq405_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq405_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell +1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq405.gif"/></alternatives></inline-formula> at time <inline-formula id="IEq406"><alternatives><mml:math id="IEq406_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq406_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq406.gif"/></alternatives></inline-formula> as the imposed boundary conditions for level <inline-formula id="IEq407"><alternatives><mml:math id="IEq407_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq407_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq407.gif"/></alternatives></inline-formula>. The value of the boundary coarse cell at level <inline-formula id="IEq408"><alternatives><mml:math id="IEq408_Math"><mml:mi>ℓ</mml:mi></mml:math><tex-math id="IEq408_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq408.gif"/></alternatives></inline-formula> is restricted to the average value of the <inline-formula id="IEq409"><alternatives><mml:math id="IEq409_Math"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">dim</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="IEq409_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{dim}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq409.gif"/></alternatives></inline-formula> cells of level <inline-formula id="IEq410"><alternatives><mml:math id="IEq410_Math"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq410_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell +1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq410.gif"/></alternatives></inline-formula> to impose the coarse-to-fine boundary. Equation <xref rid="Equ119" ref-type="disp-formula">119</xref> remains correct since the diffusion solver only deals with data estimated at the same level of refinement. The combination of Dirichlet boundary conditions at the level interfaces and the interpolation or restriction operations does not break the symmetry of matrix <italic>A</italic>. The imposed values of neighbouring cells at different levels of refinement enter the right-hand side (in vector <inline-formula id="IEq411"><alternatives><mml:math id="IEq411_Math"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><tex-math id="IEq411_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ c }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq411.gif"/></alternatives></inline-formula>) of the above matrix system <inline-formula id="IEq412"><alternatives><mml:math id="IEq412_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq412_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A{\varvec{ x }}={\varvec{ c }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq412.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec39"><title>Diffusion on a Voronoi mesh</title><p id="Par178">Pakmor et al. (<xref ref-type="bibr" rid="CR173">2016a</xref>) implement the diffusion of the CR strictly along the magnetic field lines<disp-formula id="Equ121"><label>121</label><alternatives><mml:math display="block" id="Equ121_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial e_\mathrm {cr}}{\partial t} - {\varvec{\nabla }}{\varvec{\cdot }}\left[ D_\parallel {\varvec{ b }} \left( {\varvec{ b }} {\varvec{\cdot }}{\varvec{\nabla }}e_\mathrm {cr} \right) \right] = 0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ121.gif"/></alternatives></disp-formula>with the CR energy density <inline-formula id="IEq413"><alternatives><mml:math id="IEq413_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq413_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_\mathrm {cr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq413.gif"/></alternatives></inline-formula> and the parallel diffusion coefficient <inline-formula id="IEq414"><alternatives><mml:math id="IEq414_Math"><mml:msub><mml:mi>D</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:msub></mml:math><tex-math id="IEq414_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\parallel $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq414.gif"/></alternatives></inline-formula>. Similar to Günter et al. (<xref ref-type="bibr" rid="CR86">2005</xref>) and Sharma and Hammett (<xref ref-type="bibr" rid="CR218">2007</xref>) they compute the gradient estimates at the centre of an interface between cells based on the gradient estimates at the corners. In three dimensions every corner of a Voronoi cell connects to four adjacent cells. The residual of the gradient fit reads<disp-formula id="Equ122"><label>122</label><alternatives><mml:math display="block" id="Equ122_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r_i = \phi \left( {\varvec{ c }} \right) + \left( {\varvec{\nabla }}\phi \right) \left( {\varvec{ s }}_i - {\varvec{ c }} \right) - \phi \left( {\varvec{ s }}_i \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ122.gif"/></alternatives></disp-formula>with the unknown value at the corner of a cell <inline-formula id="IEq415"><alternatives><mml:math id="IEq415_Math"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq415_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi \left( {\varvec{ c }} \right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq415.gif"/></alternatives></inline-formula>, the gradient at the corner position <inline-formula id="IEq416"><alternatives><mml:math id="IEq416_Math"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><tex-math id="IEq416_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ c }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq416.gif"/></alternatives></inline-formula>, <inline-formula id="IEq417"><alternatives><mml:math id="IEq417_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math><tex-math id="IEq417_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\nabla }}\phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq417.gif"/></alternatives></inline-formula>, and the value at the centre of the cell <inline-formula id="IEq418"><alternatives><mml:math id="IEq418_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq418_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ s }}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq418.gif"/></alternatives></inline-formula>, <inline-formula id="IEq419"><alternatives><mml:math id="IEq419_Math"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq419_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi ({\varvec{ s }}_i)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq419.gif"/></alternatives></inline-formula>. The residual can be rewritten in matrix form<disp-formula id="Equ123"><label>123</label><alternatives><mml:math display="block" id="Equ123_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">X</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ r }} = {{\mathbf {\mathsf{{X}}}}}{\varvec{ q }}-{\varvec{ Y }}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ123.gif"/></alternatives></disp-formula>where <inline-formula id="IEq420"><alternatives><mml:math id="IEq420_Math"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:math><tex-math id="IEq420_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ r }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq420.gif"/></alternatives></inline-formula>, <inline-formula id="IEq421"><alternatives><mml:math id="IEq421_Math"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow></mml:math><tex-math id="IEq421_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ q }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq421.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq422"><alternatives><mml:math id="IEq422_Math"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><tex-math id="IEq422_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ Y }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq422.gif"/></alternatives></inline-formula> are <italic>N</italic>-vectors (<inline-formula id="IEq423"><alternatives><mml:math id="IEq423_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq423_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq423.gif"/></alternatives></inline-formula>), and <inline-formula id="IEq424"><alternatives><mml:math id="IEq424_Math"><mml:mi mathvariant="sans-serif">X</mml:mi></mml:math><tex-math id="IEq424_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{X}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq424.gif"/></alternatives></inline-formula> is an <inline-formula id="IEq425"><alternatives><mml:math id="IEq425_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><tex-math id="IEq425_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\times N$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq425.gif"/></alternatives></inline-formula> matrix. The individual components are defined as<disp-formula id="Equ161"><alternatives><mml:math display="block" id="Equ161_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>ϕ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mfenced><mml:mrow><mml:mn>0</mml:mn><mml:mo>…</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>…</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>…</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} ({\varvec{ q }})_0= &amp; {} \phi \left( {\varvec{ c }} \right) ,\\ ({\varvec{ q }})_{1\ldots N-1}&amp;= \left( {\varvec{\nabla }}\phi \right) _{0\ldots N-2} ,\\ ({\varvec{ Y }})_i&amp;= \phi \left( {\varvec{ s }}_i \right) ,\\ ({{\mathbf {\mathsf{{X}}}}})_{i,0}&amp;= 1 ,\\ ({{\mathbf {\mathsf{{X}}}}})_{i,1\ldots N-2}&amp;= {\varvec{ s }}_{i,0\ldots N-2} - {\varvec{ c }}_{0\ldots N-2}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ161.gif"/></alternatives></disp-formula>The residual is then minimized by solving<disp-formula id="Equ124"><label>124</label><alternatives><mml:math display="block" id="Equ124_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width="4pt"/><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mfenced><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width="4pt"/><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( {{\mathbf {\mathsf{{X}}}}}^T\ {{\mathbf {\mathsf{{X}}}}} \right) {\varvec{ q }} = {{\mathbf {\mathsf{{X}}}}}^T\ {\varvec{ Y }}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ124.gif"/></alternatives></disp-formula>There is a unique solution for <inline-formula id="IEq426"><alternatives><mml:math id="IEq426_Math"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow></mml:math><tex-math id="IEq426_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ q }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq426.gif"/></alternatives></inline-formula> with zero residual because <inline-formula id="IEq427"><alternatives><mml:math id="IEq427_Math"><mml:mi mathvariant="sans-serif">X</mml:mi></mml:math><tex-math id="IEq427_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{X}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq427.gif"/></alternatives></inline-formula> is a square matrix. In order to solve for <inline-formula id="IEq428"><alternatives><mml:math id="IEq428_Math"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow></mml:math><tex-math id="IEq428_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ q }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq428.gif"/></alternatives></inline-formula> a multiplication with <inline-formula id="IEq429"><alternatives><mml:math id="IEq429_Math"><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width="4pt"/><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq429_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {{\mathbf {\mathsf{{X}}}}}^T\ {{\mathbf {\mathsf{{X}}}}} \right) ^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq429.gif"/></alternatives></inline-formula> from the left is used, which yields<disp-formula id="Equ125"><label>125</label><alternatives><mml:math display="block" id="Equ125_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mspace width="4pt"/><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{ q }} = {{\mathbf {\mathsf{{M}}}}} \ {\varvec{ Y }}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ125.gif"/></alternatives></disp-formula>with <inline-formula id="IEq430"><alternatives><mml:math id="IEq430_Math"><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mspace width="4pt"/><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq430_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{M}}}}} = \left( {{\mathbf {\mathsf{{X}}}}}^T\ {{\mathbf {\mathsf{{X}}}}} \right) ^{-1} \ {{\mathbf {\mathsf{{X}}}}}^T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq430.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq431"><alternatives><mml:math id="IEq431_Math"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><tex-math id="IEq431_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{M}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq431.gif"/></alternatives></inline-formula> only depends on the geometry of the mesh. The vector <inline-formula id="IEq432"><alternatives><mml:math id="IEq432_Math"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><tex-math id="IEq432_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ Y }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq432.gif"/></alternatives></inline-formula> only contains values at the cell centers. Therefore, <inline-formula id="IEq433"><alternatives><mml:math id="IEq433_Math"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><tex-math id="IEq433_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf {\mathsf{{M}}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq433.gif"/></alternatives></inline-formula> only needs to be computed once every timestep as the geometry of the mesh does not change. One can obtain the value as well as the gradient of any quantity at a corner from a simple matrix-vector multiplication. Moreover, Eq. (<xref rid="Equ125" ref-type="disp-formula">125</xref>) shows the linear dependence of the gradient at the corner on the values in the adjacent cells. This fact is needed for the implicit time integration.</p><p id="Par179">The estimate of the gradient is given by<disp-formula id="Equ126"><label>126</label><alternatives><mml:math display="block" id="Equ126_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:mfenced></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:msub></mml:mfenced></mml:mfrac></mml:mfenced><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi mathvariant="normal">face</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{\nabla }}e_{\mathrm {cr}\mathrm {,n}} = \frac{e_\mathrm {cr,L} - e_\mathrm {cr,R}}{ \left| {\varvec{ c }}_\mathrm {L} - {\varvec{ c }}_{\mathrm{R}} \right| } \left( \frac{ {\varvec{ c }}_{\mathrm {L}} - {\varvec{ c }}_{\mathrm{R}} }{ \left| {\varvec{ c }}_{\mathrm {L}} - {\varvec{ c }}_{\mathrm{R}} \right| }\right) {\varvec{\cdot }}{\varvec{ n }}_{\mathrm {face}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ126.gif"/></alternatives></disp-formula>The solution is obtained by a semi-implicit time integration,<disp-formula id="Equ127"><label>127</label><alternatives><mml:math display="block" id="Equ127_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">CR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} e_{{\mathrm {cr}},i}^{{\tilde{n}}} = e_{{\mathrm {cr}},i}^{n} + \frac{\varDelta t}{V_i} \sum _{j} D_{ij} \left( {\varvec{ b }}_{ij} {\varvec{\cdot }}{\varvec{\nabla }}e_{{\mathrm {CR,t}},ij}^{n} \right) {\varvec{ b }}_{ij} {\varvec{\cdot }}{\varvec{ n }}_{ij} A_{ij}. \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ127.gif"/></alternatives></disp-formula>In a second step, the CR energy is advanced according to the fluxes associated with the normal component of the CR energy density gradients computed at the interfaces. This is done with an implicit backward Euler step:<disp-formula id="Equ128"><label>128</label><alternatives><mml:math display="block" id="Equ128_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">CR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mfenced><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold">·</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} e_{{\mathrm {cr}},i}^{n+1} = e_{{\mathrm {cr}},i}^{{\tilde{n}}} + \frac{\varDelta t}{V_i} \sum _{j} D_{ij} \left( {\varvec{ b }}_{ij} {\varvec{\cdot }}{\varvec{\nabla }}e_{{\mathrm {CR,n}},ij}^{n+1} \right) {\varvec{ b }}_{ij} {\varvec{\cdot }}{\varvec{ n }}_{ij} A_{ij}. \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ128.gif"/></alternatives></disp-formula>The term <inline-formula id="IEq434"><alternatives><mml:math id="IEq434_Math"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">∇</mml:mi></mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cr</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq434_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\nabla }}e_{{\mathrm {cr,n}},ij}^{n+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq434.gif"/></alternatives></inline-formula> scales linearly with the CR energy densities. This yields a system of coupled linear equations, which can be solved using a matrix solver. Pakmor et al. (<xref ref-type="bibr" rid="CR173">2016a</xref>) solve the linear system in a two-step procedure using the solvers from the <sc>hypre</sc> library (Falgout and Yang <xref ref-type="bibr" rid="CR59">2002</xref>).</p></sec></sec><sec id="Sec40"><title>Numerical scheme for selfconsistent, spectral CR transport</title><p id="Par180">Here we summarise the general framework formulated by Miniati (<xref ref-type="bibr" rid="CR155">2001</xref>), which we extend to middly relativistic and non-reativistic ranges of CR momenta.</p><sec id="Sec41"><title>Evolution of the isotropic CR spectrum on the momentum grid</title><p id="Par181">We assume a piecewise power-law, isotropic (in momentum space) distribution function<disp-formula id="Equ129"><label>129</label><alternatives><mml:math display="block" id="Equ129_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(p) = f_{{i-\frac{1}{2}}} \left( \frac{p}{p_{i-\frac{1}{2}}}\right) ^{-{q_i}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ129.gif"/></alternatives></disp-formula>where the distribution function amplitudes <inline-formula id="IEq435"><alternatives><mml:math id="IEq435_Math"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq435_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f_{{i-\frac{1}{2}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq435.gif"/></alternatives></inline-formula> are defined on left edges of momentum bins <inline-formula id="IEq436"><alternatives><mml:math id="IEq436_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq436_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i-\frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq436.gif"/></alternatives></inline-formula> and the spectral indices <inline-formula id="IEq437"><alternatives><mml:math id="IEq437_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq437_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq437.gif"/></alternatives></inline-formula> are attributed to bin interiors.</p><p id="Par182">The number density of particles in a single momentum bin is<disp-formula id="Equ130"><label>130</label><alternatives><mml:math display="block" id="Equ130_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_i&amp;=  \int _{p_{i-\frac{1}{2}}}^{p_{i+\frac{1}{2}}} 4\pi p^2 f(p) dp = \int _{p_{i-\frac{1}{2}}}^{p_{i+\frac{1}{2}}} 4\pi p^2 f_{i-\frac{1}{2}}\left( \frac{p}{p_{i-\frac{1}{2}}} \right) ^{-{q_i}} dp, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ130.gif"/></alternatives></disp-formula><disp-formula id="Equ131"><label>131</label><alternatives><mml:math display="block" id="Equ131_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_i&amp;=  4\pi f_{i-\frac{1}{2}}p^3_{i-\frac{1}{2}}\times \left\{ \begin{array}{l l} \frac{\left( \frac{p_{i+\frac{1}{2}}}{p_{i-\frac{1}{2}}}\right) ^{3-{q_i}}-1}{3-{q_i}} &amp;{} \quad \text {if } {q_i}\ne 3 \\ \ln \left( p_{i+\frac{1}{2}}/p_{i-\frac{1}{2}}\right) &amp;{} \quad \text {if } {q_i}= 3 \end{array} \right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ131.gif"/></alternatives></disp-formula>The particle density equation in the discretised form (spatial propagation terms and local sources are neglected here) reads<disp-formula id="Equ132"><label>132</label><alternatives><mml:math display="block" id="Equ132_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="]" open="["><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mfenced><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\partial }^{} {n_{i}}}{{\partial } {t}^{}} = \left[ b(p) 4\pi p^2 f\right] _{p_{i-\frac{1}{2}}}^{p_{i+\frac{1}{2}}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ132.gif"/></alternatives></disp-formula>where <italic>b</italic>(<italic>p</italic>) is the loss term. We integrate Eq. (<xref rid="Equ132" ref-type="disp-formula">132</xref>) over the timestep interval<disp-formula id="Equ133"><label>133</label><alternatives><mml:math display="block" id="Equ133_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \int _t ^{t+\varDelta t} \frac{\partial n_i}{\partial t} dt' = - \left( \varDelta n_{i+\frac{1}{2}}^{\varDelta t} - \varDelta n_{i-\frac{1}{2}}^{\varDelta t} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ133.gif"/></alternatives></disp-formula>where <inline-formula id="IEq438"><alternatives><mml:math id="IEq438_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq438_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta n_{i+\frac{1}{2}}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq438.gif"/></alternatives></inline-formula> and <inline-formula id="IEq439"><alternatives><mml:math id="IEq439_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq439_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta n_{i-\frac{1}{2}}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq439.gif"/></alternatives></inline-formula> are particle numbers transferred through bin boundaries at <inline-formula id="IEq440"><alternatives><mml:math id="IEq440_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq440_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i \pm \frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq440.gif"/></alternatives></inline-formula> during the time interval <inline-formula id="IEq441"><alternatives><mml:math id="IEq441_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq441_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq441.gif"/></alternatives></inline-formula>.</p><p id="Par183">The discrete form of the particle number becomes<disp-formula id="Equ134"><label>134</label><alternatives><mml:math display="block" id="Equ134_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_i^{t+\varDelta t} = n_i^t - \left( \varDelta n_{i+\frac{1}{2}}^{\varDelta t} - \varDelta n_{i-\frac{1}{2}}^{\varDelta t} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ134.gif"/></alternatives></disp-formula>We shall approximate kinetic energy of CR particles <disp-formula id="Equ135"><label>135</label><alternatives><mml:math display="block" id="Equ135_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>≡</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T(p) = \sqrt{p^2 c^2 + m^2 c^4} - m c^2 \equiv g(p). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ135.gif"/></alternatives></disp-formula>by another piecewise powerlaw function defined for each momentum bin separately<disp-formula id="Equ136"><label>136</label><alternatives><mml:math display="block" id="Equ136_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g(p) \simeq g_{{i-\frac{1}{2}}} \left( \frac{p}{p_{i-\frac{1}{2}}}\right) ^{{s_i}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ136.gif"/></alternatives></disp-formula>where the function amplitudes <inline-formula id="IEq442"><alternatives><mml:math id="IEq442_Math"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq442_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ g_{{i-\frac{1}{2}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq442.gif"/></alternatives></inline-formula> are defined on left edges of momentum bins <inline-formula id="IEq443"><alternatives><mml:math id="IEq443_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq443_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i-\frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq443.gif"/></alternatives></inline-formula> and the power indices <inline-formula id="IEq444"><alternatives><mml:math id="IEq444_Math"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq444_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq444.gif"/></alternatives></inline-formula> are attributed to bin interiors. The amplitudes <inline-formula id="IEq445"><alternatives><mml:math id="IEq445_Math"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq445_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{{i-\frac{1}{2}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq445.gif"/></alternatives></inline-formula> are computed directly by evaluation of <inline-formula id="IEq446"><alternatives><mml:math id="IEq446_Math"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq446_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(p_{{i-\frac{1}{2}}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq446.gif"/></alternatives></inline-formula> on bin edges and the corresponding slopes <inline-formula id="IEq447"><alternatives><mml:math id="IEq447_Math"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq447_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq447.gif"/></alternatives></inline-formula> are<disp-formula id="Equ137"><label>137</label><alternatives><mml:math display="block" id="Equ137_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {s_i}=\frac{\log _{10} \left( \frac{g_{{i+\frac{1}{2}}}}{g_{{i-\frac{1}{2}}}} \right) }{\log _{10} \left( \frac{p_{i+\frac{1}{2}}}{p_{i-\frac{1}{2}}}\right) }. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ137.gif"/></alternatives></disp-formula>Thus, the general relation between energy and distribution function amplitudes is<disp-formula id="Equ138"><label>138</label><alternatives><mml:math display="block" id="Equ138_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_i = 4\pi f_{i-\frac{1}{2}}\mathrm{ g}_{i-\frac{1}{2}}p^{3}_{i-\frac{1}{2}}\times \left\{ \begin{array}{l l} \frac{\left( \frac{p_{i+\frac{1}{2}}}{p_{i-\frac{1}{2}}}\right) ^{3+{s_i}-{q_i}}-1}{3+{s_i}-{q_i}} &amp;{} \quad \text {if }{q_i}\ne 3+{s_i}\\ \ln \left( p_{i+\frac{1}{2}}/p_{i-\frac{1}{2}}\right) &amp;{} \quad \text {if }{q_i}= 3+{s_i}\end{array} \right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ138.gif"/></alternatives></disp-formula>Energy equation in the discretised form reads<disp-formula id="Equ139"><label>139</label><alternatives><mml:math display="block" id="Equ139_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="]" open="["><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msub><mml:mrow/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msub><mml:msup><mml:mrow/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msup></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial e_i}{\partial t}&amp;=  \left[ b(p) 4 \pi p^2 f(p) T(p) \right] ^{^{{p_{i+\frac{1}{2}}}}} _{_{p_{i-\frac{1}{2}}}} - \int ^{p_{i+\frac{1}{2}}}_{p_{i-\frac{1}{2}}} b(p)\frac{4 \pi c p^3 f(p)}{\sqrt{m^{2} c^2 + p^2}} dp. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ139.gif"/></alternatives></disp-formula>The energy loss term (the integral) on the right-hand side of (<xref rid="Equ139" ref-type="disp-formula">139</xref>) contains the derivative of kinetic energy<disp-formula id="Equ140"><label>140</label><alternatives><mml:math display="block" id="Equ140_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow/></mml:msup><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">cp</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{d^{} {T(p)}}{d {p}^{}} = \frac{c p}{\sqrt{p^2 c^{2} + m^{2} c^4}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ140.gif"/></alternatives></disp-formula>Since <italic>T</italic>(<italic>p</italic>) is approximated by a power-law function we can use Eq. (<xref rid="Equ136" ref-type="disp-formula">136</xref>) to represent its derivative<disp-formula id="Equ141"><label>141</label><alternatives><mml:math display="block" id="Equ141_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T'(p) = g'(p) \simeq g_{{i-\frac{1}{2}}} \frac{{s_i}}{p_{{i-\frac{1}{2}}}}\left( \frac{p}{p_{{i-\frac{1}{2}}}}\right) ^{{s_i}- 1}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ141.gif"/></alternatives></disp-formula>We substitute the second right-hand side term in equation (<xref rid="Equ139" ref-type="disp-formula">139</xref>), by <inline-formula id="IEq448"><alternatives><mml:math id="IEq448_Math"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq448_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_i R_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq448.gif"/></alternatives></inline-formula>:<disp-formula id="Equ142"><label>142</label><alternatives><mml:math display="block" id="Equ142_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="]" open="["><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msub><mml:mrow/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msub><mml:msup><mml:mrow/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msup></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial e_i}{\partial t} = \left[ b(p) 4 \pi p^2 f(p) T(p) \right] ^{^{{p_{i+\frac{1}{2}}}}} _{_{p_{i-\frac{1}{2}}}} - e_i R_i , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ142.gif"/></alternatives></disp-formula>where <inline-formula id="IEq449"><alternatives><mml:math id="IEq449_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq449_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq449.gif"/></alternatives></inline-formula> expresses the energy loss rate per unit energy<disp-formula id="Equ143"><label>143</label><alternatives><mml:math display="block" id="Equ143_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_i = \frac{1}{e_{i}} \int ^{p_{i+\frac{1}{2}}}_{p_{i-\frac{1}{2}}} b(p)\frac{4 \pi c p^3 f(p)}{\sqrt{p^2 c^{2} + m^{2} c^4 }} dp. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ143.gif"/></alternatives></disp-formula>For adiabatic cooling<disp-formula id="Equ144"><label>144</label><alternatives><mml:math display="block" id="Equ144_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.277778em"/><mml:mi>p</mml:mi><mml:mo>≡</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b(p) = \frac{1}{3} (\nabla \cdot {\varvec{v}})\; p \equiv u_{d} \; p. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ144.gif"/></alternatives></disp-formula>To deal with the full (relativistic and non-relativistic) energy range we substitute (<xref rid="Equ141" ref-type="disp-formula">141</xref>) in (<xref rid="Equ143" ref-type="disp-formula">143</xref>)<disp-formula id="Equ145"><label>145</label><alternatives><mml:math display="block" id="Equ145_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mfenced close="]" open="["><mml:msubsup><mml:mo>∫</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_i= &amp; {} \frac{1}{e_{i}} \left[ \int ^{p_{i+\frac{1}{2}}}_{p_{i-\frac{1}{2}}} 4 \pi u_{d} p^3 f(p) g'(p) dp + \ldots \right] \nonumber \\= &amp; {} \frac{4\pi c u_{d}}{e_{i}} f_{i-\frac{1}{2}}g_{i-\frac{1}{2}}p^{3}_{i-\frac{1}{2}}{s_i}\times \left\{ \begin{array}{l l} \frac{\left( \frac{p_{i+\frac{1}{2}}}{p_{i-\frac{1}{2}}}\right) ^{3+{s_i}-{q_i}}-1}{3+{s_i}-{q_i}} &amp;{} \quad \text {if }{q_i}\ne 3+{s_i}\\ \ln \left( p_{i+\frac{1}{2}}/p_{i-\frac{1}{2}}\right) &amp;{} \quad \text {if } {q_i}= 3+{s_i}\end{array} \right. + \ldots \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ145.gif"/></alternatives></disp-formula>where the dots stand for other cooling mechanisms. By elimination of the energy density we find that<disp-formula id="Equ146"><label>146</label><alternatives><mml:math display="block" id="Equ146_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{i} = u_{d} {s_i}+ \ldots \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ146.gif"/></alternatives></disp-formula>We integrate now Eq. (<xref rid="Equ142" ref-type="disp-formula">142</xref>) over the timestep interval<disp-formula id="Equ147"><label>147</label><alternatives><mml:math display="block" id="Equ147_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \int _t ^{t+\varDelta t} \frac{\partial e_i}{\partial t} dt' = - \left( \varDelta e_{i+\frac{1}{2}}^{\varDelta t} - \varDelta e_{i-\frac{1}{2}}^{\varDelta t} \right) - \int _t ^{t+\varDelta t} e_i R_i dt', \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ147.gif"/></alternatives></disp-formula>where <inline-formula id="IEq450"><alternatives><mml:math id="IEq450_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq450_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta e_{i+\frac{1}{2}}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq450.gif"/></alternatives></inline-formula> and <inline-formula id="IEq451"><alternatives><mml:math id="IEq451_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq451_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta e_{i-\frac{1}{2}}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq451.gif"/></alternatives></inline-formula> are particle energies transfered through bin boundaries at <inline-formula id="IEq452"><alternatives><mml:math id="IEq452_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:math><tex-math id="IEq452_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i \pm \frac{1}{2}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq452.gif"/></alternatives></inline-formula> during the time interval <inline-formula id="IEq453"><alternatives><mml:math id="IEq453_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq453_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq453.gif"/></alternatives></inline-formula>.</p><p id="Par184">We assume that variations of <inline-formula id="IEq454"><alternatives><mml:math id="IEq454_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq454_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq454.gif"/></alternatives></inline-formula> over the timestep are negligible, thus we approximate the integral on the r.h.s. of (<xref rid="Equ147" ref-type="disp-formula">147</xref>) as:<disp-formula id="Equ148"><label>148</label><alternatives><mml:math display="block" id="Equ148_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \int _t ^{t+\varDelta t} e_i R_i dt^{\prime} &amp;=  \frac{1}{2} \varDelta t \, R_i \left( e_i^{t+\varDelta t} + e_i^t \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ148.gif"/></alternatives></disp-formula>Hence<disp-formula id="Equ149"><label>149</label><alternatives><mml:math display="block" id="Equ149_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_i ^{t+\varDelta t} - e_i^t&amp;=  - \left( \varDelta e_{i+\frac{1}{2}}^{\varDelta t} - \varDelta e_{i-\frac{1}{2}}^{\varDelta t} \right) - \frac{1}{2}\varDelta t \, R_i \left( e_i^{t+\varDelta t} + e_i^t \right) , \nonumber \\ e_i^{t+\varDelta t}&amp;=  \frac{- \left( \varDelta e_{i+\frac{1}{2}}^{\varDelta t} - \varDelta e_{i-\frac{1}{2}}^{\varDelta t} \right) + e_i^t\left( 1 - \frac{R_i}{2}\varDelta t \right) }{ 1 + \frac{1}{2}\varDelta t \, R_i}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ149.gif"/></alternatives></disp-formula>The following part of this section will detail the calculation of the <inline-formula id="IEq455"><alternatives><mml:math id="IEq455_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq455_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta n_{i-1/2}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq455.gif"/></alternatives></inline-formula> and <inline-formula id="IEq456"><alternatives><mml:math id="IEq456_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq456_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta e_{i-1/2}^{\varDelta t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq456.gif"/></alternatives></inline-formula> terms, which involves fluxes of particles and their energies through bin boundaries. The procedure relies by construction on the upwind computation of the fluxes in momentum space.</p><p id="Par185"><italic>Computation of upstream momentum</italic><inline-formula id="IEq457"><alternatives><mml:math id="IEq457_Math"><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:math><tex-math id="IEq457_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\text {u}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq457.gif"/></alternatives></inline-formula>. Particles loose or gain momentum due to physical effects underlying the source term <italic>b</italic>(<italic>p</italic>) in Eq. (<xref rid="Equ139" ref-type="disp-formula">139</xref>)<disp-formula id="Equ150"><label>150</label><alternatives><mml:math display="block" id="Equ150_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow/></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mtext>tot</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b(p) \equiv - \left( \frac{d^{} {p}}{d {t}^{}}\right) _{\text {tot}} = \frac{1}{3} \left( \nabla \cdot {\varvec{v}}\right) p + \ldots = u_{d} \ p + \ldots . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ150.gif"/></alternatives></disp-formula>We integrate (<xref rid="Equ150" ref-type="disp-formula">150</xref>) for the case of the adiabatic process<disp-formula id="Equ151"><label>151</label><alternatives><mml:math display="block" id="Equ151_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dp</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \int _{p(t)}^{p(t+\varDelta t)} \frac{d p}{p}&amp;= - \int _{t}^{t+\varDelta t} u_d \, dt, \nonumber \\ \ln {p^{t+\varDelta t}}&amp;=  \ln {p^t} - u_d \varDelta t . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ151.gif"/></alternatives></disp-formula>Our aim is to find the value of the  momentum <inline-formula id="IEq458"><alternatives><mml:math id="IEq458_Math"><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:math><tex-math id="IEq458_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\text {u}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq458.gif"/></alternatives></inline-formula> at <italic>t</italic> that becomes <inline-formula id="IEq459"><alternatives><mml:math id="IEq459_Math"><mml:mrow><mml:mo>ln</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq459_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln (p_{i-\frac{1}{2}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq459.gif"/></alternatives></inline-formula> at <inline-formula id="IEq460"><alternatives><mml:math id="IEq460_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq460_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t+\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq460.gif"/></alternatives></inline-formula><disp-formula id="Equ162"><alternatives><mml:math display="block" id="Equ162_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>ln</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ln {p_{i-\frac{1}{2}}}&amp;=  \ln {p_{\text {u}}} - u_d \, \varDelta t, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ162.gif"/></alternatives></disp-formula>and finally we find<disp-formula id="Equ152"><label>152</label><alternatives><mml:math display="block" id="Equ152_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{\text {u}}&amp;=  p_{i-\frac{1}{2}}e^{u_d\varDelta t}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ152.gif"/></alternatives></disp-formula>Taylor expansion up to the 1st order in <inline-formula id="IEq461"><alternatives><mml:math id="IEq461_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq461_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq461.gif"/></alternatives></inline-formula> results in:<disp-formula id="Equ153"><label>153</label><alternatives><mml:math display="block" id="Equ153_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:mo>≈</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{\text {u}}\approx &amp; {} p_{i-\frac{1}{2}}(1 + u_d \varDelta t). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ153.gif"/></alternatives></disp-formula><italic>Computation of upwind quantities</italic><inline-formula id="IEq462"><alternatives><mml:math id="IEq462_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>u</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq462_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta n^{\varDelta t}_{{\text {u}}, {i-\frac{1}{2}}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq462.gif"/></alternatives></inline-formula>. In the case of cooling the number of particles transferred from <italic>i</italic>-th bin through the left bin-face is<disp-formula id="Equ154"><label>154</label><alternatives><mml:math display="block" id="Equ154_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>u</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="0.277778em"/><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta n^{\varDelta t}_{{\text {u}}, {i-\frac{1}{2}}}&amp;=  \int _{p_{i-\frac{1}{2}}}^{p_{\text {u}}} 4\pi p^2 f(p) dp \nonumber \\ &amp;=  4 \pi f_{i-\frac{1}{2}}p_{i-\frac{1}{2}}^3 \times \left\{ \begin{array}{l l l} \; \frac{ \left( \frac{p_{\text {u}}}{p_{{i-\frac{1}{2}}}}\right) ^{3-q_{i}} - 1}{3 - q_i} \, &amp;{}\text {if} &amp;{} q_i \ne 3 \\ \ln {\left( \frac{p_{\text {u}}}{p_{i-\frac{1}{2}}}\right) } \, &amp;{}\text {if} &amp;{} q_i = 3 \end{array} \right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ154.gif"/></alternatives></disp-formula>In the case of heating the the number of particles transferred from <italic>i</italic>-th bin through the right bin-face is<disp-formula id="Equ155"><label>155</label><alternatives><mml:math display="block" id="Equ155_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>u</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mtext>u</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta n^{\varDelta t}_{{\text {u}}, {i-\frac{1}{2}}}&amp;=  \int _{p_{\text {u}}}^{p_{i-\frac{1}{2}}} 4\pi p^2 f(p) dp \nonumber \\ &amp;=  4 \pi f_{i-\frac{3}{2}}\, p_{\text {u}}^3 \left( \frac{p_{i-\frac{3}{2}}}{p_{\text {u}}} \right) ^{q_{i-1}} \times \left\{ \begin{array}{l l l} \frac{\left( \frac{p_{i-\frac{1}{2}}}{p_{\text {u}}}\right) ^{3-q_{i-1}}-1}{3 - q_{i-1}} &amp;{} \text {if} &amp;{}q_i \ne 3 \\ \ln {\left( \frac{p_{i-\frac{1}{2}}}{p_{\text {u}}}\right) } \, &amp;{}\text {if} &amp;{} q_i = 3 \end{array}\right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ155.gif"/></alternatives></disp-formula><italic>Computation of upwind quantities</italic><inline-formula id="IEq463"><alternatives><mml:math id="IEq463_Math"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mtext>u</mml:mtext><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq463_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta e^{\varDelta t}_{\text {u}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq463.gif"/></alternatives></inline-formula>. In the case of cooling the the amount of particle energy transferred from <italic>i</italic>-th bin through the left bin-face:<disp-formula id="Equ156"><label>156</label><alternatives><mml:math display="block" id="Equ156_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>u</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≃</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta e^{\varDelta t}_{{\text {u}}, {i-\frac{1}{2}}}&amp;=  \int _{p_{i-\frac{1}{2}}}^{p_{\text {u}}} 4\pi p^2 f(p) T(p) dp \nonumber \\ &amp;\simeq  4\pi f_{i-\frac{1}{2}}\mathrm{ g}_{i-\frac{1}{2}}p^{3}_{i-\frac{1}{2}}\times \left\{ \begin{array}{l l l} \frac{\left( \frac{p_{\text {u}}}{p_{i-\frac{1}{2}}}\right) ^{3+{s_i}-{q_i}}-1}{3+{s_i}-{q_i}} &amp;{} \text {if} &amp;{} {q_i}\ne 3+{s_i}\\ \ln \left( \frac{p_{\text {u}}}{p_{i-\frac{1}{2}}}\right) &amp;{} \text {if} &amp;{} {q_i}= 3+{s_i}\end{array} \right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ156.gif"/></alternatives></disp-formula>In the case of heating the amount of particle energy transferred from <italic>i</italic>-th bin through the right bin-face:<disp-formula id="Equ157"><label>157</label><alternatives><mml:math display="block" id="Equ157_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>u</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:msubsup><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≃</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mtext>u</mml:mtext></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta e^{\varDelta t}_{{\text {u}}, {i-\frac{1}{2}}}&amp;=  \int _{p_{\text {u}}}^{p_{i-\frac{1}{2}}} 4\pi p^2 f(p) T(p) dp \nonumber \\ &amp; \simeq  4 \pi f_{i-\frac{3}{2}}\mathrm{ g}_{{i-\frac{3}{2}}}\, p_{\text {u}}^{3} \left( \frac{p_{i-\frac{3}{2}}}{p_{\text {u}}} \right) ^{q_{i-1}-s_{i-1}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ157.gif"/></alternatives></disp-formula><disp-formula id="Equ158"><label>158</label><alternatives><mml:math display="block" id="Equ158_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>×</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mtext>u</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\times \left\{ \begin{array}{l l l} \frac{\left( \frac{p_{i-\frac{1}{2}}}{p_{\text {u}}}\right) ^{3+{s_{i-1}}-q_{i-1}}-1}{3+{s_{i-1}}- q_{i-1}} &amp;{} \text {if} &amp;{}q_{i-1} \ne 3 +{s_{i-1}}\\ \ln {\left( \frac{p_{i-\frac{1}{2}}}{p_{\text {u}}}\right) } \, &amp;{} \text {if} &amp;{}q_{i-1} = 3 +{s_{i-1}}\end{array}\right. . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ158.gif"/></alternatives></disp-formula></p></sec><sec id="Sec42"><title>Conversion between quantities</title><p id="Par186">The spectral behaviour is best computed using the Fokker–Planck equation using the amplitudes <italic>f</italic> and the slopes <italic>q</italic>. For the coupling to hydrodynamical simulations is more convenient to use number density and energy density. Both sets of quantities (<italic>f</italic>, <italic>q</italic> and <italic>n</italic>, <italic>e</italic>) contain equivalent information, so it is possible to use <italic>f</italic> and <italic>q</italic> for the spectral evolution and then convert to <italic>n</italic> and <italic>e</italic> for the coupled part to hydrodynamics. The computation of <italic>n</italic> and <italic>e</italic> based on <italic>f</italic> and <italic>q</italic> is straight forward. The backward conversion can be done by solving the ratio of <inline-formula id="IEq464"><alternatives><mml:math id="IEq464_Math"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq464_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_i/n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq464.gif"/></alternatives></inline-formula> for <inline-formula id="IEq465"><alternatives><mml:math id="IEq465_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq465_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq465.gif"/></alternatives></inline-formula>. The amplitude <inline-formula id="IEq466"><alternatives><mml:math id="IEq466_Math"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq466_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{i-1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq466.gif"/></alternatives></inline-formula> cancels in the ratio and the solution for <inline-formula id="IEq467"><alternatives><mml:math id="IEq467_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq467_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq467.gif"/></alternatives></inline-formula> is unique.</p></sec></sec></sec><sec id="Sec43"><title>Astrophysical applications</title><sec id="Sec44"><title>Modeling galactic CR propagation with GALPROP</title><sec id="Sec45"><title>Examples of GALPROP model predictions</title><p id="Par187">Figure <xref rid="Fig9" ref-type="fig">9</xref> shows example predictions for a typical GALPROP model: protons, secondary-to-primary boron/carbon ratio, primary electrons and secondary positrons. This model includes diffusive reacceleration, and breaks in both primary injection spectra and diffusion coefficient. The halo height is 4 kpc. The predictions are for the solar position in the Galaxy (though predictions are made for the entire Galaxy). The parameters can be found in the GALPROP parameter file with name galdef_54_reltest23 supplied with the code. Interstellar and example modulated results (simple force-field approximation) are shown. Sample data are also shown for comparison; the fit is reasonable, although no attempt has been made to use the latest available data, nor is any attempt made here to fit the data; this is covered in literature (Grenier et al. <xref ref-type="bibr" rid="CR85">2015</xref>; Boschini et al. <xref ref-type="bibr" rid="CR23">2020a</xref>, <xref ref-type="bibr" rid="CR24">b</xref>).<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Examples of GALPROP model predictions. Upper left: proton spectrum, upper right: Boron to Carbon ratio, lower left: electrons, lower right: positrons. Top curves are interstellar at the solar position, and lower curves are solar-modulated with the parameters shown. The plots were made with the GALPLOT package, available at <ext-link xlink:href="https://gitlab.mpcdf.mpg.de/aws/galplot" ext-link-type="uri">https://gitlab.mpcdf.mpg.de/aws/galplot</ext-link></p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig9_HTML.png" id="MO170"/></fig></p><p id="Par188">Figure <xref rid="Fig10" ref-type="fig">10</xref> shows sample all-sky maps from hadronic interactions with the interstellar gas, and synchrotron radiation from electrons and positrons on the magnetic field. The gamma-ray maps are generated by GALPROP using the computed p and He spectra over the Galaxy, and hadronic cross-sections and the GALPROP neutral, molecular and ionized hydrogen and Helium model, and integration over the line-of-sight from the solar position. The synchrotron maps use the electron and positron spectra over the Galaxy, the magnetic field model, and the full formula for synchrotron including the directional variation with respect to the magnetic field for the regular component. Such models can be directly compared to gamma-ray observations e.g. by the Fermi-LAT instrument and radio surveys by radiotelescopes and the Planck satellite.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Examples of GALPROP model predictions. Left: gamma-ray skymap at 1 GeV, hadronic production via <inline-formula id="IEq468"><alternatives><mml:math id="IEq468_Math"><mml:msup><mml:mi>π</mml:mi><mml:mi>o</mml:mi></mml:msup></mml:math><tex-math id="IEq468_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi ^o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq468.gif"/></alternatives></inline-formula>-decay. Right: synchrotron skymap, 1 GHz, Stokes I (total). The maps are in Galactic coordinates, Aitoff projection, centred on Galactic centre. The maps are GALPROP output in Healpix format, plotted with Aladin from CDS Strasbourg</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig10_HTML.png" id="MO171"/></fig></p></sec><sec id="Sec46"><title>Diffusive reacceleration and alternatives</title><p id="Par189">Diffusive reacceleration has been a process frequently included since it explains B/C without an ad-hoc break in <inline-formula id="IEq469"><alternatives><mml:math id="IEq469_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq469_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq469.gif"/></alternatives></inline-formula> and is compatible with the Kolmogorov index 0.33 in this term. It is simply diffusion in momentum due to the gain and loss of momentum off moving scatterers; hence there is a basic relation between <inline-formula id="IEq470"><alternatives><mml:math id="IEq470_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">pp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq470_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{pp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq470.gif"/></alternatives></inline-formula> and <inline-formula id="IEq471"><alternatives><mml:math id="IEq471_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq471_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq471.gif"/></alternatives></inline-formula> (see e.g. Strong et al. <xref ref-type="bibr" rid="CR246">2007</xref>). However the question remains of the actual importance of this process in the insterstellar medium. In fact in the models with large reacceleration, a significant amount of energy is being injected into CR from the ISM, so that CR acceleration involves more than just the standard sources like SNR. The source of this energy poses a problem. The issue has been recently addressed by Thornbury and Drury (<xref ref-type="bibr" rid="CR251">2014</xref>). This article has a useful and clear derivation of the reacceleration formula and clarifies its relation to the original Fermi second-order mechanism. In future the energetics involved should be studied in more detail. Reacceleration at the level often invoked seems incompatible with low-frequency synchrotron spectrum which is sensitive to the electron and positron spectra around a few GeV.</p><p id="Par190">On the other hand, pure diffusion models without reacceleration do have a problem to reproduce B/C without either a very large break in <inline-formula id="IEq472"><alternatives><mml:math id="IEq472_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq472_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq472.gif"/></alternatives></inline-formula> (Strong and Moskalenko <xref ref-type="bibr" rid="CR243">1998</xref>) or an additional velocity dependence in <inline-formula id="IEq473"><alternatives><mml:math id="IEq473_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq473_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq473.gif"/></alternatives></inline-formula> (Ptuskin et al. <xref ref-type="bibr" rid="CR192">2006</xref>); the latter paper also invokes dissipation of MHD waves as an alternative way to produce the required <inline-formula id="IEq474"><alternatives><mml:math id="IEq474_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq474_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{xx}(p)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq474.gif"/></alternatives></inline-formula>. The use of B/C depends however critically on the level of solar modulation used to convert the interstellar ratio to the observed one; a lower level of modulation than the value <inline-formula id="IEq475"><alternatives><mml:math id="IEq475_Math"><mml:mo>≈</mml:mo></mml:math><tex-math id="IEq475_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq475.gif"/></alternatives></inline-formula>500 MV often adopted would ease the tension. Lave et al. (<xref ref-type="bibr" rid="CR141">2013</xref>) compare both reacceleration and pure diffusion models with B/C data including the latest ACE data at a few 100 MeV; a modulation potential of 250 MV is adopted there. More likely convection plays a role in the sub-GeV/nucleon range as well, since it gives an energy-independent escape time.</p><p id="Par191">It is also possible to include the effect of CR on the diffusion coefficient Ptuskin et al. (<xref ref-type="bibr" rid="CR192">2006</xref>). They studied the possibility that the nonlinear MHD cascade sets the power-law spectrum of turbulence that scatters charged energetic particles. They found that the dissipation of waves due to the resonant interaction with cosmic-ray particles may terminate the Kraichnan-type cascade below wavelengths 10<sup>13</sup> cm. The effect of this wave dissipation has been incorporated in the GALPROP numerical propagation code in order to asses the impact on measurable astrophysical data. The energy dependence of the cosmic-ray diffusion coefficient found in the resulting self-consistent model may explain the peaks in the secondary to primary nuclei ratios observed at about 1 GeV nucleon<sup>−1</sup>.</p></sec></sec><sec id="Sec47"><title>CRs in star formation</title><p id="Par192">Star formation occurs in the densest and coldest regions of the turbulent interstellar medium (Mac Low and Klessen <xref ref-type="bibr" rid="CR144">2004</xref>; McKee and Ostriker <xref ref-type="bibr" rid="CR153">2007</xref>; Girichidis et al. <xref ref-type="bibr" rid="CR81">2020a</xref>). Typical densities of star forming cores exceed <inline-formula id="IEq478"><alternatives><mml:math id="IEq478_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq478_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^6\,\mathrm {cm}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq478.gif"/></alternatives></inline-formula> where the gas is as cold as <inline-formula id="IEq479"><alternatives><mml:math id="IEq479_Math"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math><tex-math id="IEq479_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 10\,\mathrm {K}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq479.gif"/></alternatives></inline-formula>. The spatial extents are small fractions of parsecs. The role of CRs in these regions includes several aspects. As CRs penetrate deeply into the protostellar cores, they deposit energy into regions which are opaque to electromagnetic radiation (see e.g. recent review by Padovani et al. <xref ref-type="bibr" rid="CR171">2020</xref>). This effectively sets a minimum temperature on the gas temperature in dense gas. As the Jeans mass scales with the temperature as <inline-formula id="IEq480"><alternatives><mml:math id="IEq480_Math"><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq480_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^{3/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq480.gif"/></alternatives></inline-formula> the impact of CRs on the fragmentation might be dynamically relevant. The second aspect is the impact on the chemical composition. With their high energy, CRs are able to unbind and ionize many molecules. The changes in the chemical reactions alter the observable tracers and contain valuable information on the local conditions (e.g. Bisbas et al. <xref ref-type="bibr" rid="CR16">2017</xref>). In the context of star formation the main focus is on low-energy CRs because of their enhanced cross section with the thermal particles. Integrated, the CR energy density in the low-energy component is generally not comparable to the other energy densities. Consequently, the CR pressure is also not directly driving the motions of the gas and to first order CRs can be treated as tracer particles or a tracer fluid.</p><p id="Par193">Overall, the time scales for CR transport through star forming regions are much shorter than the dynamical times scales of the gas. This means that adiabatic gains and losses of CRs can be neglected contrary to galactic scales where advective and diffusive time scales are comparable. Given the strong magnetic field strengths of ~ mG (Crutcher <xref ref-type="bibr" rid="CR41">2012</xref>) and the low energy of CRs (<inline-formula id="IEq482"><alternatives><mml:math id="IEq482_Math"><mml:mrow><mml:mo>≲</mml:mo><mml:mi mathvariant="normal">GeV</mml:mi></mml:mrow></mml:math><tex-math id="IEq482_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lesssim \mathrm {GeV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq482.gif"/></alternatives></inline-formula>) the gyro-radii are smaller than the spatial extents of star forming cores and the CRs can be followed collectively following the magnetic field lines along the path <italic>s</italic>.</p><p id="Par194">The distribution function is generally a function of the pitch angle, which depends on the local strength of the regular magnetic field, and CR scattering that occurs due to resonant CR interactions with magnetohydrodynamic (MHD) turbulence and gas nuclei. Depending on the degree of pitch angle scattering, there are two CR transport regimes—free streaming and diffusive (Padovani et al. <xref ref-type="bibr" rid="CR170">2018</xref>; Silsbee and Ivlev <xref ref-type="bibr" rid="CR226">2019</xref>; Padovani et al. <xref ref-type="bibr" rid="CR171">2020</xref>). The free-streaming approximation [also known as the continuous slowing-down approximation, CSDA, (see e.g. Takayanagi <xref ref-type="bibr" rid="CR248">1973</xref>; Padovani et al. <xref ref-type="bibr" rid="CR169">2009</xref>)] is the most common approach used to calculate the propagation of CRs in molecular clouds. Scattering processes are inefficient in this regime, so that the resulting mean squared deviation of the pitch angle along a CR track is small, so <inline-formula id="IEq483"><alternatives><mml:math id="IEq483_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq483_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq483.gif"/></alternatives></inline-formula> is conserved. The dominant regime of CR transport in regions surrounding dense cores embedded within molecular clouds is debated. MHD turbulence in these regions can resonantly scatter the pitch angles of penetrating CRs (Kulsrud and Pearce <xref ref-type="bibr" rid="CR137">1969</xref>), leading to spatial diffusion. The spectrum of MHD turbulence determines the magnitude of the CR diffusion coefficient and its dependence on the particle energy (Schlickeiser et al. <xref ref-type="bibr" rid="CR213">2016</xref>; Silsbee and Ivlev <xref ref-type="bibr" rid="CR226">2019</xref>). However, MHD turbulence can also be driven by anisotropy in the CR distribution function (Skilling and Strong <xref ref-type="bibr" rid="CR232">1976</xref>; Morlino and Gabici <xref ref-type="bibr" rid="CR161">2015</xref>; Ivlev et al. <xref ref-type="bibr" rid="CR104">2018</xref>), which arises in response to CR absorption in dense cores.</p><p id="Par195">Observationally, the ionisation rate of CRs can be connected to observations of <inline-formula id="IEq484"><alternatives><mml:math id="IEq484_Math"><mml:msubsup><mml:mtext>H</mml:mtext><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:msubsup></mml:math><tex-math id="IEq484_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {H}_3^+$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq484.gif"/></alternatives></inline-formula>, whose chemical formation chain is primarily regulated by CRs (see, e.g. Indriolo et al. <xref ref-type="bibr" rid="CR102">2007</xref>; Indriolo and McCall <xref ref-type="bibr" rid="CR101">2012</xref>).</p></sec><sec id="Sec48"><title>CRs in the interstellar medium</title><p id="Par196">In this section we discuss the interactions of CRs with the interstellar medium. This covers the effects in the immediate surroundings of a supernova, the heating in the interstellar medium, and the dynamical impact within the ISM. The interactions on larger scales like the impact on galactic outflows are discussed further below. We will not cover the acceleration mechanism in SN remnant shocks as this involves the kinetic approach of CRs and is beyond the scope of this review.</p><p id="Par197">Simulations of the interstellar medium allow to resolve the different thermal phases of the gas including the degree of ionisation. The spatial resolution also allows to resolve MHD shocks. On the one hand this allows to investigate in more detail the coupling of CRs with the thermal gas. On the other hand CRs can be injected at the position of the shock and allow a more consistent injection mechanism.</p><p id="Par198">In the ISM the transport speeds of CRs and the local tubulent motions can be comparable, so the local conditions determine whether the CRs diffuse faster than they are advected or vice versa. Commerçon et al. (<xref ref-type="bibr" rid="CR39">2019</xref>) perfom simulations of the turbulent ISM and find that for most cases the effective diffusion speeds are dominating. As a result, no significant CR pressure gradient can build up and no dynamical effects are expected on scales of a few tens of parsecs.</p><p id="Par199">Pfrommer et al. (<xref ref-type="bibr" rid="CR182">2017</xref>) extend the two-fluid shock tube by CR injection at the shock and applies an on-the-fly shock finder (Schaal and Springel <xref ref-type="bibr" rid="CR210">2015</xref>) in several idealised setups such as a Sedov explosion (Sedov <xref ref-type="bibr" rid="CR214">1959</xref>) using the <sc>Arepo</sc> code (Springel <xref ref-type="bibr" rid="CR238">2010</xref>). Pais et al. (<xref ref-type="bibr" rid="CR172">2018</xref>) added an obliquity-dependent injection efficiency with respect to the magnetic field orientation and investigated the impact of CRs injected in the shock region on the Sedov explosion finding that the solution remains self-similar because the ellipticity of the propagating blast wave stays constant over time. Furthermore, their comparison to observed SN remnants suggests a lower injection efficiency of only 5 per cent rather than the canonical 10 per cent of the SN energy. This result is independent of the assumed magnetic coherence length.</p><p id="Par200">Dubois et al. (<xref ref-type="bibr" rid="CR51">2019</xref>) use a similar approach to inject CRs at the loci of the MHD shocks with an on-the-fly shock finder in the larger boxes of the interstellar medium using <sc>Ramses</sc>. The efficiency is also coupled to the upstream magnetic obliquity. Their models include CR streaming as well as ansiotropic diffusion. Similar to Pais et al. (<xref ref-type="bibr" rid="CR172">2018</xref>) they find supernova bubbles with large polar caps in case of a homogeneous background magnetic field, and a patchy structure of the CR distribution in case of inhomogeneous background fields. The application in a turbulent box shows that the presence of shock-injected CRs significantly modifies the structure of the gas.</p><p id="Par201">A more idealized study by Wiener et al. (<xref ref-type="bibr" rid="CR272">2017a</xref>) investigates a stream of CRs interacting with cold clouds in a hot dilute environment. Using one-dimensional models including CR streaming they find that the bottleneck effect, which occurs when a population of CRs undergoes the streaming instability, will accelerate and heat the gas cloud. Corresponding two-dimensional models including radiative cooling of the clouds (Wiener et al. <xref ref-type="bibr" rid="CR274">2019</xref>) confirm the acceleration of clouds by CRs, but reveal that the thermal impact might dominate. The cooling effect will keep the clouds intact to CR wave heating.</p></sec><sec id="Sec49"><title>CR driven large-scale instabilities of the ISM</title><p id="Par202">Observational data indicate that gas, magnetic fields and CRs appear in approximate energetic equipartition, which is interpreted as the effect of dynamical coupling of the diverse components of the interstellar medium. The stability of a system in vertical equilibrium<disp-formula id="Equ159"><label>159</label><alternatives><mml:math display="block" id="Equ159_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">therm</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="normal">CR</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>8</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\mathrm {d}}}{{\mathrm {d}}z}\left( P_{\mathrm {therm}} + P_{\mathrm {CR}} + \frac{B^2}{8\pi }\right) = -\rho g_z \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_Equ159.gif"/></alternatives></disp-formula>without CRs was analysed in Newcomb (<xref ref-type="bibr" rid="CR165">1961</xref>); the inclusion of CRs dates back to Parker (<xref ref-type="bibr" rid="CR176">1966</xref>). Zweibel and Kulsrud (<xref ref-type="bibr" rid="CR284">1975</xref>) generalized the model for a family equilibria. The dynamical role of CRs was first recognized by Parker (<xref ref-type="bibr" rid="CR176">1966</xref>), who noted that vertically stratified ISM consisting of thermal gas, magnetic fields and CRs is unstable due to buoyancy of the weightless components, i.e., the magnetic fields and the CRs.</p><p id="Par203">The physical mechanism of the instability stems from the fact that two weightless components—magnetic fields and cosmic rays—contribute to the total pressure of the gravitationally stratified interstellar medium. The thermal gas component is inflated by these nonthermal pressure contributions. The system is prone to a kind of convective instability tending to expel the weightless components from the system and therefore to reduce potential energy of the thermal gas. Linear stability analysis demonstrates that small-amplitude vertical corrugations of magnetic field lines lead to gas motions down to valleys of magnetic fields unweighting tops of the field lines and therefore enhancing the upward motion of the upper parts of the corrugations and a downward motion of gas into the valleys.</p><p id="Par204">The instability, hereafter named <italic>Parker instability</italic>, was recognized as a plausible mechanism leading to the formation of clouds of gas collecting in valleys of the large-scale galactic magnetic fields (Parker <xref ref-type="bibr" rid="CR177">1967</xref>; Blitz and Shu <xref ref-type="bibr" rid="CR20">1980</xref>). Parker (<xref ref-type="bibr" rid="CR178">1992</xref>) proposed, furthermore, that the instability enhanced by continues replenishment of CRs in supernova remnants may lead to an amplification of large-scale magnetic fields in galaxies.</p><p id="Par205">Numerous papers addressing the Parker instability in the ISM by means of linear stability analysis adopted a simplifying assumption that the diffusive propagation of CRs is fast enough to ensure a constant pressure of CRs along magnetic field lines. Ryu et al. (<xref ref-type="bibr" rid="CR207">2003b</xref>) performed a linear analysis of the Parker instability for the medium composed of thermal gas, horizontal magnetic field and anisotropicaly diffusing CRs. The relevant set of equations consisted of the set of ideal MHD equations and the diffusion-advection equation equivalent to Eq. (<xref rid="Equ37" ref-type="disp-formula">37</xref>) with the diffusion tensor in the form of Eq. (<xref rid="Equ88" ref-type="disp-formula">88</xref>) describing the magnetic-field aligned anisotropic propagation of CRs. Their results have shown a strong dependence of the growth rate of the Parker instability on the value of the parallel diffusion coefficient. Lower diffusion coefficients turned out to reduce the growth rate of the instability with respect to the case of constant CR pressure along magnetic field lines, representing the limit of an infinite diffusion coefficient.</p><p id="Par206">The nonlinear evolution of the Parker instability with CRs was addressed by Hanasz and Lesch (<xref ref-type="bibr" rid="CR89">2003</xref>), who extended the ZEUS 3D code with a stable numerical algorithm combining anisotropic diffusion and advection of CRs and coupled the momentum-integrated diffusion equation with the MHD system equations describing a thermal plasma (see Sect. <xref rid="Sec24" ref-type="sec">4.2</xref>). Numerical simulations have shown that the growth rate of the Parker instability depends essentially on the adopted value of the CR diffusion coefficient and that results differ from predictions made on the grounds of linear stability analysis. The difference was plausibly caused by a different triggering mechanism of the instability, which in Ryu et al. (<xref ref-type="bibr" rid="CR207">2003b</xref>) relied on excitation of a specific ’idealized’ eigenmodes, while in (Hanasz and Lesch <xref ref-type="bibr" rid="CR89">2003</xref>) the instability was excited by an instantaneous injection of CRs in a SN remnant.</p><p id="Par207">The linear and nonlinear analysis of the effects of CR diffusion on the Parker instability was subsequently extended by Kuwabara et al. (<xref ref-type="bibr" rid="CR140">2004</xref>) who have shown that the growth rate of the Parker instability becomes smaller if the coupling between CRs and thermal gas is stronger (i.e., if the CR diffusion coefficient is smaller). MHD simulations of the Parker instability with an appropriate perturbation confirmed this result. Similar conclusions were derived from studies of Parker–Jeans instability with anisotropic CR diffusion (Kuwabara and Ko <xref ref-type="bibr" rid="CR138">2006</xref>). The system is less unstable when the CR diffusion coefficient is smaller (i.e., the coupling between the CRs and plasma is stronger) and if the CR pressure is larger. This conclusion is consistent with  the fact that Jeans instability and Parker instability are less unstable when the pressure is higher. In the nonlinear regime the Parker–Jeans instability leads to the formation of gas filaments whose orientation depends on the parallel diffusion coefficient (Kuwabara and Ko <xref ref-type="bibr" rid="CR139">2020</xref>). When the diffusion coefficient is large gas filaments form preferentially perpendicular to the magnetic field and when the diffusion coefficient is small the filaments are aligned parallel to the magnetic field.</p><p id="Par208">Rodrigues et al. (<xref ref-type="bibr" rid="CR198">2016</xref>) examined the evolution of the Parker instability in galactic disks using 3D numerical simulations. They have found that the instability develops a multimodal 3D structure, which cannot be quantitatively predicted from the earlier linearized studies. They calculated synthetic polarized intensity and Faraday rotation measure (RM) maps, and the associated structure functions. They suggested that correlation scales inferred from RM maps can be used to probe the cosmic-ray content of galaxies.</p><p id="Par209">Heintz and Zweibel (<xref ref-type="bibr" rid="CR96">2018</xref>) performed a stability analysis of a stratified layer for three different cosmic-ray transport models: decoupled, corresponding to the classic Parker instability, coupled with <inline-formula id="IEq486"><alternatives><mml:math id="IEq486_Math"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq486_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _c=4/3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq486.gif"/></alternatives></inline-formula> but not streaming, named as modified Parker instability, and coupled with streaming at the Alfvén speed. They demonstrated that cosmic-ray heating of the gas is responsible for the destabilization of the system and concluded that Parker instability with cosmic-ray streaming may play an important role in cosmic-ray feedback. Heintz et al. (<xref ref-type="bibr" rid="CR97">2020</xref>) expanded the work by including radiative cooling. Heating due to CR streaming has a destabilizing effect which affects significantly the nonlinear regime of the Parker instability. While cooling depressurizes the dense gas, streaming CRs heat and inflate the diffuse extraplanar gas, greatly modifying the phase structure of the medium. The fastest growth affects typically the modes characterized by short wavelengths in the horizontal direction perpendicular to the background magnetic field.</p></sec><sec id="Sec50"><title>Cosmic ray driven galactic dynamo</title><p id="Par210">The idea of the CR-driven dynamo was originally raised by Parker (<xref ref-type="bibr" rid="CR178">1992</xref>), who postulated that the buoyancy of CRs together with the Coriolis-force, galactic differential rotation and magnetic reconnection can lead to efficient amplification of galactic magnetic fields.</p><p id="Par211">Preliminary numerical experiments pursued with the aid of the thin flux-tube approximation (Hanasz and Lesch <xref ref-type="bibr" rid="CR88">2000</xref>) have shown that the buoyancy of CRs injected in SN remnants may lead, in the presence of the Coriolis force, to an efficient generation of the poloidal magnetic field component out of the initial azimuthal magnetic field (named as <inline-formula id="IEq487"><alternatives><mml:math id="IEq487_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq487_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq487.gif"/></alternatives></inline-formula>-effect) and to the diffusive transport of magnetic flux in the vertical direction. The CR-induced diffusive transport coefficients for the large mean magnetic field, plugged into the mean-field dynamo equation (Lesch and Hanasz <xref ref-type="bibr" rid="CR142">2003</xref>), (see also Kowal et al. <xref ref-type="bibr" rid="CR130">2006</xref>) resulted in exponentially growing solutions, confirming the Parker’s conjecture that CRs may efficiently drive the dynamo action on galactic scales.</p><p id="Par212">First MHD numerical simulation models (Hanasz et al. <xref ref-type="bibr" rid="CR90">2004</xref>, <xref ref-type="bibr" rid="CR91">2006</xref>, <xref ref-type="bibr" rid="CR92">2009a</xref>; Siejkowski et al. <xref ref-type="bibr" rid="CR223">2010</xref>) of the CR-driven dynamo were realized in a local, rectangular patch of galactic disk with shearing boundary conditions and rotational pseudo-forces (tidal and Coriolis forces) incorporated to study the magnetic field evolution in rotating galactic disks.</p><p id="Par213">The first global model of the CR-driven dynamo in a Milky Way-type galaxy (Hanasz et al. <xref ref-type="bibr" rid="CR93">2009b</xref>) assumed that: (1) Supernovae convert 10% of their explosion kinetic energy into cosmic rays. (2) A weak initial magnetic field of stellar origin was suppled to the system in selected (plerionic type) SN remnants. (3) Differential rotation of the interstellar gas results from an assumed analytical model of an axisymmetric galactic gravitational potential (e.g. Allen and Santillan <xref ref-type="bibr" rid="CR4">1991</xref>) or from a computational model of an N-body galactic disk ( Wóltański <xref ref-type="bibr" rid="CR277">2015</xref>). (4) The initial gas distribution follows the global Milky Way model by Ferriere (<xref ref-type="bibr" rid="CR62">1998</xref>).<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Distribution of toroidal magnetic field at <inline-formula id="IEq489"><alternatives><mml:math id="IEq489_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq489_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=20\,{\mathrm{ Myr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq489.gif"/></alternatives></inline-formula> (top-left), <inline-formula id="IEq490"><alternatives><mml:math id="IEq490_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>700</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq490_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=700\,{\mathrm{ Myr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq490.gif"/></alternatives></inline-formula> (top-right), <inline-formula id="IEq491"><alternatives><mml:math id="IEq491_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Gyr</mml:mi></mml:mrow></mml:math><tex-math id="IEq491_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=2.5\,{\mathrm{ Gyr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq491.gif"/></alternatives></inline-formula> (bottom-left), and <inline-formula id="IEq492"><alternatives><mml:math id="IEq492_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>4.8</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Gyr</mml:mi></mml:mrow></mml:math><tex-math id="IEq492_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t =4.8\,{\mathrm{ Gyr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq492.gif"/></alternatives></inline-formula> (bottom-right). Unmagnetised regions of the volume are white, while positive and negative toroidal magnetic fields are marked with red and blue respectively. Note that the colour scale in magnetic field maps is saturated to enhance weaker magnetic field structures in disk peripheries. The maximum magnetic field strength are <inline-formula id="IEq493"><alternatives><mml:math id="IEq493_Math"><mml:mrow><mml:mn>5.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq493_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.9 \times 10^{-4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq493.gif"/></alternatives></inline-formula>, <inline-formula id="IEq494"><alternatives><mml:math id="IEq494_Math"><mml:mrow><mml:mn>4.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq494_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4.4 \times 10^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq494.gif"/></alternatives></inline-formula>, 1.5 and 29 <inline-formula id="IEq495"><alternatives><mml:math id="IEq495_Math"><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:math><tex-math id="IEq495_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu{\rm G }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq495.gif"/></alternatives></inline-formula> at <inline-formula id="IEq496"><alternatives><mml:math id="IEq496_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><tex-math id="IEq496_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=0.02$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq496.gif"/></alternatives></inline-formula>, 0.7, 2.5 and 4.8 Gyr respectively. Image reproduced with permission from Hanasz et al. (<xref ref-type="bibr" rid="CR93">2009b</xref>), copyright by AAS</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig11_HTML.png" id="MO172"/></fig><fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>Synthetic radio maps of polarised intensity (PI) of synchrotron emission, together with polarisation vectors are shown for the edge-on and face-on views of the galaxy at <inline-formula id="IEq498"><alternatives><mml:math id="IEq498_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>4.8</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq498_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=4.8\,{\mathrm{Myr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq498.gif"/></alternatives></inline-formula>. Vectors direction resembles electric vectors rotated by <inline-formula id="IEq499"><alternatives><mml:math id="IEq499_Math"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq499_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq499.gif"/></alternatives></inline-formula>, and their lengths are proportional to the degree of polarisation. Image reproduced with permission from Hanasz et al. (<xref ref-type="bibr" rid="CR93">2009b</xref>), copyright by AAS</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig12_HTML.png" id="MO173"/></fig></p><p id="Par214">Magnetic field amplification originating from the small-scale, randomly oriented dipolar magnetic fields is apparent through the exponential growth by several orders of magnitude of both the magnetic flux and the magnetic energy. The growth of magnetic field saturates at about <inline-formula id="IEq500"><alternatives><mml:math id="IEq500_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Gyr</mml:mi></mml:mrow></mml:math><tex-math id="IEq500_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 4\,\mathrm{ Gyr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq500.gif"/></alternatives></inline-formula>, reaching values of <inline-formula id="IEq501"><alternatives><mml:math id="IEq501_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq501_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3-5\,{\mu {\rm G }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq501.gif"/></alternatives></inline-formula> in the disk. During the amplification phase, magnetic flux and total magnetic energy grow by about 6 and 10 orders of magnitude, respectively. The average e-folding time of magnetic flux amplification is approximately equal to <inline-formula id="IEq502"><alternatives><mml:math id="IEq502_Math"><mml:mrow><mml:mn>270</mml:mn><mml:mspace width="4pt"/><mml:mi mathvariant="normal">Myr</mml:mi></mml:mrow></mml:math><tex-math id="IEq502_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$270 \ {\mathrm{ Myr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq502.gif"/></alternatives></inline-formula>, corresponding to the orbital rotation period at the galactocentric radius (<inline-formula id="IEq503"><alternatives><mml:math id="IEq503_Math"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">kpc</mml:mi></mml:mrow></mml:math><tex-math id="IEq503_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 10\,{\mathrm{ kpc}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq503.gif"/></alternatives></inline-formula>). The magnetic field originated from randomly oriented magnetic dipoles was initially chaotic, as shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. Later on, the toroidal magnetic field component formed a spiral structure revealing reversals in the plane of the disk. The Magnetic field structure evolved gradually by increasing its correlation scale. The toroidal magnetic field component became almost uniform inside the disk around <inline-formula id="IEq504"><alternatives><mml:math id="IEq504_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Gyr</mml:mi></mml:mrow></mml:math><tex-math id="IEq504_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=2.5\,\mathrm{ Gyr}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq504.gif"/></alternatives></inline-formula>. The volume occupied by the well-ordered magnetic field expanded continuously until the end of the simulation.</p><p id="Par215">To visualise the magnetic field structure in a manner resembling radio observations of external galaxies, synthetic radio maps of the synchrotron radio-emission were deduced in a simplified way from the distribution of CR protons. The polarised intensity of synchrotron emission is shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref> together with polarisation vectors. Electric vectors, computed on the basis of integrated Stokes parameters, are rotated by <inline-formula id="IEq505"><alternatives><mml:math id="IEq505_Math"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq505_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq505.gif"/></alternatives></inline-formula> to reproduce the magnetic field direction projected onto the plane of sky. Polarisation vectors, indicating the mean magnetic field direction, reveal a regular spiral structure in the face-on view, and the so-called <italic>X-shaped structure</italic> in the edge-on view. A particular similarity can be noticed between the edge-on synthetic radio map and the radio maps of observed edge-on galaxies such as NGC 891 (Krause <xref ref-type="bibr" rid="CR131">2009</xref>).</p><p id="Par216">Kulpa-Dybeł et al. (<xref ref-type="bibr" rid="CR135">2011</xref>) added an analytical elliptical component to the axisymmetric gravitational potential. In the presence of the bar perturbation the CR-driven dynamo reveals new properties, such as the presence of a ring-like structure as well as a shift of the magnetic arms with respect to the crests of spiral density waves. Wóltański (<xref ref-type="bibr" rid="CR277">2015</xref>) used N-body simulations to compute gravitational field of a nonaxisymmetric disk with spiral density wave perturbations. Density waves were excited in the disk by addition of a small satellite galaxy. The amplification of magnetic flux by the CR-driven dynamo leads the large-scale magnetic field to the saturation level around <inline-formula id="IEq506"><alternatives><mml:math id="IEq506_Math"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:math><tex-math id="IEq506_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\, \mu {\rm G }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq506.gif"/></alternatives></inline-formula> with local maxima reaching <inline-formula id="IEq507"><alternatives><mml:math id="IEq507_Math"><mml:mrow><mml:mn>20</mml:mn><mml:mo>-</mml:mo><mml:mn>30</mml:mn><mml:mspace width="0.166667em"/><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:math><tex-math id="IEq507_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20-30 \, \mu {\rm G }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq507.gif"/></alternatives></inline-formula>, located near the spiral crests of gas density. Magnetic field vectors are parallel to the gaseous spiral arms as it is observed in real galaxies (Fletcher et al. <xref ref-type="bibr" rid="CR64">2011</xref>). The strongest magnetic fields are generated in between gaseous spiral arms (Kulpa-Dybeł et al. <xref ref-type="bibr" rid="CR135">2011</xref>, <xref ref-type="bibr" rid="CR136">2015</xref>) similarly to magnetic arms observed in some galaxies, such as: NGC 6946 (Beck <xref ref-type="bibr" rid="CR8">2007</xref>) and IC 343 (Beck <xref ref-type="bibr" rid="CR9">2015</xref>).</p><p id="Par217">The edge-on synchrotron radio maps of the galaxy exhibit polarized synchrotron emission, extending several kiloparsecs above and below the disk. Similar structures are common in radio-images of edge on galaxies (see e.g Krause <xref ref-type="bibr" rid="CR131">2009</xref>; Soida et al. <xref ref-type="bibr" rid="CR237">2011</xref>; Mora and Krause <xref ref-type="bibr" rid="CR160">2013</xref>). The X-type structures are present in all global models of CR-driven galactic dynamo (Hanasz et al. <xref ref-type="bibr" rid="CR93">2009b</xref>; Kulpa-Dybeł et al. <xref ref-type="bibr" rid="CR135">2011</xref>, <xref ref-type="bibr" rid="CR136">2015</xref>). Global-galactic winds accompanying the magnetic field amplification are present in practically all numerical realizations of the CR-driven dynamo. The commonly present CR-driven winds leaving galaxies imply magnetic field transport out of the disk and effective magnetisation of intergalactic space. This process is particularly efficient in dwarf galaxies (Siejkowski et al. <xref ref-type="bibr" rid="CR224">2014</xref>).</p><p id="Par218">An interesting observation has been made by Butsky et al. (<xref ref-type="bibr" rid="CR32">2017</xref>) who performed numerical simulations of an isolated galaxy with a stellar feedback prescription in which thermal energy and magnetic energy are supplied by supernova explosions, but CRs are not included. They noted that, similarly to the model of the CR-driven dynamo, the magnetic field reaches equipartition levels over gigayear timescales and raised the question of the relative importance of the two primary types of energy supplied by supernovae: turbulence driven by the thermal expansion of the remnants themselves, or energy released as CRs, since either by itself appears to be sufficient.</p></sec><sec id="Sec51"><title>Cosmic ray driven galactic winds</title><p id="Par219">As supernovae drive strong shocks into the interstellar medium (ISM), some fraction of the explosion energy is consumed to accelerate ionised particles to relativistic energies, which are then injected into the ISM (Krymskii <xref ref-type="bibr" rid="CR133">1977</xref>; Bell <xref ref-type="bibr" rid="CR10">1978</xref>; Blandford and Ostriker <xref ref-type="bibr" rid="CR18">1978</xref>). This relativistic fluid is coupled to the galactic magnetic field and, in particular the hadronic component, is less prone to energy losses than the gaseous component of the ISM.</p><p id="Par220">The idea of CR wind driving has been proposed by Ipavich (<xref ref-type="bibr" rid="CR103">1975</xref>) and developed by numerous authors including Breitschwerdt et al. (<xref ref-type="bibr" rid="CR27">1991</xref>, <xref ref-type="bibr" rid="CR28">1993</xref>), Zirakashvili et al. (<xref ref-type="bibr" rid="CR281">1996</xref>), Ptuskin et al. (<xref ref-type="bibr" rid="CR191">1997</xref>), Breitschwerdt et al. (<xref ref-type="bibr" rid="CR29">2002</xref>), Uhlig et al. (<xref ref-type="bibr" rid="CR255">2012</xref>), Dorfi and Breitschwerdt (<xref ref-type="bibr" rid="CR47">2012</xref>), who find that CRs together with magnetic fields and thermal pressure can contribute to the galactic winds phenomenon. Everett et al. (<xref ref-type="bibr" rid="CR56">2008</xref>) applied a wind model, driven by combined cosmic-ray and thermal-gas pressure, to the Milky Way, and shown that the observed Galactic diffuse soft X-ray emission can be better explained by a wind than by previous static gas models. They find that cosmic-ray pressure is essential to driving the observed wind.</p><p id="Par221">CRs are strongly coupled to magnetic fields and their mutual interaction should be followed in a self-consistent way. Hanasz et al. (<xref ref-type="bibr" rid="CR90">2004</xref>, <xref ref-type="bibr" rid="CR93">2009b</xref>), Siejkowski et al. (<xref ref-type="bibr" rid="CR223">2010</xref>), Kulpa-Dybeł et al. (<xref ref-type="bibr" rid="CR135">2011</xref>) and Heintz and Zweibel (<xref ref-type="bibr" rid="CR96">2018</xref>) have shown that CRs induce buoyancy effects in the ISM, leading to the break-out of magnetic fields from galactic disks (Parker <xref ref-type="bibr" rid="CR178">1992</xref>). Plausibly, such processes are also relevant for star-forming galaxies at high redshift which are observed to have significant magnetic fields at the level of tens of µG (Bernet et al. <xref ref-type="bibr" rid="CR13">2008</xref>). Recent observations even demonstrate the existence of large magnetic fields up 50 kpc away from the galaxy, indicating strong large-scale magnetised winds (Bernet et al. <xref ref-type="bibr" rid="CR14">2013</xref>).</p><sec id="Sec52"><title>1D models</title><p id="Par222">An early popular model for investigating the impact of CRs on galactic winds are one-dimensional models. Usually, they focus on large scales compared to the details of galactic substructure, such that details of the interstellar medium and substructures inside the galaxy are neglected. The infinitesimally thin disc is modelled as the source of CRs. The simplified geometry does not allow for details of the magnetic field or turbulence to be included, but under the assumption of external confinement of CRs by isotropic turbulent motions or a magnetic field model the radial dynamics of a wind including CRs can be modelled. The first application of CRs hydrodynamics in the context of galactic winds was performed by Breitschwerdt et al. (<xref ref-type="bibr" rid="CR27">1991</xref>) assuming a steady state flow along magnetic flux tubes. They found that CRs can drive supersonic mass loss for a wide range of parameters. Exploring the parameter space of thermal and CR pressure on the mass loss has been done by Everett et al. (<xref ref-type="bibr" rid="CR56">2008</xref>) finding that in the Milky Way CRs and thermal pressure contribute equally to the outflow. Extensions of the models to time-dependent winds Dorfi and Breitschwerdt (<xref ref-type="bibr" rid="CR47">2012</xref>) confirm asymptotic solutions of previous steady state problems and also offer an explanation to the observed galactic CR spectrum. More recent models include a full CR spectrum in a semi-analytic model of advective and diffusive CR transport (Recchia et al. <xref ref-type="bibr" rid="CR195">2016b</xref>, <xref ref-type="bibr" rid="CR194">a</xref>, <xref ref-type="bibr" rid="CR196">2017</xref>). Whereas the qualitative results of winds are reproduced, the inferred spectra are in tension with observed ones.</p></sec><sec id="Sec53"><title>3D models</title><p id="Par223">Three dimensional models of the interstellar medium and galaxies including CRs allow for a more natural combination of turbulent motions, a dynamical magnetic field evolution and the interactions with CRs. However, the numerical cost only allows for reduced CR physics and a small parameter range to be explored. Jubelgas et al. (<xref ref-type="bibr" rid="CR118">2008</xref>) conduct simulations of isolated galaxies including the feedback of the diffusive CR component included in the GADGET code. They find that CRs can significantly reduce the star formation efficiencies of small galaxies, with virial velocities below <inline-formula id="IEq509"><alternatives><mml:math id="IEq509_Math"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>80</mml:mn><mml:mspace width="0.333333em"/><mml:mtext>km</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq509_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 80 \text{ km }\,\mathrm{ s}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq509.gif"/></alternatives></inline-formula>, an effect that becomes progressively stronger towards low-mass scales. Yang et al. (<xref ref-type="bibr" rid="CR280">2012</xref>) simulate the onset of a CR-driven outflow comparable to the Milky Way Fermi bubbles using anisotropic CR diffusion. Uhlig et al. (<xref ref-type="bibr" rid="CR255">2012</xref>) use SPH simulations of entire isolated galaxies to test the wind dynamics including CRs including CR heating due to streaming. Without magnetic fields, the simulations approximated the Alfvén velocity by the sound speed and only focus on isotropic transport. Similar approaches have been employed by Booth et al. (<xref ref-type="bibr" rid="CR22">2013</xref>), Salem and Bryan (<xref ref-type="bibr" rid="CR208">2014</xref>) using isotropic CR diffusion. Both studies find that CRs are able to drive winds, but only for some fraction of the probed parameter space. Booth et al. (<xref ref-type="bibr" rid="CR22">2013</xref>) note that the effects of CR-driven winds are much larger in dwarf galaxies compared to their Milky Way models, which is still affected by CRs. More recent simulations by Dashyan and Dubois (<xref ref-type="bibr" rid="CR43">2020</xref>) investigate in more detail the impact of CR on dwarf systems with different CR transport mechanisms. They report a stronger impact on the different transport mechanism than the effective diffusion coefficient.</p><p id="Par224">In a similar framework Salem et al. (<xref ref-type="bibr" rid="CR209">2016</xref>) investigate the impact of CRs on a forming <inline-formula id="IEq510"><alternatives><mml:math id="IEq510_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>12</mml:mn></mml:msup><mml:msub><mml:mi>M</mml:mi><mml:mo>⊙</mml:mo></mml:msub></mml:mrow></mml:math><tex-math id="IEq510_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{12} { M_{\odot }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq510.gif"/></alternatives></inline-formula> halo. They find that CR-inclusive runs, contrasted with a run with star formation and energetic feedback, but no CRs, substantially enrich the circumgalactic medium with metals due to robust and persistent outflows from the disk. The CR-inclusive models reveal more diffuse gas at lower temperatures, down to <inline-formula id="IEq511"><alternatives><mml:math id="IEq511_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mspace width="0.333333em"/><mml:mtext>K</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:math><tex-math id="IEq511_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{4} \text{ K }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq511.gif"/></alternatives></inline-formula>, than the non-CR cases. The CR inclusion leads to a better match of HI, SiIV, CII, and OIV line intensities than the case without CRs. Comparison of gamma-ray luminosity to observational data favor CR diffusion coefficients close to the Milky Way canonical values <inline-formula id="IEq512"><alternatives><mml:math id="IEq512_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>28</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mtext>cm</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq512_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\cdot 10^{28}\, \text{cm}^2 \,\mathrm{ s}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq512.gif"/></alternatives></inline-formula>.</p><p id="Par225">Galaxy simulations including magnetic fields and anisotropic CR diffusion are performed by Hanasz et al. (<xref ref-type="bibr" rid="CR94">2013</xref>). Their models are not only able to drive galactic winds with mass loading factors of order unity but also sustain a CR-driven dynamo with magnetic field strength at a several <italic>µ</italic>G level. Pakmor et al. (<xref ref-type="bibr" rid="CR174">2016b</xref>) compare isotropic and anisotropic diffusion models finding that anisotropic diffusion leads to more realistic magnetic field strengths than in the isotropic case. Including CR streaming in galactic models was investigated by Wiener et al. (<xref ref-type="bibr" rid="CR273">2017b</xref>), Ruszkowski et al. (<xref ref-type="bibr" rid="CR202">2017b</xref>). Butsky and Quinn (<xref ref-type="bibr" rid="CR33">2018</xref>) compare the role of isotropic and anisotropic diffusion and streaming mechanisms for shaping the structure of circumgalactic medium (CGM). They find that all three transport mechanisms result in strong, metal-rich outflows but differ in the temperature and ionization structure of their CGM. Isotropic diffusion results in a spatially uniform, warm CGM that underpredicts the column densities of low ions. Anisotropic diffusion develops a reservoir of cool gas that extends farther from the galactic center, but disperses rapidly with distance. CR streaming projects cool gas out to radii of 200 kpc, supporting a truly multiphase medium.</p><p id="Par226">A systematic parameter study of the impact of CR for different halo masses was performed by Jacob et al. (<xref ref-type="bibr" rid="CR105">2018</xref>) finding that CRs only have a significant effect on the launching of a wind for halo masses below <inline-formula id="IEq514"><alternatives><mml:math id="IEq514_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>12</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mo>⊙</mml:mo></mml:msub></mml:mrow></mml:math><tex-math id="IEq514_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{12}\,\mathrm {M}_\odot $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq514.gif"/></alternatives></inline-formula>. The combined effects of AGN and CRs has been simulated by Wang et al. (<xref ref-type="bibr" rid="CR263">2020</xref>) in isolated galaxies, where the authors argue that CR streaming and the corresponding heating has to be included in order to prevent too efficient cooling of the circumgalactic medium.</p><p id="Par227">Besides the isolated disc setups, recent models include CR transport in cosmological zoom simulations, in which individual galaxies are evolved with high resolution. Buck et al. (<xref ref-type="bibr" rid="CR30">2020</xref>) rerun simulations from the AURIGA project including CRs. They limit the transport coefficients to the Alfvén speed and include the corresponding heating effect, which changes the structure of the outflow. The modified structure of the circumgalactic medium results in a different distribution of angular momentum and thereby alters the stellar and gaseous disk. In a similar cosmologial setup Hopkins et al. (<xref ref-type="bibr" rid="CR100">2021</xref>) compare a large variety of subgrid models for CR confinements, which are connected to the MHD equations using effective transport coefficients in the diffusion, the streaming as well as combined unified CR transport. Besides the moderate effect that CRs have on the galactic winds, their models favour effective diffusion coefficients that range from <inline-formula id="IEq515"><alternatives><mml:math id="IEq515_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>29</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>33</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq515_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{29}-10^{33}\,\mathrm {cm}^2\,\mathrm {s}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq515.gif"/></alternatives></inline-formula>, which is based on the comparison with gamma-ray emission.</p><p id="Par228">The details of how CR winds are driven and in particular the relative importance and dynamical interplay between SN-driven motions and CR dynamics cannot be investigated in full galactic models at the current resolutions. Instead simulations of a smaller fraction of the galaxy are needed. Girichidis et al. (<xref ref-type="bibr" rid="CR78">2016</xref>, <xref ref-type="bibr" rid="CR79">2018</xref>) and Peters et al. (<xref ref-type="bibr" rid="CR179">2015</xref>) compare thermally and CR driven winds in more sophisticated model of the ISM, which includes a chemical evolution to accurately model the phases of the ISM. The models confirm that CRs alone are able to drive and support an outflow with mass loading of order unity. The CR driven outflows are denser, cooler and smoother than their thermally driven counterparts. Figure <xref rid="Fig13" ref-type="fig">13</xref> illustrates the difference between outflows that are only driven by thermal energy injection by SNe (left-hand panel) and the outflows driven 10% of the energy injected as CRs (three right-hand panels). The two central panels show two different diffusion coefficients. The column density on the right-hand side depicts the structure of the ISM if all SNe explode in dense regions. The resulting strong overcooling illustrates that CRs alone are able to lift gas out of the disk. Similar models by Simpson et al. (<xref ref-type="bibr" rid="CR227">2016</xref>) compare simulations with advection only and advection plus diffusion. They conclude that diffusion is needed in order to drive an outflow. The decoupling of CR and the thermal gas in a neutral environment leads to a broader spatial distribution of cosmic rays and higher wind speed compared to the uniformly applied advection-diffusion approach (Farber et al. <xref ref-type="bibr" rid="CR61">2018</xref>). A more sophisticated, locally determined coupling between CRs and the gas confirms these results (Holguin et al. <xref ref-type="bibr" rid="CR99">2019</xref>).<fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>Comparison of the column density structure in simulations of the interstellar medium. The left-hand column shows a setup with only thermal energy injection. The three other simulations include CR injection with an efficiency of 10% of the SN energy. The two central panels show two different diffusion coefficients. In the right-hand panel the SNe all explode in dense regions, which limits their thermal impact. This illustrates that CRs alone are able to lift gas out of the galactic disc. Image adapted from Girichidis et al. (<xref ref-type="bibr" rid="CR79">2018</xref>), copyright by the authors</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41115_2021_11_Fig13_HTML.png" id="MO175"/></fig></p></sec></sec><sec id="Sec54"><title>Cosmic rays in galaxy clusters</title><p id="Par229">CRs are also expected to affect galaxy clusters. One particularly important aspect is the possible heating effect provided by CR protons from AGN. Simulations including CR protons produced at shocks reveal that they could provide a substantial additional pressure in the intracluster medium (Miniati et al. <xref ref-type="bibr" rid="CR159">2001b</xref>). A follow-up study included CR electrons as an additional non-thermal component (Miniati et al. <xref ref-type="bibr" rid="CR158">2001a</xref>). In both cases the CRs are transported with the gas and include cooling effects. Simulations including diffusion of CR protons that are injected in shock regions close to the AGN find large X-ray cavities and radio lobes in the hot diffuse gas of the central regions of galaxy clusters. The cavities are long-lived if the diffusion coefficient does not exceed <inline-formula id="IEq516"><alternatives><mml:math id="IEq516_Math"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>28</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">cm</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq516_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{28}\,\mathrm {cm}^2\,\hbox {s}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq516.gif"/></alternatives></inline-formula> (Mathews and Brighenti <xref ref-type="bibr" rid="CR148">2007</xref>, <xref ref-type="bibr" rid="CR149">2008</xref>; Ruszkowski et al. <xref ref-type="bibr" rid="CR200">2008</xref>). A range of galaxy clusters and shock related CR injection models has been performed by Pfrommer et al. (<xref ref-type="bibr" rid="CR181">2007</xref>) omitting CR diffusion. They find that CRs can be efficiently accelerated in strong structure formation shocks such as accretion and merger shocks. The high relative fraction of CR pressure in the central region increases the compressibility and allows for more star formation. A detailed discussion on the differences between CR advection, diffusion and streaming by Enßlin et al. (<xref ref-type="bibr" rid="CR55">2011</xref>) suggest that the details of the transport mechanisms are essential to understand the non-thermal signatures of clusters. Hydrodynamical simulations including CR streaming and the resulting heating effect have been run by Ruszkowski et al. (<xref ref-type="bibr" rid="CR201">2017a</xref>) find that the CR can efficiently heat the gas and provide a viable channel for the AGN energy thermalization. More recently, Ehlert et al. (<xref ref-type="bibr" rid="CR53">2018</xref>) couple CRs to an AGN jet model and simulate galaxy clusters including a simplified streaming approach. They introduce an effective CR diffusion coefficient <inline-formula id="IEq517"><alternatives><mml:math id="IEq517_Math"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq517_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa _{\mathrm {cr}}\sim l_{\mathrm {cr}}v_{\mathrm {A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq517.gif"/></alternatives></inline-formula> with the CR gradient length <inline-formula id="IEq518"><alternatives><mml:math id="IEq518_Math"><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="normal">cr</mml:mi></mml:msub></mml:math><tex-math id="IEq518_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{\mathrm {cr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq518.gif"/></alternatives></inline-formula> and the Alfvén speed <inline-formula id="IEq519"><alternatives><mml:math id="IEq519_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:math><tex-math id="IEq519_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\mathrm {A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq519.gif"/></alternatives></inline-formula>, which emulates the combined effects of streaming and spatial diffusion (Sharma et al. <xref ref-type="bibr" rid="CR220">2009</xref>; Wiener et al. <xref ref-type="bibr" rid="CR273">2017b</xref>). They conclude that the CR-induced Alfvén heating matches the CR heating rates needed to solve the cooling flow problem. Vazza et al. (<xref ref-type="bibr" rid="CR262">2012b</xref>) model CRs in galaxy clusters by injecting them in numerically identified shocks and advect them with the gas flow. The simulations reveal a small but not dominant impact of CRs on the evolution with changes at the percent level for the temperature, pressure and density distribution.</p><p id="Par230">One of the first attempts to investigate the spectrum of relativistic electrons in cosmological shocks has been made by Keshet et al. (<xref ref-type="bibr" rid="CR126">2003</xref>) who studies the radiation emitted due to inverse Compton process by shock-accelerated electrons in hydrodynamic cosmological simulations of a Lambda cold dark matter (<inline-formula id="IEq520"><alternatives><mml:math id="IEq520_Math"><mml:mi>Λ</mml:mi></mml:math><tex-math id="IEq520_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varLambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq520.gif"/></alternatives></inline-formula>CDM) universe. They performed a posteriori detection and analysis of shocks forming in cosmological simulations to predict the spectrum of CR electrons and the spectrum of <inline-formula id="IEq521"><alternatives><mml:math id="IEq521_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq521_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq521.gif"/></alternatives></inline-formula>-ray photons emitted from cosmological shocks. They subsequently constructed all-sky maps of <inline-formula id="IEq522"><alternatives><mml:math id="IEq522_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq522_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq522.gif"/></alternatives></inline-formula>-ray emission from the nearby universe.</p><p id="Par231">Pfrommer et al. (<xref ref-type="bibr" rid="CR180">2006</xref>) derived an analytic solution to the one-dimensional Riemann shock tube problem for a composite plasma of CRs and thermal gas. They applied their solution to study the properties of structure formation shocks in high-resolution hydrodynamic simulations of the <inline-formula id="IEq523"><alternatives><mml:math id="IEq523_Math"><mml:mi>Λ</mml:mi></mml:math><tex-math id="IEq523_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varLambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq523.gif"/></alternatives></inline-formula>CDM universe. They found that most of the energy is dissipated in weak internal shocks with Mach numbers <inline-formula id="IEq524"><alternatives><mml:math id="IEq524_Math"><mml:mrow><mml:mi>M</mml:mi><mml:mo>∼</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq524_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M \sim 2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq524.gif"/></alternatives></inline-formula>. They recognized the dynamical importance of shock-injected CRs which is comparatively large in the low-density, peripheral halo infaling regions, buts is less important for the weaker flow shocks ocuring in central high-density regions of haloes. They raised questions of cosmological implications of the CRs component and for observational signatures of this radiation.</p><p id="Par232">In the context of AGN feedback Sijacki et al. (<xref ref-type="bibr" rid="CR225">2008</xref>) include CRs together with thermal feedback. The two-component fluid with an effectively softer equation of state and the less efficient cooling for CRs compared to the thermal gas allows CR supported bubbles to rise to the outskirts of the clusters and leak into the surrounding intergalactic medium. However, neither the accretion rates onto the black hole nor the star formation rate are significanty affected by the non-thermal component.</p></sec></sec><sec id="Sec55"><title>Conclusions and outlook</title><p id="Par233">We have reviewed the numerical treatment of CRs assuming a fluid description of this high-energy component. We identified three main approaches in treating CRs numerically. The first is a spectrally resolved approach with a focus on the physical processes of CRs like the primary CRs and the production of secondaries. The most prominent code that represents this approach is <sc>Galprop</sc> with more recent frameworks <sc>Dragon</sc> and <sc>Picard</sc>. The second numerical model focuses on the dynamical coupling of CRs and the thermal gas in (magneto)-hydrodynamical simulations. Here, CRs take the role of dynamical drivers of hydrodynamical flows. In the context of the interstellar medium and galaxy formation CRs are an important additional reservoir of energy. The numerical complexity in this approach is more in the interaction between the two fluids. Simple linear diffusion models are challenged by more complex models that account for the CR streaming instability and couple CRs to the gas including more plasma effects. A third approach tries to spectrally resolve CRs and at the same time include the dynamical impact onto the gas dynamics. The numerical and computational complexity forces this approach to be limited in both spectral complexity and multiple species of CRs and in the details of plasma interactions of relativistic and thermal gas.</p><p id="Par234">Depending on the application the currently developed models still face major limitations. In the interstellar medium and for the dynamics of galaxies all three approaches would need to be merged and coupled. For the connection with observations—in particular for a comparison with the Milky Way—a detailed modeling of secondaries is of major importance. Similarly, a spectrally resolved modeling of CR electrons as tracers of local thermal and CR properties are key to understand the galaxies. The structure of the magnetic field in galaxies is strongly connected to the dynamics of CRs. Magnetohydrodynamical simulations naturally include an evolving magnetic field that follows and/or shapes spiral structures and interacts with dynamos and local instabilities of the gas like Parker loops. The combined CR-MHD models using a single CRs fluid approach reveal that CRs can be dynamically important for shaping the magnetic field, structuring the interstellar medium, and driving galactic outflows and winds. However, the relative importance of CRs compared to other processes in galaxies as well as which details of CR physics are the crucial ones to resolve, include and simulate are still strongly debated. Currently, there is converging consensus that CRs—in particular the dynamically more relevant CR protons—should be coupled to the thermal gas and treated in a time-dependent manner. The missing physical aspects in this approach like a spectral CR description and the inclusion of multiple species and secondaries are on the agenda for the near future.</p></sec></body><back><ack><title>Acknowledgements</title><p>MH acknowledges support of the (Polish) National Science Centre through the Grant 2015/19/ST9/02959. PG acknowledges funding from the European Research Council under ERC-CoG Grant CRAGSMAN-646955.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Ajello</surname><given-names>M</given-names></name><name><surname>Allafort</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Detection of the characteristic Pion-decay signature in supernova remnants</article-title><source>Science</source><year>2013</year><volume>339</volume><fpage>807</fpage><lpage>811</lpage><pub-id pub-id-type="doi">10.1126/science.1231160</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013Sci...339..807A</pub-id><comment>arXiv:1302.3307 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguilar</surname><given-names>M</given-names></name><name><surname>Aisa</surname><given-names>D</given-names></name><name><surname>Alpat</surname><given-names>B</given-names></name><collab>AMS Collaboration</collab><etal/></person-group><article-title xml:lang="en">Precision measurement of the (e<sup>+</sup>+e<sup>−</sup>) flux in primary cosmic rays from 0.5 GeV to 1 TeV with the alpha magnetic spectrometer on the international space station</article-title><source>Phys Rev Lett</source><year>2014</year><volume>113</volume><issue>22</issue><fpage>221102</fpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.221102</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014PhRvL.113v1102A</pub-id></mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguilar</surname><given-names>M</given-names></name><name><surname>Aisa</surname><given-names>D</given-names></name><name><surname>Alvino</surname><given-names>A</given-names></name><collab>AMS Collaboration</collab><etal/></person-group><article-title xml:lang="en">Electron and positron fluxes in primary cosmic rays measured with the alpha magnetic spectrometer on the international space station</article-title><source>Phys Rev Lett</source><year>2014</year><volume>113</volume><issue>12</issue><fpage>121102</fpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.121102</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014PhRvL.113l1102A</pub-id></mixed-citation></ref><ref id="CR4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>C</given-names></name><name><surname>Santillan</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">An improved model of the galactic mass distribution for orbit computations</article-title><source>Rev Mex Astron Astrofis</source><year>1991</year><volume>22</volume><fpage>255</fpage><lpage>263</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1991RMxAA..22..255A</pub-id></mixed-citation></ref><ref id="CR5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amato</surname><given-names>E</given-names></name><name><surname>Blasi</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Cosmic ray transport in the Galaxy: a review</article-title><source>Adv Space Res</source><year>2018</year><volume>62</volume><issue>10</issue><fpage>2731</fpage><lpage>2749</lpage><pub-id pub-id-type="doi">10.1016/j.asr.2017.04.019</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018AdSpR..62.2731A</pub-id><comment>arXiv:1704.05696 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="other">Axford WI, Leer E, Skadron G (1977) The acceleration of cosmic rays by shock waves. In: 15th international cosmic ray conference, vol. 11. Bulgarian Academy of Sciences, pp 132–137</mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Axford</surname><given-names>WI</given-names></name><name><surname>Leer</surname><given-names>E</given-names></name><name><surname>McKenzie</surname><given-names>JF</given-names></name></person-group><article-title xml:lang="en">The structure of cosmic ray shocks</article-title><source>Astron Astrophys</source><year>1982</year><volume>111</volume><fpage>317</fpage><lpage>325</lpage><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0519.76059</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1982A&amp;A...111..317A</pub-id></mixed-citation></ref><ref id="CR1000"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balsara</surname><given-names>DS</given-names></name></person-group><article-title xml:lang="en">Higher-order accurate space-time schemes for computational astrophysics—Part I: finite volume methods</article-title><source>Living Rev Comput Astrophys</source><year>2017</year><volume>3</volume><fpage>2</fpage><pub-id pub-id-type="doi">10.1007/s41115-017-0002-8</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017LRCA....3....2B</pub-id></mixed-citation></ref><ref id="CR8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beck</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Magnetism in the spiral galaxy NGC 6946: magnetic arms, depolarization rings, dynamo modes, and helical fields</article-title><source>Astron Astrophys</source><year>2007</year><volume>470</volume><fpage>539</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20066988</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007A&amp;A...470..539B</pub-id><comment>arXiv:0705.4163</comment></mixed-citation></ref><ref id="CR9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beck</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Magnetic fields in the nearby spiral galaxy IC 342: a multi-frequency radio polarization study</article-title><source>Astron Astrophys</source><year>2015</year><volume>578</volume><fpage>A93</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201425572</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015A&amp;A...578A..93B</pub-id><comment>arXiv:1502.05439</comment></mixed-citation></ref><ref id="CR10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname><given-names>AR</given-names></name></person-group><article-title xml:lang="en">The acceleration of cosmic rays in shock fronts. I</article-title><source>MNRAS</source><year>1978</year><volume>182</volume><fpage>147</fpage><lpage>156</lpage><pub-id pub-id-type="doi">10.1093/mnras/182.2.147</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1978MNRAS.182..147B</pub-id><comment>10.1093/mnras/182.2.147</comment></mixed-citation></ref><ref id="CR11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname><given-names>AR</given-names></name></person-group><article-title xml:lang="en">The non-linear self-regulation of cosmic ray acceleration at shocks</article-title><source>MNRAS</source><year>1987</year><volume>225</volume><fpage>615</fpage><lpage>626</lpage><pub-id pub-id-type="doi">10.1093/mnras/225.3.615</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1987MNRAS.225..615B</pub-id></mixed-citation></ref><ref id="CR12"><mixed-citation publication-type="other">Berezinskii VS, Bulanov SV, Dogiel VA, Ptuskin VS (1990) Astrophysics of cosmic rays, edited by VL Ginzburg. North-Holland, Amsterdam</mixed-citation></ref><ref id="CR13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernet</surname><given-names>ML</given-names></name><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Lilly</surname><given-names>SJ</given-names></name><name><surname>Kronberg</surname><given-names>PP</given-names></name><name><surname>Dessauges-Zavadsky</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Strong magnetic fields in normal galaxies at high redshift</article-title><source>Nature</source><year>2008</year><volume>454</volume><fpage>302</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1038/nature07105</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008Natur.454..302B</pub-id><comment>arXiv:0807.3347</comment></mixed-citation></ref><ref id="CR14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernet</surname><given-names>ML</given-names></name><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Lilly</surname><given-names>SJ</given-names></name></person-group><article-title xml:lang="en">The extent of magnetic fields around galaxies out to <inline-formula id="IEq537"><alternatives><mml:math id="IEq537_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq537_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z \sim 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq537.gif"/></alternatives></inline-formula></article-title><source>Astrophys J</source><year>2013</year><volume>772</volume><fpage>L28</fpage><pub-id pub-id-type="doi">10.1088/2041-8205/772/2/L28</pub-id><comment>arXiv:1307.2250</comment></mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Binns</surname><given-names>WR</given-names></name><name><surname>Wiedenbeck</surname><given-names>ME</given-names></name><name><surname>Arnould</surname><given-names>M</given-names></name><name><surname>Cummings</surname><given-names>AC</given-names></name><name><surname>George</surname><given-names>JS</given-names></name><name><surname>Goriely</surname><given-names>S</given-names></name><name><surname>Israel</surname><given-names>MH</given-names></name><name><surname>Leske</surname><given-names>RA</given-names></name><name><surname>Mewaldt</surname><given-names>RA</given-names></name><name><surname>Meynet</surname><given-names>G</given-names></name><name><surname>Scott</surname><given-names>LM</given-names></name><name><surname>Stone</surname><given-names>EC</given-names></name><name><surname>von Rosenvinge</surname><given-names>TT</given-names></name></person-group><article-title xml:lang="en">Cosmic-Ray Neon, Wolf-Rayet stars, and the superbubble origin of galactic cosmic rays</article-title><source>Astrophys J</source><year>2005</year><volume>634</volume><fpage>351</fpage><lpage>364</lpage><pub-id pub-id-type="doi">10.1086/496959</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005ApJ...634..351B</pub-id></mixed-citation></ref><ref id="CR16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bisbas</surname><given-names>TG</given-names></name><name><surname>van Dishoeck</surname><given-names>EF</given-names></name><name><surname>Papadopoulos</surname><given-names>PP</given-names></name><name><surname>Szűcs</surname><given-names>L</given-names></name><name><surname>Bialy</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>ZY</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray induced destruction of CO in star-forming galaxies</article-title><source>Astrophys J</source><year>2017</year><volume>839</volume><fpage>90</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aa696d</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...839...90B</pub-id><comment>arXiv:1703.08598</comment></mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blackman</surname><given-names>EG</given-names></name><name><surname>Field</surname><given-names>GB</given-names></name></person-group><article-title xml:lang="en">A new approach to turbulent transport of a mean scalar</article-title><source>Phys Fluids</source><year>2003</year><volume>15</volume><issue>11</issue><fpage>L73</fpage><lpage>L76</lpage><pub-id pub-id-type="doi">10.1063/1.1613281</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1186.76065</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003PhFl...15L..73B</pub-id><comment>arXiv:astro-ph/0302013 [astro-ph]</comment></mixed-citation></ref><ref id="CR18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blandford</surname><given-names>RD</given-names></name><name><surname>Ostriker</surname><given-names>JP</given-names></name></person-group><article-title xml:lang="en">Particle acceleration by astrophysical shocks</article-title><source>Astrophys J</source><year>1978</year><volume>221</volume><fpage>L29</fpage><lpage>L32</lpage><pub-id pub-id-type="doi">10.1086/182658</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1978ApJ...221L..29B</pub-id></mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="other">Blasi P, Amato E (2012) Diffusive propagation of cosmic rays from supernova remnants in the Galaxy. I: spectrum and chemical composition. JCAP 2012(1):010. <ext-link xlink:href="10.1088/1475-7516/2012/01/010" ext-link-type="doi">https://doi.org/10.1088/1475-7516/2012/01/010</ext-link>. <ext-link xlink:href="http://arxiv.org/abs/1105.4521" ext-link-type="uri">arXiv:1105.4521</ext-link> [astro-ph.HE]</mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blitz</surname><given-names>L</given-names></name><name><surname>Shu</surname><given-names>FH</given-names></name></person-group><article-title xml:lang="en">The origin and lifetime of giant molecular cloud complexes</article-title><source>Astrophys J</source><year>1980</year><volume>238</volume><fpage>148</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1086/157968</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1980ApJ...238..148B</pub-id></mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloemen</surname><given-names>JBGM</given-names></name><name><surname>Dogiel</surname><given-names>VA</given-names></name><name><surname>Dorman</surname><given-names>VL</given-names></name><name><surname>Ptuskin</surname><given-names>VS</given-names></name></person-group><article-title xml:lang="en">Galactic diffusion and wind models of cosmic-ray transport. I—Insight from CR composition studies and gamma-ray observations</article-title><source>Astron Astrophys</source><year>1993</year><volume>267</volume><fpage>372</fpage><lpage>387</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1993A&amp;A...267..372B</pub-id></mixed-citation></ref><ref id="CR22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Booth</surname><given-names>CM</given-names></name><name><surname>Agertz</surname><given-names>O</given-names></name><name><surname>Kravtsov</surname><given-names>AV</given-names></name><name><surname>Gnedin</surname><given-names>NY</given-names></name></person-group><article-title xml:lang="en">Simulations of disk galaxies with cosmic ray driven galactic winds</article-title><source>Astrophys J</source><year>2013</year><volume>777</volume><issue>1</issue><fpage>L16</fpage><pub-id pub-id-type="doi">10.1088/2041-8205/777/1/L16</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ApJ...777L..16B</pub-id><comment>arXiv:1308.4974 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boschini</surname><given-names>MJ</given-names></name><name><surname>Della Torre</surname><given-names>S</given-names></name><name><surname>Gervasi</surname><given-names>M</given-names></name><name><surname>Grandi</surname><given-names>D</given-names></name><name><surname>Jóhannesson</surname><given-names>G</given-names></name><name><surname>La Vacca</surname><given-names>G</given-names></name><name><surname>Masi</surname><given-names>N</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Pensotti</surname><given-names>S</given-names></name><name><surname>Porter</surname><given-names>TA</given-names></name><name><surname>Quadrani</surname><given-names>L</given-names></name><name><surname>Rancoita</surname><given-names>PG</given-names></name><name><surname>Rozza</surname><given-names>D</given-names></name><name><surname>Tacconi</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Inference of the local interstellar spectra of cosmic-ray nuclei <inline-formula id="IEq539"><alternatives><mml:math id="IEq539_Math"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>≤</mml:mo><mml:mn>28</mml:mn></mml:mrow></mml:math><tex-math id="IEq539_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z \le 28$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq539.gif"/></alternatives></inline-formula> with the GalProp-HelMod framework</article-title><source>Astrophys J Suppl</source><year>2020</year><volume>250</volume><issue>2</issue><fpage>27</fpage><pub-id pub-id-type="doi">10.3847/1538-4365/aba901</pub-id><comment>arXiv:2006.01337 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boschini</surname><given-names>MJ</given-names></name><name><surname>Della Torre</surname><given-names>S</given-names></name><name><surname>Gervasi</surname><given-names>M</given-names></name><name><surname>Grandi</surname><given-names>D</given-names></name><name><surname>Jøhannesson</surname><given-names>G</given-names></name><name><surname>La Vacca</surname><given-names>G</given-names></name><name><surname>Masi</surname><given-names>N</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Pensotti</surname><given-names>S</given-names></name><name><surname>Porter</surname><given-names>TA</given-names></name><name><surname>Quadrani</surname><given-names>L</given-names></name><name><surname>Rancoita</surname><given-names>PG</given-names></name><name><surname>Rozza</surname><given-names>D</given-names></name><name><surname>Tacconi</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Deciphering the local interstellar spectra of secondary nuclei with the Galprop/Helmod framework and a hint for primary lithium in cosmic rays</article-title><source>Astrophys J</source><year>2020</year><volume>889</volume><issue>2</issue><fpage>167</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/ab64f1</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020ApJ...889..167B</pub-id><comment>arXiv:1911.03108 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boudaud</surname><given-names>M</given-names></name><name><surname>Génolini</surname><given-names>Y</given-names></name><name><surname>Derome</surname><given-names>L</given-names></name><name><surname>Lavalle</surname><given-names>J</given-names></name><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Salati</surname><given-names>P</given-names></name><name><surname>Serpico</surname><given-names>PD</given-names></name></person-group><article-title xml:lang="en">AMS-02 antiprotons’ consistency with a secondary astrophysical origin</article-title><source>Phys Rev Res</source><year>2020</year><volume>2</volume><issue>2</issue><fpage>023022</fpage><pub-id pub-id-type="doi">10.1103/PhysRevResearch.2.023022</pub-id></mixed-citation></ref><ref id="CR26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradt</surname><given-names>HL</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Abundance of lithium, beryllium, boron, and other light nuclei in the primary cosmic radiation and the problem of cosmic-ray origin</article-title><source>Phys Rev</source><year>1950</year><volume>80</volume><fpage>943</fpage><lpage>953</lpage><pub-id pub-id-type="doi">10.1103/PhysRev.80.943</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1950PhRv...80..943B</pub-id></mixed-citation></ref><ref id="CR27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitschwerdt</surname><given-names>D</given-names></name><name><surname>McKenzie</surname><given-names>JF</given-names></name><name><surname>Voelk</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Galactic winds. I—Cosmic ray and wave-driven winds from the Galaxy</article-title><source>Astron Astrophys</source><year>1991</year><volume>245</volume><fpage>79</fpage><lpage>98</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1991A&amp;A...245...79B</pub-id></mixed-citation></ref><ref id="CR28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitschwerdt</surname><given-names>D</given-names></name><name><surname>McKenzie</surname><given-names>JF</given-names></name><name><surname>Voelk</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Galactic winds. II—Role of the disk-halo interface in cosmic ray driven galactic winds</article-title><source>Astron Astrophys</source><year>1993</year><volume>269</volume><fpage>54</fpage><lpage>66</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1993A&amp;A...269...54B</pub-id></mixed-citation></ref><ref id="CR29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitschwerdt</surname><given-names>D</given-names></name><name><surname>Dogiel</surname><given-names>VA</given-names></name><name><surname>Völk</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">The gradient of diffuse gamma-ray emission in the Galaxy</article-title><source>Astron Astrophys</source><year>2002</year><volume>385</volume><fpage>216</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20020152</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002A&amp;A...385..216B</pub-id></mixed-citation></ref><ref id="CR30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buck</surname><given-names>T</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Grand</surname><given-names>RJJ</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">The effects of cosmic rays on the formation of Milky Way-mass galaxies in a cosmological context</article-title><source>MNRAS</source><year>2020</year><volume>497</volume><issue>2</issue><fpage>1712</fpage><lpage>1737</lpage><pub-id pub-id-type="doi">10.1093/mnras/staa1960</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020MNRAS.497.1712B</pub-id><comment>arXiv:1911.00019 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Büsching</surname><given-names>I</given-names></name><name><surname>Kopp</surname><given-names>A</given-names></name><name><surname>Pohl</surname><given-names>M</given-names></name><name><surname>Schlickeiser</surname><given-names>R</given-names></name><name><surname>Perrot</surname><given-names>C</given-names></name><name><surname>Grenier</surname><given-names>I</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray propagation properties for an origin in supernova remnants</article-title><source>Astrophys J</source><year>2005</year><volume>619</volume><fpage>314</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1086/426537</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005ApJ...619..314B</pub-id></mixed-citation></ref><ref id="CR33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butsky</surname><given-names>IS</given-names></name><name><surname>Quinn</surname><given-names>TR</given-names></name></person-group><article-title xml:lang="en">The role of cosmic-ray transport in shaping the simulated circumgalactic medium</article-title><source>Astrophys J</source><year>2018</year><volume>868</volume><issue>2</issue><fpage>108</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aaeac2</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...868..108B</pub-id><comment>arXiv:1803.06345 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butsky</surname><given-names>I</given-names></name><name><surname>Zrake</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>Jh</given-names></name><name><surname>Yang</surname><given-names>HI</given-names></name><name><surname>Abel</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Ab initio simulations of a supernova-driven galactic dynamo in an isolated disk galaxy</article-title><source>Astrophys J</source><year>2017</year><volume>843</volume><issue>2</issue><fpage>113</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aa799f</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...843..113B</pub-id><comment>arXiv:1610.08528 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caprioli</surname><given-names>D</given-names></name><name><surname>Spitkovsky</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Simulations of ion acceleration at non-relativistic shocks. I. Acceleration efficiency</article-title><source>Astrophys J</source><year>2014</year><volume>783</volume><issue>2</issue><fpage>91</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/783/2/91</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014ApJ...783...91C</pub-id><comment>arXiv:1310.2943 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Casse</surname><given-names>F</given-names></name><name><surname>Lemoine</surname><given-names>M</given-names></name><name><surname>Pelletier</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Transport of cosmic rays in chaotic magnetic fields</article-title><source>Phys Rev D</source><year>2002</year><volume>65</volume><issue>2</issue><fpage>023002</fpage><pub-id pub-id-type="doi">10.1103/PhysRevD.65.023002</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002PhRvD..65b3002C</pub-id><comment>astro-ph/0109223</comment></mixed-citation></ref><ref id="CR36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chin</surname><given-names>YC</given-names></name><name><surname>Wentzel</surname><given-names>DG</given-names></name></person-group><article-title xml:lang="en">Nonlinear dissipation of Alfvén waves</article-title><source>Astrophys Space Sci</source><year>1972</year><volume>16</volume><issue>3</issue><fpage>465</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1007/BF00642346</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1972Ap&amp;SS..16..465C</pub-id></mixed-citation></ref><ref id="CR37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colella</surname><given-names>P</given-names></name><name><surname>Woodward</surname><given-names>PR</given-names></name></person-group><article-title xml:lang="en">The piecewise parabolic method (PPM) for gas-dynamical simulations</article-title><source>J Comput Phys</source><year>1984</year><volume>54</volume><fpage>174</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1016/0021-9991(84)90143-8</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0531.76082</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1984JCoPh..54..174C</pub-id></mixed-citation></ref><ref id="CR38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Commerçon</surname><given-names>B</given-names></name><name><surname>Debout</surname><given-names>V</given-names></name><name><surname>Teyssier</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">A fast, robust, and simple implicit method for adaptive time-stepping on adaptive mesh-refinement grids</article-title><source>Astron Astrophys</source><year>2014</year><volume>563</volume><fpage>A11</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201322858</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014A&amp;A...563A..11C</pub-id><comment>arXiv:1401.1112 [astro-ph.IM]</comment></mixed-citation></ref><ref id="CR39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Commerçon</surname><given-names>B</given-names></name><name><surname>Marcowith</surname><given-names>A</given-names></name><name><surname>Dubois</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray propagation in the bi-stable interstellar medium. I. Conditions for cosmic-ray trapping</article-title><source>Astron Astrophys</source><year>2019</year><volume>622</volume><fpage>A143</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201833809</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019A&amp;A...622A.143C</pub-id><comment>arXiv:1811.11509 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Connell</surname><given-names>JJ</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray composition as observed by Ulysses</article-title><source>Space Sci Rev</source><year>2001</year><volume>99</volume><fpage>41</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1023/A:1013820309913</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001SSRv...99...41C</pub-id></mixed-citation></ref><ref id="CR41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crutcher</surname><given-names>RM</given-names></name></person-group><article-title xml:lang="en">Magnetic fields in molecular clouds</article-title><source>Annu Rev Astron Astrophys</source><year>2012</year><volume>50</volume><fpage>29</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1146/annurev-astro-081811-125514</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012ARA&amp;A..50...29C</pub-id></mixed-citation></ref><ref id="CR42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cummings</surname><given-names>AC</given-names></name><name><surname>Stone</surname><given-names>EC</given-names></name><name><surname>Heikkila</surname><given-names>BC</given-names></name><name><surname>Lal</surname><given-names>N</given-names></name><name><surname>Webber</surname><given-names>WR</given-names></name><name><surname>Jóhannesson</surname><given-names>G</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Orlando</surname><given-names>E</given-names></name><name><surname>Porter</surname><given-names>TA</given-names></name></person-group><article-title xml:lang="en">Galactic cosmic rays in the local interstellar medium: voyager 1 observations and model results</article-title><source>Astrophys J</source><year>2016</year><volume>831</volume><issue>1</issue><fpage>18</fpage><pub-id pub-id-type="doi">10.3847/0004-637X/831/1/18</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...831...18C</pub-id></mixed-citation></ref><ref id="CR43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dashyan</surname><given-names>G</given-names></name><name><surname>Dubois</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Cosmic ray feedback from supernovae in dwarf galaxies</article-title><source>Astron Astrophys</source><year>2020</year><volume>638</volume><fpage>A123</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201936339</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020A&amp;A...638A.123D</pub-id><comment>arXiv:2003.09900 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR45"><mixed-citation publication-type="other">Davis L Jr (1960) On the diffusion of cosmic rays in the galaxy. In: Syrovatsky SI (ed) 6th international cosmic ray conference, vol 3, p 220</mixed-citation></ref><ref id="CR44"><mixed-citation publication-type="other">Davis AJ, Mewaldt RA, Binns WR, Christian ER, Cummings AC, George JS, Hink PL, Leske RA, von Rosenvinge TT, Wiedenbeck ME, Yanasak NE (2000) On the low energy decrease in galactic cosmic ray secondary/primary ratios. In: Mewaldt RA, Jokipii JR, Lee MA, Möbius E, Zurbuchen TH (eds) Acceleration and transport of energetic particles observed in the heliosphere. AIP conference proceedings, American Institute of Physics, New York, p 421. <ext-link xlink:href="10.1063/1.1324351" ext-link-type="doi">https://doi.org/10.1063/1.1324351</ext-link></mixed-citation></ref><ref id="CR46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desiati</surname><given-names>P</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">The transport of cosmic rays across magnetic fieldlines</article-title><source>Astrophys J</source><year>2014</year><volume>791</volume><issue>1</issue><fpage>51</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/791/1/51</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014ApJ...791...51D</pub-id><comment>arXiv:1402.1475 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR47"><mixed-citation publication-type="other">Dorfi EA, Breitschwerdt D (2012) Time-dependent galactic winds. I. Structure and evolution of galactic outflows accompanied by cosmic ray acceleration. Astron Astrophys 540:A77. <ext-link xlink:href="10.1051/0004-6361/201118082" ext-link-type="doi">https://doi.org/10.1051/0004-6361/201118082</ext-link>. <ext-link xlink:href="http://arxiv.org/abs/1304.1311" ext-link-type="uri">arXiv:1304.1311</ext-link> [astro-ph.HE]</mixed-citation></ref><ref id="CR48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drury</surname><given-names>LO</given-names></name><name><surname>Falle</surname><given-names>SAEG</given-names></name></person-group><article-title xml:lang="en">On the stability of shocks modified by particle acceleration</article-title><source>MNRAS</source><year>1986</year><volume>223</volume><fpage>353</fpage><pub-id pub-id-type="doi">10.1093/mnras/223.2.353</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0607.76068</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1986MNRAS.223..353D</pub-id></mixed-citation></ref><ref id="CR49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drury</surname><given-names>LO</given-names></name><name><surname>Voelk</surname><given-names>JH</given-names></name></person-group><article-title xml:lang="en">Hydromagnetic shock structure in the presence of cosmic rays</article-title><source>Astrophys J</source><year>1981</year><volume>248</volume><fpage>344</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1086/159159</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1981ApJ...248..344D</pub-id></mixed-citation></ref><ref id="CR50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubois</surname><given-names>Y</given-names></name><name><surname>Commerçon</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">An implicit scheme for solving the anisotropic diffusion of heat and cosmic rays in the RAMSES code</article-title><source>Astron Astrophys</source><year>2016</year><volume>585</volume><fpage>A138</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201527126</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016A&amp;A...585A.138D</pub-id><comment>arXiv:1509.07037 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubois</surname><given-names>Y</given-names></name><name><surname>Commerçon</surname><given-names>B</given-names></name><name><surname>Ar</surname><given-names>Marcowith</given-names></name><name><surname>Brahimi</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Shock-accelerated cosmic rays and streaming instability in the adaptive mesh refinement code Ramses</article-title><source>Astron Astrophys</source><year>2019</year><volume>631</volume><fpage>A121</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201936275</pub-id><comment>arXiv:1907.04300 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duvernois</surname><given-names>MA</given-names></name><name><surname>Simpson</surname><given-names>JA</given-names></name><name><surname>Thayer</surname><given-names>MR</given-names></name></person-group><article-title xml:lang="en">Interstellar propagation of cosmic rays: analysis of the Ulysses primary and secondary elemental abundances</article-title><source>Astron Astrophys</source><year>1996</year><volume>316</volume><fpage>555</fpage><lpage>563</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996A&amp;A...316..555D</pub-id></mixed-citation></ref><ref id="CR53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ehlert</surname><given-names>K</given-names></name><name><surname>Weinberger</surname><given-names>R</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Simulations of the dynamics of magnetized jets and cosmic rays in galaxy clusters</article-title><source>MNRAS</source><year>2018</year><volume>481</volume><issue>3</issue><fpage>2878</fpage><lpage>2900</lpage><pub-id pub-id-type="doi">10.1093/mnras/sty2397</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018MNRAS.481.2878E</pub-id><comment>arXiv:1806.05679 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elmegreen</surname><given-names>BG</given-names></name><name><surname>Scalo</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Interstellar turbulence I: observations and processes</article-title><source>Annu Rev Astron Astrophys</source><year>2004</year><volume>42</volume><fpage>211</fpage><lpage>273</lpage><pub-id pub-id-type="doi">10.1146/annurev.astro.41.011802.094859</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ARA&amp;A..42..211E</pub-id><comment>10.1146/annurev.astro.41.011802.094859</comment></mixed-citation></ref><ref id="CR55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enßlin</surname><given-names>T</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Subramanian</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Cosmic ray transport in galaxy clusters: implications for radio halos, gamma-ray signatures, and cool core heating</article-title><source>Astron Astrophys</source><year>2011</year><volume>527</volume><fpage>A99</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201015652</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011A&amp;A...527A..99E</pub-id><comment>arXiv:1008.4717 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR1011"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>CR</given-names></name><name><surname>Hawley</surname><given-names>JF</given-names></name></person-group><article-title xml:lang="en">Simulation of magnetohydrodynamic flows: a constrained transport model</article-title><source>Astrophys J</source><year>1988</year><volume>332</volume><fpage>659</fpage><pub-id pub-id-type="doi">10.1086/166684</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1988ApJ...332..659E</pub-id></mixed-citation></ref><ref id="CR56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Everett</surname><given-names>JE</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name><name><surname>Benjamin</surname><given-names>RA</given-names></name><name><surname>McCammon</surname><given-names>D</given-names></name><name><surname>Rocks</surname><given-names>L</given-names></name><name><surname>John Gallagher</surname><given-names>IS</given-names></name></person-group><article-title xml:lang="en">The Milky Way’s Kiloparsec-Scale wind: a hybrid cosmic-ray and thermally driven outflow</article-title><source>Astrophys J</source><year>2008</year><volume>674</volume><issue>1</issue><fpage>258</fpage><lpage>270</lpage><pub-id pub-id-type="doi">10.1086/524766</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008ApJ...674..258E</pub-id><comment>arXiv:0710.3712 [astro-ph]</comment></mixed-citation></ref><ref id="CR57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evoli</surname><given-names>C</given-names></name><name><surname>Yan</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Cosmic ray propagation in galactic turbulence</article-title><source>Astrophys J</source><year>2014</year><volume>782</volume><fpage>36</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/782/1/36</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014ApJ...782...36E</pub-id><comment>arXiv:1310.5732 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evoli</surname><given-names>C</given-names></name><name><surname>Gaggero</surname><given-names>D</given-names></name><name><surname>Vittino</surname><given-names>A</given-names></name><name><surname>Di Bernardo</surname><given-names>G</given-names></name><name><surname>Di Mauro</surname><given-names>M</given-names></name><name><surname>Ligorini</surname><given-names>A</given-names></name><name><surname>Ullio</surname><given-names>P</given-names></name><name><surname>Grasso</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray propagation with DRAGON2: I. numerical solver and astrophysical ingredients</article-title><source>JCAP</source><year>2017</year><volume>2</volume><fpage>015</fpage><pub-id pub-id-type="doi">10.1088/1475-7516/2017/02/015</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017JCAP...02..015E</pub-id><comment>arXiv:1607.07886 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR59"><mixed-citation publication-type="other">Falgout RD, Yang UM (2002) hypre: A library of high performance preconditioners. In: Sloot PMA, Hoekstra AG, Tan CJK, Dongarra JJ (eds) Computational science—ICCS 2002. Lecture notes in computer science, vol 2331. Springer, Berlin, pp 632–641. <ext-link xlink:href="10.1007/3-540-47789-6_66" ext-link-type="doi">https://doi.org/10.1007/3-540-47789-6_66</ext-link></mixed-citation></ref><ref id="CR60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falle</surname><given-names>SAEG</given-names></name><name><surname>Giddings</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Time-dependent cosmic ray modified shocks</article-title><source>MNRAS</source><year>1987</year><volume>225</volume><fpage>399</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1093/mnras/225.2.399</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0617.76073</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1987MNRAS.225..399F</pub-id></mixed-citation></ref><ref id="CR61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farber</surname><given-names>R</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>HYK</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">Impact of cosmic-ray transport on galactic winds</article-title><source>Astrophys J</source><year>2018</year><volume>856</volume><fpage>112</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aab26d</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...856..112F</pub-id><comment>arXiv:1707.04579 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferriere</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Global model of the interstellar medium in our galaxy with new constraints on the hot gas component</article-title><source>Astrophys J</source><year>1998</year><volume>497</volume><fpage>759</fpage><pub-id pub-id-type="doi">10.1086/305469</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...497..759F</pub-id></mixed-citation></ref><ref id="CR63"><mixed-citation publication-type="other">Ferrière KM (2001) The interstellar environment of our galaxy. Rev Mod Phys 73:1031–1066. <ext-link xlink:href="10.1103/RevModPhys.73.1031" ext-link-type="doi">https://doi.org/10.1103/RevModPhys.73.1031</ext-link>. astro-ph/0106359</mixed-citation></ref><ref id="CR64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fletcher</surname><given-names>A</given-names></name><name><surname>Beck</surname><given-names>R</given-names></name><name><surname>Shukurov</surname><given-names>A</given-names></name><name><surname>Berkhuijsen</surname><given-names>EM</given-names></name><name><surname>Horellou</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Magnetic fields and spiral arms in the galaxy M51</article-title><source>MNRAS</source><year>2011</year><volume>412</volume><fpage>2396</fpage><lpage>2416</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2010.18065.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011MNRAS.412.2396F</pub-id><comment>arXiv:1001.5230 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>A</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Oblique magnetohydrodynamic cosmic-ray-modified shocks: Two-fluid numerical simulations</article-title><source>Astrophys J Suppl</source><year>1994</year><volume>90</volume><fpage>975</fpage><lpage>980</lpage><pub-id pub-id-type="doi">10.1086/191935.</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994ApJS...90..975F</pub-id><comment>astro-ph/9404073</comment></mixed-citation></ref><ref id="CR66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>A</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Time-dependent simulation of oblique MHD cosmic-ray shocks using the two-fluid model</article-title><source>Astrophys J</source><year>1995</year><volume>441</volume><fpage>629</fpage><lpage>643</lpage><pub-id pub-id-type="doi">10.1086/175388</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995ApJ...441..629F</pub-id></mixed-citation></ref><ref id="CR67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabici</surname><given-names>S</given-names></name><name><surname>Evoli</surname><given-names>C</given-names></name><name><surname>Gaggero</surname><given-names>D</given-names></name><name><surname>Lipari</surname><given-names>P</given-names></name><name><surname>Mertsch</surname><given-names>P</given-names></name><name><surname>Orlando</surname><given-names>E</given-names></name><name><surname>Strong</surname><given-names>A</given-names></name><name><surname>Vittino</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">The origin of Galactic cosmic rays: challenges to the standard paradigm</article-title><source>Int J Mod Phys D</source><year>2019</year><volume>28</volume><issue>15</issue><fpage>1930022</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1142/S0218271819300222</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019IJMPD..2830022G</pub-id><comment>arXiv:1903.11584 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaggero</surname><given-names>D</given-names></name><name><surname>Maccione</surname><given-names>L</given-names></name><name><surname>Grasso</surname><given-names>D</given-names></name><name><surname>Di Bernardo</surname><given-names>G</given-names></name><name><surname>Evoli</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">PAMELA and AMS-02 e<inline-formula id="IEq541"><alternatives><mml:math id="IEq541_Math"><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:math><tex-math id="IEq541_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq541.gif"/></alternatives></inline-formula> and e<inline-formula id="IEq542"><alternatives><mml:math id="IEq542_Math"><mml:msup><mml:mrow/><mml:mo>-</mml:mo></mml:msup></mml:math><tex-math id="IEq542_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq542.gif"/></alternatives></inline-formula> spectra are reproduced by three-dimensional cosmic-ray modeling</article-title><source>Phys Rev D</source><year>2014</year><volume>89</volume><issue>8</issue><fpage>083007</fpage><pub-id pub-id-type="doi">10.1103/PhysRevD.89.083007</pub-id><comment>arXiv:1311.5575 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR69"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gaisser</surname><given-names>TK</given-names></name></person-group><source>Cosmic rays and particle physics</source><year>1991</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name></mixed-citation></ref><ref id="CR70"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaisser</surname><given-names>TK</given-names></name><name><surname>Stanev</surname><given-names>T</given-names></name><name><surname>Tilav</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Cosmic ray energy spectrum from measurements of air showers</article-title><source>Front Phys</source><year>2013</year><volume>8</volume><issue>6</issue><fpage>748</fpage><lpage>758</lpage><pub-id pub-id-type="doi">10.1007/s11467-013-0319-7</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013FrPhy...8..748G</pub-id><comment>arXiv:1303.3565 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Munoz</surname><given-names>M</given-names></name><name><surname>Mason</surname><given-names>GM</given-names></name><name><surname>Simpson</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">The isotopic composition of galactic cosmic-ray lithium, beryllium, and boron</article-title><source>Astrophys J</source><year>1975</year><volume>201</volume><fpage>L145</fpage><lpage>L148</lpage><pub-id pub-id-type="doi">10.1086/181962</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975ApJ...201L.145G</pub-id></mixed-citation></ref><ref id="CR72"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Munoz</surname><given-names>M</given-names></name><name><surname>Simpson</surname><given-names>JA</given-names></name><name><surname>Guzik</surname><given-names>TG</given-names></name><name><surname>Wefel</surname><given-names>JP</given-names></name><name><surname>Margolis</surname><given-names>SH</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray propagation in the Galaxy and in the heliosphere—the path-length distribution at low energy</article-title><source>Astrophys J Suppl</source><year>1987</year><volume>64</volume><fpage>269</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1086/191197</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1987ApJS...64..269G</pub-id></mixed-citation></ref><ref id="CR73"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genel</surname><given-names>S</given-names></name><name><surname>Vogelsberger</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>D</given-names></name><name><surname>Sijacki</surname><given-names>D</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Hernquist</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Following the flow: tracer particles in astrophysical fluid simulations</article-title><source>MNRAS</source><year>2013</year><volume>435</volume><issue>2</issue><fpage>1426</fpage><lpage>1442</lpage><pub-id pub-id-type="doi">10.1093/mnras/stt1383</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013MNRAS.435.1426G</pub-id><comment>arXiv:1305.2195 [astro-ph.IM]</comment></mixed-citation></ref><ref id="CR74"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giacalone</surname><given-names>J</given-names></name><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Charged-particle motion in multidimensional magnetic-field turbulence</article-title><source>Astrophys J</source><year>1994</year><volume>430</volume><fpage>L137</fpage><lpage>L140</lpage><pub-id pub-id-type="doi">10.1086/187457</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994ApJ...430L.137G</pub-id></mixed-citation></ref><ref id="CR75"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giacalone</surname><given-names>J</given-names></name><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">The transport of cosmic rays across a turbulent magnetic field</article-title><source>Astrophys J</source><year>1999</year><volume>520</volume><fpage>204</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1086/307452</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1999ApJ...520..204G</pub-id></mixed-citation></ref><ref id="CR76"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ginzburg</surname><given-names>VL</given-names></name><name><surname>Ptuskin</surname><given-names>VS</given-names></name></person-group><article-title xml:lang="en">On the origin of cosmic rays: some problems in high-energy astrophysics</article-title><source>Rev Mod Phys</source><year>1976</year><volume>48</volume><fpage>161</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.48.161</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1976RvMP...48..161G</pub-id></mixed-citation></ref><ref id="CR77"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ginzburg</surname><given-names>VL</given-names></name><name><surname>Syrovatskii</surname><given-names>SI</given-names></name></person-group><source>The origin of cosmic rays</source><year>1964</year><publisher-loc>New York</publisher-loc><publisher-name>Macmillan</publisher-name><pub-id pub-id-type="doi">10.1016/B978-0-08-013526-7.50011-6</pub-id></mixed-citation></ref><ref id="CR78"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Naab</surname><given-names>T</given-names></name><name><surname>Walch</surname><given-names>S</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Mac Low</surname><given-names>MM</given-names></name><name><surname>Ostriker</surname><given-names>JP</given-names></name><name><surname>Gatto</surname><given-names>A</given-names></name><name><surname>Peters</surname><given-names>T</given-names></name><name><surname>Wünsch</surname><given-names>R</given-names></name><name><surname>Glover</surname><given-names>SCO</given-names></name><name><surname>Klessen</surname><given-names>RS</given-names></name><name><surname>Clark</surname><given-names>PC</given-names></name><name><surname>Baczynski</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Launching cosmic-ray-driven outflows from the magnetized interstellar medium</article-title><source>Astrophys J</source><year>2016</year><volume>816</volume><fpage>L19</fpage><pub-id pub-id-type="doi">10.3847/2041-8205/816/2/L19</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...816L..19G</pub-id><comment>arXiv:1509.07247</comment></mixed-citation></ref><ref id="CR79"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Naab</surname><given-names>T</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Walch</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Cooler and smoother—the impact of cosmic rays on the phase structure of galactic outflows</article-title><source>MNRAS</source><year>2018</year><volume>479</volume><fpage>3042</fpage><lpage>3067</lpage><pub-id pub-id-type="doi">10.1093/mnras/sty1653</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018MNRAS.479.3042G</pub-id><comment>arXiv:1805.09333</comment></mixed-citation></ref><ref id="CR80"><mixed-citation publication-type="other">Girichidis P, Pfrommer C, Hanasz M, Naab T (2019) Spectrally resolved cosmic ray hydrodynamics—I. Spectral scheme. MNRAS, p 2648. <ext-link xlink:href="10.1093/mnras/stz2961" ext-link-type="doi">https://doi.org/10.1093/mnras/stz2961</ext-link>. <ext-link xlink:href="http://arxiv.org/abs/1909.12840" ext-link-type="uri">arXiv:1909.12840</ext-link> [astro-ph.HE]</mixed-citation></ref><ref id="CR81"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Offner</surname><given-names>SSR</given-names></name><name><surname>Kritsuk</surname><given-names>AG</given-names></name><name><surname>Klessen</surname><given-names>RS</given-names></name><name><surname>Hennebelle</surname><given-names>P</given-names></name><name><surname>Kruijssen</surname><given-names>JMD</given-names></name><name><surname>Krause</surname><given-names>MGH</given-names></name><name><surname>Glover</surname><given-names>SCO</given-names></name><name><surname>Padovani</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Physical processes in star formation</article-title><source>Space Sci Rev</source><year>2020</year><volume>216</volume><issue>4</issue><fpage>68</fpage><pub-id pub-id-type="doi">10.1007/s11214-020-00693-8</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020SSRv..216...68G</pub-id><comment>arXiv:2005.06472 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR82"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Naab</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Spectrally resolved cosmic ray hydrodynamics—I. Spectral scheme</article-title><source>MNRAS</source><year>2020</year><volume>491</volume><issue>1</issue><fpage>993</fpage><lpage>1007</lpage><pub-id pub-id-type="doi">10.1093/mnras/stz2961</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020MNRAS.491..993G</pub-id><comment>arXiv:1909.12840 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR83"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glimm</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Solutions in the large for nonlinear hyperbolic systems of equations</article-title><source>Commun Pure Appl Math</source><year>1965</year><volume>18</volume><issue>4</issue><fpage>697</fpage><lpage>715</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">194770</pub-id><pub-id pub-id-type="doi">10.1002/cpa.3160180408</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0141.28902</pub-id></mixed-citation></ref><ref id="CR84"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldreich</surname><given-names>P</given-names></name><name><surname>Sridhar</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Toward a theory of interstellar turbulence. II. Strong Alfvénic turbulence</article-title><source>Astrophys J</source><year>1995</year><volume>438</volume><fpage>763</fpage><lpage>775</lpage><pub-id pub-id-type="doi">10.1086/175121</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995ApJ...438..763G</pub-id></mixed-citation></ref><ref id="CR85"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grenier</surname><given-names>IA</given-names></name><name><surname>Black</surname><given-names>JH</given-names></name><name><surname>Strong</surname><given-names>AW</given-names></name></person-group><article-title xml:lang="en">The nine lives of cosmic rays in galaxies</article-title><source>Annu Rev Astron Astrophys</source><year>2015</year><volume>53</volume><fpage>199</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1146/annurev-astro-082214-122457</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015ARA&amp;A..53..199G</pub-id></mixed-citation></ref><ref id="CR86"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Günter</surname><given-names>S</given-names></name><name><surname>Yu</surname><given-names>Q</given-names></name><name><surname>Krüger</surname><given-names>J</given-names></name><name><surname>Lackner</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Modelling of heat transport in magnetised plasmas using non-aligned coordinates</article-title><source>J Comput Phys</source><year>2005</year><volume>209</volume><issue>1</issue><fpage>354</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2005.03.021</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1329.76405</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005JCoPh.209..354G</pub-id></mixed-citation></ref><ref id="CR87"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Mignone</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A numerical approach to the non-uniqueness problem of cosmic ray two-fluid equations at shocks</article-title><source>MNRAS</source><year>2021</year><volume>502</volume><issue>2</issue><fpage>2733</fpage><lpage>2749</lpage><pub-id pub-id-type="doi">10.1093/mnras/stab142</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2021MNRAS.502.2733G</pub-id><comment>arXiv:1906.07200 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR88"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray evolution in parker-unstable galactic magnetic fields</article-title><source>Astrophys J</source><year>2000</year><volume>543</volume><fpage>235</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1086/317077</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2000ApJ...543..235H</pub-id></mixed-citation></ref><ref id="CR89"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Incorporation of cosmic ray transport into the ZEUS MHD code. Application for studies of Parker instability in the ISM</article-title><source>Astron Astrophys</source><year>2003</year><volume>412</volume><fpage>331</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20031433</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003A&amp;A...412..331H</pub-id></mixed-citation></ref><ref id="CR90"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Kowal</surname><given-names>G</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Amplification of galactic magnetic fields by the cosmic-ray-driven dynamo</article-title><source>Astrophys J</source><year>2004</year><volume>605</volume><fpage>L33</fpage><lpage>L36</lpage><pub-id pub-id-type="doi">10.1086/420697</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApJ...605L..33H</pub-id></mixed-citation></ref><ref id="CR91"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Kowal</surname><given-names>G</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Cosmic ray driven dynamo in galactic disks: effects of resistivity, SN rate and spiral arms</article-title><source>Astron Nachr</source><year>2006</year><volume>327</volume><fpage>469</fpage><pub-id pub-id-type="doi">10.1002/asna.200610559</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006AN....327..469H</pub-id></mixed-citation></ref><ref id="CR92"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Kowal</surname><given-names>G</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray-driven dynamo in galactic disks. A parameter study</article-title><source>Astron Astrophys</source><year>2009</year><volume>498</volume><fpage>335</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1051/0004-6361/200810279</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009A&amp;A...498..335H</pub-id><comment>arXiv:0812.3906</comment></mixed-citation></ref><ref id="CR93"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Wóltański</surname><given-names>D</given-names></name><name><surname>Kowalik</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Global galactic dynamo driven by cosmic rays and exploding magnetized stars</article-title><source>Astrophys J</source><year>2009</year><volume>706</volume><fpage>L155</fpage><lpage>L159</lpage><pub-id pub-id-type="doi">10.1088/0004-637X/706/1/L155</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009ApJ...706L.155H</pub-id><comment>arXiv:0907.4891 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR94"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Lesch</surname><given-names>H</given-names></name><name><surname>Naab</surname><given-names>T</given-names></name><name><surname>Gawryszczak</surname><given-names>A</given-names></name><name><surname>Kowalik</surname><given-names>K</given-names></name><name><surname>Wóltański</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Cosmic rays can drive strong outflows from gas-rich high-redshift disk galaxies</article-title><source>Astrophys J</source><year>2013</year><volume>777</volume><fpage>L38</fpage><pub-id pub-id-type="doi">10.1088/2041-8205/777/2/L38</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ApJ...777L..38H</pub-id><comment>arXiv:1310.3273</comment></mixed-citation></ref><ref id="CR95"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harten</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">High resolution schemes for hyperbolic conservation laws</article-title><source>J Comput Phys</source><year>1983</year><volume>49</volume><issue>3</issue><fpage>357</fpage><lpage>393</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">701178</pub-id><pub-id pub-id-type="doi">10.1016/0021-9991(83)90136-5</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0565.65050</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1983JCoPh..49..357H</pub-id></mixed-citation></ref><ref id="CR96"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heintz</surname><given-names>E</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">The parker instability with cosmic-ray streaming</article-title><source>Astrophys J</source><year>2018</year><volume>860</volume><issue>2</issue><fpage>97</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aac208</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...860...97H</pub-id><comment>arXiv:1803.00584 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR97"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heintz</surname><given-names>E</given-names></name><name><surname>Bustard</surname><given-names>C</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">The role of the parker instability in structuring the interstellar medium</article-title><source>Astrophys J</source><year>2020</year><volume>891</volume><issue>2</issue><fpage>157</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/ab7453</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020ApJ...891..157H</pub-id><comment>arXiv:1910.03588 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR98"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Higdon</surname><given-names>JC</given-names></name><name><surname>Lingenfelter</surname><given-names>RE</given-names></name></person-group><article-title xml:lang="en">The myriad-source model of cosmic rays. I. Steady state age and path length distributions</article-title><source>Astrophys J</source><year>2003</year><volume>582</volume><fpage>330</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1086/344510</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003ApJ...582..330H</pub-id></mixed-citation></ref><ref id="CR99"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holguin</surname><given-names>F</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Lazarian</surname><given-names>A</given-names></name><name><surname>Farber</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>HYK</given-names></name></person-group><article-title xml:lang="en">Role of cosmic-ray streaming and turbulent damping in driving galactic winds</article-title><source>MNRAS</source><year>2019</year><volume>490</volume><issue>1</issue><fpage>1271</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1093/mnras/stz2568</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019MNRAS.490.1271H</pub-id><comment>arXiv:1807.05494 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR100"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopkins</surname><given-names>PF</given-names></name><name><surname>Squire</surname><given-names>J</given-names></name><name><surname>Chan</surname><given-names>TK</given-names></name><name><surname>Quataert</surname><given-names>E</given-names></name><name><surname>Ji</surname><given-names>S</given-names></name><name><surname>Kereš</surname><given-names>D</given-names></name><name><surname>Faucher-Giguère</surname><given-names>CA</given-names></name></person-group><article-title xml:lang="en">Testing physical models for cosmic ray transport coefficients on galactic scales: self-confinement and extrinsic turbulence at <inline-formula id="IEq545"><alternatives><mml:math id="IEq545_Math"><mml:mo>∼</mml:mo></mml:math><tex-math id="IEq545_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\sim }}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq545.gif"/></alternatives></inline-formula>GeV energies</article-title><source>MNRAS</source><year>2021</year><volume>501</volume><issue>3</issue><fpage>4184</fpage><lpage>4213</lpage><pub-id pub-id-type="doi">10.1093/mnras/staa3691</pub-id><comment>arXiv:2002.06211 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR101"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Indriolo</surname><given-names>N</given-names></name><name><surname>McCall</surname><given-names>BJ</given-names></name></person-group><article-title xml:lang="en">Investigating the cosmic-ray ionization rate in the galactic diffuse interstellar medium through observations of H<inline-formula id="IEq547"><alternatives><mml:math id="IEq547_Math"><mml:msubsup><mml:mrow/><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:msubsup></mml:math><tex-math id="IEq547_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{+}_{3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq547.gif"/></alternatives></inline-formula></article-title><source>Astrophys J</source><year>2012</year><volume>745</volume><issue>1</issue><fpage>91</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/745/1/91</pub-id><comment>arXiv:1111.6936 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR102"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Indriolo</surname><given-names>N</given-names></name><name><surname>Geballe</surname><given-names>TR</given-names></name><name><surname>Oka</surname><given-names>T</given-names></name><name><surname>McCall</surname><given-names>BJ</given-names></name></person-group><article-title xml:lang="en">H<inline-formula id="IEq549"><alternatives><mml:math id="IEq549_Math"><mml:msubsup><mml:mrow/><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:msubsup></mml:math><tex-math id="IEq549_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{+}_{3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq549.gif"/></alternatives></inline-formula> in diffuse interstellar clouds: a tracer for the cosmic-ray ionization rate</article-title><source>Astrophys J</source><year>2007</year><volume>671</volume><issue>2</issue><fpage>1736</fpage><lpage>1747</lpage><pub-id pub-id-type="doi">10.1086/523036</pub-id><comment>arXiv:0709.1114 [astro-ph]</comment></mixed-citation></ref><ref id="CR103"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ipavich</surname><given-names>FM</given-names></name></person-group><article-title xml:lang="en">Galactic winds driven by cosmic rays</article-title><source>Astrophys J</source><year>1975</year><volume>196</volume><fpage>107</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1086/153397</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975ApJ...196..107I</pub-id></mixed-citation></ref><ref id="CR104"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivlev</surname><given-names>AV</given-names></name><name><surname>Dogiel</surname><given-names>VA</given-names></name><name><surname>Chernyshov</surname><given-names>DO</given-names></name><name><surname>Caselli</surname><given-names>P</given-names></name><name><surname>Ko</surname><given-names>CM</given-names></name><name><surname>Cheng</surname><given-names>KS</given-names></name></person-group><article-title xml:lang="en">Penetration of cosmic rays into dense molecular clouds: role of diffuse envelopes</article-title><source>Astrophys J</source><year>2018</year><volume>855</volume><issue>1</issue><fpage>23</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aaadb9</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...855...23I</pub-id><comment>arXiv:1802.02612 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR105"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>S</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Simpson</surname><given-names>CM</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">The dependence of cosmic ray-driven galactic winds on halo mass</article-title><source>MNRAS</source><year>2018</year><volume>475</volume><issue>1</issue><fpage>570</fpage><lpage>584</lpage><pub-id pub-id-type="doi">10.1093/mnras/stx3221</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018MNRAS.475..570J</pub-id><comment>arXiv:1712.04947 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR106"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>YF</given-names></name><name><surname>Oh</surname><given-names>SP</given-names></name></person-group><article-title xml:lang="en">A new numerical scheme for cosmic-ray transport</article-title><source>Astrophys J</source><year>2018</year><volume>854</volume><issue>1</issue><fpage>5</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aaa6ce</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...854....5J</pub-id><comment>arXiv:1712.07117 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR107"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Propagation of cosmic rays in the solar wind</article-title><source>Rev Geophys Space Phys</source><year>1971</year><volume>9</volume><fpage>27</fpage><pub-id pub-id-type="doi">10.1029/RG009i001p00027</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1971RvGSP...9...27J</pub-id></mixed-citation></ref><ref id="CR108"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Consequences of a lifetime greater than 10 to the 7th power years for galactic cosmic rays</article-title><source>Astrophys J</source><year>1976</year><volume>208</volume><fpage>900</fpage><lpage>902</lpage><pub-id pub-id-type="doi">10.1086/154678</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1976ApJ...208..900J</pub-id></mixed-citation></ref><ref id="CR109"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>FC</given-names></name></person-group><article-title xml:lang="en">The history of cosmic rays in a dynamical halo: a retrodictive probability approach</article-title><source>Astrophys J</source><year>1978</year><volume>222</volume><fpage>1097</fpage><lpage>1103</lpage><pub-id pub-id-type="doi">10.1086/156226</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1978ApJ...222.1097J</pub-id></mixed-citation></ref><ref id="CR110"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>FC</given-names></name></person-group><article-title xml:lang="en">The dynamical halo and the variation of cosmic-ray path length with energy</article-title><source>Astrophys J</source><year>1979</year><volume>229</volume><fpage>747</fpage><lpage>752</lpage><pub-id pub-id-type="doi">10.1086/157010</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1979ApJ...229..747J</pub-id></mixed-citation></ref><ref id="CR113"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Time-dependent evolution of cosmic-ray-mediated shocks in the two-fluid model</article-title><source>Astrophys J</source><year>1990</year><volume>363</volume><fpage>499</fpage><lpage>514</lpage><pub-id pub-id-type="doi">10.1086/169361</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1990ApJ...363..499J</pub-id></mixed-citation></ref><ref id="CR114"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray acceleration during the impact of shocks on dense clouds</article-title><source>Astrophys J</source><year>1993</year><volume>402</volume><fpage>560</fpage><lpage>573</lpage><pub-id pub-id-type="doi">10.1086/172158</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1993ApJ...402..560J</pub-id></mixed-citation></ref><ref id="CR115"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">An efficient numerical scheme for simulating particle acceleration in evolving cosmic-ray modified shocks</article-title><source>Astropart Phys</source><year>2005</year><volume>24</volume><fpage>75</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.astropartphys.2005.05.006</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005APh....24...75J</pub-id></mixed-citation></ref><ref id="CR116"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Tregillis</surname><given-names>IL</given-names></name></person-group><article-title xml:lang="en">Cosmic bullets as particle accelerators and radio sources</article-title><source>Astrophys J</source><year>1994</year><volume>432</volume><fpage>194</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1086/174560</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994ApJ...432..194J</pub-id></mixed-citation></ref><ref id="CR117"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Engel</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Simulating electron transport and synchrotron emission in radio galaxies: shock acceleration and synchrotron aging in axisymmetric flows</article-title><source>Astrophys J</source><year>1999</year><volume>512</volume><fpage>105</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1086/306772.</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1999ApJ...512..105J</pub-id><comment>astro-ph/9809081</comment></mixed-citation></ref><ref id="CR111"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>FC</given-names></name><name><surname>Lukasiak</surname><given-names>A</given-names></name><name><surname>Ptuskin</surname><given-names>V</given-names></name><name><surname>Webber</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">The modified weighted slab technique: models and results</article-title><source>Astrophys J</source><year>2001</year><volume>547</volume><fpage>264</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1086/318358</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001ApJ...547..264J</pub-id></mixed-citation></ref><ref id="CR112"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>FC</given-names></name><name><surname>Lukasiak</surname><given-names>A</given-names></name><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Webber</surname><given-names>WR</given-names></name></person-group><article-title xml:lang="en">K-capture cosmic ray secondaries and reacceleration</article-title><source>Adv Space Res</source><year>2001</year><volume>27</volume><fpage>737</fpage><lpage>741</lpage><pub-id pub-id-type="doi">10.1016/S0273-1177(01)00113-2</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001AdSpR..27..737J</pub-id></mixed-citation></ref><ref id="CR118"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jubelgas</surname><given-names>M</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Enßlin</surname><given-names>T</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Cosmic ray feedback in hydrodynamical simulations of galaxy formation</article-title><source>Astron Astrophys</source><year>2008</year><volume>481</volume><fpage>33</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20065295</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1140.85322</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008A&amp;A...481...33J</pub-id><comment>astro-ph/0603485</comment></mixed-citation></ref><ref id="CR119"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname><given-names>BI</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Radio emission from a young supernova remnant interacting with an interstellar cloud: magnetohydrodynamic simulation with relativistic electrons</article-title><source>Astrophys J</source><year>1999</year><volume>511</volume><fpage>774</fpage><lpage>791</lpage><pub-id pub-id-type="doi">10.1086/306694</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1999ApJ...511..774J</pub-id></mixed-citation></ref><ref id="CR120"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname><given-names>BI</given-names></name><name><surname>Clarke</surname><given-names>DA</given-names></name><name><surname>Norman</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">The evolution of cosmic-ray-mediated magnetohydrodynamic shocks: a two-fluid approach</article-title><source>Astrophys J</source><year>1994</year><volume>429</volume><fpage>748</fpage><pub-id pub-id-type="doi">10.1086/174358</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994ApJ...429..748J</pub-id></mixed-citation></ref><ref id="CR121"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Diffusive cosmic-ray acceleration—two-fluid models with in situ injection</article-title><source>Astrophys J</source><year>1990</year><volume>353</volume><fpage>149</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1086/168601</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1990ApJ...353..149K</pub-id></mixed-citation></ref><ref id="CR122"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Diffusive shock acceleration in oblique magnetohydrodynamic shocks: comparison with Monte Carlo methods and observations</article-title><source>Astrophys J</source><year>1997</year><volume>476</volume><fpage>875</fpage><pub-id pub-id-type="doi">10.1086/303646</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1997ApJ...476..875K</pub-id></mixed-citation></ref><ref id="CR123"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Self-similar evolution of cosmic-ray-modified quasi-parallel plane shocks</article-title><source>Astropart Phys</source><year>2007</year><volume>28</volume><issue>2</issue><fpage>232</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1016/j.astropartphys.2007.05.007</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007APh....28..232K</pub-id><comment>arXiv:0705.3274 [astro-ph]</comment></mixed-citation></ref><ref id="CR124"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Diffusive shock acceleration at cosmological shock waves</article-title><source>Astrophys J</source><year>2013</year><volume>764</volume><issue>1</issue><fpage>95</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/764/1/95</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ApJ...764...95K</pub-id><comment>arXiv:1212.3246 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR125"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennel</surname><given-names>CF</given-names></name><name><surname>Engelmann</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Velocity space diffusion from weak plasma turbulence in a magnetic field</article-title><source>Phys Fluids</source><year>1966</year><volume>9</volume><issue>12</issue><fpage>2377</fpage><lpage>2388</lpage><pub-id pub-id-type="doi">10.1063/1.1761629</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1966PhFl....9.2377K</pub-id></mixed-citation></ref><ref id="CR126"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keshet</surname><given-names>U</given-names></name><name><surname>Waxman</surname><given-names>E</given-names></name><name><surname>Loeb</surname><given-names>A</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Hernquist</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Gamma rays from intergalactic shocks</article-title><source>Astrophys J</source><year>2003</year><volume>585</volume><issue>1</issue><fpage>128</fpage><lpage>150</lpage><pub-id pub-id-type="doi">10.1086/345946</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003ApJ...585..128K</pub-id><comment>arXiv:astro-ph/0202318 [astro-ph]</comment></mixed-citation></ref><ref id="CR127"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kissmann</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">PICARD: a novel code for the Galactic Cosmic Ray propagation problem</article-title><source>Astropart Phys</source><year>2014</year><volume>55</volume><fpage>37</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1016/j.astropartphys.2014.02.002</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014APh....55...37K</pub-id><comment>arXiv:1401.4035 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR128"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kotera</surname><given-names>K</given-names></name><name><surname>Olinto</surname><given-names>AV</given-names></name></person-group><article-title xml:lang="en">The astrophysics of ultrahigh-energy cosmic rays</article-title><source>Annu Rev Astron Astrophys</source><year>2011</year><volume>49</volume><issue>1</issue><fpage>119</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1146/annurev-astro-081710-102620</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011ARA&amp;A..49..119K</pub-id><comment>arXiv:1101.4256 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR129"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kotera</surname><given-names>K</given-names></name><name><surname>Silk</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Ultrahigh-energy Cosmic Rays and Black Hole Mergers</article-title><source>Astrophys J</source><year>2016</year><volume>823</volume><issue>2</issue><fpage>L29</fpage><pub-id pub-id-type="doi">10.3847/2041-8205/823/2/L29</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...823L..29K</pub-id><comment>arXiv:1602.06961 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR130"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kowal</surname><given-names>G</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Dynamo coefficients in Parker unstable disks with cosmic rays and shear. The new methods of estimation</article-title><source>Astron Astrophys</source><year>2006</year><volume>445</volume><fpage>915</fpage><lpage>929</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20053582</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006A&amp;A...445..915K</pub-id></mixed-citation></ref><ref id="CR131"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krause</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Magnetic fields and star formation in spiral galaxies</article-title><source>Rev Mex Astron Astrofis Conf Ser Rev Mex Astron Astrofis</source><year>2009</year><volume>36</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009RMxAC..36...25K</pub-id><comment>arXiv:0806.2060</comment></mixed-citation></ref><ref id="CR132"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krumholz</surname><given-names>MR</given-names></name><name><surname>Crocker</surname><given-names>RM</given-names></name><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Lazarian</surname><given-names>A</given-names></name><name><surname>Rosevear</surname><given-names>MT</given-names></name><name><surname>Bedwell-Wilson</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Cosmic ray transport in starburst galaxies</article-title><source>MNRAS</source><year>2020</year><volume>493</volume><issue>2</issue><fpage>2817</fpage><lpage>2833</lpage><pub-id pub-id-type="doi">10.1093/mnras/staa493</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020MNRAS.493.2817K</pub-id><comment>arXiv:1911.09774 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR133"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krymskii</surname><given-names>GF</given-names></name></person-group><article-title xml:lang="en">A regular mechanism for the acceleration of charged particles on the front of a shock wave</article-title><source>Akad Nauk SSSR Dokl</source><year>1977</year><volume>234</volume><fpage>1306</fpage><lpage>1308</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1977DoSSR.234.1306K</pub-id></mixed-citation></ref><ref id="CR134"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kudoh</surname><given-names>Y</given-names></name><name><surname>Hanawa</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">A new scheme to solve the two-fluid cosmic-ray magnetohydrodynamic equations</article-title><source>J Phys Conf Ser</source><year>2016</year><volume>719</volume><fpage>012021</fpage><pub-id pub-id-type="doi">10.1088/1742-6596/719/1/012021</pub-id></mixed-citation></ref><ref id="CR135"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kulpa-Dybeł</surname><given-names>K</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Kulesza-Zydzik</surname><given-names>B</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Kowal</surname><given-names>G</given-names></name><name><surname>Wóltański</surname><given-names>D</given-names></name><name><surname>Kowalik</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Global simulations of the magnetic field evolution in barred galaxies under the influence of the cosmic-ray-driven dynamo</article-title><source>Astrophys J</source><year>2011</year><volume>733</volume><fpage>L18</fpage><pub-id pub-id-type="doi">10.1088/2041-8205/733/2/L18</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011ApJ...733L..18K</pub-id><comment>arXiv:1106.0283 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR136"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kulpa-Dybeł</surname><given-names>K</given-names></name><name><surname>Nowak</surname><given-names>N</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Siejkowski</surname><given-names>H</given-names></name><name><surname>Kulesza-Zydzik</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">The effect of supernova rate on the magnetic field evolution in barred galaxies</article-title><source>Astron Astrophys</source><year>2015</year><volume>575</volume><fpage>A93</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201323113</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015A&amp;A...575A..93K</pub-id></mixed-citation></ref><ref id="CR137"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kulsrud</surname><given-names>R</given-names></name><name><surname>Pearce</surname><given-names>WP</given-names></name></person-group><article-title xml:lang="en">The effect of wave-particle interactions on the propagation of cosmic rays</article-title><source>Astrophys J</source><year>1969</year><volume>156</volume><fpage>445</fpage><pub-id pub-id-type="doi">10.1086/149981</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1969ApJ...156..445K</pub-id></mixed-citation></ref><ref id="CR138"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuwabara</surname><given-names>T</given-names></name><name><surname>Ko</surname><given-names>CM</given-names></name></person-group><article-title xml:lang="en">Parker-Jeans instability of gaseous disks including the effect of cosmic rays</article-title><source>Astrophys J</source><year>2006</year><volume>636</volume><fpage>290</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1086/498056</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006ApJ...636..290K</pub-id></mixed-citation></ref><ref id="CR139"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuwabara</surname><given-names>T</given-names></name><name><surname>Ko</surname><given-names>CM</given-names></name></person-group><article-title xml:lang="en">Dynamics of the Parker-Jeans instability of gaseous disks including the effect of cosmic rays</article-title><source>Astrophys J</source><year>2020</year><volume>899</volume><issue>1</issue><fpage>72</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aba04c</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020ApJ...899...72K</pub-id><comment>arXiv:2008.06117 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR140"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuwabara</surname><given-names>T</given-names></name><name><surname>Nakamura</surname><given-names>K</given-names></name><name><surname>Ko</surname><given-names>CM</given-names></name></person-group><article-title xml:lang="en">Nonlinear parker instability with the effect of cosmic-ray diffusion</article-title><source>Astrophys J</source><year>2004</year><volume>607</volume><fpage>828</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1086/383611</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApJ...607..828K</pub-id></mixed-citation></ref><ref id="CR141"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lave</surname><given-names>KA</given-names></name><name><surname>Wiedenbeck</surname><given-names>ME</given-names></name><name><surname>Binns</surname><given-names>WR</given-names></name><name><surname>Christian</surname><given-names>ER</given-names></name><name><surname>Cummings</surname><given-names>AC</given-names></name><name><surname>Davis</surname><given-names>AJ</given-names></name><name><surname>de Nolfo</surname><given-names>GA</given-names></name><name><surname>Israel</surname><given-names>MH</given-names></name><name><surname>Leske</surname><given-names>RA</given-names></name><name><surname>Mewaldt</surname><given-names>RA</given-names></name><name><surname>Stone</surname><given-names>EC</given-names></name><name><surname>von Rosenvinge</surname><given-names>TT</given-names></name></person-group><article-title xml:lang="en">Galactic Cosmic-Ray energy spectra and composition during the 2009–2010 solar minimum period</article-title><source>Astrophys J</source><year>2013</year><volume>770</volume><fpage>117</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/770/2/117</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ApJ...770..117L</pub-id></mixed-citation></ref><ref id="CR142"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lesch</surname><given-names>H</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Strong magnetic fields and cosmic rays in very young galaxies</article-title><source>Astron Astrophys</source><year>2003</year><volume>401</volume><fpage>809</fpage><lpage>816</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20030212</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003A&amp;A...401..809L</pub-id></mixed-citation></ref><ref id="CR143"><mixed-citation publication-type="other">LeVeque RJ (2002) Finite volume methods for hyperbolic problems. Cambridge Texts in Applied Mathematics. Cambridge University Press, Cambridge. <ext-link xlink:href="10.1017/CBO9780511791253" ext-link-type="doi">https://doi.org/10.1017/CBO9780511791253</ext-link></mixed-citation></ref><ref id="CR144"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mac Low</surname><given-names>MM</given-names></name><name><surname>Klessen</surname><given-names>RS</given-names></name></person-group><article-title xml:lang="en">Control of star formation by supersonic turbulence</article-title><source>Rev Mod Phys</source><year>2004</year><volume>76</volume><fpage>125</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.76.125</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004RvMP...76..125M</pub-id></mixed-citation></ref><ref id="CR145"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacKenzie</surname><given-names>JF</given-names></name><name><surname>Völk</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Non-linear theory of cosmic ray shocks including self-generated Alfvén waves</article-title><source>Astron Astrophys</source><year>1982</year><volume>116</volume><fpage>191</fpage><lpage>200</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1982A&amp;A...116..191M</pub-id></mixed-citation></ref><ref id="CR146"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcowith</surname><given-names>A</given-names></name><name><surname>Ferrand</surname><given-names>G</given-names></name><name><surname>Grech</surname><given-names>M</given-names></name><name><surname>Meliani</surname><given-names>Z</given-names></name><name><surname>Plotnikov</surname><given-names>I</given-names></name><name><surname>Walder</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Multi-scale simulations of particle acceleration in astrophysical systems</article-title><source>Living Rev Comput Astrophys</source><year>2020</year><volume>6</volume><fpage>1</fpage><pub-id pub-id-type="doi">10.1007/s41115-020-0007-6</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020LRCA....6....1M</pub-id><comment>arXiv:2002.09411 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR147"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mashnik</surname><given-names>SG</given-names></name><name><surname>Gudima</surname><given-names>KK</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Prael</surname><given-names>RE</given-names></name><name><surname>Sierk</surname><given-names>AJ</given-names></name></person-group><article-title xml:lang="en">CEM2K and LAQGSM codes as event generators for space-radiation-shielding and cosmic-ray-propagation applications</article-title><source>Adv Space Res</source><year>2004</year><volume>34</volume><fpage>1288</fpage><lpage>1296</lpage><pub-id pub-id-type="doi">10.1016/j.asr.2003.08.057</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004AdSpR..34.1288M</pub-id></mixed-citation></ref><ref id="CR148"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathews</surname><given-names>WG</given-names></name><name><surname>Brighenti</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Creation of X-ray cavities in galaxy clusters with cosmic rays</article-title><source>Astrophys J</source><year>2007</year><volume>660</volume><fpage>1137</fpage><lpage>1145</lpage><pub-id pub-id-type="doi">10.1086/513691</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007ApJ...660.1137M</pub-id><comment>astro-ph/0701712</comment></mixed-citation></ref><ref id="CR149"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathews</surname><given-names>WG</given-names></name><name><surname>Brighenti</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Creation of the X-ray cavity jet and its radio lobe in M87/Virgo with cosmic rays: relevance to relic radio sources</article-title><source>Astrophys J</source><year>2008</year><volume>676</volume><fpage>880</fpage><lpage>888</lpage><pub-id pub-id-type="doi">10.1086/527429</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008ApJ...676..880M</pub-id><comment>arXiv:0711.4384</comment></mixed-citation></ref><ref id="CR150"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurin</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">USINE: semi-analytical models for Galactic cosmic-ray propagation</article-title><source>Comput Phys Commun</source><year>2020</year><volume>247</volume><fpage>106942</fpage><pub-id pub-id-type="doi">10.1016/j.cpc.2019.106942</pub-id></mixed-citation></ref><ref id="CR151"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Donato</surname><given-names>F</given-names></name><name><surname>Taillet</surname><given-names>R</given-names></name><name><surname>Salati</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Cosmic rays below <inline-formula id="IEq551"><alternatives><mml:math id="IEq551_Math"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><tex-math id="IEq551_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z = 30$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41115_2021_11_Article_IEq551.gif"/></alternatives></inline-formula> in a diffusion model: new constraints on propagation parameters</article-title><source>Astrophys J</source><year>2001</year><volume>555</volume><fpage>585</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1086/321496</pub-id></mixed-citation></ref><ref id="CR152"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Taillet</surname><given-names>R</given-names></name><name><surname>Donato</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">New results on source and diffusion spectral features of Galactic cosmic rays: I B/C ratio</article-title><source>Astron Astrophys</source><year>2002</year><volume>394</volume><fpage>1039</fpage><lpage>1056</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20021176</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002A&amp;A...394.1039M</pub-id></mixed-citation></ref><ref id="CR153"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKee</surname><given-names>CF</given-names></name><name><surname>Ostriker</surname><given-names>EC</given-names></name></person-group><article-title xml:lang="en">Theory of star formation</article-title><source>Annu Rev Astron Astrophys</source><year>2007</year><volume>45</volume><issue>1</issue><fpage>565</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1146/annurev.astro.45.051806.110602</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007ARA&amp;A..45..565M</pub-id><comment>arXiv:0707.3514 [astro-ph]</comment></mixed-citation></ref><ref id="CR154"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mimica</surname><given-names>P</given-names></name><name><surname>Aloy</surname><given-names>MA</given-names></name><name><surname>Agudo</surname><given-names>I</given-names></name><name><surname>Martí</surname><given-names>JM</given-names></name><name><surname>Gómez</surname><given-names>JL</given-names></name><name><surname>Miralles</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Spectral evolution of superluminal components in parsec-scale jets</article-title><source>Astrophys J</source><year>2009</year><volume>696</volume><issue>2</issue><fpage>1142</fpage><lpage>1163</lpage><pub-id pub-id-type="doi">10.1088/0004-637X/696/2/1142</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009ApJ...696.1142M</pub-id><comment>arXiv:0811.1143 [astro-ph]</comment></mixed-citation></ref><ref id="CR155"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miniati</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">COSMOCR: a numerical code for cosmic ray studies in computational cosmology</article-title><source>Comput Phys Commun</source><year>2001</year><volume>141</volume><fpage>17</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/S0010-4655(01)00293-4</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001CoPhC.141...17M</pub-id><comment>10.1016/S0010-4655(01)00293-4</comment></mixed-citation></ref><ref id="CR156"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miniati</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Glimm–Godunov’s method for cosmic-ray-hydrodynamics</article-title><source>J Comput Phys</source><year>2007</year><volume>227</volume><fpage>776</fpage><lpage>796</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2361546</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2007.08.013</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1126.76037</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007JCoPh.227..776M</pub-id><comment>astro-ph/0611499</comment></mixed-citation></ref><ref id="CR157"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Cen</surname><given-names>R</given-names></name><name><surname>Ostriker</surname><given-names>JP</given-names></name></person-group><article-title xml:lang="en">Properties of cosmic shock waves in large-scale structure formation</article-title><source>Astrophys J</source><year>2000</year><volume>542</volume><issue>2</issue><fpage>608</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.1086/317027</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2000ApJ...542..608M</pub-id><comment>arXiv:astro-ph/0005444 [astro-ph]</comment></mixed-citation></ref><ref id="CR158"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray electrons in groups and clusters of galaxies: primary and secondary populations from a numerical cosmological simulation</article-title><source>Astrophys J</source><year>2001</year><volume>562</volume><fpage>233</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1086/323434</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001ApJ...562..233M</pub-id></mixed-citation></ref><ref id="CR159"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray protons accelerated at cosmological shocks and their impact on groups and clusters of galaxies</article-title><source>Astrophys J</source><year>2001</year><volume>559</volume><fpage>59</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1086/322375</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001ApJ...559...59M</pub-id></mixed-citation></ref><ref id="CR160"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname><given-names>SC</given-names></name><name><surname>Krause</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Magnetic field structure and halo in NGC 4631</article-title><source>Astron Astrophys</source><year>2013</year><volume>560</volume><fpage>A42</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201321043</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013A&amp;A...560A..42M</pub-id><comment>arXiv:1312.3648 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR161"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morlino</surname><given-names>G</given-names></name><name><surname>Gabici</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Cosmic ray penetration in diffuse clouds</article-title><source>MNRAS</source><year>2015</year><volume>451</volume><fpage>L100</fpage><lpage>L104</lpage><pub-id pub-id-type="doi">10.1093/mnrasl/slv074</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015MNRAS.451L.100M</pub-id><comment>arXiv:1503.02435 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR162"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Strong</surname><given-names>AW</given-names></name></person-group><article-title xml:lang="en">Production and propagation of cosmic-ray positrons and electrons</article-title><source>Astrophys J</source><year>1998</year><volume>493</volume><fpage>694</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1086/305152.</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...493..694M</pub-id><comment>astro-ph/9710124</comment></mixed-citation></ref><ref id="CR163"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Strong</surname><given-names>AW</given-names></name><name><surname>Ormes</surname><given-names>JF</given-names></name><name><surname>Potgieter</surname><given-names>MS</given-names></name></person-group><article-title xml:lang="en">Secondary antiprotons and propagation of cosmic rays in the galaxy and heliosphere</article-title><source>Astrophys J</source><year>2002</year><volume>565</volume><fpage>280</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1086/324402</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002ApJ...565..280M</pub-id></mixed-citation></ref><ref id="CR164"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naab</surname><given-names>T</given-names></name><name><surname>Ostriker</surname><given-names>JP</given-names></name></person-group><article-title xml:lang="en">Theoretical challenges in galaxy formation</article-title><source>Annu Rev Astron Astrophys</source><year>2017</year><volume>55</volume><fpage>59</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1146/annurev-astro-081913-040019</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ARA&amp;A..55...59N</pub-id><comment>arXiv:1612.06891</comment></mixed-citation></ref><ref id="CR165"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newcomb</surname><given-names>WA</given-names></name></person-group><article-title xml:lang="en">Convective instability induced by gravity in a plasma with a frozen-in magnetic field</article-title><source>Phys Fluids</source><year>1961</year><volume>4</volume><issue>4</issue><fpage>391</fpage><lpage>396</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">134603</pub-id><pub-id pub-id-type="doi">10.1063/1.1706342</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0103.43703</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1961PhFl....4..391N</pub-id></mixed-citation></ref><ref id="CR166"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogrodnik</surname><given-names>MA</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Wóltański</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Implementation of cosmic ray energy spectrum (CRESP) algorithm in PIERNIK MHD code. I. Spectrally resolved propagation of cosmic ray electrons on Eulerian grids</article-title><source>Astrophys J Suppl</source><year>2021</year><volume>253</volume><issue>1</issue><fpage>18</fpage><pub-id pub-id-type="doi">10.3847/1538-4365/abd16f</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2021ApJS..253...18O</pub-id><comment>arXiv:2009.06941 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR167"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owens</surname><given-names>AJ</given-names></name><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Cosmic rays in a dynamical halo. I. Age and matter traversal distributions and anisotropy for nuclei</article-title><source>Astrophys J</source><year>1977</year><volume>215</volume><fpage>677</fpage><lpage>684</lpage><pub-id pub-id-type="doi">10.1086/155401</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1977ApJ...215..677O</pub-id></mixed-citation></ref><ref id="CR168"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owens</surname><given-names>AJ</given-names></name><name><surname>Jokipii</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Cosmic rays in a dynamical halo. II</article-title><source>Electrons Astrophys J</source><year>1977</year><volume>215</volume><fpage>685</fpage><lpage>689</lpage><pub-id pub-id-type="doi">10.1086/155402</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1977ApJ...215..685O</pub-id></mixed-citation></ref><ref id="CR169"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padovani</surname><given-names>M</given-names></name><name><surname>Galli</surname><given-names>D</given-names></name><name><surname>Glassgold</surname><given-names>AE</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray ionization of molecular clouds</article-title><source>Astron Astrophys</source><year>2009</year><volume>501</volume><fpage>619</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1051/0004-6361/200911794</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009A&amp;A...501..619P</pub-id><comment>arXiv:0904.4149 [astro-ph.SR]</comment></mixed-citation></ref><ref id="CR170"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padovani</surname><given-names>M</given-names></name><name><surname>Galli</surname><given-names>D</given-names></name><name><surname>Ivlev</surname><given-names>AV</given-names></name><name><surname>Caselli</surname><given-names>P</given-names></name><name><surname>Ferrara</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Production of atomic hydrogen by cosmic rays in dark clouds</article-title><source>Astron Astrophys</source><year>2018</year><volume>619</volume><fpage>A144</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201834008</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018A&amp;A...619A.144P</pub-id><comment>arXiv:1809.04168 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR171"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padovani</surname><given-names>M</given-names></name><name><surname>Ivlev</surname><given-names>AV</given-names></name><name><surname>Galli</surname><given-names>D</given-names></name><name><surname>Offner</surname><given-names>SSR</given-names></name><name><surname>Indriolo</surname><given-names>N</given-names></name><name><surname>Rodgers-Lee</surname><given-names>D</given-names></name><name><surname>Marcowith</surname><given-names>A</given-names></name><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Bykov</surname><given-names>AM</given-names></name><name><surname>Kruijssen</surname><given-names>JMD</given-names></name></person-group><article-title xml:lang="en">Impact of low-energy cosmic rays on star formation</article-title><source>Space Sci Rev</source><year>2020</year><volume>216</volume><issue>2</issue><fpage>29</fpage><pub-id pub-id-type="doi">10.1007/s11214-020-00654-1</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020SSRv..216...29P</pub-id><comment>arXiv:2002.10282 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR172"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pais</surname><given-names>M</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Ehlert</surname><given-names>K</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">The effect of cosmic ray acceleration on supernova blast wave dynamics</article-title><source>MNRAS</source><year>2018</year><volume>478</volume><issue>4</issue><fpage>5278</fpage><lpage>5295</lpage><pub-id pub-id-type="doi">10.1093/mnras/sty1410</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018MNRAS.478.5278P</pub-id><comment>arXiv:1805.00128 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR173"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Simpson</surname><given-names>CM</given-names></name><name><surname>Kannan</surname><given-names>R</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Semi-implicit anisotropic cosmic ray transport on an unstructured moving mesh</article-title><source>MNRAS</source><year>2016</year><volume>462</volume><issue>3</issue><fpage>2603</fpage><lpage>2616</lpage><pub-id pub-id-type="doi">10.1093/mnras/stw1761</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.462.2603P</pub-id><comment>arXiv:1604.08587 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR174"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Simpson</surname><given-names>CM</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Galactic winds driven by isotropic and anisotropic cosmic-ray diffusion in disk galaxies</article-title><source>Astrophys J</source><year>2016</year><volume>824</volume><fpage>L30</fpage><pub-id pub-id-type="doi">10.3847/2041-8205/824/2/L30</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...824L..30P</pub-id><comment>arXiv:1605.00643</comment></mixed-citation></ref><ref id="CR175"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Bauer</surname><given-names>A</given-names></name><name><surname>Mocz</surname><given-names>P</given-names></name><name><surname>Munoz</surname><given-names>DJ</given-names></name><name><surname>Ohlmann</surname><given-names>ST</given-names></name><name><surname>Schaal</surname><given-names>K</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Improving the convergence properties of the moving-mesh code AREPO</article-title><source>MNRAS</source><year>2016</year><volume>455</volume><issue>1</issue><fpage>1134</fpage><lpage>1143</lpage><pub-id pub-id-type="doi">10.1093/mnras/stv2380</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.455.1134P</pub-id><comment>arXiv:1503.00562 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR176"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>EN</given-names></name></person-group><article-title xml:lang="en">The dynamical state of the interstellar gas and field</article-title><source>Astrophys J</source><year>1966</year><volume>145</volume><fpage>811</fpage><pub-id pub-id-type="doi">10.1086/148828</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1966ApJ...145..811P</pub-id></mixed-citation></ref><ref id="CR177"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>EN</given-names></name></person-group><article-title xml:lang="en">The dynamical state of the interstellar gas and field. II. Non-linear growth of clouds and forces in three dimensions</article-title><source>Astrophys J</source><year>1967</year><volume>149</volume><fpage>517</fpage><pub-id pub-id-type="doi">10.1086/149282</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1967ApJ...149..517P</pub-id></mixed-citation></ref><ref id="CR178"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>EN</given-names></name></person-group><article-title xml:lang="en">Fast dynamos, cosmic rays, and the galactic magnetic field</article-title><source>Astrophys J</source><year>1992</year><volume>401</volume><fpage>137</fpage><pub-id pub-id-type="doi">10.1086/172046</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1992ApJ...401..137P</pub-id></mixed-citation></ref><ref id="CR179"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname><given-names>T</given-names></name><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Gatto</surname><given-names>A</given-names></name><name><surname>Naab</surname><given-names>T</given-names></name><name><surname>Walch</surname><given-names>S</given-names></name><name><surname>Wünsch</surname><given-names>R</given-names></name><name><surname>Glover</surname><given-names>SCO</given-names></name><name><surname>Clark</surname><given-names>PC</given-names></name><name><surname>Klessen</surname><given-names>RS</given-names></name><name><surname>Baczynski</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Impact of supernova and cosmic-ray driving on the surface brightness of the galactic halo in soft X-rays</article-title><source>Astrophys J</source><year>2015</year><volume>813</volume><fpage>L27</fpage><pub-id pub-id-type="doi">10.1088/2041-8205/813/2/L27</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015ApJ...813L..27P</pub-id><comment>arXiv:1510.06563</comment></mixed-citation></ref><ref id="CR180"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Enßlin</surname><given-names>TA</given-names></name><name><surname>Jubelgas</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Detecting shock waves in cosmological smoothed particle hydrodynamics simulations</article-title><source>MNRAS</source><year>2006</year><volume>367</volume><fpage>113</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2005.09953.x</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1140.85003</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006MNRAS.367..113P</pub-id><comment>astro-ph/0603483</comment></mixed-citation></ref><ref id="CR181"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Enßlin</surname><given-names>TA</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Jubelgas</surname><given-names>M</given-names></name><name><surname>Dolag</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Simulating cosmic rays in clusters of galaxies—I. Effects on the Sunyaev-Zel’dovich effect and the X-ray emission</article-title><source>MNRAS</source><year>2007</year><volume>378</volume><fpage>385</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2007.11732.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007MNRAS.378..385P</pub-id><comment>astro-ph/0611037</comment></mixed-citation></ref><ref id="CR182"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Schaal</surname><given-names>K</given-names></name><name><surname>Simpson</surname><given-names>CM</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Simulating cosmic ray physics on a moving mesh</article-title><source>MNRAS</source><year>2017</year><volume>465</volume><fpage>4500</fpage><lpage>4529</lpage><pub-id pub-id-type="doi">10.1093/mnras/stw2941</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017MNRAS.465.4500P</pub-id><comment>arXiv:1604.07399</comment></mixed-citation></ref><ref id="CR183"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname><given-names>TA</given-names></name><name><surname>Jóhannesson</surname><given-names>G</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name></person-group><article-title xml:lang="en">High-energy gamma rays from the Milky Way: three-dimensional spatial models for the cosmic-ray and radiation field densities in the interstellar medium</article-title><source>Astrophys J</source><year>2017</year><volume>846</volume><issue>1</issue><fpage>67</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aa844d</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...846...67P</pub-id><comment>arXiv:1708.00816 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR184"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname><given-names>TA</given-names></name><name><surname>Jóhannesson</surname><given-names>G</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name></person-group><article-title xml:lang="en">Deciphering residual emissions: time-dependent models for the nonthermal interstellar radiation from the Milky Way</article-title><source>Astrophys J</source><year>2019</year><volume>887</volume><issue>2</issue><fpage>250</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/ab5961</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019ApJ...887..250P</pub-id><comment>arXiv:1909.02223 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR185"><mixed-citation publication-type="other">Potgieter MS (2013) Solar modulation of cosmic rays. Living Rev Sol Phys 10:3. <ext-link xlink:href="10.12942/lrsp-2013-3" ext-link-type="doi">https://doi.org/10.12942/lrsp-2013-3</ext-link>. <ext-link xlink:href="http://arxiv.org/abs/1306.4421" ext-link-type="uri">arXiv:1306.4421</ext-link> [physics.space-ph]</mixed-citation></ref><ref id="CR186"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Press</surname><given-names>WH</given-names></name><name><surname>Teukolsky</surname><given-names>SA</given-names></name><name><surname>Vetterling</surname><given-names>WT</given-names></name><name><surname>Flannery</surname><given-names>BP</given-names></name></person-group><source>Numerical recipes in FORTRAN. The art of scientific computing</source><year>1992</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0778.65002</pub-id></mixed-citation></ref><ref id="CR187"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Protheroe</surname><given-names>RJ</given-names></name><name><surname>Ormes</surname><given-names>JF</given-names></name><name><surname>Comstock</surname><given-names>GM</given-names></name></person-group><article-title xml:lang="en">Interpretation of cosmic ray composition: the path length distribution</article-title><source>Astrophys J</source><year>1981</year><volume>247</volume><fpage>362</fpage><lpage>373</lpage><pub-id pub-id-type="doi">10.1086/159045</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1981ApJ...247..362P</pub-id></mixed-citation></ref><ref id="CR188"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Soutoul</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Cosmic rays in the cloudy interstellar medium—production of secondary nuclei</article-title><source>Astron Astrophys</source><year>1990</year><volume>237</volume><fpage>445</fpage><lpage>453</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1990A&amp;A...237..445P</pub-id></mixed-citation></ref><ref id="CR189"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Soutoul</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Decaying cosmic ray nuclei in the local interstellar medium</article-title><source>Astron Astrophys</source><year>1998</year><volume>337</volume><fpage>859</fpage><lpage>865</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998A&amp;A...337..859P</pub-id></mixed-citation></ref><ref id="CR190"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Jones</surname><given-names>FC</given-names></name><name><surname>Ormes</surname><given-names>JF</given-names></name></person-group><article-title xml:lang="en">On using the weighted slab approximation in studying the problem of cosmic-ray transport</article-title><source>Astrophys J</source><year>1996</year><volume>465</volume><fpage>972</fpage><pub-id pub-id-type="doi">10.1086/177482</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996ApJ...465..972P</pub-id></mixed-citation></ref><ref id="CR191"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Völk</surname><given-names>HJ</given-names></name><name><surname>Zirakashvili</surname><given-names>VN</given-names></name><name><surname>Breitschwerdt</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Transport of relativistic nucleons in a galactic wind driven by cosmic rays</article-title><source>Astron Astrophys</source><year>1997</year><volume>321</volume><fpage>434</fpage><lpage>443</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1997A&amp;A...321..434P</pub-id></mixed-citation></ref><ref id="CR192"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Jones</surname><given-names>FC</given-names></name><name><surname>Strong</surname><given-names>AW</given-names></name><name><surname>Zirakashvili</surname><given-names>VN</given-names></name></person-group><article-title xml:lang="en">Dissipation of magnetohydrodynamic waves on energetic particles: impact on interstellar turbulence and cosmic-ray transport</article-title><source>Astrophys J</source><year>2006</year><volume>642</volume><fpage>902</fpage><lpage>916</lpage><pub-id pub-id-type="doi">10.1086/501117</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006ApJ...642..902P</pub-id><comment>astro-ph/0510335</comment></mixed-citation></ref><ref id="CR193"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Putze</surname><given-names>A</given-names></name><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Donato</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">p, He, and C to Fe cosmic-ray primary fluxes in diffusion models. Source and transport signatures on fluxes and ratios</article-title><source>Astron Astrophys</source><year>2011</year><volume>526</volume><fpage>A101</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201016064</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011A&amp;A...526A.101P</pub-id><comment>arXiv:1011.0989 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR194"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Recchia</surname><given-names>S</given-names></name><name><surname>Blasi</surname><given-names>P</given-names></name><name><surname>Morlino</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Cosmic ray driven Galactic winds</article-title><source>MNRAS</source><year>2016</year><volume>462</volume><fpage>4227</fpage><lpage>4239</lpage><pub-id pub-id-type="doi">10.1093/mnras/stw1966</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.462.4227R</pub-id><comment>arXiv:1603.06746 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR195"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Recchia</surname><given-names>S</given-names></name><name><surname>Blasi</surname><given-names>P</given-names></name><name><surname>Morlino</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">On the radial distribution of Galactic cosmic rays</article-title><source>MNRAS</source><year>2016</year><volume>462</volume><fpage>L88</fpage><lpage>L92</lpage><pub-id pub-id-type="doi">10.1093/mnrasl/slw136</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.462L..88R</pub-id><comment>arXiv:1604.07682 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR196"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Recchia</surname><given-names>S</given-names></name><name><surname>Blasi</surname><given-names>P</given-names></name><name><surname>Morlino</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Cosmic ray-driven winds in the Galactic environment and the cosmic ray spectrum</article-title><source>MNRAS</source><year>2017</year><volume>470</volume><fpage>865</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1093/mnras/stx1214</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017MNRAS.470..865R</pub-id><comment>arXiv:1703.04490 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR197"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reville</surname><given-names>B</given-names></name><name><surname>O’Sullivan</surname><given-names>S</given-names></name><name><surname>Duffy</surname><given-names>P</given-names></name><name><surname>Kirk</surname><given-names>JG</given-names></name></person-group><article-title xml:lang="en">The transport of cosmic rays in self-excited magnetic turbulence</article-title><source>MNRAS</source><year>2008</year><volume>386</volume><issue>1</issue><fpage>509</fpage><lpage>515</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2008.13059.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008MNRAS.386..509R</pub-id><comment>arXiv:0802.0109 [astro-ph]</comment></mixed-citation></ref><ref id="CR198"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodrigues</surname><given-names>LFS</given-names></name><name><surname>Sarson</surname><given-names>GR</given-names></name><name><surname>Shukurov</surname><given-names>A</given-names></name><name><surname>Bushby</surname><given-names>PJ</given-names></name><name><surname>Fletcher</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">The Parker instability in disk galaxies</article-title><source>Astrophys J</source><year>2016</year><volume>816</volume><issue>1</issue><fpage>2</fpage><pub-id pub-id-type="doi">10.3847/0004-637X/816/1/2</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...816....2R</pub-id><comment>arXiv:1510.06318 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR199"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roe</surname><given-names>PL</given-names></name></person-group><article-title xml:lang="en">Approximate Riemann solvers, parameter vectors, and difference schemes</article-title><source>J Comput Phys</source><year>1981</year><volume>43</volume><issue>2</issue><fpage>357</fpage><lpage>372</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">640362</pub-id><pub-id pub-id-type="doi">10.1016/0021-9991(81)90128-5</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0474.65066</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1981JCoPh..43..357R</pub-id></mixed-citation></ref><ref id="CR200"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Enßlin</surname><given-names>TA</given-names></name><name><surname>Brüggen</surname><given-names>M</given-names></name><name><surname>Begelman</surname><given-names>MC</given-names></name><name><surname>Churazov</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Cosmic ray confinement in fossil cluster bubbles</article-title><source>MNRAS</source><year>2008</year><volume>383</volume><issue>4</issue><fpage>1359</fpage><lpage>1365</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2007.12659.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008MNRAS.383.1359R</pub-id><comment>arXiv:0705.3235 [astro-ph]</comment></mixed-citation></ref><ref id="CR201"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>HYK</given-names></name><name><surname>Reynolds</surname><given-names>CS</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray feedback heating of the intracluster medium</article-title><source>Astrophys J</source><year>2017</year><volume>844</volume><fpage>13</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aa79f8</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...844...13R</pub-id><comment>arXiv:1701.07441 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR202"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>HYK</given-names></name><name><surname>Zweibel</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Global simulations of galactic winds including cosmic-ray streaming</article-title><source>Astrophys J</source><year>2017</year><volume>834</volume><fpage>208</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/834/2/208</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...834..208R</pub-id><comment>arXiv:1602.04856</comment></mixed-citation></ref><ref id="CR203"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Numerical magnetohydrodynamics in astrophysics: algorithm and tests for one-dimensional flow</article-title><source>Astrophys J</source><year>1995</year><volume>442</volume><fpage>228</fpage><pub-id pub-id-type="doi">10.1086/175437</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995ApJ...442..228R</pub-id><comment>arXiv:astro-ph/9404074 [astro-ph]</comment></mixed-citation></ref><ref id="CR204"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Frank</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Numerical magnetohydrodynamics in astrophysics: algorithm and tests for multidimensional flow</article-title><source>Astrophys J</source><year>1995</year><volume>452</volume><fpage>785</fpage><pub-id pub-id-type="doi">10.1086/176347</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1995ApJ...452..785R</pub-id><comment>arXiv:astro-ph/9505073 [astro-ph]</comment></mixed-citation></ref><ref id="CR205"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Miniati</surname><given-names>F</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Frank</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A divergence-free upwind code for multidimensional magnetohydrodynamic flows</article-title><source>Astrophys J</source><year>1998</year><volume>509</volume><issue>1</issue><fpage>244</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1086/306481</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...509..244R</pub-id><comment>arXiv:astro-ph/9807228 [astro-ph]</comment></mixed-citation></ref><ref id="CR206"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>D</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Hallman</surname><given-names>E</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name></person-group><article-title xml:lang="en">Cosmological shock waves and their role in the large-scale structure of the universe</article-title><source>Astrophys J</source><year>2003</year><volume>593</volume><issue>2</issue><fpage>599</fpage><lpage>610</lpage><pub-id pub-id-type="doi">10.1086/376723</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2003ApJ...593..599R</pub-id><comment>arXiv:astro-ph/0305164 [astro-ph]</comment></mixed-citation></ref><ref id="CR207"><mixed-citation publication-type="other">Ryu D, Kim J, Hong SS, Jones TW (2003b) The effect of cosmic-ray diffusion on the Parker instability. Astrophys J 589:338–346. <ext-link xlink:href="10.1086/374392" ext-link-type="doi">https://doi.org/10.1086/374392</ext-link>. astro-ph/0301625</mixed-citation></ref><ref id="CR208"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salem</surname><given-names>M</given-names></name><name><surname>Bryan</surname><given-names>GL</given-names></name></person-group><article-title xml:lang="en">Cosmic ray driven outflows in global galaxy disc models</article-title><source>MNRAS</source><year>2014</year><volume>437</volume><issue>4</issue><fpage>3312</fpage><lpage>3330</lpage><pub-id pub-id-type="doi">10.1093/mnras/stt2121</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014MNRAS.437.3312S</pub-id><comment>arXiv:1307.6215 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR209"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salem</surname><given-names>M</given-names></name><name><surname>Bryan</surname><given-names>GL</given-names></name><name><surname>Corlies</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Role of cosmic rays in the circumgalactic medium</article-title><source>MNRAS</source><year>2016</year><volume>456</volume><fpage>582</fpage><lpage>601</lpage><pub-id pub-id-type="doi">10.1093/mnras/stv2641</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.456..582S</pub-id><comment>arXiv:1511.05144</comment></mixed-citation></ref><ref id="CR210"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaal</surname><given-names>K</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Shock finding on a moving mesh—I. Shock statistics in non-radiative cosmological simulations</article-title><source>MNRAS</source><year>2015</year><volume>446</volume><issue>4</issue><fpage>3992</fpage><lpage>4007</lpage><pub-id pub-id-type="doi">10.1093/mnras/stu2386</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015MNRAS.446.3992S</pub-id><comment>arXiv:1407.4117 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR211"><mixed-citation publication-type="other">Schlickeiser R (2002) Cosmic ray astrophysics. Astronomy and Astrophysics Library. Springer, Berlin. <ext-link xlink:href="10.1007/978-3-662-04814-6" ext-link-type="doi">https://doi.org/10.1007/978-3-662-04814-6</ext-link></mixed-citation></ref><ref id="CR212"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlickeiser</surname><given-names>R</given-names></name><name><surname>Lerche</surname><given-names>I</given-names></name></person-group><article-title xml:lang="en">Cosmic gas dynamics. I. Basic equations and the dynamics of hot interstellar matter</article-title><source>Astron Astrophys</source><year>1985</year><volume>151</volume><fpage>151</fpage><lpage>156</lpage><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0574.76114</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1985A&amp;A...151..151S</pub-id></mixed-citation></ref><ref id="CR213"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlickeiser</surname><given-names>R</given-names></name><name><surname>Caglar</surname><given-names>M</given-names></name><name><surname>Lazarian</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Cosmic rays and MHD turbulence generation in interstellar Giant molecular clouds</article-title><source>Astrophys J</source><year>2016</year><volume>824</volume><issue>2</issue><fpage>89</fpage><pub-id pub-id-type="doi">10.3847/0004-637X/824/2/89</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...824...89S</pub-id></mixed-citation></ref><ref id="CR214"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sedov</surname><given-names>LI</given-names></name></person-group><source>Similarity and dimensional methods in mechanics</source><year>1959</year><publisher-loc>New York</publisher-loc><publisher-name>Academic Press</publisher-name><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0121.18504</pub-id></mixed-citation></ref><ref id="CR215"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname><given-names>ES</given-names></name><name><surname>Ptuskin</surname><given-names>VS</given-names></name></person-group><article-title xml:lang="en">Stochastic reacceleration of cosmic rays in the interstellar medium</article-title><source>Astrophys J</source><year>1994</year><volume>431</volume><fpage>705</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1086/174520</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1994ApJ...431..705S</pub-id></mixed-citation></ref><ref id="CR216"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seta</surname><given-names>A</given-names></name><name><surname>Shukurov</surname><given-names>A</given-names></name><name><surname>Wood</surname><given-names>TS</given-names></name><name><surname>Bushby</surname><given-names>PJ</given-names></name><name><surname>Snodin</surname><given-names>AP</given-names></name></person-group><article-title xml:lang="en">Relative distribution of cosmic rays and magnetic fields</article-title><source>MNRAS</source><year>2018</year><volume>473</volume><issue>4</issue><fpage>4544</fpage><lpage>4557</lpage><pub-id pub-id-type="doi">10.1093/mnras/stx2606</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018MNRAS.473.4544S</pub-id><comment>arXiv:1708.07499 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR217"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>MM</given-names></name><name><surname>Silberberg</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Heavy cosmic ray nuclei</article-title><source>Annu Rev Nucl Part Sci</source><year>1970</year><volume>20</volume><fpage>323</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1146/annurev.ns.20.120170.001543</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1970ARNPS..20..323S</pub-id></mixed-citation></ref><ref id="CR218"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Hammett</surname><given-names>GW</given-names></name></person-group><article-title xml:lang="en">Preserving monotonicity in anisotropic diffusion</article-title><source>J Comput Phys</source><year>2007</year><volume>227</volume><issue>1</issue><fpage>123</fpage><lpage>142</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2361519</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2007.07.026</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1280.76027</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2007JCoPh.227..123S</pub-id><comment>arXiv:0707.2616 [astro-ph]</comment></mixed-citation></ref><ref id="CR219"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Hammett</surname><given-names>GW</given-names></name></person-group><article-title xml:lang="en">A fast semi-implicit method for anisotropic diffusion</article-title><source>J Comput Phys</source><year>2011</year><volume>230</volume><issue>12</issue><fpage>4899</fpage><lpage>4909</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2795987</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2011.03.009</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1220.65118</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011JCoPh.230.4899S</pub-id><comment>arXiv:1008.0861 [astro-ph.IM]</comment></mixed-citation></ref><ref id="CR220"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Chandran</surname><given-names>BDG</given-names></name><name><surname>Quataert</surname><given-names>E</given-names></name><name><surname>Parrish</surname><given-names>IJ</given-names></name></person-group><article-title xml:lang="en">Buoyancy instabilities in galaxy clusters: convection due to adiabatic cosmic rays and anisotropic thermal conduction</article-title><source>Astrophys J</source><year>2009</year><volume>699</volume><issue>1</issue><fpage>348</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1088/0004-637X/699/1/348</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009ApJ...699..348S</pub-id><comment>arXiv:0901.4786 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR221"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Colella</surname><given-names>P</given-names></name><name><surname>Martin</surname><given-names>DF</given-names></name></person-group><article-title xml:lang="en">Numerical implementation of streaming down the gradient: application to fluid modeling of cosmic rays and saturated conduction</article-title><source>SIAM J Sci Comput</source><year>2010</year><volume>32</volume><issue>6</issue><fpage>3564</fpage><lpage>3583</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2763738</pub-id><pub-id pub-id-type="doi">10.1137/100792135</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1222.85002</pub-id></mixed-citation></ref><ref id="CR222"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shukurov</surname><given-names>A</given-names></name><name><surname>Snodin</surname><given-names>AP</given-names></name><name><surname>Seta</surname><given-names>A</given-names></name><name><surname>Bushby</surname><given-names>PJ</given-names></name><name><surname>Wood</surname><given-names>TS</given-names></name></person-group><article-title xml:lang="en">Cosmic rays in intermittent magnetic fields</article-title><source>Astrophys J</source><year>2017</year><volume>839</volume><issue>1</issue><fpage>L16</fpage><pub-id pub-id-type="doi">10.3847/2041-8213/aa6aa6</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...839L..16S</pub-id><comment>arXiv:1702.06193 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR223"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siejkowski</surname><given-names>H</given-names></name><name><surname>Soida</surname><given-names>M</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name><name><surname>Bomans</surname><given-names>DJ</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray driven dynamo in the interstellar medium of irregular galaxies</article-title><source>Astron Astrophys</source><year>2010</year><volume>510</volume><fpage>A97</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/200912729</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2010A&amp;A...510A..97S</pub-id><comment>arXiv:0909.0926</comment></mixed-citation></ref><ref id="CR224"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siejkowski</surname><given-names>H</given-names></name><name><surname>Otmianowska-Mazur</surname><given-names>K</given-names></name><name><surname>Soida</surname><given-names>M</given-names></name><name><surname>Bomans</surname><given-names>DJ</given-names></name><name><surname>Hanasz</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">3D global simulations of a cosmic-ray-driven dynamo in dwarf galaxies</article-title><source>Astron Astrophys</source><year>2014</year><volume>562</volume><fpage>A136</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/201220367</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014A&amp;A...562A.136S</pub-id><comment>arXiv:1401.5293</comment></mixed-citation></ref><ref id="CR225"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sijacki</surname><given-names>D</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Enßlin</surname><given-names>TA</given-names></name></person-group><article-title xml:lang="en">Simulations of cosmic-ray feedback by active galactic nuclei in galaxy clusters</article-title><source>MNRAS</source><year>2008</year><volume>387</volume><issue>4</issue><fpage>1403</fpage><lpage>1415</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2008.13310.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008MNRAS.387.1403S</pub-id><comment>arXiv:0801.3285 [astro-ph]</comment></mixed-citation></ref><ref id="CR226"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silsbee</surname><given-names>K</given-names></name><name><surname>Ivlev</surname><given-names>AV</given-names></name></person-group><article-title xml:lang="en">Diffusive versus free-streaming cosmic-ray transport in molecular clouds</article-title><source>Astrophys J</source><year>2019</year><volume>879</volume><issue>1</issue><fpage>14</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/ab22b4</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019ApJ...879...14S</pub-id><comment>arXiv:1904.01588 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR227"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>CM</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name><name><surname>Marinacci</surname><given-names>F</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name><name><surname>Glover</surname><given-names>SCO</given-names></name><name><surname>Clark</surname><given-names>PC</given-names></name><name><surname>Smith</surname><given-names>RJ</given-names></name></person-group><article-title xml:lang="en">The role of cosmic-ray pressure in accelerating galactic outflows</article-title><source>Astrophys J</source><year>2016</year><volume>827</volume><fpage>L29</fpage><pub-id pub-id-type="doi">10.3847/2041-8205/827/2/L29</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ApJ...827L..29S</pub-id><comment>arXiv:1606.02324</comment></mixed-citation></ref><ref id="CR228"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skilling</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Cosmic rays in the galaxy: convection or diffusion?</article-title><source>Astrophys J</source><year>1971</year><volume>170</volume><fpage>265</fpage><pub-id pub-id-type="doi">10.1086/151210</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1971ApJ...170..265S</pub-id></mixed-citation></ref><ref id="CR229"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skilling</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Cosmic ray streaming—I. Effect of Alfvén waves on particles</article-title><source>MNRAS</source><year>1975</year><volume>172</volume><fpage>557</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1093/mnras/172.3.557</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975MNRAS.172..557S</pub-id></mixed-citation></ref><ref id="CR230"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skilling</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Cosmic ray streaming—II. Effect of particles on Alfvén waves</article-title><source>MNRAS</source><year>1975</year><volume>173</volume><fpage>245</fpage><lpage>254</lpage><pub-id pub-id-type="doi">10.1093/mnras/173.2.245</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975MNRAS.173..245S</pub-id></mixed-citation></ref><ref id="CR231"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skilling</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Cosmic ray streaming—III. Self-consistent solutions</article-title><source>MNRAS</source><year>1975</year><volume>173</volume><fpage>255</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1093/mnras/173.2.255</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975MNRAS.173..255S</pub-id></mixed-citation></ref><ref id="CR232"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skilling</surname><given-names>J</given-names></name><name><surname>Strong</surname><given-names>AW</given-names></name></person-group><article-title xml:lang="en">Cosmic ray exclusion from dense molecular clouds</article-title><source>Astron Astrophys</source><year>1976</year><volume>53</volume><issue>2</issue><fpage>253</fpage><lpage>258</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1976A&amp;A....53..253S</pub-id></mixed-citation></ref><ref id="CR233"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skillman</surname><given-names>SW</given-names></name><name><surname>O’Shea</surname><given-names>BW</given-names></name><name><surname>Hallman</surname><given-names>EJ</given-names></name><name><surname>Burns</surname><given-names>JO</given-names></name><name><surname>Norman</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">Cosmological shocks in adaptive mesh refinement simulations and the acceleration of cosmic rays</article-title><source>Astrophys J</source><year>2008</year><volume>689</volume><issue>2</issue><fpage>1063</fpage><lpage>1077</lpage><pub-id pub-id-type="doi">10.1086/592496</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008ApJ...689.1063S</pub-id><comment>arXiv:0806.1522 [astro-ph]</comment></mixed-citation></ref><ref id="CR234"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snodin</surname><given-names>AP</given-names></name><name><surname>Brandenburg</surname><given-names>A</given-names></name><name><surname>Mee</surname><given-names>AJ</given-names></name><name><surname>Shukurov</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Simulating field-aligned diffusion of a cosmic ray gas</article-title><source>MNRAS</source><year>2006</year><volume>373</volume><issue>2</issue><fpage>643</fpage><lpage>652</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2006.11034.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2006MNRAS.373..643S</pub-id><comment>arXiv:astro-ph/0507176 [astro-ph]</comment></mixed-citation></ref><ref id="CR235"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snodin</surname><given-names>AP</given-names></name><name><surname>Shukurov</surname><given-names>A</given-names></name><name><surname>Sarson</surname><given-names>GR</given-names></name><name><surname>Bushby</surname><given-names>PJ</given-names></name><name><surname>Rodrigues</surname><given-names>LFS</given-names></name></person-group><article-title xml:lang="en">Global diffusion of cosmic rays in random magnetic fields</article-title><source>MNRAS</source><year>2016</year><volume>457</volume><issue>4</issue><fpage>3975</fpage><lpage>3987</lpage><pub-id pub-id-type="doi">10.1093/mnras/stw217</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016MNRAS.457.3975S</pub-id><comment>arXiv:1509.03766 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR236"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sod</surname><given-names>GA</given-names></name></person-group><article-title xml:lang="en">Review. A survey of several finite difference methods for systems of nonlinear hyperbolic conservation laws</article-title><source>J Comput Phys</source><year>1978</year><volume>27</volume><issue>1</issue><fpage>1</fpage><lpage>31</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">495002</pub-id><pub-id pub-id-type="doi">10.1016/0021-9991(78)90023-2</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0387.76063</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1978JCoPh..27....1S</pub-id></mixed-citation></ref><ref id="CR237"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soida</surname><given-names>M</given-names></name><name><surname>Krause</surname><given-names>M</given-names></name><name><surname>Dettmar</surname><given-names>RJ</given-names></name><name><surname>Urbanik</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">The large scale magnetic field structure of the spiral galaxy NGC 5775</article-title><source>Astron Astrophys</source><year>2011</year><volume>531</volume><fpage>A127</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/200810763</pub-id><comment>arXiv:1105.5259</comment></mixed-citation></ref><ref id="CR238"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">E pur si muove: Galilean-invariant cosmological hydrodynamical simulations on a moving mesh</article-title><source>MNRAS</source><year>2010</year><volume>401</volume><issue>2</issue><fpage>791</fpage><lpage>851</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2009.15715.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2010MNRAS.401..791S</pub-id><comment>arXiv:0901.4107 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR239"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>SA</given-names></name><name><surname>Streitmatter</surname><given-names>RE</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray propagation in the galaxy: techniques and the mean matter traversal</article-title><source>Astrophys J</source><year>1998</year><volume>505</volume><fpage>266</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1086/306142</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...505..266S</pub-id></mixed-citation></ref><ref id="CR243"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strong</surname><given-names>AW</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name></person-group><article-title xml:lang="en">Propagation of cosmic-ray nucleons in the galaxy</article-title><source>Astrophys J</source><year>1998</year><volume>509</volume><fpage>212</fpage><lpage>228</lpage><pub-id pub-id-type="doi">10.1086/306470</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...509..212S</pub-id></mixed-citation></ref><ref id="CR240"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>JM</given-names></name><name><surname>Norman</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">ZEUS-2D: a radiation magnetohydrodynamics code for astrophysical flows in two space dimensions. I. The hydrodynamic algorithms and tests</article-title><source>Astrophys J Suppl</source><year>1992</year><volume>80</volume><fpage>753</fpage><pub-id pub-id-type="doi">10.1086/191680</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1992ApJS...80..753S</pub-id></mixed-citation></ref><ref id="CR241"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>JM</given-names></name><name><surname>Norman</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">ZEUS-2D: a radiation magnetohydrodynamics code for astrophysical flows in two space dimensions. II. The magnetohydrodynamic algorithms and tests</article-title><source>Astrophys J Suppl</source><year>1992</year><volume>80</volume><fpage>791</fpage><pub-id pub-id-type="doi">10.1086/191681</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1992ApJS...80..791S</pub-id></mixed-citation></ref><ref id="CR244"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strong</surname><given-names>AW</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Reimer</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">Diffuse continuum gamma rays from the galaxy</article-title><source>Astrophys J</source><year>2000</year><volume>537</volume><fpage>763</fpage><lpage>784</lpage><pub-id pub-id-type="doi">10.1086/309038</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2000ApJ...537..763S</pub-id></mixed-citation></ref><ref id="CR245"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strong</surname><given-names>AW</given-names></name><name><surname>Moskalenko</surname><given-names>IV</given-names></name><name><surname>Reimer</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">Diffuse galactic continuum gamma rays: a model compatible with EGRET data and cosmic-ray measurements</article-title><source>Astrophys J</source><year>2004</year><volume>613</volume><fpage>962</fpage><lpage>976</lpage><pub-id pub-id-type="doi">10.1086/423193</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApJ...613..962S</pub-id></mixed-citation></ref><ref id="CR246"><mixed-citation publication-type="other">Strong AW, Moskalenko IV, Ptuskin VS (2007) Cosmic-ray propagation and interactions in the galaxy. Annu Rev Nucl Part Sci 57:285–327. <ext-link xlink:href="10.1146/annurev.nucl.57.090506.123011" ext-link-type="doi">https://doi.org/10.1146/annurev.nucl.57.090506.123011</ext-link>. astro-ph/0701517</mixed-citation></ref><ref id="CR242"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>JM</given-names></name><name><surname>Tomida</surname><given-names>K</given-names></name><name><surname>White</surname><given-names>CJ</given-names></name><name><surname>Felker</surname><given-names>KG</given-names></name></person-group><article-title xml:lang="en">The Athena++ adaptive mesh refinement framework: design and magnetohydrodynamic solvers</article-title><source>Astrophys J Suppl</source><year>2020</year><volume>249</volume><issue>1</issue><fpage>4</fpage><pub-id pub-id-type="doi">10.3847/1538-4365/ab929b</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020ApJS..249....4S</pub-id><comment>arXiv:2005.06651 [astro-ph.IM]</comment></mixed-citation></ref><ref id="CR247"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taillet</surname><given-names>R</given-names></name><name><surname>Salati</surname><given-names>P</given-names></name><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Vangioni-Flam</surname><given-names>E</given-names></name><name><surname>Cassé</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">The effects of discreteness of galactic cosmic-ray sources</article-title><source>Astrophys J</source><year>2004</year><volume>609</volume><fpage>173</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1086/421059</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApJ...609..173T</pub-id></mixed-citation></ref><ref id="CR248"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takayanagi</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Molecule formation in dense interstellar clouds</article-title><source>Publ Astron Soc Jpn</source><year>1973</year><volume>25</volume><fpage>327</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1973PASJ...25..327T</pub-id></mixed-citation></ref><ref id="CR249"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teyssier</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Cosmological hydrodynamics with adaptive mesh refinement. A new high resolution code called RAMSES</article-title><source>Astron Astrophys</source><year>2002</year><volume>385</volume><fpage>337</fpage><lpage>364</lpage><pub-id pub-id-type="doi">10.1051/0004-6361:20011817</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2002A&amp;A...385..337T</pub-id><comment>arXiv:astro-ph/0111367 [astro-ph]</comment></mixed-citation></ref><ref id="CR250"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>T</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray hydrodynamics: Alfvén-wave regulated transport of cosmic rays</article-title><source>MNRAS</source><year>2019</year><volume>485</volume><issue>3</issue><fpage>2977</fpage><lpage>3008</lpage><pub-id pub-id-type="doi">10.1093/mnras/stz263</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019MNRAS.485.2977T</pub-id><comment>arXiv:1805.11092 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR251"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornbury</surname><given-names>A</given-names></name><name><surname>Drury</surname><given-names>LO</given-names></name></person-group><article-title xml:lang="en">Power requirements for cosmic ray propagation models involving re-acceleration and a comment on second-order Fermi acceleration theory</article-title><source>MNRAS</source><year>2014</year><volume>442</volume><fpage>3010</fpage><lpage>3012</lpage><pub-id pub-id-type="doi">10.1093/mnras/stu1080</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014MNRAS.442.3010T</pub-id><comment>arXiv:1404.2104 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR252"><mixed-citation publication-type="other">Toptygin IN (1985) Cosmic rays in interplanetary magnetic fields, geophysics and astrophysics monographs, vol 27. D. Reidel, Dordrecht. <ext-link xlink:href="10.1007/978-94-009-5257-7" ext-link-type="doi">https://doi.org/10.1007/978-94-009-5257-7</ext-link></mixed-citation></ref><ref id="CR253"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toro</surname><given-names>EF</given-names></name></person-group><article-title xml:lang="en">Riemann solvers and numerical methods for fluid dynamics: a practical introduction</article-title><source>Springer</source><year>2009</year><pub-id pub-id-type="doi">10.1007/b79761</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1227.76006</pub-id></mixed-citation></ref><ref id="CR254"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tregillis</surname><given-names>IL</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Ryu</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Simulating electron transport and synchrotron emission in radio galaxies: shock acceleration and synchrotron aging in three-dimensional flows</article-title><source>Astrophys J</source><year>2001</year><volume>557</volume><issue>1</issue><fpage>475</fpage><lpage>491</lpage><pub-id pub-id-type="doi">10.1086/321657</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001ApJ...557..475T</pub-id></mixed-citation></ref><ref id="CR255"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uhlig</surname><given-names>M</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Sharma</surname><given-names>M</given-names></name><name><surname>Nath</surname><given-names>BB</given-names></name><name><surname>Enßlin</surname><given-names>TA</given-names></name><name><surname>Springel</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Galactic winds driven by cosmic ray streaming</article-title><source>MNRAS</source><year>2012</year><volume>423</volume><fpage>2374</fpage><lpage>2396</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2012.21045.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012MNRAS.423.2374U</pub-id><comment>arXiv:1203.1038 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR256"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaidya</surname><given-names>B</given-names></name><name><surname>Mignone</surname><given-names>A</given-names></name><name><surname>Bodo</surname><given-names>G</given-names></name><name><surname>Rossi</surname><given-names>P</given-names></name><name><surname>Massaglia</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A particle module for the PLUTO code. II. Hybrid framework for modeling nonthermal emission from relativistic magnetized flows</article-title><source>Astrophys J</source><year>2018</year><volume>865</volume><issue>2</issue><fpage>144</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aadd17</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018ApJ...865..144V</pub-id><comment>arXiv:1808.08960 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR257"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Es</surname><given-names>B</given-names></name><name><surname>Koren</surname><given-names>B</given-names></name><name><surname>de Blank</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Finite-difference schemes for anisotropic diffusion</article-title><source>J Comput Phys</source><year>2014</year><volume>272</volume><fpage>526</fpage><lpage>549</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3212285</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2014.04.046</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1349.82136</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014JCoPh.272..526V</pub-id></mixed-citation></ref><ref id="CR258"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Es</surname><given-names>B</given-names></name><name><surname>Koren</surname><given-names>B</given-names></name><name><surname>de Blank</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Finite-volume scheme for anisotropic diffusion</article-title><source>J Comput Phys</source><year>2016</year><volume>306</volume><fpage>422</fpage><lpage>442</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3432359</pub-id><pub-id pub-id-type="doi">10.1016/j.jcp.2015.11.041</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1352.65382</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016JCoPh.306..422V</pub-id></mixed-citation></ref><ref id="CR259"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Leer</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Towards the ultimate conservative difference scheme. V. A second-order sequel to Godunov’s method</article-title><source>J Comput Phys</source><year>1979</year><volume>32</volume><issue>1</issue><fpage>101</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1016/0021-9991(79)90145-1</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1364.65223</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1979JCoPh..32..101V</pub-id></mixed-citation></ref><ref id="CR260"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vazza</surname><given-names>F</given-names></name><name><surname>Brunetti</surname><given-names>G</given-names></name><name><surname>Gheller</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Shock waves in Eulerian cosmological simulations: main properties and acceleration of cosmic rays</article-title><source>MNRAS</source><year>2009</year><volume>395</volume><issue>3</issue><fpage>1333</fpage><lpage>1354</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2009.14691.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2009MNRAS.395.1333V</pub-id><comment>arXiv:0808.0609 [astro-ph]</comment></mixed-citation></ref><ref id="CR261"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vazza</surname><given-names>F</given-names></name><name><surname>Brüggen</surname><given-names>M</given-names></name><name><surname>Gheller</surname><given-names>C</given-names></name><name><surname>Brunetti</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Modelling injection and feedback of cosmic rays in grid-based cosmological simulations: effects on cluster outskirts</article-title><source>MNRAS</source><year>2012</year><volume>421</volume><issue>4</issue><fpage>3375</fpage><lpage>3398</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2012.20562.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012MNRAS.421.3375V</pub-id><comment>arXiv:1201.3362 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR262"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vazza</surname><given-names>F</given-names></name><name><surname>Brüggen</surname><given-names>M</given-names></name><name><surname>Gheller</surname><given-names>C</given-names></name><name><surname>Brunetti</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Modelling injection and feedback of cosmic rays in grid-based cosmological simulations: effects on cluster outskirts</article-title><source>MNRAS</source><year>2012</year><volume>421</volume><issue>4</issue><fpage>3375</fpage><lpage>3398</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2966.2012.20562.x</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012MNRAS.421.3375V</pub-id><comment>arXiv:1201.3362 [astro-ph.CO]</comment></mixed-citation></ref><ref id="CR263"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>HYK</given-names></name></person-group><article-title xml:lang="en">Chaotic cold accretion in giant elliptical galaxies heated by AGN cosmic rays</article-title><source>MNRAS</source><year>2020</year><volume>493</volume><issue>3</issue><fpage>4065</fpage><lpage>4076</lpage><pub-id pub-id-type="doi">10.1093/mnras/staa550</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020MNRAS.493.4065W</pub-id><comment>arXiv:1910.03608 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR264"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webber</surname><given-names>WR</given-names></name></person-group><article-title xml:lang="en">The cosmic-ray path length (age) distribution in the Galaxy—experimental limits on the deviation from an exponential</article-title><source>Astrophys J</source><year>1993</year><volume>402</volume><fpage>188</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1086/172122</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1993ApJ...402..188W</pub-id></mixed-citation></ref><ref id="CR265"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webber</surname><given-names>WR</given-names></name></person-group><article-title xml:lang="en">A new estimate of the local interstellar energy density and ionization rate of galactic cosmic cosmic rays</article-title><source>Astrophys J</source><year>1998</year><volume>506</volume><issue>1</issue><fpage>329</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.1086/306222</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ApJ...506..329W</pub-id></mixed-citation></ref><ref id="CR266"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webber</surname><given-names>WR</given-names></name></person-group><article-title xml:lang="en">What are the limits for ace galactic cosmic-ray isotope studies?</article-title><source>Space Sci Rev</source><year>1998</year><volume>86</volume><fpage>239</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1023/A:1005023728963</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998SSRv...86..239W</pub-id></mixed-citation></ref><ref id="CR267"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webber</surname><given-names>WR</given-names></name><name><surname>Lee</surname><given-names>MA</given-names></name><name><surname>Gupta</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Propagation of cosmic-ray nuclei in a diffusing galaxy with convective halo and thin matter disk</article-title><source>Astrophys J</source><year>1992</year><volume>390</volume><fpage>96</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1086/171262</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1992ApJ...390...96W</pub-id></mixed-citation></ref><ref id="CR268"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinrich</surname><given-names>N</given-names></name><name><surname>Boudaud</surname><given-names>M</given-names></name><name><surname>Derome</surname><given-names>L</given-names></name><name><surname>Génolini</surname><given-names>Y</given-names></name><name><surname>Lavalle</surname><given-names>J</given-names></name><name><surname>Maurin</surname><given-names>D</given-names></name><name><surname>Salati</surname><given-names>P</given-names></name><name><surname>Serpico</surname><given-names>P</given-names></name><name><surname>Weymann-Despres</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Galactic halo size in the light of recent AMS-02 data</article-title><source>Astron Astrophys</source><year>2020</year><volume>639</volume><fpage>A74</fpage><pub-id pub-id-type="doi">10.1051/0004-6361/202038064</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020A&amp;A...639A..74W</pub-id><comment>arXiv:2004.00441 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR269"><mixed-citation publication-type="other">Werner M, Kissmann R, Strong AW, Reimer O (2013) A new 3D transport and radiation code for galactic cosmic rays. In: Saa A (ed) 33rd international cosmic ray conference (ICRC 2013), vol 1. Sociedade Brasileira de Fisica. <ext-link xlink:href="http://arxiv.org/abs/1308.2829" ext-link-type="uri">arXiv:1308.2829</ext-link> [astro-ph.IM]</mixed-citation></ref><ref id="CR270"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiedenbeck</surname><given-names>ME</given-names></name><name><surname>Yanasak</surname><given-names>NE</given-names></name><name><surname>Cummings</surname><given-names>AC</given-names></name><name><surname>Davis</surname><given-names>AJ</given-names></name><name><surname>George</surname><given-names>JS</given-names></name><name><surname>Leske</surname><given-names>RA</given-names></name><name><surname>Mewaldt</surname><given-names>RA</given-names></name><name><surname>Stone</surname><given-names>EC</given-names></name><name><surname>Hink</surname><given-names>PL</given-names></name><name><surname>Israel</surname><given-names>MH</given-names></name><name><surname>Lijowski</surname><given-names>M</given-names></name><name><surname>Christian</surname><given-names>ER</given-names></name><name><surname>von Rosenvinge</surname><given-names>TT</given-names></name></person-group><article-title xml:lang="en">The origin of primary cosmic rays: constraints from ACE elemental and isotopic composition observations</article-title><source>Space Sci Rev</source><year>2001</year><volume>99</volume><fpage>15</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1023/A:1013816209004</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2001SSRv...99...15W</pub-id></mixed-citation></ref><ref id="CR271"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiener</surname><given-names>J</given-names></name><name><surname>Oh</surname><given-names>SP</given-names></name><name><surname>Guo</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Cosmic ray streaming in clusters of galaxies</article-title><source>MNRAS</source><year>2013</year><volume>434</volume><issue>3</issue><fpage>2209</fpage><lpage>2228</lpage><pub-id pub-id-type="doi">10.1093/mnras/stt1163</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013MNRAS.434.2209W</pub-id><comment>arXiv:1303.4746 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR272"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiener</surname><given-names>J</given-names></name><name><surname>Oh</surname><given-names>SP</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">Interaction of cosmic rays with cold clouds in galactic haloes</article-title><source>MNRAS</source><year>2017</year><volume>467</volume><fpage>646</fpage><lpage>660</lpage><pub-id pub-id-type="doi">10.1093/mnras/stx109</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017MNRAS.467..646W</pub-id><comment>arXiv:1610.02041 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR273"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiener</surname><given-names>J</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Oh</surname><given-names>SP</given-names></name></person-group><article-title xml:lang="en">Cosmic ray-driven galactic winds: streaming or diffusion?</article-title><source>MNRAS</source><year>2017</year><volume>467</volume><issue>1</issue><fpage>906</fpage><lpage>921</lpage><pub-id pub-id-type="doi">10.1093/mnras/stx127</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017MNRAS.467..906W</pub-id><comment>arXiv:1608.02585 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR274"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiener</surname><given-names>J</given-names></name><name><surname>Zweibel</surname><given-names>EG</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Cosmic ray acceleration of cool clouds in the circumgalactic medium</article-title><source>MNRAS</source><year>2019</year><volume>489</volume><issue>1</issue><fpage>205</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1093/mnras/stz2007</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019MNRAS.489..205W</pub-id><comment>arXiv:1903.01471 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR275"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winner</surname><given-names>G</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Pakmor</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Evolution of cosmic ray electron spectra in magnetohydrodynamical simulations</article-title><source>MNRAS</source><year>2019</year><volume>488</volume><issue>2</issue><fpage>2235</fpage><lpage>2252</lpage><pub-id pub-id-type="doi">10.1093/mnras/stz1792</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019MNRAS.488.2235W</pub-id><comment>arXiv:1903.01467 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR276"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winner</surname><given-names>G</given-names></name><name><surname>Pfrommer</surname><given-names>C</given-names></name><name><surname>Girichidis</surname><given-names>P</given-names></name><name><surname>Werhahn</surname><given-names>M</given-names></name><name><surname>Pais</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Evolution and observational signatures of the cosmic ray electron spectrum in SN 1006</article-title><source>MNRAS</source><year>2020</year><volume>499</volume><issue>2</issue><fpage>2785</fpage><lpage>2802</lpage><pub-id pub-id-type="doi">10.1093/mnras/staa2989</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020MNRAS.499.2785W</pub-id><comment>arXiv:2006.06683 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR277"><mixed-citation publication-type="other">Wóltański D (2015) Cosmic-Ray-driven dynamo in spiral galaxies. PhD thesis, Nicolaus Copernicus University, Toruń</mixed-citation></ref><ref id="CR278"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>H</given-names></name><name><surname>Lazarian</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Cosmic-ray scattering and streaming in compressible magnetohydrodynamic turbulence</article-title><source>Astrophys J</source><year>2004</year><volume>614</volume><fpage>757</fpage><lpage>769</lpage><pub-id pub-id-type="doi">10.1086/423733</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApJ...614..757Y</pub-id></mixed-citation></ref><ref id="CR279"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>HYK</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">The spatially uniform spectrum of the fermi bubbles: the leptonic active galactic nucleus jet scenario</article-title><source>Astrophys. J.</source><year>2017</year><volume>850</volume><issue>1</issue><fpage>2</fpage><pub-id pub-id-type="doi">10.3847/1538-4357/aa9434</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017ApJ...850....2Y</pub-id><comment>arXiv:1706.05025 [astro-ph.HE]</comment></mixed-citation></ref><ref id="CR280"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>HYK</given-names></name><name><surname>Ruszkowski</surname><given-names>M</given-names></name><name><surname>Ricker</surname><given-names>PM</given-names></name><name><surname>Zweibel</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">The Fermi bubbles: supersonic active galactic nucleus jets with anisotropic cosmic-ray diffusion</article-title><source>Astrophys J</source><year>2012</year><volume>761</volume><issue>2</issue><fpage>185</fpage><pub-id pub-id-type="doi">10.1088/0004-637X/761/2/185</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012ApJ...761..185Y</pub-id><comment>arXiv:1207.4185 [astro-ph.GA]</comment></mixed-citation></ref><ref id="CR281"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zirakashvili</surname><given-names>VN</given-names></name><name><surname>Breitschwerdt</surname><given-names>D</given-names></name><name><surname>Ptuskin</surname><given-names>VS</given-names></name><name><surname>Völk</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Magnetohydrodynamic wind driven by cosmic rays in a rotating galaxy</article-title><source>Astron Astrophys</source><year>1996</year><volume>311</volume><fpage>113</fpage><lpage>126</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1996A&amp;A...311..113Z</pub-id></mixed-citation></ref><ref id="CR282"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">The microphysics and macrophysics of cosmic rays</article-title><source>Phys Plasmas</source><year>2013</year><volume>20</volume><issue>5</issue><fpage>055501</fpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1701501</pub-id><pub-id pub-id-type="doi">10.1063/1.4807033</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013PhPl...20e5501Z</pub-id></mixed-citation></ref><ref id="CR283"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zweibel</surname><given-names>EG</given-names></name></person-group><article-title xml:lang="en">The basis for cosmic ray feedback: written on the wind</article-title><source>Phys Plasmas</source><year>2017</year><volume>24</volume><issue>5</issue><fpage>055402</fpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1701501</pub-id><pub-id pub-id-type="doi">10.1063/1.4984017</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017PhPl...24e5402Z</pub-id></mixed-citation></ref><ref id="CR284"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zweibel</surname><given-names>EG</given-names></name><name><surname>Kulsrud</surname><given-names>RM</given-names></name></person-group><article-title xml:lang="en">The stabilizing effects of cloud reacceleration; microturbulence, and rotation on Parker’s instability</article-title><source>Astrophys J</source><year>1975</year><volume>201</volume><fpage>63</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1086/153858</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1975ApJ...201...63Z</pub-id></mixed-citation></ref></ref-list></ref-list><fn-group><fn id="Fn1"><label>1</label><p id="Par63">See <ext-link xlink:href="http://galprop.stanford.edu" ext-link-type="uri">http://galprop.stanford.edu</ext-link> and <ext-link xlink:href="https://gitlab.mpcdf.mpg.de/aws/galprop" ext-link-type="uri">https://gitlab.mpcdf.mpg.de/aws/galprop</ext-link>.</p></fn><fn id="Fn2"><label>2</label><p id="Par92">At <ext-link xlink:href="http://www.dragonproject.org" ext-link-type="uri">http://www.dragonproject.org</ext-link>.</p></fn><fn id="Fn3"><label>3</label><p id="Par94"><ext-link xlink:href="https://dmaurin.gitlab.io/USINE/" ext-link-type="uri">https://dmaurin.gitlab.io/USINE/</ext-link>.</p></fn></fn-group><notes notes-type="Misc"><title>Publisher's Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Astronomy, Astrophysics and Cosmology</facet-value><facet-value count="1">Computational Science and Engineering</facet-value><facet-value count="1">Numerical and Computational Physics, Simulation</facet-value><facet-value count="1">Physics</facet-value></facet><facet name="keyword"><facet-value count="1">Astroparticle physics</facet-value><facet-value count="1">Magnetohydrodynamics</facet-value><facet-value count="1">Plasma</facet-value></facet><facet name="pub"><facet-value count="1">Living Reviews in Computational Astrophysics</facet-value></facet><facet name="year"><facet-value count="1">2021</facet-value></facet><facet name="country"><facet-value count="1">Germany</facet-value><facet-value count="1">Poland</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
