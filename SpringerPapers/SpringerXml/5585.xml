<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41524-020-0307-8</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41524</journal-id><journal-id journal-id-type="doi">10.1038/41524.2057-3960</journal-id><journal-title-group><journal-title>npj Computational Materials</journal-title><abbrev-journal-title abbrev-type="publisher">npj Comput Mater</abbrev-journal-title></journal-title-group><issn pub-type="epub">2057-3960</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41524-020-0307-8</article-id><article-id pub-id-type="manuscript">307</article-id><article-id pub-id-type="doi">10.1038/s41524-020-0307-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/166/987</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/638/298/398</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/925/357/995</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Machine-learning structural and electronic properties of metal halide perovskites using a hierarchical convolutional neural network</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6714-4832</contrib-id><name><surname>Saidi</surname><given-names>Wissam A.</given-names></name><address><email>alsaidi@pitt.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4152402003078_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Shadid</surname><given-names>Waseem</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5880-5045</contrib-id><name><surname>Castelli</surname><given-names>Ivano E.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.21925.3d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id><institution content-type="org-division">Department of Mechanical Engineering and Materials Science</institution><institution content-type="org-name">University of Pittsburgh</institution></institution-wrap><addr-line content-type="postcode">15261</addr-line><addr-line content-type="city">Pittsburgh</addr-line><addr-line content-type="state">PA</addr-line><country country="US">USA</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266859.6</institution-id><institution-id institution-id-type="ISNI">0000 0000 8598 2218</institution-id><institution content-type="org-division">Department of System and Information Systems</institution><institution content-type="org-name">The University of North Carolina Charlotte</institution></institution-wrap><addr-line content-type="city">Charlotte</addr-line><addr-line content-type="state">NC</addr-line><country country="US">USA</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5170.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 8870</institution-id><institution content-type="org-division">Department of Energy Conversion and Storage</institution><institution content-type="org-name">Technical University of Denmark, DK-2800 Kgs</institution></institution-wrap><addr-line content-type="city">Lyngby</addr-line><country country="DK">Denmark</country></aff></contrib-group><author-notes><corresp id="IDs4152402003078_cor1"><label>a</label><email>alsaidi@pitt.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>14</day><month>4</month><year>2020</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2020</year></pub-date><volume>6</volume><issue seq="36">1</issue><elocation-id>36</elocation-id><history><date date-type="registration"><day>19</day><month>3</month><year>2020</year></date><date date-type="received"><day>8</day><month>12</month><year>2019</year></date><date date-type="accepted"><day>10</day><month>3</month><year>2020</year></date><date date-type="online"><day>14</day><month>4</month><year>2020</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2020</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">The development of statistical tools based on machine learning (ML) and deep networks is actively sought for materials design problems. While structure-property relationships can be accurately determined using quantum mechanical methods, these first-principles calculations are computationally demanding, limiting their use in screening a large set of candidate structures. Herein, we use convolutional neural networks to develop a predictive model for the electronic properties of metal halide perovskites (MHPs) that have a billions-range materials design space. We show that a well-designed hierarchical ML approach has a higher fidelity in predicting properties of the MHPs compared to straight-forward methods. In this architecture, each neural network element has a designated role in the estimation process from predicting complex features of the perovskites such as lattice constant and octahedral till angle to narrowing down possible ranges for the values of interest. Using the hierarchical ML scheme, the obtained root-mean-square errors for the lattice constants, octahedral angle and bandgap for the MHPs are 0.01 Å, 5°, and 0.02 eV, respectively. Our study underscores the importance of a careful network design and a hierarchical approach to alleviate issues associated with imbalanced dataset distributions, which is invariably common in materials datasets.</p></abstract><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Portfolio</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>199</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2020</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>19</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41524_2020_Article_307.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Materials Science</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Materials Science, general</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Characterization and Evaluation of Materials</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical and Computational Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Theoretical, Mathematical and Computational Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computational Intelligence</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical Modeling and Industrial Mathematics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Chemistry and Materials Science</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par2">Realization of commercially viable solar electricity is critical for securing long-term economic growth and mitigating the impact of climate change. The metal halide perovskites (MHPs) and in particular MAPbI<sub>3</sub> (MA = CH<sub>3</sub>NH<sub>3</sub>) are currently the most investigated solar materials with ~25.2% power conversion efficiency (PCE) surpassing commercialized solar cells such as multicrystalline Si (c-Si, 21.3%), cadmium telluride (CdTe, 22.1%) and copper indium gallium selenide (CIGS, 22.3%)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. However, in comparison to traditional solar absorbers, the main advantage of MHPs is their facile large-scale synthesis with relatively low cost<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Several studies showed that the high PCE in MHP based solar cells results from a unique combination of features: large absorption coefficient &gt; 3.0 × 10<sup>4</sup> cm<sup>−1</sup> in the visible light region<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, low exciton binding energy resulting in high quantum yield of free electrons and holes<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, long electron–hole diffusion lengths<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>, and electronically benign point<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup> and grain-boundary defects<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Another application of MHPs utilizes tandem solar cells, coupling a wide bandgap “top cell” with a narrow bandgap material like silicon as a “bottom cell”. Given that crystalline Si has a 1.1 eV bandgap, this requires materials with a 1.75 eV bandgap in order to current-match both junctions<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Current research focuses on finding optimum MHPs materials for either a single absorber or tandem solar cells that are cost-effective, stable and lead free<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. As an example, Li and Yang quite recently screened over 4500 hybrid compounds including those beyond the perovskite crystal structure, identifying 13 and 23 materials for solar energy conversion and light emitting diodes, respectively<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Despite these and other efforts, the chemical space of materials design is too broad for “brute force” screening, and more efficient search methods are needed to find perovskites in different bandgap ranges.</p><p id="Par3">There are vast opportunities for the discovery of new photovoltaic materials, but with considerable synthesis challenges, e.g., new materials can disproportionate into competing phases, and uniform films of the correct phase and composition for photovoltaics may prove difficult to form. “Computational experiments” or inverse-design approaches using predictive first-principles calculations offer a remedy, either narrowing down the number of potential solar absorbers or in guiding the experimental synthesis by determining the region of stability, if any, of the new compound. Further, previous studies show that useful compounds for different applications comprise only a small fraction of the total number of possible compounds<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. For example, Castelli et al. examined the performance of 19,000 oxide and oxynitride perovskite materials as solar water light splitters, finding only 20 interesting compounds for experimental follow-up<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. Also, DFT-based screening of 700 ternary alkali-transition metal borohydrides identified ~20 compounds with potential for reversible hydrogen storage<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p><p id="Par4">While ab initio investigations only require input of atomic numbers and ion positions to provide accurate materials properties, their relatively high computational cost limits their application on large datasets of millions of possible combinations. This is a serious limitation given that the material design space of hybrid MHPs is enormous. In contrast to the ~100 chemical elements available for all inorganic compounds, there are astronomical combinations yielding valid molecular species for the organic systems. The GDB-17 database<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> contains 166.4 billion molecules composed of 17 atoms including H, C, N, O, S, and the halogens, and there are ~10 million in the FDB-17 database, which evenly covers a broad range of molecular sizes, polarities, and stereochemistries<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Even limiting the chemical space to ~10,000 experimentally measured molecules<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>, the number of potential candidates is still huge, precluding traditional screening methods.</p><p id="Par5">Machine learning (ML) approaches can accelerate the materials search by orders of magnitude compared to traditional first-principles methods without significantly compromising their accuracy<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>, contributing to a paradigm shift in materials design where big data, artificial intelligence and materials modeling are deeply entangled<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. For example, Pilania and collaborators used kernel-ridge regression to predict the bandgaps of double perovskites achieving a root-mean-square error (RMSE) of 0.37 eV<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Im and co-workers used gradient-boosted regression trees to identify lead-free double perovskites and achieve an RMSE of 0.3 eV<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Weston and Stampfl compared different ML models in the prediction of bandgaps of kesterite I2-II-IV-V4 quaternary compounds, reporting an RMSE as low as 0.28 eV<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>.</p><p id="Par6">Herein, we systematically develop a dataset including structural and bandgap properties of 862 MHPs with the aim of developing a predictive ML model that captures the complex trends and correlations of this chemical space. We construct our materials design space by focusing mainly on variations in the organic molecule that has an enormous number of possibilities compared to those afforded by inorganic systems. For example, in comparison to inorganic compounds<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>, organic compounds display a wider range of features like electrostatic moments, anisotropies, and a complex potential energy surface allowing the molecule to distort depending environment and other entities in the compound. Additionally, the atomic size of the constituent elements of the perovskites is particularly important since this relates to their stability according to the Goldschmidt tolerance factor<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. But simple features such as the Shannon radii for atomic size are not easily generalized to the molecular case<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. Furthermore, structural optimization of the MHPs is challenging due to the soft nature of their potential energy surface<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, which thus complicates building a consistent large database for ML training.</p><p id="Par7">With the aim of addressing these challenges, we develop a ML approach for the MHPs that will (1) accurately estimate the bandgap using easy to calculate descriptors; (2) overcome the small size dataset problem with imbalanced distributions of target values, i.e., some range parts of a target value may have too many samples while other parts may have few or none; and (3) use simple ML approaches that are computationally not demanding, and are relatively simple to understand and control. We show that a hierarchical neural network architecture composed of a relatively small neural network elements can address all of these constraints. In this case, the ML elements are arranged such that each part plays a specific role in the prediction process. Each element is built using a convolutional neural network (CNN) framework and independently trained for its designated role apart from the other elements. This simplifies the learning process for neural networks and avoids the need for more sophisticated network architectures with many hidden layers.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Database</title><p id="Par8">We perform a high-throughput computational screening of ABX<sub>3</sub> MHPs, focusing mainly on variations at the “A-ion” site while keeping the lattice and the inorganic BX<sub>3</sub> network the same as in the parent MAPbI<sub>3</sub> structure. As a necessary constraint, we ensured selected <italic>A</italic>, <italic>B,</italic> and <italic>X</italic> species satisfy (a) the valence rule, requiring elements to have the correct oxidation state, namely <italic>A</italic><sup>+1</sup>, <italic>B</italic><sup>+2</sup>, and <italic>X</italic><sup><italic>−1</italic></sup>; and (b) the even-odd rule, requiring the material to have an even number of electrons in the unit cell to maintain a non-metallic behavior. Figure <xref rid="Fig1" ref-type="fig">1</xref> summarizes the material design space. At the <italic>A</italic> site, we investigated Cs in addition to 18 different organic molecules: ammonium [NH<sub>4</sub>]<sup>+</sup>, [AsH<sub>4</sub>]<sup>+</sup>, [PH<sub>4</sub>]<sup>+</sup>, [AsH<sub>4</sub>]<sup>+</sup>, [PF<sub>4</sub>]<sup>+</sup>, methylammonium [CH<sub>3</sub>NH<sub>3</sub>]<sup>+</sup>, [CH<sub>3</sub>PH<sub>3</sub>]<sup>+</sup>, [CH<sub>3</sub>AsH<sub>3</sub>]<sup>+</sup>, hydrazinium [(H<sub>3</sub>N)(NH<sub>2</sub>)]<sup>+</sup>, azetidinium [(CH<sub>2</sub>)<sub>3</sub>NH<sub>2</sub>]<sup>+</sup>, formamidinium [NH<sub>2</sub>(CH)NH<sub>2</sub>]<sup>+</sup>, [NH<sub>2</sub>(CH)PH<sub>2</sub>]<sup>+</sup>, [NH<sub>2</sub>(CH)AsH<sub>2</sub>]<sup>+</sup>, imidazolium [C<sub>3</sub>N<sub>2</sub>H<sub>5</sub>]<sup>+</sup>, dimethylammonium [(CH<sub>3</sub>)<sub>2</sub>NH<sub>2</sub>]<sup>+</sup>, acetamidinium [NH<sub>2</sub>-C-CH<sub>3</sub>-NH<sub>2</sub>]<sup>+</sup>, ethylammonium[(C<sub>2</sub>H<sub>5</sub>)NH<sub>3</sub>]<sup>+</sup>, and hydroxylammonium [H<sub>3</sub>NOH]<sup>+</sup>. Starting from <italic>A</italic> cations such as ammonium, methylammonium or dimethylammonium, other cations can be generated by replacing N with P, As, or Sb, or by replacing hydrogen in ammonium with halogen atoms such as [PF<sub>4</sub>]<sup>+</sup><sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In our database, we avoided using relatively large organic molecules such as tertiary methylammonium or other combinations such as [NF<sub>4</sub>]<sup>+</sup> and [PCl<sub>4</sub>]<sup>+</sup> since these were previously shown to destabilize the 3-dimensional perovskite network<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. At the <italic>B</italic> site, we considered the divalent metals Pb and Sn. At the halogen <italic>X</italic> site, we included 10 different combinations obtained from the three halogens (Cl, Br, I). Previous searches investigated a small portion of these compounds<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR32">32</xref></sup>. In total, we have 380 different MHP compositions in the cubic phase, which was expanded to 862 to account for all permutations obtained by rearrangements of the tri-halide moiety.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><title>Schematic representation of the selected material design space for the MHPs.</title><p>The A site of ABX<sup>1</sup><italic>X</italic><sup>2</sup><italic>X</italic><sup>3</sup> can be occupied by Cs in addition to 18 different organic molecules: ammonium [NH<sub>4</sub>]<sup>+</sup>, [AsH<sub>4</sub>]<sup>+</sup>, [PH<sub>4</sub>]<sup>+</sup>, [AsH<sub>4</sub>]<sup>+</sup>, [PF<sub>4</sub>]<sup>+</sup>, methylammonium [CH<sub>3</sub>NH<sub>3</sub>]<sup>+</sup>, [CH<sub>3</sub>PH<sub>3</sub>] <sup>+</sup>, [CH<sub>3</sub>AsH<sub>3</sub>]<sup>+</sup>, hydrazinium [(H<sub>3</sub>N)(NH<sub>2</sub>)]<sup>+</sup>, azetidinium [(CH<sub>2</sub>)<sub>3</sub>NH<sub>2</sub>]<sup>+</sup>, formamidinium [NH<sub>2</sub>(CH)NH<sub>2</sub>]<sup>+</sup>, [NH<sub>2</sub>(CH)PH<sub>2</sub>]<sup>+</sup>, [NH<sub>2</sub>(CH)AsH<sub>2</sub>]<sup>+</sup>, imidazolium [C<sub>3</sub>N<sub>2</sub>H<sub>5</sub>]<sup>+</sup>, dimethylammonium [(CH<sub>3</sub>)<sub>2</sub>NH<sub>2</sub>]<sup>+</sup>, acetamidinium [NH<sub>2</sub>-C-CH<sub>3</sub>-NH<sub>2</sub>]<sup>+</sup>, ethylammonium [(C<sub>2</sub>H<sub>5</sub>)NH<sub>3</sub>] <sup>+</sup>, and hydroxylammonium [H<sub>3</sub>NOH]<sup>+</sup>. The B site can be occupied by Sn or Pb, while as the <italic>X</italic><sup>1</sup>, <italic>X</italic><sup>2</sup>, and <italic>X</italic><sup>3</sup> halogen can be Cl, Br or I.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig1_HTML.png"/></fig></p><p id="Par9">The bandgap and structural parameters of all of the compounds in the dataset are computed using DFT. For each case, we start structural relaxation with the organic molecule chosen randomly at the center of the metal-halide octahedra. Previous studies show the orientation of the organic molecule has relatively small effect on electronic properties of the system and, on average, the bandgap changes less than 0.1 eV<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. MHPs are known to have a complex potential energy surface with many local minima<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>. This adds a significant challenge to high-throughput computational studies because the outcome structure, and hence its properties, tend to be sensitive to the starting configuration. In our study, we fully relaxed the atomic coordinates and obtained the lattice constant using the Murnaghan equation of state assuming a perfect cubic structure. We find this approach to be important to have a consistent database given the sensitivity of the bandgap to lattice distorations. We ingored electron-phonon coupling effects that can affect the bandgasp as these are relatively small<sup><xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR37">37</xref></sup>. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the bandgaps of the system obtained using GLLBC + SOC. Differences between the direct and indirect bandgaps were &lt;0.1 eV, so this is ignored in our analysis. While the significant (0.2–6 eV) modulations of the bandgaps in the database ensure that the obtained correlations cover a wide range of systems, this complicates the development of an accurate ML model as we further discuss below.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><title>Ground-truth bandgap values. </title><p>Results obtained using GLLB-SC with SOC corrections for (<bold>a</bold>) Sn-based and (<bold>b</bold>) Pb-based perovskites. Each colored square corresponds to a different perovskite with the color indicating the bandgap value. The A-ion and the <italic>X</italic><sup>1</sup><italic>X</italic><sup>2</sup><italic>X</italic><sup>3</sup> combination is identified by the labels on the vertical and horizontal axis, respectively.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig2_HTML.png"/></fig></p></sec></sec><sec id="Sec4" sec-type="discussion"><title>Discussion</title><sec id="Sec5"><title>Features engineering</title><p id="Par10">Based on their complexity, we classify our descriptors into three main categories: elemental, precursor-based, and ABX<sub>3</sub>-based features. We identified 29 elemental features that are obtained from the atoms and molecules forming the perovskite compound. These include first and second ionization energies and electron affinities, the electric dipole of the organic molecule, and atomic/molecular sizes. Also, we included the Goldschmidt tolerance factor,<disp-formula id="Equa"><alternatives><mml:math id="Equa_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = \frac{{\left( {R_A + R_X} \right)}}{{\sqrt 2 \left( {R_B + R_X} \right)}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_Equa.gif"/></alternatives></disp-formula>often used to assess the stability of the perovskite structure and the recently introduced tolerance factor<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>,<disp-formula id="Equb"><alternatives><mml:math id="Equb_Math"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width="0.33em"/><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = \frac{{R_X}}{{R_B}} - n_A\left( {n_A - \frac{Y}{{{\mathrm{ln}}(Y)}}} \right)\ {\rm{with}}\ Y= \frac{R_{A}}{R_{B}}\ {\rm{and}} \ n_A = 1.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_Equb.gif"/></alternatives></disp-formula></p><p id="Par11">We also identified six-precursor-based features derived from optimum structures of <italic>AX</italic> and <italic>BX</italic><sub><italic>2</italic></sub> including lattice volumes, formation energies and bandgaps. The motivation for including these precursor-derived features is that MAPbI<sub>3</sub> can be synthesized from MAI and PbI<sub>3</sub>. While similar synthesis routes may not exist for different <italic>ABX</italic><sub><italic>3</italic></sub> compounds, these features capture some of the chemistry of <italic>ABX</italic><sub><italic>3</italic></sub> and hence are deemed important to include. The last set of features considered are the lattice constant <italic>a</italic> and the metal-halide-metal octahedral tilt angle <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi mathvariant="script">O</mml:mi></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{O}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_IEq1.gif"/></alternatives></inline-formula> obtained from the optimum <italic>ABX</italic><sub><italic>3</italic></sub> structure, included because these geometric parameters affect the overlap of atomic orbitals and thus the bandgap<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Obviously, a predictive model to be used for screening different <italic>ABX</italic><sub><italic>3</italic></sub> systems should not depend on features obtained from the optimized <italic>ABX</italic><sub><italic>3</italic></sub> structures. However, as we will discuss later, we will implement the <italic>ABX</italic><sub><italic>3</italic></sub>-based features in a hierarchal neural network architecture composed of a relatively small number of neural network elements, each computationally tractable and relying on quickly calculated features.</p><p id="Par12">Using the full set of features, we performed a statistic analysis and empirical validation to determine the features that have the most impact on the predictivity of the ML model, as quantified from the RMSE. This process results in 11 features out of the 37 original set of features. We note that this reduction of feature space is mainly important to speed up the calculations and to obtain a smoother training of the neural network. The identified important features include the size <italic>A</italic>, <italic>B</italic> and halides, first ionization energy and electron affinity of the organic molecule, bandgap, formation energy, and the volume of the AX precursor, in addition to the lattice constant and the octahedral angle of ABX<sub>3</sub>. As seen, the selected features are associated mainly with the <italic>A</italic> cation (organic molecule) rather than the <italic>B</italic> cation, which is rationalized given that our database encompasses mainly variations at the <italic>A</italic> site (19 different cases) rather than the B site (2 cases). The importance of some of these features for the bandgap in the MHPs has been reported before<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. For example, Filip and collaborators found this to be the case for the lattice constant and the octahedral angle<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Further, the bandgaps of MHPs are found to be strongly dependent on electronegativities of the constituent species and the lattice constant, where the bandgaps increase (decrease) with an increase of the electronegativities (lattice constant)<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. Also, the electronegativity of the organic molecule can influence the bandgap indirectly: increasing the size of <italic>A</italic> tends to increase the lattice constant, and hence decrease the bandgap based on a one-dimensional quantum well description. Such a model applies to perovskites with <italic>A</italic> = FA, MA and Cs<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, as well as APbI<sub>3</sub> (A = NH<sub>4</sub>, PH<sub>4</sub>, AsH<sub>4</sub>, and SbH<sub>4</sub>)<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p><p id="Par13">Our ML approach is based on a CNN since it can be equally applied for classification and regression models. Further, we found that convolutional layers capture important trends as multiple perceptron layer was appreciably less accurate. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows pictorially the employed CNN architecture characterized by an input layer followed by two convolutional layers, one fully connected layer, and an output layer. This network design was implemented with TensorFlow Python API<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. The input layer is the set of predictors; The first convolutional layer consists of 64 filters, and employs a one dimensional (1D) convolutional kernel of size corresponding to the number of input features. The second convolutional layer consists of 128 filters, and employs a 2D convolutional kernel where the number of rows is equal to five and the number of columns is equal to the number of input features divided by two. The choice of 2D rather than 1D for the second layer is purposeful to accommodate the 2D output (filters and features) of the first layer. For both convolutional layers, the padding technique forces the output of each filter to have the same size as the input, followed by an element-wise rectified linear activation. Subsequent down sampling by a factor of two in a max pooling layer compresses the features between convolutional layers<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The fully connected layer consists of 100 hidden neurons connected to the down-sampled output of the second convolutional layer. This layer employs an element-wise rectified linear activation followed by a dropout layer with a drop rate of 0.2 to prevent overfitting. The last layer consists of one neuron with element-wise rectified linear activation that takes output of the fully connected layer as input and calculates the value of the bandgap. For the CNN for classification purposes, e.g., for estimating the range of the bandgap or the octahedral angle, the element-wise rectified linear activation is replaced by an element-wise sigmoid in all layers.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><title>Schematic representation of the convolutional neural network architecture.</title><p>For the classifier network the element-wise rectified linear activation unit (relU) is replaced by an element-wise sigmoid unit.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig3_HTML.png"/></fig></p><p id="Par14">The CNN is trained using 80% of the data selected randomly from our dataset. For validation, we employed 12 different selections of the training set from the dataset, and the reported RMSE prediction estimation is an average over all of them. Prior to the training, we first standardized the input data by subtracting the mean of each feature from each value and divided by the standard deviation. The standardized features have a zero-mean and unit-variance, which ensures that all have equal weight without any distortions to the differences in the value ranges. Further, features standardization is important for optimizing the weights of the CNN during the training process given that inputs over different ranges may cause convergence problems manifesting as oscillatory behavior around the desired minimum. After standardization, we also included new features obtained from the pair-wise interaction between the original descriptors to transform the linear regression model to a polynomial regression one. In this case, the pair-wise interactions between two different features capture the conjoint variation of any two independent predictors, and the self-interaction of features adds quadratic nonlinearity to the model. This feature augmentation step reduces the probability of missing important information that may improve the predictions of the CNN. Here, assuming that the original number of features is <italic>M</italic>, then after feature augmentation the total number of features will be increased by <italic>M</italic> due to the square terms and <italic>M(M-1)/2</italic> from pair-wise interactions (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). After CNN training, we obtained an RMSE of 0.07 eV during bandgap prediction. Using all of the features also yielded similar RMSE for the bandgap, assuring that the dimensionality reduction does not affect the predictivity of the model.</p><p id="Par15">One of the requirements to produce a reliable CNN is to have a balanced training dataset with homogenous distribution of samples in the output range. Imbalanced datasets may produce a model biased to learning parts of the range that have the most samples, and thus performs poorly on the other parts. As seen from the histogram in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the bandgap values vary between 0 and 6 eV with the majority of the values between 2 and 4 eV. Clearly, this imbalance in the representation of a physical property is a common problem in materials design, as there is no practical way to choose compounds that equally cover all the different ranges. To address the uneven nature of the dataset, we applied a hierarchical CNN (HCNN) that implements a classification algorithm to determine the bandgap range followed by another regressor CNN that estimates the bandgap value based on the outcome of the first CNN. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows schematically the dataflow contrast between the direct and hierarchical ML approaches.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><title>Data distribution. </title><p>Histogram analysis for (<bold>a</bold>) lattice constant, (<bold>b</bold>) octahedral angle, and (<bold>c</bold>) bandgap of the perovskites.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig4_HTML.png"/></fig><fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><title>HCNN architecture. </title><p>Schematic representation of the convolutional neural network employed for (<bold>a</bold>) bandgap and (<bold>b</bold>) structural features of the perovskites. Type 1, 2, and 3 correspond respectively to elemental, precursor-derived and complex type features. In (<bold>a</bold>) and (<bold>b</bold>) we show two design schemes by either using a direct regressor network, or a combined hierarchical network that employs a classifier for the range followed by a regressor network for the output value. The dotted square in (<bold>a</bold>) indicates that Type 3 structural features can be obtained using the network design shown in (<bold>b</bold>).</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig5_HTML.png"/></fig></p><p id="Par16">We trained the HCNN by splitting the training set into six different classes based on the bandgap value. The first level structure of the hierarchical CNN design consists of one CNN model that outputs a vector of six binary values corresponding to the six ranges of the bandgaps. For each compound, all of these values should be zero except the value associated with the category this combination belongs to, which is one, a method referred to as one-hot representation<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Further, we implemented soft cutoffs for the range classification so that compounds that within ~0.2 eV of the boundary are included in both classes. Impressively, the HCNN approach reduces the error obtained before using standard CNN by a factor of three resulting in an RMSE of 0.02 eV or on average a 0.14 eV error in the bandgap.</p><p id="Par17">While the HCNN has a high predictive accuracy, the feature list includes the lattice constant <italic>a</italic> and the octahedral angle <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi mathvariant="script">O</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{O}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_IEq2.gif"/></alternatives></inline-formula> of the hybrid <italic>ABX</italic><sub><italic>3</italic></sub> that are not easily accessible without calculating the optimum structure of the <italic>ABX</italic><sub><italic>3</italic></sub> using DFT, which we are trying to circumvent by using a CNN in the first place. Indeed, we find that both features are important to the high predictivity of the CNN model, as the RMSE increases from 0.07 to 0.16 eV when lattice constant and octahedral angle are removed from the features sets. It would be tempting to explore whether the <italic>a</italic> and <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi mathvariant="script">O</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{O}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_IEq3.gif"/></alternatives></inline-formula> can both be predicted using a CNN that employs only elemental and precursor-type features. We find that this is indeed the case, and both features can be predicted with a high accuracy, as can be seen in Fig. <xref rid="Fig5" ref-type="fig">5a, b</xref>. Using a CNN with an architecture similar to the one employed for the bandgap, the RMSE for the lattice constant and tilt angle are found to be 0.01 Å and 40°, respectively. The high RMSE for the octahedral angle is expected to be due to the imbalanced nature of the dataset, which is not the case for the lattice constants as seen from the histograms in Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>. To verify that this is the case, we employed an HCNN for the octahedral angle as we did for the bandgap. The RMSE decreased in this case to 5°.</p><p id="Par18">We employed the lattice constant CNN and the octahedral angle HCNN as two sub-nets in conjunction with an HCNN for the bandgap, all utilizing the same set of nine features identified before without the <italic>ABX</italic><sub><italic>3</italic></sub>-type. Using this complex network architecture, we obtained an RMSE of 0.02 eV for the bandgap that is identical to the value obtained before the HCNN with the 11 feature sets including those of <italic>a</italic> and <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi mathvariant="script">O</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{O}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41524_2020_307_Article_IEq4.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig6" ref-type="fig">6c</xref> compares the DFT-computed and CNN predicted values for the bandgap.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><title>HCNN performance. </title><p>Representative plots for the prediction of the CNNs with 80% of the data for training and 20% for testing for (<bold>a</bold>) lattice constant, (<bold>b</bold>) octahedral angle and (<bold>c</bold>) bandgap.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41524_2020_307_Fig6_HTML.png"/></fig></p><p id="Par19">In summary, this study underscores the importance of careful design of the ML approaches to provide a predictive structure-property relationship for the MHPs. Particularly, we show that the lattice constant and the octahedral till angle are key to obtain a predictive model for the bandgap, as the RMSE increases from 0.07 to 0.16 eV when these two features are removed from the dataset. Addressing this, we demonstrate that a CNN with easy-to-compute features can predict the lattice constant and octahedral angle with RMSE of 0.01 Å and 5°, respectively. Further, using the lattice constant and the tilt angle CNNs as two elements in the bandgap CNN would provide a predictive model with an RMSE of 0.02 eV, in agreement with the CNN that uses the DFT computed lattice constant and angle. Additionally, we show that a key to the success of this approach is in employing a hierarchical CNN to alleviate problems associated with the imbalanced nature of target values. Our findings are general and are likely to be applicable to other problems in materials design.</p></sec></sec><sec id="Sec6" sec-type="methods"><title>Methods</title><p id="Par20">The structural optimization of the MHPs is carried out using DFT calculations employing the Perdew-Burke-Ehrenzhof exchange-correlation functional revised for solids (PBEsol)<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> and projector augmented wave (PAW) pseudopotentials<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup> as implemented in the Vienna Ab initio Simulation Package (VASP) package. We expanded the electronic wavefunctions using planewave representation with a 400 eV cutoff. Sampling in the Brillouin zone, we used a 8 × 8 × 8 shifted grids with 0.2 eV Gaussian smearing. All of the atomic coordinates are relaxed using a convergence threshold of 1 meV/Å on the atomic forces and 10<sup>−7</sup> eV on the energies of the self-consistent electronic step. The band structure calculations are performed using GPAW<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> with spin-orbit coupling (SOC) corrections. To obtain accurate bandgaps at a reasonable computational cost, we employed the GLLB-SC functional<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> that can predict the bandgaps within an absolute accuracy of 0.5 eV<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. The GLLB-SC functional has been used in several studies to screen layered perovskites<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, perovskite oxides<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, and also organic perovskites<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. For comparison, the GLLB-SC bandgaps of tetragonal MAPbI3 and FAPbI3 with SOC are 1.36 and 1.47 eV, comparable to the GW/SOC results<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. The SOC corrections decrease the bandgap on average by ~1.0 and 0.25 eV for Pb-based and Sn-based compounds. These results are consistent with previous studies<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. The reduction of the quasiparticle gap due to electron–hole interactions is relatively small ~0.1 eV and is hence ignored in this study<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>.</p><p id="Par21">For consistency, we calculated all features employed in the ML analysis rather than using values from literature. The electron affinity and ionization energy are obtained from energy differences of neutral and charged systems computed using Gaussian<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and the B3LYP functional. Such approach can be equally applied for the elements and the organic molecule. We have verified that the basis set is large and include diffuse basis functions to accurately calculate the electron affinity. For Pb, we used 0.365 eV for the electron-affinity as computed with relativistic effects<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. To quantify the steric size, it is common to use Shannon radii of the elements. However, these do not exist for the organic cations. To be consistent for all elements/cations, we used as a size feature the radius of the sphere containing 90% of the electron density obtained from the B3LYP functional of the cation/anion that have the following nominal valence charges in ABX<sub>3</sub> perovskite structure: +1 for A cations, +2 for Pb and Sn, and –1 for the halides<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Although the atom sizes of Pb/Sn and halide groups obtained from this method were different from the corresponding Shannon radii, it was comforting that both quantities showed similar trends. Further, it was reassuring that the less stringent constraint <italic>R</italic><sub><italic>A</italic></sub> &gt; <italic>R</italic><sub><italic>B</italic></sub> is also satisfied by all our systems using the new size feature. We also calculated the formation energies, lattice constant, and bandgap based on PBEsol for all AX and BX<sub>2</sub> compounds, under the assumption that these have the same crystal structure as in the parent MAI and PbI<sub>2</sub> systems.</p></sec></body><back><ack><title>Acknowledgements</title><p>W.A.S. acknowledges the financial support from the National Science Foundation (Award No. DMR-1809085), useful discussions with Luca Ghiringhelli and Runhai Ouyang, and careful read by Richard Burke Garza. Calculations were performed in part at the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02–06CH11357, Extreme Science and Engineering Discovery Environment (XSEDE), and the University of Pittsburgh Center for Research Computing (CRC) through the computational resources provided. I.E.C. acknowledges support from the Department of Energy Conversion and Storage, Technical University of Denmark, through the Special Competence Initiative “Autonomous Materials Discovery (AiMade)”. [<ext-link xlink:href="http://www.aimade.org" ext-link-type="uri">http://www.aimade.org</ext-link>].</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>W.A.S. designed the project. W.S. and W.A.S. carried out the machine learning design and calculations. W.A.S. and I.E.C. performed the high-throughput DFT calculations. W.A.S. wrote the manuscript. All authors discussed data and feature analysis, and reviewed the manuscript.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>A dataset of the 862 systems utilized in this study along with optimized atomic structures of the compounds are provided in the Supplementary Information.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par22">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other"><italic>National Renewable Energy Laboratory</italic>, <italic>Best Research-Cell Efficiencies Chart</italic>: <ext-link xlink:href="https://www.nrel.gov/pv/assets/pdfs/best-research-cell-efficiencies.20190802.pdf" ext-link-type="uri">https://www.nrel.gov/pv/assets/pdfs/best-research-cell-efficiencies.20190802.pdf.</ext-link></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jena</surname><given-names>AK</given-names></name><name><surname>Kulkarni</surname><given-names>A</given-names></name><name><surname>Miyasaka</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Halide perovskite photovoltaics: background, status, and future prospects</article-title><source>Chem. Rev.</source><year>2019</year><volume>119</volume><fpage>3036</fpage><lpage>3103</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXjvV2isbc%3D</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>MA</given-names></name><name><surname>Ho-Baillie</surname><given-names>A</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">The emergence of perovskite solar cells</article-title><source>Nat. Photon.</source><year>2014</year><volume>8</volume><fpage>506</fpage><lpage>514</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXhtVGqu7zN</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyata</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Direct measurement of the exciton binding energy and effective masses for charge carriers in organic–inorganic tri-halide perovskites</article-title><source>Nat. Phys.</source><year>2015</year><volume>11</volume><fpage>582</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhtFeisr7K</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xing</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Long-range balanced electron-and hole-transport lengths in organic-inorganic CH<sub>3</sub>NH<sub>3</sub>PbI<sub>3</sub></article-title><source>Science</source><year>2013</year><volume>342</volume><fpage>344</fpage><lpage>347</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhs1Wltr3F</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stranks</surname><given-names>SD</given-names></name><etal/></person-group><article-title xml:lang="en">Electron-hole diffusion lengths exceeding 1 micrometer in an organometal trihalide perovskite absorber</article-title><source>Science</source><year>2013</year><volume>342</volume><fpage>341</fpage><lpage>344</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhs1Wltr3K</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>MH</given-names></name></person-group><article-title xml:lang="en">Efficient carrier transport in halide perovskites: theoretical perspectives</article-title><source>J. Mater. Chem. A</source><year>2014</year><volume>2</volume><fpage>9091</fpage><lpage>9098</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXovVKjsLg%3D</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>S-H</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Hong</surname><given-names>K-H</given-names></name></person-group><article-title xml:lang="en">The role of intrinsic defects in methylammonium lead iodide perovskite</article-title><source>J. Phys. Chem. Lett.</source><year>2014</year><volume>5</volume><fpage>1312</fpage><lpage>1317</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXkslChu78%3D</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shan</surname><given-names>W</given-names></name><name><surname>Saidi</surname><given-names>WA</given-names></name></person-group><article-title xml:lang="en">Segregation of native defects to the grain boundaries in methylammonium lead iodide perovskite</article-title><source>J. Phys. Chem. Lett.</source><year>2017</year><volume>8</volume><fpage>5935</fpage><lpage>5942</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhvVars7fP</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMeekin</surname><given-names>DP</given-names></name><etal/></person-group><article-title xml:lang="en">A mixed-cation lead mixed-halide perovskite absorber for tandem solar cells</article-title><source>Science</source><year>2016</year><volume>351</volume><fpage>151</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhvV2itg%3D%3D</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giustino</surname><given-names>F</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Toward lead-free perovskite solar cells</article-title><source>ACS Energy Lett.</source><year>2016</year><volume>1</volume><fpage>1233</fpage><lpage>1240</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhvVert73N</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">High-throughput computational design of organic–inorganic hybrid halide semiconductors beyond perovskites for optoelectronics</article-title><source>Energy Environ. Sci.</source><year>2019</year><volume>12</volume><fpage>2233</fpage><lpage>2243</lpage></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Curtarolo</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">The high-throughput highway to computational materials design</article-title><source>Nat. Mater.</source><year>2013</year><volume>12</volume><fpage>191</fpage><lpage>201</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXislWju7c%3D</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castelli</surname><given-names>IE</given-names></name><etal/></person-group><article-title xml:lang="en">Computational screening of perovskite metal oxides for optimal solar light capture</article-title><source>Energy Environ. Sci.</source><year>2012</year><volume>5</volume><fpage>5814</fpage><lpage>5819</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38Xht12iurc%3D</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hummelshøj</surname><given-names>JS</given-names></name><etal/></person-group><article-title xml:lang="en">Density functional theory based screening of ternary alkali-transition metal borohydrides: a computational material design project Bandgap calculations and trends of organometal halide perovskites</article-title><source>J. Chem. Phys.</source><year>2009</year><volume>131</volume><fpage>014101</fpage></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Zunger</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Identification of potential photovoltaic absorbers based on first-principles spectroscopic screening of materials</article-title><source>Phys. Rev. Lett.</source><year>2012</year><volume>108</volume><fpage>068701</fpage></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castelli</surname><given-names>IE</given-names></name><etal/></person-group><article-title xml:lang="en">New cubic perovskites for one- and two-photon water splitting using the computational materials repository</article-title><source>Energy Environ. Sci.</source><year>2012</year><volume>5</volume><fpage>9034</fpage><lpage>9043</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38Xhtlyqs7vL</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reymond</surname><given-names>J-L</given-names></name></person-group><article-title xml:lang="en">The chemical space project</article-title><source>Acc. Chem. Res.</source><year>2015</year><volume>48</volume><fpage>722</fpage><lpage>730</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXivFWisb4%3D</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visini</surname><given-names>R</given-names></name><name><surname>Awale</surname><given-names>M</given-names></name><name><surname>Reymond</surname><given-names>J-L</given-names></name></person-group><article-title xml:lang="en">Fragment Database FDB-17</article-title><source>J. Chem. Inf. Modeling</source><year>2017</year><volume>57</volume><fpage>700</fpage><lpage>709</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXlsVynt70%3D</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chase</surname><given-names>MW</given-names></name><etal/></person-group><article-title xml:lang="en">JANAF thermochemical tables, 1982 supplement</article-title><source>J. Phys. Chem. Ref. Data</source><year>1982</year><volume>11</volume><fpage>695</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL38Xmt1Cht7g%3D</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Rowley, R. L., W. W. V., Oscarson, J. L., Yang, Y. &amp; Giles, N. F. <italic>Data Compilation Tables of Properties of Pure Compounds</italic> (American Institute for Chemical Engineering New York, 2012).</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pilania</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Machine learning bandgaps of double perovskites</article-title><source>Sci. Rep.</source><year>2016</year><volume>6</volume><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28Xht1elt74%3D</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>L</given-names></name><name><surname>Agrawal</surname><given-names>A</given-names></name><name><surname>Choudhary</surname><given-names>A</given-names></name><name><surname>Wolverton</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">A general-purpose machine learning framework for predicting properties of inorganic materials</article-title><source>Npj Comput. Mater.</source><year>2016</year><volume>2</volume></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weston</surname><given-names>L</given-names></name><name><surname>Stampfl</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Machine learning the band gap properties of kesterite I2-II-IV-V4 quaternary compounds for photovoltaics applications</article-title><source>Phys. Rev. Mater.</source><year>2018</year><volume>2</volume><fpage>085407</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXltVKktrY%3D</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Im</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Identifying Pb-free perovskites for solar cells by machine learning</article-title><source>npj Comput. Mater.</source><year>2019</year><volume>5</volume></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jose</surname><given-names>R</given-names></name><name><surname>Ramakrishna</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Materials 4.0: materials big data enabled materials discovery</article-title><source>Appl. Mater. Today</source><year>2018</year><volume>10</volume><fpage>127</fpage><lpage>132</lpage></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldschmidt</surname><given-names>VM</given-names></name></person-group><article-title xml:lang="en">Die Gesetze der Krystallochemie</article-title><source>Naturwissenschaften</source><year>1926</year><volume>14</volume><fpage>477</fpage><lpage>485</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaB28Xit1Gnsw%3D%3D</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Filip, M. R., Eperon, G. E., Snaith, H. J. &amp; Giustino, F. Steric engineering of metal-halide perovskites with tunable optical band gaps. <italic>Nat. Commun.</italic><bold>5</bold>, <ext-link xlink:href="10.1038/ncomms6757" ext-link-type="doi">https://doi.org/10.1038/ncomms6757</ext-link> (2014).</mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castelli</surname><given-names>IE</given-names></name><name><surname>García-Lastra</surname><given-names>JM</given-names></name><name><surname>Thygesen</surname><given-names>KS</given-names></name><name><surname>Jacobsen</surname><given-names>KW</given-names></name></person-group><article-title xml:lang="en">Bandgap calculations and trends of organometal halide perovskites</article-title><source>APL Mater.</source><year>2014</year><volume>2</volume><fpage>081514</fpage></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Filip</surname><given-names>MR</given-names></name><name><surname>Giustino</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Computational screening of homovalent lead substitution in organic–inorganic halide perovskites</article-title><source>J. Phys. Chem. C</source><year>2016</year><volume>120</volume><fpage>166</fpage><lpage>173</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhvFOrurnP</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandt</surname><given-names>RE</given-names></name><name><surname>Stevanović</surname><given-names>V</given-names></name><name><surname>Ginley</surname><given-names>DS</given-names></name><name><surname>Buonassisi</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Identifying defect-tolerant semiconductors with high minority-carrier lifetimes: beyond hybrid lead halide perovskites</article-title><source>MRS Commun.</source><year>2015</year><volume>5</volume><fpage>265</fpage><lpage>275</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhtFGmur3F</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">Functionality-directed screening of Pb-free hybrid organic–inorganic perovskites with desired intrinsic photovoltaic functionalities</article-title><source>Chem. Mater.</source><year>2017</year><volume>29</volume><fpage>524</fpage><lpage>538</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XitFOiurzI</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Castelli, I., KristianvThygesen &amp; Jacobsen, K. <italic>Computational High-throughput Screening for Solar Energy Materials</italic> (CRC Press, 2017).</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saidi</surname><given-names>WA</given-names></name><name><surname>Choi</surname><given-names>JJ</given-names></name></person-group><article-title xml:lang="en">Nature of the cubic to tetragonal phase transition in methylammonium lead iodide perovskite</article-title><source>J. Chem. Phys.</source><year>2016</year><volume>145</volume><fpage>144702</fpage></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foley</surname><given-names>BJ</given-names></name><etal/></person-group><article-title xml:lang="en">Temperature dependent energy levels of methylammonium lead iodide perovskite</article-title><source>Appl. Phys. Lett.</source><year>2015</year><volume>106</volume><fpage>243904</fpage></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saidi</surname><given-names>WA</given-names></name><name><surname>Poncé</surname><given-names>S</given-names></name><name><surname>Monserrat</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Temperature dependence of the energy levels of methylammonium lead iodide perovskite from first-principles</article-title><source>J. Phys. Chem. Lett.</source><year>2016</year><volume>7</volume><fpage>5247</fpage><lpage>5252</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhvF2hu7%2FP</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="other">Saidi, W. A. &amp; Kachmar, A. Effects of electron–phonon coupling on electronic properties of methylammonium lead iodide perovskites. <italic>J. Phys. Chem. Lett.</italic> 7090–7097, <ext-link xlink:href="10.1021/acs.jpclett.8b03164" ext-link-type="doi">https://doi.org/10.1021/acs.jpclett.8b03164</ext-link> (2018).</mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartel</surname><given-names>CJ</given-names></name><etal/></person-group><article-title xml:lang="en">New tolerance factor to predict the stability of perovskite oxides and halides</article-title><source>Sci. Adv.</source><year>2019</year><volume>5</volume><fpage>eaav0693</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhvFWqs77N</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Filip</surname><given-names>MR</given-names></name><name><surname>Verdi</surname><given-names>C</given-names></name><name><surname>Giustino</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">GW band structures and carrier effective masses of CH<sub>3</sub>NH<sub>3</sub>PbI<sub>3</sub> and hypothetical perovskites of the type APbI<sub>3</sub>: A = NH<sub>4</sub>, PH<sub>4</sub>, AsH<sub>4</sub>, and SbH<sub>4</sub></article-title><source>J. Phys. Chem. C</source><year>2015</year><volume>119</volume><fpage>25209</fpage><lpage>25219</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhs1Onsr3I</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other"><italic>TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems</italic>, <ext-link xlink:href="http://tensorflow.org/" ext-link-type="uri">http://tensorflow.org/</ext-link> (2015).</mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">Krohn, J. et al. <italic>A Guide to Convolutional Neural Networks for Computer Vision</italic>. (Morgan &amp; Claypool Publishers, 2018).</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Khan, S., Beyleveld, G. &amp; Bassens, A. <italic>Deep Learning Illustrated: A Visual, Interactive Guide to Artificial Intelligence</italic>. (Pearson Education, 2019).</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perdew</surname><given-names>JP</given-names></name><etal/></person-group><article-title xml:lang="en">Restoring the density-gradient expansion for exchange in solids and surfaces</article-title><source>Phys. Rev. Lett.</source><year>2008</year><volume>100</volume><fpage>136406</fpage></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blochl</surname><given-names>PE</given-names></name></person-group><article-title xml:lang="en">Projector augmented-wave method</article-title><source>Phys. Rev. B</source><year>1994</year><volume>50</volume><fpage>17953</fpage><lpage>17979</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BC2sfjslSntA%3D%3D</pub-id></mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kresse</surname><given-names>G</given-names></name><name><surname>Joubert</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">From ultrasoft pseudopotentials to the projector augmented-wave method</article-title><source>Phys. Rev. B</source><year>1999</year><volume>59</volume><fpage>1758</fpage><lpage>1775</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1MXkt12nug%3D%3D</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enkovaara</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Electronic structure calculations with GPAW: a real-space implementation of the projector augmented-wave method</article-title><source>J. Phys.: Condens. Matter</source><year>2010</year><volume>22</volume><fpage>253202</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BC3M3lvVansg%3D%3D</pub-id></mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuisma</surname><given-names>M</given-names></name><name><surname>Ojanen</surname><given-names>J</given-names></name><name><surname>Enkovaara</surname><given-names>J</given-names></name><name><surname>Rantala</surname><given-names>TT</given-names></name></person-group><article-title xml:lang="en">Kohn-Sham potential with discontinuity for band gap materials</article-title><source>Phys. Rev. B</source><year>2010</year><volume>82</volume><fpage>115106</fpage></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castelli</surname><given-names>IE</given-names></name><etal/></person-group><article-title xml:lang="en">New light-harvesting materials using accurate and efficient bandgap calculations</article-title><source>Adv. Energy Mater.</source><year>2015</year><volume>5</volume><fpage>1400915</fpage></mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivano</surname><given-names>EC</given-names></name><name><surname>Juan María</surname><given-names>G-L</given-names></name><name><surname>Falco</surname><given-names>H</given-names></name><name><surname>Kristian</surname><given-names>ST</given-names></name><name><surname>Karsten</surname><given-names>WJ</given-names></name></person-group><article-title xml:lang="en">Stability and bandgaps of layered perovskites for one- and two-photon water splitting</article-title><source>N. J. Phys.</source><year>2013</year><volume>15</volume><fpage>105026</fpage></mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Umari</surname><given-names>P</given-names></name><name><surname>Mosconi</surname><given-names>E</given-names></name><name><surname>De Angelis</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Relativistic GW calculations on CH<sub>3</sub>NH<sub>3</sub>PbI<sub>3</sub> and CH<sub>3</sub>NH<sub>3</sub>SnI<sub>3</sub> perovskites for solar cell applications</article-title><source>Sci. Rep.</source><year>2014</year><volume>4</volume></mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="other">Gaussian 09 (Gaussian, Inc., Wallingford, CT, USA, 2009).</mixed-citation></ref><ref id="CR52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatewaki</surname><given-names>H</given-names></name><name><surname>Yamamoto</surname><given-names>S</given-names></name><name><surname>Moriyama</surname><given-names>H</given-names></name><name><surname>Watanabe</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Electron affinity of lead: An ab initio four-component relativistic study</article-title><source>Chem. Phys. Lett.</source><year>2009</year><volume>470</volume><fpage>158</fpage><lpage>161</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXisV2ls74%3D</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec7"><title>Supplementary information</title><p id="Par23"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41524_2020_307_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplemental material</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information"><media mimetype="text" mime-subtype="plain" xlink:href="MediaObjects/41524_2020_307_MOESM2_ESM.csv" position="anchor"><caption xml:lang="en"><p>Dataset</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/41524_2020_307_MOESM3_ESM.gz" position="anchor"><caption xml:lang="en"><p>Structure files</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary information</title><p><bold>Supplementary information</bold> is available for this paper at <ext-link xlink:href="10.1038/s41524-020-0307-8" ext-link-type="doi">https://doi.org/10.1038/s41524-020-0307-8</ext-link>.</p></notes><notes notes-type="Misc"><p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Characterization and Evaluation of Materials</facet-value><facet-value count="1">Computational Intelligence</facet-value><facet-value count="1">Materials Science</facet-value><facet-value count="1">Materials Science, general</facet-value><facet-value count="1">Mathematical and Computational Engineering</facet-value><facet-value count="1">Mathematical Modeling and Industrial Mathematics</facet-value><facet-value count="1">Theoretical, Mathematical and Computational Physics</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">npj Computational Materials</facet-value></facet><facet name="year"><facet-value count="1">2020</facet-value></facet><facet name="country"><facet-value count="1">Denmark</facet-value><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
