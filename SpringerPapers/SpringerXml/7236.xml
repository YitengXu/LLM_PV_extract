<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s13677-021-00273-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">13677</journal-id><journal-title-group><journal-title>Journal of Cloud Computing</journal-title><journal-subtitle>Advances, Systems and Applications</journal-subtitle><abbrev-journal-title abbrev-type="publisher">J Cloud Comp</abbrev-journal-title></journal-title-group><issn pub-type="epub">2192-113X</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s13677-021-00273-3</article-id><article-id pub-id-type="manuscript">273</article-id><article-id pub-id-type="doi">10.1186/s13677-021-00273-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group><subj-group subj-group-type="article-collection" specific-use="Regular"><subject>Utility, big data and cloud computing: Applications and technologies</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Security scheduling and transaction mechanism of virtual power plants based on dual blockchains</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2481-2663</contrib-id><name><surname>Zhang</surname><given-names>Xiaohong</given-names></name><address><email>xiaohongzh@jxust.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs13677021002733_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Song</surname><given-names>Zilong</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Moshayedi</surname><given-names>Ata Jahangir</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="IAu1"><collab><institution>IEEE Member</institution></collab></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.440790.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1764 4419</institution-id><institution content-type="org-division">School of Information Engineering</institution><institution content-type="org-name">Jiangxi University of Science and Technology</institution></institution-wrap><addr-line content-type="city">Ganzhou</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.411757.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1755 5416</institution-id><institution content-type="org-division">KhomeiniShahr Branch</institution><institution content-type="org-name">Islamic Azad University</institution></institution-wrap><addr-line content-type="city">Isfahan</addr-line><country country="IR">Iran</country></aff></contrib-group><author-notes><corresp id="IDs13677021002733_cor1"><label>a</label><email>xiaohongzh@jxust.edu.cn</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>28</day><month>1</month><year>2022</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2022</year></pub-date><volume>11</volume><issue seq="4">1</issue><elocation-id>4</elocation-id><history><date date-type="registration"><day>24</day><month>11</month><year>2021</year></date><date date-type="received"><day>3</day><month>8</month><year>2021</year></date><date date-type="accepted"><day>23</day><month>11</month><year>2021</year></date><date date-type="online"><day>28</day><month>1</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Aiming at the data authenticity and storage problems in the current coordinated scheduling of virtual power plants, as well as the opaque information and high transaction costs, a dual blockchains security mechanism is proposed to solve above problems. In the process of security scheduling, a hybrid attribute proxy re-encryption algorithm based on ciphertext strategy is designed. The algorithm is composed of an identity encryption algorithm and an attribute proxy re-encryption algorithm with ciphertext strategy. Combining blockchain, tamper-proof smart metering equipment can effectively solve data authenticity and confidentiality in the information transmission process of distributed energy. In the research process of the trading mechanism, a continuous double auction mechanism based on reputation is proposed. In order to create a favorable trading atmosphere, reputation-based market segmentation mechanisms are integrated, and participants are divided according to reputation value. Depending on the properties of the stored information, they are divided into the private blockchain (with coordination scheduling information) and the consortium blockchain (with transaction information). The system analysis shows the reliability of the dual blockchains architecture. The communication and calculation costs of the proxy re-encryption algorithm verify the practicability of the proposed scheme. The case analysis of the auction mechanism declares that the mechanism can operate effective in the electricity trading market.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Virtual power plant</kwd><kwd>Virtual power plant</kwd><kwd>Hybrid proxy re-encryption</kwd><kwd>Distributed energy resources</kwd><kwd>Reputation</kwd><kwd>Continuous double auction</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>major research plan</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100010905</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">61763017, 51665019</award-id><principal-award-recipient><name><surname>Zhang</surname><given-names>Xiaohong</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>11</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>24</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-collection-editor</meta-name><meta-value>Josef Spilner</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/13677_2021_Article_273.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Computer Science</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computer Communication Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Special Purpose and Application-Based Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Information Systems Applications (incl.Internet)</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computer Systems Organization and Communication Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Computer System Implementation</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Software Engineering/Programming and Operating Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Computer Science</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2"><bold>A</bold>ccording to the global greenhouse gas emission data in 2010, energy production such as electricity and industry accounted for 76% of the total global emissions in that year. Considering the impact of greenhouse gas emissions on climate change [<xref ref-type="bibr" rid="CR1">1</xref>] and the cost and supply of fossil fuels, the traditional single form of thermal power generation can no longer meet the needs of people's lives, and the academic community has begun to study new power supply modes.</p><p id="Par3">A long with the development of Energy Internet (EI), the power supply model in the future may be gradually transformed into Distributed Energy Resources (DER) as the main primary energy [<xref ref-type="bibr" rid="CR2">2</xref>]. DER is mainly composed of Distributed Generation (DG), Distributed Energy Storage (DES), Dispatchable Load (DL), Electric Vehicle (EV) and so on [<xref ref-type="bibr" rid="CR3">3</xref>]. When the clean and efficient DG represented by Wind Energy (WE), Hydroenergy (HE) and Photovoltaic (PV) are integrated into the power grid, the above greenhouse gas emission problems can be effectively alleviated [<xref ref-type="bibr" rid="CR4">4</xref>]. Experts pointed out that by the end of 2016, about 25% of the world's electricity originated from DER, also predicted that DER generation will account for about 30% in 2022 and even more than 60% in 2050 [<xref ref-type="bibr" rid="CR5">5</xref>]. Although DER is widely valued, there are still certain problems remaining in its application. Firstly, features of the DG are small capacity and uneven distribution, energy generation from the DER is intermittent and random making energy less reliable [<xref ref-type="bibr" rid="CR6">6</xref>]; Secondly, when the power generated by DER is directly connected to the grid, these powers are invisible and uncontrollable. If the amount of grid-connected is too large, it is easy to cause load fluctuations, which will cause the power system to lose safety and reliability [<xref ref-type="bibr" rid="CR7">7</xref>]; Finally, the supply-demand relationship of the power market becomes a bottleneck hindering further advancement of DER.</p><p id="Par4">In order to mitigate the problems caused by DER connected to the grid directly, two different grid-connected technologies were proposed in the industry, Micro Grid (MG) and Virtual Power Plant (VPP) [<xref ref-type="bibr" rid="CR8">8</xref>]. MG, a small power distribution system with integration of several modules composed of DG, the controllable load, energy storage and energy conversion equipment especially including monitoring and protection equipment [<xref ref-type="bibr" rid="CR9">9</xref>], have a certain energy management function, can enhance the reliability of power supply and provide continuous power supply for important users. Nevertheless, there are certain physical limitations, the characteristics of DER (large-scale, multi-regional) would lead to results that cannot be fully utilized in the MG. In contrast, VPP is not restricted by geographical location, can coordinate and manage the market operation of centralized and distributed energy through advanced coordinated control technology, intelligent metering technology and information and communication technology without changing the original grid-connection mode of DG [<xref ref-type="bibr" rid="CR10">10</xref>]. Currently, the research and use of virtual power plants are mainly concentrated in developed countries such as Europe and North America. Mashhour and Moghaddas-Tafreshi [<xref ref-type="bibr" rid="CR11">11</xref>] defined VPP as the flexible combination of a portfolio of DER that could maximize market benefits through bidding. Then, they proposed a non-equilibrium model of the deterministic price-based unit commitment which took into account the constraints of VPP itself, and used genetic algorithms to solve the bidding results. It is an inevitable trend to include more and more DER in the future distribution system, and a large number of VPPs will be established. The trading strategy between VPPs is a problem to be solved. For this consideration, Shabanzadeh et al. [<xref ref-type="bibr" rid="CR12">12</xref>] established a medium-term self-scheduling decision-making layer for VPP to solve the interests of different trading layers, the correctness of the decision is ensured by an effective risk management method based on the first-order stochastic dominance constraint. A key problem in deciding to provide bidding strategy for VPP is the accurate modeling of uncertain variables. To solve this issue, a stochastic adaptive robust optimization model was proposed by Baringo et al. [<xref ref-type="bibr" rid="CR13">13</xref>]. The optimization model consisted of robust optimization model and stochastic programming model, and the case study results of the model proved the applicability of the scheme. In the electricity market environment of Europe and the United States, Baringo et al. [<xref ref-type="bibr" rid="CR14">14</xref>] discussed the self-dispatching problem of VPP energy trading and reserves set up a day-ahead. They proposed a model to solve this problem by considering the uncertainty related to the virtual power plant required by the system operator to deploy reserves. A distinctive feature of the model is the use of adaptive robust optimization to model demand uncertainty. In addition to theoretical research, EU countries had already started to implement a series of VPP projects, such as VFCPP [<xref ref-type="bibr" rid="CR15">15</xref>], FENIX [<xref ref-type="bibr" rid="CR16">16</xref>], EDISON [<xref ref-type="bibr" rid="CR17">17</xref>] and GVPP [<xref ref-type="bibr" rid="CR18">18</xref>].</p><p id="Par5">The above-mentioned literatures and projects show the potential of VPP in energy market trading and scheduling, and can be used for reference for further research in the future. However, there are still some common problems in the existing VPP grid connection technology:
<list list-type="order"><list-item><p id="Par6">DER grid connection is highly free. With the increase of the number of DER in the grid, VPP is difficult to meet the profit-seeking demand and grid connection behavior of the massive DER in the power market driven by real-time electricity price, which increases the difficulty of the designing and implementing its coordinated control technology.</p></list-item><list-item><p id="Par7">VPP lacks an open and transparent trading platform and information platform, transactions between VPPs and transactions with other users usually have high costs. In the meantime, due to the information asymmetry between VPP and DER, so DER's enthusiasm to participate in electricity trading is not high.</p></list-item><list-item><p id="Par8">Lacking a set of methods or mechanism to ensure the security of data and information in the existing VPP system. The information needed by dispatching is directly transmitted through two-way communication technology. If the dispatching information is tampered with maliciously during the transmission, it will seriously affect the security and stability of the current power market.</p></list-item></list></p><p id="Par9">In 2008, the outbreak of the global financial crisis prompted Satoshi Nakamoto to propose a decentralized digital currency bitcoin, and the blockchain is the core technology that supports the operation of bitcoin [<xref ref-type="bibr" rid="CR19">19</xref>]. After passing through the frenzy period of digital currency, blockchain has become one of the research hotspots in academia due to its decentralization, trustlessness, openness and transparency. With continuous research, the application range of blockchain has become more and more extensive, and it is no longer limited to the financial sector. The integration of blockchain into the energy industry can provide new solutions to the above problems. Different from the traditional centralized system, each node on the blockchain is given the same power. Even if a single point of failure occurs, it will not affect the entire blockchain system [<xref ref-type="bibr" rid="CR20">20</xref>]. Unguru [<xref ref-type="bibr" rid="CR21">21</xref>] analyzed the advantages and risks of blockchain application in the energy sector, and conclused that the advantages far outweigh the disadvantages for consumers. A survey of decision makers in the German energy industry was conducted by Burger et al. [<xref ref-type="bibr" rid="CR22">22</xref>], which showed that most people think that blockchain technology has great potential in the energy field. Hasse et al. [<xref ref-type="bibr" rid="CR23">23</xref>] introduced the history of blockchain technology and its potential impact in different industries, and then emphatically analyzed the feasibility of applying blockchain technology to the energy industry from the perspective of consumers. At the same time, the challenges from laws or rules faced by the application of blockchain in the energy industry were also described in detail. Starting from the concepts and characteristics of blockchain technology and virtual power plant, Starting from the concepts and characteristics of blockchain technology and virtual power plant, He and Ai [<xref ref-type="bibr" rid="CR24">24</xref>] analyzed the feasibility of blockchain technology in VPP and the complementarity between the two fusions. With the continuous growth of DER, how to reasonably integrate new participants into the energy market has become a key problem that must be solved. Therefore, Galici et al. [<xref ref-type="bibr" rid="CR25">25</xref>] designed a physical platform to simulate the local electricity market. The platform was mainly managed by an integrator who plays the role of VPP. The integrator needed to collect and publish the quotation information of transaction participants, and then used blockchain technology to complete the user’s business transaction. The development of technology promotes the evolution of smart grid to EI. For the better development of EI, Lu et al. [<xref ref-type="bibr" rid="CR26">26</xref>] established a blockchain-based VPP transaction model for EI driven by electricity prices in real time. In order to simplify the existing complex power transaction and settlement process, a VPP distributed energy transaction smart contract based on blockchain technology was proposed. The promotion of electric vehicles not only brings clean and environmental protection, but also makes the power transaction, especially caused by charging and discharging, face more severe security challenges. Li and Hu [<xref ref-type="bibr" rid="CR27">27</xref>] designed a two-layer optimized dispatch architecture based on consortium blockchain, and realized safe two-way power trading between electric vehicles and smart grids under the constraints of circuit power flow and vehicle travel demand. Most of the above-mentioned documents focus on the energy dispatch and transaction process, without too much analysis of blockchain technology.</p><p id="Par10">This paper focuses on the specific role of blockchain technology to realize the energy dispatch and transaction process in the operation of VPP. The main contributions are summarized as follows:
<list list-type="order"><list-item><p id="Par11">Considering that the amount of real-time data generated by DER is too large, a storage architecture based on dual blockchains is proposed, which consists of a private blockchain at the bottom and a consortium blockchain at the top. The private blockchain is formed by each DER supplier to store the production information required for VPP scheduling calculation. The central node of the private blockchain has the risk of tampering with data. We use a more secure alliance blockchain to ensure the security of private chain data, mainly by storing private blockchain abstracts. The alliance blockchain is composed of all nodes in the system. It not only stores the private blockchain abstracts, but also stores transaction information involving the interests of participants.</p></list-item><list-item><p id="Par12">A large amount of data and information are needed in the VPP scheduling process. To avoid malicious tampering of key information and ensure the confidentiality and authenticity of the information, a hybrid attribute proxy re-encryption algorithm based on ciphertext strategy is proposed. Agents can convert ciphertext based on attribute encryption into ciphertext identity-enabled encryption, which reduces the decryption cost of data visitors.</p></list-item><list-item><p id="Par13">In order to ensure that participants have good market behavior, a reputation-based continuous double auction mechanism is proposed, which combines a reputation with market segmentation mechanism and a continuous double auction mechanism. The reputation value and identity of the participants are the basis for their classification. The higher the reputation value, the more preferential treatment the participants can get. In addition, this paper proposes the concept of energy currency to facilitate transactions in the electricity market, which will be the only currency in system transactions.</p></list-item></list></p><p id="Par14">The rest of this paper is arranged as follows: Section 2 introduces the preliminary knowledge. In Section 3, we discuss the basic framework diagram of virtual power plant resource scheduling and transaction mechanism based on dual blockchains. We described the specific implementation details of the scheme, such as the process of re-encryption based on the attribute proxy of the blockchain, the process of the reputation-based blockchain energy transaction mechanism, and the process of block generation in Section 4. In Section 5, we conduct a safety analysis and performance evaluation of the proposed scheme. Finally, we summarize the whole paper.</p></sec><sec id="Sec2"><title>Preliminaries</title><sec id="Sec3"><title>Blockchain</title><p id="Par15">As a whole, blockchain, which enables data storage, circulation and processing by integrating various existing technologies, is a new distributed computing parading. It uses the distributed node consensus algorithm to generate and update the data, uses cryptography to ensure the immutability and unforgeability of the stored data, and the data transmission between nodes is completed through the point-to-point network [<xref ref-type="bibr" rid="CR28">28</xref>]. Currently, in the light of different modes of node participation, blockchain network can be divided into three types: public blockchain, consortium blockchain and private blockchain [<xref ref-type="bibr" rid="CR29">29</xref>].</p><p id="Par16">Among them, non-public blockchains such as consortium blockchain and private blockchain can be collectively referred to as permissioned blockchain. The public blockchain is also known as the permissionless blockchain, which allows any user with a network computer in the world to freely join and read block information freely. It is a completely decentralized blockchain in the true sense. Consortium blockchain refers to a multi-centralized blockchain composed of multiple organizations or institutions with the characteristics of common maintenance and access mechanisms. Only institutions certified by the consortium can join the consortium blockchain. A private blockchain refers to a blockchain in which the write permission of each node is completely controlled by an organization, and the read permission is selectively opened to the outside world by the organization. Although the consensus and verification processes of private blockchains are strictly limited to specific scopes by belongs institutions, they still have a general structure of multi-node blockchains, and private blockchains are often regarded as public blockchains within a small-scale system. The model diagram of the three blockchains is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Diagram of three blockchain models</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig1_HTML.png" id="MO1"/></fig></p></sec><sec id="Sec4"><title>Virtual power plant</title><p id="Par17">The Virtual Power Plant (VPP) originated from the definition of virtual public facilities which proposed by Awerbuch and Preston [<xref ref-type="bibr" rid="CR30">30</xref>]. Virtual public facilities refer to a flexible cooperative relationship between independent entities driven by the market. This virtual cooperative relationship enables participating entities to provide consumers with high-quality power services without having to own corresponding physical assets.</p><p id="Par18">The traditional VPP is committed to regional power integration, so as to provide better power services for internal users. Nevertheless, with the addition of emerging technologies such as Demand Response (DR), Demand-Side Management (DSM) and Local Energy Market (LEM), VPP has gradually played the role of the unified DER agent in LEM. While realizing the integrated scheduling of DER, it is also necessary to provide technical support for DER to participate in the bidding and ancillary services of the electricity market. For VPP, its nerve center is the dispatching control center. Wei et al. [<xref ref-type="bibr" rid="CR31">31</xref>] divides it into two modules according to their functions—Commercial VPP (CVPP) and Technical VPP (TVPP). The operation process and division of responsibilities of the two modules are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Information interaction and operation flow of virtual power plant</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par19">CVPP is a VPP considered from the perspective of commercial revenue, aiming to improve the overall benefits of VPP. CVPP, regardless of the impact of VPP on the distribution network, adds DER to the electricity market in the same way as traditional power plants. CVPP receives economic parameters from DER, and then combines these parameters with market intelligence to develop a profit-driven bidding plan. Once the market authorization is obtained, CVPP will sign a medium and long-term contract with LEM, and submit DER generation schedule and operation cost information to TVPP [<xref ref-type="bibr" rid="CR32">32</xref>]. CVPP can represent any number of DER, and DER can also arbitrarily select a CVPP to join in order to enter the electricity market for energy trading. Such as energy suppliers, trusted third parties or new market entrants can assume the responsibilities of CVPP. The purpose of CVPP is to maximize the benefits.</p><p id="Par20">Different from CVPP, TVPP, from the perspective of system scheduling, mainly responsible for parameter collection and operation monitoring. After TVPP integrates the data parameters provided by CVPP and DER, it calculates the contribution that the DER belongs to, and then declares the operating characteristics of the VPP to the power dispatch operation center. When the dispatching center finds the risk of power flow overrun or power imbalance in the operation plan of VPP, the dispatching center will send dispatching instructions to TVPP, so that TVPP can ensure the stability and security of power system by responding to the dispatching instructions in a timely manner. It should be noted that the operation plan of VPP is evaluated together with that of traditional power plants. If the evaluation is approved, DER shall strictly follow the plan issued by TVPP.</p><p id="Par21">Economy and safety are important cornerstones to ensure the lasting and stable operation of VPP, whereas CVPP and TVPP correspond to these two characteristics respectively. Namely, to ensure the economy and security of VPP is to ensure the stable operation of CVPP and TVPP.</p></sec><sec id="Sec5"><title>Bilinear pairing</title><p id="Par22">Supposing the three cyclic groups <italic>G</italic><sub><italic>x</italic></sub>, <italic>G</italic><sub><italic>y</italic></sub> and <italic>G</italic><sub><italic>z</italic></sub>of order <italic>p</italic> and the generator <italic>g</italic>, based on bilinear pairing, there is a mapping relationship <italic>e</italic> : <italic>G</italic><sub><italic>x</italic></sub> × <italic>G</italic><sub><italic>y</italic></sub> → <italic>G</italic><sub><italic>z</italic></sub>, and the following properties are satisfied [<xref ref-type="bibr" rid="CR33">33</xref>]:
<list list-type="order"><list-item><p id="Par23">Bilinear: For ∀<italic>g</italic><sub><italic>x</italic></sub> ∈ <italic>G</italic><sub><italic>x</italic></sub>, <italic>g</italic><sub><italic>y</italic></sub> ∈ <italic>G</italic><sub><italic>y</italic></sub>, <inline-formula id="IEq1"><alternatives><mml:math display="inline" id="IEq1_Math"><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ q,h\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq1.gif"/></alternatives></inline-formula>, there is always Ǝ <inline-formula id="IEq2"><alternatives><mml:math display="inline" id="IEq2_Math"><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>g</mml:mi><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mi>y</mml:mi><mml:mi>h</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfenced><mml:mi mathvariant="italic">qh</mml:mi></mml:msup></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ e\left({g}_x^q,{g}_y^h\right)=e{\left({g}_x,{g}_y\right)}^{qh} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq2.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par24">Non-degeneracy: Always exists <italic>g</italic><sub><italic>x</italic></sub> ∈ <italic>G</italic><sub><italic>x</italic></sub>, <italic>g</italic><sub><italic>y</italic></sub> ∈ <italic>G</italic><sub><italic>y</italic></sub>, such that <italic>e</italic>(<italic>g</italic><sub><italic>x</italic></sub>, <italic>g</italic><sub><italic>y</italic></sub>) ≠ 1.</p></list-item><list-item><p id="Par25">Computability: There is an effective algorithm that makes <italic>e</italic>(<italic>g</italic><sub><italic>x</italic></sub>, <italic>g</italic><sub><italic>y</italic></sub>) computable under the condition of ∀<italic>g</italic><sub><italic>x</italic></sub> ∈ <italic>G</italic><sub><italic>x</italic></sub>, <italic>g</italic><sub><italic>y</italic></sub> ∈ <italic>G</italic><sub><italic>y</italic></sub>.</p></list-item></list></p><p id="Par26">When <italic>G</italic><sub><italic>x</italic></sub>=<italic>G</italic><sub><italic>y</italic></sub>, the pairing can be called symmetric bilinear pairing, otherwise it is asymmetric. It should be noted that the bilinear pairing mentioned here is based on the prime order, that is, <italic>p</italic> is a prime number.</p><p id="Par27">It should be noted that the bilinear pairing mentioned here is based on the prime order, that is, <italic>p</italic> is a prime number. Boneh et al. [<xref ref-type="bibr" rid="CR34">34</xref>] introduced a new bilinear pairing based on composite order to the field of cryptography. The composite order bilinear pairing can prove its safety under the premise of realizing high-complexity functions through the orthogonality of sub-groups.</p></sec><sec id="Sec6"><title>Access structure</title><p id="Par28">Assume there is a set of parties <italic>P</italic> = {<italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub>, …, <italic>P</italic><sub><italic>n</italic></sub>}, then we define a collection <italic>A</italic> ⊆ 2<sup><italic>P</italic></sup>. The collection is monotonic if for any <italic>B</italic> and <italic>C</italic>, we can conclude that <italic>C</italic> ∈ <italic>A</italic> when <italic>B</italic> ∈ <italic>A</italic> and <italic>B</italic> ⊆ <italic>C</italic>. An access structure is a collection <italic>A</italic> of nonempty subsets of <italic>P</italic> (access structure and collection <italic>A</italic> are monotonic), such as <italic>A</italic> ⊆ 2<sup><italic>P</italic></sup>\∅. The set in <italic>A</italic> are called authorized sets, on the contrary, they are called unauthorized sets.</p></sec><sec id="Sec7"><title>Smart contract</title><p id="Par29">The concept of smart contract first proposed by Szabo [<xref ref-type="bibr" rid="CR35">35</xref>] in the late 1990s. Its basic idea is to embed part of contract into hardware or software in the form of code, so as to achieve a certain degree of decoupling with people when executing the contract, and to reduce the possibility of breach and increase the cost of breach. The essence of a smart contract is a treaty signed and recognized by both parties or even multiple parties. To ensure the effective execution of the contract, a trusted third party or arbitration institution will be needed. The smart contract incorporates the concept of machines into the execution of the contract, virtualizing part of the functions of the arbitration institution. If one party breaches the contract, the software or hardware of the machine needs to be modified, which increase the difficulty of breaching the contract.</p><p id="Par30">Since 2016, the smart contract technology represented by Ethereum [<xref ref-type="bibr" rid="CR36">36</xref>] has attracted increasing attention. The European Conference held in February 2017 pointed out that smart contract technology is the most promising one among the various applications of blockchain. Smart contracts are typically stored in blockchain as scripts, whose stored procedures can be referenced from operations in relational database management systems. Blockchain technology is the basis of smart contract, which solves the problem of contract execution in the absence of a trusted third party. Smart contract reflects its value through blockchain, and the value of blockchain is also released due to smart contract.</p></sec></sec><sec id="Sec8"><title>System model</title><sec id="Sec9"><title>VPP data storage and sharing model</title><sec id="Sec10"><title>System global model</title><p id="Par31">In view of the lack of transparent VPP platform and the difficulty of data analysis, this paper proposes an information storage system based on blockchain technology. Different from most storage systems based on blockchain technology, this system will adopt two sets of blockchain systems: consortium blockchain and private blockchain. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, VPP is divided into CVPP transaction information storage layer based on consortium blockchain and TVPP scheduling information storage layer based on private blockchain, which are referred to as Commercial Transaction Consortium Blockchain (CTCB) and Technology Scheduling Private Blockchain (TSPB).
<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>VPP data storage and sharing system based on dual blockchains</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig3_HTML.png" id="MO3"/></fig></p><p id="Par32">Through the design of VPP information storage and sharing architecture of dual blockchains, the advantages of the consortium blockchain and private blockchain can be fully combined, so that they can play advantages at the level of their respective managements. Energy trading is an important part of national management. In the CVPP transaction layer, the consortium blockchain can be used to set the threshold for the entry of nodes, and the data access right of nodes can also be set and controlled. Meanwhile, the consortium chain inherits the advantages of partial decentralization of the public blockchain, and avoids the monopoly pressure similar to the high concentration of the private blockchain. Since the number of nodes in the consortium blockchain is known, a more efficient consensus algorithm can be used to improve the system performance and transaction efficiency without consuming huge computing power to maintain the system. In addition, when VPP performs energy dispatch, it needs a large amount of production information form DER, such as energy type, working power, generation quota and other external information as for local time, geographical location, weather and so on. Using private blockchain in TVPP scheduling layer can achieve efficient, large capacity and low-cost information storage. Therefore, the purpose of this paper is to realize the complementarity of the two blockchains to form a practical information storage scheme.</p></sec><sec id="Sec11"><title>TSPB local storage model</title><p id="Par33">TSPB is mainly used to record the relevant information required by energy dispatching in the region under the jurisdiction of VPP, and relies on the nature of blockchain technology to ensure the authenticity, integrity and privacy of relevant information. TSPB is composed of TVPP, Power Dispatching Control Center (PDCC) and DER which TVPP belongs, each VPP can build its own TSPB. Data storage in TSPB is similar to Bitcoin, when a new block is allowed to be added to the blockchain, distributed nodes link it to the longest legal blockchain. The information recorded by the blockchain exists in these blocks, which are divided into block header and block body [<xref ref-type="bibr" rid="CR37">37</xref>]. The block header is mainly used to store version number, previous block hash, timestamp, Merkel root and current block hash. Merkel root represents the total hash value of all transaction combinations contained in the block. The concrete information of the transaction is stored in the block body. The transaction data is hashed by pairwise pairing through the Merkel tree [<xref ref-type="bibr" rid="CR38">38</xref>], and finally points to the Merkel root in the block header. The specific data storage model is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> (a).
<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Regional model for data storage</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig4_HTML.png" id="MO4"/></fig></p></sec><sec id="Sec12"><title>CTCB local storage model</title><p id="Par34">CTCB is mainly used as LEM's energy transaction record. It also relies on the nature of blockchain technology to ensure the authenticity, integrity, openness and traceability of the transaction process. CTCB is composed of Power Exchange Center (PEC), CVPP, residences, factories and DER which CVPP belongs. Unlike TSPB, there is only one CTCB in EI, and its operation is jointly maintained by all nodes in the network. CTCB adopts the data storage mode of Ethereum. Ethereum has improved the storage mode of bitcoin and proposed an account-based data storage mode. Based on the storage mode of Ethereum, there is an additional LogsBloom filter in the block header. This filter is mainly used to judge whether the transaction of a block has generated a log, thereby avoiding the storage of log information in the block and saving space. What's more, it stores Merkel Patricia tree (MPT) roots instead of Merkel roots. MPT is composed of Merkel tree and Patricia tree (PT). The difference between MPT and PT is that the pointer of connection node is hash pointer, and a Merkel root will be saved in the end. PT is a variant of the prefix tree. Its working principle is similar to that of the prefix tree, but the characters of the prefix tree are compressed to save storage space. There are three types of MPT root in Ethereum: status root, transaction root and receipt root. There is only one status tree in the whole system, which records the account status of the whole blockchain network, such as account balance. In each block, there will be a transaction tree and a receipt tree. The former records the transaction information of the block, and the latter records the transaction receipt of the block. In order to ensure the security of data in TSPB, the transaction tree of CTCB should store not only transaction information, but also TSPB block hash value. The CTCB data storage model is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> (b).</p></sec></sec><sec id="Sec13"><title>VPP security scheduling model</title><sec id="Sec14"><title>Key technologies of VPP scheduling</title><sec><p id="Par35">As mentioned above, the key technologies of VPP scheduling include coordinated control technology, intelligent metering technology and information communication technology.</p></sec><sec id="FPar1"><title>Coordinated control technology</title><p id="Par36">The objects controlled by the coordinated control technology are mainly DER such as DG, energy storage system, controllable load and EV etc., and the purpose is to realize the electric energy output of diversified DERs to users with high demand [<xref ref-type="bibr" rid="CR31">31</xref>]. Considering the randomness or intermittence of renewable energy (light and wind) power stations, the DG classified into VPP should include at least one fully controllable power station (conventional power station) [<xref ref-type="bibr" rid="CR39">39</xref>]. VPP can be divided into centralized control, decentralized control and hybrid control according to its internal DG composition and operation mode [<xref ref-type="bibr" rid="CR40">40</xref>]. In centralized control mode, the energy coordination in the region under the jurisdiction of VPP is performed by the Control Coordination Center (CCC) located in the VPP center. CCC processes and analyzes the data from DER through appropriate algorithms (mathematical algorithm or heuristic algorithm, the former is used to solve linear programming problems, and the latter is used to solve nonlinear programming problems), so as to obtain the scheduling of each DER, then DER works according to the CCC scheduling scheme to achieve global coordination. However, this structure is only used when CCC has very strong computing power and communication bandwidth, and a single point of failure of CCC will cause the system to crash. In decentralized control mode, VPP no longer owns CCC, and each DER is in an independent alliance relationship. VPP here only provides key parameters and information exchange channels for DER, and does not participate in DER energy scheduling process. The DER belonging to it realizes self-scheduling according to the information from VPP. Under this mode, the composition of VPP is loose, and the competition between DER is fierce, which is not conducive to long-term development. The hybrid mode integrates the characteristics of the above two patterns, which not only has CCC to coordinate the global scheduling, but also gives DER part of the autonomous control. In this mode, DERs with the same ownership are integrated and managed by the same agent, and VPP directly interacts with each agent for information. Agents share part of the integration tasks of virtual power plants, which, compared with the centralized control mode, reduces the computing burden of CCC and alleviates the communication pressure. Compared with decentralized control mode, DER ensures the internal coordination of VPP system while guaranteeing a certain degree of autonomy.</p></sec><sec id="FPar2"><title>Intelligent metering technology</title><p id="Par37">Intelligent metering technology is an important part of VPP. Intelligent devices such as smart meters using intelligent metering technology are embedded into the power supply side or the terminal of equipment on the power side to realize real-time data recording and uploading. Finally, the data is aggregated to the VPP, and VPP will perform the aforementioned coordination scheduling based on the data. To ensure the authenticity of recorded data, smart devices should have tamper-proof features.</p></sec><sec id="FPar3"><title>Information communication technology</title><p id="Par38">The technology guarantees the normal communication between VPP and DER. VPP mainly adopts two-way communication technology. On the one hand, VPP can receive the status information transmitted by the intelligent devices embedded in each unit. On the other hand, it can send scheduling control information to each unit.</p></sec></sec><sec id="Sec15"><title>Security scheduling model</title><p id="Par39">Since VPP is data-driven, damaging the data authenticity will seriously affect the stability of the system. Different from traditional VPP information interaction, this paper adopts blockchain technology to share information. Blockchain technology can only guarantee the invariability of recorded data, while the credibility of input data cannot be guaranteed, it is necessary to use tamper-proof intelligent metering devices to input data [<xref ref-type="bibr" rid="CR41">41</xref>]. The data of smart metering devices are updated and uploaded in real time. If it is directly transmitted to the VPP through the blockchain technology, it will cause a huge communication burden. VPP usually aggregates data every 5 or 15 minutes. To ensure the authenticity and confidentiality of data during this period, smart metering devices encrypt the data and store it in the blockchain. When data is encrypted, it is difficult to share it with other users who want to access it. Proxy re-encryption [<xref ref-type="bibr" rid="CR42">42</xref>] can convert the encrypted file into ciphertext that the data requester can decrypt with his/her private key through a semi-trusted agent without disclosing the private key of the delegator. In the hybrid control model, each DER agent can just act as the identity of the re-encryption proxy. The specific security scheduling model is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>VPP security scheduling model based on dual blockchain</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig5_HTML.png" id="MO5"/></fig></p><p id="Par40">The various process steps occurring in the system model are described as follows:
<list list-type="bullet"><list-item><p id="Par41"><bold>Step 1.</bold> The verification organization verifies the nodes that apply to join, and the verified nodes use identity-based encryption algorithms to generate exclusive public-private key pairs (<italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub>). In the scheduling process, it is mainly to analyze and process the information uploaded by DER. In order to ensure the confidentiality and sharing of the uploaded information, this paper adopts the ciphertext-based hybrid proxy re-encryption technology. Therefore, verification organization needs to additionally generate an encryption key <italic>SK</italic><sub><italic>S</italic></sub> for DER, which is generated by an attribute-based encryption algorithm and can encrypt uploaded information according to attributes.</p></list-item><list-item><p id="Par42"><bold>Step 2.</bold> DER with built-in tamper-proof intelligent metering device uses encryption keys <italic>SK</italic><sub><italic>S</italic></sub> to encrypt the real-time production data according to attributes, and then stores the encrypted data in the private chain TSPB. At the same time, DER continuously conducts energy transactions through CVPP, and its transaction information is stored in the consortium blockchain CTCB. To ensure the security of private blockchain data, the private blockchain hash will also be stored in the consortium blockchain.</p></list-item><list-item><p id="Par43"><bold>Step 3.</bold> Under the hybrid control model, DER agents share the operating pressure of TVPP, and DER agents are responsible for the same ownership of DER. When TVPP in the private chain needs a new round of scheduling, it needs to send a data access application to the DER agent.</p></list-item><list-item><p id="Par44"><bold>Step 4.</bold> After receiving the data access application from TVPP, the DER agent aggregates from the private blockchain TSPB the data <italic>CT</italic><sub><italic>A</italic></sub> that has been encrypted and uploaded by DER during the period since the last scheduling.</p></list-item><list-item><p id="Par45"><bold>Step 5.</bold> Since the DER agent has the ownership of the DER under its jurisdiction, the proxy re-encryption key <inline-formula id="IEq3"><alternatives><mml:math display="inline" id="IEq3_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq3.gif"/></alternatives></inline-formula> is directly generated by the DER agent, without the need for DER generation and forwarding to the DER agent. The <italic>SK</italic><sub><italic>S</italic></sub> required in the re-encryption key generation algorithm is issued and obtained by the verification organization in the Step 1. After generating <inline-formula id="IEq4"><alternatives><mml:math display="inline" id="IEq4_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq4.gif"/></alternatives></inline-formula>, DER agents use it to re-encrypt the ciphertext <italic>CT</italic><sub><italic>A</italic></sub> to obtain the re-encrypted ciphertext <inline-formula id="IEq5"><alternatives><mml:math display="inline" id="IEq5_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq5.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par46"><bold>Step 6.</bold> After <inline-formula id="IEq6"><alternatives><mml:math display="inline" id="IEq6_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq6.gif"/></alternatives></inline-formula> is generated, the DER agent immediately sends it to TVPP. TVPP obtains <inline-formula id="IEq7"><alternatives><mml:math display="inline" id="IEq7_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq7.gif"/></alternatives></inline-formula> and decrypts it with its own private key <inline-formula id="IEq8"><alternatives><mml:math display="inline" id="IEq8_Math"><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SK}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq8.gif"/></alternatives></inline-formula> to obtain the data required for scheduling.</p></list-item><list-item><p id="Par47"><bold>Step 7.</bold> The CVPP based on the alliance blockchain collects the quotation information within its jurisdiction, and then promotes the electric energy transaction through the continuous double auction mechanism based on reputation. Participants who have not successfully traded will be handled by PTC. During the transaction, DER’s reputation value and transaction volume and other relevant economic information will be transmitted in VPP’s internal communications. It should be noted that the internal communication of VPP is two-way, which means that CVPP can also obtain messages from TVPP at this stage.</p></list-item><list-item><p id="Par48"><bold>Step 8.</bold> Collecting production information from DER and economic parameter information from CVPP, TVPP calculates the optimal global scheduling plan by using mathematical algorithms or intelligent heuristic algorithms. During the calculation process, DER agents can share the calculation pressure for TVPP. In addition, the reputation value of DER can affect the final result to a certain extent, and those with high reputation value will appropriately consider allocating more production quotas.</p></list-item><list-item><p id="Par49"><bold>Step 9.</bold> TVPP first sends the calculated scheduling plan to PDCC for security verification. If the verification passes, TVPP sends the plan to all DER agents in the same private blockchain. If the verification fails, TVPP needs to recalculate the new optimal scheduling plan.</p></list-item><list-item><p id="Par50"><bold>Step 10.</bold> The DER agent sends the received scheduling plan to the DER under its jurisdiction, and then supervises the DER to respond to the scheduling optimization plan. The response rate and the degree of completion of the plan will affect the evaluation of the reputation value.</p></list-item></list></p></sec></sec><sec id="Sec16"><title>VPP market trading model</title><sec><p id="Par51">At present, DER transactions are mainly divided into two ways: P2P transactions and centralized clearing [<xref ref-type="bibr" rid="CR43">43</xref>]. The former is a direct transaction between individuals, in which both parties have only Power Units (PU) and Generation Units (GU), and the transaction is automatically executed through a pre-made contract. The latter is a unified transaction under the optimal scheduling of the intermediary, that is, in addition to the two parties of the transaction, there should also be a third-party platform to match the transaction. For DER transactions based on blockchain, centralized clearing may be a good choice.</p></sec><sec><p id="Par52">According to the way of quotation, the centralized clearing can be further subdivided into call auction and Continuous Double Auction (CDA) [<xref ref-type="bibr" rid="CR43">43</xref>]. Under the call auction mode, once the two parties of a transaction give a quotation, it is impossible to modify it. The third-party platform summarizes all the quotations and matches them according to the quotation and demand of both parties. Instead, CDA allows both parties to modify their quotations during each auction. Compared with the two parties, CDA is more conducive to realizing the goal of maximizing benefits, which is also the specific transaction mode adopted by the transaction model proposed in this paper.</p></sec><sec><p id="Par53">To ensure that both parties have good market behavior, we have introduced the concept of reputation in the CDA auction mechanism, each user has its own reputation. The reputation of both parties to the transaction will be re-evaluated after a certain period of time, the level of the value is directly linked to the economic interests of the users, the higher reputation points of users, the more able to maximize their own interests. In addition, we will introduce a new digital cryptocurrency, named energy coin, in the transaction process. All the power transaction clearing processes in this paper are based on energy coin, and the specific transaction model is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.
<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>VPP market trading model based on dual blockchains and reputation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig6_HTML.png" id="MO6"/></fig></p></sec><sec><p id="Par54">The basic flow of the trading model is as follows:</p></sec><sec id="FPar4"><title>Initializing variables</title><p id="Par55">Same as Step 1 in the scheduling process, the function of initialization is to verify the identity of the trader and provide a public-private key pair (<italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub>) for the passer. Only users with accounts can conduct communication transactions on the consortium chain CTCB, and (<italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub>) are the prerequisite for generating accounts.</p></sec><sec id="FPar5"><title>Reputation-based CDA auction stage</title><p id="Par56">PU and GU send their own quotations, demand and reputation to CVPP. CVPP matches transactions according to the reputation-based CDA auction mechanism, and continuously feeds back matching information to each participant entities, so as to make timely quotation revisions. Once the transaction is matched successfully, CVPP will broadcast the transaction information in the CTCB of the alliance blockchain. At this time, it is not recorded in the block. Only when all stages are completed will the transaction information be stored in the block.</p><p id="Par57">After the auction ends, the unmatched information will be sent to PTC, and PTC will be responsible for related transactions. More details about the reputation-based CDA auction mechanism will be introduced in subsequent sections. It should be noted that when DER agents aggregate all local DER quotations and submit them to CVPP, their DERs have been continuously uploading production information to their private blockchain TSPB.</p></sec><sec id="FPar6"><title>Transaction and settlement stage</title><p id="Par58">The successfully matched GU checks the transaction information, and after confirmation is correct, it supplies power to the corresponding PU according to the determined transaction power. After the PU receives the determined amount of electricity, it pays energy coins at the price negotiated in advance. In this process, any party who fails to complete the transaction as required will be punished economically by the system, and a certain amount of reputation value will be deducted. PU that has not successfully matched can choose to sell the excess electricity to PTC, thereby obtaining a certain amount of energy currency as a reward. At the same time, the PU can also choose to store electrical energy in its own energy storage equipment and wait for the next round of auctions. The unmatched power users directly purchase electricity from PTC.</p><p id="Par59">Energy currency is the only transaction currency of this system. When the user registers for the first time, the system will give a certain amount of energy currency to the user. When users have insufficient energy coins, they can purchase energy coins from PTC or DER agents. In addition, users with good reputation have the opportunity to participate in the consensus process of the system, thereby obtaining energy coins rewarded by the system.</p></sec></sec></sec><sec id="Sec17"><title>System implementation</title><sec id="Sec18"><title>Hybrid attribute proxy re-encryption scheme based on ciphertext policy</title><p id="Par60">Attribute-based proxy re-encryption (ABPRE) [<xref ref-type="bibr" rid="CR44">44</xref>] is an encryption mode. Proxy can convert ciphertext encrypted based on ciphertext policy (CP) or key policy (KP) into new re-encrypted ciphertext under the authorization of the data owner. The process does not change the plaintext information. However, most ABPRE schemes have efficiency problems when applied to incentive scenarios, because these schemes need to calculate the key components of all internal attributes in the re-encryption key generation stage, even if the data applicant has only one attribute. This working mechanism is likely to cause waste of computing power and time. To solve this problem, we combine the cost-effective identity-based encryption algorithm (IBE) [<xref ref-type="bibr" rid="CR45">45</xref>] with ABPRE, and propose a hybrid attribute proxy re-encryption algorithm based on ciphertext strategy (CP-HAPRE).</p><p id="Par61">CP-HAPRE consists of a tuple (<italic>S</italic>e<italic>tup</italic>, <italic>KGen</italic>, <italic>Enc</italic>, <italic>RKGen</italic>, <italic>ReEnc</italic>, <italic>Sig</italic>, <italic>Dec</italic>, <italic>ReDec</italic>). In the actual VPP security scheduling information sharing model, DER uses the ciphertext strategy attribute to encrypt the information recorded by the tamper-proof meter in real-time and upload it to the blockchain. When VPP requires DER to provide information for related scheduling operations, the DER agent uses the <italic>CP</italic> secret key <italic>SK</italic><sub><italic>S</italic></sub> and the ID of the VPP to generate a re-encryption secret key <inline-formula id="IEq9"><alternatives><mml:math display="inline" id="IEq9_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq9.gif"/></alternatives></inline-formula>, and then uses <inline-formula id="IEq10"><alternatives><mml:math display="inline" id="IEq10_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq10.gif"/></alternatives></inline-formula> to generate a re-encrypted ciphertext <inline-formula id="IEq11"><alternatives><mml:math display="inline" id="IEq11_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq11.gif"/></alternatives></inline-formula>, which VPP can decrypt with the private key generated by its own ID. The combination of this algorithm and the blockchain ensures that VPP can obtain real and safe DER information. VPP performs a series of calculations and predictions based on this information, and finally obtains a reliable scheduling scheme. The variable notations involved in the CP-HAPRE scheme are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. The following is a specific program description:
<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Symbol definition of our system implementation</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Symbol</p></th><th><p>Definition</p></th></tr></thead><tbody><tr><td><p>ℓ, <italic>M</italic></p></td><td><p>System security parameters, Plaintext</p></td></tr><tr><td><p><italic>U</italic>, <italic>S</italic></p></td><td><p>System/ User attribute set</p></td></tr><tr><td><p><italic>GP</italic>, <italic>GP</italic><sub><italic>IBE</italic></sub></p></td><td><p>System/IBE public parameters</p></td></tr><tr><td><p><italic>MSK</italic>, <italic>MSK</italic><sub><italic>IBE</italic></sub></p></td><td><p>System/IBE master secret key</p></td></tr><tr><td><p><italic>SK</italic><sub><italic>S</italic></sub></p></td><td><p>CP key</p></td></tr><tr><td><p><italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub></p></td><td><p>IBE public/ private key</p></td></tr><tr><td><p>(<italic>A</italic>, <italic>ρ</italic>)</p></td><td><p>Shared structure</p></td></tr><tr><td><p><inline-formula id="IEq12"><alternatives><mml:math display="inline" id="IEq12_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq12.gif"/></alternatives></inline-formula></p></td><td><p>Re-encryption key</p></td></tr><tr><td><p><inline-formula id="IEq13"><alternatives><mml:math display="inline" id="IEq13_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_A,{CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq13.gif"/></alternatives></inline-formula></p></td><td><p>Initial/ Re-encrypted ciphertext</p></td></tr></tbody></table></table-wrap></p><sec id="Sec19"><title>Step1: System initialization</title><p id="Par62"><italic>S</italic>e<italic>tup</italic>(1<sup>ℓ</sup>, <italic>U</italic>) → (<italic>GP</italic>, <italic>MSK</italic>): The verification organization executes the algorithm. Input the system safety parameters ℓ and the system attribute set <italic>U</italic>, and then construct two multiplicative cyclic groups <italic>G</italic> and <italic>G</italic><sub><italic>T</italic></sub> of order <italic>p</italic>, with <italic>p</italic> being a prime number. The <italic>g</italic>, <italic>g</italic><sub>1</sub>, <italic>g</italic><sub>2</sub> and <italic>g</italic><sub>3</sub> are all generators of <italic>G</italic>, <italic>G</italic> and <italic>G</italic><sub><italic>T</italic></sub> satisfy the bilinear mapping relationship <italic>e</italic> : <italic>G</italic> × <italic>G</italic> → <italic>G</italic><sub><italic>T</italic></sub>. Randomly select an element <inline-formula id="IEq14"><alternatives><mml:math display="inline" id="IEq14_Math"><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha \in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq14.gif"/></alternatives></inline-formula> and define three hash functions <italic>H</italic><sub>1</sub> : (0, 1)<sup>∗</sup> → <italic>G</italic>, <italic>H</italic><sub>2</sub> : <italic>G</italic><sub><italic>T</italic></sub> → <italic>G</italic>, <inline-formula id="IEq15"><alternatives><mml:math display="inline" id="IEq15_Math"><mml:msub><mml:mi>H</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_3:{G}_T\to {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq15.gif"/></alternatives></inline-formula>. Finally, output the system public parameters <italic>GP</italic> and the master key <italic>MSK</italic>.
<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mi mathvariant="italic">GP</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,,,,,"><mml:mi>p</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mi>α</mml:mi></mml:msup></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="italic">MSK</mml:mi><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ GP=\left(p,g,{g}_1,{g}_2,{g}_3,e{\left(g,g\right)}^{\alpha },{H}_1,{H}_2,{H}_3\right), MSK=\alpha $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ1.gif"/></alternatives></disp-formula></p><p id="Par63">It should be noted that the system public parameters and master key of <italic>IBE</italic> have been included in Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>. The specific <italic>IBE</italic> system public parameters <italic>GP</italic><sub><italic>IBE</italic></sub> and master key <italic>MSK</italic><sub><italic>IBE</italic></sub> are as follows.
<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:msub><mml:mi mathvariant="italic">GP</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,"><mml:mi>p</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mi>α</mml:mi></mml:msup></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">MSK</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">MSK</mml:mi><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {GP}_{IBE}=\left(p,{g}_1,e{\left(g,g\right)}^{\alpha },{H}_1,{H}_3\right),{MSK}_{IBE}= MSK=\alpha $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ2.gif"/></alternatives></disp-formula></p><p id="Par64">From the master key <italic>MSK</italic><sub><italic>IBE</italic></sub>, the system public key is <inline-formula id="IEq16"><alternatives><mml:math display="inline" id="IEq16_Math"><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:msubsup></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {PK}_{IBE}={g}_1^{\alpha } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq16.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec20"><title>Step2: Key generation</title><p id="Par65"><italic>KGen</italic><sub><italic>IBE</italic></sub>(<italic>GP</italic><sub><italic>IBE</italic></sub>, <italic>MSK</italic><sub><italic>IBE</italic></sub>, <italic>ID</italic>) → <italic>SK</italic><sub><italic>ID</italic></sub>: Input the <italic>IBE</italic> system public parameters, master key <italic>MSK</italic><sub><italic>IBE</italic></sub> and user <italic>ID</italic> ∈ (0, 1)<sup>∗</sup>, and output the public-private key pair corresponding to the <italic>ID</italic>.
<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi mathvariant="italic">ID</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">ID</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi mathvariant="italic">ID</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">ID</mml:mi></mml:mfenced><mml:mi>α</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{c}P{K}_{ID}={H}_1(ID)\\ {}S{K}_{ID}={g}_1{H}_1{(ID)}^{\alpha}\end{array}\right. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ3.gif"/></alternatives></disp-formula></p><p id="Par66"><italic>KGen</italic><sub><italic>CP</italic></sub>(<italic>GP</italic>, <italic>MSK</italic>, <italic>S</italic>) → <italic>SK</italic><sub><italic>S</italic></sub>: Input the system public parameters <italic>GP</italic>, master key <italic>MSK</italic> and DER attribute set <italic>S</italic> = {<italic>a</italic><sub>1</sub>, …, <italic>a</italic><sub>|<italic>S</italic>|</sub>} ⊆ <italic>U</italic>, |<italic>S</italic>| means the base of <italic>S</italic>. Randomly choose <inline-formula id="IEq17"><alternatives><mml:math display="inline" id="IEq17_Math"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ t\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq17.gif"/></alternatives></inline-formula>, then calculate
<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {K}_0={g}^{\alpha }{g}_1^t,{K}_1={g}^t,{K}_{i,2}={H}_1\left({a}_i\right){g}_2^{-t} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ4.gif"/></alternatives></disp-formula></p><p id="Par67">The verification organization outputs the key of the attribute set <italic>S</italic> as
<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,"><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="}" open="{"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi>S</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SK}_S=\left({K}_0,{K}_1,{\left\{{K}_{i,2}\right\}}_{i=1}^{\left|S\right|}\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ5.gif"/></alternatives></disp-formula></p></sec><sec id="Sec21"><title>Step3: Data encryption</title><p id="Par68"><italic>Enc</italic><sub><italic>CP</italic></sub>(<italic>GP</italic>, (<italic>A</italic>, <italic>ρ</italic>), <italic>M</italic>) → <italic>CT</italic><sub><italic>A</italic></sub>: Input system public parameters <italic>GP</italic>, access structure (<italic>A</italic>, <italic>ρ</italic>) (<italic>A</italic> is a <italic>l</italic> × <italic>n</italic> matrix, and the function <italic>ρ</italic> : [<italic>l</italic>] maps each row of the matrix <italic>A</italic> to an attribute) and plaintext information <italic>M</italic> ∈ <italic>G</italic><sub><italic>T</italic></sub>. Choose a random element <inline-formula id="IEq18"><alternatives><mml:math display="inline" id="IEq18_Math"><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq18.gif"/></alternatives></inline-formula> and form a vector <inline-formula id="IEq19"><alternatives><mml:math display="inline" id="IEq19_Math"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="true">⇀</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,"><mml:mi>s</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overset{\rightharpoonup }{v}=\left(s,{y}_2,\dots {y}_n\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq19.gif"/></alternatives></inline-formula>. <italic>y</italic><sub>2</sub>, …<italic>y</italic><sub><italic>n</italic></sub> is also randomly selected from <inline-formula id="IEq20"><alternatives><mml:math display="inline" id="IEq20_Math"><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq20.gif"/></alternatives></inline-formula>. For the <italic>i-th</italic> row <italic>A</italic><sub><italic>i</italic></sub> of <italic>A</italic>, we have <inline-formula id="IEq21"><alternatives><mml:math display="inline" id="IEq21_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="true">⇀</mml:mo></mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=",,,"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mi>l</mml:mi></mml:mfenced></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_i=\overset{\rightharpoonup }{v}{A}_i\left(i=1,2,\dots, l\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq21.gif"/></alternatives></inline-formula>. Randomly select<italic>l</italic>parameters <inline-formula id="IEq22"><alternatives><mml:math display="inline" id="IEq22_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}_1,{t}_2,\dots, {t}_l\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq22.gif"/></alternatives></inline-formula>, and calculate the following formula.
<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mfenced open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Me</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mi mathvariant="italic">αs</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{l}W= Me{\left(g,g\right)}^{\alpha s},{W}_0={g}^s,\\ {}{W}_{i,1}={g}_1^{\lambda_i}{g}_2^{t_i},{W}_{i,2}={H}_1{\left(\rho (i)\right)}^{-{t}_i},{W}_{i,3}={g}^{t_i}\end{array}\right. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ6.gif"/></alternatives></disp-formula></p><p id="Par69">CP-HAPRE provides two encryption options for DER: When DER only wants to share data with DER agents and does not want to re-encrypt the data, then the output ciphertext is
<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mi>C</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,"><mml:mi>W</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="}" open="{" separators=",,"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:mfenced></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C{T}_A=\left(W,{W}_0,{\left\{{W}_{i,1},{W}_{i,2},{W}_{i,3}\right\}}_{i=1}^l\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ7.gif"/></alternatives></disp-formula></p><p id="Par70">When DER needs to re-encrypt the data, it must calculate <inline-formula id="IEq23"><alternatives><mml:math display="inline" id="IEq23_Math"><mml:msub><mml:mi>W</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_4={g}_3^s $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq23.gif"/></alternatives></inline-formula>, and the final output ciphertext is
<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mi>C</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:mi>W</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="}" open="{" separators=",,"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mfenced></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C{T}_A=\left(W,{W}_0,{\left\{{W}_{i,1},{W}_{i,2},{W}_{i,3}\right\}}_{i=1}^l,{W}_4\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ8.gif"/></alternatives></disp-formula></p><p id="Par71">Since only the ciphertext referred to in Eq. <xref rid="Equ8" ref-type="disp-formula">8</xref> supports re-encryption, we will focus on the ciphertext.</p></sec><sec id="Sec22"><title>Step4: Re-encryption key generation</title><p id="Par72"><inline-formula id="IEq24"><alternatives><mml:math display="inline" id="IEq24_Math"><mml:mtext mathvariant="italic">RKGen</mml:mtext><mml:mfenced close=")" open="(" separators=",,"><mml:mi mathvariant="italic">GP</mml:mi><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ RKGen\left( GP,{SK}_S,{PK}_{ID_{VPP}}\right)\to {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq24.gif"/></alternatives></inline-formula>: The algorithm inputs the system public parameters <italic>GP</italic>, the <italic>CP</italic> key <italic>SK</italic><sub><italic>S</italic></sub> of DER and the public key <inline-formula id="IEq25"><alternatives><mml:math display="inline" id="IEq25_Math"><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {PK}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq25.gif"/></alternatives></inline-formula> of VPP. DER agent randomly selects elements <inline-formula id="IEq26"><alternatives><mml:math display="inline" id="IEq26_Math"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}^{\hbox{'}},{s}^{\hbox{'}}\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq26.gif"/></alternatives></inline-formula> and calculates
<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mfenced open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{l}R{K}_0={K}_0{g}_3^{t^{\prime }},R{K}_1={K}_1,{\left\{R{K}_{i,2}={K}_{i,2}\right\}}_{i=1}^l\\ {}R{K}_3={H}_2\left(e{\left(g,g\right)}^{\alpha {s}^{\prime }}\right){g}^{t^{\prime }},R{K}_4=P{K}_{I{D}_{VPP}}^{s^{\prime }},R{K}_5={g}^{s^{\prime }}\end{array}\right. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ9.gif"/></alternatives></disp-formula></p><p id="Par73">Finally, the complete re-encryption key is shown in Eq. 10
<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,,"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mfenced></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}}=\left({RK}_0,{RK}_1,\left\{{RK}_{i,2}\right\},{RK}_3,{RK}_4,{RK}_5\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ10.gif"/></alternatives></disp-formula></p></sec><sec id="Sec23"><title>Step5: Re-encryption</title><p id="Par74"><inline-formula id="IEq27"><alternatives><mml:math display="inline" id="IEq27_Math"><mml:mtext mathvariant="italic">ReEnc</mml:mtext><mml:mfenced close=")" open="(" separators=",,"><mml:mi mathvariant="italic">GP</mml:mi><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mfenced><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ ReEnc\left( GP,{RK}_{S\to {ID}_{VPP}},{CT}_A\right)\to {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq27.gif"/></alternatives></inline-formula>: Input the system public parameters <italic>GP</italic>, re-encryption key <inline-formula id="IEq28"><alternatives><mml:math display="inline" id="IEq28_Math"><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RK}_{S\to {ID}_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq28.gif"/></alternatives></inline-formula>and ciphertext <italic>CT</italic><sub><italic>A</italic></sub>. If the attribute set <italic>S</italic> satisfies the access structure (<italic>A</italic>, <italic>ρ</italic>), let <italic>I</italic> = {<italic>i</italic> : <italic>ρ</italic>(<italic>i</italic>) ∈ <italic>S</italic>}, then there is a coefficient <inline-formula id="IEq29"><alternatives><mml:math display="inline" id="IEq29_Math"><mml:msub><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left\{{\omega}_i\in {Z}_p^{\ast}\right\}}_{i\in I} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq29.gif"/></alternatives></inline-formula>, so that ∑<sub><italic>i</italic> ∈ <italic>I</italic></sub><italic>ω</italic><sub><italic>i</italic></sub><italic>A</italic><sub><italic>i</italic></sub> = (1, 0, …, 0). Then, the DER agent calculates
<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ V=\frac{e\left({W}_0,R{K}_0\right)}{\prod_{i\in I}{\left(e\left({W}_{i,1},R{K}_1\right)e\left({W}_{i,2},g\right)e\left({W}_{i,3},R{K}_{j,2}\right)\right)}^{\omega_i}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ11.gif"/></alternatives></disp-formula></p><p id="Par75">where <italic>j</italic> is the index of attribute <italic>ρ</italic>(<italic>i</italic>) in <italic>S</italic>. After finding <italic>V</italic>, the DER agent re-encrypts the ciphertext
<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>/</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">RK</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}^{\prime }=W/V,{W}_0^{\prime }={RK}_3,{W}_1^{\prime }={RK}_4,{W}_2^{\prime }={RK}_5,{W}_3^{\prime }={W}_4 $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par76">The final re-encrypted ciphertext output by the DER agent is
<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}}=\left({W}^{\prime },{W}_0^{\prime },{W}_1^{\prime },{W}_2^{\prime },{W}_3^{\prime}\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ13.gif"/></alternatives></disp-formula></p></sec><sec id="Sec24"><title>Step6: Digital signature</title><p id="Par77"><inline-formula id="IEq30"><alternatives><mml:math display="inline" id="IEq30_Math"><mml:mi mathvariant="italic">Sig</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:mi mathvariant="italic">GP</mml:mi><mml:msup><mml:mi>W</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:msub></mml:mfenced><mml:mo>→</mml:mo><mml:mi>σ</mml:mi></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Sig\left( GP,{W}^{\hbox{'}},{SK}_{ID_{proxy}}\right)\to \sigma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq30.gif"/></alternatives></inline-formula>: Input the system public parameters <italic>GP</italic>, part of the re-encrypted ciphertext <italic>W</italic><sup>'</sup> and the private key <inline-formula id="IEq31"><alternatives><mml:math display="inline" id="IEq31_Math"><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SK}_{ID_{proxy}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq31.gif"/></alternatives></inline-formula> of the DER agent. DER agent randomly selects two random numbers <inline-formula id="IEq32"><alternatives><mml:math display="inline" id="IEq32_Math"><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_1,{k}_2\in {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq32.gif"/></alternatives></inline-formula>, and then calculates
<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>q</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{c}{P}_1={g}_1^{k_1},{P}_2={g}_1^{k_2}\\ {}q=e\left({P}_1,{P}_2\right),H={H}_3\left({W}^{\prime },q\right)\\ {}U=S{K}_{I{D}_{proxy}}^H{P}_1^{k_2}\end{array}\right. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ14.gif"/></alternatives></disp-formula></p><p id="Par78">The final digital signature output by the DER agent is <italic>σ</italic> = (<italic>U</italic>, <italic>q</italic>).</p></sec><sec id="Sec25"><title>Step7: Ciphertext decryption</title><p id="Par79"><italic>Dec</italic>(<italic>GP</italic>, <italic>CT</italic><sub><italic>A</italic></sub>, <italic>SK</italic><sub><italic>S</italic></sub>) → <italic>M</italic>: Input the system public parameters <italic>GP</italic>, ciphertext <italic>CT</italic><sub><italic>A</italic></sub> and DER <italic>CP</italic> key <italic>SK</italic><sub><italic>S</italic></sub>. If the attribute set <italic>S</italic> satisfies the access structure (<italic>A</italic>, <italic>ρ</italic>), for <italic>I</italic> = {<italic>i</italic> : <italic>ρ</italic>(<italic>i</italic>) ∈ <italic>S</italic>}, there is a coefficient <inline-formula id="IEq33"><alternatives><mml:math display="inline" id="IEq33_Math"><mml:msub><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left\{{\omega}_i\in {Z}_p^{\ast}\right\}}_{i\in I} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq33.gif"/></alternatives></inline-formula>, such that ∑<sub><italic>i</italic> ∈ <italic>I</italic></sub><italic>ω</italic><sub><italic>i</italic></sub><italic>A</italic><sub><italic>i</italic></sub> = (1, 0, …, 0). Decryption algorithm calculation
<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:msup><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}^{\prime }=\frac{e\left({W}_0,{K}_0\right)}{\prod_{i\in I}{\left(e\left({W}_{i,1},{K}_1\right)e\left({W}_{i,2},g\right)e\left({W}_{i,3},{K}_{j,3}\right)\right)}^{\omega_i}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ15.gif"/></alternatives></disp-formula></p><p id="Par80">where <italic>j</italic> is the index of attribute <italic>ρ</italic>(<italic>i</italic>) in <italic>S</italic>. The plaintext information is <italic>M</italic> = <italic>W</italic>/<italic>M</italic><sup>'</sup>.</p></sec><sec id="Sec26"><title>Step8: Re-encrypted ciphertext decryption</title><p id="Par81"><inline-formula id="IEq34"><alternatives><mml:math display="inline" id="IEq34_Math"><mml:mtext mathvariant="italic">ReDec</mml:mtext><mml:mfenced close=")" open="(" separators=",,,,,"><mml:mi mathvariant="italic">GP</mml:mi><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:msub><mml:mi>σ</mml:mi></mml:mfenced><mml:mo>→</mml:mo><mml:mi>M</mml:mi></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ ReDec\left( GP,{CT}_{ID_{VPP}},{SK}_{ID_{VPP}},{PK}_{IBE},{PK}_{ID_{proxy}},\sigma \right)\to M $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq34.gif"/></alternatives></inline-formula>: Input system public parameters <italic>GP</italic>, re-encrypted ciphertext <inline-formula id="IEq35"><alternatives><mml:math display="inline" id="IEq35_Math"><mml:msub><mml:mi mathvariant="italic">CT</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {CT}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq35.gif"/></alternatives></inline-formula>, VPP <italic>IBE</italic> private key <inline-formula id="IEq36"><alternatives><mml:math display="inline" id="IEq36_Math"><mml:msub><mml:mi mathvariant="italic">SK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SK}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq36.gif"/></alternatives></inline-formula>, system <italic>IBE</italic> public key <italic>PK</italic><sub><italic>IBE</italic></sub>, DER agent’s <italic>IBE</italic> public key <inline-formula id="IEq37"><alternatives><mml:math display="inline" id="IEq37_Math"><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {PK}_{ID_{proxy}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq37.gif"/></alternatives></inline-formula> and re-encrypted ciphertext signature <italic>σ</italic>. First, VPP needs to calculate <italic>H</italic> = <italic>H</italic><sub>3</sub>(<italic>W</italic><sup>′</sup>, <italic>q</italic>), then verify if <inline-formula id="IEq38"><alternatives><mml:math display="inline" id="IEq38_Math"><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>U</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">qe</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ e\left(U,{g}_1\right)= qe\left({PK}_{IBE}{PK}_{ID_{proxy}}^H,{g}_1\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq38.gif"/></alternatives></inline-formula> is established. if it is not established, resend the data access request to the DER agent, if it is established, calculate
<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi mathvariant="italic">gS</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{e\left( gS{K}_{I{D}_{VPP}},{W}_2^{\prime}\right)}{e\left(g,{W}_1^{\prime}\right)e\left({g}_1,{W}^{\prime}\right)}=e{\left(g,g\right)}^{\alpha {s}^{\prime }} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ16.gif"/></alternatives></disp-formula></p><p id="Par82">and
<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_0^{\prime }/{H}_2\left(e{\left(g,g\right)}^{\alpha {s}^{\prime }}\right)={g}^{t^{\prime }} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ17.gif"/></alternatives></disp-formula></p><p id="Par83">Finally, VPP recovers the plaintext information <inline-formula id="IEq39"><alternatives><mml:math display="inline" id="IEq39_Math"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ M={W}^{\prime }e\left({g}^{t^{\prime }},{W}_3^{\prime}\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq39.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec27"><title>Correctness verification</title><p id="Par84">We first prove the correctness of the initial ciphertext decryption. When the ciphertext is <italic>CT</italic><sub><italic>A</italic></sub> and the key is <italic>SK</italic><sub><italic>S</italic></sub>, if the attribute set <italic>S</italic> satisfies the access structure (<italic>A</italic>, <italic>ρ</italic>), ∑<sub><italic>i</italic> ∈ <italic>I</italic></sub><italic>ω</italic><sub><italic>i</italic></sub><italic>λ</italic><sub><italic>i</italic></sub> = <italic>s</italic> can be obtained, therefore
<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msup><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi mathvariant="italic">ts</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{cc}{M}^{\prime }&amp; =\frac{e\left({W}_0,{K}_0\right)}{\prod_{i\in I}{\left(e\left({W}_{i,1},{K}_1\right)e\left({W}_{i,2},g\right)e\left({W}_{i,3},{K}_{j,2}\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha }{g}_1^t\right)}{\prod_{i\in I}{\left(e\left({g}_1^{\lambda_i}{g}_2^{t_i},{g}^t\right)e\left({H}_1{\left(\rho (i)\right)}^{-{t}_i},g\right)e\left({g}^{t_i},{H}_1\left(\rho (i)\right){g}_2^{-t}\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)}{\prod_{i\in I}{\left(e\left({g}_1^{\lambda_i},{g}^t\right)e\left({g}^{t_i},{g}_2^t\right)e\left({H}_1{\left(\rho (i)\right)}^{-{t}_i},g\right)\right)}^{\omega_i}}\cdot \\ {}&amp; \frac{1}{\prod_{i\in I}{\left(e\left({g}_2^{t_i},{g}^{-t}\right)e\left({g}^{t_i},{H}_1\left(\rho (i)\right)\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)}{e{\left({g}_1,g\right)}^{t{\sum}_{i\in I}{\omega}_i{\lambda}_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)}{e{\left({g}_1,g\right)}^{ts}}\\ {}&amp; =e\left({g}^s,{g}^{\alpha}\right)\end{array}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ18.gif"/></alternatives></disp-formula></p><p id="Par85">Then, DER can get the plaintext message by calculating <italic>M</italic> = <italic>W</italic>/<italic>M</italic><sup>′</sup> = <italic>Me</italic>(<italic>g</italic><sup><italic>s</italic></sup>, <italic>g</italic><sup><italic>α</italic></sup>)/<italic>e</italic>(<italic>g</italic><sup><italic>s</italic></sup>, <italic>g</italic><sup><italic>α</italic></sup>) = <italic>M</italic>.</p><p id="Par86">Next, we prove the correctness of the decryption of the re-encrypted ciphertext. If the attribute set satisfies the access structure, the DER agent can calculate
<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mi>V</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>g</mml:mi></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ω</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>g</mml:mi></mml:mfenced><mml:mi mathvariant="italic">ts</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{cc}V&amp; =\frac{e\left({W}_0,R{K}_0\right)}{\prod_{i\in I}{\left(e\left({W}_{i,1},R{K}_1\right)e\left({W}_{i,2},g\right)e\left({W}_{i,3},R{K}_{j,2}\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha }{g}_1^t{g}_3^{t^{\prime }}\right)}{\prod_{i\in I}{\left(e\left({g}_1^{\lambda_i}{g}_2^{t_i},{g}^t\right)e\left({H}_1{\left(\rho (i)\right)}^{-{t}_i},g\right)e\left({g}^{t_i},{H}_1\left(\rho (i)\right){g}_2^{-t}\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)e\left({g}^s,{g}_3^{t^{\prime }}\right)}{\prod_{i\in I}{\left(e\left({g}_1^{\lambda_i},{g}^t\right)e\left({g}_2^{t_i},{g}^t\right)e\left({H}_1{\left(\rho (i)\right)}^{-{t}_i},g\right)\right)}^{\omega_i}}\cdot \\ {}&amp; \frac{1}{\prod_{i\in I}{\left(e\left({g}^{t_i},{g}_2^{-t}\right)e\left({g}^{t_i},{H}_1\left(\rho (i)\right)\right)\right)}^{\omega_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)e\left({g}^s,{g}_3^{t^{\prime }}\right)}{e{\left({g}_1,g\right)}^{t{\sum}_{i\in I}{\omega}_i{\lambda}_i}}\\ {}&amp; =\frac{e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_1^t\right)e\left({g}^s,{g}_3^{t^{\prime }}\right)}{e{\left({g}_1,g\right)}^{ts}}\\ {}&amp; =e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_3^{t^{\prime }}\right)\end{array}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ19.gif"/></alternatives></disp-formula></p><p id="Par87">Then, the DER agent continues to calculate
<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>/</mml:mo><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Me</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mo>/</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msubsup><mml:mi>g</mml:mi><mml:mn>3</mml:mn><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{cc}{W}^{\prime }&amp; =W/V= Me\left({g}^s,{g}^{\alpha}\right)/e\left({g}^s,{g}^{\alpha}\right)e\left({g}^s,{g}_3^{t^{\prime }}\right)\\ {}&amp; =M/e\left({g}^s,{g}_3^{t^{\prime }}\right)\end{array}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ20.gif"/></alternatives></disp-formula></p><p id="Par88">In the re-decryption algorithm, VPP first needs to be verified
<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>U</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mfenced><mml:mi mathvariant="italic">αH</mml:mi></mml:msup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mfenced><mml:mi>H</mml:mi></mml:msup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi mathvariant="italic">qe</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi mathvariant="italic">IBE</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mtext mathvariant="italic">proxy</mml:mtext></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{cc}e\left(U,{g}_1\right)&amp; =e\left(S{K}_{I{D}_{proxy}}^H{P}_1^{k_2},{g}_1\right)\\ {}&amp; =e\left(S{K}_{I{D}_{proxy}}^H,{g}_1\right)e\left({P}_1^{k_2},{g}_1\right)\\ {}&amp; =e\left({g}_1{H}_1{\left({ID}_{proxy}\right)}^{\alpha H},{g}_1\right)e\left({P}_1,{g}_1^{k_2}\right)\\ {}&amp; =e\left({g}_1^{\alpha }{H}_1{\left({ID}_{proxy}\right)}^H,{g}_1\right)e\left({P}_1,{P}_2\right)\\ {}&amp; = qe\left(P{K}_{IBE}P{K}_{I{D}_{proxy}}^H,{g}_1\right)\end{array}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ21.gif"/></alternatives></disp-formula></p><p id="Par89">Then, calculate
<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi mathvariant="italic">gS</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>α</mml:mi></mml:msup></mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mfenced></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{cc}\frac{e\left( gS{K}_{I{D}_{VPP}},{W}_2^{\prime}\right)}{e\left(g,{W}_1^{\prime}\right)e\left({g}_1,{W}_2^{\prime}\right)}&amp; =\frac{e\left(g{g}_1{H}_1{\left(I{D}_{VPP}\right)}^{\alpha },{g}^{s^{\prime }}\right)}{e\left(g,{H}_1{\left(I{D}_{VPP}\right)}^{s^{\prime }}\right)}\\ {}&amp; =e{\left(g,g\right)}^{\alpha {s}^{\prime }}\end{array}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ22.gif"/></alternatives></disp-formula></p><p id="Par90">and
<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mo>'</mml:mo></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=","><mml:mi>g</mml:mi><mml:mi>g</mml:mi></mml:mfenced><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_0^{\hbox{'}}/{H}_2\left(e{\left(g,g\right)}^{\alpha {s}^{\prime }}\right)={H}_2\left(e{\left(g,g\right)}^{\alpha {s}^{\prime }}\right){g}^{t^{\prime }}/{H}_2\left(e{\left(g,g\right)}^{\alpha {s}^{\prime }}\right)={g}^{t^{\prime }} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ23.gif"/></alternatives></disp-formula></p><p id="Par91">Finally, VPP can get the plaintext information that it wants to access by calculating <inline-formula id="IEq40"><alternatives><mml:math display="inline" id="IEq40_Math"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>g</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:msubsup><mml:mi>W</mml:mi><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mfenced></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ M={W}^{\prime }e\left({g}^{t^{\prime }},{W}_3^{\prime}\right) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq40.gif"/></alternatives></inline-formula>.</p></sec></sec><sec id="Sec28"><title>Reputation-based continuous double auction mechanism</title><p id="Par92">CDA is an effective market mechanism to solve the problem of distributed resource allocation. Distributed resource allocation usually involves multiple participants, and each participant wants to maximize his own revenue. CDA improves the overall efficiency by constantly matching the quotations of transaction participants. According to the identity of the participant who submitted the quotation, CDA stores the received quotations in the Bid List (BL) of the buyer and the Offer List (OL) of the seller, respectively. In BL, the sorting rule is price from high to low (descending order); on the contrary, the sorting rule in OL is sorting from low to high price (ascending order). The buyer’s highest quotation is called the optimal buying price, and the seller’s lowest quotation is called the optimal selling price. Only when the optimal buying price is greater than or equal to the optimal selling price, the buyer and seller can match successfully. To maximize the interests of each participant, the transaction price is the average of the optimal buying price and the optimal selling price. It should be noted that CDA is matched according to the matching rule of “price first, time first”. When the price is the same, it will be matched with the participant who submitted the quotation earlier.</p><p id="Par93">Reputation-based trading system can ensure that participants have good market behavior, which is composed of market segmentation mechanism and priority-value-order mechanism [<xref ref-type="bibr" rid="CR41">41</xref>]. The market segmentation mechanism divides the corresponding list according to the reputation level. Its purpose is to enable the buyer or seller with high reputation values to obtain more and better quotations. The detailed market segmentation mechanism is shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Priority-value-order mechanism is a sort method based on user reputation and quotation. The reputation-based CDA mechanism proposed in this paper mainly integrates the reputation-based market segmentation machine into the CDA mechanism. The sorting mechanism still uses the original CDA sorting mechanism instead of the reputation-based priority-value-order mechanism.
<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Market segmentation machine based on reputation</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Buyer/Seller reputation values</p></th><th><p>Level</p></th><th><p>Matchable level range</p></th></tr></thead><tbody><tr><td><p>[0,2]</p></td><td><p>1</p></td><td><p>3</p></td></tr><tr><td><p>(2,4]</p></td><td><p>2</p></td><td><p>3, 2</p></td></tr><tr><td><p>(4,6]</p></td><td><p>3</p></td><td><p>3, 2, 1</p></td></tr></tbody></table></table-wrap></p><p id="Par94">The reputation-based CDA mechanism includes three entities: buyers, sellers and auctioneers. In this paper, <italic>PU</italic> such as houses and factories represent buyers, <italic>GU</italic> such as photovoltaic power plants and hydroelectric power plants represent sellers, and CVPP assumes the responsibility of auctioneer. At the beginning of the trading cycle, <italic>PU</italic> and <italic>GU</italic> submit the initial <inline-formula id="IEq41"><alternatives><mml:math display="inline" id="IEq41_Math"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {B}_{i,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq41.gif"/></alternatives></inline-formula> and <inline-formula id="IEq42"><alternatives><mml:math display="inline" id="IEq42_Math"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_{j,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq42.gif"/></alternatives></inline-formula> to CVPP, respectively. <inline-formula id="IEq43"><alternatives><mml:math display="inline" id="IEq43_Math"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {B}_{i,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq43.gif"/></alternatives></inline-formula> represents the transaction information submitted by <italic>PU</italic><sub><italic>i</italic></sub> for the first time in the <italic>k-th</italic> transaction cycle. Similarly, <inline-formula id="IEq44"><alternatives><mml:math display="inline" id="IEq44_Math"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_{j,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq44.gif"/></alternatives></inline-formula> means that the transaction information submitted by <italic>GU</italic><sub><italic>j</italic></sub> for the first time in the <italic>k-th</italic> transaction cycle. The concrete content of the two is as follows:
<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Si</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Si</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mspace width="0.5em"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{c}{B}_{i,k}^1=\left({E}_{i,d}^1,{P}_{i,b}^1,R{S}_i^k, Si{g}_i^1\right)\\ {}{S}_{j,k}^1=\left({E}_{j,s}^1,{P}_{j,o}^1,R{S}_j^k, Si{g}_j^1\right)\end{array}\right.\kern0.5em i,j,k=1,2,\cdots, n $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ24.gif"/></alternatives></disp-formula></p><p id="Par95">In the formula, <inline-formula id="IEq45"><alternatives><mml:math display="inline" id="IEq45_Math"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{i,d}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><mml:math display="inline" id="IEq46_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{i,b}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq46.gif"/></alternatives></inline-formula> represent the power demand and bid price of <italic>PU</italic><sub><italic>i</italic></sub> in the first round of trading, <inline-formula id="IEq47"><alternatives><mml:math display="inline" id="IEq47_Math"><mml:msubsup><mml:mi mathvariant="italic">RS</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RS}_i^k $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><mml:math display="inline" id="IEq48_Math"><mml:msubsup><mml:mi mathvariant="italic">Sig</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Sig}_i^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq48.gif"/></alternatives></inline-formula> represent the reputation value of <italic>PU</italic><sub><italic>i</italic></sub> in the <italic>k-th</italic> trading cycle and the signature of the submitted information. <inline-formula id="IEq49"><alternatives><mml:math display="inline" id="IEq49_Math"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{j,s}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><mml:math display="inline" id="IEq50_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{j,o}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq50.gif"/></alternatives></inline-formula> represent the power supply and the quoted price of <italic>GU</italic><sub><italic>j</italic></sub> in the first round of trading. The definitions of <inline-formula id="IEq51"><alternatives><mml:math display="inline" id="IEq51_Math"><mml:msubsup><mml:mi mathvariant="italic">RS</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {RS}_j^k $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><mml:math display="inline" id="IEq52_Math"><mml:msubsup><mml:mi mathvariant="italic">Sig</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Sig}_j^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq52.gif"/></alternatives></inline-formula> are similar to the above.</p><p id="Par96">After receiving <inline-formula id="IEq53"><alternatives><mml:math display="inline" id="IEq53_Math"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {B}_{i,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><mml:math display="inline" id="IEq54_Math"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_{j,k}^1 $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq54.gif"/></alternatives></inline-formula> submitted by <italic>PU</italic><sub><italic>i</italic></sub> and<italic>GU</italic><sub><italic>j</italic></sub>, the CVPP matches the buyer and the seller according to the reputation-based CDA mechanism. First, CVPP constructs a matching list by checking the identity and reputation value of the information submitter. Different from the traditional CDA mechanism, a reputation-based market segmentation mechanism is introduced here. According to this mechanism, we further divide BL and OL. The specific division is shown in Eq. <xref rid="Equ25" ref-type="disp-formula">25</xref><disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mfenced open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>3</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:msubsup><mml:mi>L</mml:mi><mml:mn>3</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd><mml:mtd><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{l}B{L}_1^t=\left\{R{L}_i=1\right\}\\ {}B{L}_2^t=\left\{R{L}_i=2\right\}\\ {}B{L}_3^t=\left\{R{L}_i=3\right\}\\ {}O{L}_1^t=\left\{R{L}_j=3\right\}\\ {}O{L}_2^t=\left\{R{L}_j=3,R{L}_j=2\right\}\\ {}O{L}_3^t=\left\{R{L}_j=3,R{L}_j=2,R{L}_j=1\right\}\end{array}\right.\kern0.5em t,i,j=1,2,\cdots, n $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ25.gif"/></alternatives></disp-formula></p><p id="Par97">It can be seen that both BL and OL are divided into three lists, where <italic>t</italic> represents the number of rounds of the transaction, <italic>RL</italic><sub><italic>i</italic></sub> represents the reputation level of <italic>PU</italic><sub><italic>i</italic></sub>, and the relationship between <italic>RL</italic> and <italic>RS</italic> is shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Only part of the symbol definitions are explained here, other symbol definitions are similar to the explained symbols. <inline-formula id="IEq55"><alternatives><mml:math display="inline" id="IEq55_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi mathvariant="italic">RL</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_1^t=\left\{{RL}_i=1\right\} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq55.gif"/></alternatives></inline-formula> means that <inline-formula id="IEq56"><alternatives><mml:math display="inline" id="IEq56_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_1^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq56.gif"/></alternatives></inline-formula> only contains <italic>PU</italic> with <italic>RL</italic> = 1. <inline-formula id="IEq57"><alternatives><mml:math display="inline" id="IEq57_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi mathvariant="italic">RL</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_1^t=\left\{{RL}_j=3\right\} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq57.gif"/></alternatives></inline-formula> means that <inline-formula id="IEq58"><alternatives><mml:math display="inline" id="IEq58_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_1^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq58.gif"/></alternatives></inline-formula> only contains <italic>GU</italic> with <italic>RL</italic> = 3. After the construction of the matching list, the CVPP performs matching between lists according to Table <xref rid="Tab2" ref-type="table">2</xref>, that is, <inline-formula id="IEq59"><alternatives><mml:math display="inline" id="IEq59_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_l^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq59.gif"/></alternatives></inline-formula> matches for <inline-formula id="IEq60"><alternatives><mml:math display="inline" id="IEq60_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_l^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq60.gif"/></alternatives></inline-formula> transaction matching (<italic>l</italic> = 1, 2, 3).</p><p id="Par98">At the beginning of the trading cycle, both <italic>PU</italic> and <italic>GU</italic> want to obtain more benefits, so the initial purchase price of <italic>PU</italic> will be the lowest, and the initial sale price of will be the <italic>GU</italic> highest. In this case, the number of successful trade matches in the first round will be relatively small. For more matches in subsequent transactions, after each round of transactions, CVPP needs to do two things. The first thing is to match the successfully matched <italic>PU</italic><sub><italic>i</italic></sub> and <italic>GU</italic><sub><italic>j</italic></sub> for transaction, and upload the transaction information <italic>Tx</italic><sub><italic>ij</italic></sub> to the blockchain, <italic>Tx</italic><sub><italic>ij</italic></sub> is as follow
<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:msub><mml:mi mathvariant="italic">Tx</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,,,,"><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="italic">RS</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="italic">RS</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">Sig</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">Sig</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Tx}_{ij}=\left({ID}_i,{ID}_j,{RS}_i^k,{RS}_j^k,{E}_{ij},{P}_{ij},{Sig}_i,{Sig}_j\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ26.gif"/></alternatives></disp-formula></p><p id="Par99"><italic>ID</italic><sub><italic>i</italic></sub> represents the identity of <italic>PU</italic><sub><italic>i</italic></sub>, <italic>E</italic><sub><italic>ij</italic></sub> represents the capacity of electricity traded between <italic>PU</italic><sub><italic>i</italic></sub> and the <italic>GU</italic><sub><italic>j</italic></sub>, and <italic>P</italic><sub><italic>ij</italic></sub> represents the trading amount between the two.</p><p id="Par100">The second thing is to calculate the competitive equilibrium price <italic>E</italic><sub><italic>p</italic></sub> and announce it to the unmatched transaction parties. The calculation method of <italic>E</italic><sub><italic>p</italic></sub> is as follows
<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_p=\sum \limits_{s=A,A+1,\dots, B}^{B-A}\left({\omega}_s{p}_s\right) $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ27.gif"/></alternatives></disp-formula></p><p id="Par101"><italic>A</italic> represents the estimated starting transaction number, <italic>B</italic> represents the ending transaction number, <italic>s</italic> represents an increasing integer from <italic>A</italic> to <italic>B</italic>, <italic>p</italic><sub><italic>s</italic></sub> represents the transaction price of the <italic>s-th</italic> transaction, and <italic>ω</italic><sub><italic>s</italic></sub> represents the weight of the transaction price. The sum of <italic>ω</italic><sub><italic>s</italic></sub> in the estimation range [<italic>A</italic>, <italic>B</italic>] is 1, and <italic>ω</italic><sub><italic>s</italic> + 1</sub> = <italic>βω</italic><sub><italic>s</italic></sub>, <italic>β</italic> represents the weight coefficient.</p><p id="Par102">Before the start of the next round of trading, <italic>PU</italic> and <italic>GU</italic> which have not yet been matched will recalculate their quotations <inline-formula id="IEq61"><alternatives><mml:math display="inline" id="IEq61_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{i,b}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><mml:math display="inline" id="IEq62_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{j,o}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq62.gif"/></alternatives></inline-formula> according to <italic>E</italic><sub><italic>p</italic></sub>, respective. The calculation formula is as follows
<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{c}{P}_{i,b}^t=\left\{\begin{array}{c}{P}_{i,b}^1,t=1\\ {}{P}_{i,b}^{t-1}+\eta \left|{E}_p-{P}_{i,b}^{t-1}\right|,t\ge 2\end{array}\right.\\ {}{P}_{j,o}^t=\left\{\begin{array}{c}{P}_{j,o}^1,t=1\\ {}{P}_{j,o}^{t-1}-\eta \left|{E}_p-{P}_{j,o}^{t-1}\right|,t\ge 2\end{array}\right.\end{array}\right. $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ28.gif"/></alternatives></disp-formula></p><p id="Par103">The value range of <italic>η</italic> is [0, 1]. From the above formula, it is not difficult to see that the constraint condition of <inline-formula id="IEq63"><alternatives><mml:math display="inline" id="IEq63_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{i,b}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq63.gif"/></alternatives></inline-formula> is <inline-formula id="IEq64"><alternatives><mml:math display="inline" id="IEq64_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:mo>⋯</mml:mo><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{i,b}^1\le {P}_{i,b}^2\le \cdots \le {P}_{i,b}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq64.gif"/></alternatives></inline-formula>, and the constraint condition of <inline-formula id="IEq65"><alternatives><mml:math display="inline" id="IEq65_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{j,o}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq65.gif"/></alternatives></inline-formula> is <inline-formula id="IEq66"><alternatives><mml:math display="inline" id="IEq66_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≥</mml:mo><mml:mo>⋯</mml:mo><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{j,o}^1\ge {P}_{j,o}^2\ge \cdots \ge {P}_{j,o}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq66.gif"/></alternatives></inline-formula>. In addition, <inline-formula id="IEq67"><alternatives><mml:math display="inline" id="IEq67_Math"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {P}_{j,o}^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq67.gif"/></alternatives></inline-formula> should be greater than the power generation cost of <italic>GU</italic><sub><italic>j</italic></sub>.</p><p id="Par104">After calculating the bid price of the next round of transaction, both parties submit the transaction information of the new round as follows
<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mfenced open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Si</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Si</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd><mml:mtd><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\begin{array}{l}{B}_{i,k}^t=\left({E}_{i,d}^t,{P}_{i,b}^t,R{S}_i^k, Si{g}_i^t\right)\\ {}{S}_{j,k}^t=\left({E}_{j,s}^t,{P}_{j,o}^t,R{S}_j^k, Si{g}_j^t\right)\end{array}\right.\kern0.5em t\ge 2;i,j,k=1,2,\dots, n $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_Equ29.gif"/></alternatives></disp-formula></p><p id="Par105">CVPP receives the transaction information and looks at the current total matching time <italic>T</italic><sub><italic>M</italic></sub> of each round of transactions. If <italic>T</italic><sub><italic>M</italic></sub> &lt; <italic>T</italic>, <italic>T</italic> represents the total duration of each transaction cycle, a new round of matching will be performed. If <italic>T</italic><sub><italic>M</italic></sub> ≥ <italic>T</italic>, the period of the transaction ends, and the transaction information is submitted to the power trading center. So far, the power required by <italic>PU</italic> is directly provided by the power grid controlled by PTC. <italic>GU</italic> can choose to sell the remaining power to PTC at a low price, or store it in its own storage device, and then trade in the next trading cycle.</p><fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Figa_HTML.png" position="anchor" id="MO7"/></fig><p id="Par106">After each round of the trading cycle, the system will conduct a new round of reputation value evaluation based on the trading performance of each participant in this cycle. If some unexpected event occurs during the energy transaction, this will activate the trigger. Then, CVPP restarts Algorithm 1 and re-initializes the parameters.</p><p id="Par107">Bitcoin has opened the 1.0 era of blockchain, and Ethereum integrated with smart contract has opened the 2.0 era of blockchain. Smart contract gives the blockchain more possibilities, so that the blockchain is no longer restricted to the financial field. Algorithm 1 is the pseudo code of reputation-based CDA algorithm. The actual code needs to be deployed to the blockchain network in the form of smart contract.</p></sec><sec id="Sec29"><title>Generation of data blocks</title><sec><p id="Par108">The system mentioned in this article is mainly composed of a globally maintained transaction consortium blockchain and multiple scheduling private blockchains constructed by VPP itself. On the private chain constructed by VPP, we uniformly adopt the strong-leader Raft consensus mechanism [<xref ref-type="bibr" rid="CR46">46</xref>] to generate new data blocks. There are three identities of leader, candidate and follower in the Raft consensus mechanism. Under normal working conditions, there is only one leader, and all other nodes are followers. The difference between a candidate and a follower is that when the leader cannot function normally, a new leader will be selected from the candidates. Here, we will briefly explain the workflow of using the Raft consensus mechanism to generate new blocks in the scheduling of private blockchains. First, the leader node reviews the data from DER and sends it to the DER agent for re-inspection. Secondly, the DER agent rechecks the data sent by the leader node and returns the result of the recheck to the leader node. Finally, the leader node packs the data that has passed the verification and re-inspection into blocks and uploads it to the private blockchain, and sends its block hash value to the transaction consortium blockchain.</p></sec><sec><p id="Par109">As mentioned above, PoW is usually a consensus algorithm adopted by public blockchain and has the highest security. However, its work efficiency is low and resource consumption is large, and it cannot meet the real-time needs of users. Although PoS reduces the resource consumption problem of PoW to a certain extent, it has the problem of excessive concentration. Therefore, the consortium blockchain usually uses the PBFT consensus algorithm to complete the generation of new blocks. The transaction consortium blockchain proposed in this paper uses the PBFT consensus algorithm to generate new blocks. The difference is that the consensus node in this article is constantly changing. According to the reputation value of participating nodes, the system randomly selects a certain number of nodes to form a consensus committee. Before each transaction cycle in the system starts, a new consensus committee will be generated, and the working time of the consensus committee is the transaction cycle time. After the transaction cycle ends, the system will reconfigure a new consensus committee based on the current node reputation value. It should be noted that the total number of nodes in the consensus committee remains unchanged, except for the first configuration of the committee consensus nodes are all new nodes, and subsequent reconfigurations only randomly replace a certain number of old nodes. After the consensus committee is generated, it starts to run the PBFT consensus algorithm. There are two types of consensus nodes in the PBFT algorithm, leader nodes and replica nodes. There is only one leader node in the consensus process, and the others are replica nodes. The specific PBFT distributed consensus process is divided into five stages: request, pre-prepare, prepare, commit and reply. The three stages of pre-prepare, prepare and commit determine the correctness of the final consensus result. The simplified PBFT algorithm consensus process has 5 stages, which are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.
<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Simplified PBFT algorithm consensus flow chart</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig7_HTML.png" id="MO8"/></fig></p></sec><sec id="FPar7"><title>Request stage</title><p id="Par110">when a client sends a request to any node, the consensus node that first activates the node service operation is called the leader.</p></sec><sec id="FPar8"><title>Pre-prepare stage</title><p id="Par111">after receiving the information request from the client, the leader node broadcasts the execution sequence of the transaction to each replica node.</p></sec><sec id="FPar9"><title>Prepare stage</title><p id="Par112">when each replica node receives a message from the leader node, there are two different options, the first is to accept and spread the message again, the second is to not accept and refuse to make any response. In Fig. <xref rid="Fig7" ref-type="fig">7</xref>, replica1 and replica2 choose the first option, and replica3 chooses the second option. At this time, the replica3 may be down or maliciously hijacked.</p></sec><sec id="FPar10"><title>Commit stage</title><p id="Par113">if each consensus node receives (<italic>n</italic> − <italic>f</italic>) identical requests in the “prepare stage”, it will enter the “commit stage” and broadcast the commitment information throughout the network. <italic>n</italic> is the total number of consensus nodes, <italic>f</italic> is the maximum number of Byzantine nodes that can be accommodated in the consensus node.</p></sec><sec id="FPar11"><title>Reply stage</title><p id="Par114">if the consensus node collects enough same commitment information, the node will feed it back to the client. If and only if <italic>f</italic> ≤ (<italic>n</italic> − 1)/3 [<xref ref-type="bibr" rid="CR28">28</xref>], the consensus result is trustworthy.</p><p id="Par115">The verified information will be constructed into a new block, and then linked to the end of the current transaction consortium blockchain, the block height adds 1. In order to encourage nodes to participate more actively in the consensus process, all selected consensus nodes can receive energy coins issued by the system as rewards during the block generation process.</p></sec></sec></sec><sec id="Sec30"><title>Analysis and evaluation</title><sec id="Sec31"><title>System security analysis</title><sec><p id="Par116">In the scheduling and transaction process of VPP, the security of data sharing and storage process is very important for the entire system. In this section, we compare with the existing schemes in terms of system security, and the comparison results are shown in Table <xref rid="Tab3" ref-type="table">3</xref>. The comparison results show that the security of this scheme is better than other schemes, and it is more suitable for data sharing and storage in VPP. In the meantime, we theoretically explained how to uses blockchain technology to realize the security features in the process of data sharing and storage.
<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Security comparison between our scheme and some references</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Security Features</p></th><th><p>Ref. [<xref ref-type="bibr" rid="CR24">24</xref>]</p></th><th><p>Ref. [<xref ref-type="bibr" rid="CR25">25</xref>]</p></th><th><p>Ref. [<xref ref-type="bibr" rid="CR26">26</xref>]</p></th><th><p>Our scheme</p></th></tr></thead><tbody><tr><td><p>Authenticity</p></td><td><p><bold>×</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>×</bold></p></td><td><p><bold>√</bold></p></td></tr><tr><td><p>Confidentiality</p></td><td><p><bold>×</bold></p></td><td><p><bold>×</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td></tr><tr><td><p>Transparency</p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td></tr><tr><td><p>Traceability</p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td></tr><tr><td><p>Immutability</p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td></tr><tr><td><p>Non-repudiation</p></td><td><p><bold>×</bold></p></td><td><p><bold>×</bold></p></td><td><p><bold>√</bold></p></td><td><p><bold>√</bold></p></td></tr></tbody></table></table-wrap></p></sec><sec id="FPar12"><title>Authenticity</title><p id="Par117">This paper repeatedly mentions that VPP is a data-driven technology. If VPP cannot get real data, then all subsequent operations are meaningless. Most of the existing literatures default that the data on the blockchain is real. In nature, blockchain technology can only guarantee the authenticity of the data on the chain, but cannot guarantee the authenticity of the input data. To ensure the authenticity of the input data, this paper proposes to use tamper-proof smart metering equipment for data collection at the data end, and upload the collected data to the local blockchain in real time. So far, the data on the chain and off-chain are authentic, and VPP can process the data with confidence.</p></sec><sec id="FPar13"><title>Confidentiality</title><p id="Par118">Tamper proof intelligent metering equipment will upload users' various data and information in real time. If this information are not encrypted before uploading, it is easy to cause user privacy disclosure. When the DER want to share encrypted data with VPP, it needs to download the ciphertext <italic>CT</italic><sub><italic>A</italic></sub> and decrypt it, and then encrypt it with the public key <inline-formula id="IEq68"><alternatives><mml:math display="inline" id="IEq68_Math"><mml:msub><mml:mi mathvariant="italic">PK</mml:mi><mml:msub><mml:mi mathvariant="italic">ID</mml:mi><mml:mi mathvariant="italic">VPP</mml:mi></mml:msub></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {PK}_{ID_{VPP}} $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq68.gif"/></alternatives></inline-formula> of the VPP. In this case, encrypting data brings a lot of extra cost to the DER, which is not worth it. In order to solve this problem, this paper uses proxy re-encryption technology to re-encrypt <italic>CT</italic><sub><italic>A</italic></sub>, so that <italic>CT</italic><sub><italic>A</italic></sub> can be accessed by VPP without decrypting through the DER. This method effectively reduces the cost of the data owner and protects the confidentiality of the data.</p></sec><sec id="FPar14"><title>Transparency and Traceability</title><p id="Par119">The data stored on the blockchain is open and transparent to all nodes that join. Although for confidentiality of the data, the stored here may be ciphertext <italic>CT</italic><sub><italic>A</italic></sub>, but it can be passed to the data owner submit an application to gain access. Furthermore, the public and private keys (<italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub>) in this paper are generated based on identity, and each piece of information on the blockchain will be closely linked to its own (<italic>PK</italic><sub><italic>ID</italic></sub>, <italic>SK</italic><sub><italic>ID</italic></sub>). It is also worth noting that the blockchain is linked by a hash pointer to the blocks containing the previous block hash. The characteristics of the hash function make the information stored in the blockchain not lost and falsify. Under the combined effect of these conditions, the information stored on the blockchain is traceable.</p></sec><sec id="FPar15"><title>Immutability and Non-repudiation</title><p id="Par120">Immutability on the blockchain is related to the adopted consensus mechanism. In the dual blockchains architecture used in this paper, the private blockchain uses the strong leader Raft consensus algorithm, and the consortium blockchain uses the PBFT consensus algorithm. In the private blockchain, the leader may tamper with the data. To avoid this situation, we store the hash of the private chain in the consortium blockchain, and rely on the unforgeability of the consortium blockchain to ensure the non-tamperable modification of the private blockchain. Since the consensus nodes of the consortium blockchain are selected based on reputation, and nodes with higher reputation can reap more benefits, more than one-third of high-reputation consensus nodes attacking the alliance blockchain at the same time violate their own interests and are unlikely to happen. Therefore, it can guarantee the unforgeability of consortium blockchain and private blockchain. Non-repudiation is achieved by digital signatures. The generation of each transaction requires the user to sign the transaction. Once the user denies, we can use his public key <italic>PK</italic><sub><italic>ID</italic></sub> to verify the correctness of the signature <italic>σ</italic> to achieve the purpose of accountability.</p></sec></sec><sec id="Sec32"><title>CP-HAPRE algorithm performance evaluation</title><sec id="Sec33"><title>Computational overhead evaluation</title><p id="Par121">The computational cost of the algorithm is mainly composed of four operations: encryption, re-encryption, decryption and re-decryption. In the literature we consulted, we did not find similar literature with the same ideas as ours in terms of energy. In order to better evaluate the algorithm performance, we found papers using similar ideas to solve information security problems in cloud, Internet of things and Internet of vehicles for performance comparison. These papers are represented in references [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>] and [<xref ref-type="bibr" rid="CR49">49</xref>], the computational cost of the CP-HAPRE algorithm is compared and analyzed. The comparison results of computational overhead are shown in Table <xref rid="Tab4" ref-type="table">4</xref> with these references. In this table, <italic>T</italic><sub><italic>P</italic></sub> represents the time required for the bilinear pairing operation, and <italic>T</italic><sub><italic>E</italic></sub> represents the exponential operation time. Since other operations time is very small compared with these two operations, we ignore the operation time of other operations here. In addition, |<italic>l</italic>| represents the number of attributes in the access structure, and |<italic>I</italic>| represents the number of attributes that satisfy the access structure.
<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Comparison of computational overhead</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Scheme</p></th><th><p>Encryption</p></th><th><p>Re-encryption</p></th><th><p>Decryption</p></th><th><p>Re-decryption</p></th></tr></thead><tbody><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR47">47</xref>]</p></td><td><p><italic>T</italic><sub><italic>p</italic></sub><italic>+</italic>(3|<italic>l</italic>|<italic>+</italic>6)<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>(2|<italic>I</italic>|<italic>+</italic>3)<italic>T</italic><sub><italic>P</italic></sub></p></td><td><p>(2|<italic>I</italic>|<italic>+</italic>3)<italic>T</italic><sub><italic>P</italic></sub><italic>+T</italic><sub><italic>E</italic></sub></p></td><td><p>(2|<italic>I</italic>|<italic>+</italic>4<italic>)T</italic><sub><italic>P</italic></sub><italic>+T</italic><sub><italic>E</italic></sub></p></td></tr><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR48">48</xref>]</p></td><td><p>(6|<italic>l</italic>|<italic>+</italic>3)<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>(8|<italic>I</italic>|<italic>+</italic>3)<italic>T</italic><sub><italic>P</italic></sub><italic>+</italic>2<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>(4|<italic>I</italic>|<italic>+</italic>2)<italic>T</italic><sub><italic>P</italic></sub></p></td><td><p>2<italic>T</italic><sub><italic>P</italic></sub><italic>+</italic>(4|<italic>I</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>E</italic></sub></p></td></tr><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR49">49</xref>]</p></td><td><p><italic>T</italic><sub><italic>p</italic></sub><italic>+</italic>(3|<italic>l</italic>|<italic>+</italic>2)<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>(4|<italic>I</italic>|<italic>+</italic>9)<italic>T</italic><sub><italic>P</italic></sub></p></td><td><p>(2|<italic>I</italic>|<italic>+</italic>5)<italic>T</italic><sub><italic>P</italic></sub><italic>+</italic>(|<italic>I</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>3<italic>T</italic><sub><italic>P</italic></sub><italic>+</italic>2(|<italic>I</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>E</italic></sub></p></td></tr><tr><td><p>Our scheme</p></td><td><p><italic>T</italic><sub><italic>p</italic></sub><italic>+</italic>(3|<italic>l</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>E</italic></sub></p></td><td><p>(3|<italic>I</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>P</italic></sub></p></td><td><p>(3|<italic>I</italic>|<italic>+</italic>1)<italic>T</italic><sub><italic>P</italic></sub></p></td><td><p>6<italic>T</italic><sub><italic>P</italic></sub></p></td></tr></tbody></table></table-wrap></p><p id="Par122"><italic>T</italic><sub><italic>p</italic></sub>: bilinear pairing operation time; <italic>T</italic><sub><italic>E</italic></sub>: exponential operation time; |<italic>l</italic>|: the number of attributes in the access structure; |<italic>I</italic>|: the number of attributes that satisfy the access structure</p><p id="Par123">A test run was performed on a computer with an Intel i5 processor CPU with a running memory of 8G and a frequency of 3.0GHz. Finally, it was concluded that the above two operations took 1.57ms and 0.31ms respectively. Based on this data, we can get a comparison diagram of each part of the computational overhead as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref> with references [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>] and [<xref ref-type="bibr" rid="CR49">49</xref>].
<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Computational overhead comparison diagram</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig8_HTML.png" id="MO9"/></fig></p><p id="Par124">Fig. <xref rid="Fig8" ref-type="fig">8</xref> (a) shows the encryption overhead that occurs as the number of attributes increases, and the least encryption overhead is our scheme. Fig. <xref rid="Fig8" ref-type="fig">8</xref> (b) shows the re-encryption calculation overhead, which changes with the number of attributes. It can be seen from the figure that the re-encryption overhead in [<xref ref-type="bibr" rid="CR47">47</xref>] is the smallest, followed by ours. Fig. <xref rid="Fig8" ref-type="fig">8</xref> (c) shows the decryption overhead comparison chart. Our scheme ranks third, which is only slightly less expensive than literature [<xref ref-type="bibr" rid="CR48">48</xref>]. This is the disadvantage of our scheme. Fig. <xref rid="Fig8" ref-type="fig">8</xref> (d) shows the re-decryption overhead. It is not difficult to find that our scheme will not change with the number of attributes, and its re-decryption time is always maintained at 9.42ms. Compared with the other three schemes, our scheme is at a disadvantage when the number of attributes is less than 5. This is because we join the signature verification process, so that we can be held responsible when the data is wrong. However, when the number of attributes exceeds 5, our scheme has obvious advantages, and the more the number of attributes, the greater the advantage.</p><p id="Par125">Based on the four-part comparative performance, our scheme performed unsatisfactorily in the decryption stage, while in the re-decryption stage, our solution showed great superiority. In actual application, the encrypted data uploaded by DER is mainly shared to TVPP for viewing. Therefore, during the entire algorithm operation process, the decryption operation process will be very few, most of the time is running the re-decryption process, this concept coincides with our solution. In summary, the comparison of computational overhead shows the applicability and efficiency of our solution in the actual application scenarios of this paper.</p></sec><sec id="Sec34"><title>Communication overhead evaluation</title><p id="Par126">Here, we assume that |<italic>G</italic>| and |<italic>G</italic><sub><italic>T</italic></sub>| represent the lengths of the cyclic groups <italic>G</italic> and <italic>G</italic><sub><italic>T</italic></sub>, respectively, with values of 60 bits and 40 bits. Since the length of <inline-formula id="IEq69"><alternatives><mml:math display="inline" id="IEq69_Math"><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Z}_p^{\ast } $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq69.gif"/></alternatives></inline-formula> is very small, we ignore it. The communication overhead comparison is shown in Table <xref rid="Tab5" ref-type="table">5</xref>, where |<italic>U</italic>| represents the size of the attribute complete set, |<italic>S</italic>| represents the size of the user attribute set, and |<italic>l</italic>| and |<italic>I</italic>| are defined as above.
<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Comparison of communication overhead</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Scheme</p></th><th><p>System parameters</p></th><th><p>Encryption key</p></th><th><p>Ciphertext</p></th><th><p>Re-encrypted ciphertext</p></th></tr></thead><tbody><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR47">47</xref>]</p></td><td><p>8|<italic>G</italic>|<italic>+</italic>2|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>(2|<italic>S</italic>|<italic>+</italic>4)|<italic>G</italic>|</p></td><td><p>(2|<italic>l</italic>|<italic>+</italic>5)|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>(2|<italic>I</italic>|<italic>+</italic>8)|<italic>G</italic>|<italic>+</italic>3|<italic>G</italic><sub><italic>T</italic></sub>|</p></td></tr><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR48">48</xref>]</p></td><td><p>(8|<italic>U</italic>|<italic>+</italic>6)|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>6|<italic>S</italic>||<italic>G</italic>|</p></td><td><p>(6|<italic>l</italic>|<italic>+</italic>2)|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>2|<italic>G</italic>|<italic>+</italic>(2|<italic>I</italic>|<italic>+</italic>1)|<italic>G</italic><sub><italic>T</italic></sub>|</p></td></tr><tr><td><p>Ref. [<xref ref-type="bibr" rid="CR49">49</xref>]</p></td><td><p>6|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>(|<italic>S</italic>|<italic>+</italic>2)|<italic>G</italic>|</p></td><td><p>(3|<italic>l</italic>|<italic>+</italic>3)|<italic>G</italic>|</p></td><td><p>6(|<italic>I</italic>|<italic>+</italic>1)|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td></tr><tr><td><p>Our scheme</p></td><td><p>6|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>(|<italic>S</italic>|<italic>+</italic>2)|<italic>G</italic>|</p></td><td><p>(3|<italic>l</italic>|<italic>+</italic>2)|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td><td><p>4|<italic>G</italic>|<italic>+</italic>|<italic>G</italic><sub><italic>T</italic></sub>|</p></td></tr></tbody></table><table-wrap-foot><p>|<italic>G</italic>|, |<italic>G</italic><sub><italic>T</italic></sub>|: the lengths of the cyclic groups <italic>G</italic> and <italic>G</italic><sub><italic>T</italic></sub>; |<italic>U</italic>|: the attribute complete set size; |<italic>S</italic>|: the user attribute set size; |<italic>l</italic>|: the number of attributes in the access structure; |<italic>I</italic>|: the number of attributes that satisfy the access structure</p></table-wrap-foot></table-wrap></p><p id="Par127">Fig. <xref rid="Fig9" ref-type="fig">9</xref> shows a comparison diagram of various parts of the communication overhead, including system parameters, encryption key, ciphertext and re-encrypted ciphertext. Fig. <xref rid="Fig9" ref-type="fig">9</xref> (a) shows the comparison of the communication overhead of the system parameters. It can be seen from the figure that, except for the literature [<xref ref-type="bibr" rid="CR48">48</xref>], which changes with the number of attributes, the other three schemes are kept constant. The system parameter length of our scheme and literature [<xref ref-type="bibr" rid="CR49">49</xref>] is the smallest, both are 400 bits, while the length of literature [<xref ref-type="bibr" rid="CR47">47</xref>] is 560 bits. Fig. <xref rid="Fig9" ref-type="fig">9</xref> (b) shows the comparison of encryption key. Reference [<xref ref-type="bibr" rid="CR49">49</xref>] and our scheme equals the encryption key length, tied for the first performance. The communication overhead comparison of ciphertext is shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref> (c). At this time, as the number of attributes increases, the minimum ciphertext length comes from literature [<xref ref-type="bibr" rid="CR47">47</xref>], and our scheme still ranks second. The length of re- encrypted ciphertext shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref> (d) is similar to the re-decryption process in comparison of the computational cost. The length of the re-encrypted ciphertext in our scheme is always maintained at 280 bits, once again showing the great advantages of the algorithm.
<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Communication overhead comparison diagram</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13677_2021_273_Fig9_HTML.png" id="MO10"/></fig></p><p id="Par128">Combining the evaluation of computational cost and communication cost, we can conclude that the algorithm in this paper has superior performance, whether in comparison of computational cost or communication cost. In the re-decryption calculation cost and re-encrypted ciphertext communication cost stage, we are far ahead of the other three schemes. This advantage helps us realize the rapid sharing of re-encrypted ciphertext, which is very suitable for the use scenarios of this paper.</p></sec></sec><sec id="Sec35"><title>Evaluation of effectiveness of the reputation-based CDA algorithm</title><p id="Par129">Assuming that there are 16 DER generation units and 16 residential power units participating in the electricity bidding auction process organized by CVPP in this area, the quotation information they submit to CVPP is shown in Table <xref rid="Tab6" ref-type="table">6</xref>. After CVPP receives the quotation information from each participant, it performs list division and list matching according to the reputation-based CDA algorithm. For details, see Tables <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref> and <xref rid="Tab9" ref-type="table">9</xref>. The quotation information, capacity and reputation value in the table are all generated by random functions, and the value ranges of the three parties are [1.1-1.5], [1-20] and [0-6].
<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>Quotation information of all participants</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p><bold><italic>GU</italic></bold></p></th><th><p>Offer</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th><th><p><bold><italic>PU</italic></bold></p></th><th><p>Bid</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th></tr></thead><tbody><tr><td><p><italic>GU</italic><sub>1</sub></p></td><td><p>1.13</p></td><td><p>11</p></td><td><p>2.82</p></td><td><p><italic>PU</italic><sub>1</sub></p></td><td><p>1.33</p></td><td><p>1</p></td><td><p>2.34</p></td></tr><tr><td><p><italic>GU</italic><sub>2</sub></p></td><td><p>1.20</p></td><td><p>15</p></td><td><p>0.07</p></td><td><p><italic>PU</italic><sub>2</sub></p></td><td><p>1.18</p></td><td><p>5</p></td><td><p>1.45</p></td></tr><tr><td><p><italic>GU</italic><sub>3</sub></p></td><td><p>1.15</p></td><td><p>12</p></td><td><p>2.02</p></td><td><p><italic>PU</italic><sub>3</sub></p></td><td><p>1.22</p></td><td><p>4</p></td><td><p>2.42</p></td></tr><tr><td><p><italic>GU</italic><sub>4</sub></p></td><td><p>1.17</p></td><td><p>13</p></td><td><p>0.97</p></td><td><p><italic>PU</italic><sub>4</sub></p></td><td><p>1.29</p></td><td><p>9</p></td><td><p>0.58</p></td></tr><tr><td><p><italic>GU</italic><sub>5</sub></p></td><td><p>1.20</p></td><td><p>10</p></td><td><p>4.77</p></td><td><p><italic>PU</italic><sub>5</sub></p></td><td><p>1.19</p></td><td><p>16</p></td><td><p>0.79</p></td></tr><tr><td><p><italic>GU</italic><sub>6</sub></p></td><td><p>1.27</p></td><td><p>19</p></td><td><p>1.87</p></td><td><p><italic>PU</italic><sub>6</sub></p></td><td><p>1.44</p></td><td><p>11</p></td><td><p>5.65</p></td></tr><tr><td><p><italic>GU</italic><sub>7</sub></p></td><td><p>1.12</p></td><td><p>20</p></td><td><p>3.17</p></td><td><p><italic>PU</italic><sub>7</sub></p></td><td><p>1.18</p></td><td><p>7</p></td><td><p>5.74</p></td></tr><tr><td><p><italic>GU</italic><sub>8</sub></p></td><td><p>1.46</p></td><td><p>17</p></td><td><p>0.99</p></td><td><p><italic>PU</italic><sub>8</sub></p></td><td><p>1.19</p></td><td><p>14</p></td><td><p>3.45</p></td></tr><tr><td><p><italic>GU</italic><sub>9</sub></p></td><td><p>1.48</p></td><td><p>6</p></td><td><p>3.61</p></td><td><p><italic>PU</italic><sub>9</sub></p></td><td><p>1.17</p></td><td><p>12</p></td><td><p>0.36</p></td></tr><tr><td><p><italic>GU</italic><sub>10</sub></p></td><td><p>1.30</p></td><td><p>3</p></td><td><p>1.58</p></td><td><p><italic>PU</italic><sub>10</sub></p></td><td><p>1.19</p></td><td><p>20</p></td><td><p>1.41</p></td></tr><tr><td><p><italic>GU</italic><sub>11</sub></p></td><td><p>1.30</p></td><td><p>16</p></td><td><p>3.92</p></td><td><p><italic>PU</italic><sub>11</sub></p></td><td><p>1.27</p></td><td><p>15</p></td><td><p>2.12</p></td></tr><tr><td><p><italic>GU</italic><sub>12</sub></p></td><td><p>1.24</p></td><td><p>18</p></td><td><p>4.14</p></td><td><p><italic>PU</italic><sub>12</sub></p></td><td><p>1.22</p></td><td><p>3</p></td><td><p>4.93</p></td></tr><tr><td><p><italic>GU</italic><sub>13</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>4.49</p></td><td><p><italic>PU</italic><sub>13</sub></p></td><td><p>1.47</p></td><td><p>6</p></td><td><p>0.09</p></td></tr><tr><td><p><italic>GU</italic><sub>14</sub></p></td><td><p>1.25</p></td><td><p>14</p></td><td><p>2.70</p></td><td><p><italic>PU</italic><sub>14</sub></p></td><td><p>1.27</p></td><td><p>19</p></td><td><p>0.26</p></td></tr><tr><td><p><italic>GU</italic><sub>15</sub></p></td><td><p>1.14</p></td><td><p>7</p></td><td><p>0.50</p></td><td><p><italic>PU</italic><sub>15</sub></p></td><td><p>1.17</p></td><td><p>10</p></td><td><p>1.01</p></td></tr><tr><td><p><italic>GU</italic><sub>16</sub></p></td><td><p>1.41</p></td><td><p>9</p></td><td><p>1.37</p></td><td><p><italic>PU</italic><sub>16</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>3.89</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Matching list of <inline-formula id="IEq70"><alternatives><mml:math display="inline" id="IEq70_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_1^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq70.gif"/></alternatives></inline-formula> and <inline-formula id="IEq71"><alternatives><mml:math display="inline" id="IEq71_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_1^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq71.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p><bold><italic>GU</italic></bold></p></th><th><p>Offer</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th><th><p><bold><italic>PU</italic></bold></p></th><th><p>Bid</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th></tr></thead><tbody><tr><td><p><italic>GU</italic><sub>5</sub></p></td><td><p>1.20</p></td><td><p>10</p></td><td><p>4.77</p></td><td><p><italic>PU</italic><sub>13</sub></p></td><td><p>1.47</p></td><td><p>6</p></td><td><p>0.09</p></td></tr><tr><td><p><italic>GU</italic><sub>12</sub></p></td><td><p>1.24</p></td><td><p>18</p></td><td><p>4.14</p></td><td><p><italic>PU</italic><sub>4</sub></p></td><td><p>1.29</p></td><td><p>9</p></td><td><p>0.58</p></td></tr><tr><td><p><italic>GU</italic><sub>13</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>4.49</p></td><td><p><italic>PU</italic><sub>14</sub></p></td><td><p>1.27</p></td><td><p>19</p></td><td><p>0.26</p></td></tr><tr><td/><td/><td/><td/><td><p><italic>PU</italic><sub>10</sub></p></td><td><p>1.19</p></td><td><p>20</p></td><td><p>1.41</p></td></tr><tr><td/><td/><td/><td/><td><p><italic>PU</italic><sub>5</sub></p></td><td><p>1.19</p></td><td><p>16</p></td><td><p>0.79</p></td></tr><tr><td/><td/><td/><td/><td><p><italic>PU</italic><sub>2</sub></p></td><td><p>1.18</p></td><td><p>5</p></td><td><p>1.45</p></td></tr><tr><td/><td/><td/><td/><td><p><italic>PU</italic><sub>15</sub></p></td><td><p>1.17</p></td><td><p>10</p></td><td><p>1.01</p></td></tr><tr><td/><td/><td/><td/><td><p><italic>PU</italic><sub>9</sub></p></td><td><p>1.17</p></td><td><p>12</p></td><td><p>0.36</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab8"><label>Table 8</label><caption xml:lang="en"><p>Matching list of <inline-formula id="IEq72"><alternatives><mml:math display="inline" id="IEq72_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_2^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><mml:math display="inline" id="IEq73_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_2^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq73.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p><bold><italic>GU</italic></bold></p></th><th><p>Offer</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th><th><p><bold><italic>PU</italic></bold></p></th><th><p>Bid</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th></tr></thead><tbody><tr><td><p><italic>GU</italic><sub>7</sub></p></td><td><p>1.12</p></td><td><p>20</p></td><td><p>3.17</p></td><td><p><italic>PU</italic><sub>16</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>3.89</p></td></tr><tr><td><p><italic>GU</italic><sub>1</sub></p></td><td><p>1.13</p></td><td><p>11</p></td><td><p>2.82</p></td><td><p><italic>PU</italic><sub>1</sub></p></td><td><p>1.33</p></td><td><p>1</p></td><td><p>2.34</p></td></tr><tr><td><p><italic>GU</italic><sub>3</sub></p></td><td><p>1.15</p></td><td><p>12</p></td><td><p>2.02</p></td><td><p><italic>PU</italic><sub>11</sub></p></td><td><p>1.27</p></td><td><p>15</p></td><td><p>2.12</p></td></tr><tr><td><p><italic>GU</italic><sub>5</sub></p></td><td><p>1.20</p></td><td><p>10</p></td><td><p>4.77</p></td><td><p><italic>PU</italic><sub>3</sub></p></td><td><p>1.22</p></td><td><p>4</p></td><td><p>2.42</p></td></tr><tr><td><p><italic>GU</italic><sub>12</sub></p></td><td><p>1.24</p></td><td><p>18</p></td><td><p>4.14</p></td><td><p><italic>PU</italic><sub>8</sub></p></td><td><p>1.19</p></td><td><p>14</p></td><td><p>3.45</p></td></tr><tr><td><p><italic>GU</italic><sub>14</sub></p></td><td><p>1.25</p></td><td><p>14</p></td><td><p>2.70</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>11</sub></p></td><td><p>1.30</p></td><td><p>16</p></td><td><p>3.92</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>13</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>4.49</p></td><td/><td/><td/><td/></tr></tbody></table></table-wrap><table-wrap id="Tab9"><label>Table 9</label><caption xml:lang="en"><p>Matching list of <inline-formula id="IEq74"><alternatives><mml:math display="inline" id="IEq74_Math"><mml:msubsup><mml:mi mathvariant="italic">OL</mml:mi><mml:mn>3</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {OL}_3^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><mml:math display="inline" id="IEq75_Math"><mml:msubsup><mml:mi mathvariant="italic">BL</mml:mi><mml:mn>3</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {BL}_3^t $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13677_2021_273_Article_IEq75.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p><bold><italic>GU</italic></bold></p></th><th><p>Offer</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th><th><p><bold><italic>PU</italic></bold></p></th><th><p>Bid</p><p>(USD/Unit)</p></th><th><p>Capacity</p><p>(Unit)</p></th><th><p>Reputation</p><p>value</p></th></tr></thead><tbody><tr><td><p><italic>GU</italic><sub>7</sub></p></td><td><p>1.12</p></td><td><p>20</p></td><td><p>3.17</p></td><td><p><italic>PU</italic><sub>6</sub></p></td><td><p>1.44</p></td><td><p>11</p></td><td><p>5.65</p></td></tr><tr><td><p><italic>GU</italic><sub>1</sub></p></td><td><p>1.13</p></td><td><p>11</p></td><td><p>2.82</p></td><td><p><italic>PU</italic><sub>12</sub></p></td><td><p>1.22</p></td><td><p>3</p></td><td><p>4.93</p></td></tr><tr><td><p><italic>GU</italic><sub>15</sub></p></td><td><p>1.14</p></td><td><p>7</p></td><td><p>0.50</p></td><td><p><italic>PU</italic><sub>7</sub></p></td><td><p>1.18</p></td><td><p>7</p></td><td><p>5.74</p></td></tr><tr><td><p><italic>GU</italic><sub>3</sub></p></td><td><p>1.15</p></td><td><p>12</p></td><td><p>2.02</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>4</sub></p></td><td><p>1.17</p></td><td><p>13</p></td><td><p>0.97</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>5</sub></p></td><td><p>1.20</p></td><td><p>10</p></td><td><p>4.77</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>2</sub></p></td><td><p>1.20</p></td><td><p>15</p></td><td><p>0.07</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>12</sub></p></td><td><p>1.24</p></td><td><p>18</p></td><td><p>4.14</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>14</sub></p></td><td><p>1.25</p></td><td><p>14</p></td><td><p>2.70</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>6</sub></p></td><td><p>1.27</p></td><td><p>19</p></td><td><p>1.87</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>11</sub></p></td><td><p>1.30</p></td><td><p>16</p></td><td><p>3.92</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>10</sub></p></td><td><p>1.30</p></td><td><p>3</p></td><td><p>1.58</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>16</sub></p></td><td><p>1.41</p></td><td><p>9</p></td><td><p>1.37</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>13</sub></p></td><td><p>1.46</p></td><td><p>2</p></td><td><p>4.49</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>8</sub></p></td><td><p>1.46</p></td><td><p>17</p></td><td><p>0.99</p></td><td/><td/><td/><td/></tr><tr><td><p><italic>GU</italic><sub>9</sub></p></td><td><p>1.48</p></td><td><p>6</p></td><td><p>3.61</p></td><td/><td/><td/><td/></tr></tbody></table></table-wrap></p><sec id="Sec36"><title>Analyzing the validity of algorithm to PU</title><p id="Par130">From Table <xref rid="Tab6" ref-type="table">6</xref>, we can find that the quotations of <italic>PU</italic><sub>7</sub> and <italic>PU</italic><sub>15</sub> are both 1.18 USD/Unit, and the quotation of <italic>PU</italic><sub>10</sub> is 1.19 USD/Unit. After this round of matching, <italic>PU</italic><sub>7</sub> is matched successfully, but <italic>PU</italic><sub>10</sub> and <italic>PU</italic><sub>15</sub> failed to match. The main reason is <italic>that</italic> the reputation value of <italic>PU</italic><sub>7</sub> is 5.74 , which is in the third level. In the case given in this paper, there are only 3 <italic>PU</italic> with <italic>reputation</italic> at third level, and 16 <italic>GU</italic> that can be selected. The reputation values of <italic>PU</italic><sub>10</sub> and <italic>PU</italic><sub>15</sub> are in the first level. As shown in Table <xref rid="Tab7" ref-type="table">7</xref>, there are only 3 <italic>GU</italic> that can be matched, while 8 <italic>PU</italic> are waiting to be matched. Under such conditions, even though the bid of <italic>PU</italic><sub>7</sub> is lower, it can still be successfully matched, which is the benefit of high reputation value to <italic>PU</italic>.</p></sec><sec id="Sec37"><title>Analyzing the validity of algorithm to GU</title><p id="Par131">For <italic>GU</italic>, the higher the reputation value, the more benefits can be obtained. Taking <italic>GU</italic><sub>2</sub> and <italic>GU</italic><sub>12</sub> as examples, the offer of <italic>GU</italic><sub>12</sub> is 1.24 USD/Unit, and the offer of <italic>GU</italic><sub>2</sub> is 1.20 USD/Unit. In the normal CDA auction mechanism, only after the number of <italic>GU</italic><sub>2</sub> to be sold is purchased, the higher offer of <italic>GU</italic><sub>12</sub> may be successfully matched. But in our proposed reputation-based CDA auction mechanism, <italic>GU</italic><sub>12</sub> with a higher offer was matched successfully, and <italic>GU</italic><sub>2</sub> with a lower offer failed. The main reason is that <italic>GU</italic><sub>12</sub> has a reputation value of 4.14 and the reputation value of <italic>GU</italic><sub>2</sub> was only 0.07. According to the market segmentation mechanism, the reputation level of <italic>GU</italic><sub>12</sub> is 3 and the reputation level of <italic>GU</italic><sub>2</sub> is 1. Therefore, the quotation of <italic>GU</italic><sub>12</sub> can be seen by all <italic>PU</italic>. However, the quotation of <italic>GU</italic><sub>2</sub> can only be seen by <italic>PU</italic> with a reputation level of 3. In the end, <italic>GU</italic><sub>12</sub> was successfully matched in Table <xref rid="Tab7" ref-type="table">7</xref> where the supply exceeded demand, while <italic>GU</italic><sub>2</sub> failed in Table <xref rid="Tab9" ref-type="table">9</xref>, where supply exceeded demand. The <italic>GU</italic> which fails to match need to continue to lower their offers and then participate in the next round of auctions. On the contrary, the <italic>PU</italic> which fails to match needs to increase their bids. Participants' specific quotations for the next auction can be obtained according to Eq. (<xref rid="Equ28" ref-type="disp-formula">28</xref>), where <italic>E</italic><sub><italic>p</italic></sub> is provided by CVPP from Eq. <xref rid="Equ27" ref-type="disp-formula">27</xref>.</p></sec><sec id="Sec38"><title>Analyzing the validity of algorithm to the whole transaction</title><p id="Par132">Analyzing Tables <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref> and <xref rid="Tab9" ref-type="table">9</xref> according to the CDA auction mechanism, we can find that <italic>PU</italic><sub>4</sub>, <italic>PU</italic><sub>13</sub> and <italic>PU</italic><sub>14</sub> in Table <xref rid="Tab7" ref-type="table">7</xref> can be successfully matched to <italic>GU</italic>, and <italic>PU</italic> in Table <xref rid="Tab8" ref-type="table">8</xref> that can be successfully matched are <italic>PU</italic><sub>1</sub>, <italic>PU</italic><sub>3</sub>, <italic>PU</italic><sub>8</sub>, <italic>PU</italic><sub>11</sub> and <italic>PU</italic><sub>16</sub>. All 3 <italic>PU</italic> included in Table <xref rid="Tab9" ref-type="table">9</xref> can be matched successfully. After summarizing, it is found that among the 16 <italic>PU</italic>, 11 <italic>PU</italic> in this round of transactions can be successfully matched in this auction, and the unmatched ones are <italic>PU</italic><sub>2</sub>, <italic>PU</italic><sub>5</sub>, <italic>PU</italic><sub>9</sub>, <italic>PU</italic><sub>10</sub> and <italic>PU</italic><sub>15</sub>. In the ordinary CDA auction mechanism, there is only one matching list, and the reason why participants fail to match is only related to the price. The reputation-based CDA auction mechanism proposed in this paper divides three matching lists according to the reputation-based market segmentation mechanism. In this mechanism, the reason for the failure of the participants to match is not only related to the price, but also to the reputation value of the participants.</p><p id="Par133">All in all, the reputation-based CDA auction mechanism proposed in this paper can not only operate normally in CVPP, but also encourage all participants to develop good market behavior. Because the reputation value directly affects their own interests, it can be foreseen that each participant will strive to increase the reputation value in order to maximize their own interests. Even if the reputation values of all participants are at the same level, according to the matching mechanism of "price first, reputation first, time first", our program can still operate normally.</p></sec></sec></sec><sec id="Sec39" sec-type="conclusions"><title>Conclusion</title><p id="Par134">Based on the virtual power plant existing storage, scheduling and trade issues, this paper proposes a VPP security scheduling and transaction mechanism with dual blockchains. In order to store huge data sets from DER in real time and quickly, we adopt a private chain structure. Since the data in the private blockchain may be tampered with by the leader node, we store the hash value of the private blockchain in the consortium blockchain, which is mainly used to store the transaction information of the electricity market participants. The transparency and traceability of the blockchain itself can provide VPP with a low-cost, transparent and open information and transaction platform. In the process of VPP scheduling, the authenticity of data is particularly important. Under the premise of ensuring the authenticity of data and the confidentiality of user information, we propose the CP-HAPRE algorithm. Performance evaluation shows that the algorithm has great advantages in the process of secure data sharing. There are many participants in the electricity market, we put forward a reputation-based CDA auction mechanism to maximize the benefits of each participant. Effectiveness analysis shows that the scheme can effectively operate and create an electricity market with good trading behavior.</p></sec></body><back><ack><title>Acknowledgments</title><p>We want to thank the authors of the literature cited in this paper for contributing useful ideas to this study.</p></ack><sec sec-type="author-contribution"><title>Authors’ contributions</title><sec><p>Xiaohong Zhang: Validation, Writing - review &amp; editing, Visualization. Zilong Song: Conceptualization, Methodology, Software, Writing - original draft. Ata Jahangir Moshayedi: Security analysis and essay polishing. The authors read and approved the final manuscript.</p></sec><sec id="FPar16"><title>Authors’ information</title><p id="Par135"><bold>Xiaohong Zhang</bold> received the B.S. degree in physics from Jiangxi Normal University, Jiangxi, China, in 1984. The M.S. degree in Optical Information Processing from Chinese Academy of Sciences, Changchun, China, in 1990, and the PH. D degree in control theory, information safety, from the University of Science and Technology Beijing (USTB) and Beijing University of Posts and Telecommunications (BUPT) in 2002, 2006, respectively. She was a Visiting Scholar with the University of California, Berkeley, USA, from 2014 to 2015. She is currently a full Professor with the Department of College of Information Engineering, Jiangxi University of Science and Technology, Ganzhou, China. Her main research interests are blockchain technology, information security, nonlinear dynamics, wireless sensor network, etc.</p><p id="Par136"><bold>Zilong Song</bold> received the B.S. degree in electronic and information engineering from Jiangxi University of Science and Technology, Jiangxi, China, in 2019, where he is currently pursuing the M.S. degree with the school of information and communication engineering. His current research interests focus on blockchain technology, renewable energy and information security.</p><p id="Par137"><bold>Ata Jahangir Moshayedi</bold> received the B.S. degree in Power electrical Engineering from Azad University, Iran in 2004. The M.S. degree in Instrumentation Science from Pune University, India in 2009 and PhD in Electronic Science in electronic and Robotic from Savitribai Phule Pune University, India in 2015. Currently working as Associate professor at College of Information Engineering, Jiangxi University of Science and Technology, China, IEEE member. His research interest includes: Robotics and Automation/ Sensor modeling/Bio inspired robot, Mobile Robot Olfaction/Virtual reality, Machine vision/Artificial Intelligence</p></sec></sec><sec><title>Funding</title><p>This work is jointly supported by the National Natural Science Foundation of China (Nos. 61763017, 51665019), Scientific Research Plan Projects of Jiangxi Education Department (No. GJJ150621), Natural Science Foundation of Jiangxi Province (Nos. 20161BAB202053, 20161BAB206145), and the Innovation Fund for Graduate Students in Jiangxi Province (Grant No: YC2020-S443).</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>The authors approve that data used to support the finding of this study are included in the article.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar17" sec-type="COI-statement"><title>Competing interests</title><p id="Par138">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramanathan</surname><given-names>V</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Air pollution, greenhouse gases and climate change: Global and regional perspectives</article-title><source>Atmos Environ</source><year>2009</year><volume>43</volume><issue>1</issue><fpage>37</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1016/j.atmosenv.2008.09.063</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>Z</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Wen</surname><given-names>F</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">From smart grid to energy internet: basic concept and research framework</article-title><source>Autom Electr Power Syst</source><year>2014</year><volume>38</volume><issue>15</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.7500/AEPS20140613007</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>J</given-names></name><name><surname>Xin</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Roadmap of realizing the high penetration renewable energy in China</article-title><source>Proc CSEE</source><year>2015</year><volume>35</volume><issue>14</issue><fpage>3699</fpage><lpage>3705</lpage><pub-id pub-id-type="doi">10.13334/j.0258-8013.pcsee.2015.14.026</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">Kieny C, Berseneff B, Hadjsaid N, Besanger Y, Maire J (2009) On the concept and the interest of virtual power plant: Some results from the European project Fenix. In: 2009 IEEE Power &amp; Energy Society General Meeting. IEEE, pp 1–6. <ext-link xlink:href="10.1109/PES.2009.5275526" ext-link-type="doi">https://doi.org/10.1109/PES.2009.5275526</ext-link></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siano</surname><given-names>P</given-names></name><name><surname>De Marco</surname><given-names>G</given-names></name><name><surname>Rolán</surname><given-names>A</given-names></name><name><surname>Loia</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">A survey and evaluation of the potentials of distributed ledger technology for peer-to-peer transactive energy exchanges in local energy markets</article-title><source>IEEE Syst J</source><year>2019</year><volume>13</volume><issue>3</issue><fpage>3454</fpage><lpage>3466</lpage><pub-id pub-id-type="doi">10.1109/JSYST.2019.2903172</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmad</surname><given-names>A</given-names></name><name><surname>Khan</surname><given-names>JY</given-names></name></person-group><article-title xml:lang="en">Real-time load scheduling and storage management for solar powered network connected EVs</article-title><source>IEEE Trans Sustain Energy</source><year>2019</year><volume>11</volume><issue>3</issue><fpage>1220</fpage><lpage>1235</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2019.2921024</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Shao W, Xu W, Xu Z, Liu B, Zou H (2019) A Grid Connection Mechanism of Large-scale Distributed Energy Resources based on Blockchain. In: 2019 Chinese Control Conference (CCC). IEEE, pp 7500–7505. <ext-link xlink:href="10.23919/ChiCC.2019.8866604" ext-link-type="doi">https://doi.org/10.23919/ChiCC.2019.8866604</ext-link></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Mashhour E, Moghaddas-Tafreshi SM (2009) A review on operation of micro grids and virtual power plants in the power markets. In: 2009 2nd International Conference on Adaptive Science &amp; Technology (ICAST). IEEE, pp 273–277. <ext-link xlink:href="10.1109/ICASTECH.2009.5409714" ext-link-type="doi">https://doi.org/10.1109/ICASTECH.2009.5409714</ext-link></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Development and challenges of distributed generation, the micro-grid and smart distribution system</article-title><source>Autom Electr Power Syst</source><year>2010</year><volume>34</volume><issue>2</issue><fpage>10</fpage><lpage>14</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2643316</pub-id><pub-id pub-id-type="doi">10.13535/j.cnki.11-4406/n.2015.33.071</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shao</surname><given-names>W</given-names></name><name><surname>Xu</surname><given-names>W</given-names></name><name><surname>Xu</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>N</given-names></name><name><surname>Nong</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Research on virtual power plant model based on blockchain</article-title><source>Comput Sci</source><year>2018</year><volume>45</volume><issue>2</issue><fpage>25</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.11896/j.issn.1002-137X.2018.02.005</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mashhour</surname><given-names>E</given-names></name><name><surname>Moghaddas-Tafreshi</surname><given-names>SM</given-names></name></person-group><article-title xml:lang="en">Bidding strategy of virtual power plant for participating in energy and spinning reserve markets—Part I: Problem formulation</article-title><source>IEEE Trans Power Syst</source><year>2010</year><volume>26</volume><issue>2</issue><fpage>949</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2010.2070884</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shabanzadeh</surname><given-names>M</given-names></name><name><surname>Sheikh-El-Eslami</surname><given-names>MK</given-names></name><name><surname>Haghifam</surname><given-names>MR</given-names></name></person-group><article-title xml:lang="en">Risk-based medium-term trading strategy for a virtual power plant with first-order stochastic dominance constraints</article-title><source>Iet Gener Transm Distrib</source><year>2017</year><volume>11</volume><issue>2</issue><fpage>520</fpage><lpage>529</lpage><pub-id pub-id-type="doi">10.1049/iet-gtd.2016.1072</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baringo</surname><given-names>A</given-names></name><name><surname>Baringo</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">A stochastic adaptive robust optimization approach for the offering strategy of a virtual power plant</article-title><source>IEEE Trans Power Syst</source><year>2016</year><volume>32</volume><issue>5</issue><fpage>3492</fpage><lpage>3504</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2016.2633546</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baringo</surname><given-names>A</given-names></name><name><surname>Baringo</surname><given-names>L</given-names></name><name><surname>Arroyo</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">Day-ahead self-scheduling of a virtual power plant in energy and reserve electricity markets under uncertainty</article-title><source>IEEE Trans Power Syst</source><year>2018</year><volume>34</volume><issue>3</issue><fpage>1881</fpage><lpage>1894</lpage><pub-id pub-id-type="doi">10.1109/TPWRS.2018.2883753</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Soter S, Bertling F (2004) Adjustable converter for injection of fuel cell power as a part of a virtual power plant. In: 2004 IEEE 35th Annual Power Electronics Specialists Conference (IEEE Cat. No. 04CH37551), IEEE, pp 1988-1990. <ext-link xlink:href="10.1109/PESC.2004.1355422" ext-link-type="doi">https://doi.org/10.1109/PESC.2004.1355422</ext-link>.</mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikonowicz</surname><given-names>LB</given-names></name><name><surname>Milewski</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Virtual power plants-general review: structure, application and optimization</article-title><source>J Power Technol</source><year>2012</year><volume>92</volume><issue>3</issue><fpage>135</fpage><comment>https://papers.itc.pw.edu.pl/index.php/JPT/article/view/284</comment></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Binding C, Gantenbein D, Jansen B, Sundstrom O, Andersen PB, Marra F, Poulsen B, Traeholt C (2010) Electric vehicle fleet integration in the Danish EDISON project - A virtual power plant on the island of Bornholm. In: IEEE PES General Meeting. IEEE, pp 1–8. <ext-link xlink:href="10.1109/PES.2010.5589605" ext-link-type="doi">https://doi.org/10.1109/PES.2010.5589605</ext-link></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">You S, Træholt C, Poulsen B (2009) Generic virtual power plants: Management of distributed energy resources under liberalized electricity market. In: 8th International Conference on Advances in Power System Control, Operation and Management (APSCOM 2009). IET, pp 1–6. <ext-link xlink:href="10.1049/cp.2009.1764" ext-link-type="doi">https://doi.org/10.1049/cp.2009.1764</ext-link></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Nakamoto S (2008) Bitcoin: a peer-to-peer electronic cash system. White Paper. <ext-link xlink:href="10.2139/ssrn.3440802" ext-link-type="doi">https://doi.org/10.2139/ssrn.3440802</ext-link>.</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Watanabe H, Fujimura S, Nakadaira A, Miyazaki Y, Akutsu A, Kishigami JJ (2015) Blockchain contract: A complete consensus using blockchain. In: 2015 IEEE 4th Global Conference on Consumer Electronics (GCCE). IEEE, pp 577–578. <ext-link xlink:href="10.1109/GCCE.2015.7398721" ext-link-type="doi">https://doi.org/10.1109/GCCE.2015.7398721</ext-link></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Unguru M (2018) Blockchain technology: opportunities for the energy sector. Euroinfo 2(1):53–58. <ext-link xlink:href="https://ideas.repec.org/a/iem/eurinf/v2y2018i1p53-58.html" ext-link-type="uri">https://ideas.repec.org/a/iem/eurinf/v2y2018i1p53-58.html</ext-link>.</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Burger C, Kuhlmann A, Richard P, Weinmanm J (2016) Blockchain in the energy transition. A survey among decisionmakers in the German energy industry, DENA German Energy Agency 60. <ext-link xlink:href="https://www.researchgate.net/publication/341441255_Blockchain_in_the_energy_transition_A_survey_among_decisionmakers_in_the_German_energy_industry" ext-link-type="uri">https://www.researchgate.net/publication/341441255_Blockchain_in_the_energy_transition_A_survey_among_decisionmakers_in_the_German_energy_industry</ext-link>.</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Hasse F, von Perfall A, Hillebrand T, Smole E, Lay L, Charlet M (2016) Blockchain–an opportunity for energy producers and consumers. PwC Global Power Util:1–45. <ext-link xlink:href="https://www.pwc.com/ca/en/power-utilities/publications/pwc-blockchainopportunity-for-energy-producers-and-consumers-2016-11-en.pdf" ext-link-type="uri">https://www.pwc.com/ca/en/power-utilities/publications/pwc-blockchainopportunity-for-energy-producers-and-consumers-2016-11-en.pdf</ext-link>.</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Q</given-names></name><name><surname>Ai</surname><given-names>Q</given-names></name></person-group><article-title xml:lang="en">Application Prospect of Block Chain Technology in Virtual Power Plant</article-title><source>Electr Energy Manag Technol</source><year>2017</year><volume>41</volume><issue>3</issue><fpage>14</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.16628/j.cnki.2095-8188.2017.03.003</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Galici M, Ghiani E, Troncia M, Pisano G, Pilo F (2019) A cyber-physical platform for simulating energy transactions in local energy markets. In: 2019 IEEE Milan PowerTech. IEEE, pp 1–6. <ext-link xlink:href="10.1109/PTC.2019.8810656" ext-link-type="doi">https://doi.org/10.1109/PTC.2019.8810656</ext-link></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Lu J, Wu S, Cheng H, Xiang Z (2020) Smart contract for distributed energy trading in virtual power plants based on blockchain. Comput Intell. <ext-link xlink:href="10.1111/coin.12388" ext-link-type="doi">https://doi.org/10.1111/coin.12388</ext-link></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">An iterative two-layer optimization charging and discharging trading scheme for electric vehicle using consortium blockchain</article-title><source>IEEE Trans Smart Grid</source><year>2019</year><volume>11</volume><issue>3</issue><fpage>2627</fpage><lpage>2637</lpage><pub-id pub-id-type="doi">10.1109/TSG.2019.2958971</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Zeng S, Huo R, Huang D, Liu J, Wang S, W. Feng (2020) Overview of blockchain Technology: principle, progress and Application. J Commun 41(1): 134-151. <ext-link xlink:href="10.11959/j.issn.1000-436x.2020027" ext-link-type="doi">https://doi.org/10.11959/j.issn.1000-436x.2020027</ext-link></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Dai</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Du</surname><given-names>X</given-names></name><name><surname>Guizani</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Blockchain-Enhanced High-Confidence Energy Sharing in Internet of Electric Vehicles</article-title><source>IEEE Internet Things J</source><year>2020</year><volume>7</volume><issue>9</issue><fpage>7868</fpage><lpage>7882</lpage><pub-id pub-id-type="doi">10.1109/JIOT.2020.2992994</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Awerbuch S, Preston A (eds) (2012) The Virtual Utility: Accounting, Technology &amp; Competitive Aspects of the Emerging Industry. Springer Sci Bus Media Berlin. <ext-link xlink:href="10.1007/978-1-4615-6167-5" ext-link-type="doi">https://doi.org/10.1007/978-1-4615-6167-5</ext-link></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Yu</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Yuan</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Concept and development of virtual power plant</article-title><source>Autom Electr Power Syst</source><year>2013</year><volume>37</volume><issue>13</issue><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.7500/AEPS201210156</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pudjianto</surname><given-names>D</given-names></name><name><surname>Ramsay</surname><given-names>C</given-names></name><name><surname>Strbac</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Virtual power plant and system integration of distributed energy resources</article-title><source>IET Renew Power Gener</source><year>2017</year><volume>1</volume><issue>1</issue><fpage>10</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg:20060023</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Freeman D, Scott M, Teske E (2010) A taxonomy of pairing-friendly elliptic curves. J Cryptol 23(2): 224-280. 10.1007/ s00145-009-9048-z</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boneh</surname><given-names>D</given-names></name><name><surname>Goh</surname><given-names>EJ</given-names></name><name><surname>Nissim</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Evaluating 2-DNF Formulas on Ciphertexts</article-title><source>Theory of cryptography conference</source><year>2005</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name><fpage>325</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-30576-7_18</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Szabo N (1997) Formalizing and Securing Relationships on Public Networks. First Monday 2(9). <ext-link xlink:href="10.5210/fm.v2i9.548" ext-link-type="doi">https://doi.org/10.5210/fm.v2i9.548</ext-link></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Buterin V (2014) A next-generation smart contract and decentralized application platform. White Paper. <ext-link xlink:href="https://translatewhitepaper.com/wp-content/uploads/2021/04/EthereumOrijinal-ETH-English.pdf" ext-link-type="uri">https://translatewhitepaper.com/wp-content/uploads/2021/04/EthereumOrijinal-ETH-English.pdf</ext-link>.</mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Data Security Sharing and Storage Based on a Consortium Blockchain in a Vehicular Ad-hoc Network</article-title><source>IEEE Access</source><year>2019</year><volume>7</volume><fpage>58241</fpage><lpage>58254</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2018.2890736</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="other">Yu Y, Li Y, Tian J, Liu J (2018) Blockchain-Based Solutions to Security and Privacy Issues in the Internet of Things. IEEE Wireless Communications 25(6):12-18. <ext-link xlink:href="10.1109/MWC.2017.1800116" ext-link-type="doi">https://doi.org/10.1109/MWC.2017.1800116</ext-link>.</mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="other">Hropko D, Ivanecký J, Turček J (2012) Optimal dispatch of renewable energy sources included in Virtual power plant using Accelerated particle swarm optimization. In: 2012 ELEKTRO. IEEE, pp 196–200. <ext-link xlink:href="10.1109/ELEKTRO.2012.6225637" ext-link-type="doi">https://doi.org/10.1109/ELEKTRO.2012.6225637</ext-link></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Fang</surname><given-names>F</given-names></name><name><surname>Niu</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Review of virtual power plant</article-title><source>Proc CSEE</source><year>2014</year><volume>34</volume><issue>29</issue><fpage>5103</fpage><lpage>5111</lpage><pub-id pub-id-type="doi">10.13334/j.0258-8013.pcsee.2014.29.012</pub-id></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khaqqi</surname><given-names>KN</given-names></name><name><surname>Sikorski</surname><given-names>JJ</given-names></name><name><surname>Hadinoto</surname><given-names>K</given-names></name><name><surname>Kraft</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Incorporating seller/buyer reputation-based system in blockchain-enabled emission trading application</article-title><source>Appl Energy</source><year>2018</year><volume>209</volume><fpage>8</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2017.10.070</pub-id></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blaze</surname><given-names>M</given-names></name><name><surname>Bleumer</surname><given-names>G</given-names></name><name><surname>Strauss</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Divertible Protocols and Atomic Proxy Cryptography</article-title><source>International Conference on the Theory and Applications of Cryptographic Techniques</source><year>1998</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name><fpage>127</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1007/BFb0054122</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0929.68048</pub-id></mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>Y</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Key technologies of distributed energy trading based on blockchain</article-title><source>Autom Electr Power Syst</source><year>2019</year><volume>43</volume><issue>14</issue><fpage>53</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.7500/AEPS20181203010</pub-id></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>X</given-names></name><name><surname>Cao</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name><name><surname>Shao</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Attribute based proxy re-encryption with delegating capabilities</article-title><source>Proceedings of the 4th International Symposium on Information, Computer, and Communications Security</source><year>2009</year><fpage>276</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1145/1533057.1533094</pub-id></mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boneh</surname><given-names>D</given-names></name><name><surname>Boyen</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Efficient Selective-ID Secure Identity-Based Encryption Without Random Oracles</article-title><source>International conference on the theory and applications of cryptographic techniques</source><year>2004</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name><fpage>223</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-24676-3_14</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="other">Ongaro D, Ousterhout J (2014) In search of an understandable consensus algorithm. In: 2014 {USENIX} Annual Technical Conference ({USENIX}{ATC} 14), pp 305–319. <ext-link xlink:href="https://www.usenix.org/conference/atc14/technical-sessions/presentation/ongaro" ext-link-type="uri">https://www.usenix.org/conference/atc14/technical-sessions/presentation/ongaro</ext-link>.</mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Luo</surname><given-names>W</given-names></name><name><surname>Qin</surname><given-names>Z</given-names></name><name><surname>Yuan</surname><given-names>D</given-names></name><name><surname>Zou</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Attribute-based proxy re-encryption scheme with multiple features</article-title><source>J Commun</source><year>2019</year><volume>40</volume><issue>6</issue><fpage>177</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.11959/j.issn.1000-436x.2019127</pub-id></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Obour Agyekum</surname><given-names>KOB</given-names></name><name><surname>Xia</surname><given-names>Q</given-names></name><name><surname>Sifah</surname><given-names>EB</given-names></name><name><surname>Gao</surname><given-names>J</given-names></name><name><surname>Xia</surname><given-names>H</given-names></name><name><surname>Du</surname><given-names>X</given-names></name><name><surname>Guizani</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">A Secured Proxy-Based Data Sharing Module in IoT Environments Using Blockchain</article-title><source>Sensors</source><year>2019</year><volume>19</volume><issue>5</issue><fpage>1235</fpage><pub-id pub-id-type="doi">10.3390/s19051235</pub-id></mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Secure Data Sharing and Customized Services for Intelligent Transportation Based on a Consortium Blockchain</article-title><source>IEEE Access</source><year>2020</year><volume>8</volume><fpage>56045</fpage><lpage>56059</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2020.2981945</pub-id></mixed-citation></ref></ref-list></ref-list><notes notes-type="Misc"><title>Publisher’s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Computer Communication Networks</facet-value><facet-value count="1">Computer Science</facet-value><facet-value count="1">Computer System Implementation</facet-value><facet-value count="1">Computer Systems Organization and Communication Networks</facet-value><facet-value count="1">Information Systems Applications (incl.Internet)</facet-value><facet-value count="1">Software Engineering/Programming and Operating Systems</facet-value><facet-value count="1">Special Purpose and Application-Based Systems</facet-value></facet><facet name="keyword"><facet-value count="1">Continuous double auction</facet-value><facet-value count="1">Distributed energy resources</facet-value><facet-value count="1">Hybrid proxy re-encryption</facet-value><facet-value count="1">Reputation</facet-value><facet-value count="1">Virtual power plant</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Cloud Computing</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value><facet-value count="1">Iran</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
