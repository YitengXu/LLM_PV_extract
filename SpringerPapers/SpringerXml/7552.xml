<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s10825-022-01988-5</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">10825</journal-id><journal-id journal-id-type="doi">10.1007/10825.1572-8137</journal-id><journal-title-group><journal-title>Journal of Computational Electronics</journal-title><abbrev-journal-title abbrev-type="publisher">J Comput Electron</abbrev-journal-title></journal-title-group><issn pub-type="ppub">1569-8025</issn><issn pub-type="epub">1572-8137</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s10825-022-01988-5</article-id><article-id pub-id-type="manuscript">1988</article-id><article-id pub-id-type="doi">10.1007/s10825-022-01988-5</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">IonMonger 2.0: software for free, fast and versatile simulation of current, voltage and impedance response of planar perovskite solar cells</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1629-9698</contrib-id><name><surname>Clarke</surname><given-names>Will</given-names></name><address><email>wc3g16@soton.ac.uk</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs10825022019885_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Bennett</surname><given-names>Laurence J.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Grudeva</surname><given-names>Yoana</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Foster</surname><given-names>Jamie M.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Richardson</surname><given-names>Giles</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au6"><name><surname>Courtier</surname><given-names>Nicola E.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5491.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9297</institution-id><institution content-type="org-division">Mathematical Sciences</institution><institution content-type="org-name">University of Southampton</institution></institution-wrap><addr-line content-type="city">Southampton</addr-line><country country="GB">UK</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution content-type="org-division">Engineering Science</institution><institution content-type="org-name">University of Oxford</institution></institution-wrap><addr-line content-type="city">Oxford</addr-line><country country="GB">UK</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.4701.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0728 6636</institution-id><institution content-type="org-division">Mathematics and Physics</institution><institution content-type="org-name">University of Portsmouth</institution></institution-wrap><addr-line content-type="city">Portsmouth</addr-line><country country="GB">UK</country></aff></contrib-group><author-notes><corresp id="IDs10825022019885_cor1"><label>a</label><email>wc3g16@soton.ac.uk</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>30</day><month>11</month><year>2022</year></pub-date><pub-date date-type="pub" publication-format="print"><month>2</month><year>2023</year></pub-date><volume>22</volume><issue seq="33">1</issue><fpage>364</fpage><lpage>382</lpage><history><date date-type="registration"><day>17</day><month>11</month><year>2022</year></date><date date-type="received"><day>27</day><month>9</month><year>2022</year></date><date date-type="accepted"><day>15</day><month>11</month><year>2022</year></date><date date-type="online"><day>30</day><month>11</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">The second generation of the open-source MATLAB-based software tool IonMonger, for solving drift–diffusion models of charge transport in planar perovskite solar cells, is presented here. This version is based upon a generalisation of the original drift–diffusion model of charge carrier and ion motion in the perosvkite cell, as described in Courtier (J Comput Electron 18:1435–1449, 2019). The generalised model has the flexibility to capture (1) non-Boltzmann statistics of charge carriers in the transport layers, (2) steric effects for the ions in the perovskite layer, (3) generation of charge carriers from light made up of a spectrum of different wavelengths and, (4) Auger recombination. The updated software is significantly more stable than the original version and also adds the ability to simulate impedance spectroscopy measurements as well as transient voltage and/or illumination protocols. In addition, it is fully backwards compatible with the original version and displays improved performance through refinement of the underlying numerical methods. Furthermore, the software has been made accessible to a wider user base by the addition of IonMonger Lite, a version that leverages MATLAB’s live scripts and eliminates the need for a detailed knowledge of MATLAB’s syntax.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Perovskite solar cell</kwd><kwd>Drift–diffusion</kwd><kwd>Device simulation</kwd><kwd>Ion migration</kwd><kwd>Impedance spectroscopy</kwd><kwd>IonMonger</kwd><kwd>MATLAB</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Engineering and Physical Sciences Research Council</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100000266</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">EP/V520056/1</award-id><award-id award-type="FundRef grant">EP/L01551X/1</award-id><principal-award-recipient><name><surname>Clarke</surname><given-names>Will</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>Bennett</surname><given-names>Laurence J.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>52</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>Springer Science+Business Media, LLC, part of Springer Nature</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>11</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>17</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/10825_2022_Article_1988.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical and Computational Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Electrical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Theoretical, Mathematical and Computational Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Optical and Electronic Materials</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mechanical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1007/s10825-022-01988-5" ext-link-type="doi">https://doi.org/10.1007/s10825-022-01988-5</ext-link>.</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Over the past decade, charge transport modelling of perovskite solar cells (PSCs) has improved to a point where it can not only qualitatively reproduce most of the observed responses of these devices to a wide variety of experimental protocols but is also close to being predictive. Nevertheless there remain challenges, not only with the formulation of the charge transport model, but also with its accurate solution in parameter regimes of interest. The first published numerical scheme capable of solving such a model in relevant parameter regimes was presented in [<xref ref-type="bibr" rid="CR20">20</xref>], while open source<xref ref-type="fn" rid="Fn1">1</xref> software was made available only relatively recently by Courtier et al. [<xref ref-type="bibr" rid="CR19">19</xref>] and Calado et al. [<xref ref-type="bibr" rid="CR13">13</xref>]. The aim of this work is to publicise and describe an updated, and improved, version of the first of these two software packages.</p><p id="Par3">The original version of the perovskite solar cell (PSC) simulation tool IonMonger [<xref ref-type="bibr" rid="CR19">19</xref>] has been successfully used by numerous groups to simulate charge transport and cell performance in these devices. The main goal of the continuum models that IonMonger solves is to improve the understanding of PSCs and to predict device behaviour from its underlying physical properties. For example, IonMonger enables investigation of the effects of altering properties such as charge carrier diffusion lengths and recombination rates on current–voltage (or power) output. IonMonger includes a fully-coupled conservation equation for mobile ion migration in the perovskite layer of a three-layer PSC (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>), which has been shown to play a dominant role in device behaviour [<xref ref-type="bibr" rid="CR67">67</xref>], including steady-state performance [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Schematic of the basic drift–diffusion model of a planar PSC upon which IonMonger v1.0 was based. The continuum variables modelled in each layer are shown. Carrier generation is assumed to occur only in the perovskite and recombination in the perovskite and at the interfaces between the perovskite and the transport layers</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par4">Simulation results obtained using IonMonger have enabled researchers to tackle a variety of questions relating to the performance and design of PSCs. Examples of such work include: (1) Cave et al. [<xref ref-type="bibr" rid="CR15">15</xref>] demonstrated how to determine activation energies for ion vacancy migration in different perovskite compositions using the information contained in current–voltage (JV) measurements; (2) Courtier [<xref ref-type="bibr" rid="CR17">17</xref>] used IonMonger to verify a novel theory, termed the ectypal diode theory, for the steady-state performance of a PSC, which is notable for its inclusion of mobile ions; (3) Bennett et al. [<xref ref-type="bibr" rid="CR8">8</xref>] extended this theory to describe the electrochemical impedance response of a PSC and identify a measurable value, analogous to the ideality factor for conventional solar cells, that may be used to diagnose the limiting form of recombination; (4) Riquelme, Castro-Chong, Anta and co-workers [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>] validated this approach by investigating trends in impedance spectra using a combination of IonMonger simulations and investigation of experimental measurements; (5) Diekmann, Le Corre, Stolterfoht and colleagues used IonMonger to study the maximum efficiencies attainable from PSCs incorporating mobile ions in the perovskite layer [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR42">42</xref>], concluding that the presence of mobile ions is detrimental to power conversion efficiency (PCE); (6) Cordoba et al. [<xref ref-type="bibr" rid="CR21">21</xref>] and Lin [<xref ref-type="bibr" rid="CR45">45</xref>] evaluated another metric, namely the open-circuit voltage. Lin also simulated the impact of mobile ions on the short-circuit current [<xref ref-type="bibr" rid="CR46">46</xref>]. (7) Li et al. [<xref ref-type="bibr" rid="CR43">43</xref>] showed how ion migration can explain the light-soaking phenomenon observed in experiment [<xref ref-type="bibr" rid="CR65">65</xref>]; and (8) García-Rodríguez et al. demonstrated that inverted hysteresis can be explained by the drift–diffusion model, comparing IonMonger simulations to experiment [<xref ref-type="bibr" rid="CR27">27</xref>].</p><p id="Par5">Despite the undoubted success of IonMonger v1.0, and its growing user base, significant issues with its performance and capabilities have been brought to our attention by its early users; these have motivated the improvements to the numerical solver described in this work. Chief amongst the issues identified, and addressed here, are problems with the stability of the code. In addition to performance issues the validity of the Boltzmann model for charge carrier dynamics in the transport layers (particularly where these are composed of organic materials) has been called into question. This has motivated an extension to IonMonger which allows for non-Boltzmann models of the transport layer charge carrier dynamics. From a practical perspective, many experiments are performed with white light and therefore IonMonger v2.0 incorporates a model of charge carrier generation based on multiple wavelength illumination. Furthermore, adapting IonMonger v1.0 to simulate impedance experiments is cumbersome and so version 2.0 includes a module that allows impedance plots to be generated automatically and efficiently.</p><p id="Par6">A development cycle similar to IonMonger’s is being carried out to great effect in the field of lithium-ion battery modelling, by the PyBaMM community [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR59">59</xref>]. This builds upon collaborations both within academia and between academia and industry in order to accelerate R &amp;D and serves as a model for the future path of IonMonger. In order to progress towards the ultimate goal of developing stable and commercially viable PSCs, further advances in our understanding of the interplay between ionic and electronic mechanisms, including their effects on degradation, are required. It is envisaged that this goal can be furthered by providing sophisticated and easy-to-use open-source modelling tools [<xref ref-type="bibr" rid="CR61">61</xref>]. As such, IonMonger 2.0 includes a host of advanced features along with a new user-friendly interface.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>A list of the model extensions offered as part of IonMonger 2.0 and the additional functions or parameters that must be specified to use each extension</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Model extension</p></th><th align="left"><p>Extra function/parameter</p></th><th align="left"><p>Symbol</p></th><th align="left"><p>Name</p></th><th align="left"><p>Default value</p></th><th align="left"><p>Unit</p></th></tr></thead><tbody><tr><td align="left"><p>Non-Boltzmann</p></td><td align="left"><p>ETL statistical integral</p></td><td align="left"><p><inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq1.gif"/></alternatives></inline-formula></p></td><td align="left"><p>SE</p></td><td align="left"><p><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mo>exp</mml:mo></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exp$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq2.gif"/></alternatives></inline-formula></p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>statistical models</p></td><td align="left"/><td align="left"><p><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{E}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq3.gif"/></alternatives></inline-formula></p></td><td align="left"><p>SEinv</p></td><td align="left"><p><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mo>ln</mml:mo></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq4.gif"/></alternatives></inline-formula></p></td><td align="left"><p>–</p></td></tr><tr><td align="left"/><td align="left"><p>HTL statistical integral</p></td><td align="left"><p><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq5.gif"/></alternatives></inline-formula></p></td><td align="left"><p>SH</p></td><td align="left"><p><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mo>exp</mml:mo></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exp$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq6.gif"/></alternatives></inline-formula></p></td><td align="left"><p>–</p></td></tr><tr><td align="left"/><td align="left"/><td align="left"><p><inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{H}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq7.gif"/></alternatives></inline-formula></p></td><td align="left"><p>SHinv</p></td><td align="left"><p><inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mo>ln</mml:mo></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq8.gif"/></alternatives></inline-formula></p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Steric effects</p></td><td align="left"><p>Form of ion vacancy flux</p></td><td align="left"><p><inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msup><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F^P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq9.gif"/></alternatives></inline-formula></p></td><td align="left"><p>NonlinearFP</p></td><td align="left"><p>N/A</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"/><td align="left"><p>Maximum vacancy density</p></td><td align="left"><p><inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq10.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Plim</p></td><td align="left"><p>N/A</p></td><td align="left"><p>m<inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq11.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p>Immobile ions</p></td><td align="left"><p>Ionic diffusion coefficient</p></td><td align="left"><p><inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\textrm{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq12.gif"/></alternatives></inline-formula></p></td><td align="left"><p>DI</p></td><td align="left"><p>N/A</p></td><td align="left"><p>m<inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq13.gif"/></alternatives></inline-formula> s<inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq14.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p>Absorption spectra</p></td><td align="left"><p>Generation rate</p></td><td align="left"><p><italic>G</italic>(<italic>x</italic>, <italic>t</italic>)</p></td><td align="left"><p>G</p></td><td align="left"><p>Eq. (<xref rid="Equ36" ref-type="disp-formula">31</xref>)</p></td><td align="left"><p>m<inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq15.gif"/></alternatives></inline-formula> s<inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq16.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p>Auger recombination</p></td><td align="left"><p>Electron-dominated rate</p></td><td align="left"><p><inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq17.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Augn</p></td><td align="left"><p>0</p></td><td align="left"><p>m<inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msup><mml:mrow/><mml:mn>6</mml:mn></mml:msup></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^6$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq18.gif"/></alternatives></inline-formula> s<inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq19.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"/><td align="left"><p>Hole-dominated rate</p></td><td align="left"><p><inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq20.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Augp</p></td><td align="left"><p>0</p></td><td align="left"><p>m<inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msup><mml:mrow/><mml:mn>6</mml:mn></mml:msup></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^6$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq21.gif"/></alternatives></inline-formula> s<inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq22.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p>TL/metal band offsets</p></td><td align="left"><p>Cathode workfunction</p></td><td align="left"><p><inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>ct</mml:mtext></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{ct}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq23.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Ect</p></td><td align="left"><p><inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{f}^\textrm{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq24.gif"/></alternatives></inline-formula></p></td><td align="left"><p>eV</p></td></tr><tr><td align="left"/><td align="left"><p>Anode workfunction</p></td><td align="left"><p><inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>an</mml:mtext></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{an}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq25.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Ean</p></td><td align="left"><p><inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{f}^\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq26.gif"/></alternatives></inline-formula></p></td><td align="left"><p>eV</p></td></tr><tr><td align="left"><p>Parasitic resistances</p></td><td align="left"><p>Series resistance</p></td><td align="left"><p><inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\textrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq27.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Rs</p></td><td align="left"><p>0</p></td><td align="left"><p>Ohm</p></td></tr><tr><td align="left"/><td align="left"><p>Shunt/parallel resistance</p></td><td align="left"><p><inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\textrm{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq28.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Rp</p></td><td align="left"><p>Inf</p></td><td align="left"><p>Ohm</p></td></tr><tr><td align="left"/><td align="left"><p>Cell area</p></td><td align="left"><p><italic>A</italic></p></td><td align="left"><p>Acell</p></td><td align="left"><p>1</p></td><td align="left"><p>cm<inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq29.gif"/></alternatives></inline-formula></p></td></tr></tbody></table><table-wrap-foot><p>Six choices for the statistical functions are provided, see Sect. <xref rid="Sec4" ref-type="sec">3</xref>/Table <xref rid="Tab2" ref-type="table">2</xref>. If such parameters are not specified in the parameters.m file, then the default value is used and this is equivalent to simulating the model without the extension</p></table-wrap-foot></table-wrap></p><p id="Par7">Favourable comparisons have been made between IonMonger 1.0 and alternative simulation software such as Driftfusion [<xref ref-type="bibr" rid="CR13">13</xref>], SCAPS (without mobile ions) [<xref ref-type="bibr" rid="CR23">23</xref>] and a Python implementation of the IonMonger model [<xref ref-type="bibr" rid="CR6">6</xref>]. As a consensus has not yet been reached on the correct model of charge transport in PSCs, it is vital that simulation software is open source to allow users to investigate the many proposed extensions to the model. The code presented in this paper, therefore is, to our knowledge, the most advanced open-source software for the simulation of charge transport and ion migration in standard three-layer planar PSCs available to-date.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p><bold>a</bold> A schematic of a planar perovskite solar cell (PSC) with new additions to the IonMonger charge transport model labelled by green arrows. <bold>b</bold> A circuit representation for a PSC with series and shunt resistance. Here, the circle labelled “PSC” is used as a symbol for the current–voltage (<inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq30.gif"/></alternatives></inline-formula>–<inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq31.gif"/></alternatives></inline-formula>) relation determined from a charge transport model for the motion of electrons, holes and halide ion vacancies in a PSC (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par8">In the next section, Sect. <xref rid="Sec2" ref-type="sec">2</xref>, we introduce the impedance spectroscopy module, outlining its features and giving a cursory introduction to its use in practice (a full set of instructions are given in the users’ guide). Subsequently, in Sect. <xref rid="Sec4" ref-type="sec">3</xref>, we describe how the charge transport model has been extended to incorporate non-Boltzmann statistical models in the description of the transport layers. In Sect. <xref rid="Sec12" ref-type="sec">4</xref>, we discuss how steric effects have been accounted for in the equations defining the ion vacancy flux. The purpose of Sect. <xref rid="Sec15" ref-type="sec">5</xref> is to introduce the remaining extensions to the charge transport model, namely; generation from light comprising a spectrum of wavelengths, Auger recombination, immobile ion distributions, parasitic series and shunt resistances (by embedding the charge transport model within an equivalent circuit), and metal contact band offsets. In Sect. <xref rid="Sec21" ref-type="sec">6</xref>, an introduction to IonMonger Lite is given. The penultimate section, Sect. <xref rid="Sec23" ref-type="sec">7</xref>, includes details of the improved numerical methods which give rise to better code performance, and how backwards compatibility with IonMonger 1.0 has been ensured. In Sect. <xref rid="Sec30" ref-type="sec">8</xref> we draw our conclusions.</p><p id="Par9">A complete statement of the charge transport model (system of PDEs) being solved in IonMonger 2.0 is given in “<xref rid="Sec31" ref-type="sec">Appendix</xref>”. A schematic diagram showing the new additions to the model is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and these additions are listed in Table <xref rid="Tab1" ref-type="table">1</xref>.</p></sec><sec id="Sec2"><title>Impedance spectroscopy module</title><p id="Par10">Electrochemical impedance spectroscopy (IS) is a measurement technique that is widely used in the study of electrochemical systems [<xref ref-type="bibr" rid="CR51">51</xref>]; including in batteries [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR63">63</xref>] and fuel cells [<xref ref-type="bibr" rid="CR32">32</xref>], where it is used to study corrosion and plating [<xref ref-type="bibr" rid="CR38">38</xref>] and solar cells [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR56">56</xref>] where it can be used to identify efficiency and monitor degradation. It is a particularly useful technique as it is non-destructive and relatively easy to perform both in the lab and in the field. In the context of PSCs, the interpretation of results is still relatively poorly understood, because of the novel complicating feature of ion motion, in addition to charge carrier motion. This motivates the need for accurate impedance simulations from a well-founded drift–diffusion model of the cell.</p><p id="Par11">IS is performed by perturbing a device from steady state by applying a low-amplitude voltage oscillation (over a range of frequencies) and measuring the current response. This elicits valuable information due to the different physical processes stimulated at different frequencies, allowing their effects to be disentangled. The applied voltage typically consists of a constant (or ‘DC’) component and a sinusoidal (or ‘AC’) component,<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>DC</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V(t) = V_\text {DC} + V_\textrm{p} \sin (\omega t), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ1.gif"/></alternatives></disp-formula>where <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>DC</mml:mtext></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\text {DC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq32.gif"/></alternatives></inline-formula> is the steady-state voltage, and <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mi>ω</mml:mi></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq34.gif"/></alternatives></inline-formula> are the amplitude and the angular frequency of the voltage perturbation, respectively. Keeping the amplitude of the voltage perturbation small (here, typically, <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;20$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq35.gif"/></alternatives></inline-formula> mV) ensures that the current response is an approximately linear function of the applied voltage, taking the general form<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mtext>DC</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J(t) = J_\text {DC} + J_{p}(\omega ) \sin (\omega t - \theta (\omega )), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ2.gif"/></alternatives></disp-formula>where <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>J</mml:mi><mml:mtext>DC</mml:mtext></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_\text {DC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq36.gif"/></alternatives></inline-formula> is the steady-state current, <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq37.gif"/></alternatives></inline-formula> is the amplitude of the sinusoidal component and <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mi>θ</mml:mi></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq38.gif"/></alternatives></inline-formula> is the phase relative to the voltage. The complex impedance, <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq39.gif"/></alternatives></inline-formula>, is the ratio between the complex representation of the voltage perturbation and that of the current, i.e.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Z(\omega ) = \frac{V_\textrm{p}}{J_{p}(\omega )}\, e^{i \theta (\omega )}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ3.gif"/></alternatives></disp-formula><fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Decomposition of complex impedance into real and imaginary components with projections onto each of the three planes</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig3_HTML.png" id="MO6"/></fig></p><p id="Par12">A so-called impedance spectrum (i.e. the impedance as a function of frequency, <italic>f</italic>) is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. It is common to decompose the impedance into its real and imaginary components; i.e. the resistance <italic>R</italic> and the reactance <italic>X</italic>, respectively, such that <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z(\omega ) = R(\omega ) + iX(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq40.gif"/></alternatives></inline-formula>. The projection of a complex impedance curve onto the <italic>R</italic>-<italic>X</italic> plane forms a Nyquist plot, as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. Nyquist plots restrict the frequency information that is displayed. Therefore, it is useful to display impedance spectra as their projection into the <italic>R</italic>-<italic>f</italic> and <italic>X</italic>-<italic>f</italic> planes, referred to here as frequency plots (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Other representations of impedance such as Bode or capacitance plots can also be used to explicitly show the frequency dependence.</p><p id="Par13">Generally, the impedance spectra of PSCs exhibit two semicircles on a Nyquist plot, one low- and one high-frequency feature. The two features indicate that there are (at least) two species of mobile charge (electronic charges and ionic charges) in a typical PSC [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR54">54</xref>]. The high-frequency feature excludes the transient effects of the slow-moving ionic charge and enables information to be obtained about the sources of electron and hole recombination (via the electronic ideality factor as defined in Bennett et al. [<xref ref-type="bibr" rid="CR8">8</xref>]). The low-frequency feature captures how ions impact the cell response and provides information on the potential barrier to recombination (via the ectypal factor as defined in [<xref ref-type="bibr" rid="CR17">17</xref>]) as well as the density and mobility of the ionic species [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR54">54</xref>]. In addition to the low- and high-frequency features, other features have been observed in the Nyquist plots of impedance spectra for PSCs. For example, these include a third semicircle [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] or a loop between the low- and high-frequency features [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. These less common features observed in experiment are reproduced by IonMonger for particular parameter regimes.</p><sec id="Sec3"><title>Simulating impedance spectra</title><p id="Par14">IonMonger allows users to perform virtual IS measurements analogous to those performed by experiment. The voltage protocol is created via the applied_voltage input specified in the parameters file. An impedance simulation consists of the following steps. First, the cell is allowed to equilibrate at the DC voltage, thereby locating steady-state. IonMonger autonomously detects when the steady-state solution has been reached. This solution is then used as initial conditions for the transient stimulation at each different frequency. IonMonger then iterates over all sample frequencies, simulating the response to each voltage perturbation. Thus, an impedance protocol can be specified by six parameters: the minimum and maximum frequencies, the DC applied voltage, the AC voltage amplitude, the number of frequencies to be sampled and the number of complete periods to simulate. Detailed information on how to construct an impedance protocol from these six parameters can be found in the user guide (GUIDE.md).<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p><bold>a</bold> Nyquist and <bold>b</bold> frequency plots calculated using the template parameter set</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig4_HTML.png" id="MO7"/></fig></p><p id="Par15">The resulting structure array of solutions (one for each frequency) is passed to impedance_analysis.m to compute the impedance as a function of frequency. This is achieved by extracting the final two periodic cycles of the current density (at each frequency) and fitting a sinusoid to the data using FourierFit.m.</p><p id="Par16">IS simulations are computed using the same numerical solver as transient simulations, meaning they not only achieve the same speed and accuracy, but are also fully compatible with additions to the charge transport model (detailed in Sects. <xref rid="Sec4" ref-type="sec">3</xref>, <xref rid="Sec12" ref-type="sec">4</xref>, <xref rid="Sec15" ref-type="sec">5</xref>). If MATLAB’s Parallel Computing toolbox is installed, the iterations will be executed on multiple parallel workers, decreasing the compute time. The impedance spectra shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, are each made up of 100 sample frequencies and took an average time of 48.7s to compute on a desktop computer with a six-core Ryzen 5 5600X CPU. Functions for plotting IS simulations are detailed in Sect. <xref rid="Sec27" ref-type="sec">7.3</xref>.</p></sec></sec><sec id="Sec4"><title>Carrier statistics in the transport layers</title><p id="Par17">In previous versions of IonMonger, electronic carriers in all three layers were assumed to follow Boltzmann statistics, as is common in semiconductor modelling. However, this assumption, in the context of PSCs, has been called into question by recent works [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR61">61</xref>]. It is known that this assumption is not justified in the case of highly doped and/or organic materials, such as the transport layers [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR60">60</xref>]. To rectify this, IonMonger now allows carriers to be governed by more general band models, with the option of either a Fermi–Dirac or Boltzmann distribution. In this section we discuss the physical origin of statistical models and the specific options available in IonMonger 2.0 (see Table <xref rid="Tab2" ref-type="table">2</xref>).</p><sec id="Sec5"><title>General statistical models</title><p id="Par18">The density of free conduction electrons in a semiconductor is the product of the statistical distribution, <italic>f</italic>(<italic>E</italic>), and the conduction band density of states (DoS), <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>c</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{g}}_\textrm{c}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq41.gif"/></alternatives></inline-formula>, integrated across all energies, i.e.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>c</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n = \int _{-\infty }^\infty f(E) {\hat{g}}_\textrm{c}(E) \textrm{d}E. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ4.gif"/></alternatives></disp-formula>Similarly, the density of valence band holes is<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>v</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p = \int _{-\infty }^\infty (1-f(E)) {\hat{g}}_\textrm{v}(E) \textrm{d}E. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ5.gif"/></alternatives></disp-formula>These integrals (referred to as statistical integrals) define a relationship between carrier densities and quasi-Fermi levels. As Fermions, electrons adhere to a Fermi–Dirac statistical distribution [<xref ref-type="bibr" rid="CR48">48</xref>], defined as<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(E) = \frac{1}{\exp \left( \frac{E-E_\textrm{f}}{k_BT}\right) +1}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ6.gif"/></alternatives></disp-formula>where <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq42.gif"/></alternatives></inline-formula> is the Fermi level. In semiconductor modelling, it is common to approximate <italic>f</italic>(<italic>E</italic>) by a Boltzmann distribution [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR61">61</xref>], and assume that the DoS is parabolic, resulting in the familiar densities<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>n</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n&amp;= g_\textrm{c} \, \exp \left( \frac{E_{\textrm{f}_n}-E_{\textrm{c}}}{k_BT} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>p</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p&amp;= g_\textrm{v} \, \exp \left( - \frac{E_{\textrm{f}_{p}} - E_\textrm{v}}{k_BT} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ8.gif"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{\textrm{c},\textrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq43.gif"/></alternatives></inline-formula> are the effective densities of states for the conduction and valence bands, respectively, <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{f}_{n,p}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq44.gif"/></alternatives></inline-formula> are the electron and hole quasi-Fermi levels (QFLs), and <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c},\textrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq45.gif"/></alternatives></inline-formula> are band edges. This is known as the Boltzmann approximation. Employing a statistical integral that is analytical, differentiable and invertible results in drift–diffusion equations that are significantly easier to solve, leading to widespread adoption of the Boltzmann approximation in semiconductor modelling, including the charge transport model upon which previous versions of IonMonger were based.</p><p id="Par19">However, the Boltzmann distribution fails as an approximation to the Fermi–Dirac distribution in the case of materials with high doping levels and/or non-parabolic band shapes, motivating a more general approach. Carrier densities in a general statistical model are given by [<xref ref-type="bibr" rid="CR29">29</xref>] <disp-formula id="Equ9"><label>9a</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>n</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">S</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n&amp;= g_\textrm{c} \, {\mathcal {S}}\left( \frac{E_{\textrm{f}_n}-E_{\textrm{c}}}{k_BT} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ9.gif"/></alternatives></disp-formula><disp-formula id="Equ10"><label>9b</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>p</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">S</mml:mi><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p&amp;= g_\textrm{v} \, {\mathcal {S}}\left( - \frac{E_{\textrm{f}_{p}} - E_\textrm{v}}{k_BT} \right) ,\end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ10.gif"/></alternatives></disp-formula> where <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mi mathvariant="script">S</mml:mi></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq46.gif"/></alternatives></inline-formula> is the statistical integral. The energies <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{v}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq48.gif"/></alternatives></inline-formula> will henceforth be referred to as reference energies to account for DoS functions that do not possess the same defined edge as parabolic bands.</p><p id="Par20">Electron and hole currents in a semiconductor are driven by gradients in their quasi-Fermi levels, meaning the current densities are defined as<disp-formula id="Equ11"><label>10</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} j^n&amp;= \mu _n n \frac{\partial }{\partial x} E_{\textrm{f}_n},&amp;j^p&amp;= \mu _{p} p \frac{\partial }{\partial x} E_{\textrm{f}_{p}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ11.gif"/></alternatives></disp-formula>where <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq50.gif"/></alternatives></inline-formula> are the electron and hole mobilities, respectively. By rearranging (<xref rid="Equ9" ref-type="disp-formula">9</xref>), the quasi-Fermi levels can be written as functions of carrier density, <disp-formula id="Equ12"><label>11a</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E_{\textrm{f}_n}&amp;= E_{\textrm{c}} + k_BT {\mathcal {S}}^{-1} \left( \frac{n}{g_\textrm{c}} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ12.gif"/></alternatives></disp-formula><disp-formula id="Equ13"><label>11b</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E_{\textrm{f}_{p}}&amp;= E_\textrm{v} - k_BT {\mathcal {S}}^{-1} \left( \frac{p}{g_\textrm{v}} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ13.gif"/></alternatives></disp-formula> where <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq51.gif"/></alternatives></inline-formula> is the inverse of <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mi mathvariant="script">S</mml:mi></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq52.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mo>·</mml:mo></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {S}}\big ( {\mathcal {S}}^{-1} (\cdot ) \big ) \equiv \cdot }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq53.gif"/></alternatives></inline-formula>. The reference energies, <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c},\textrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq54.gif"/></alternatives></inline-formula>, are dependent on the local electric potential, leading to the phenomenon known as band-bending. Specifically, we assume that the reference energies take the form <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>const.</mml:mtext><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c},\textrm{v}} = \text {const.} - q \phi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq55.gif"/></alternatives></inline-formula>. Combined with (<xref rid="Equ12" ref-type="disp-formula">11</xref>), this allows one to express the electronic current densities as functions of carrier density and electric potential,<disp-formula id="Equ14"><label>12</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^n}&amp;= \mu _nk_BTn\frac{\partial }{\partial x} \left[ {\mathcal {S}}^{-1}\left( \frac{n}{g_\textrm{c}}\right) - \frac{q\phi }{k_BT}\right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>13</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^p}&amp;= -\mu _{p}k_BTp\frac{\partial }{\partial x} \left[ {\mathcal {S}}^{-1}\left( \frac{p}{g_\textrm{v}}\right) + \frac{q\phi }{k_BT}\right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ15.gif"/></alternatives></disp-formula>Note that if carriers are assumed to be Boltzmann distributed in parabolic bands, the statistical integral is simply <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\cdot ) = \exp (\cdot )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq56.gif"/></alternatives></inline-formula> and the familiar expressions for current density,<disp-formula id="Equ16"><label>14</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qn</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^n}&amp;= \mu _n k_BT \left[ \frac{\partial n}{\partial x} - \frac{qn}{k_BT} \frac{\partial \phi }{\partial x} \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>15</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qp</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^p}&amp;= -\mu _{p} k_BT \left[ \frac{\partial p}{\partial x} + \frac{qp}{k_BT} \frac{\partial \phi }{\partial x} \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ17.gif"/></alternatives></disp-formula>are recovered.</p></sec><sec id="Sec6"><title>Statistical models in the PSC model</title><p id="Par21">Carrier densities in the transport layers (TLs) of PSCs are typically several orders of magnitude larger than in the perovskite layer due to high effective doping levels and the band offsets between the layers. For this reason, the Boltzmann approximation cannot be guaranteed to be accurate in these layers and we adapt the charge transport model to allow for some general (possibly non-Boltzmann) statistical model. We assume that conduction electrons in the electron transport layer (ETL) are described by some statistical integral <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq57.gif"/></alternatives></inline-formula> and valence holes in the hole transport layer (HTL) by <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq58.gif"/></alternatives></inline-formula>. Thus the equations for current densities in the transport layers must be updated to reflect the choice of statistical model. We now have<disp-formula id="Equ18"><label>16</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>n</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^n}= \mu _\textrm{E} k_BT n \frac{\partial }{\partial x} \left[ {\mathcal {S}}_\textrm{E}^{-1}\left( \frac{n}{g_\textrm{c}^\textrm{E}}\right) - \frac{q\phi }{k_BT}\right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ18.gif"/></alternatives></disp-formula>in the ETL and<disp-formula id="Equ19"><label>17</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>p</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^p}= -\mu _\textrm{H} k_BT p \frac{\partial }{\partial x} \left[ {\mathcal {S}}_\textrm{H}^{-1}\left( \frac{p}{g_\textrm{v}^\textrm{H}}\right) + \frac{q\phi }{k_BT}\right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ19.gif"/></alternatives></disp-formula>in the HTL.</p><p id="Par22">The generalised statistical models necessitate that continuity conditions at the edges of the transport layers must be reconsidered. As in previous versions of the model [<xref ref-type="bibr" rid="CR19">19</xref>], we enforce that the majority carriers’ QFLs are continuous across the interfaces between transport layers and the perovskite, <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>n</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{f}_n}|_{x=0^-} = E_{\textrm{f}_n}|_{x=0^+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mtext>f</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{f}_{p}}|_{x=b^-} = E_{\textrm{f}_{p}}|_{x=b^+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq60.gif"/></alternatives></inline-formula>. Using expressions for the QFLs in Boltzmann models (<xref rid="Equ7" ref-type="disp-formula">7</xref>), (<xref rid="Equ8" ref-type="disp-formula">8</xref>) in the perovskite and general statistical models (<xref rid="Equ12" ref-type="disp-formula">11</xref>) in the transport layers, we obtain the continuity conditions<disp-formula id="Equ20"><label>18</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n|_{x=0^+}&amp;= g_\textrm{c} \exp \left[ \frac{E_\textrm{c}^\textrm{E}-E_\textrm{c}}{k_BT} + {\mathcal {S}}_\textrm{E}^{-1}\left( \frac{n|_{x=0^-}}{g_\textrm{c}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>19</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p|_{x=b^-}&amp;= g_\textrm{v} \exp \left[ \frac{E_\textrm{v}-E_\textrm{v}^\textrm{H}}{k_BT} + {\mathcal {S}}_\textrm{H}^{-1}\left( \frac{p|_{x=b^+}}{g_\textrm{v}^\textrm{H}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ21.gif"/></alternatives></disp-formula>where a superscript ‘<inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mo>+</mml:mo></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq61.gif"/></alternatives></inline-formula>’ denotes a quantity on the right hand side of an interface and ‘−’ the left hand side. The ratios of carrier densities either side of the interfaces when the cell is in equilibrium with no potential difference across it are therefore <disp-formula id="Equ22"><label>20a</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;k_\textrm{E} = \frac{g_\textrm{c}}{d_\textrm{E}} \exp \left[ \frac{E_\textrm{c}^\textrm{E}-E_\textrm{c}}{k_BT} + {\mathcal {S}}_\textrm{E}^{-1}\left( \frac{d_\textrm{E}}{g_\textrm{c}^\textrm{E}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ22.gif"/></alternatives></disp-formula><disp-formula id="Equ23"><label>20b</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;k_H = \frac{g_\textrm{v}}{d_H} \exp \left[ \frac{E_\textrm{v}-E_\textrm{v}^\textrm{H}}{k_BT} + {\mathcal {S}}_\textrm{H}^{-1}\left( \frac{d_H}{g_\textrm{v}^\textrm{H}}\right) \right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ23.gif"/></alternatives></disp-formula> and we recast the continuity conditions in terms of these ratios as<disp-formula id="Equ24"><label>21</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n|_{x=0^+} = d_\textrm{E} k_\textrm{E} \exp \left[ {\mathcal {S}}_\textrm{E}^{-1} \left( \frac{n|_{x=0^-}}{g_\textrm{c}^\textrm{E}}\right) - {\mathcal {S}}_\textrm{E}^{-1} \left( \frac{d_\textrm{E}}{g_\textrm{c}^\textrm{E}}\right) \right] , \ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ24.gif"/></alternatives></disp-formula><disp-formula id="Equ25"><label>22</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p|_{x=b^-} = d_H k_H \exp \left[ {\mathcal {S}}_\textrm{H}^{-1} \left( \frac{p|_{x=b^+}}{g_\textrm{v}^\textrm{H}}\right) - {\mathcal {S}}_\textrm{H}^{-1} \left( \frac{d_H}{g_\textrm{v}^\textrm{H}}\right) \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ25.gif"/></alternatives></disp-formula>This concludes the changes required to incorporate the option of simulating non-Boltzmann statistics in IonMonger. In the next section we describe the common statistical models that are built-in to IonMonger 2.0.</p></sec><sec id="Sec7"><title>Available statistical models</title><p id="Par23">In IonMonger 2.0, the user can choose statistical models from three possible band shapes, with either Fermi–Dirac or Boltzmann distributions, to apply to majority carriers in the transport layers. Note that statistical models, determined by the combination of a statistical distribution and a band shape, are commonly given names, summarised in Table <xref rid="Tab2" ref-type="table">2</xref>. The two transport layers can be assigned different statistical models. Model parameters are used to create reference functions which enable quick and accurate evaluation of the statistical function and its inverse.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Available statistical models determined by choices of statistical distribution <italic>f</italic>(<italic>E</italic>) and band shape <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{g}}_{\textrm{c},\textrm{v}}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq62.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><p>Statistical integral</p></th><th align="left"><p>Boltzmann approximation</p></th></tr></thead><tbody><tr><td align="left" colspan="3"><p>Band shape, <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\hat{g}}}_{\textrm{c},\textrm{v}}(E)}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq63.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p> Parabolic</p></td><td align="left"><p>Fermi–Dirac, <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )={\mathcal {F}}(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq64.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )=\exp (\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq65.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p> Gaussian</p></td><td align="left"><p>Gauss–Fermi, <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )={\mathcal {G}}_\textrm{s}(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq66.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mi>ξ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )=\exp \left( \xi +\frac{s}{2}\right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq67.gif"/></alternatives></inline-formula></p></td></tr><tr><td align="left"><p> Gaussian with <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq68.gif"/></alternatives></inline-formula></p></td><td align="left"><p>Blakemore, <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )={\mathcal {B}}(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq69.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi )=\exp (\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq70.gif"/></alternatives></inline-formula></p></td></tr></tbody></table><table-wrap-foot><p>The Fermi–Dirac integral (<inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mi mathvariant="script">F</mml:mi></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq71.gif"/></alternatives></inline-formula>), the Gauss–Fermi integral (<inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {G}}_\textrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq72.gif"/></alternatives></inline-formula>) and the Blakemore function (<inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mi mathvariant="script">B</mml:mi></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {B}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq73.gif"/></alternatives></inline-formula>) are defined in (<xref rid="Equ28" ref-type="disp-formula">24</xref>), (<xref rid="Equ31" ref-type="disp-formula">26</xref>), and (<xref rid="Equ33" ref-type="disp-formula">28</xref>), respectively</p></table-wrap-foot></table-wrap></p><p id="Par24">Note that users who do not wish to make use of alternative statistical models can simply remove the ‘stats’ structure from the parameter file. In its absence, IonMonger will automatically employ Boltzmann distributions in parabolic bands, as was the case in previous versions of the software. For more information about specifying statistical models in simulations, see the user guide (GUIDE.md).</p><p id="Par25">Users also have the option of creating their own statistical models by editing the create_stats_funcs.m file which serves as a template.</p><sec id="Sec8"><title>The parabolic model</title><p id="Par26">The parabolic band model (shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) originates from a Taylor expansion of the dispersion relation near a turning point (see [<xref ref-type="bibr" rid="CR48">48</xref>] §3.3.5). This Taylor expansion describes the DoS near the edges of the bands (where most carriers exist). This model is usually considered accurate in the case of ordered crystalline semiconductors (typically inorganic).<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>The parabolic statistical integral. <bold>a</bold> The parabolic DoS functions for the two bands where the reference energies are the band edges, located at <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>3.9</mml:mn></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{c}=-3.9$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq74.gif"/></alternatives></inline-formula> eV and <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>5.1</mml:mn></mml:mrow></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{v}=-5.1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq75.gif"/></alternatives></inline-formula> eV, and the effective DoS are <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>25</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_\textrm{c}=g_\textrm{v}=10^{25}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq76.gif"/></alternatives></inline-formula> m<inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq77.gif"/></alternatives></inline-formula>. <bold>b</bold> The statistical integral versus dimensionless quasi-Fermi level. The solid blue line corresponds to Fermi–Dirac statistics and the dashed red line corresponds to the Boltzmann approximation. The pink shaded area is the region in which the Boltzmann approximation is commonly considered accurate (<inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi &lt;-3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq78.gif"/></alternatives></inline-formula>) (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig5_HTML.png" id="MO30"/></fig></p><p id="Par27">The parabolic band structure is defined by the DoS functions <disp-formula id="Equ26"><label>23a</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>c</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mi>E</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mi>E</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{g}}_\textrm{c}(E)&amp;= {\left\{ \begin{array}{ll} 0 &amp;{}\quad E&lt;E_\textrm{c}\\ \displaystyle \frac{2g_\textrm{c}}{\sqrt{\pi }} \frac{1}{k_BT} \sqrt{\frac{E-E_\textrm{c}}{k_BT}} &amp;{}\quad E \ge E_\textrm{c} \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ26.gif"/></alternatives></disp-formula><disp-formula id="Equ27"><label>23b</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>v</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mi>E</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mi>E</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{g}}_\textrm{v}(E)&amp;= {\left\{ \begin{array}{ll} 0 &amp;{}\quad E&gt;E_\textrm{v}\\ \displaystyle \frac{2g_\textrm{v}}{\sqrt{\pi }} \frac{1}{k_BT} \sqrt{\frac{E_\textrm{v}-E}{k_BT}} &amp;{}\quad E \le E_\textrm{v}. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ27.gif"/></alternatives></disp-formula> The conduction and valence bands have defined edges, denoted by <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{v}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq80.gif"/></alternatives></inline-formula>, respectively. These are the reference energies. Under a Fermi–Dirac distribution, the statistical integral, often (somewhat confusingly) referred to as the Fermi–Dirac integral, is defined to be<disp-formula id="Equ28"><label>24</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mfrac><mml:mfrac><mml:msqrt><mml:mi>η</mml:mi></mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtext>d</mml:mtext><mml:mi>η</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {F}}(\xi ) = \int _0^\infty \frac{2}{\sqrt{\pi }} \frac{\sqrt{\eta }}{1+ \exp (\eta -\xi )} \textrm{d}\eta , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ28.gif"/></alternatives></disp-formula>where <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mi>ξ</mml:mi></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq82.gif"/></alternatives></inline-formula> are the dimensionless quasi-Fermi level and state energy, respectively, where both are relative to the band’s reference energy and measured in units of the thermal voltage. This function is plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b. To clarify the nomenclature, the Fermi–Dirac distribution is the statistical distribution obeyed by all Fermions and the Fermi–Dirac integral is the statistical integral to which only Fermions in parabolic bands adhere.</p><p id="Par28">As discussed in the previous section, if carrier densities are approximated by a Boltzmann distribution, the statistical integral becomes <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi ) = \exp (\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq83.gif"/></alternatives></inline-formula>. Both the Fermi–Dirac integral and its Boltzmann approximation are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b. It is generally accepted that the Boltzmann approximation to the Fermi–Dirac integral is accurate for quasi-Fermi levels more than three thermal voltages from the band edge (or densities <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mn>20</mml:mn></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n&lt;\frac{g_\textrm{c}}{20}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq84.gif"/></alternatives></inline-formula>) [<xref ref-type="bibr" rid="CR3">3</xref>].</p></sec><sec id="Sec9"><title>The Gaussian model</title><p id="Par29">Weak molecular bonds in organic materials create a disordered structure in which electron transport takes the form of hopping between discrete molecular sites; this is in contrast to the band transport in ordered crystalline materials. For a system with a large number of molecules, this hopping transport resembles band transport in a Gaussian band [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR50">50</xref>, <xref ref-type="bibr" rid="CR60">60</xref>] where the width of the Gaussian corresponds to the level of disorder in the intermolecular structure. The Gaussian band structure is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a. The bands no longer have defined edges, hence the reference energies are now the centres of each Gaussian, denoted by <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{v}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq86.gif"/></alternatives></inline-formula>, respectively. In organic materials, these are commonly referred to as the lowest unoccupied molecular orbital (LUMO) and the highest occupied molecular orbital (HOMO), and denoted by <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>L</mml:mtext></mml:msub></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq87.gif"/></alternatives></inline-formula> and <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq88.gif"/></alternatives></inline-formula>, respectively. This model requires a further parameter, <italic>s</italic>, to describe the width of the Gaussian (corresponding to the structural disorder). Note that <italic>s</italic> is dimensionless but is often given in its dimensional form, <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =s k_BT$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq89.gif"/></alternatives></inline-formula>. The Gaussian DoS functions are <disp-formula id="Equ29"><label>25a</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>c</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{g}}_\textrm{c}(E)&amp;= \frac{g_\textrm{c}}{\sqrt{2\pi } \sigma _\textrm{c}} \exp \left( \frac{-1}{2} \left( \frac{E-E_{\textrm{c}}}{\sigma _\textrm{c}}\right) ^2 \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ29.gif"/></alternatives></disp-formula><disp-formula id="Equ30"><label>25b</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>v</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mtext>v</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{g}}_\textrm{v}(E)&amp;= \frac{g_\textrm{v}}{\sqrt{2\pi } \sigma _\textrm{v}} \exp \left( \frac{-1}{2} \left( \frac{E-E_\textrm{v}}{\sigma _\textrm{v}}\right) ^2 \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ30.gif"/></alternatives></disp-formula> Under a Fermi–Dirac distribution, the statistical integral, referred to as the Gauss–Fermi integral [<xref ref-type="bibr" rid="CR52">52</xref>], is defined as<disp-formula id="Equ31"><label>26</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mi>η</mml:mi><mml:mi>s</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtext>d</mml:mtext><mml:mi>η</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {G}}_\textrm{s}(\xi ) = \frac{1}{s\sqrt{2\pi }} \int _{-\infty }^\infty \frac{\exp \big ( \frac{-1}{2} \big (\frac{\eta }{s}\big )^2 \big ) }{1 + \exp (\eta -\xi )}\textrm{d}\eta . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ31.gif"/></alternatives></disp-formula>If carriers are approximated by a Boltzmann distribution, the statistical integral becomes <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi ) = \exp (\xi + \frac{s}{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq90.gif"/></alternatives></inline-formula>. Both the Gauss–Fermi statistical integral and its Boltzmann approximation are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b for different values of <italic>s</italic>. Note that the Boltzmann approximation to Gauss–Fermi statistics is far less accurate than the parabolic equivalent, and this is exacerbated for larger values of <italic>s</italic>. As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b, the Boltzmann approximation to <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {G}}_8(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq91.gif"/></alternatives></inline-formula> is still highly inaccurate when the quasi-Fermi level is <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mrow><mml:mn>50</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$50k_BT$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq92.gif"/></alternatives></inline-formula> from the reference energy, occurring at a dimensionless carrier density of approximately <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-9}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq93.gif"/></alternatives></inline-formula>. Measurements of the Gaussian disorder parameter in the bands of spiro-MeOTAD (a common HTL material for PSCs) have yielded <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>3.38</mml:mn><mml:mo>-</mml:mo><mml:mn>4.08</mml:mn></mml:mrow></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=3.38-4.08$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq94.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR57">57</xref>, <xref ref-type="bibr" rid="CR66">66</xref>].<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>The Gauss–Fermi statistical integral. <bold>a</bold> The Gaussian DoS functions for the two bands where the reference energies are located at <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>3.9</mml:mn><mml:mspace width="0.166667em"/></mml:mrow></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c}}=-3.9\,$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq95.gif"/></alternatives></inline-formula> eV and <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>5.1</mml:mn><mml:mspace width="0.166667em"/></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{v}=-5.1\,$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq96.gif"/></alternatives></inline-formula> eV, and the effective densities of states are <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>25</mml:mn></mml:msup><mml:mspace width="0.166667em"/></mml:mrow></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_\textrm{c}=g_\textrm{v}=10^{25}\,$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq97.gif"/></alternatives></inline-formula>eV<inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq98.gif"/></alternatives></inline-formula> m<inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq99.gif"/></alternatives></inline-formula>. Three values of the Gaussian width are shown. <bold>b</bold> the Gauss–Fermi statistical integral vs. dimensionless quasi-Fermi level for three different Gaussian widths. Solid lines correspond to the Gauss–Fermi integral and the dashed black lines correspond to the Boltzmann approximation. Note the vast difference in scales compared to Fig. <xref rid="Fig5" ref-type="fig">5</xref>b due to the wide spread of state energy levels into the band gap (particularly for large values of <italic>s</italic>)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig6_HTML.png" id="MO37"/></fig></p></sec><sec id="Sec10"><title>The Blakemore model</title><p id="Par30">In the limit of vanishing Gaussian width (<inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq100.gif"/></alternatives></inline-formula>), the Gaussian DoS becomes a Dirac-<inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq101.gif"/></alternatives></inline-formula> function,<disp-formula id="Equ32"><label>27</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{g}}_{\textrm{c},\textrm{v}}(E)&amp;= g_{\textrm{c},\textrm{v}} \delta (E-E_{\textrm{c},\textrm{v}}), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ32.gif"/></alternatives></disp-formula>representing a density of <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{\textrm{c},\textrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq102.gif"/></alternatives></inline-formula> states, all with identical energy <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>,</mml:mo><mml:mtext>v</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\textrm{c},\textrm{v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq103.gif"/></alternatives></inline-formula>. This is equivalent to hopping transport in materials with no structural disorder. Under a Fermi–Dirac distribution, this DoS yields a statistical integral, referred to as the Blakemore function, and shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> [<xref ref-type="bibr" rid="CR9">9</xref>],<disp-formula id="Equ33"><label>28</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {B}}(\xi ) = \frac{1}{\exp (-\xi )+1}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ33.gif"/></alternatives></disp-formula>If carriers are approximated by a Boltzmann distribution, the statistical integral becomes <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}(\xi ) = \exp (\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq104.gif"/></alternatives></inline-formula> .<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>The Blakemore statistical integral. The solid line corresponds to Blakemore function and the dashed black line corresponds to the Boltzmann approximation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig7_HTML.png" id="MO40"/></fig></p></sec></sec><sec id="Sec11"><title>Quasi-Fermi level input</title><p id="Par31">Under Boltzmann distributions, the conversion between a carrier density and a quasi-Fermi level is simple; meaning that users can easily convert experimental measurements of equilibrium quasi-Fermi levels into effective doping densities to use in the parameter set for simulations. To avoid requiring users to perform this conversion for non-Boltzmann statistical models, IonMonger 2.0 can accept either carrier densities or quasi-Fermi levels when setting the TL doping levels. When the user sets the QFLs for the TLs, the relevant doping densities are calculated according to the statistical model in that layer. The two layers are independent, meaning one could set the doping density for one and the QFL for the other.</p><p id="Par32"><italic>Impact of statistical models on device performance.</italic> Finally, we note that the full charge transport model is sufficiently complex that it is impossible to predict how changes to the statistical model in one of the TLs might affect the model’s response to any general experimental protocol. While outside the scope of this work, the impact of transport layer statistical models on device-level modelling will be investigated in a forthcoming publication [<xref ref-type="bibr" rid="CR16">16</xref>].</p></sec></sec><sec id="Sec12"><title>Steric effects</title><p id="Par33">The standard Poisson–Nernst–Planck (PNP) system, used to govern ionic motion in the previous version of IonMonger  has an embedded assumption; namely that there is no shortage of lattice sites for ion vacancies to occupy, i.e. <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≪</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P \ll P_{\text {lim}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq105.gif"/></alternatives></inline-formula> where <inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq106.gif"/></alternatives></inline-formula> is the density of anion sites (and so is equivalent to the maximum vacancy density).<xref ref-type="fn" rid="Fn2">2</xref> However, in relatively extreme scenarios, e.g. at very large applied voltage and/or in the narrow Debye layers near the edges of the perovskite, it is possible that ion vacancy densities become sufficiently large that steric effects (i.e. ion vacancy crowding, also known as volume exclusion effects) cannot be duly neglected. In such scenarios, the standard PNP system must be amended and replaced with a nonlinear-PNP (nPNP) system with a modified ion flux [<xref ref-type="bibr" rid="CR1">1</xref>]. Two forms of modified ion flux have been used in the literature, derived using different assumptions. One approach yields a nonlinear (in the vacancy density) drift term in the ion flux whilst the other gives a nonlinear diffusion term. Rather than stipulating one form (or the other) of the ion flux, we allow users to easily switch between the two. We shall now present the two formulations in turn.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Distribution of anion vacancies in the Debye layer near the ETL interface at steady state at an applied voltage of 1 V under different values of the limiting vacancy density</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig8_HTML.png" id="MO41"/></fig></p><sec id="Sec13"><title>Modified drift</title><p id="Par34">Bazant [<xref ref-type="bibr" rid="CR7">7</xref>] presents a general theory for chemical kinetics which describes how an ion flux is driven by the product of the ion density, mobility and gradient of its electrochemical potential <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mi>γ</mml:mi><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu = k_BT\ln \left( \gamma \frac{P}{P_{\text {lim}}} \right) + \phi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq112.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq113.gif"/></alternatives></inline-formula> is termed the activity coefficient. For diffusion on a lattice, the activity coefficient is given by <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma = (1-\frac{P}{P_{\text {lim}}})^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq114.gif"/></alternatives></inline-formula> and the mobility <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M = \gamma \frac{D_\textrm{I}}{k_BT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq115.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\textrm{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq116.gif"/></alternatives></inline-formula> is a constant diffusion coefficient. This theory leads to the following formulation for the ion flux, with a nonlinear density-dependent drift term,<disp-formula id="Equ34"><label>29</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qP</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F^P = -D_\textrm{I} \left[ \frac{\partial P }{\partial x} + \frac{qP}{k_B T} \frac{\partial \phi }{\partial x} \left( 1 - \frac{P}{P_{\text {lim}}} \right) \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ34.gif"/></alternatives></disp-formula>Another appealing justification for this formulation follows from work by Burger et al. [<xref ref-type="bibr" rid="CR12">12</xref>]. This work considers a hopping model for the diffusion process that retains a non-zero probability that sites adjacent to the ion (or ion vacancy) in question are already occupied. In the derivation of the usual PNP system, this probability is set to zero. When incorporating steric effects, the probability of transition to an occupied site is zero, thereby enforcing that at most one ion can reside on any given lattice site. This constraint results in a density-dependent mobility and hence a modified drift term.</p></sec><sec id="Sec14"><title>Nonlinear diffusion</title><p id="Par35">Alternatively, steric effects can be modelled via a nonlinearity in the diffusion term, as proposed by Kralj-Iglic and Iglic [<xref ref-type="bibr" rid="CR41">41</xref>] and Borukhov et al. [<xref ref-type="bibr" rid="CR10">10</xref>] according to thermodynamic considerations (assuming a constant mobility). In this case, the ion flux is given by<disp-formula id="Equ35"><label>30</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qP</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F^P = -D_\textrm{I} \left[ \frac{\partial P }{\partial x} \left( 1 - \frac{P}{P_{\text {lim}}} \right) ^{-1} + \frac{qP}{k_B T} \frac{\partial \phi }{\partial x} \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ35.gif"/></alternatives></disp-formula>Note that diffusion is “enhanced” as <italic>P</italic> approaches <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq117.gif"/></alternatives></inline-formula>. This formulation has previously been used in the context of PSC modelling [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Abdel et al. [<xref ref-type="bibr" rid="CR2">2</xref>] show that the form of diffusion enhancement depends on the choice of statistical function and that the formulation in (<xref rid="Equ35" ref-type="disp-formula">30</xref>) results from employing a Blakemore model (or, equivalently, a Fermi–Dirac integral of order − 1) to describe the movement of ions.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Timescales for the current density reaching steady state at an applied voltage of 1 V after a preconditioning step at 0.9 V with different vacancy limitation parameters. Modified drift (<xref rid="Equ34" ref-type="disp-formula">29</xref>) and diffusion terms (<xref rid="Equ35" ref-type="disp-formula">30</xref>) show different dynamics but reach the same steady state</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig9_HTML.png" id="MO44"/></fig></p><p id="Par36">Both expressions for the ion flux collapse to the form found in the usual PNP system on taking the limit <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}\rightarrow \infty$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq118.gif"/></alternatives></inline-formula>. Furthermore, it is important to note that even though the two formulations predict the same steady state ((<xref rid="Equ34" ref-type="disp-formula">29</xref>) is identical to (<xref rid="Equ35" ref-type="disp-formula">30</xref>) on setting <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F^p \equiv 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq119.gif"/></alternatives></inline-formula>), there are marked differences in their dynamics. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows how the dynamics are affected by variations in <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq120.gif"/></alternatives></inline-formula> for the two models, whilst Fig. <xref rid="Fig9" ref-type="fig">9</xref> verifies that IonMonger produces identical steady states for the two different nPNP models as expected.</p><p id="Par37">Steric effects can be activated in IonMonger by setting ‘Plim’ to a numeric value and ‘NonlinearFP’ to a string value of either ‘Drift’ or ‘Diffusion’.</p></sec></sec><sec id="Sec15"><title>Other extensions to the model</title><p id="Par38">In this section we briefly introduce a number of other extensions that have been added during the IonMonger update. See the User Guide for more information.</p><sec id="Sec16"><title>Absorption spectra</title><p id="Par39">By default, the generation rate <italic>G</italic>(<italic>x</italic>, <italic>t</italic>) follows the Beer-Lambert law of light absorption for a single wavelength and absorption coefficient [<xref ref-type="bibr" rid="CR48">48</xref>], i.e.<disp-formula id="Equ36"><label>31</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>ph</mml:mtext></mml:msub><mml:mi>α</mml:mi><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x,t) = I_\textrm{s}(t)F_\textrm{ph} \alpha \exp \left( -\alpha \left[ \frac{b}{2}+l\left( x-\frac{b}{2}\right) \right] \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ36.gif"/></alternatives></disp-formula>where <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:msub><mml:mi>F</mml:mi><mml:mtext>ph</mml:mtext></mml:msub></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_\textrm{ph}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq121.gif"/></alternatives></inline-formula> is the flux of photons incident on the light-facing perovskite surface (after accounting for reflection) under the equivalent of 1 Sun illumination; <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq122.gif"/></alternatives></inline-formula> is the light absorption coefficient of the perovskite; <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_\textrm{s}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq123.gif"/></alternatives></inline-formula> is the intensity of the illumination in Sun equivalents; and, the parameter <italic>l</italic> determines whether light enters through the ETL (<inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq124.gif"/></alternatives></inline-formula>) or through the HTL (<inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq125.gif"/></alternatives></inline-formula>) for a so-called inverted architecture.</p><p id="Par40">In IonMonger 2.0 the user now has the option, via the generation_profile function, to replace (<xref rid="Equ36" ref-type="disp-formula">31</xref>) with a Beer-Lambert generation profile for light that includes a range of wavelengths, by integrating an absorption coefficient spectrum versus photon energy as follows:<disp-formula id="Equ37"><label>32</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>I</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>min</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:msubsup><mml:msub><mml:mi>F</mml:mi><mml:mtext>ph</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>exp</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mfenced><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x,t)= &amp; {} I_\textrm{s}(t)\int _{E_\text {min}}^{E_\text {max}}F_\textrm{ph}(E) \alpha (E) \exp \nonumber \\{} &amp; {} \left( -\alpha (E)\left[ \frac{b}{2}+l\left( x-\frac{b}{2}\right) \right] \right) \,\textrm{d}E. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ37.gif"/></alternatives></disp-formula>In this expression, the incident photon flux and the absorption coefficients are now functions of photon energy. The function can be created from measurement data.</p></sec><sec id="Sec17"><title>Auger recombination</title><p id="Par41">The total bulk recombination rate <italic>R</italic>(<italic>n</italic>, <italic>p</italic>) can now include contributions from Auger recombination as well as bimolecular and/or SRH recombination. The Auger recombination rate takes the form<disp-formula id="Equ38"><label>33</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>Auger</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;R_\text {Auger} = (A_n n + A_{p} p)(np - n_i^2)\,, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ38.gif"/></alternatives></disp-formula>where <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq126.gif"/></alternatives></inline-formula> and <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq127.gif"/></alternatives></inline-formula> are the Auger coefficients (with units m<inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mn>6</mml:mn></mml:msup><mml:mspace width="0.166667em"/></mml:mrow></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^6\,$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq128.gif"/></alternatives></inline-formula>s<inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq129.gif"/></alternatives></inline-formula>). This choice ensures that <inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>Auger</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\text {Auger} = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq130.gif"/></alternatives></inline-formula> at thermal equilibrium, i.e. when <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$np = n_i^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq131.gif"/></alternatives></inline-formula>. The total bulk recombination rate is<disp-formula id="Equ39"><label>34</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mtext>bim.</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mtext>SRH</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mtext>Auger</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;R(n,p) = R_\text {bim.}+R_\text {SRH}+R_\text {Auger}\,. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ39.gif"/></alternatives></disp-formula>The full expressions for each of these rates are given in the “<xref rid="Sec31" ref-type="sec">Appendix</xref>”.</p></sec><sec id="Sec18"><title>Immobile ions</title><p id="Par42">IonMonger 2.0 allows for the possibility of immobilising ion vacancies (previously all anion vacancies were assumed to be mobile). The user may set the ion vacancy diffusion coefficient <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_\textrm{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq132.gif"/></alternatives></inline-formula> equal to zero in order to fix them in their initial distribution. In previous versions, this would cause the characteristic timescale (by which time is re-scaled) to become infinite, preventing simulations from running. To correct for this, the numerical scheme now uses a characteristic timescale defined as follows.<disp-formula id="Equ40"><label>35</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ion</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mtext>ph</mml:mtext></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:mfrac><mml:mi>b</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mtext>I</mml:mtext></mml:msub></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:msub><mml:mi>ε</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tau _\textrm{ion}= {\left\{ \begin{array}{ll} \displaystyle \frac{n_0}{G_0} = \frac{b g_\textrm{c}\exp {((E_\textrm{f}^\textrm{E}-E_\textrm{c})/V_T)}}{F^\textrm{ph}(1-\textrm{e}^{-\alpha b})}\,, &amp;{} \text {if}\ D_\textrm{I}=0 \\ \displaystyle \frac{b}{D_\textrm{I}}\sqrt{\frac{V_T\varepsilon _A}{q\hat{N_0}}}, &amp;{} \text {otherwise.} \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ40.gif"/></alternatives></disp-formula>The first option is a timescale for electron transport; the second is the ionic timescale used in IonMonger 1.0 [<xref ref-type="bibr" rid="CR19">19</xref>].</p></sec><sec id="Sec19"><title>Band offsets at metal contacts</title><p id="Par43">Differences in the band energy levels between the transport layers and the metal contacts are modelled by updating the boundary condition on the majority carrier in each TL as follows. <disp-formula id="Equ41"><label>36a</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>ct</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;n|_{x=-b_\textrm{E}} = g_\textrm{c}^\textrm{E}{\mathcal {S}}_\textrm{E}\left( \frac{E_\textrm{ct} - E_\textrm{c}^\textrm{E}}{V_T}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ41.gif"/></alternatives></disp-formula><disp-formula id="Equ42"><label>36b</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>an</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;p|_{x=b+b_\textrm{H}} = g_\textrm{v}^\textrm{H}{\mathcal {S}}_\textrm{H}\left( \frac{E_\textrm{v}^\textrm{H} - E_\textrm{an}}{V_T}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ42.gif"/></alternatives></disp-formula> If the cathode and anode workfunctions are not set, IonMonger 2.0 assumes flat-band conditions, as before, which are equivalent to setting <disp-formula id="Equ43"><label>37a</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>ct</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>c</mml:mtext><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;E_\textrm{ct} = E_\textrm{f}^\textrm{E} = E_\textrm{c}^\textrm{E}+k_BT{\mathcal {S}}_\textrm{E}^{-1}\left( \frac{d_\textrm{E}}{g_\textrm{c}^\textrm{E}}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ43.gif"/></alternatives></disp-formula><disp-formula id="Equ44"><label>37b</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>an</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>f</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mtext>H</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mtext>v</mml:mtext><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;E_\textrm{an} = E_\textrm{f}^\textrm{H} = E_\textrm{v}^\textrm{H}-k_BT{\mathcal {S}}_\textrm{H}^{-1}\left( \frac{d_\textrm{H}}{g_\textrm{v}^\textrm{H}}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ44.gif"/></alternatives></disp-formula></p></sec><sec id="Sec20"><title>Parasitic resistances</title><p id="Par44">In order to model parasitic resistances, we follow the work of Neukom et al. [<xref ref-type="bibr" rid="CR49">49</xref>] and embed the PSC drift–diffusion model in an external circuit containing two resistors, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b. Even though this modelling approach (of appending resistors to the PSC element) is essentially ad-hoc, it does allow the model to capture parasitic series and shunt(/parallel) resistances which may be important in practice. An alternative approach to capturing these resistances would be to upgrade the model to include more spatial dimensions, more of the PSC architecture and a more complex (non-planar) geometry. However, such complexity would render the model significantly more costly to both solve and parameterise, nullifying some of the benefits of IonMonger.</p><p id="Par45">The effect of the external circuit is taken account of through two modifications to the drift–diffusion model. Within the PSC, the total current density is independent of <italic>x</italic> and can be computed at any point in the cell from<disp-formula id="Equ45"><label>38</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mspace width="2em"/><mml:mspace width="2em"/></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mspace width="2em"/><mml:mspace width="2em"/></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;J(t) = -\frac{V_{\textrm{p}}}{AR_{\textrm{p}}} + \left\{ \begin{array}{c} \displaystyle {j^n}+{j^p}-\frac{\partial }{\partial t}\left( \varepsilon _A\frac{\partial \phi }{\partial x}\right) +q{{F}^P}\\ \qquad \qquad \text {for } 0&lt;x&lt;b, \\ \displaystyle {j^n}-\frac{\partial }{\partial t}\left( \varepsilon _\textrm{E}\frac{\partial \phi }{\partial x}\right) \qquad \qquad \\ \qquad \qquad \text { for } -b_\textrm{E}&lt;x&lt;0,\\ \displaystyle {j^p}-\frac{\partial }{\partial t}\left( \varepsilon _\textrm{H}\frac{\partial \phi }{\partial x}\right) \qquad \qquad \\ \qquad \qquad \text { for } b&lt;x&lt;b+b_\textrm{H}, \end{array} \right. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ45.gif"/></alternatives></disp-formula>where <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext>bi</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\textrm{p}} = V_\textrm{bi}-\phi |_{x=-b_\textrm{E}}+\phi |_{x=b+b_\textrm{H}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq133.gif"/></alternatives></inline-formula>. The first term on the right-hand side accounts for current losses due to shunt resistance in the external circuit. <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\textrm{p}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq134.gif"/></alternatives></inline-formula> denotes the potential difference across the parallel resistor and, equivalently, the PSC element as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b. To minimise numerical error, IonMonger automatically calculates the current density at the midpoint of the perovskite layer, where the grid spacing is larger and the solution varies more smoothly. The terms involving time-derivatives give the displacement current density, which can become dominant during very high frequency (IS) measurements.</p><p id="Par46">Secondly, we have to take account of the change in <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\textrm{p}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq135.gif"/></alternatives></inline-formula> due to the resistor in series. We choose to incorporate this change at the HTL/metal contact, leading to the boundary condition<disp-formula id="Equ46"><label>39</label><alternatives><mml:math display="block" id="Equ46_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>bi</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\phi |_{x=b+b_\textrm{H}} = -\frac{V_\textrm{bi}-V(t)}{2}-\frac{R_\textrm{s}[AR_{\textrm{p}}j^{p,H}- V(t)]}{R_{\textrm{p}}+R_\textrm{s}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ46.gif"/></alternatives></disp-formula>where <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\textrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq136.gif"/></alternatives></inline-formula> (Ohm) is the series resistance, <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\textrm{p}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq137.gif"/></alternatives></inline-formula> (Ohm) is the parallel resistance and <italic>A</italic> (cm<inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq138.gif"/></alternatives></inline-formula>) is the cross-sectional area of the cell perpendicular to the current. We implicitly assume that the displacement current is negligible at the boundary. With these two modifications, the impact of parasitic resistances on cell performance and time-dependent behaviour can be easily investigated alongside the full set of cell parameters.</p></sec></sec><sec id="Sec21"><title>Easy access via IonMonger Lite</title><p id="Par47">Previously, some knowledge of MATLAB syntax was required to edit the parameters file and run simulations. In contrast, IonMonger Lite (provided as part of IonMonger 2.0) is aimed at users with no expertise in the MATLAB language.</p><p id="Par48">IonMonger Lite is a MATLAB live script, i.e. an interactive document that displays formatted text, equations and images [<xref ref-type="bibr" rid="CR47">47</xref>]. The underlying code can be hidden, thereby providing a more accessible user-experience. The IonMonger Lite interface enables users to run two types of simulation: a single current–voltage (<inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq139.gif"/></alternatives></inline-formula>–<inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq140.gif"/></alternatives></inline-formula>) sweep, preceded by a preconditioning step, or impedance spectroscopy (IS). The cell parameters and simulation protocol can be edited in text boxes and drop-down menus.</p><p id="Par49">Figure <xref rid="Fig10" ref-type="fig">10</xref> depicts the available protocols, including the adjustable parameters. For the <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq141.gif"/></alternatives></inline-formula>–<inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq142.gif"/></alternatives></inline-formula> sweep, the six parameters are the steady-state initial voltage, <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>init</mml:mtext></mml:msub></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{init}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq143.gif"/></alternatives></inline-formula>; the voltage at which the sweep begins, <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>pre</mml:mtext></mml:msub></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{pre}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq144.gif"/></alternatives></inline-formula>; the target sweep voltage, <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>tar</mml:mtext></mml:msub></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{tar}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq145.gif"/></alternatives></inline-formula>; the length of the preconditioning phase, <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:msub><mml:mi>t</mml:mi><mml:mtext>pre</mml:mtext></mml:msub></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\textrm{pre}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq146.gif"/></alternatives></inline-formula>; the length of the sweep, <inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:msub><mml:mi>t</mml:mi><mml:mtext>sweep</mml:mtext></mml:msub></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\textrm{sweep}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq147.gif"/></alternatives></inline-formula>; and the constant light intensity, <italic>L</italic>. For impedance spectroscopy, the adjustable parameters are the DC voltage, <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>DC</mml:mtext></mml:msub></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{DC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq148.gif"/></alternatives></inline-formula>; the AC voltage amplitude, <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\textrm{p}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq149.gif"/></alternatives></inline-formula>; the minimum and maximum frequencies, <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:msub><mml:mi>f</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:msub><mml:mi>f</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq151.gif"/></alternatives></inline-formula>; the number of sample frequencies, <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:msub><mml:mi>n</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\textrm{f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq152.gif"/></alternatives></inline-formula>; and the constant light intensity, <italic>L</italic>.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>The two types of experimental protocol available in IonMonger Lite. <bold>a</bold> Current–voltage sweep protocol with 6 adjustable parameters. <bold>b</bold> Impedance spectroscopy protocol with two variable voltage parameters, three frequency parameters and one light intensity parameter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig10_HTML.png" id="MO56"/></fig></p><p id="Par50">Users are presented with a series of checkboxes to determine which plots will be produced at the end of the simulation. Possible plots for <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq153.gif"/></alternatives></inline-formula>–<inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq154.gif"/></alternatives></inline-formula> sweeps include the applied voltage and light intensity as functions of time; the current density as a function of either time or applied voltage; and distributions of the anion vacancy density, electron density, hole density or electric potential. For IS simulations, Nyquist and frequency plots such as those in Fig. <xref rid="Fig4" ref-type="fig">4</xref> can be produced. For <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq155.gif"/></alternatives></inline-formula>–<inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq156.gif"/></alternatives></inline-formula> sweeps, there is also the option to automatically generate an animation of the solution using animate_sections.m (see Sect. <xref rid="Sec27" ref-type="sec">7.3</xref>).</p><p id="Par51">While offering a simplified user experience, live scripts lack the flexibility of standard MATLAB code. For this reason, proficient users should continue to run simulations by editing a parameters file and running ‘master.m’ to make use of IonMonger’s full functionality. Useful features of the full version that are not possible in IonMonger Lite include:<list list-type="bullet"><list-item><p id="Par52">advanced simulation protocols involving more sections, asymmetric sweeps, multiple consecutive sweeps, or time-dependent illumination intensity</p></list-item><list-item><p id="Par53">open-circuit voltage tracking</p></list-item><list-item><p id="Par54">non-Boltzmann statistical models in the transport layers</p></list-item><list-item><p id="Par55">running batches of simulations where one or more variables are iterated through a list of values</p></list-item><list-item><p id="Par56">changing the resolution and error tolerances of the solver</p></list-item><list-item><p id="Par57">band offsets at the metal contacts</p></list-item><list-item><p id="Par58">parasitic resistances</p></list-item><list-item><p id="Par59">resuming saved simulations</p></list-item></list>IonMonger Lite uses the same numerical solver as the full version, meaning it achieves the same performance and accuracy. After the simulation, the solution file is saved in the same format as the full version; thus all of the same post-processing and analysis/plotting can be performed.</p><sec id="Sec22"><title>Importing data into Python</title><p id="Par60">Once a simulation is complete, all the data, including the inputs, are saved in a single file. These data can then be imported into any software of the user’s choice for further analysis. The transfer of this data from MATLAB to Python is nontrivial because Python has no direct equivalent data type to the structures used by MATLAB. To aid this transfer, we include a Python file named IonMonger_import.py that can import a solution and unpack the data for analysis. This file contains functions to extract all major variables from a saved .mat file as well as example code to generate plots of the data and further instructions. Combined with IonMonger Lite, this function allows users with experience in Python but no expertise in MATLAB to design, run, and analyse simulations with IonMonger, an important step in making IonMonger accessible to a wider scientific community.</p></sec></sec><sec id="Sec23"><title>Performance, compatibility and accessibility</title><p id="Par61">In this section, we give details of the features of IonMonger 2.0 that enable the improved performance, backwards compatibility and greater accessibility via new functionalities for both running the code and visualising the results.</p><sec id="Sec24"><title>Performance</title><p id="Par62">In the original version of IonMonger, the Jacobian (<inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:mi mathvariant="script">J</mml:mi></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {J}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq157.gif"/></alternatives></inline-formula>) of the DAE system was approximated numerically by ode15s. In IonMonger 2.0, performance is improved by analytic calculation of <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:mi mathvariant="script">J</mml:mi></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {J}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq158.gif"/></alternatives></inline-formula> in the function AnJac.m. Figure <xref rid="Fig11" ref-type="fig">11</xref> demonstrates the resulting increase in performance for simulations of current–voltage sweeps using the default parameter set. The simulation time for an impedance spectrum with 60 sample frequencies is decreased from 61 to 31 s.</p><p id="Par63">Similarly, IonMonger 2.0 benefits from improved stability in response to different parameter sets, due to many small changes that aid the solver, ode15s, in converging on a solution.<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Comparison of performance between IonMonger versions 1.0 and 2.0. An identical parameter file is used for both versions. For each value of <italic>N</italic>, a preconditioning stage and 100 mV s<inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq159.gif"/></alternatives></inline-formula> reverse and forward scans were simulated. Red lines correspond to 1.0 and blue lines to 2.0. Squares represent measurements on a laptop with a Ryzen 5 Microsoft Surface Edition CPU and crosses represent a desktop with a Ryzen 5 5600X CPU. Simulations were attempted for 40 values of <italic>N</italic> equally spaced between 20 and 800. Any missing data points are due to a solution not being obtained from the given parameter set (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig11_HTML.png" id="MO57"/></fig></p><sec id="Sec25"><title>Fast and accurate evaluation of statistical integrals and their inverses</title><p id="Par64">The challenge of implementing alternative statistical models is the large number of comparatively costly evaluations of the inverse statistical integral, <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq160.gif"/></alternatives></inline-formula> (<xref rid="Equ55" ref-type="disp-formula">47b</xref>,<xref rid="Equ60" ref-type="disp-formula">49b</xref>). In general, not only is the statistical integral non-invertible, but <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:mi mathvariant="script">S</mml:mi></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq161.gif"/></alternatives></inline-formula> also cannot be evaluated exactly. This is the case in both the Fermi–Dirac (<xref rid="Equ28" ref-type="disp-formula">24</xref>) and Gauss–Fermi (<xref rid="Equ31" ref-type="disp-formula">26</xref>) integrals. The simplest approach would be to evaluate the integrals numerically and invert the function with a root-finding algorithm. However, even with efficient functions to perform the integration and root-finding, this is computationally expensive and would result in <inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq162.gif"/></alternatives></inline-formula>–<inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq163.gif"/></alternatives></inline-formula> simulations taking minutes to hours instead of seconds to minutes motivating the need for more efficient schemes.</p><p id="Par65">Significant efforts have been made to find approximations to the Fermi–Dirac [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR64">64</xref>] and Gauss–Fermi integrals [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. However, most approximations are either computationally expensive or lack accuracy. Furthermore, attempts to approximate the inverses of these integrals are rare. In order to maximise both efficiency and accuracy, IonMonger 2.0 utilises interpolation of lookup tables of dimensionless quasi-Fermi levels and their corresponding dimensionless carrier densities, evaluated once at the start of a simulation by numerical integration using the trapezium rule on a high-resolution grid. This approach eliminates the need for a root-finding algorithm as the interpolation can be performed in either direction.</p><p id="Par66">The inverted statistical integrals are evaluated inside an approximated derivative within the DAE system; therefore it is essential that the approximations have continuous first derivatives. For this reason, interpolation is performed using piecewise cubic Hermite interpolating polynomials (PCHIPs), rather than linear interpolation, via MATLAB’s interp1 function. This approach results in approximations for <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq164.gif"/></alternatives></inline-formula> and <inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {G}}_\textrm{s}(\xi )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq165.gif"/></alternatives></inline-formula> with a relative error of less than 0.1% in the domains <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>ξ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \xi &lt;6\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq166.gif"/></alternatives></inline-formula> and <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>ξ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \xi &lt; 2s \, , \, s\ge 1\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq167.gif"/></alternatives></inline-formula>, respectively.</p><p id="Par67">Figure <xref rid="Fig12" ref-type="fig">12</xref> shows the simulation times for a single current–voltage sweep with and without Boltzmann statistics in the transport layers for a range of spatial grid spacings. The time taken to create the lookup tables at the beginning of each simulation averaged 39 ms for the Fermi–Dirac, and 30 ms for the Gauss–Fermi integral. The average extra time taken for simulations of a 100 mV s<inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq168.gif"/></alternatives></inline-formula><inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq169.gif"/></alternatives></inline-formula>–<inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq170.gif"/></alternatives></inline-formula> sweep of the template parameter set was just 0.54 s. Therefore the effects of alternative statistical models may be investigated using IonMonger without significant negative impact on computation time.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>Time taken to compute a 100 mV s<inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq171.gif"/></alternatives></inline-formula><inline-formula id="IEq172"><alternatives><mml:math id="IEq172_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq172_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq172.gif"/></alternatives></inline-formula>–<inline-formula id="IEq173"><alternatives><mml:math id="IEq173_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq173_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq173.gif"/></alternatives></inline-formula> sweep of the template parameter set with different statistical models across a range of grid resolutions. Red lines correspond to simulations using Fermi–Dirac statistics in the ETL and Gauss–Fermi in the HTL as the parameter set is based on an inorganic ETL and an organic HTL and blue lines correspond to simulations in which the Boltzmann approximation was employed in both transport layers. Circles were measured on a desktop with a Ryzen 5 5600X CPU and triangles were measured on a laptop with a Ryzen 5 Windows Surface Edition CPU (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig12_HTML.png" id="MO58"/></fig></p></sec></sec><sec id="Sec26"><title>Compatibility</title><p id="Par68">IonMonger 2.0 is fully compatible and consistent with previous versions. Any parameter file from a previous version can be run using version 2.0. If any parameters required for additions to the model are not specified in the parameter file, they will automatically be replaced by their default values, listed in Table <xref rid="Tab1" ref-type="table">1</xref>. An example of the verification that IonMonger 2.0 is indeed consistent with the initial release is shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>, where electric potential distributions calculated on high resolution grids from both versions are shown to overlap exactly. Though not shown, this verification has been performed on all output variables across multiple parameter sets.</p><p id="Par69">Two tests for developers have been written using MATLAB’s testing framework. The aim of these tests is to verify that future versions of the code are consistent with the initial and subsequent releases. The first is a regression test that compares the output of an example simulation with saved data produced by the original code. The second is an integration test that checks that the current code runs successfully for two different experimental protocols that make use of different subroutines.<fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>Verification of IonMonger 2.0 (dotted lines) against version 1.0 (solid lines) for solutions of electric potential during a voltage sweep on a high resolution grid. Note that the electric potential has been shifted such that <inline-formula id="IEq174"><alternatives><mml:math id="IEq174_Math"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq174_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi =0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq174.gif"/></alternatives></inline-formula> on the HTL contact for clarity and the spatial grid has been stretched such that grid points are linearly spaced in order to examine the behaviour in the Debye layers</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2022_1988_Fig13_HTML.png" id="MO59"/></fig></p></sec><sec id="Sec27"><title>New analysis tools</title><p id="Par70">Five new analysis tools are provided as part of IonMonger 2.0 and can be found in the Code\Plotting folder.</p><sec id="Sec28"><title>Plotting functions</title><p id="Par71">Four of these new tools are plotting functions. For more details, see the README file.<list list-type="bullet"><list-item><p id="Par72">plot_recombination.m generates two figures showing the recombination rates as functions of time and space.</p></list-item><list-item><p id="Par73">plot_dstrbns.m plots spatial distributions of the four model variables (<inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P,\phi ,n,p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq175.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par74">plot_IS.m generates Nyquist and frequency plots as in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, as well as a 3D plot of the impedance spectrum as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p></list-item><list-item><p id="Par75">plot_bands.m generates a band diagram including the position of references energies and QFLs.</p></list-item></list></p></sec><sec id="Sec29"><title>Animating solutions</title><p id="Par76">The function animate_sections.m can be used to animate a solution and save the video as an MP4 file. Details of how to use the function and specify the parameters of the video (length, resolution, frame rate, etc) can be found in the user guide (GUIDE.md). Example videos can be found on the IonMonger Modelling YouTube channel [<xref ref-type="bibr" rid="CR36">36</xref>] and one is included in the SI.</p></sec></sec></sec><sec id="Sec30" sec-type="conclusions"><title>Conclusions</title><p id="Par77">We have presented the second incarnation of the PSC simulation tool IonMonger, expanding on the success of the original software by: (1) augmenting the charge transport model to account for a diverse list of physical processes, including non-Boltzmann statistics, steric effects for mobile ions, absorption spectra, Auger recombination, and parasitic resistances; (2) adding additional functionality, particularly in regards to simulating impedance responses; (3) improving accessibility and lowering the barrier-to-entry via the introduction of IonMonger Lite (allowing users to leverage many features of the tool with little to no coding or MATLAB experience), and; (4) increased numerical performance and stability. In addition, the performance of the tool has been increased across the board, meaning decreased computation times. This is primarily due to the addition of an analytic Jacobian in the numerical scheme and enables the computation of full, well-resolved, impedance spectra on timescales of seconds to minutes and current–voltage sweeps on timescales of seconds on standard desktop computers.
</p><p id="Par78">The open-source nature of IonMonger is supported by a dedicated, free-to-join Slack community of users and developers<xref ref-type="fn" rid="Fn3">3</xref> who will further develop both the charge transport model and the code in the future. Thus, the software provides an accessible in-silico laboratory for investigating the physics of PSCs, and it is the authors’ hope that it can contribute towards accelerating PSC development.</p></sec></body><back><sec sec-type="author-contribution"><title>Author contributions</title><p>WC, LJB, YG, and NEC developed the software code. WC, LJB, YG, JMF, and NEC wrote the manuscript. JMF, GR and NEC supervised the development and publication.</p></sec><sec><title>Funding</title><p>WC was supported by an Engineering and Physical Sciences Research Council grant (reference EP/V520056/1). LJB was supported by EPSRC funded studentships from the CDT in New and Sustainable Photovoltaics (reference EP/L01551X/1).</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>All data in this work were obtained using the freely available software and the parameter set listed in the Supplementary Information.</p></sec><sec sec-type="ethics-statement"><title>Declaration</title><sec id="FPar1" sec-type="COI-statement"><title>Conflict of interest</title><p id="Par79"> The authors have no relevant financial or non-financial interests to disclose.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Abdel, D. Courtier, N., Farrell, P.: Volume exclusion effects in perovskite charge transport modeling. In: 2022 International Conference on Numerical Simulation of Optoelectronic Devices (NUSOD), pp. 107–108 (2022)</mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdel</surname><given-names>D</given-names></name><name><surname>Vágner</surname><given-names>P</given-names></name><name><surname>Fuhrmann</surname><given-names>J</given-names></name><name><surname>Farrell</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Modelling charge transport in perovskite solar cells: potential-based and limiting ion depletion</article-title><source>Electrochim. Acta</source><year>2021</year><volume>390</volume><pub-id pub-id-type="doi">10.1016/j.electacta.2021.138696</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>AlQurashi</surname><given-names>A</given-names></name><name><surname>Selvakumar</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">A new approximation of Fermi–Dirac integrals of order 1/2 for degenerate semiconductor devices</article-title><source>Superlattices Microstruct.</source><year>2018</year><volume>118</volume><fpage>308</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1016/j.spmi.2018.03.072</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altermatt</surname><given-names>PP</given-names></name><name><surname>Schumacher</surname><given-names>JO</given-names></name><name><surname>Cuevas</surname><given-names>A</given-names></name><name><surname>Kerr</surname><given-names>MJ</given-names></name><name><surname>Glunz</surname><given-names>SW</given-names></name><name><surname>King</surname><given-names>RR</given-names></name><name><surname>Heiser</surname><given-names>G</given-names></name><name><surname>Schenk</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Numerical modeling of highly doped si:p emitters based on Fermi–Dirac statistics and self-consistent material parameters</article-title><source>J. Appl. Phys.</source><year>2002</year><volume>92</volume><fpage>3187</fpage><lpage>3197</lpage><pub-id pub-id-type="doi">10.1063/1.1501743</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alvarez</surname><given-names>AO</given-names></name><name><surname>Arcas</surname><given-names>R</given-names></name><name><surname>Aranda</surname><given-names>CA</given-names></name><name><surname>Bethencourt</surname><given-names>L</given-names></name><name><surname>Mas-Marzá</surname><given-names>E</given-names></name><name><surname>Saliba</surname><given-names>M</given-names></name><name><surname>Fabregat-Santiago</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Negative capacitance and inverted hysteresis: matching features in perovskite solar cells</article-title><source>J. Phys. Chem. Lett.</source><year>2020</year><volume>11</volume><fpage>8417</fpage><lpage>8423</lpage><pub-id pub-id-type="doi">10.1021/acs.jpclett.0c02331</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Anderson, N.J.: A Python Implementation of a Drift–Diffusion Model to Capture Ion Migration in Perovskite Solar Cells, thesis. University of Minnesota (2021)</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazant</surname><given-names>MZ</given-names></name></person-group><article-title xml:lang="en">Theory of chemical kinetics and charge transfer based on nonequilibrium thermodynamics</article-title><source>Acc. Chem. Res.</source><year>2013</year><volume>46</volume><fpage>1144</fpage><lpage>1160</lpage><pub-id pub-id-type="doi">10.1021/ar300145c</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Bennett, L.J., Riquelme, A.J., Courtier, N.E., Anta, J.A., Richardson, G.: A new ideality factor for perovskite solar cells and an analytical theory for their impedance spectroscopy response (2021). <ext-link xlink:href="http://arxiv.org/abs/2105.11226" ext-link-type="uri">arXiv:2105.11226</ext-link></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blakemore</surname><given-names>JS</given-names></name></person-group><article-title xml:lang="en">Approximations for Fermi–Dirac integrals, especially the function used to describe electron density in a semiconductor</article-title><source>Solid State Electron.</source><year>1982</year><volume>25</volume><fpage>1067</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1016/0038-1101(82)90143-5</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borukhov</surname><given-names>I</given-names></name><name><surname>Andelman</surname><given-names>D</given-names></name><name><surname>Orland</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Steric effects in electrolytes: a modified Poisson–Boltzmann equation</article-title><source>Phys. Rev. Lett.</source><year>1997</year><volume>79</volume><fpage>435</fpage><lpage>438</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.79.435</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bässler</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Charge transport in disordered organic photoconductors. A Monte Carlo simulation study</article-title><source>Phys. Status Solidi B (Basic Res.)</source><year>1993</year><volume>175</volume><fpage>15</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1002/pssb.2221750102</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burger</surname><given-names>M</given-names></name><name><surname>Schlake</surname><given-names>B</given-names></name><name><surname>Wolfram</surname><given-names>M-T</given-names></name></person-group><article-title xml:lang="en">Nonlinear Poisson–Nrnst–Planck equations for ion flux through confined geometries</article-title><source>Nonlinearity</source><year>2012</year><volume>25</volume><fpage>961</fpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2891554</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1236.92011</pub-id><pub-id pub-id-type="doi">10.1088/0951-7715/25/4/961</pub-id></mixed-citation></ref><ref id="CR13"><label>13.
</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calado</surname><given-names>P</given-names></name><name><surname>Gelmetti</surname><given-names>I</given-names></name><name><surname>Hilton</surname><given-names>B</given-names></name><name><surname>Azzouzi</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>J</given-names></name><name><surname>Barnes</surname><given-names>PRF</given-names></name></person-group><article-title xml:lang="en">Driftfusion: an open source code for simulating ordered semiconductor devices with mixed ionic–electronic conducting materials in one dimension</article-title><source>J. Comput. Electron.</source><year>2022</year><volume>21</volume><fpage>960</fpage><lpage>991</lpage><pub-id pub-id-type="doi">10.1007/s10825-021-01827-z</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castro-Chong</surname><given-names>A</given-names></name><name><surname>Riquelme</surname><given-names>AJ</given-names></name><name><surname>Aernouts</surname><given-names>T</given-names></name><name><surname>Bennett</surname><given-names>LJ</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Illumination intensity dependence of the recombination mechanism in mixed perovskite solar cells</article-title><source>ChemPlusChem</source><year>2021</year><volume>86</volume><fpage>1347</fpage><lpage>1356</lpage><pub-id pub-id-type="doi">10.1002/cplu.202100233</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cave</surname><given-names>JM</given-names></name><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Blakborn</surname><given-names>IA</given-names></name><name><surname>Jones</surname><given-names>TW</given-names></name><name><surname>Ghosh</surname><given-names>D</given-names></name><name><surname>Anderson</surname><given-names>KF</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><name><surname>Dijkhoff</surname><given-names>AA</given-names></name><name><surname>Wilson</surname><given-names>GJ</given-names></name><name><surname>Feron</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Deducing transport properties of mobile vacancies from perovskite solar cell characteristics</article-title><source>J. Appl. Phys.</source><year>2020</year><volume>128</volume><pub-id pub-id-type="doi">10.1063/5.0021849</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Clarke, W., Wolf, M., Walker, A., Richardson, G.: Assessing the importance of the generalised Einstein relation for electrons and holes in transport layers of metal-halide perovskite based solar cells (unpublished) (2022)</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Interpreting ideality factors for planar perovskite solar cells: ectypal diode theory for steady-state operation</article-title><source>Phys. Rev. Appl.</source><year>2020</year><volume>14</volume><pub-id pub-id-type="doi">10.1103/PhysRevApplied.14.024031</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Cave</surname><given-names>JM</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">How transport layer properties affect perovskite solar cell performance: insights from a coupled charge transport/ion migration model</article-title><source>Energy Environ. Sci.</source><year>2019</year><volume>12</volume><fpage>396</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1039/C8EE01576G</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Cave</surname><given-names>JM</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">Ionmonger: a free and fast planar perovskite solar cell simulator with coupled ion vacancy and charge carrier dynamics</article-title><source>J. Comput. Electron.</source><year>2019</year><volume>18</volume><fpage>1435</fpage><lpage>1449</lpage><pub-id pub-id-type="doi">10.1007/s10825-019-01396-2</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">A fast and robust numerical scheme for solving models of charge carrier transport and ion vacancy motion in perovskite solar cells</article-title><source>Appl. Math. Model.</source><year>2018</year><volume>63</volume><fpage>329</fpage><lpage>348</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3844296</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1480.82018</pub-id><pub-id pub-id-type="doi">10.1016/j.apm.2018.06.051</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Córdoba</surname><given-names>M</given-names></name><name><surname>Unmüssig</surname><given-names>M</given-names></name><name><surname>Herterich</surname><given-names>J</given-names></name><name><surname>Würfel</surname><given-names>U</given-names></name><name><surname>Taretto</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Interpretation of slow electroluminescence and open circuit voltage transient response in cs-based perovskite solar cells</article-title><source>J. Appl. Phys.</source><year>2021</year><volume>130</volume><pub-id pub-id-type="doi">10.1063/5.0065983</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derewjanko</surname><given-names>D</given-names></name><name><surname>Scheunemann</surname><given-names>D</given-names></name><name><surname>Järsvall</surname><given-names>E</given-names></name><name><surname>Hofmann</surname><given-names>AI</given-names></name><name><surname>Müller</surname><given-names>C</given-names></name><etal/></person-group><article-title xml:lang="en">Delocalization enhances conductivity at high doping concentrations</article-title><source>Adv. Funct. Mater.</source><year>2022</year><volume>32</volume><fpage>2112262</fpage><pub-id pub-id-type="doi">10.1002/adfm.202112262</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diekmann</surname><given-names>J</given-names></name><name><surname>Caprioglio</surname><given-names>P</given-names></name><name><surname>Futscher</surname><given-names>MH</given-names></name><name><surname>Le Corre</surname><given-names>VM</given-names></name><name><surname>Reichert</surname><given-names>S</given-names></name><name><surname>Jaiser</surname><given-names>F</given-names></name><name><surname>Arvind</surname><given-names>M</given-names></name><name><surname>Toro</surname><given-names>LP</given-names></name><name><surname>Gutierrez-Partida</surname><given-names>E</given-names></name><name><surname>Peña-Camargo</surname><given-names>F</given-names></name><name><surname>Deibel</surname><given-names>C</given-names></name><name><surname>Ehrler</surname><given-names>B</given-names></name><name><surname>Unold</surname><given-names>T</given-names></name><name><surname>Kirchartz</surname><given-names>T</given-names></name><name><surname>Neher</surname><given-names>D</given-names></name><name><surname>Stolterfoht</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Pathways toward 30% efficient single-junction perovskite solar cells and the role of mobile ions</article-title><source>Solar RRL</source><year>2021</year><volume>5</volume><fpage>2100219</fpage><pub-id pub-id-type="doi">10.1002/solr.202100219</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebadi</surname><given-names>F</given-names></name><name><surname>Taghavinia</surname><given-names>N</given-names></name><name><surname>Mohammadpour</surname><given-names>R</given-names></name><name><surname>Hagfeldt</surname><given-names>A</given-names></name><name><surname>Tress</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Origin of apparent light-enhanced and negative capacitance in perovskite solar cells</article-title><source>Nat. Commun.</source><year>2019</year><volume>10</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-09079-z</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name><name><surname>Leijtens</surname><given-names>T</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">A model for the operation of perovskite based hybrid solar cells: formulation, analysis, and comparison to experiment</article-title><source>SIAM J. Appl. Math.</source><year>2014</year><volume>74</volume><fpage>1935</fpage><lpage>1966</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3291540</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1315.82024</pub-id><pub-id pub-id-type="doi">10.1137/130934258</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukushima</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Precise and fast computation of Fermi–Dirac integral of integer and half integer order by piecewise minimax rational approximation</article-title><source>Appl. Math. Comput.</source><year>2015</year><volume>259</volume><fpage>708</fpage><lpage>729</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3338406</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1464.65024</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">García-Rodríguez, R., Riquelme, A.J., Cowley, M., Valadez-Villalobos, K., Oskam, G., Bennett, L.J., Wolf, M.J., Contreras-Bernal, L., Cameron, P.J., Walker, A.B., Anta, J.A.: Inverted hysteresis in n-i-p and p-i-n perovskite solar cells. Energy Technol. 2200507 (2022)</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>García-Rodríguez</surname><given-names>R</given-names></name><name><surname>Ferdani</surname><given-names>D</given-names></name><name><surname>Pering</surname><given-names>S</given-names></name><name><surname>Baker</surname><given-names>PJ</given-names></name><name><surname>Cameron</surname><given-names>PJ</given-names></name></person-group><article-title xml:lang="en">Influence of bromide content on iodide migration in inverted MAPb (I 1–x Br x) 3 perovskite solar cells</article-title><source>J. Mater. Chem. A</source><year>2019</year><volume>7</volume><fpage>22604</fpage><lpage>22614</lpage><pub-id pub-id-type="doi">10.1039/C9TA08848B</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Glazer</surname><given-names>M</given-names></name><name><surname>Wark</surname><given-names>J</given-names></name></person-group><source>Statistical Mechanics: A Survival Guide</source><year>2001</year><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1012.82001</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grasser</surname><given-names>T</given-names></name><name><surname>Ting-Wei</surname><given-names>T</given-names></name><name><surname>Kosina</surname><given-names>H</given-names></name><name><surname>Selberherr</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A review of hydrodynamic and energy-transport models for semiconductor device simulation</article-title><source>Proc. IEEE</source><year>2003</year><volume>91</volume><fpage>251</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1109/JPROC.2002.808150</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guerrero</surname><given-names>A</given-names></name><name><surname>Garcia-Belmonte</surname><given-names>G</given-names></name><name><surname>Mora-Sero</surname><given-names>I</given-names></name><name><surname>Bisquert</surname><given-names>J</given-names></name><name><surname>Kang</surname><given-names>YS</given-names></name><name><surname>Jacobsson</surname><given-names>TJ</given-names></name><name><surname>Correa-Baena</surname><given-names>J-P</given-names></name><name><surname>Hagfeldt</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Properties of contact and bulk impedances in hybrid lead halide perovskite solar cells including inductive loop elements</article-title><source>J. Phys. Chem. C</source><year>2016</year><volume>120</volume><fpage>8023</fpage><lpage>8032</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcc.6b01728</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Mansfeld</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Exploring the use of electrochemical impedance spectroscopy (eis) in microbial fuel cell studies</article-title><source>Energy Environ. Sci.</source><year>2009</year><volume>2</volume><fpage>215</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1039/B814914C</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horowitz</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Validity of the concept of band edge in organic semiconductors</article-title><source>J. Appl. Phys.</source><year>2015</year><volume>118</volume><pub-id pub-id-type="doi">10.1063/1.4931061</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howey</surname><given-names>DA</given-names></name><name><surname>Roberts</surname><given-names>SA</given-names></name><name><surname>Viswanathan</surname><given-names>V</given-names></name><name><surname>Mistry</surname><given-names>A</given-names></name><name><surname>Beuse</surname><given-names>M</given-names></name><name><surname>Khoo</surname><given-names>E</given-names></name><name><surname>DeCaluwe</surname><given-names>SC</given-names></name><name><surname>Sulzer</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Free radicals: making a case for battery modeling</article-title><source>Electrochem. Soc. Interface</source><year>2020</year><volume>29</volume><fpage>30</fpage><pub-id pub-id-type="doi">10.1149/2.F03204IF</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>I</given-names></name><name><surname>McNeill</surname><given-names>CR</given-names></name><name><surname>Greenham</surname><given-names>NC</given-names></name></person-group><article-title xml:lang="en">Drift-diffusion modeling of photocurrent transients in bulk heterojunction solar cells</article-title><source>J. Appl. Phys.</source><year>2009</year><volume>106</volume><pub-id pub-id-type="doi">10.1063/1.3247547</pub-id></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">IonMonger Modelling (2022). <ext-link xlink:href="https://www.youtube.com/@ionmongermodelling" ext-link-type="uri">https://www.youtube.com/@ionmongermodelling </ext-link></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jacoboni</surname><given-names>C</given-names></name></person-group><source>Theory of Electron Transport in Semiconductors: A Pathway from Elementary Physics to Nonequilibrium Green Functions</source><year>2010</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jüttner</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Electrochemical impedance spectroscopy (EIS) of corrosion processes on inhomogeneous surfaces</article-title><source>Electrochim. Acta</source><year>1990</year><volume>35</volume><fpage>1501</fpage><lpage>1508</lpage><pub-id pub-id-type="doi">10.1016/0013-4686(90)80004-8</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>J</given-names></name><name><surname>Nelson</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Theoretical study of the transfer integral and density of states in spiro-linked triphenylamine derivatives</article-title><source>J. Chem. Phys.</source><year>2005</year><volume>123</volume><pub-id pub-id-type="doi">10.1063/1.1993560</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koster</surname><given-names>LJA</given-names></name><name><surname>Smits</surname><given-names>ECF</given-names></name><name><surname>Mihailetchi</surname><given-names>VD</given-names></name><name><surname>Blom</surname><given-names>PWM</given-names></name></person-group><article-title xml:lang="en">Device model for the operation of polymer/fullerene bulk heterojunction solar cells</article-title><source>Phys. Rev. B</source><year>2005</year><volume>72</volume><fpage>085205</fpage><pub-id pub-id-type="doi">10.1103/PhysRevB.72.085205</pub-id></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kralj-Iglič</surname><given-names>V</given-names></name><name><surname>Iglič</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A simple statistical mechanical approach to the free energy of the electric double layer including the excluded volume effect</article-title><source>J. Phys.</source><year>1996</year><volume>II</volume><issue>6</issue><fpage>477</fpage><lpage>491</lpage></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Corre</surname><given-names>VM</given-names></name><name><surname>Diekmann</surname><given-names>J</given-names></name><name><surname>Peña-Camargo</surname><given-names>F</given-names></name><name><surname>Thiesbrummel</surname><given-names>J</given-names></name><name><surname>Tokmoldin</surname><given-names>N</given-names></name><etal/></person-group><article-title xml:lang="en">Quantification of efficiency losses due to mobile ions in perovskite solar cells via fast hysteresis measurements</article-title><source>Solar RRL</source><year>2022</year><volume>6</volume><fpage>2100772</fpage><pub-id pub-id-type="doi">10.1002/solr.202100772</pub-id></mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Kan</surname><given-names>C</given-names></name><name><surname>Hang</surname><given-names>P</given-names></name><name><surname>Yao</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zhong</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Revealing the correlation of light soaking effect with ion migration in perovskite solar cells</article-title><source>Solar RRL</source><year>2022</year><volume>6</volume><fpage>2200050</fpage><pub-id pub-id-type="doi">10.1002/solr.202200050</pub-id></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>SE</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Peng</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">An electrochemistry-based impedance model for lithium-ion batteries</article-title><source>J. Power Sources</source><year>2014</year><volume>258</volume><fpage>9</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2014.02.045</pub-id></mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">Effect of ion vacancy migration on open-circuit voltage of perovskite solar cells</article-title><source>Phys. Status Solidi (a)</source><year>2022</year><volume>219</volume><fpage>2100472</fpage><pub-id pub-id-type="doi">10.1002/pssa.202100472</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">Influence of ion vacancy migration on short-circuit current of perovskite solar cells</article-title><source>Phys. Status Solidi (a)</source><year>2022</year><volume>219</volume><fpage>2200262</fpage><pub-id pub-id-type="doi">10.1002/pssa.202200262</pub-id></mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">MATLAB version 9.12.0.1975300 (2022)</mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>JA</given-names></name></person-group><source>The Physics of Solar Cells</source><year>2003</year><publisher-loc>Singapore</publisher-loc><publisher-name>World Scientific Publishing Company</publisher-name><pub-id pub-id-type="doi">10.1142/p276</pub-id></mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neukom</surname><given-names>MT</given-names></name><name><surname>Schiller</surname><given-names>A</given-names></name><name><surname>Züfle</surname><given-names>S</given-names></name><name><surname>Knapp</surname><given-names>E</given-names></name><name><surname>Ávila</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Consistent device simulation model describing perovskite solar cells in steady-state, transient, and frequency domain</article-title><source>ACS Appl. Mater. Interfaces</source><year>2019</year><volume>11</volume><fpage>23320</fpage><lpage>23328</lpage><pub-id pub-id-type="doi">10.1021/acsami.9b04991</pub-id></mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novikov</surname><given-names>SV</given-names></name><name><surname>Dunlap</surname><given-names>DH</given-names></name><name><surname>Kenkre</surname><given-names>VM</given-names></name><name><surname>Parris</surname><given-names>PE</given-names></name><name><surname>Vannikov</surname><given-names>AV</given-names></name></person-group><article-title xml:lang="en">Essential role of correlations in governing charge transport in disordered organic materials</article-title><source>Phys. Rev. Lett.</source><year>1998</year><volume>81</volume><fpage>4472</fpage><lpage>4475</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.81.4472</pub-id></mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Orazem</surname><given-names>ME</given-names></name><name><surname>Tribollet</surname><given-names>B</given-names></name></person-group><source>Electrochemical Impedance Spectroscopy</source><year>2008</year><publisher-loc>Hoboken</publisher-loc><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/9780470381588</pub-id></mixed-citation></ref><ref id="CR52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paasch</surname><given-names>G</given-names></name><name><surname>Scheinert</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Charge carrier density of organics with Gaussian density of states: analytical approximation for the Gauss–Fermi integral</article-title><source>J. Appl. Phys.</source><year>2010</year><volume>107</volume><pub-id pub-id-type="doi">10.1063/1.3374475</pub-id></mixed-citation></ref><ref id="CR53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pockett</surname><given-names>A</given-names></name><name><surname>Eperon</surname><given-names>GE</given-names></name><name><surname>Sakai</surname><given-names>N</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name><name><surname>Peter</surname><given-names>LM</given-names></name><name><surname>Cameron</surname><given-names>PJ</given-names></name></person-group><article-title xml:lang="en">Microseconds, milliseconds and seconds: deconvoluting the dynamic behaviour of planar perovskite solar cells</article-title><source>Phys. Chem. Chem. Phys.</source><year>2017</year><volume>19</volume><fpage>5959</fpage><lpage>5970</lpage><pub-id pub-id-type="doi">10.1039/C6CP08424A</pub-id></mixed-citation></ref><ref id="CR54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riquelme</surname><given-names>A</given-names></name><name><surname>Bennett</surname><given-names>LJ</given-names></name><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Wolf</surname><given-names>MJ</given-names></name><name><surname>Contreras-Bernal</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Identification of recombination losses and charge collection efficiency in a perovskite solar cell by comparing impedance response to a drift–diffusion model</article-title><source>Nanoscale</source><year>2020</year><volume>12</volume><fpage>17385</fpage><lpage>17398</lpage><pub-id pub-id-type="doi">10.1039/D0NR03058A</pub-id></mixed-citation></ref><ref id="CR55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riquelme</surname><given-names>AJ</given-names></name><name><surname>Valadez-Villalobos</surname><given-names>K</given-names></name><name><surname>Boix</surname><given-names>PP</given-names></name><name><surname>Oskam</surname><given-names>G</given-names></name><name><surname>Mora-Seró</surname><given-names>I</given-names></name><name><surname>Anta</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Understanding equivalent circuits in perovskite solar cells. insights from drift–diffusion simulation</article-title><source>Phys. Chem. Chem. Phys.</source><year>2022</year><volume>24</volume><fpage>15657</fpage><lpage>15671</lpage><pub-id pub-id-type="doi">10.1039/D2CP01338J</pub-id></mixed-citation></ref><ref id="CR56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sacco</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Electrochemical impedance spectroscopy: fundamentals and application in dye-sensitized solar cells</article-title><source>Renew. Sustain. Energy Rev.</source><year>2017</year><volume>79</volume><fpage>814</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2017.05.159</pub-id></mixed-citation></ref><ref id="CR57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sallenave</surname><given-names>X</given-names></name><name><surname>Shasti</surname><given-names>M</given-names></name><name><surname>Anaraki</surname><given-names>EH</given-names></name><name><surname>Volyniuk</surname><given-names>D</given-names></name><name><surname>Grazulevicius</surname><given-names>JV</given-names></name><etal/></person-group><article-title xml:lang="en">Interfacial and bulk properties of hole transporting materials in perovskite solar cells: spiro-MeTAD versus spiro-OMeTAD</article-title><source>J. Mater. Chem. A</source><year>2020</year><volume>8</volume><fpage>8527</fpage><lpage>8539</lpage><pub-id pub-id-type="doi">10.1039/D0TA00623H</pub-id></mixed-citation></ref><ref id="CR58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selvaggi</surname><given-names>JP</given-names></name></person-group><article-title xml:lang="en">Analytical evaluation of the charge carrier density of organic materials with a Gaussian density of states revisited</article-title><source>J. Comput. Electron.</source><year>2018</year><volume>17</volume><fpage>61</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1007/s10825-017-1113-5</pub-id></mixed-citation></ref><ref id="CR59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sulzer</surname><given-names>V</given-names></name><name><surname>Marquis</surname><given-names>SG</given-names></name><name><surname>Timms</surname><given-names>R</given-names></name><name><surname>Robinson</surname><given-names>M</given-names></name><name><surname>Chapman</surname><given-names>SJ</given-names></name></person-group><article-title xml:lang="en">Python battery mathematical modelling (pybamm)</article-title><source>J.
Open Res. Softw.</source><year>2021</year><volume>9</volume><fpage>14</fpage><pub-id pub-id-type="doi">10.5334/jors.309</pub-id></mixed-citation></ref><ref id="CR60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tessler</surname><given-names>N</given-names></name><name><surname>Roichman</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Amorphous organic molecule/polymer diodes and transistors-comparison between predictions based on Gaussian or exponential density of states</article-title><source>Org. Electron.</source><year>2005</year><volume>6</volume><fpage>200</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1016/j.orgel.2005.06.006</pub-id></mixed-citation></ref><ref id="CR61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tessler</surname><given-names>N</given-names></name><name><surname>Vaynzof</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Insights from device modeling of perovskite solar cells</article-title><source>ACS Energy Lett.</source><year>2020</year><volume>5</volume><fpage>1260</fpage><lpage>1270</lpage><pub-id pub-id-type="doi">10.1021/acsenergylett.0c00172</pub-id></mixed-citation></ref><ref id="CR62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walsh</surname><given-names>A</given-names></name><name><surname>Scanlon</surname><given-names>DO</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Gong</surname><given-names>XG</given-names></name><name><surname>Wei</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Self-regulation mechanism for charged point defects in hybrid halide perovskites</article-title><source>Angew. Chem.</source><year>2015</year><volume>127</volume><fpage>1811</fpage><lpage>1814</lpage><pub-id pub-id-type="doi">10.1002/ange.201409740</pub-id></mixed-citation></ref><ref id="CR63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q-K</given-names></name><name><surname>He</surname><given-names>Y-J</given-names></name><name><surname>Shen</surname><given-names>J-N</given-names></name><name><surname>Hu</surname><given-names>X-S</given-names></name><name><surname>Ma</surname><given-names>Z-F</given-names></name></person-group><article-title xml:lang="en">State of charge-dependent polynomial equivalent circuit modeling for electrochemical impedance spectroscopy of lithium-ion batteries</article-title><source>IEEE Trans. Power Electron.</source><year>2017</year><volume>33</volume><fpage>8449</fpage><lpage>8460</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2780184</pub-id></mixed-citation></ref><ref id="CR64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>SA</given-names></name><name><surname>McAlister</surname><given-names>SP</given-names></name><name><surname>Li</surname><given-names>Z-M</given-names></name></person-group><article-title xml:lang="en">A comparison of some approximations for the Fermi–Dirac integral of order 1/2</article-title><source>Solid-State Electron.</source><year>2017</year><volume>37</volume><fpage>61</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/0038-1101(94)90105-8</pub-id></mixed-citation></ref><ref id="CR65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Qin</surname><given-names>M</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Qin</surname><given-names>Z</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Control over light soaking effect in all-inorganic perovskite solar cells</article-title><source>Adv. Funct. Mater.</source><year>2021</year><volume>31</volume><fpage>2101287</fpage><pub-id pub-id-type="doi">10.1002/adfm.202101287</pub-id></mixed-citation></ref><ref id="CR66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yavuz</surname><given-names>I</given-names></name><name><surname>Houk</surname><given-names>KN</given-names></name></person-group><article-title xml:lang="en">Mesoscale ordering and charge-transport of crystalline Spiro-OMeTAD organic semiconductors</article-title><source>J. Phys. Chem. C</source><year>2017</year><volume>121</volume><fpage>993</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcc.6b08624</pub-id></mixed-citation></ref><ref id="CR67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>C</given-names></name><name><surname>Hao</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Ion migration in organic–inorganic hybrid perovskite solar cells: current understanding and perspectives</article-title><source>Small</source><year>2022</year><volume>18</volume><fpage>2105783</fpage><pub-id pub-id-type="doi">10.1002/smll.202105783</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1"><sec id="Sec31"><title>Appendix: The full charge transport model</title><p id="Par80">In this section we state the full charge transport model solved by IonMonger 2.0. The notation is consistent between versions 1.0 and 2.0; a complete list of symbols and their definitions is provided in the SI. For an overview of the changes between the versions of IonMonger, refer to Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="Tab1" ref-type="table">1</xref>. In order to make use of model extensions, the parameters listed in Table <xref rid="Tab1" ref-type="table">1</xref> need to be specified, via the parameters file, otherwise they are set to their default values for backwards compatibility. With or without the model extensions, IonMonger 2.0 outperforms 1.0 due to improvements in the numerical implementation, as described in Sect. <xref rid="Sec24" ref-type="sec">7.1</xref>. Equations that have been altered by the model extensions are highlighted in bold.</p><p id="Par81"><italic>Perovskite absorber layer</italic> (<inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;x&lt;b$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq176.gif"/></alternatives></inline-formula>) Following [<xref ref-type="bibr" rid="CR19">19</xref>], our model comprises statements of conservation of conduction electrons, valence holes, and halide ion vacancies,<disp-formula id="Equ47"><label>40</label><alternatives><mml:math display="block" id="Equ47_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial P}{\partial t} + \frac{\partial {{F}^P}}{\partial x} = 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ47.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ48"><label>41</label><alternatives><mml:math display="block" id="Equ48_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial n}{\partial t} - \frac{1}{q} \frac{\partial {j^n}}{\partial x} = G(x,t) - R(n,p) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ48.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ49"><label>42</label><alternatives><mml:math display="block" id="Equ49_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial p}{\partial t} + \frac{1}{q} \frac{\partial {j^p}}{\partial x} = G(x,t) - R(n,p), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ49.gif" position="anchor"/></alternatives></disp-formula>as well as drift–diffusion equations for the fluxes of these species,<disp-formula id="Equ50"><label>43</label><alternatives><mml:math display="block" id="Equ50_Math"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="bold">no</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">steric</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">effects</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="bold">lim</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="bold">lim</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="bold">nonlinear</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">diffusion</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="bold">lim</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mi mathvariant="bold">lim</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="bold">nonlinear</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">drift</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{F}^{\varvec{P}} {\mathbf{ =}} \left\{ {\begin{array}{*{20}l} { - \varvec{D}_{{\mathbf{I}}} \left( {\frac{{{\boldsymbol{\partial }}\varvec{P}}}{{{\boldsymbol{\partial }}\varvec{x}}} + \frac{\varvec{P}}{{\varvec{V}_{\varvec{T}} }}\frac{{{\boldsymbol{\partial }}\boldsymbol{\phi }}}{{{\boldsymbol{\partial }}\varvec{x}}}} \right)} \hfill &amp; {{\mathbf{no}}\,{\mathbf{steric}}\,{\mathbf{effects}}} \hfill \\ { - \varvec{D}_{{\mathbf{I}}} \left( {\frac{{\varvec{P}_{{{\mathbf{lim}}}} }}{{\varvec{P}_{{{\mathbf{lim}}}} - \varvec{P}}}\frac{{{\boldsymbol{\partial }}\varvec{P}}}{{{\boldsymbol{\partial }}\varvec{x}}} + \frac{\varvec{P}}{{\varvec{V}_{\varvec{T}} }}\frac{{{\boldsymbol{\partial }}\boldsymbol{\phi }}}{{{\boldsymbol{\partial }}\varvec{x}}}} \right)} \hfill &amp; {{\mathbf{nonlinear}}\,{\mathbf{diffusion}}} \hfill \\ { - \varvec{D}_{{\mathbf{I}}} \left( {\frac{{{\boldsymbol{\partial }}\varvec{P}}}{{{\boldsymbol{\partial }}\varvec{x}}} + \frac{\varvec{P}}{{\varvec{V}_{\varvec{T}} }}\frac{{\varvec{P}_{{{\mathbf{lim}}}} - \varvec{P}}}{{\varvec{P}_{{{\mathbf{lim}}}} }}\frac{{{\boldsymbol{\partial }}\boldsymbol{\phi }}}{{{\boldsymbol{\partial }}\varvec{x}}}} \right)} \hfill &amp; {{\mathbf{nonlinear}}\,{\mathbf{drift}}} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ50.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ51"><label>44</label><alternatives><mml:math display="block" id="Equ51_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{j^n}=qD_n \left( \frac{\partial n}{\partial x} - \frac{n}{V_T} \frac{\partial \phi }{\partial x} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ51.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ52"><label>45</label><alternatives><mml:math display="block" id="Equ52_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{j^p}=-qD_{p} \left( \frac{\partial p}{\partial x} + \frac{p}{V_T} \frac{\partial \phi }{\partial x} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ52.gif" position="anchor"/></alternatives></disp-formula>Charge carrier photo-generation and recombination within the perovskite are included via the functions <italic>G</italic>(<italic>x</italic>, <italic>t</italic>) and <italic>R</italic>(<italic>n</italic>, <italic>p</italic>), respectively. These are coupled with Poisson’s equation for the electric potential,<disp-formula id="Equ53"><label>46</label><alternatives><mml:math display="block" id="Equ53_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _A}(\hat{N_0}-P+n-p). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ53.gif" position="anchor"/></alternatives></disp-formula>We assume a constant, uniform background density (<inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{N_0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq177.gif"/></alternatives></inline-formula>) of immobile cation vacancies.</p><p id="Par82"><italic>Electron transport layer</italic> (<inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-b_\textrm{E}&lt;x&lt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq178.gif"/></alternatives></inline-formula>) We model only the majority carriers (the free electrons) through the ETL using a conservation equation, supplemented with a definition of the flux, coupled to Poisson’s equation. <disp-formula id="Equ54"><label>47a</label><alternatives><mml:math display="block" id="Equ54_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial n}{\partial t} - \frac{1}{q} \frac{\partial {j^n}}{\partial x} = 0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ54.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ55"><label>47b</label><alternatives><mml:math display="block" id="Equ55_Math"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Tn</mml:mi></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{j}^{\varvec{n}} {\mathbf{ =}} \varvec{\mu }_{{\mathbf{E}}} \varvec{k}_{{\mathbf{B}}} \varvec{Tn}\frac{{\boldsymbol{\partial }}}{{{\boldsymbol{\partial }}\varvec{x}}}\left[ {{\boldsymbol{\mathcal{S}}}_{{\mathbf{E}}}^{{ - 1}} \left( {\frac{\varvec{n}}{{\varvec{g}_{{\mathbf{c}}}^{{\mathbf{E}}} }}} \right) - \frac{{\varvec{q\phi }}}{{\varvec{k}_{{\mathbf{B}}} \varvec{T}}}} \right],$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ55.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ56"><label>47c</label><alternatives><mml:math display="block" id="Equ56_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _\textrm{E}}(n-d_\textrm{E}). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ56.gif" position="anchor"/></alternatives></disp-formula> Here <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}_\textrm{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq179.gif"/></alternatives></inline-formula> denotes the statistical integral for the ETL and we use a superscript <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq180.gif"/></alternatives></inline-formula> to denote the inverse function.</p><p id="Par83">On the external boundary with the metal contact, we impose Ohmic boundary conditions which read <disp-formula id="Equ57"><label>48a</label><alternatives><mml:math display="block" id="Equ57_Math"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mi mathvariant="bold">ct</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msubsup></mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{n}|_{{\varvec{x} {\mathbf{ =}} - \varvec{b}_{{\mathbf{E}}} }} = g_{{\mathbf{c}}}^{{\mathbf{E}}} {\boldsymbol{\mathcal{S}}}_{{\mathbf{E}}} \left( {\frac{{\varvec{E}_{{{\mathbf{ct}}}} - \varvec{E}_{{\mathbf{c}}}^{{\mathbf{E}}} }}{{{\mathbf{V}}_{\varvec{T}} }}} \right),$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ57.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ58"><label>48b</label><alternatives><mml:math display="block" id="Equ58_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>bi</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\phi |_{x=-b_\textrm{E}} = \frac{V_\textrm{bi}-V(t)}{2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ58.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:msub><mml:mi>E</mml:mi><mml:mtext>ct</mml:mtext></mml:msub></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_\textrm{ct}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq181.gif"/></alternatives></inline-formula> is the workfunction of the cathode, <italic>V</italic>(<italic>t</italic>) is the applied voltage and the built-in voltage <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:msub><mml:mi>V</mml:mi><mml:mtext>bi</mml:mtext></mml:msub></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{bi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq182.gif"/></alternatives></inline-formula> is defined as the difference between the workfunctions of the two metal contacts, i.e. <inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>bi</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>ct</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mtext>an</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\textrm{bi} = E_\textrm{ct}-E_\textrm{an}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq183.gif"/></alternatives></inline-formula>.</p><p id="Par84"><italic>Hole transport layer </italic>(<inline-formula id="IEq184"><alternatives><mml:math id="IEq184_Math"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq184_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b&lt;x&lt;b+b_\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq184.gif"/></alternatives></inline-formula>) Similar to the model statement in the ETL, we model the HTL using <disp-formula id="Equ59"><label>49a</label><alternatives><mml:math display="block" id="Equ59_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial p}{\partial t} + \frac{1}{q} \frac{\partial {j^p}}{\partial x} = 0 , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ59.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ60"><label>49b</label><alternatives><mml:math display="block" id="Equ60_Math"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Tp</mml:mi></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">∂</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{j}^{\varvec{p}} {\mathbf{ =}} \boldsymbol{\mu }_{{\mathbf{H}}} \varvec{k}_{{\mathbf{B}}} \varvec{Tp}\frac{{\boldsymbol{\partial }}}{{{\boldsymbol{\partial }}\varvec{x}}}\left[ {{\boldsymbol{\mathcal{S}}}_{{\mathbf{H}}}^{{ - 1}} \left( {\frac{\varvec{p}}{{\varvec{g}_{{\mathbf{v}}}^{{\mathbf{H}}} }}} \right) - \frac{{\varvec{q}}\boldsymbol{\phi }}{{\varvec{k}_{{\mathbf{B}}} \varvec{T}}}} \right],$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ60.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ61"><label>49c</label><alternatives><mml:math display="block" id="Equ61_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _\textrm{H}}(d_\textrm{H}-p). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ61.gif" position="anchor"/></alternatives></disp-formula> Here <inline-formula id="IEq185"><alternatives><mml:math id="IEq185_Math"><mml:msub><mml:mi>S</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:math><tex-math id="IEq185_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_\textrm{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq185.gif"/></alternatives></inline-formula> is statistical integral for the HTL.</p><p id="Par85">On the HTL/metal contact, we impose Ohmic boundary conditions which take into account the impact of parasitic resistances, <disp-formula id="Equ62"><label>50a</label><alternatives><mml:math display="block" id="Equ62_Math"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow><mml:mi mathvariant="bold">an</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{p}|_{{\varvec{x} {\mathbf{ =}} \varvec{b} + \varvec{b}_{{\mathbf{H}}} }} {\mathbf{ =}} \varvec{g}_{{\mathbf{v}}}^{{\mathbf{H}}} \boldsymbol{{\mathcal{S}}}_{{\mathbf{H}}} \left( {\frac{{\varvec{E}_{{\mathbf{v}}}^{{\mathbf{H}}} - \varvec{E}_{{{\mathbf{an}}}} }}{{\varvec{V}_{\varvec{T}} }}} \right),$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ62.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ63"><label>50b</label><alternatives><mml:math display="block" id="Equ63_Math"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mi mathvariant="bold">bi</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">AR</mml:mi></mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\boldsymbol{\phi }|_{{\varvec{x} = \varvec{b} + \varvec{b}_{{\mathbf{H}}} }} = - \frac{{\varvec{V}_{{{\mathbf{bi}}}} - \varvec{V}(\varvec{t})}}{{\mathbf{2}}} - \frac{{\varvec{R}_{{\mathbf{s}}} [\varvec{AR}_{{\mathbf{p}}} \varvec{j}^{{{\mathbf{p}},{\mathbf{H}}}} - \varvec{V}(\varvec{t})]}}{{\varvec{R}_{{\mathbf{p}}} + \varvec{R}_{{\mathbf{s}}} }}.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ63.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par86"><italic>Continuity conditions on the interfaces</italic> (<inline-formula id="IEq186"><alternatives><mml:math id="IEq186_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq186_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=b$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq187.gif"/></alternatives></inline-formula>) At both internal interfaces (where the perovskite abuts the TLs), we place the following continuity conditions. At the ETL/perovskite interface,<disp-formula id="Equ64"><label>51</label><alternatives><mml:math display="block" id="Equ64_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^n}|_{x=0^-}&amp;= {j^n}|_{x=0^+}-\bar{R_l}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ64.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ65"><label>52</label><alternatives><mml:math display="block" id="Equ65_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^p}&amp;= -q \bar{R_l}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ65.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ66"><label>53</label><alternatives><mml:math display="block" id="Equ66_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{F}^P}&amp;= 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ66.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ67"><label>54</label><alternatives><mml:math display="block" id="Equ67_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi |_{x=0^-}&amp;= \phi |_{x=0^+}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ67.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ68"><label>55</label><alternatives><mml:math display="block" id="Equ68_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varepsilon _{E}\frac{\partial \phi }{\partial x}\Big |_{x=0^-}&amp;= \varepsilon _A\frac{\partial \phi }{\partial x}\Big |_{x=0^+}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ68.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ69"><label>56</label><alternatives><mml:math display="block" id="Equ69_Math"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mi mathvariant="bold">exp</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mrow><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{d}_{{\mathbf{E}}} \varvec{k}_{{\mathbf{E}}} {\mathbf{exp}}\left[ {\boldsymbol{{\mathcal{S}}}_{{\mathbf{E}}}^{{{\mathbf{ - 1}}}} \left( {\frac{{\varvec{n}|_{{\varvec{x}{\mathbf{ = 0}}^{{\mathbf{ - }}} }} }}{{\varvec{g}_{{\mathbf{c}}}^{{\mathbf{E}}} }}} \right) - {\boldsymbol{\mathcal{S}}}_{{\mathbf{E}}}^{{{\mathbf{ - 1}}}} \left( {\frac{{\varvec{d}_{{\mathbf{E}}} }}{{\varvec{g}_{{\mathbf{c}}}^{{\mathbf{E}}} }}} \right)} \right] = \varvec{n}|_{{\varvec{x}{\mathbf{ = 0}}^{{\mathbf{ + }}} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ69.gif" position="anchor"/></alternatives></disp-formula>whereas those at the perovskite/HTL interface are<disp-formula id="Equ70"><label>57</label><alternatives><mml:math display="block" id="Equ70_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^p}|_{x=b^-}-\bar{R_r}&amp;= {j^p}|_{x=b^+}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ70.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ71"><label>58</label><alternatives><mml:math display="block" id="Equ71_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {j^n}&amp;= -q \bar{R_r}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ71.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ72"><label>59</label><alternatives><mml:math display="block" id="Equ72_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{F}^P}&amp;= 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ72.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ73"><label>60</label><alternatives><mml:math display="block" id="Equ73_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi |_{x=b^-}&amp;= \phi |_{x=b^+}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ73.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ74"><label>61</label><alternatives><mml:math display="block" id="Equ74_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varepsilon _A\frac{\partial \phi }{\partial x}\Big |_{x=b^-}&amp;= \varepsilon _\textrm{H}\frac{\partial \phi }{\partial x}\Big |_{x=b^+}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ74.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ75"><label>62</label><alternatives><mml:math display="block" id="Equ75_Math"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub><mml:mi mathvariant="bold">exp</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{p}|_{{\varvec{x}{\mathbf{ = }}\varvec{b}^{{\mathbf{ - }}} }} {\mathbf{ = }}\varvec{d}_{{\mathbf{H}}} \varvec{k}_{{\mathbf{H}}} {\mathbf{exp}}\left[ {{\mathbf{\mathcal{S}}}_{{\mathbf{H}}}^{{{\mathbf{ - 1}}}} \left( {\frac{{\varvec{p}|_{{\varvec{x}{\mathbf{ = }}\varvec{b}^{{\mathbf{ + }}} }} }}{{\varvec{g}_{{\mathbf{v}}}^{{\mathbf{H}}} }}} \right) - {\mathbf{\mathcal{S}}}_{{\mathbf{H}}}^{{{\mathbf{ - 1}}}} \left( {\frac{{\varvec{d}_{{\mathbf{H}}} }}{{\varvec{g}_{{\mathbf{v}}}^{{\mathbf{H}}} }}} \right)} \right].$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ75.gif" position="anchor"/></alternatives></disp-formula><italic>Generation and recombination rates</italic> If a wavelength-dependent generation profile (<xref rid="Equ37" ref-type="disp-formula">32</xref>) is not used, the generation rate is<disp-formula id="Equ76"><label>63</label><alternatives><mml:math display="block" id="Equ76_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>ph</mml:mtext></mml:msub><mml:mi>α</mml:mi><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x,t) = I_\textrm{s}(t)F_\textrm{ph} \alpha \exp \left( -\alpha \left[ \frac{b}{2}+l\left( x-\frac{b}{2}\right) \right] \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ76.gif" position="anchor"/></alternatives></disp-formula>The bulk recombination rate is<disp-formula id="Equ77"><label>64</label><alternatives><mml:math display="block" id="Equ77_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R(n,p)&amp;= \beta \left( np-n_i^2\right) \nonumber \\&amp;\quad +\frac{ np - n_i^2}{\tau _n p + \tau _{p} n + (\tau _n + \tau _{p})n_i} \nonumber \\&amp;\quad +(A_n n + A_{p} p)(np - n_i^2) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ77.gif" position="anchor"/></alternatives></disp-formula>and the interfacial recombination rates<xref ref-type="fn" rid="Fn4">4</xref> are<disp-formula id="Equ78"><label>65</label><alternatives><mml:math display="block" id="Equ78_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>β</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mtext>E</mml:mtext></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mtext>E</mml:mtext></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_l(n^+,p^+)&amp;=\frac{\beta _\textrm{E}}{k_\textrm{E}} \left( n^+p^+ - n_i^2\right) \nonumber \\&amp;\quad + \frac{n^+p^+-n_i^2}{\frac{k_\textrm{E}}{\nu _n^\textrm{E}}(p^++n_i) + \frac{1}{\nu _{p}^\textrm{E}}(n^++n_i)}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ78.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ79"><label>66</label><alternatives><mml:math display="block" id="Equ79_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>β</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mtext>H</mml:mtext></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mtext>H</mml:mtext></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mtext>H</mml:mtext></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_r(n^-,p^-)&amp;=\frac{\beta _\textrm{H}}{k_\textrm{H}} \left( n^-p^- - n_i^2\right) \nonumber \\&amp;\quad + \frac{n^-p^--n_i^2}{\frac{1}{\nu _n^\textrm{H}}(p^-+n_i) + \frac{k_\textrm{H}}{\nu _{p}^\textrm{H}}(n^-+n_i)}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_Equ79.gif" position="anchor"/></alternatives></disp-formula></p></sec></app><app id="App2" specific-use="web-only"><sec id="Sec32"><title>Supplementary Information</title><p id="Par87">Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/10825_2022_1988_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary file 1 (PDF 230 KB)</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary Information"><media mimetype="video" mime-subtype="mp4" xlink:href="MediaObjects/10825_2022_1988_MOESM2_ESM.mp4" position="anchor"><object-id pub-id-type="video-id">9XJH8q5CTGg4FMzMYXJi7B</object-id><caption xml:lang="en"><p>Supplementary file 2 (MP4 265 KB)</p></caption></media></supplementary-material></p></sec></app></app-group><fn-group><fn id="Fn1"><label>1</label><p id="Par88">We note that, while the code is open-source, a valid MATLAB license is still required to run IonMonger.</p></fn><fn id="Fn2"><label>2</label><p id="Par89">In MAPI (CH<inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msub><mml:mrow/><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq107.gif"/></alternatives></inline-formula>NH<inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msub><mml:mrow/><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq108.gif"/></alternatives></inline-formula>PbI<inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msub><mml:mrow/><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq109.gif"/></alternatives></inline-formula>), <inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>lim</mml:mtext></mml:msub><mml:mo>≈</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>27</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text {lim}}\approx 2 \times 10^{27}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq110.gif"/></alternatives></inline-formula>m<inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2022_1988_Article_IEq111.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR62">62</xref>].</p></fn><fn id="Fn3"><label>3</label><p id="Par90"><ext-link xlink:href="https://perovskitescmodelling.slack.com" ext-link-type="uri">https://perovskitescmodelling.slack.com</ext-link>.</p></fn><fn id="Fn4"><label>4</label><p id="Par91">These rates are equivalent to those previously used in IonMonger but are now coded in terms of the perovskite carrier concentrations adjacent to each interface.</p></fn></fn-group><notes notes-type="Misc"><title>Publisher's Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Electrical Engineering</facet-value><facet-value count="1">Engineering</facet-value><facet-value count="1">Mathematical and Computational Engineering</facet-value><facet-value count="1">Mechanical Engineering</facet-value><facet-value count="1">Optical and Electronic Materials</facet-value><facet-value count="1">Theoretical, Mathematical and Computational Physics</facet-value></facet><facet name="keyword"><facet-value count="1">Device simulation</facet-value><facet-value count="1">Drift–diffusion</facet-value><facet-value count="1">Impedance spectroscopy</facet-value><facet-value count="1">Ion migration</facet-value><facet-value count="1">IonMonger</facet-value><facet-value count="1">MATLAB</facet-value><facet-value count="1">Perovskite solar cell</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Computational Electronics</facet-value></facet><facet name="year"><facet-value count="1">2023</facet-value></facet><facet name="country"><facet-value count="1">United Kingdom</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
