<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s10825-019-01396-2</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">10825</journal-id><journal-id journal-id-type="doi">10.1007/10825.1572-8137</journal-id><journal-title-group><journal-title>Journal of Computational Electronics</journal-title><abbrev-journal-title abbrev-type="publisher">J Comput Electron</abbrev-journal-title></journal-title-group><issn pub-type="ppub">1569-8025</issn><issn pub-type="epub">1572-8137</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s10825-019-01396-2</article-id><article-id pub-id-type="manuscript">1396</article-id><article-id pub-id-type="doi">10.1007/s10825-019-01396-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">IonMonger: a free and fast planar perovskite solar cell simulator with coupled ion vacancy and charge carrier dynamics</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5714-1096</contrib-id><name><surname>Courtier</surname><given-names>N. E.</given-names></name><address><email>N.E.Courtier@soton.ac.uk</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs10825019013962_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7560-8411</contrib-id><name><surname>Cave</surname><given-names>J. M.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2232-9734</contrib-id><name><surname>Walker</surname><given-names>A. B.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au4"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6225-8590</contrib-id><name><surname>Richardson</surname><given-names>G.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6120-5734</contrib-id><name><surname>Foster</surname><given-names>J. M.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5491.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9297</institution-id><institution content-type="org-division">Mathematical Sciences</institution><institution content-type="org-name">University of Southampton</institution></institution-wrap><addr-line content-type="city">Southampton</addr-line><country country="GB">UK</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7340.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 1699</institution-id><institution content-type="org-division">Department of Physics</institution><institution content-type="org-name">University of Bath</institution></institution-wrap><addr-line content-type="city">Bath</addr-line><country country="GB">UK</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.4701.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0728 6636</institution-id><institution content-type="org-division">School of Mathematics and Physics</institution><institution content-type="org-name">University of Portsmouth</institution></institution-wrap><addr-line content-type="city">Portsmouth</addr-line><country country="GB">UK</country></aff></contrib-group><author-notes><corresp id="IDs10825019013962_cor1"><label>a</label><email>N.E.Courtier@soton.ac.uk</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>13</day><month>9</month><year>2019</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2019</year></pub-date><volume>18</volume><issue seq="35">4</issue><fpage>1435</fpage><lpage>1449</lpage><history><date date-type="registration"><day>19</day><month>8</month><year>2019</year></date><date date-type="online"><day>13</day><month>9</month><year>2019</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Details of an open-source planar perovskite solar cell simulator, which includes ion vacancy migration within the perovskite layer coupled to charge carrier transport throughout the perovskite and adjoining transport layers in one dimension, are presented. The model equations are discretised in space using a finite element scheme, and temporal integration of the resulting system of differential algebraic equations is carried out in MATLAB. The user is free to modify device parameters, as well as the incident illumination and applied voltage. Time-varying voltage and/or illumination protocols can be specified, e.g. to simulate current–voltage sweeps, or to track the open-circuit conditions as the illumination is varied. Typical simulations, e.g. current–voltage sweeps, only require computation times of seconds to minutes on a modern personal computer. An example set of hysteretic current–voltage curves is presented.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Perovskite solar cell</kwd><kwd>Drift–diffusion</kwd><kwd>Device simulation</kwd><kwd>Ion vacancy migration</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Engineering and Physical Sciences Research Council</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100000266</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">EP/L01551X/1</award-id><principal-award-recipient><name><surname>Courtier</surname><given-names>N. E.</given-names></name><name><surname>Cave</surname><given-names>J. M.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>40</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2019</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>Springer Science+Business Media, LLC, part of Springer Nature</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2019</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2019</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>8</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>19</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/10825_2019_Article_1396.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2019</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>11</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2019</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>11</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical and Computational Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Electrical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Theoretical, Mathematical and Computational Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Optical and Electronic Materials</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mechanical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="ESMHint"><title>Electronic supplementary material</title><p>The online version of this article (<ext-link xlink:href="10.1007/s10825-019-01396-2" ext-link-type="doi">https://doi.org/10.1007/s10825-019-01396-2</ext-link>) contains supplementary material, which is available to authorised users.</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Perovskite solar cells (PSCs) are a promising thin-film technology that, due to their rapid rise in power conversion efficiency to 22.7% [<xref ref-type="bibr" rid="CR15">15</xref>], are attracting a lot of interest and research effort in the photovoltaic community. However, PSCs display unusual transient behaviour (exemplified by current–voltage hysteresis) in the order of seconds to days which affects the power output of the device [<xref ref-type="bibr" rid="CR24">24</xref>]. The consensus in the literature is that this slow (compared to the timescale of electronic motion) behaviour is due to the motion of mobile ion vacancies within the perovskite layer. The species of ion vacancy deemed most likely to be responsible for the behaviour observed in the order of seconds to minutes is that of the halide (e.g. iodide, I<inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msup><mml:mrow/><mml:mo>-</mml:mo></mml:msup></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^-$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq1.gif"/></alternatives></inline-formula>) ion vacancy due to its high mean density and high diffusion coefficient (compared to the other ionic species) predicted by DFT calculations [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Visual evidence of iodide ion migration within a perovskite film has also been obtained experimentally [<xref ref-type="bibr" rid="CR7">7</xref>]. Recent reviews of the outstanding challenges in the field of perovskite solar cells have been given by Snaith [<xref ref-type="bibr" rid="CR23">23</xref>], Egger et al. [<xref ref-type="bibr" rid="CR9">9</xref>] and Phung and Abate [<xref ref-type="bibr" rid="CR17">17</xref>].</p><p id="Par3">Due to the existence of mobile ion vacancies, the perovskite layer must be treated as a mixed ionic–electronic conductor for the purpose of device simulation. The first works [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] to apply numerical methods to PSC modelling reported that their simulations suffered from prohibitively long calculation times and inaccuracies in solution for realistic values of the parameters. A combined analytic/numerical method was used by Richardson et al. [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] to reveal how iodide ion vacancies accumulate/deplete in very narrow layers (called Debye layers) adjacent to the perovskite boundaries. The associated rapid change in solution across these Debye layers is a significant source of spatial stiffness, while the disparity in timescales between the motion of electronic and ionic charges is a source of temporal stiffness [<xref ref-type="bibr" rid="CR6">6</xref>], rendering the task of finding solutions to realistic models of PSCs very challenging.</p><p id="Par4">Courtier et al. [<xref ref-type="bibr" rid="CR6">6</xref>] developed a finite element scheme, implemented in MATLAB [<xref ref-type="bibr" rid="CR14">14</xref>], that is able to cope with the spatial and temporal stiffness of the problem and obtain accurate solutions to a coupled model for ion migration and charge carrier transport within the perovskite layer of a PSC. Since then, alternative numerical methods have also appeared in [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Walter et al. [<xref ref-type="bibr" rid="CR27">27</xref>] have developed a solver that includes the motion of both cations and anions. Their scheme is based on the freely available software Quokka3 [<xref ref-type="bibr" rid="CR10">10</xref>], originally designed for the solution of models of silicon-based photovoltaic devices. While this provides a thoroughly tested and validated framework for their results, the model being solved only explicitly models the perovskite absorber and there is strong evidence suggesting that the adjacent transport layers play a key role in determining device behaviour [<xref ref-type="bibr" rid="CR4">4</xref>]. Meanwhile, Jacobs et al. [<xref ref-type="bibr" rid="CR13">13</xref>] use the proprietary COMSOL package via a MATLAB interface to simulate three layers of a PSC over a range of timescales. However, the details of the modelling and solutions techniques are not given in full, making their results difficult to reproduce and compare with alternatives.</p><p id="Par5">In this work, we present the extension of the finite element code presented in [<xref ref-type="bibr" rid="CR6">6</xref>] for a single-layer model of a PSC to a model that explicitly describes the three core layers of a PSC: the electron transport layer (ETL), perovskite absorber layer and hole transport layer (HTL). Full details of the charge transport model equations and the implementation of the code are given. The code is freely available on GitHub at <ext-link xlink:href="https://github.com/PerovskiteSCModelling/IonMonger" ext-link-type="uri">https://github.com/PerovskiteSCModelling/IonMonger</ext-link> (under an AGPL-3.0 copyleft license) and can be used to simulate a variety of different experimental protocols. Current density–voltage (<inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq2.gif"/></alternatives></inline-formula>–<inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq3.gif"/></alternatives></inline-formula>) curves are the typical measurement that is performed to assess solar cell performance including, for perovskite solar cells, the extent of <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq4.gif"/></alternatives></inline-formula>–<inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq5.gif"/></alternatives></inline-formula> hysteresis displayed at a particular scan rate. In addition to <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq6.gif"/></alternatives></inline-formula>–<inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq7.gif"/></alternatives></inline-formula> curves, the code can be used to simulate photocurrent transients (during which the applied voltage and/or the illumination intensity is varied over time) and photovoltage transients (during which the cell is held at open circuit and the illumination intensity is varied) that occur on timescales of microseconds to minutes. Uncovering the links between model parameters and the results of such simulations will help to improve understanding of the underlying physics of PSCs and hence guide further improvements in their design. One such investigation, into how the extent of observable hysteresis depends on material properties of the two transport layers, has been conducted by Courtier et al. [<xref ref-type="bibr" rid="CR4">4</xref>]. The investigation is based upon simulations of the same<xref ref-type="fn" rid="Fn1">1</xref> three-layer model as that considered in this work.</p><p id="Par7">In Sect. <xref rid="Sec2" ref-type="sec">2</xref>, we show an example set of simulation results obtained using the code. In Sect. <xref rid="Sec3" ref-type="sec">3</xref>, we present and discuss the governing equations in each of the three layers as well as the boundary and interface conditions through which the equations couple together. A non-dimensionalisation is also presented which is geared to study the behaviour of the cell on the timescales associated with anion vacancy motion and aids in obtaining uniformly well-resolved solutions by ensuring that the numerical tolerances are applied equally to each of the model variables. In Sect. <xref rid="Sec9" ref-type="sec">4</xref>, we detail the finite element discretisation of the system and highlight the differences between how open-circuit and applied voltage protocols are imposed at the discrete level. The focus of Sect. <xref rid="Sec13" ref-type="sec">5</xref> is a discussion of the how the time-stepping is carried out and how the output current density is calculated from the numerical solution. In Sect. <xref rid="Sec17" ref-type="sec">6</xref>, we validate the results of the numerical scheme upon which IonMonger is based. Finally, in Sect. <xref rid="Sec19" ref-type="sec">7</xref>, we draw our conclusions.</p></sec><sec id="Sec2"><title>Application example</title><p id="Par8">The main purpose of this paper is to provide the perovskite solar cell community with a high-quality, free and useful tool with which to better understand PSC behaviour, and not to provide a detailed analysis or interpretation of the device physics. The power of the solver in advancing our physical understanding of PSCs is demonstrated in Courtier et al. [<xref ref-type="bibr" rid="CR4">4</xref>], in which an investigation of the effects of material properties of the transport layers on cell performance is detailed. There it is found that two material properties in particular, namely the permittivity and the effective doping density of the transport layers, have a significant role to play in determining the extent of <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq11.gif"/></alternatives></inline-formula>–<inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq12.gif"/></alternatives></inline-formula> hysteresis exhibited by a PSC. In addition, characteristics of simulations that can be used to identify the dominant recombination mechanism in a PSC are discussed. Results from two other simulations, also computed using the capabilities offered by IonMonger, have been presented by Idígoras et al. [<xref ref-type="bibr" rid="CR12">12</xref>] in a study of the role of surface (also often termed interfacial or interface) recombination, which occurs on the interfaces between the perovskite layer and the adjacent transport layers, on PSC performance. However, further work in this area is vital for the future development and optimisation of PSCs. Here, we show how IonMonger can be used to both simulate the most common measurement protocol for assessing the performance of a solar cell, namely a <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq13.gif"/></alternatives></inline-formula>–<inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq14.gif"/></alternatives></inline-formula> curve, and reveal how each type of recombination included in the model contributes to the observed behaviour.</p><p id="Par9">Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows the <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq15.gif"/></alternatives></inline-formula>–<inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq16.gif"/></alternatives></inline-formula> output for an example simulation of a typical <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq17.gif"/></alternatives></inline-formula>–<inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq18.gif"/></alternatives></inline-formula> measurement protocol performed on a planar, standard-architecture PSC (see Fig. <xref rid="Fig2" ref-type="fig">2</xref> for the cell geometry). The cell is initially preconditioned for 5 s before the applied voltage is scanned from 1.2 V to short circuit (0 V) and back to 1.2 V at a scan rate of 100 mV/s. In addition, Fig.  <xref rid="Fig1" ref-type="fig">1</xref>a displays the corresponding current losses due to the two types of interface recombination included in the model. Note that bulk recombination occurring within the perovskite layer is also included in the model but is not shown. By comparing the shape of the current-loss curves to the <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq19.gif"/></alternatives></inline-formula>–<inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq20.gif"/></alternatives></inline-formula> curve, it is clear that, for this example, the observed behaviour is controlled primarily by the rate of recombination at the ETL/perovskite interface (the blue line), while the rate of recombination at the perovskite/HTL interface (the red line) has little effect on the performance of the cell. The parameter values used in the simulation are equal to those given in Tables 1 and 2(b) of [<xref ref-type="bibr" rid="CR4">4</xref>] except that here the effective doping densities <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>24</mml:mn></mml:msup><mml:mspace width="0.333333em"/><mml:msup><mml:mtext>m</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\rm E} = d_{\rm H} = 10^{24} \hbox { m}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq21.gif"/></alternatives></inline-formula> and the effective densities of state <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>24</mml:mn></mml:msup><mml:mspace width="0.333333em"/><mml:msup><mml:mtext>m</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{\rm{c}}^{E} = g_{\rm{v}}^{H} = 5\times 10^{24} \hbox { m}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq22.gif"/></alternatives></inline-formula>. The input file for this simulation, along with a GUIDE and documentation to aid in using the code, is provided in the main folder of the IonMonger GitHub repository so that users can utilise these as a starting point for investigations of their own.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Example simulation results: <bold>a</bold> A <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq23.gif"/></alternatives></inline-formula>–<inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq24.gif"/></alternatives></inline-formula> curve measured at 100 mV/s from 1.2 V to short-circuit and back, after a 5-s preconditioning step. The simulation uses the parameters given in Tables 1 and 2(b) of [<xref ref-type="bibr" rid="CR4">4</xref>] except that here the effective doping densities <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>24</mml:mn></mml:msup><mml:mspace width="0.333333em"/><mml:msup><mml:mtext>m</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\rm E} = d_{\rm H} = 10^{24} \hbox { m}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq25.gif"/></alternatives></inline-formula> and the effective densities of state <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>24</mml:mn></mml:msup><mml:mspace width="0.333333em"/><mml:msup><mml:mtext>m</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{\rm{c}}^{E} = g_{\rm{v}}^{H} = 5\times 10^{24} \hbox { m}^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq26.gif"/></alternatives></inline-formula>. The purple lines show the current-density output, while the blue and red lines show the current losses due to interface recombination at the ETL/perovskite and perovskite/HTL interfaces, respectively. Losses due to bulk recombination are not shown. The direction of scan is indicated by both the arrows and the style of each line: solid for the reverse scan and dashed for the subsequent forward scan. <bold>b</bold> A set of three <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq27.gif"/></alternatives></inline-formula>–<inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq28.gif"/></alternatives></inline-formula> curves. Here, the example in panel (<bold>a</bold>) is plotted alongside two other <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq29.gif"/></alternatives></inline-formula>–<inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq30.gif"/></alternatives></inline-formula> curves measured at scan rates of 50 mV/s and 200 mV/s, but for otherwise identical input parameters. These results demonstrate the ability of the model to reproduce the scan rate-dependent <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq31.gif"/></alternatives></inline-formula>–<inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq32.gif"/></alternatives></inline-formula> hysteresis commonly exhibited by PSCs due to the migration of ion vacancies within the perovskite layer (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2019_1396_Fig1_HTML.png" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>A schematic of the three-layer geometry of the PSC model detailed in Sect. <xref rid="Sec3" ref-type="sec">3</xref>. The symbols in each layer indicate which variables are explicitly modelled in that region. The markers along the <italic>x</italic>-axis represent the non-uniform grid spacing used by IonMonger</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2019_1396_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par10">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, the example <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq33.gif"/></alternatives></inline-formula>–<inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq34.gif"/></alternatives></inline-formula> curve from panel (a) is shown alongside the corresponding results for two other simulations. The only difference in the input parameters between the three simulations is the rate at which the applied voltage is scanned back and forth to measure the <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq35.gif"/></alternatives></inline-formula>–<inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq36.gif"/></alternatives></inline-formula> curve. The three scan rates are 50, 100 and 200 mV/s. Harvesting the full set of results in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b required a total of 34 s of computation time on a standard desktop machine, i.e. approximately 11 s per simulation including the calculation of appropriate initial conditions and the preconditioning step. See Sect. <xref rid="Sec17" ref-type="sec">6</xref> for figures showing how the accuracy of the solution and the computation time vary with respect to the number of grid points on which the solution is computed. Next, the equations that underlie these simulations are detailed.</p></sec><sec id="Sec3"><title>The charge transport model</title><p id="Par11">
In this section, the charge transport model for a planar lead halide perovskite solar cell consisting of a perovskite absorber layer sandwiched between an electron transport layer (ETL) and a hole transport layer (HTL) is presented. Tables of the model variables and parameters along with their definitions are given in the SI. The structure of the cell is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The non-dimensionalisation used by the code is also given.</p><sec id="Sec4"><title>Model equations</title><sec><p id="Par13"><italic>Perovskite absorber layer </italic>(<inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;x&lt;b$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq37.gif"/></alternatives></inline-formula>) A model for the perovskite layer consists of equations for the conservation of conduction (free) electrons, holes and halide ion vacancies coupled with the Poisson equation for the electric potential, <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (x,t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq38.gif"/></alternatives></inline-formula>. We denote the halide ion vacancy density by <italic>P</italic>(<italic>x</italic>, <italic>t</italic>), its flux by <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{F}^P}(x,t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq39.gif"/></alternatives></inline-formula> and define <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{N_0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq40.gif"/></alternatives></inline-formula> as the mean ion vacancy density. It is assumed that an equal, uniform density <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{N_0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq41.gif"/></alternatives></inline-formula> of immobile cation vacancies also exists within the perovskite layer. The electron and hole concentrations are denoted by <italic>n</italic> and <italic>p</italic> with current densities <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq43.gif"/></alternatives></inline-formula>, respectively. The functions <italic>G</italic>(<italic>x</italic>, <italic>t</italic>) and <italic>R</italic>(<italic>n</italic>, <italic>p</italic>) denote the charge carrier photogeneration and bulk recombination rates, respectively. In the perovskite layer, we thus have<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial p}{\partial t} + \frac{1}{q} \frac{\partial {j^p}}{\partial x} = G(x,t) - R(n,p), \\ &amp; {j^p}=-qD_p \left( \frac{\partial p}{\partial x} + \frac{p}{V_{\mathrm{T}}} \frac{\partial \phi }{\partial x} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial n}{\partial t} - \frac{1}{q} \frac{\partial {j^n}}{\partial x} = G(x,t) - R(n,p) , \\&amp; {j^n}=qD_n \left( \frac{\partial n}{\partial x} - \frac{n}{V_{\mathrm{T}}} \frac{\partial \phi }{\partial x} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial P}{\partial t} + \frac{\partial {{F}^P}}{\partial x} = 0, \\&amp; {{F}^P}= -D_{\mathrm{I}}\left( \frac{\partial P}{\partial x}+\frac{P}{ V_{\mathrm{T}}}\frac{\partial \phi }{\partial x}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ3.gif"/></alternatives></disp-formula>with Poisson’s equation,<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _{\rm A}}(\hat{N_0}-P+n-p). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ4.gif"/></alternatives></disp-formula></p></sec><sec><p>Here, <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{\mathrm{I}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq44.gif"/></alternatives></inline-formula> denotes the diffusion coefficient of the iodide ion vacancies and <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{\rm A}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq45.gif"/></alternatives></inline-formula> is the permittivity of the perovskite absorber layer. These differential equations are supplemented by continuity conditions at the interfaces with the transport layers (given at the end of this section).</p></sec><sec><title><italic>Electron transport layer </italic></title><p id="Par14">(<inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-b_{\rm E}&lt;x&lt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq46.gif"/></alternatives></inline-formula>) The majority carriers through the ETL are free electrons. The model for the electrical behaviour of this layer thus consists only of a conservation equation for the free electrons which couples to Poisson’s equation. Here, <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq47.gif"/></alternatives></inline-formula> denotes the electron diffusion coefficient, <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq48.gif"/></alternatives></inline-formula> the permittivity and <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq49.gif"/></alternatives></inline-formula> the intrinsic free electron density (due to the doping) in the ETL.<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial n}{\partial t} - \frac{1}{q} \frac{\partial {j^n}}{\partial x} = 0 , \quad {j^n}=qD_{\rm E} \left( \frac{\partial n}{\partial x} - \frac{n}{V_{\mathrm{T}}} \frac{\partial \phi }{\partial x} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _{\rm E}}(n-d_{\rm E}). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ6.gif"/></alternatives></disp-formula></p><p>These equations couple to the perovskite equations via four continuity conditions at the interface (given at the end of this section). On the external boundary with the metal contact, we impose Ohmic boundary conditions. These read<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n = d_{\rm E}, \quad \phi = \frac{V_{\mathrm{bi}}-V(t)}{2} \quad \text{ on } x=-b_{\rm E}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ7.gif"/></alternatives></disp-formula>where <italic>V</italic>(<italic>t</italic>) is the applied voltage and <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{bi}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq50.gif"/></alternatives></inline-formula> denotes the cell’s built-in voltage, which is defined in (<xref rid="Equ17" ref-type="disp-formula">17</xref>).</p></sec><sec><title><italic>Hole transport layer </italic>(<inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b&lt;x&lt;b+b_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq51.gif"/></alternatives></inline-formula>)</title><p id="Par15">The majority carriers in the HTL are holes, and analogously to the case in the ETL, we need specify only two equations, specifically<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial p}{\partial t} + \frac{1}{q} \frac{\partial {j^p}}{\partial x} = 0 , \quad {j^p}= -qD_{\rm H} \left( \frac{\partial p}{\partial x} + \frac{p}{V_{\mathrm{T}}} \frac{\partial \phi }{\partial x} \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ8.gif"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial ^2 \phi }{\partial x^2} = \frac{q}{\varepsilon _{\rm H}}(d_{\rm H}-p). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ9.gif"/></alternatives></disp-formula></p><p>Here, <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq52.gif"/></alternatives></inline-formula> is the hole diffusion coefficient, <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq53.gif"/></alternatives></inline-formula> is the permittivity and <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq54.gif"/></alternatives></inline-formula> is the intrinsic hole density (due to the doping) in the HTL. These equations couple to the equations in the perovskite via four continuity conditions at the interface (given at the end of this section) and satisfy the following Ohmic contact conditions on the metal contact.<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p = d_{\rm H}, \quad \phi = -\frac{V_{\mathrm{bi}}-V(t)}{2} \quad \text{ on } x=b+b_{\rm H}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ10.gif"/></alternatives></disp-formula></p></sec><sec><title><italic>Continuity conditions on the interfaces </italic>(<inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq55.gif"/></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=b$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq56.gif"/></alternatives></inline-formula>)</title><p id="Par16">At the interface between the perovskite and the ETL, (1) the electron flux (and its associated current density) is conserved, (2) the hole flux (and its associated current density) is conserved, (3) there is no flux of halide ion vacancies, (4) and (5) both the electrostatic potential and electric displacement field are continuous, and (6) the majority carrier density (in this case the electrons) at the edge of the ETL is related to the neighbouring carrier density in the perovskite by a factor, <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq57.gif"/></alternatives></inline-formula>, which depends upon the relevant band offset and change in effective density of states [<xref ref-type="bibr" rid="CR11">11</xref>]. Therefore, at the interface between the ETL and the perovskite, the following conditions are applied<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="}"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mrow/><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="4pt"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\left.\begin{array}{r} {j^n}|_{x=0^-} = {j^n}|_{x=0^+}-\bar{R_{\rm{l}}}\\ {j^p}= -q \bar{R_{\rm{l}}}\\ {{F}^P}= 0\\ \phi |_{x=0^-} = \phi |_{x=0^+}\\ \varepsilon _{E}\frac{\partial \phi }{\partial x}\Big |_{x=0^-} = \varepsilon _{\rm A}\frac{\partial \phi }{\partial x}\Big |_{x=0^+}\\ k_{\rm E}n|_{x=0^-} = n|_{x=0^+} \end{array} \right\} \ \text{ on } \ \ x=0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ11.gif"/></alternatives></disp-formula></p><p>Analogous conditions are applied at the interface between the perovskite and the HTL (where the holes are the majority carrier). These read<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="}"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:msub><mml:mrow><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mrow/><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mrow/><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="4pt"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\left. \begin{array}{r} {j^p}|_{x=b^-}-\bar{R_{\rm{r}}}= {j^p}|_{x=b^+}\\ {j^n}= -q \bar{R_{\rm{r}}}\\ {{F}^P}= 0\\ \phi |_{x=b^-} = \phi |_{x=b^+}\\ \varepsilon _{\rm A}\frac{\partial \phi }{\partial x}\Big |_{x=b^-} = \varepsilon _{\rm H}\frac{\partial \phi }{\partial x}\Big |_{x=b^+}\\ p|_{x=b^-} = k_{\rm H}p|_{x=b^+} \end{array} \right\} \ \text{ on } \ \ x=b. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ12.gif"/></alternatives></disp-formula></p><p>Here, the superscripts of ± denote quantities evaluated at either the left- or right-hand side of the perovskite/transport layer interfaces, respectively; <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{R_{\rm{l}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{R_{\rm{r}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq59.gif"/></alternatives></inline-formula> are the recombination fluxes at the left (ETL/perovskite) and right (perovskite/HTL) interface, respectively; and <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq61.gif"/></alternatives></inline-formula> are constants of proportionality between the charge carrier concentrations on each side of the interfaces according to Boltzmann statistics, given by<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;k_{\rm E} = \frac{g_{\rm{c}}}{g_{\rm{c}}^{E}}\exp \left( -\frac{E_{\rm{c}}-E_{\rm{c}}^{E}}{k_{\rm{B}}T}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;k_{\rm H} = \frac{g_{\rm{v}}}{g_{\rm{v}}^{H}}\exp \left( \frac{E_{\rm{v}}-E_{\rm{v}}^{H}}{k_{\rm{B}}T}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ14.gif"/></alternatives></disp-formula></p><p>In these expressions, <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{\rm{c,v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq62.gif"/></alternatives></inline-formula> denote the effective conduction/valence band density of states; <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\rm{c,v}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq63.gif"/></alternatives></inline-formula> are the energies of the conduction/valence band edges; and the superscripts <italic>E</italic> or <italic>H</italic> indicate to which transport layer a quantity relates. The validity of each of these expressions relies on the validity of using the Boltzmann approximation to describe the distribution of electrons in a non-degenerate semiconductor. Consequently, users should choose an effective doping density which is less than 20 times smaller than the effective density of states in each transport layer in order to ensure that the equilibrium Fermi level is more than a few thermal voltages away from the band edges, see (<xref rid="Equ15" ref-type="disp-formula">15</xref>)–(<xref rid="Equ16" ref-type="disp-formula">16</xref>).</p></sec><sec><title><italic>Built-in voltage</italic></title><p id="Par17">The cell’s built-in voltage is equal to the difference between the workfunctions of the two metal contacts. Assuming that the contacts form ideal Ohmic contacts with the adjacent transport layer, this difference is equal to the difference between the equilibrium Fermi levels of the two transport layers which are approximated, using Boltzmann statistics, by<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\rm f}^{E} = E_{\rm{c}}^{E} - k_{\rm{B}}T\log \left( \frac{g_{\rm{c}}^{E}}{d_{\rm E}}\right),$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ15.gif"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\rm f}^{H} = E_{\rm{v}}^{H} + k_{\rm{B}}T\log \left( \frac{g_{\rm{v}}^{H}}{d_{\rm H}}\right).$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ16.gif"/></alternatives></disp-formula></p><p>Hence, the built-in voltage is given by<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{bi}} = E_{\rm{c}}^{E}-E_{\rm{v}}^{H}-k_{\rm{B}}T\log \left( \frac{g_{\rm{c}}^{E}g_{\rm{v}}^{H}}{d_{\rm E}d_{\rm H}}\right).$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ17.gif"/></alternatives></disp-formula></p></sec></sec><sec id="Sec5"><title>Carrier generation and recombination rates</title><p id="Par18">For the rate of charge carrier generation within the perovskite layer, we use a simplified Beer–Lambert model of light absorption [<xref ref-type="bibr" rid="CR16">16</xref>] in which it is assumed that absorption can be characterised by a single absorption coefficient (<inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq64.gif"/></alternatives></inline-formula>) and photon flux that are independent of the wavelength of light. Taking into account the possibility of choosing either a standard or inverted architecture (i.e. applying the light to either the ETL- or HTL-side of the cell, respectively), this rate can be written as<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mi>α</mml:mi><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x,t) = I_{\rm s}(t)F_{\rm{ph}} \alpha \exp \left( -\alpha \left[ \frac{b}{2}+l\left( x-\frac{b}{2}\right) \right] \right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ18.gif"/></alternatives></disp-formula>in which <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{\rm{ph}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq65.gif"/></alternatives></inline-formula> denotes the flux of photons incident on the light-facing perovskite surface (after accounting for reflection) under the equivalent of 1 Sun illumination; the function <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\rm s}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq66.gif"/></alternatives></inline-formula> is the intensity of the illumination in Sun equivalents; and the parameter <italic>l</italic> can be set equal to either <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq67.gif"/></alternatives></inline-formula> for light from the left (through the ETL) or <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq68.gif"/></alternatives></inline-formula> for light from the right (through the HTL) by making use of the Inverted option in the parameter input file.</p><p id="Par19">We allow bulk recombination to be described by a combination of bimolecular and trap-assisted Shockley–Read–Hall (SRH) recombination mechanisms from, for example, Nelson [<xref ref-type="bibr" rid="CR16">16</xref>] §4.5.5. Hence, the volumetric bulk recombination rate is<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;R(n,p) = \beta \left( np-n_i^2\right) +\frac{np-n_i^2}{\tau _n(p+p_t)+\tau _p (n+n_t)}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ19.gif"/></alternatives></disp-formula>in which <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mi>β</mml:mi></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq69.gif"/></alternatives></inline-formula> is the bimolecular rate constant, <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq70.gif"/></alternatives></inline-formula> is the intrinsic carrier concentration, <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq71.gif"/></alternatives></inline-formula> and <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq72.gif"/></alternatives></inline-formula> are the charge carrier lifetimes and we assume that the trap state energy level lies close to the intrinsic potential energy of the perovskite such that we can apply the approximation that <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_t = n_t = n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq73.gif"/></alternatives></inline-formula>.</p><p id="Par20">Similarly, the interfacial recombination fluxes (<inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{R_{\rm{l}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{R_{\rm{r}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq75.gif"/></alternatives></inline-formula>) can be chosen as a combination of bimolecular and SRH recombination as follows, noting the use of recombination velocities rather than carrier lifetimes in the SRH recombination rates (see Nelson [<xref ref-type="bibr" rid="CR16">16</xref>, Sect. 4.5.6]),<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \bar{R}_{\mathrm{l,r}}(n^-,p^+)&amp;= \beta ^{E,H} \left( n^-p^+-n_i^-n_i^+\right) \\&amp;+\frac{n^-p^+-n_i^-n_i^+}{\frac{1}{\nu _n^{E,H}}(p^++p_t^+)+\frac{1}{\nu _p^{E,H}}(n^-+n_t^-)}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ20.gif"/></alternatives></disp-formula>in which the superscripts of ± denote quantities evaluated at either the left- or right-hand side of the perovskite/transport layer interfaces, respectively; <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta ^{E,H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq76.gif"/></alternatives></inline-formula> are the bimolecular rate constants; and <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _n^{E,H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _p^{E,H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq78.gif"/></alternatives></inline-formula> are the electron and hole recombination velocities, respectively. In order to satisfy the principle of detailed balance, we assume that the intrinsic carrier density in the ETL <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i^{E} = \frac{n_i}{k_{\rm E}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq79.gif"/></alternatives></inline-formula> and the intrinsic carrier density in the HTL <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i^{H} = \frac{n_i}{k_{\rm H}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq80.gif"/></alternatives></inline-formula> for consistency with the continuity conditions in (<xref rid="Equ11" ref-type="disp-formula">11</xref>f) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>f). Then, in order to keep the number of input parameters to a minimum, we approximate <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_t = n_t = n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq81.gif"/></alternatives></inline-formula> in analogy with the approximation made to the bulk recombination rate above. Therefore, the interface recombination rates used by the code are equivalent to<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>n</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>p</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\bar{R_{\rm{l}}}\left( \frac{n}{k_{\rm E}},p\right) = \frac{\beta ^{E}}{k_{\rm E}} \left( np-n_i^2\right) \\&amp;\quad +\frac{np-n_i^2}{\frac{k_{\rm E}}{\nu _n^{E}}(p+n_i)+\frac{1}{\nu _p^{E}}(n+n_i)} \quad \text{ on } x=0^+, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ21.gif"/></alternatives></disp-formula><disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>n</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\bar{R_{\rm{r}}}\left( n,\frac{p}{k_{\rm H}}\right) = \frac{\beta ^{H}}{k_{\rm H}} \left( np-n_i^2\right) \\&amp;\quad +\frac{np-n_i^2}{\frac{1}{\nu _n^{H}}(p+n_i)+\frac{k_{\rm H}}{\nu _p^{H}}(n+n_i)} \quad \text{ on } x=b^-. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ22.gif"/></alternatives></disp-formula></p></sec><sec id="Sec6"><title>Calculation of the total current density</title><p id="Par21">In order to calculate the total current density from a numerical solution of the drift–diffusion model, we derive an expression that can be evaluated at any point in the domain. The code automatically calculates the current density at the midpoint of the perovskite layer, where the grid spacing is larger and the solution varies more smoothly than in the Debye layers, to minimise numerical error. By subtracting Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>a) from Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>a), we get<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial }{\partial t}(p-n) + \frac{1}{q}\frac{\partial }{\partial x}\left( {j^p}+{j^n}\right) = 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ23.gif"/></alternatives></disp-formula></p><p>Then, by substituting the difference in the carrier concentrations (<inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p-n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq82.gif"/></alternatives></inline-formula>) using Poisson’s equation for the perovskite layer, given in (<xref rid="Equ4" ref-type="disp-formula">4</xref>), and multiplying by <italic>q</italic>, we get<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial }{\partial x}\left( {j^p}+{j^n}\right) - \frac{\partial }{\partial t}\left( \varepsilon _{\rm A}\frac{\partial ^2 \phi }{\partial x^2}-q(\hat{N_0}-P)\right) = 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ24.gif"/></alternatives></disp-formula></p><p>Applying the time derivative to the last term in the brackets allows us to eliminate <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{N_0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq83.gif"/></alternatives></inline-formula> (the constant and uniform cation vacancy density) and to use the ion vacancy conservation equation in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) to make a substitution for the time derivative of <italic>P</italic>, which gives<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial }{\partial x}\left( {j^p}+{j^n}\right) - \frac{\partial }{\partial t}\left( \varepsilon _{\rm A}\frac{\partial ^2 \phi }{\partial x^2}\right) + q\frac{\partial {{F}^P}}{\partial x} = 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ25.gif"/></alternatives></disp-formula></p><p>Similarly, for the transport layers, we have<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial {j^n}}{\partial x} - \frac{\partial }{\partial t}\left( \varepsilon _{\rm E}\frac{\partial ^2 \phi }{\partial x^2}\right) = 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ26.gif"/></alternatives></disp-formula><disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\frac{\partial {j^p}}{\partial x} - \frac{\partial }{\partial t}\left( \varepsilon _{\rm H}\frac{\partial ^2 \phi }{\partial x^2}\right) = 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ27.gif"/></alternatives></disp-formula></p><p>After swapping the order of spatial and temporal differentiation, it is possible to integrate these three equations with respect to the spatial variable <italic>x</italic>. By integrating and applying the continuity conditions and the Ohmic boundary conditions at either metal contact, we get an expression for the total current density which is independent of <italic>x</italic> and given by<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;J(t) = \left\{ \begin{array}{ll} {j^n}+{j^p}-\frac{\partial }{\partial t}\left( \varepsilon _{\rm A}\frac{\partial \phi }{\partial x}\right) +q{{F}^P}, &amp;\quad \text {for } 0&lt;x&lt;b, \\ {j^n}-\frac{\partial }{\partial t}\left( \varepsilon _{\rm E}\frac{\partial \phi }{\partial x}\right) , &amp;\quad{\text { for }} -b_{\rm E}&lt;x&lt;0,\\ {j^p}-\frac{\partial }{\partial t}\left( \varepsilon _{\rm H}\frac{\partial \phi }{\partial x}\right) , &amp;\quad {\text { for }} b&lt;x&lt;b+b_{\rm H}. \end{array} \right. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ28.gif"/></alternatives></disp-formula></p><p>The term involving a time derivative in each equation is the displacement current density. It should be noted that the magnitude of the displacement current density is usually even smaller than the magnitude of the expected numerical error in the solution, see Sect. <xref rid="Sec17" ref-type="sec">6</xref>.</p></sec><sec id="Sec7"><title>Boundary conditions for open-circuit conditions</title><p id="Par22">It is possible to simulate open-circuit conditions, rather than a fixed voltage protocol, by changing just two of the model equations. The two conditions that describe the application of a fixed potential difference are (<xref rid="Equ7" ref-type="disp-formula">7</xref>b) and (<xref rid="Equ10" ref-type="disp-formula">10</xref>b). The model for simulation of a device at open circuit instead includes boundary conditions to ensure that there is zero flux of electrons across the metal/ETL boundary (and hence no photocurrent) and that the values of the electric potential at each contact are equal and opposite. This amounts to imposing, in place of (<xref rid="Equ7" ref-type="disp-formula">7</xref>b) and (<xref rid="Equ10" ref-type="disp-formula">10</xref>b),<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>-</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{j^n}|_{x=-{b_{\rm E}}{^-}} = 0,&amp;\phi |_{x=-b_{\rm E}} = -\phi |_{x=b+b_{\rm H}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ29.gif"/></alternatives></disp-formula></p></sec><sec id="Sec8"><title>Non-dimensionalisation</title><p id="Par23">The code is programmed to solve a non-dimensional form of the model equations. Note, however, that all input parameter values are non-dimensionalised automatically and the output is re-dimensionalised prior to output. Details of the non-dimensionalisation are given here to allow the possibility that users can adapt the equations that underlie the model described here. The non-dimensionalisation is given by:<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">ion</mml:mi></mml:msub><mml:msup><mml:mi>t</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi>P</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>b</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>b</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{ccc} x = b x^*, &amp;{}t = \tau _{\mathrm{ion}}t^*, &amp;{}\phi = V_{\mathrm{T}} \phi ^*, \\ p = d_{\rm H}p^*, &amp;{}n = d_{\rm E}n^*, &amp;{}P = \hat{N_0}P^*, \\ {j^p}= qG_0b{{j^p}}^*, &amp;{}{j^n}=q G_0 b {{j^n}}^*, &amp;{} {{F}^P}= \frac{D_{\mathrm{I}} \hat{N_0}}{b} {{F}^P}^*, \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ30.gif"/></alternatives></disp-formula>where <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq84.gif"/></alternatives></inline-formula> is a typical value of <italic>G</italic> (the rate of photogeneration of charge pairs per unit volume) and <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">ion</mml:mi></mml:msub></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _{\mathrm{ion}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq85.gif"/></alternatives></inline-formula> is the characteristic timescale for ion motion into the Debye layers, given by<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msup><mml:mi>b</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">ion</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;G_0=\frac{F^{\mathrm{ph}}}{b}(1-\mathrm {e}^{-\alpha b}),&amp;\tau _{\mathrm{ion}} = \frac{b}{D_{\mathrm{I}}}\sqrt{\frac{V_{\mathrm{T}}\varepsilon _{\rm A}}{q\hat{N_0}}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ31.gif"/></alternatives></disp-formula></p><p>The perovskite (ionic) Debye length is defined as<disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_{\rm D} = \sqrt{\frac{V_{\mathrm{T}}\varepsilon _{\rm A}}{q\hat{N_0}}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ32.gif"/></alternatives></disp-formula></p><p>The other input functions and constants are rescaled as follows:<disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mi>Φ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:msub><mml:mi>Φ</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>G</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>R</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">ion</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>κ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>κ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>κ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>κ</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>b</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>b</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>b</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mi>b</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>λ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>λ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{array}{cccc} V = V_{\mathrm{T}}\varPhi , &amp;{}V_{\mathrm{bi}} = V_{\mathrm{T}}\varPhi _{\mathrm{bi}}, &amp;{}G = G_0G^*, \\ R = G_0R^*, &amp;{}\bar{R_{\rm{l}}}= bG_0\bar{R_{\rm{l}}}^*, &amp;{}\bar{R_{\rm{r}}}= bG_0\bar{R_{\rm{r}}}^*, \\ \sigma = \frac{d_{\rm E}}{G_0\tau _{\mathrm{ion}}}, &amp;{}\chi = \frac{d_{\rm H}}{d_{\rm E}}, &amp;{} \kappa _p = \frac{D_pd_{\rm H}}{G_0b^2}, \\ \kappa _n = \frac{D_nd_{\rm E}}{G_0b^2}, &amp;{}\kappa _{\rm E} = \frac{D_{\rm E}\kappa _n}{D_n}, &amp;{}\kappa _{\rm H} = \frac{D_{\rm H}\kappa _p}{D_p}, \\ w_{\rm E} = \frac{b_{\rm E}}{b}, &amp;{}w_{\rm H} = \frac{b_{\rm H}}{b}, &amp;{}r_{\rm E} = \frac{\varepsilon _{\rm E}}{\varepsilon _{\rm A}},\\ r_{\rm H} = \frac{\varepsilon _{\rm H}}{\varepsilon _{\rm A}}, &amp;{}\delta = \frac{d_{\rm E}}{\hat{N_0}}, &amp;{}\lambda = \frac{L_{\rm D}}{b}, \\ \lambda _{\rm E} =\sqrt{ \frac{\varepsilon _{\rm E}\hat{N_0}}{\varepsilon _{\rm A}d_{\rm E}}}\lambda , &amp;{}\lambda _{\rm H} = \sqrt{ \frac{\varepsilon _{\rm H}\hat{N_0}}{\varepsilon _{\rm A}d_{\rm H}}}\lambda . \end{array} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ33.gif"/></alternatives></disp-formula></p><p>The star notation is dropped in the following sections.</p></sec></sec><sec id="Sec9"><title>Discretisation</title><p id="Par24">The numerical method upon which our code is based was developed by Courtier et al. [<xref ref-type="bibr" rid="CR6">6</xref>] to solve a simplified model description of a perovskite solar cell in which it was assumed that the transport layers were so highly doped that the potential within them was uniform, thereby reducing the model to equations in the perovskite absorber layer only. In that work, the speed and accuracy of the method are compared against those of two previously used alternatives. It is shown that the method we adopt here is superior to both of these methods for both metrics of performance. Here, we adapt the finite element-based scheme to solve the dimensionless three-layer model set out in the previous section. We do not use the Scharfetter–Gummel scheme [<xref ref-type="bibr" rid="CR19">19</xref>], commonly used for the solution of drift–diffusion equations, because it is tailored to deal with issues related to charge carrier transport rather than accurately resolving solutions in narrow Debye layers, which is the main difficulty in the present work.</p><sec id="Sec10"><title>Spatial grid</title><p id="Par25">The discretisation is formulated on a computational grid comprised of <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+N_{\rm E}+N_{\rm H}+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq86.gif"/></alternatives></inline-formula> non-uniformly positioned grid points which partition the (non-dimensional) domain <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in [-w_{\rm E},1+w_{\rm H}]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq87.gif"/></alternatives></inline-formula> into <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+N_{\rm E}+N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq88.gif"/></alternatives></inline-formula> subintervals. The perovskite layer (including interfaces) contains <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq89.gif"/></alternatives></inline-formula> grid points denoted by <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq90.gif"/></alternatives></inline-formula> for <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=0,\ldots ,N$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq91.gif"/></alternatives></inline-formula> with subinterval widths denoted by <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _{i+1/2}=x_{i+1}-x_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq92.gif"/></alternatives></inline-formula>. The transport layer domains (excluding interfaces) contain <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq93.gif"/></alternatives></inline-formula> and <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq94.gif"/></alternatives></inline-formula> grid points, respectively, with grid points denoted by <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x^{E}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq95.gif"/></alternatives></inline-formula> for <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=0,\ldots ,N_{\rm E}-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x^{H}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq97.gif"/></alternatives></inline-formula> for <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq98.gif"/></alternatives></inline-formula>, respectively, with corresponding subinterval notation.</p><p id="Par26">It is known that the largest gradients in the solution appear in narrow Debye layers adjacent to the material interfaces [<xref ref-type="bibr" rid="CR5">5</xref>]. This motivates the use of a grid in which points are concentrated near the domain boundaries and at internal interfaces so that computational resolution is focused there and not wasted where it is not required. One such grid can be created by extending the <italic>tanh</italic> grid used in [<xref ref-type="bibr" rid="CR6">6</xref>] to the three-layer cell geometry displayed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Specifically, we set<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>tanh</mml:mo><mml:mfenced close="]" open="["><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced></mml:mrow><mml:mrow><mml:mo>tanh</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x_i = \frac{1}{2} \left( \frac{\tanh \left[ s\left( \frac{2i}{N}-1\right) \right] }{\tanh (s)}+1\right) , \\&amp; \qquad \text{ for } i=0,\ldots ,N, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ34.gif"/></alternatives></disp-formula><disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>tanh</mml:mo><mml:mfenced close="]" open="["><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced></mml:mrow><mml:mrow><mml:mo>tanh</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x^{E}_i = \frac{w_{\rm E}}{2} \left( \frac{\tanh \left[ s\left( \frac{2i}{N_{\rm E}}-1\right) \right] }{\tanh (s)}-1\right) , \\&amp; \qquad \text{ for } i=0,\ldots ,N_{\rm E}-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ35.gif"/></alternatives></disp-formula><disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>tanh</mml:mo><mml:mfenced close="]" open="["><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced></mml:mrow><mml:mrow><mml:mo>tanh</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x^{H}_i = 1+\frac{w_{\rm H}}{2} \left( \frac{\tanh \left[ s\left( \frac{2i}{N_{\rm H}}-1\right) \right] }{\tanh (s)}+1\right) , \\&amp; \qquad \text{ for } i=1,\ldots ,N_{\rm H}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ36.gif"/></alternatives></disp-formula></p><p>Our numerical experiments indicate that a good rule of thumb for deciding on a judicious choice for the value for <italic>s</italic> can be to calculate a value which leads to 20% of the grid points falling within one Debye length of each interface within the perovskite layer (i.e. the intervals <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in [0,\lambda ]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq99.gif"/></alternatives></inline-formula> and <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in [1-\lambda ,1]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq100.gif"/></alternatives></inline-formula>), via numerical solution of<disp-formula id="Equ37"><label>37</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mn>0.6</mml:mn></mml:mfenced></mml:mrow><mml:mrow><mml:mo>tanh</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda = \frac{1}{2} \left( \frac{\tanh \left( 0.6\right) }{\tanh (s)}+1\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ37.gif"/></alternatives></disp-formula></p><p>The code is set up so that the numbers of grid points <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq102.gif"/></alternatives></inline-formula> are chosen based on the input parameter <italic>N</italic> to give approximately equal spacing immediately either side of the interface.</p></sec><sec id="Sec11"><title>Finite element scheme</title><sec><p id="Par27">As in [<xref ref-type="bibr" rid="CR6">6</xref>], we employ a common finite element approach, in which each of the dependent variables is approximated as a linear combination of piecewise linear basis functions with compact support. For a generic dependent variable, <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:mi>u</mml:mi></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq103.gif"/></alternatives></inline-formula>, defined within the perovskite, i.e. for <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in (0,1)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq104.gif"/></alternatives></inline-formula>, we write<disp-formula id="Equ38"><label>38</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u(x,t) = \sum _{i=0}^{i=N} u_i(t) \varphi _i(x)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ38.gif"/></alternatives></disp-formula>where <disp-formula id="Equ39"><label>39</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>x</mml:mi><mml:mo>∉</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _i(x) = {\left\{\begin{array}{ll} \frac{x-x_{i-1}}{x_i-x_{i-1}} &amp;\quad{} {\text {if }}x \in (x_{i-1},x_i)\\ \frac{x_{i+1} - x}{x_{i+1}-x_i} &amp;\quad{} {\text {if }}x \in (x_{i},x_{i+1}) \\ 0 &amp;\quad{} {\text {if }}x \notin (x_{i-1},x_{i+1}) \end{array}\right. }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ39.gif"/></alternatives></disp-formula>in which <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _i(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq105.gif"/></alternatives></inline-formula> are referred to as the basis functions. Each of the governing equations of interest can be manipulated into the form<disp-formula id="Equ40"><label>40</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>±</mml:mo><mml:mi>u</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} A \frac{\partial u}{\partial t} = B \frac{\partial }{\partial x} \left( \frac{\partial u}{\partial x} \pm u\frac{\partial \phi }{\partial x} \right) + S(x,t,u,v_1,v_2,v_3), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ40.gif"/></alternatives></disp-formula>in which <italic>A</italic> and <italic>B</italic> are constants and the function <inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(x,t,u,v_1,v_2,v_3)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq106.gif"/></alternatives></inline-formula> is a source term which depends upon the spatial variable <italic>x</italic>, the temporal variable <italic>t</italic>, the generic variable <inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:mi>u</mml:mi></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq107.gif"/></alternatives></inline-formula> and a series of other generic dependent variables <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq108.gif"/></alternatives></inline-formula> for <inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,2,3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq109.gif"/></alternatives></inline-formula>. The electron, hole and halide ion vacancy conservation equations, (<xref rid="Equ1" ref-type="disp-formula">1</xref>), (<xref rid="Equ2" ref-type="disp-formula">2</xref>) and (<xref rid="Equ3" ref-type="disp-formula">3</xref>), are rewritten in this form by eliminating the attendant electron or hole current densities, or the halide ion vacancy flux, respectively. Poisson’s equation in the perovskite, (<xref rid="Equ4" ref-type="disp-formula">4</xref>), is already in this form.</p></sec><sec><p id="Par28">The spatially discretised equations in the perovskite are derived by multiplying (<xref rid="Equ40" ref-type="disp-formula">40</xref>) through each of the test functions <inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _j(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq110.gif"/></alternatives></inline-formula> (for <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j=0,\ldots ,N$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq111.gif"/></alternatives></inline-formula>), integrating over the domain <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in (0,1)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq112.gif"/></alternatives></inline-formula> (using integration by parts where appropriate) and substituting form (<xref rid="Equ38" ref-type="disp-formula">38</xref>) for each of the dependent variables. On doing so, we arrive at<disp-formula id="Equ41"><label>41</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>A</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msub><mml:mi>φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>±</mml:mo><mml:mi>u</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mfenced open="{"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mi>φ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>φ</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mfenced close="}"><mml:mo>±</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msub><mml:mi>φ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>φ</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msubsup><mml:mi>φ</mml:mi><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;A \sum _{i=0}^{i=N} \frac{\mathrm {d}u_i}{\mathrm {d}t} \int _0^1 \varphi _i \varphi _j \,\mathrm {d}x \\ &amp; \quad = B \left( \frac{\partial u}{\partial x} \pm u\frac{\partial \phi }{\partial x} \right) \varphi _j \Big |_{x=0}^{x=1} \\ &amp; - B \left\{ \sum _{i=0}^{i=N} u_i \int _0^1 \varphi _i' \varphi _j' \,\mathrm {d}x \right. \\ &amp; \left. \pm \sum _{i=0}^{i=N} \sum _{k=0}^{k=N} u_i \phi _k \int _0^1 \varphi _i \varphi _j' \varphi _k' \,\mathrm {d}x \right\} \\ &amp; + \int _0^1 S(x,t,u,v_1,v_2,v_3) \varphi _j \,\mathrm {d}x. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ41.gif"/></alternatives></disp-formula></p></sec><sec><p>Each of the integrals containing expressions that depend solely on the basis functions and/or their derivatives can be computed exactly. Likewise, terms containing quantities evaluated on the boundaries <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=0,1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq113.gif"/></alternatives></inline-formula> can be computed exactly using the continuity conditions (<xref rid="Equ11" ref-type="disp-formula">11</xref>)–(<xref rid="Equ12" ref-type="disp-formula">12</xref>), else the relevant equation is replaced by the corresponding Dirichlet condition. The one remaining term that is not so readily computed is the final integral in (<xref rid="Equ41" ref-type="disp-formula">41</xref>) that depends on the source terms <italic>S</italic>. For the anion vacancy conservation, <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mo>≡</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\equiv 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq114.gif"/></alternatives></inline-formula> and so this term is zero. For Poisson’s equation, this term is a linear combination of dependent variables and so can be computed exactly. However, for the electron and hole conservation equations, (<xref rid="Equ2" ref-type="disp-formula">2</xref>) and (<xref rid="Equ1" ref-type="disp-formula">1</xref>), the source term comprises both the generation and bulk recombination rates, <italic>G</italic>(<italic>x</italic>) and <italic>R</italic>(<italic>n</italic>, <italic>p</italic>), which are highly nonlinear, see Sect. <xref rid="Sec5" ref-type="sec">3.2</xref>. In order that the integral contained in the final term of (<xref rid="Equ41" ref-type="disp-formula">41</xref>) can be integrated (at least approximately) regardless of the functional form of the source term, we make a further approximation, that is, to replace the dependent variables in the integrand by functions that are piecewise constant over each subinterval, <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in (x_i,x_{i+1})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq115.gif"/></alternatives></inline-formula>, and have a value equal to that of the full series (<xref rid="Equ38" ref-type="disp-formula">38</xref>) at the midpoint of that interval. In short, we make the additional approximation<disp-formula id="Equ42"><label>42</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>≈</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="2em"/><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\int _0^{1} ( G - R(n,p)) \varphi _j \,\mathrm {d}x \approx \\&amp;{\left\{ \begin{array}{ll} \frac{\varDelta _{j-\frac{1}{2}}}{2} \left( G|_{x=x_{j-\frac{1}{2}}} - R\left( n|_{x=x_{j-\frac{1}{2}}},p|_{x=x_{j-\frac{1}{2}}} \right) \right) \\ + \frac{\varDelta _{j+\frac{1}{2}}}{2} \left( G|_{x=x_{j+\frac{1}{2}}} - R\left( n|_{x=x_{j+\frac{1}{2}}},p|_{x=x_{j+\frac{1}{2}}} \right) \right) , \\ \qquad {\text {if }}j=1,\ldots ,N-1, \\ \frac{\varDelta _{\frac{1}{2}}}{2} \left( G|_{x=x_{\frac{1}{2}}} - R\left( n|_{x=x_{\frac{1}{2}}},p|_{x=x_{\frac{1}{2}}} \right) \right) , \\ \qquad {\text {if }}j=0, \\ \frac{\varDelta _{N-\frac{1}{2}}}{2} \left( G|_{x=x_{N-\frac{1}{2}}} - R\left( n|_{x=x_{N-\frac{1}{2}}},p|_{x=x_{N-\frac{1}{2}}} \right) \right) , \\ \qquad {\text {if }}j=N. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ42.gif"/></alternatives></disp-formula></p></sec><sec><p>The additional error incurred as a result of this approximation is comparable to the error associated with the original piecewise linear approximation for the dependent variables. Thus, even though some additional error is introduced, the scheme retains its second-order local accuracy, as demonstrated in Sect. <xref rid="Sec17" ref-type="sec">6</xref>. We note that this approach to deal with the nonlinear source terms is a special case of the method used in the work of Skeel and Berzins [<xref ref-type="bibr" rid="CR22">22</xref>], but we emphasise that in contrast to their method, we only use this additional approximation for treatment of the source terms while the rest of the terms are integrated exactly.</p></sec><sec><p id="Par29">An analogous methodology is used to derive the discrete equations in the transport layers. The only difference is that the basis and test functions are piecewise linear functions with compact support defined within the ETL and HTL, respectively.</p></sec><sec><p id="Par30">For notational convenience, we introduce three discrete operators: a difference operator, <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathfrak {D}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq116.gif"/></alternatives></inline-formula>; an interpolation operator, <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathfrak {I}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq117.gif"/></alternatives></inline-formula>; and, a linear operator <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathfrak {L}_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq118.gif"/></alternatives></inline-formula>. For a generic dependent variable <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mi>u</mml:mi></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq119.gif"/></alternatives></inline-formula>, these three operators are defined as follows, in which the midpoint <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x_{i+1/2}=x_i/2+x_{i+1}/2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq120.gif"/></alternatives></inline-formula> is halfway between <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq121.gif"/></alternatives></inline-formula> and <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=x_{i+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq122.gif"/></alternatives></inline-formula>.<disp-formula id="Equ43"><label>43</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\partial u}{\partial x}\Big |_{x=x_{i+1/2}} \approx \mathfrak {D}_{i+1/2}(u) = \frac{u_{i+1}-u_i}{\varDelta _{i+1/2}},$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ43.gif"/></alternatives></disp-formula><disp-formula id="Equ44"><label>44</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;u|_{x=x_{i+1/2}} \approx \quad \mathfrak {I}_{i+1/2}(u) = \frac{1}{2}(u_{i+1}+u_i), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ44.gif"/></alternatives></disp-formula><disp-formula id="Equ45"><label>45</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}\mathfrak {L}_i(u) &amp;= \frac{1}{6}\varDelta _{i+1/2}u_{i+1}+\frac{1}{3}\left( \varDelta _{i+1/2}+\varDelta _{i-1/2}\right) u_i \\&amp; \quad +\frac{1}{6}\varDelta _{i-1/2}u_{i-1}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ45.gif"/></alternatives></disp-formula></p></sec><sec><p>These discrete operators can be used to obtain discretised versions of the ion flux and carrier current densities in the perovskite layer, given in dimensional form in (<xref rid="Equ3" ref-type="disp-formula">3</xref>b), (<xref rid="Equ2" ref-type="disp-formula">2</xref>b) and (<xref rid="Equ1" ref-type="disp-formula">1</xref>b), as follows:<disp-formula id="Equ46"><label>46</label><alternatives><mml:math display="block" id="Equ46_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{{F}^P}_{i+1/2} =-\left[ \mathfrak {D}_{i+1/2}(P)+\mathfrak {I}_{i+1/2}(P)\mathfrak {D}_{i+1/2}(\phi )\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ46.gif"/></alternatives></disp-formula><disp-formula id="Equ47"><label>47</label><alternatives><mml:math display="block" id="Equ47_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{j^n}_{i+1/2} = \kappa _n\left[ \mathfrak {D}_{i+1/2}(n)-\mathfrak {I}_{i+1/2}(n)\mathfrak {D}_{i+1/2}(\phi )\right] , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ47.gif"/></alternatives></disp-formula><disp-formula id="Equ48"><label>48</label><alternatives><mml:math display="block" id="Equ48_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{j^p}_{i+1/2} = -\kappa _p\left[ \mathfrak {D}_{i+1/2}(p)+\mathfrak {I}_{i+1/2}(p)\mathfrak {D}_{i+1/2}(\phi )\right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ48.gif"/></alternatives></disp-formula>for <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=0, \ldots , N-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq123.gif"/></alternatives></inline-formula>. The electron current density in the ETL (<inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:msup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^n}^{,E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq124.gif"/></alternatives></inline-formula>) and hole current density in the HTL (<inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:msup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^p}^{,H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq125.gif"/></alternatives></inline-formula>) can be expressed in an equivalent way.</p></sec><sec><p id="Par31">The carrier generation and bulk recombination terms are approximated to be linear on each interval, and to take the value at the midpoint, hence we define<disp-formula id="Equ49"><label>49</label><alternatives><mml:math display="block" id="Equ49_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{i+1/2}&amp;= G(\mathfrak {I}_{i+1/2}(x),t), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ49.gif"/></alternatives></disp-formula><disp-formula id="Equ50"><label>50</label><alternatives><mml:math display="block" id="Equ50_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{i+1/2}&amp;= R(\mathfrak {I}_{i+1/2}(n),\mathfrak {I}_{i+1/2}(p)). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ50.gif"/></alternatives></disp-formula></p></sec><sec><title><italic>Perovskite absorber layer</italic></title><p>The discretised equations governing the evolution of the halide ion vacancy density subject to no-flux boundary conditions, corresponding to (<xref rid="Equ3" ref-type="disp-formula">3</xref>), (<xref rid="Equ11" ref-type="disp-formula">11</xref>c) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>c), are<disp-formula id="Equ51"><label>51</label><alternatives><mml:math display="block" id="Equ51_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\varDelta _{1/2}\left[ \frac{1}{3}\frac{\mathrm {d}P_0}{\mathrm {d}t}+\frac{1}{6}\frac{\mathrm {d}P_1}{\mathrm {d}t}\right] = -\lambda {{F}^P}_{1/2} , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ51.gif"/></alternatives></disp-formula><disp-formula id="Equ52"><label>52</label><alternatives><mml:math display="block" id="Equ52_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\mathfrak {L}_i\left( \frac{\mathrm {d}P}{\mathrm {d}t}\right) = -\lambda \left[ {{F}^P}_{i+1/2}-{{F}^P}_{i-1/2}\right] , \qquad \text {for } i=1,\ldots ,N-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ52.gif"/></alternatives></disp-formula><disp-formula id="Equ53"><label>53</label><alternatives><mml:math display="block" id="Equ53_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\varDelta _{N-1/2}\left[ \frac{1}{6}\frac{\mathrm {d}P_{N-1}}{\mathrm {d}t}+\frac{1}{3}\frac{\mathrm {d}P_N}{\mathrm {d}t}\right] = \lambda {{F}^P}_{N-1/2}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ53.gif"/></alternatives></disp-formula></p><p>The discretisation of Poisson’s equation, from (<xref rid="Equ4" ref-type="disp-formula">4</xref>), becomes<disp-formula id="Equ54"><label>54</label><alternatives><mml:math display="block" id="Equ54_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close="]" open="["><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi><mml:mfenced close="]" open="["><mml:mi>χ</mml:mi><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp;0 = \lambda ^2\left[ \mathfrak {D}_{i+1/2}(\phi )-\mathfrak {D}_{i-1/2}(\phi )\right] +\mathfrak {L}_i(P) -\frac{1}{2}\left[ \varDelta _{i+1/2}+\varDelta _{i-1/2}\right] +&amp;\delta \left[ \chi \mathfrak {L}_i(p)-\mathfrak {L}_i(n)\right] \\ &amp;\quad\text {for} \, \, i=1,\ldots ,N-1. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ54.gif"/></alternatives></disp-formula>The conservation equations for the electrons and holes and the carrier current density boundary conditions, corresponding to (<xref rid="Equ1" ref-type="disp-formula">1</xref>a), (<xref rid="Equ2" ref-type="disp-formula">2</xref>a), (<xref rid="Equ11" ref-type="disp-formula">11</xref>b) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>b), become<disp-formula id="Equ55"><label>55</label><alternatives><mml:math display="block" id="Equ55_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \mathfrak {L}_i\left( \frac{\mathrm {d}n}{\mathrm {d}t}\right) = {j^n}_{i+1/2}-{j^n}_{i-1/2} \\&amp;\quad + \frac{\varDelta _{i+1/2}}{2}\left[ G_{i+1/2} - R_{i+1/2}\right] + \frac{\varDelta _{i-1/2}}{2}\left[ G_{i-1/2} - R_{i-1/2}\right] , \\&amp; \qquad \text {for } i=1,\ldots ,N-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ55.gif"/></alternatives></disp-formula><disp-formula id="Equ56"><label>56</label><alternatives><mml:math display="block" id="Equ56_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \varDelta _{N-1/2}\left[ \frac{1}{6}\frac{\mathrm {d}n_{N-1}}{\mathrm {d}t}+\frac{1}{3}\frac{\mathrm {d}n_N}{\mathrm {d}t}\right] = -{j^n}_{N-1/2} \\&amp;\quad + \frac{\varDelta _{N-1/2}}{2}\left[ G_{N-1/2}- R_{N-1/2}\right] -\bar{R_{\rm{r}}}(n_N,p^{H}_0), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ56.gif"/></alternatives></disp-formula><disp-formula id="Equ57"><label>57</label><alternatives><mml:math display="block" id="Equ57_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mi>χ</mml:mi><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \chi \varDelta _{1/2}\left[ \frac{1}{3}\frac{\mathrm {d}p_0}{\mathrm {d}t}+\frac{1}{6}\frac{\mathrm {d}p_1}{\mathrm {d}t}\right] = -{j^p}_{1/2} \\&amp;\quad + \frac{\varDelta _{1/2}}{2}\left[ G_{1/2} - R_{1/2}\right] -\bar{R_{\rm{l}}}(n^{E}_{N_{\rm E}},p_0), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ57.gif"/></alternatives></disp-formula><disp-formula id="Equ58"><label>58</label><alternatives><mml:math display="block" id="Equ58_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mi>χ</mml:mi><mml:msub><mml:mi mathvariant="fraktur">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \chi \mathfrak {L}_i\left( \frac{\mathrm {d}p}{\mathrm {d}t}\right) = -{j^p}_{i+1/2}+{j^p}_{i-1/2} \\&amp;\quad + \frac{\varDelta _{i+1/2}}{2}\left[ G_{i+1/2} - R_{i+1/2}\right] + \frac{\varDelta _{i-1/2}}{2}\left[ G_{i-1/2} - R_{i-1/2}\right] , \\&amp; \quad \quad \text {for} \, \, i=1,\ldots ,N-1. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ58.gif"/></alternatives></disp-formula></p></sec><sec><title><italic>Electron transport layer</italic></title><p>The equations and Dirichlet boundary conditions for the electric potential and the electron density in the ETL, from (<xref rid="Equ5" ref-type="disp-formula">5</xref>a), (<xref rid="Equ6" ref-type="disp-formula">6</xref>) and (<xref rid="Equ7" ref-type="disp-formula">7</xref>), become<disp-formula id="Equ59"><label>59</label><alternatives><mml:math display="block" id="Equ59_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>Φ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = \phi ^{E}_0 - \frac{\varPhi -\varPhi _{\mathrm{bi}}}{2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ59.gif"/></alternatives></disp-formula><disp-formula id="Equ60"><label>60</label><alternatives><mml:math display="block" id="Equ60_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mfenced close="]" open="["><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = \lambda _{\rm E}^2\left[ \mathfrak {D}^{E}_{i+1/2}(\phi ^{E})-\mathfrak {D}^{E}_{i-1/2}(\phi ^{E})\right] \\&amp;\quad +\frac{1}{2}\left[ \varDelta ^{E}_{i+1/2}+\varDelta ^{E}_{i-1/2}\right] -\mathfrak {L}^{E}_i(n^{E}), \quad \text {for } i=1,\ldots ,N_{\rm E}-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ60.gif"/></alternatives></disp-formula><disp-formula id="Equ61"><label>61</label><alternatives><mml:math display="block" id="Equ61_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = n^{E}_0 - 1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ61.gif"/></alternatives></disp-formula><disp-formula id="Equ62"><label>62</label><alternatives><mml:math display="block" id="Equ62_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \mathfrak {L}^{E}_i\left( \frac{\mathrm {d}n^{E}}{\mathrm {d}t}\right) = {j^n}^{,E}_{i+1/2}-{j^n}^{,E}_{i-1/2}, \qquad \text {for} \, \, i=1,\ldots ,N_{\rm E}-1. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ62.gif"/></alternatives></disp-formula></p></sec><sec><title><italic>Hole transport layer</italic></title><p>Similarly, for the electric potential and hole density in the HTL from (<xref rid="Equ8" ref-type="disp-formula">8</xref>a), (<xref rid="Equ9" ref-type="disp-formula">9</xref>) and (<xref rid="Equ10" ref-type="disp-formula">10</xref>),<disp-formula id="Equ63"><label>63</label><alternatives><mml:math display="block" id="Equ63_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mfenced close="]" open="["><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}0 &amp;= \lambda _{\rm H}^2\left[ \mathfrak {D}^{H}_{i+1/2}(\phi ^{H})-\mathfrak {D}^{H}_{i-1/2}(\phi ^{H})\right] +\mathfrak {L}^{H}_i(p^{H}) \\&amp;\quad -\frac{1}{2}\left[ \varDelta _{i+1/2}+\varDelta _{i-1/2}\right] , \quad \text {for } i=1,\ldots ,N_{\rm H}-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ63.gif"/></alternatives></disp-formula><disp-formula id="Equ64"><label>64</label><alternatives><mml:math display="block" id="Equ64_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>Φ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equ64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 = \phi ^{H}_{N_{\rm H}} + \frac{\varPhi -\varPhi _{\mathrm{bi}}}{2},$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ64.gif"/></alternatives></disp-formula><disp-formula id="Equ65"><label>65</label><alternatives><mml:math display="block" id="Equ65_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mi>χ</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \chi \mathfrak {L}^{H}_i\left( \frac{\mathrm {d}p^{H}}{\mathrm {d}t}\right) = -\left[ {j^p}^{,H}_{i+1/2}-{j^p}^{,H}_{i-1/2}\right] , \qquad \text {for } i=1,\ldots ,N_{\rm H}-1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ65.gif"/></alternatives></disp-formula><disp-formula id="Equ66"><label>66</label><alternatives><mml:math display="block" id="Equ66_Math"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 = p^{H}_{N_{\rm H}}-1.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ66.gif"/></alternatives></disp-formula></p></sec><sec><title><italic>Continuity conditions</italic></title><p>The carrier relations and continuity of the potential across the interfaces from (<xref rid="Equ11" ref-type="disp-formula">11</xref>d, f) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>d, f) are applied directly as follows:<disp-formula id="Equ67"><label>67</label><alternatives><mml:math display="block" id="Equ67_Math"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math><tex-math id="Equ67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi ^{E}_{N_{\rm E}} = \phi _0, \quad k_{\rm E}n^{E}_{N_{\rm E}} = n_0, \quad \phi _N = \phi ^{H}_0, \quad p_N = k_{\rm H}p^{H}_0.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ67.gif"/></alternatives></disp-formula></p><p>The continuity of the displacement field and that of the electric potential across the interfaces, from (<xref rid="Equ11" ref-type="disp-formula">11</xref>e) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>e), are ensured via<disp-formula id="Equ68"><label>68</label><alternatives><mml:math display="block" id="Equ68_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>E</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>6</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>6</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mn>6</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mn>6</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = \mathfrak {D}_{1/2}(\phi )-r_{\rm E}\mathfrak {D}^{E}_{N_{\rm E}-1/2}(\phi ^{E}) \\&amp;\quad -\frac{\varDelta _{1/2}}{\lambda ^2}\left( \frac{1}{2}-\frac{P_1}{3}-\frac{P_2}{6}+\delta \left[ \frac{n_1}{3}+\frac{n_2}{6}-\frac{p_1}{3}-\frac{p_2}{6}\right] \right) \\&amp;\quad -r_{\rm E}\frac{\varDelta ^{E}_{N_{\rm E}-1/2}}{\lambda _{\rm E}^2}\left( \frac{n^{E}_{N_{\rm E}-1}}{6}+\frac{n_0}{3k_{\rm E}}-\frac{1}{2}\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ68.gif"/></alternatives></disp-formula><disp-formula id="Equ69"><label>69</label><alternatives><mml:math display="block" id="Equ69_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="fraktur">D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mn>6</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mfenced close="]" open="["><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mn>6</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mn>6</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mn>6</mml:mn></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = r_{\rm H}\mathfrak {D}^{H}_{1/2}(\phi ^{H})-\mathfrak {D}_{N-1/2}(\phi ) \\&amp;\quad -\frac{\varDelta _{N-1/2}}{\lambda ^2}\left( \frac{1}{2}-\frac{P_{N-1}}{6}-\frac{P_N}{3}+\delta \left[ \frac{n_{N-1}}{6}+\frac{n_N}{3}-\frac{p_{N-1}}{6}-\frac{p_N}{3}\right] \right) \\&amp;\quad -r_{\rm H}\frac{\varDelta ^{H}_{1/2}}{\lambda _{\rm H}^2}\left( \frac{1}{2}-\frac{p_N}{3k_{\rm H}}-\frac{p^{H}_1}{6}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ69.gif"/></alternatives></disp-formula></p><p>Interface recombination is included in the equations for the continuity of carrier current densities, corresponding to (<xref rid="Equ11" ref-type="disp-formula">11</xref>a) and (<xref rid="Equ12" ref-type="disp-formula">12</xref>a), as follows:<disp-formula id="Equ70"><label>70</label><alternatives><mml:math display="block" id="Equ70_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \left( \frac{1}{6}\varDelta ^{E}_{N_{\rm E}-1/2}\frac{\mathrm {d}n^{E}_{N_{\rm E}-1}}{\mathrm {d}t}+\frac{1}{3}\left( \frac{\varDelta ^{E}_{N_{\rm E}-1/2}}{k_{\rm E}}+\varDelta _{1/2}\right) \frac{\mathrm {d}n_0}{\mathrm {d}t}+\frac{1}{6}\varDelta _{1/2}\frac{\mathrm {d}n_1}{\mathrm {d}t}\right) \\&amp;\quad = -\left[ {j^n}^{,E}_{N_{\rm E}-1/2}-{j^n}_{1/2}\right] \\ &amp;\quad \quad + \frac{\varDelta _{1/2}}{2}\left[ G_{1/2} - R_{1/2}\right] -\bar{R_{\rm{l}}}(n^{E}_{N_{\rm E}},p_0), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ70.gif"/></alternatives></disp-formula><disp-formula id="Equ71"><label>71</label><alternatives><mml:math display="block" id="Equ71_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mi>χ</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \chi \left( \frac{1}{6}\varDelta _{N-1/2}\frac{\mathrm {d}p_{N-1}}{\mathrm {d}t}+\frac{1}{3}\left( \varDelta _{N-1/2}+\frac{\varDelta ^{H}_{1/2}}{k_{\rm H}}\right) \frac{\mathrm {d}p_N}{\mathrm {d}t}+\frac{1}{6}\varDelta ^{H}_{1/2}\frac{\mathrm {d}p^{H}_1}{\mathrm {d}t}\right) \\&amp; \quad = {j^p}_{N-1/2}-{j^p}^{,H}_{1/2} \\&amp;\quad \quad+ \frac{\varDelta _{N-1/2}}{2}\left[ G_{N-1/2} - R_{N-1/2}\right] -\bar{R_{\rm{r}}}(n_N,p^{H}_0). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ71.gif"/></alternatives></disp-formula></p></sec></sec><sec id="Sec12"><title>Boundary conditions for modelling open-circuit conditions</title><p id="Par32">In order to simulate open-circuit conditions using the alternative boundary conditions given in (<xref rid="Equ29" ref-type="disp-formula">29</xref>), we simply replace (<xref rid="Equ59" ref-type="disp-formula">59</xref>) and (<xref rid="Equ64" ref-type="disp-formula">64</xref>) by<disp-formula id="Equ72"><label>72</label><alternatives><mml:math display="block" id="Equ72_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mfenced close="]" open="["><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:mi>E</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sigma \varDelta ^{E}_{1/2}\left[ \frac{1}{3}\frac{\mathrm {d}n^{E}_0}{\mathrm {d}t}+\frac{1}{6}\frac{\mathrm {d}n^{E}_1}{\mathrm {d}t}\right] = {j^n}^{,E}_{1/2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ72.gif"/></alternatives></disp-formula><disp-formula id="Equ73"><label>73</label><alternatives><mml:math display="block" id="Equ73_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>E</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;0 = \phi ^{E}_1+\phi ^{H}_{N_{\rm H}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ73.gif"/></alternatives></disp-formula></p></sec></sec><sec id="Sec13"><title>Implementation</title><p id="Par33">In this section, we outline the steps performed by the code. We begin by describing the procedure that is used to integrate forward in time. Next, we outline how the parameters, operating protocol and initial conditions are set. Finally, we outline how IonMonger post-processes the results so that quantities of interest, e.g. the dimensional current output, can be extracted and visualised.</p><sec id="Sec14"><title>Integration in time using MATLAB’s ode15s</title><p id="Par34">The system of differential algebraic equations formulated in Sect. <xref rid="Sec11" ref-type="sec">4.2</xref> is evolved forward in time using MATLAB’s ode15s [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. A prerequisite for leveraging this algorithm is assembling the state variables into a column vector, <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {u}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq126.gif"/></alternatives></inline-formula>. A significant decrease in computational cost (proportional to the length of <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {u}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq127.gif"/></alternatives></inline-formula> squared) is available if the size of <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {u}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq128.gif"/></alternatives></inline-formula> can be reduced, and so we eliminate superfluous variables, namely <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{F}^P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq129.gif"/></alternatives></inline-formula><inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq130.gif"/></alternatives></inline-formula>, <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq131.gif"/></alternatives></inline-formula> and <italic>E</italic> between equations (<xref rid="Equ46" ref-type="disp-formula">46</xref>)–(<xref rid="Equ73" ref-type="disp-formula">73</xref>) before assembling the <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4N+2N_{\rm E}+2N_{\rm H}+4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq132.gif"/></alternatives></inline-formula> remaining unknown functions of time, into the column vector <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {u}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq133.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ74"><label>74</label><alternatives><mml:math display="block" id="Equ74_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mfenced open="["><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:msup><mml:mfenced close="]"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mi>H</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:msubsup></mml:mfenced><mml:mtext>T</mml:mtext></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {u}(t) =&amp;\left[ P_{0}, \cdots , P_{N}, \phi _0, \cdots , \phi _N, \right. \\&amp; n_0, \cdots , n_N, p_0, \cdots , p_N, \\&amp; \phi ^{E}_0,\cdots ,\phi ^{E}_{N_{\rm E}-1}, n^{E}_0, \cdots , n^{E}_{N_{\rm E}-1}, \\&amp; \left. \phi ^{H}_1, \cdots , \phi ^{H}_{N_{\rm H}}, p^{H}_1, \cdots , p^{H}_{N_{\rm H}} \right] ^{\text {T}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ74.gif"/></alternatives></disp-formula><disp-formula id="Equ75"><label>75</label><alternatives><mml:math display="block" id="Equ75_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfenced open="["><mml:mi mathvariant="bold">P</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">n</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">p</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mfenced close="]"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup></mml:mfenced><mml:mtext>T</mml:mtext></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} =&amp;\left[ \mathbf {P}(t)^{\text {T}} \, \, \varvec{\Phi }(t)^{\text {T}} \, \, \mathbf {n}(t)^{\text {T}} \, \, \mathbf {p}(t)^{\text {T}} \, \, \right. \\&amp; \left. \varvec{\Phi }^{E}(t)^{\text {T}} \, \, \mathbf {n}^{E}(t)^{\text {T}} \, \,\varvec{\Phi }^{H}(t)^{\text {T}} \, \, \mathbf {p}^{H}(t)^{\text {T}} \right] ^{\text {T}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ75.gif"/></alternatives></disp-formula>where a superscript T denotes a transpose. In (<xref rid="Equ75" ref-type="disp-formula">75</xref>), <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:mi mathvariant="bold">P</mml:mi></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq134.gif"/></alternatives></inline-formula>, <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq135.gif"/></alternatives></inline-formula>, <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:mi mathvariant="bold">n</mml:mi></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:mi mathvariant="bold">p</mml:mi></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq137.gif"/></alternatives></inline-formula> are column vectors of length <inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq138.gif"/></alternatives></inline-formula>; <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }^{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq139.gif"/></alternatives></inline-formula> and <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {n}^{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq140.gif"/></alternatives></inline-formula> are column vectors of length <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq141.gif"/></alternatives></inline-formula>; and <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }^{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}^{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq143.gif"/></alternatives></inline-formula> are column vectors of length <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq144.gif"/></alternatives></inline-formula>. The problem to be solved can now be written in the form<disp-formula id="Equ76"><label>76</label><alternatives><mml:math display="block" id="Equ76_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {M}\frac{\mathrm {d}\mathbf {u}}{\mathrm {d}t} = \mathbf {f}(\mathbf {u}) \quad \text {with} \quad \mathbf {u}|_{t=0}=\mathbf {u}_0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ76.gif"/></alternatives></disp-formula>in which <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {f}(\mathbf {u})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq145.gif"/></alternatives></inline-formula> is a nonlinear vector function of length <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4N+2N_{\rm E}+2N_{\rm H}+4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq146.gif"/></alternatives></inline-formula> whose entries are the right-hand sides of (<xref rid="Equ51" ref-type="disp-formula">51</xref>)–(<xref rid="Equ71" ref-type="disp-formula">71</xref>) and <inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:mi mathvariant="bold">M</mml:mi></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {M}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq147.gif"/></alternatives></inline-formula> is a singular diagonal mass matrix whose entries are the coefficients of the time derivative terms in the same equations.</p><p id="Par35">Another useful strategy for speeding up computations, and one that we make use of in IonMonger, is to exploit ode15s’s jpattern option. This facilitates additional savings in computational cost by specifying entries in the Jacobian of the vector function <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:mi mathvariant="bold">f</mml:mi></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {f}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq148.gif"/></alternatives></inline-formula> which are known to always equal zero a priori, thereby preventing the algorithm from having to numerically approximate their value as the integration in time proceeds. The function Jac creates a sparse matrix that indicates which entries of the Jacobian need to be numerically approximated at each time step and which are always equal to zero.</p></sec><sec id="Sec15"><title>Parameter input and initial conditions</title><p id="Par36">The necessary dimensional parameters, the illumination protocol <italic>G</italic>(<italic>x</italic>, <italic>t</italic>), voltage protocol <italic>V</italic>(<italic>t</italic>) and solver options are passed between functions in a MATLAB structure called params. A params structure can most easily be created using the script called parameters.m.</p><p id="Par37">Finding initial conditions which satisfy the requisite boundary conditions is non-trivial. In the code, we opt to supply initial conditions that correspond to a device which has been left to reach a quasi-equilibrium with the applied voltage held equal to either a fixed value or the open-circuit voltage such that there is no output current from the cell. In either case, the task of finding initial conditions amounts to finding a valid steady-state solution to the PSC model and we start by finding initial conditions corresponding to when the applied voltage is set equal to the built-in voltage, as defined in (<xref rid="Equ17" ref-type="disp-formula">17</xref>). This task is tackled by the function initial_conditions.m. In order to start the simulation protocol from a different value of the applied voltage or from open-circuit conditions, an additional call is then made to either precondition.m or find_Voc.m, respectively. All three of these routines find discrete representations of the (dimensionless) initial conditions which can be written as<disp-formula id="Equ77"><label>77</label><alternatives><mml:math display="block" id="Equ77_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;P|_{t=0} = \hat{P}(x), \quad {\text { for }}\,\, 0\le x\le 1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ77.gif"/></alternatives></disp-formula><disp-formula id="Equ78"><label>78</label><alternatives><mml:math display="block" id="Equ78_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\phi |_{t=0} = \hat{\phi }(x), \quad {\text { for }}\,\, -w_{\rm E}\le x\le 1+w_{\rm H}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ78.gif"/></alternatives></disp-formula><disp-formula id="Equ79"><label>79</label><alternatives><mml:math display="block" id="Equ79_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;n|_{t=0} = \hat{n}(x),\quad {\text { for }}\,\, -w_{\rm E}\le x \le 1, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ79.gif"/></alternatives></disp-formula><disp-formula id="Equ80"><label>80</label><alternatives><mml:math display="block" id="Equ80_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;p|_{t=0} = \hat{p}(x),\quad {\text { for }}\,\, 0\le x \le 1+w_{\rm H}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ80.gif"/></alternatives></disp-formula>where the initial profiles <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{P}(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq149.gif"/></alternatives></inline-formula>, <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\phi }(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq150.gif"/></alternatives></inline-formula>, <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{n}(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq151.gif"/></alternatives></inline-formula> and <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq152.gif"/></alternatives></inline-formula> satisfy (up to numerical tolerances) the discrete counterpart of the steady-state PDEs. This is achieved by invoking MATLAB’s root-finding tools (i.e. fsolve) which act on the nonlinear system <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {f}(\mathbf {u})=\mathbf{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq153.gif"/></alternatives></inline-formula>, defined in (<xref rid="Equ76" ref-type="disp-formula">76</xref>), with one minor alteration. An additional integral constraint, namely <inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mi>P</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\int _0^1 P\,\mathrm {d}x = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq154.gif"/></alternatives></inline-formula>, is imposed to ensure that the overall number of anion vacancies is maintained within the perovskite. In order to preserve the system as a square system, we therefore replace the last anion vacancy conservation equation (<xref rid="Equ53" ref-type="disp-formula">53</xref>) in the nonlinear system <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {f}(\mathbf {u})=\mathbf{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq155.gif"/></alternatives></inline-formula> with the equation<disp-formula id="Equ81"><label>81</label><alternatives><mml:math display="block" id="Equ81_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi mathvariant="fraktur">I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \sum _{i=0}^{i=N-1} \mathfrak {I}_{i+1/2}(P) \varDelta _{i+1/2} = 1. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ81.gif"/></alternatives></disp-formula></p><p>We note that in the original PDE setting, the electric potential, <inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq156.gif"/></alternatives></inline-formula>, satisfies an elliptic equation, namely Poisson’s equation, and therefore does not require an initial condition, since the initial potential is uniquely defined by the initial densities. After spatial discretisation, Poisson’s equation is translated into a set of algebraic equations, see (<xref rid="Equ54" ref-type="disp-formula">54</xref>), (<xref rid="Equ60" ref-type="disp-formula">60</xref>) and (<xref rid="Equ63" ref-type="disp-formula">63</xref>), and as such, one would not expect initial conditions on the electric potential to be required. However, it is a requirement of ode15s that initial conditions for all components of a DAE system are specified. It is this feature of the integrator that requires us to find and specify the initial potential profile <inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\phi }(x)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq157.gif"/></alternatives></inline-formula>; this profile is chosen to satisfy the algebraic equations derived from the discretisation of Poisson’s equation, and its boundary conditions, into which the initial conditions for <italic>P</italic>, <italic>n</italic> and <italic>p</italic> have been substituted.</p></sec><sec id="Sec16"><title>Calculation of current densities and output</title><p id="Par38">In order to calculate the total (dimensionless) current density <italic>J</italic>(<italic>t</italic>) from the dimensionless solution generated by IonMonger, from (<xref rid="Equ28" ref-type="disp-formula">28</xref>), we use<disp-formula id="Equ82"><label>82</label><alternatives><mml:math display="block" id="Equ82_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>q</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">ion</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">|</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}J(t) &amp;= {j^n}_{k+1/2}+{j^p}_{k+1/2} \\&amp;\quad - \frac{\varepsilon _{\rm A}V_{\mathrm{T}}}{\hat{t}qG_0b^2\tau _{\mathrm{ion}}}\left( \frac{\phi _{k+1}-\phi _k}{\varDelta _{k+1/2}}\bigg |_{t}-\frac{\phi _{k+1}-\phi _k}{\varDelta _{k+1/2}}\bigg |_{t-\hat{t}}\right) \\&amp;\quad +\frac{D_{\mathrm{I}}\hat{N_0}}{G_0b^2}{{F}^P}_{k+1/2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ82.gif"/></alternatives></disp-formula>where <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>ceil</mml:mtext><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = \text {ceil}\left( \frac{N+1}{2}\right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq158.gif"/></alternatives></inline-formula> is the index of the grid point at (or nearest to) the midpoint of the perovskite layer and <inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq159.gif"/></alternatives></inline-formula> denotes the time since the previous time point. The quantities denoted by <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^n}_{k+1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq160.gif"/></alternatives></inline-formula>, <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:msub><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j^p}_{k+1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq161.gif"/></alternatives></inline-formula> and <inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{F}^P}_{k+1/2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq162.gif"/></alternatives></inline-formula> are defined in (<xref rid="Equ47" ref-type="disp-formula">47</xref>), (<xref rid="Equ48" ref-type="disp-formula">48</xref>) and (<xref rid="Equ46" ref-type="disp-formula">46</xref>), respectively. Note that the contributions from the third and fourth terms are usually negligibly small in comparison with the sum of the first two terms.</p><p id="Par39">In addition to the total current density, the (dimensionless) current density losses due to interface recombination (<inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\rm{l}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\rm{r}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq164.gif"/></alternatives></inline-formula>) are calculated prior to re-dimensionalisation as follows:<disp-formula id="Equ83"><label>83</label><alternatives><mml:math display="block" id="Equ83_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;J_{\rm{l}}(t) = -\bar{R_{\rm{l}}}\left( \frac{n_1}{k_{\rm E}},p_1\right) , \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ83.gif"/></alternatives></disp-formula><disp-formula id="Equ84"><label>84</label><alternatives><mml:math display="block" id="Equ84_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;J_{\rm{r}}(t) = -\bar{R_{\rm{r}}}\left( n_N,\frac{p_N}{k_{\rm H}}\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_Equ84.gif"/></alternatives></disp-formula></p><p>The final steps of the solution procedure carried out by IonMonger are to re-dimensionalise (see Sect. <xref rid="Sec8" ref-type="sec">3.5</xref>) and then save the solution variables (<inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:mi mathvariant="bold">P</mml:mi></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq165.gif"/></alternatives></inline-formula>, <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq166.gif"/></alternatives></inline-formula>, <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:mi mathvariant="bold">n</mml:mi></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq167.gif"/></alternatives></inline-formula>, <inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:mi mathvariant="bold">p</mml:mi></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq168.gif"/></alternatives></inline-formula>, <inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }^{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq169.gif"/></alternatives></inline-formula>, <inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {n}^{E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq170.gif"/></alternatives></inline-formula>, <inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }^{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq171.gif"/></alternatives></inline-formula> and <inline-formula id="IEq172"><alternatives><mml:math id="IEq172_Math"><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msup></mml:math><tex-math id="IEq172_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {p}^{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq172.gif"/></alternatives></inline-formula>), spatial vectors (<inline-formula id="IEq173"><alternatives><mml:math id="IEq173_Math"><mml:mi mathvariant="bold">x</mml:mi></mml:math><tex-math id="IEq173_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {x}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq173.gif"/></alternatives></inline-formula>, xE and xH), time (time), evolution of the applied voltage (V) and evolution of the current densities defined above (<inline-formula id="IEq174"><alternatives><mml:math id="IEq174_Math"><mml:mi mathvariant="bold">J</mml:mi></mml:math><tex-math id="IEq174_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq174.gif"/></alternatives></inline-formula>, <inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J_{\rm{l}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq175.gif"/></alternatives></inline-formula> and <inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {J_{\rm{r}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq176.gif"/></alternatives></inline-formula>). These data are saved into a .mat data file along with the input structure (params).</p><p id="Par40">The saved data can be further analysed and plotted in MATLAB in any way chosen by the user. One example plotting script is included in the IonMonger GitHub repository, and instructions for its use are given in the GUIDE. This script can be used to plot the current density generated by a PSC during the reverse and forward scans of a <inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq177.gif"/></alternatives></inline-formula>–<inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq178.gif"/></alternatives></inline-formula> curve, alongside the current losses due to recombination at each of the perovskite/transport layer interfaces, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. Such a plot can enable the user to identify the limiting recombination mechanism for a particular set of input parameters as described in Sect. <xref rid="Sec2" ref-type="sec">2</xref>.</p></sec></sec><sec id="Sec17"><title>Validation</title><p id="Par41"><fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p><bold>a</bold> A measure of the error in each of eight solution variables (listed in the legend) for five simulations versus the number of grid points in the domain on a logarithmic scale. Dotted lines show the expected rate of convergence aligned to the rightmost data point. <bold>b</bold> The computation time for each of the same five simulations versus the number of grid points on a logarithmic scale. Here, a dotted line is shown as a guide for the eye. For each of the five simulations performed for both panels <bold>a</bold> and <bold>b</bold>, the input parameter <italic>N</italic> equals 100, 200, 400, 800 and 1600, while the other parameters are identical to those used for Fig. <xref rid="Fig1" ref-type="fig">1</xref>a (for which <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=400$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq179.gif"/></alternatives></inline-formula>). The number of grid points is equal to <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+N_{\rm E}+N_{\rm H}+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq180.gif"/></alternatives></inline-formula> where <inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq181.gif"/></alternatives></inline-formula> and <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq182.gif"/></alternatives></inline-formula> are automatically computed from <italic>N</italic> (see Sect. <xref rid="Sec10" ref-type="sec">4.1</xref>) (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2019_1396_Fig3_HTML.png" id="MO87"/></fig></p><p id="Par42">For the purpose of verifying the results generated by IonMonger, in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, we plot a measure of the error in eight different solution variables against the number of grid points (<inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+N_{\rm E}+N_{\rm H}+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq183.gif"/></alternatives></inline-formula>) on a logarithmic scale for five example simulations. The only input parameter that is varied between the five simulations is <italic>N</italic>, which takes values of 100, 200, 400, 800 and 1600, while all other input parameters are the same as those used for Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Due to the lack of an exact solution, the errors are calculated with respect to another simulation performed on an even finer spatial grid consisting of 5613 points (for which the input parameter <italic>N</italic> is set equal to 3200). The chosen error measure is the sum (an <inline-formula id="IEq184"><alternatives><mml:math id="IEq184_Math"><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq184_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq184.gif"/></alternatives></inline-formula> norm) of the differences between the value of the variable computed by the example simulation and that computed by the 5613-point simulation, averaged over all 300 time points of the simulation protocol after <inline-formula id="IEq185"><alternatives><mml:math id="IEq185_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq185_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq185.gif"/></alternatives></inline-formula>. The same error measure was used in [<xref ref-type="bibr" rid="CR6">6</xref>] to compare the same solution method applied to a single-layer version of the model against two other methods on different spatial grids. Here, the eight solution variables for which the error is calculated are the (dimensionless) ion vacancy density, electric potential, electron concentration and hole concentration at the ETL/perovskite and perovskite/HTL interfaces located at <inline-formula id="IEq186"><alternatives><mml:math id="IEq186_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq186_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq187.gif"/></alternatives></inline-formula>, respectively, as listed in the legend. The results demonstrate the expected second-order pointwise convergence of the finite element scheme on which IonMonger is based [<xref ref-type="bibr" rid="CR6">6</xref>]. The variation in the magnitude of the error between the eight solution variables is due to differences in the magnitude of the dimensionless variables themselves.</p><p id="Par43">Figure <xref rid="Fig3" ref-type="fig">3</xref>b shows the computation times associated with each of the five simulations in panel (a), also plotted against the number of grid points on a logarithmic scale. Note that the computation time will also depend upon the length of the simulation protocol. The temporal tolerances for the integration in time performed by MATLAB’s ode15s were fixed for all simulations at values of <inline-formula id="IEq188"><alternatives><mml:math id="IEq188_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq188_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-6}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq188.gif"/></alternatives></inline-formula> for the relative tolerance and <inline-formula id="IEq189"><alternatives><mml:math id="IEq189_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq189_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-10}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq189.gif"/></alternatives></inline-formula> for the absolute tolerance.</p><p id="Par44">A comprehensive verification of the single-layer finite element scheme, from which this code was developed, is provided in Sections 5 and 6 of [<xref ref-type="bibr" rid="CR6">6</xref>]. This work includes plots of each solution variable across the perovskite layer against corresponding asymptotic results, which show very good agreement between the two approaches for realistic values of the input parameters.</p><sec id="Sec18"><title>Comparison to asymptotic results</title><p id="Par45">Further validation of the numerical scheme, against results obtained using an alternative (although approximate) solution method, is given in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Here, we compare the simulation results for the typical <inline-formula id="IEq192"><alternatives><mml:math id="IEq192_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq192_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq192.gif"/></alternatives></inline-formula>–<inline-formula id="IEq193"><alternatives><mml:math id="IEq193_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq193_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq193.gif"/></alternatives></inline-formula> measurement displayed in Fig. <xref rid="Fig1" ref-type="fig">1</xref> to the equivalent quantities computed using a combined asymptotic/numerical method. This alternative method is described in detail for a single-layer model in [<xref ref-type="bibr" rid="CR5">5</xref>] and has been used to explain trends in experimental observations in [<xref ref-type="bibr" rid="CR4">4</xref>]. Excellent agreement is shown between the current densities computed using the two methods.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>A comparison between the current density calculated using the IonMonger code (purple lines) and an alternative, combined asymptotic/numerical method from [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] (green circles) for the same simulation of a <inline-formula id="IEq190"><alternatives><mml:math id="IEq190_Math"><mml:mi>J</mml:mi></mml:math><tex-math id="IEq190_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq190.gif"/></alternatives></inline-formula>–<inline-formula id="IEq191"><alternatives><mml:math id="IEq191_Math"><mml:mi>V</mml:mi></mml:math><tex-math id="IEq191_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq191.gif"/></alternatives></inline-formula> measurement as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (Color figure online)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/10825_2019_1396_Fig4_HTML.png" id="MO88"/></fig></p></sec></sec><sec id="Sec19" sec-type="conclusions"><title>Conclusions</title><p id="Par47">We have built a fast and robust numerical solver for coupled ionic–electronic charge transport in a realistic three-layer perovskite solar cell architecture. The scheme is able to simulate a variety of relevant device operating regimes, including current–voltage sweeps and open-circuit transients, both with the possibility of having time-dependent illumination. Simulations of this sort can be carried out in seconds to minutes of computation time on a standard modern personal computer. The only prerequisite for making use of this tool is access to MATLAB and its suite of routines for time integration of ordinary differential equations, specifically the ode15s routine.</p><p id="Par48">This work therefore provides a tool that is capable of playing a major role in guiding the development of perovskite solar cells. Our IonMonger code provides the possibility of independently varying each of the device parameters, so that their roles in determining cell performance can be discerned, something that is difficult, or even impossible, to achieve experimentally. One area of particular practical interest is understanding what can be done to mitigate the amount of parasitic recombination in PSCs, thereby further improving their performance. As demonstrated in [<xref ref-type="bibr" rid="CR4">4</xref>], it is possible to suppress these losses via careful tuning of the cell’s constituent material properties, and we anticipate that further studies in the same spirit will be made possible using the computational tool provided here. A second area where such a simulation tool is surely needed is in understanding the long-term degradation processes that occur within PSCs on timescales of between hours and weeks. While the current version of the code cannot simulate degradation, it can be used to predict the effects of different device parameters on some of the proposed causes of degradation. For example, degradation due to chemical reactions at the perovskite/transport layer interfaces [<xref ref-type="bibr" rid="CR3">3</xref>] is likely to be exacerbated by iodide ion accumulation in the Debye layers, while degradation due to the penetration of extrinsic ions, e.g. oxygen, into the perovskite may be enhanced by an accumulation of ion vacancies [<xref ref-type="bibr" rid="CR1">1</xref>]. The development of IonMonger to include additional physical processes that occur on longer timescales would allow researchers to investigate long-term behaviour and stability much more quickly than is possible via experimentation, and hence it will be the subject of future work.</p><p id="Par49">The authors are committed to maintaining and expanding the functionality of the code, and any updates will be hosted on the GitHub repository which can be accessed at <ext-link xlink:href="https://github.com/PerovskiteSCModelling/IonMonger" ext-link-type="uri">https://github.com/PerovskiteSCModelling/IonMonger</ext-link>. While we cannot promise a high level of technical support to all users, we are happy to receive any suggestions on ways in which the features of the code can be improved and/or expanded, and it is our intention that the code will grow as the research priorities of the perovskite community evolve. Contact details for current code developers can be found in the README file in the main folder of the IonMonger GitHub repository.</p></sec></body><back><ack><title>Acknowledgements</title><p>NEC and JMC were supported by EPSRC-funded studentships from the CDT in New and Sustainable Photovoltaics (with reference EP/L01551X/1). NEC was subsequently supported by an EPSRC Doctoral Prize (Ref. EP/R513325/1). NEC would like to thank Dr. Sam Mangham from the University of Southampton’s Research Software Group for his advice on sustainable code design.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aristidou</surname><given-names>N</given-names></name><name><surname>Eames</surname><given-names>C</given-names></name><name><surname>Sanchez-Molina</surname><given-names>I</given-names></name><name><surname>Bu</surname><given-names>X</given-names></name><name><surname>Kosco</surname><given-names>J</given-names></name><name><surname>Islam</surname><given-names>M</given-names></name><name><surname>Haque</surname><given-names>SA</given-names></name></person-group><article-title xml:lang="en">Fast oxygen diffusion and iodide defects mediate oxygen-induced degradation of perovskite solar cells</article-title><source>Nat. Commun.</source><year>2017</year><volume>8</volume><fpage>15218</fpage><pub-id pub-id-type="doi">10.1038/ncomms15218</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calado</surname><given-names>P</given-names></name><name><surname>Telford</surname><given-names>AM</given-names></name><name><surname>Bryant</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Nelson</surname><given-names>J</given-names></name><name><surname>O’Regan</surname><given-names>BC</given-names></name><name><surname>Barnes</surname><given-names>PRF</given-names></name></person-group><article-title xml:lang="en">Evidence for ion migration in hybrid perovskite solar cells with minimal hysteresis</article-title><source>Nat. Commun.</source><year>2016</year><volume>7</volume><fpage>13831</fpage><pub-id pub-id-type="doi">10.1038/ncomms13831</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carrillo</surname><given-names>J</given-names></name><name><surname>Guerrero</surname><given-names>A</given-names></name><name><surname>Rahimnejad</surname><given-names>S</given-names></name><name><surname>Almora</surname><given-names>O</given-names></name><name><surname>Zarazua</surname><given-names>I</given-names></name><name><surname>Mas-Marza</surname><given-names>E</given-names></name><name><surname>Bisquert</surname><given-names>J</given-names></name><name><surname>Garcia-Belmonte</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Ionic reactivity at contacts and aging of methylammonium lead triiodide perovskite solar cells</article-title><source>Adv. Energy Mater.</source><year>2016</year><pub-id pub-id-type="doi">10.1002/aenm.201502246</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Cave</surname><given-names>JM</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">How transport layer properties affect perovskite solar cell performance: insights from a coupled charge transport/ion migration model</article-title><source>Energy Environ. Sci. Adv.</source><year>2019</year><volume>12</volume><issue>1</issue><fpage>396</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1039/C8EE01576G</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>O’Kane</surname><given-names>SEJ</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Systematic derivation of a surface polarisation model for planar perovskite solar cells</article-title><source>Eur. J. Appl. Math.</source><year>2019</year><volume>30</volume><fpage>427</fpage><lpage>457</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3934483</pub-id><pub-id pub-id-type="doi">10.1017/S0956792518000207</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">A fast and robust numerical scheme for solving models of charge carrier transport and ion vacancy motion in perovskite solar cells</article-title><source>Appl. Math. Model.</source><year>2018</year><volume>63</volume><fpage>329</fpage><lpage>348</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3844296</pub-id><pub-id pub-id-type="doi">10.1016/j.apm.2018.06.051</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Quilettes</surname><given-names>DW</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Burlakov</surname><given-names>VM</given-names></name><name><surname>Graham</surname><given-names>DJ</given-names></name><name><surname>Leijtens</surname><given-names>T</given-names></name><name><surname>Osherov</surname><given-names>A</given-names></name><name><surname>Bulović</surname><given-names>V</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name><name><surname>Ginger</surname><given-names>DS</given-names></name><name><surname>Stranks</surname><given-names>SD</given-names></name></person-group><article-title xml:lang="en">Photo-induced halide redistribution in organic–inorganic perovskite films</article-title><source>Nat. Commun.</source><year>2016</year><volume>7</volume><fpage>11683</fpage><pub-id pub-id-type="doi">10.1038/ncomms11683</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eames</surname><given-names>C</given-names></name><name><surname>Frost</surname><given-names>JM</given-names></name><name><surname>Barnes</surname><given-names>PRF</given-names></name><name><surname>O’Regan</surname><given-names>BC</given-names></name><name><surname>Walsh</surname><given-names>A</given-names></name><name><surname>Islam</surname><given-names>MS</given-names></name></person-group><article-title xml:lang="en">Ionic transport in hybrid lead iodide perovskite solar cells</article-title><source>Nat. Commun.</source><year>2015</year><volume>6</volume><fpage>7497</fpage><pub-id pub-id-type="doi">10.1038/ncomms8497</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egger</surname><given-names>DA</given-names></name><name><surname>Bera</surname><given-names>A</given-names></name><name><surname>Cahen</surname><given-names>D</given-names></name><name><surname>Hodes</surname><given-names>G</given-names></name><name><surname>Kirchartz</surname><given-names>T</given-names></name><name><surname>Kronik</surname><given-names>L</given-names></name><name><surname>Lovrincic</surname><given-names>R</given-names></name><name><surname>Rappe</surname><given-names>AM</given-names></name><name><surname>Reichman</surname><given-names>DR</given-names></name><name><surname>Yaffe</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">What remains unexplained about the properties of halide perovskites?</article-title><source>Adv. Mater.</source><year>2018</year><volume>30</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1002/adma.201800691</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fell</surname><given-names>A</given-names></name><name><surname>Schön</surname><given-names>J</given-names></name><name><surname>Schubert</surname><given-names>MC</given-names></name><name><surname>Glunz</surname><given-names>SW</given-names></name></person-group><article-title xml:lang="en">The concept of skins for silicon solar cell modeling</article-title><source>Sol. Energy Mater. Sol. Cells</source><year>2017</year><volume>173</volume><fpage>128</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2017.05.012</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name><name><surname>Leijtens</surname><given-names>T</given-names></name><name><surname>Richardson</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">A model for the operation of perovskite based hybrid solar cells: formulation, analysis, and comparison to experiment</article-title><source>SIAM J. Appl. Math.</source><year>2014</year><volume>74</volume><fpage>1935</fpage><lpage>1966</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3291540</pub-id><pub-id pub-id-type="doi">10.1137/130934258</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Idígoras</surname><given-names>J</given-names></name><name><surname>Contreras-Bernal</surname><given-names>L</given-names></name><name><surname>Cave</surname><given-names>JM</given-names></name><name><surname>Courtier</surname><given-names>NE</given-names></name><name><surname>Barranco</surname><given-names>A</given-names></name><name><surname>Borras</surname><given-names>A</given-names></name><name><surname>Sánchez-Valencia</surname><given-names>JR</given-names></name><name><surname>Anta</surname><given-names>JA</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name></person-group><article-title xml:lang="en">The role of surface recombination on the performance of perovskite solar cells: effect of morphology and crystalline phase of TiO<sub>2</sub> contact</article-title><source>Adv. Mater. Interfaces</source><year>2018</year><volume>5</volume><issue>21</issue><fpage>1801076</fpage><pub-id pub-id-type="doi">10.1002/admi.201801076</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacobs</surname><given-names>DA</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Pfeffer</surname><given-names>F</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name><name><surname>White</surname><given-names>TP</given-names></name><name><surname>Beck</surname><given-names>FJ</given-names></name><name><surname>Catchpole</surname><given-names>KR</given-names></name></person-group><article-title xml:lang="en">The two faces of capacitance: new interpretations for electrical impedance measurements of perovskite solar cells and their relation to hysteresis</article-title><source>J. Appl. Phys.</source><year>2018</year><volume>124</volume><fpage>225702</fpage><pub-id pub-id-type="doi">10.1063/1.5063259</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">MATLAB version 9.3.0.713579 (R2017b) (2017)</mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">National Renewable Energy Laboratory (NREL) research cell record efficiency chart. <ext-link xlink:href="http://www.nrel.gov/pv/assets/images/efficiency-chart.png" ext-link-type="uri">http://www.nrel.gov/pv/assets/images/efficiency-chart.png</ext-link> (2018). Accessed 17 June 2019</mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>J</given-names></name></person-group><source>The Physics of Solar Cells</source><year>2003</year><publisher-loc>London</publisher-loc><publisher-name>Imperial College Press</publisher-name><pub-id pub-id-type="doi">10.1142/p276</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phung</surname><given-names>N</given-names></name><name><surname>Abate</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">The impact of nano- and microstructure on the stability of perovskite solar cells</article-title><source>Small</source><year>2018</year><volume>14</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1002/smll.201802573</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>G</given-names></name><name><surname>O’Kane</surname><given-names>SEJ</given-names></name><name><surname>Niemann</surname><given-names>RG</given-names></name><name><surname>Peltola</surname><given-names>TA</given-names></name><name><surname>Foster</surname><given-names>JM</given-names></name><name><surname>Cameron</surname><given-names>PJ</given-names></name><name><surname>Walker</surname><given-names>AB</given-names></name></person-group><article-title xml:lang="en">Can slow-moving ions explain hysteresis in the current–voltage curves of perovskite solar cells?</article-title><source>Energy Environ. Sci.</source><year>2016</year><volume>9</volume><fpage>1476</fpage><lpage>1485</lpage><pub-id pub-id-type="doi">10.1039/C5EE02740C</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharfetter</surname><given-names>DL</given-names></name><name><surname>Gummel</surname><given-names>HK</given-names></name></person-group><article-title xml:lang="en">Large-signal analysis of a silicon read diode oscillator</article-title><source>IEEE Trans. Electron. Devices</source><year>1969</year><volume>16</volume><fpage>64</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1109/T-ED.1969.16566</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shampine</surname><given-names>LF</given-names></name><name><surname>Reichelt</surname><given-names>MW</given-names></name></person-group><article-title xml:lang="en">The MATLAB ODE suite</article-title><source>SIAM J. Sci. Comput.</source><year>1997</year><volume>18</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1433374</pub-id><pub-id pub-id-type="doi">10.1137/S1064827594276424</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shampine</surname><given-names>LF</given-names></name><name><surname>Reichelt</surname><given-names>MW</given-names></name><name><surname>Kierzenka</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Solving index-1 DAEs in MATLAB and Simulink</article-title><source>SIAM Rev.</source><year>1999</year><volume>41</volume><fpage>538</fpage><lpage>552</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1719129</pub-id><pub-id pub-id-type="doi">10.1137/S003614459933425X</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skeel</surname><given-names>RD</given-names></name><name><surname>Berzins</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">A method for the spatial discretization of parabolic equations in one space variable</article-title><source>SIAM J. Sci. Stat. Comput.</source><year>1990</year><volume>11</volume><fpage>1</fpage><lpage>32</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1032224</pub-id><pub-id pub-id-type="doi">10.1137/0911001</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snaith</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Present status and future prospects of perovskite photovoltaics</article-title><source>Nat. Mater.</source><year>2018</year><volume>17</volume><fpage>372</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1038/s41563-018-0071-z</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snaith</surname><given-names>HJ</given-names></name><name><surname>Abate</surname><given-names>A</given-names></name><name><surname>Ball</surname><given-names>JM</given-names></name><name><surname>Eperon</surname><given-names>GE</given-names></name><name><surname>Leijtens</surname><given-names>TC</given-names></name><name><surname>Noel</surname><given-names>NK</given-names></name><name><surname>Stranks</surname><given-names>SD</given-names></name><name><surname>Wang</surname><given-names>JT-W</given-names></name><name><surname>Wojciechowski</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Anomalous hysteresis in perovskite solar cells</article-title><source>J. Phys. Chem. Lett.</source><year>2014</year><volume>5</volume><fpage>1511</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1021/jz500113x</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Reenen</surname><given-names>S</given-names></name><name><surname>Kemerink</surname><given-names>M</given-names></name><name><surname>Snaith</surname><given-names>HJ</given-names></name></person-group><article-title xml:lang="en">Modeling anomalous hysteresis in perovskite solar cells</article-title><source>J. Phys. Chem. Lett.</source><year>2015</year><volume>6</volume><fpage>3808</fpage><lpage>3814</lpage><pub-id pub-id-type="doi">10.1021/acs.jpclett.5b01645</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walsh</surname><given-names>A</given-names></name><name><surname>Scanlon</surname><given-names>DO</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Gong</surname><given-names>XG</given-names></name><name><surname>Wei</surname><given-names>S-H</given-names></name></person-group><article-title xml:lang="en">Self-regulation mechanism for charged point defects in hybrid halide perovskites</article-title><source>Angew. Chem. Int. Ed.</source><year>2015</year><volume>54</volume><fpage>1791</fpage><lpage>1794</lpage><pub-id pub-id-type="doi">10.1002/anie.201409740</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walter</surname><given-names>D</given-names></name><name><surname>Fell</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Duong</surname><given-names>T</given-names></name><name><surname>Barugkin</surname><given-names>C</given-names></name><name><surname>Wu</surname><given-names>N</given-names></name><name><surname>White</surname><given-names>TP</given-names></name><name><surname>Weber</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Transient photovoltage in perovskite solar cells: interaction of trap-mediated recombination and migration of multiple ionic species</article-title><source>J. Phys. Chem. C</source><year>2018</year><volume>122</volume><fpage>11270</fpage><lpage>11281</lpage><pub-id pub-id-type="doi">10.1021/acs.jpcc.8b02529</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec20"><title>Electronic supplementary material</title><p id="Par50">Below is the link to the electronic supplementary material.

<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/10825_2019_1396_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary material 1 (pdf 163 KB)</p></caption></media></supplementary-material></p></sec></app></app-group><fn-group><fn id="Fn1"><label>1</label><p id="Par6">The simulations in [<xref ref-type="bibr" rid="CR4">4</xref>] are based on the same mathematical model as described in this work; however, the definitions of the constants of proportionality <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\rm E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\rm H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq9.gif"/></alternatives></inline-formula> and the built-in voltage <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{bi}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2019_1396_Article_IEq10.gif"/></alternatives></inline-formula> vary between the two works; the definitions in this work are compatible with Boltzmann statistics for non-degenerate semiconductors, see (<xref rid="Equ13" ref-type="disp-formula">13</xref>)–(<xref rid="Equ17" ref-type="disp-formula">17</xref>).</p></fn></fn-group><notes notes-type="Misc"><title>Publisher's Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Electrical Engineering</facet-value><facet-value count="1">Engineering</facet-value><facet-value count="1">Mathematical and Computational Engineering</facet-value><facet-value count="1">Mechanical Engineering</facet-value><facet-value count="1">Optical and Electronic Materials</facet-value><facet-value count="1">Theoretical, Mathematical and Computational Physics</facet-value></facet><facet name="keyword"><facet-value count="1">Device simulation</facet-value><facet-value count="1">Drift–diffusion</facet-value><facet-value count="1">Ion vacancy migration</facet-value><facet-value count="1">Perovskite solar cell</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Computational Electronics</facet-value></facet><facet name="year"><facet-value count="1">2019</facet-value></facet><facet name="country"><facet-value count="1">United Kingdom</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
