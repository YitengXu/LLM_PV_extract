<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41598-018-26469-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" specific-use="web-only" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41598</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title><abbrev-journal-title abbrev-type="publisher">Sci Rep</abbrev-journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41598-018-26469-3</article-id><article-id pub-id-type="manuscript">26469</article-id><article-id pub-id-type="doi">10.1038/s41598-018-26469-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/4077/4072/4062</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/166/988</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/129</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/119/118</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Rapid Optimization of External Quantum Efficiency of Thin Film Solar Cells Using Surrogate Modeling of Absorptivity</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6615-1552</contrib-id><name><surname>Kaya</surname><given-names>Mine</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2835-863X</contrib-id><name><surname>Hajimirza</surname><given-names>Shima</given-names></name><address><email>shima.hm@tamu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41598018264693_cor2">b</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4687 2082</institution-id><institution-id institution-id-type="GRID">grid.264756.4</institution-id><institution content-type="org-division">Department of Mechanical Engineering</institution><institution content-type="org-name">Texas A&amp;M University</institution></institution-wrap><addr-line content-type="street">3123 TAMU</addr-line><addr-line content-type="postcode">77843-3123</addr-line><addr-line content-type="city">College Station</addr-line><addr-line content-type="state">TX</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><corresp id="IDs41598018264693_cor2"><label>b</label><email>shima.hm@tamu.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>25</day><month>5</month><year>2018</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2018</year></pub-date><volume>8</volume><issue seq="8170">1</issue><elocation-id>8170</elocation-id><history><date date-type="registration"><day>15</day><month>5</month><year>2018</year></date><date date-type="received"><day>16</day><month>1</month><year>2018</year></date><date date-type="accepted"><day>25</day><month>4</month><year>2018</year></date><date date-type="online"><day>25</day><month>5</month><year>2018</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2018</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">This paper uses surrogate modeling for very fast design of thin film solar cells with improved solar-to-electricity conversion efficiency. We demonstrate that the wavelength-specific optical absorptivity of a thin film multi-layered amorphous-silicon-based solar cell can be modeled accurately with Neural Networks and can be efficiently approximated as a function of cell geometry and wavelength. Consequently, the external quantum efficiency can be computed by averaging surrogate absorption and carrier recombination contributions over the entire irradiance spectrum in an efficient way. Using this framework, we optimize a multi-layer structure consisting of ITO front coating, metallic back-reflector and oxide layers for achieving maximum efficiency. Our required computation time for an entire model fitting and optimization is 5 to 20 times less than the best previous optimization results based on direct Finite Difference Time Domain (FDTD) simulations, therefore proving the value of surrogate modeling. The resulting optimization solution suggests at least 50% improvement in the external quantum efficiency compared to bare silicon, and 25% improvement compared to a random design.</p></abstract><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Research</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>5</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>15</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41598_2018_Article_26469.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par2">The solution of inverse problem is challenging when analytical solution is not available for the forward problem. This is the case for many engineering problems with underlying physical utilities and constraints where the <italic>best design</italic> is sought. Underlying many complex design problems reside spatially and temporally discretized partial differential equations, which usually do not render closed form solutions. Consequently, there is no explicit expression for the design utility function (i.e. forward problem) and its derivatives (i.e., gradient vector, Hessian matrix, etc.). Therefore, inverse problem can only be solved within a black-box optimization framework which requires many iterative simulations of the forward problem and thus can be computationally expensive<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. The progress in computational methods and resources has made solving complex design problems feasible by means of more powerful simulators, parallel processing and more to-the-point black box optimization algorithms.</p><p id="Par3">An example of a computationally expensive problem with non-explicit derivative is modeling opto-electrical characteristics of devices at subwavelength scales, including thin film solar cells (TFSC). Governing equations for this problem are Maxwell’s electromagnetic equations which are partial differential equations expressing the relationship between electric and magnetic fields and current flow, as well as drift-diffusion equations that determine the transport of carriers inside a medium. In order to model the efficiency of a solar cell in response to solar irradiance, Maxwell’s equations must be solved to render the number and distribution of absorbed photons in the absorber layer (semiconductor). Since solving Maxwell’s equations for a relatively wide solar spectrum (visible, UV and IR) is time-consuming given the current numerical technologies, TFSC design problem is limited to heuristic searches, intuitive guesses and experimental evaluations. Recent research work, including the efforts of the author, has attempted to utilize smart and efficient global optimization algorithms to systematically design efficient TFSCs<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>.</p><p id="Par4">An alternative to costly black-box optimization is surrogate modeling. The unknown black-box function can be approximated using a learning model by collecting a representative set of training data. The resulting model is presumably much more efficient to calculate for a new set of input parameters than the original forward problem<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. The surrogate model does not have to be the complete black-box function, but rather a subcomponent function. Specifically, if the utility function is known to be a sum of another sub-function over a range of a few input parameters, then a more efficient approach is to approximate the sub-function. This happens to be the case for TFSCs; the number of absorbed photons is the weighted integral of optical generation rate (absorptivity) at individual wavelengths, therefore single frequency optical characteristics can be modeled and approximated<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>.</p><p id="Par5">In the present work, we use surrogate modeling for approximating optical absorptivity, and therefore external quantum efficiency of a particular class of multi-layered thin film solar cells. We use the learned models to efficiently design the multi-parameter geometry of the TFSC structure for maximum efficiency. The multi-layered silicon-based TFSCs that we study consist of front anti-reflective and metallic back-reflector coatings, and have practical thin oxide layers that occur during the fabrication process. We demonstrate that neural networks (NN) can be used to reliably learn the optical absorptivity of the structures as a function of geometry and radiation wavelength. Additionally, we show that the resulting optimization reduces the computational burden of optimization by a factor of 5 to 20. The resulting design shows 25% improvement in the external quantum efficiency compared to a random design, and 50% improvement compared to bare silicon.</p><p id="Par6">This paper is organized as follows. First an overview of the multilayer solar cell structure and fundamentals of optical modeling in subwavelength scale solar cells are presented. Then the framework of the present optimization problem along with the basics of surrogate-based optimization and regression models are provided. Finally, numerical results are presented and discussed.</p></sec><sec id="Sec2"><title>Thin Film Multilayer Solar Cell Structure</title><p id="Par7">The thin film solar cell structure in Fig. <xref rid="Fig1" ref-type="fig">1</xref> is considered in the present study. The amorphous silicon (a-Si) active layer is stacked between aluminum back reflector and antireflective indium tin oxide (ITO) layers. The oxides Al<sub>2</sub>O<sub>3</sub> and SiO<sub>2</sub> formed during manufacturing could help to improve solar cell performance by balancing the refractive indices between a-Si and the front/back layers<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p>Thin film multilayer solar cell structure.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig1_HTML.jpg"/></fig></p><p id="Par8">The performance of a solar cell is often quantified by internal (IQE) and external (EQE) quantum efficiencies. IQE is the ratio of electrons collected as photocurrent to the number of absorbed photons. On the other hand, EQE combines optical performance and charge generation and calculates the ratio of the number of electrons collected as photocurrent to the number of photons incident to the solar cell. Ideal EQE is unity, however this is never the case due to two main practical reasons: (i) optical losses due to photons that are not absorbed and (ii) recombination losses due to non-collected excitons<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. EQE is calculated from Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>).<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:msub><mml:mrow><mml:mi mathvariant="italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">A</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:msub><mml:mrow><mml:mi mathvariant="italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">I</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\eta }}_{{e}}=\frac{{{N}}_{{e}}}{{{N}}_{{i}}}=\frac{{{N}}_{{p}}}{{{N}}_{{i}}}\frac{{{N}}_{{e}}}{{{N}}_{{p}}}={{\eta }}_{{A}}\,{{\eta }}_{{I}},$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ1.gif"/></alternatives></disp-formula>where <italic>η</italic><sub><italic>A</italic></sub> = <italic>N</italic><sub><italic>p</italic></sub>/<italic>N</italic><sub><italic>i</italic></sub> is the absorption efficiency, <italic>N</italic><sub><italic>i</italic></sub> is the number of photons incident on the solar cell and <italic>N</italic><sub><italic>p</italic></sub> is the photons absorbed within a-Si layer given by:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mspace width=".25em"/><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mspace width=".25em"/><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{p}=\frac{1}{hc}\int \lambda \,\alpha (\lambda )\,I(\lambda )d\lambda ,$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mspace width=".25em"/><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{i}=\frac{1}{hc}\int \lambda \,I(\lambda )d\lambda .$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ3.gif"/></alternatives></disp-formula></p><p id="Par9">where <italic>h</italic> is the Planck’s constant, <italic>c</italic> is the speed of light, <italic>α</italic>(<italic>λ</italic>) is the spectral absorptivity and <italic>I</italic>(<italic>λ</italic>) is the irradiance spectrum. In this study, AM1.5 standard terrestrial spectrum<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> is used for irradiance.</p><p id="Par10"><italic>N</italic><sub><italic>e</italic></sub> is the number of electrons collected as photocurrent, and <italic>η</italic><sub><italic>I</italic></sub> is IQE. <italic>η</italic><sub><italic>I</italic></sub> is calculated from:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{I}=\frac{{N}_{e}}{{N}_{p}}=\frac{{J}_{L}/q}{{N}_{p}}=\frac{1}{{N}_{p}}\frac{1}{q}[q{\int }_{0}^{{t}_{aSi}}{n}_{p}(x){{\mathbb{P}}}_{c}(x)dx].$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ4.gif"/></alternatives></disp-formula>where <italic>J</italic><sub><italic>L</italic></sub> is the photocurrent, <italic>q</italic> is the elementary charge, <italic>n</italic><sub><italic>p</italic></sub>(<italic>x</italic>) is the carrier generation rate, <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{P}}}_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq7.gif"/></alternatives></inline-formula> is <italic>collection probability</italic> defined as the probability that a carrier generated due to absorption contributes to the photocurrent.</p><p id="Par11"><italic>n</italic><sub><italic>p</italic></sub>(<bold>x</bold>) depends on the number of photons absorbed within the active layer. Assuming photons are absorbed uniformly within a-Si layer, <italic>η</italic><sub><italic>I</italic></sub> becomes:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{I}=\frac{1}{{t}_{aSi}}{\int }_{0}^{{t}_{aSi}}{{\mathbb{P}}}_{c}(x)dx.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ5.gif"/></alternatives></disp-formula></p><p id="Par12">IQE and EQE are mostly experimentally measured in order to calculate short-circuit current density<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. There are numerous examples of experimental measurements of IQE and EQE for solar cells. For example, Thouti <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> measured IQE of a textured silicon solar cell to estimate the effective diffusion length due to the presence of resonance effect of silver nanoparticles. There have also been attempts at obtaining analytical expressions for the quantity. Ferrero <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> proposed a method to calculate EQE of photodiodes based on Beer’s law for absorption and Shockley-Read-Hall recombination. The structure is divided into front, space-charge (depletion) and rear regions and treated differently regarding recombination. Dibbs <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> approximated the collection model as a step function, which is unity in the depletion region and zero elsewhere. In these two theoretical models, the exact knowledge of the dimensions of depletion zone and p and n layers are required. A probabilistic model of EQE similar in principle to those of Xue <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup> is used in this work which preserves the dependence of collection probability to absorber thickness and diffusion length. The essence of the model is as follows: In general, in a p-n junction solar cell, <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{P}}}_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq8.gif"/></alternatives></inline-formula> is unity in the depletion region and decreases exponentially as the distance from depletion region increases<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. Assuming surface recombination is negligible compared to bulk recombination, <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{P}}}_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq9.gif"/></alternatives></inline-formula> can be approximated as:<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:msub><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{P}}}_{c}(x)=\exp (-\frac{|x-{t}_{aSi}/2|}{{L}_{D}}),$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ6.gif"/></alternatives></disp-formula>where <italic>L</italic><sub><italic>D</italic></sub> is the diffusion length of the carriers. After substituting (2–6) in Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>), <italic>EQE</italic> becomes,<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{e}=\frac{{N}_{p}}{{N}_{i}}\frac{1}{{\tilde{t}}_{aSi}}(1-{e}^{-{\tilde{t}}_{aSi}}),$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ7.gif"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{t}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq1.gif"/></alternatives></inline-formula><sub><italic>aSi</italic></sub> = 0.5<italic>t</italic><sub><italic>aSi</italic></sub>/<italic>L</italic><sub><italic>D</italic></sub> . <italic>L</italic><sub><italic>D</italic></sub> is ~100 nm for amorphous silicon<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Note that according to (1), EQE has two components: an optical component (<italic>η</italic><sub><italic>A</italic></sub>) which has a complicated tie to all geometry parameters and material choices, and can only be determined via solving the Maxwell’s equations. The second component (<italic>η</italic><sub><italic>I</italic></sub>) is IQE and is only a function of silicon height and junction diffuse length in this simplified model. Generally, the expectation is that thicker silicon results in higher absorption, but also higher recombination, thus lower electric factor. The trade-off between these two components is the key to optimal design. This trade-off is shown for a random fixation of all geometry parameters but varying silicon thickness in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p>The variation of <italic>η</italic><sub><italic>A</italic></sub> and <italic>η</italic><sub><italic>I</italic></sub> with respect to <italic>t</italic><sub><italic>aSi</italic></sub>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig2_HTML.jpg"/></fig></p><p id="Par13">The proposed EQE model is validated with experimental results in the literature<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. The authors measured EQE of a Ag/ZnO:Al/a-Si/ITO solar cell and calculated absorbed power in the a-Si layer using FDTD method. The same absorption profile is used to calculate EQE using Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) for <italic>t</italic><sub><italic>aSi</italic></sub> = 100 <italic>nm</italic> and <italic>L</italic><sub><italic>D</italic></sub> = 100 <italic>nm</italic>. The comparison of experiments and present calculations based on absorptivity is given in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Note that the model matches closely with the experiments for most of the relevant spectrum.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p>Comparison of measured and calculated <italic>EQE</italic> and simulated absorptivity profile for Ag/ZnO:Al/a-Si/ITO solar cell.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig3_HTML.jpg"/></fig></p></sec><sec id="Sec3"><title>Optimization</title><p id="Par14">The aim of the present study is to maximize EQE given in Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) by modifying the solar cell geometry vector, <bold>x</bold>:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{{\rm{\max }}}_{{\bf{x}}}{\eta }_{e}({\bf{x}}),\\ {{\bf{x}}}_{{\bf{L}}} &lt; {\bf{x}} &lt; {{\bf{x}}}_{{\bf{U}}},\end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ8.gif"/></alternatives></disp-formula>where <bold>x</bold><sub><bold><italic>L</italic></bold></sub> and <bold>x</bold><sub><bold><italic>U</italic></bold></sub> are lower and upper bounds imposed on <bold>x</bold>, respectively. The present optimization problem requires computation of <italic>N</italic><sub><italic>p</italic></sub> at every iteration (Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>)), where the integrand is evaluated at a full spectrum of irradiance wavelengths, and then numerically integrated. When the step size for the wavelength is 10 nm, <italic>α</italic>(<italic>λ</italic>) must be calculated 46 times (within the 300–750 nm wavelength range) using FDTD to complete one iteration of the optimization. A surrogate for <italic>α</italic>(<italic>λ</italic>) could accelerate the optimization procedure provided that it predicts the output accurately.</p><sec id="Sec4"><title>Surrogate-Based Optimization</title><p id="Par15">Surrogate-based optimization (SBO) provides a faster way to maximize a black-box utility function that requires expensive computations. Examples of time-consuming objective functions based on underlying first principle calculations include fluid dynamics equations, heat transfer equations and Maxwell’s electromagnetic equations as in the present study. In SBO, a regression model is fit to the objective function as an approximate model, using past data. The key to the merit of SBO is the accuracy and reliability of the regression (surrogate) model. Once the surrogate model is trained with the data pool obtained by performing a limited number of computationally expensive simulations, and after the accuracy and reliability of the model is verified, the optimization task could be accomplished efficiently.</p><p id="Par16">For the present problem of maximizing EQE, referring to Eqs (<xref rid="Equ1" ref-type="disp-formula">1</xref>–<xref rid="Equ7" ref-type="disp-formula">7</xref>) we can express EQE for an arbitrary geometry <bold>x</bold> as:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mspace width=".25em"/><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mspace width=".25em"/><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{e}({\bf{x}})=\frac{a(1-{e}^{-b{x}_{3}})}{{x}_{3}}\int \lambda \,f({\bf{x}},\lambda )\,I(\lambda )d\lambda ,$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width=".25em"/><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=\frac{2{L}_{D}}{hc{N}_{i}},\,b=\frac{0.5}{{L}_{D}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq2.gif"/></alternatives></inline-formula> are constants, <italic>x</italic><sub>3</sub> is the third coordinate of <bold>x</bold>, namely <italic>t</italic><sub><italic>aSi</italic></sub>, and <italic>f</italic>(<bold>x</bold>, <italic>λ</italic>) is the spectral absorptivity for the geometry <bold>x</bold> at wavelength <italic>λ</italic>. The most computationally efficient way to approximate <italic>η</italic><sub><italic>e</italic></sub> is therefore to approximate spectral absorptivity with a surrogate function:<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{f}({\bf{z}})\approx f({\bf{z}}).$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ10.gif"/></alternatives></disp-formula></p><p id="Par17">Therefore the surrogate-based optimization becomes:<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>ˆ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{\max }_{{\bf{x}}}{\hat{\eta }}_{e}({\bf{x}}),\\ {{\bf{x}}}_{{\bf{L}}} &lt; {\bf{x}} &lt; {{\bf{x}}}_{{\bf{U}}},\end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ11.gif"/></alternatives></disp-formula>where<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>ˆ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mspace width=".25em"/><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mspace width=".25em"/><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\eta }}_{e}({\bf{x}})=\frac{a(1-{e}^{-b{x}_{3}})}{{x}_{3}}\int \lambda \,\hat{f}({\bf{x}},\lambda )\,I(\lambda )d\lambda ,$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par18">The state-of-the-art surrogate modeling techniques are rooted in the machine learning literature and include Polynomial Regression (PR), Support Vector Machines (SVM), Gaussian Process (GP) (also known as Kriging) and Neural Networks (NN). Depending on the nature of the problem, at least one of these techniques could successfully be used to map the input space to the output space. NN is a well-established regression tool and is noteworthy for its ability to approximate almost every function regardless of the degree of nonlinearity<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. When engaged with regularization techniques, it is possible to obtain reliable models without overfitting. Basics of modeling using NNs are provided below and more in Supplementary Information.</p><sec id="Sec5"><title>Neural Networks</title><p id="Par19">Neural Networks (NN) are machine learning tools that can approximate input-output relationships of complex functions by mimicking the neuro-chemical brain learning process. A NN consists of a series of multiple layers of functional relationships evaluated at parallel perceptron units (neurons). More details on the mathematical formulation of NN, training and regularization for the specific utility function of this work are presented in Supplementary Information.</p></sec><sec id="Sec6"><title>Design of Experiments and Validation</title><p id="Par20">Regardless of what regression method is used, there are two important factors which determines the success of surrogate modeling: design of experiments and validation<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Design of experiment means sampling to determine where on input space the actual simulations will be performed. There are several available sampling options, such as Latin hypercube sampling (LHS), orthogonal arrays (OA)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and uniform sampling (US). In this study, the input space is sampled uniformly. Validation is the other important step of SBO, which provides an instantaneous estimate of the out-sample performance of the model during training. Some portion of the available data (validation set) is not introduced to the training, but rather used only for evaluating the model out-sample performance. The validation set can be obtained from the data pool in several ways. In the split-sample (SS) method, training and validation sets are divided only once, and training stops if validation error starts increasing. On the other hand, cross validation (CV) or leave-one out (LOO) method splits the data <italic>n</italic> times (<italic>n</italic>:number of folds) and every one of <italic>n</italic> folds are used as validation set while the rest is used for model fitting. Although CV requires <italic>n</italic> times training, it usually renders an unbiased model. CV is used in the current work for model learning.</p></sec></sec><sec id="Sec7"><title>Algorithms</title><p id="Par21">Optimization of the objective function could be done by means of deterministic and heuristic methods. Deterministic methods, such as Steepest Descent (SD), Conjugate Gradient (CG) and Quasi-Newton (QN), rely on the gradient and Hessian of the objective function. Although these methods have guaranteed convergence for convex functions, they have the tendency of local entrapment for highly nonconvex functions and thus often only yield a local optimum. Therefore, they are usually used in conjunction with another global heuristic method. The appealing factor about QN is that when NNs are used as surrogate functions, an explicit expression for the gradient of the surrogate utility function is available, thus the QN can be implemented very efficiently.</p><p id="Par22">Heuristic methods utilize random search which are unlikely to trap at local optima. These methods include Tabu Search (TS), evolutionary algorithms, population based algorithms and Simulated Annealing (SA). In this study, we use a combination of Simulated Annealing and Quasi-Newton (QN) algorithms for NN surrogate function. First a SA global optimizer is used to achieve a near optimal solution. Then QN is used to locally improve the search. Details of these algorithms are explained in Supplementary Information.</p></sec></sec><sec id="Sec8" sec-type="results"><title>Results and Discussion</title><sec id="Sec9"><title>Data Generation</title><p id="Par23">The aim of the surrogate model is to establish a functional relationship between the absorbed power in the active layer, solar cell geometry and wavelength of the incoming light. As discussed in the previous section, a pool of data is required for training the surrogate. Data pool is generated by sampling from the input space, then running FDTD simulations on the data and obtaining output values (see Section 6 on Methods). Lower and upper bounds are imposed to the input vector in order to restrict our focus to a reasonable limited range. These bounds are shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Lower (LB) and upper (UB) bounds for the multilayer solar cell.</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Parameters</p></th><th><p><italic>t</italic><sub><italic>ITO</italic></sub></p></th><th><p><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Si</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">O</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{t}}}_{{\boldsymbol{Si}}{{\boldsymbol{O}}}_{{\bf{2}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq3.gif"/></alternatives></inline-formula></p></th><th><p><italic>t</italic><sub><italic>aSi</italic></sub></p></th><th><p><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">O</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{{\boldsymbol{A}}{{\boldsymbol{l}}}_{{\bf{2}}}{{\boldsymbol{O}}}_{{\bf{3}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq4.gif"/></alternatives></inline-formula></p></th><th><p><italic>t</italic><sub><italic>Al</italic></sub></p></th><th><p><italic>λ</italic></p></th></tr></thead><tbody><tr><td><p>LB (nm)</p></td><td><p>20</p></td><td><p>5</p></td><td><p>20</p></td><td><p>5</p></td><td><p>20</p></td><td><p>300</p></td></tr><tr><td><p>UB (nm)</p></td><td><p>80</p></td><td><p>20</p></td><td><p>200</p></td><td><p>20</p></td><td><p>120</p></td><td><p>750</p></td></tr></tbody></table></table-wrap></p><p id="Par24">A total of 1000 points are uniformly sampled from the input space, and the corresponding output values (absorptivity) are obtained from FDTD simulations. These 1000 simulations are equivalent to ~22 direct simulations for absorptivity of distinct geometries when simulated over the wavelength range with 10 nm increments.</p></sec><sec id="Sec10"><title>Model Fitting</title><p id="Par25">NN architecture is 6-<italic>R</italic><sub>1</sub>-1 where <italic>R</italic><sub>1</sub> is the number of neurons in the hidden layer and is determined based on minimum validation error principle: Cross validation is used during training, and mean training and validation errors are calculated as the average of <italic>n</italic> = 4 folds. Optimal <italic>R</italic><sub>1</sub> is where the validation error does not improve despite increasing <italic>R</italic><sub>1</sub>. The results for the NN training are presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The optimal <italic>R</italic><sub>1</sub> is determined as 7 in this case (see Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). The final coefficient matrices are then obtained by training the NN with this configuration over the entire available data. The variation of Sum Square Error (SSE) during the final training is presented in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>. The trained model is then used as the surrogate for FDTD simulations in optimization, the results of which will be demonstrated in the next section.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p>Neural network training. (<bold>a</bold>) Normalized mean sum of squared error (SSE) with respect to number of neurons in hidden layer (<italic>R</italic><sub>1</sub>), (<bold>b</bold>) Evolution of SSE cost function during final NN training.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig4_HTML.jpg"/></fig></p></sec><sec id="Sec11"><title>Optimization</title><p id="Par26">The trained NN surrogate model is used instead of original FDTD simulations for designing the optimal structure. The search is done using two randomly selected starting points of x<sub><italic>i</italic>,1</sub> = [50, 12, 110, 12, 70]<sup><italic>T</italic></sup> and x<sub>i,2</sub> = [20, 10, 70, 10, 60]<sup><italic>T</italic></sup>. Every search includes a SA optimization followed by a local QN optimization starting at the optimal point of SA. Final optimization results are presented in Table <xref rid="Tab2" ref-type="table">2</xref>, and are compared with the optimization of the previous study<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. The reference<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> used a regression-tree based optimizer as well as SA on direct FDTD simulations to find the optimal solution. However, since the objective function in this study<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> is slightly different than the present objective function, a deviation between the results of these two studies is expected. The present study achieved a slightly higher EQE than that in the reference<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Results of optimization.</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Solution</p></th><th><p><italic>t</italic><sub><italic>ITO</italic></sub></p></th><th><p><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Si</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">O</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{t}}}_{{\boldsymbol{Si}}{{\boldsymbol{O}}}_{{\bf{2}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq5.gif"/></alternatives></inline-formula></p></th><th><p><italic>t</italic><sub><italic>aSi</italic></sub></p></th><th><p><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">O</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{t}}}_{{\boldsymbol{A}}{{\boldsymbol{l}}}_{{\bf{2}}}{{\boldsymbol{O}}}_{{\bf{3}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2018_26469_Article_IEq6.gif"/></alternatives></inline-formula></p></th><th><p><italic>t</italic><sub><bold><italic>Al</italic></bold></sub></p></th><th><p><italic>η</italic><sub><italic>e</italic></sub> (NN)</p></th><th><p><italic>η</italic><sub><italic>e</italic></sub> (FDTD)</p></th></tr></thead><tbody><tr><td><p>1. NN-SA-QN</p></td><td><p>29</p></td><td><p>19</p></td><td><p>65</p></td><td><p>20</p></td><td><p>101</p></td><td><p>0.356</p></td><td><p>0.370</p></td></tr><tr><td><p>2. NN-SA-QN</p></td><td><p>29</p></td><td><p>20</p></td><td><p>65</p></td><td><p>20</p></td><td><p>98</p></td><td><p>0.356</p></td><td><p>0.369</p></td></tr><tr><td><p>Reference<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></p></td><td><p>30</p></td><td><p>16</p></td><td><p>62</p></td><td><p>20</p></td><td><p>50</p></td><td><p>0.350</p></td><td><p>0.361</p></td></tr></tbody></table></table-wrap></p><p id="Par27">The required time to complete optimization for the corresponding algorithms are also recorded. Each SA algorithm is iterated 400 times, and the consequent QN takes several extra iterations. NN-based SA-QN takes 30 seconds to find an optimal solution, which is negligible compared to the amount of time spent at finding the true EQE value for a given geometry using FDTD (~600 seconds). The overall number of computations is equivalent to only 20 full-spectrum FDTD calculations, which is impressively smaller than approximately 100 iterations in regression-tree-based search, and 200–400 iterations in SA on direct FDTD calculations used in the reference study<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Therefore, the overall computation time is reduced by a factor of 5–20 using the proposed surrogate-based optimization. The evolution of EQE during the iterations for the results presented in Table <xref rid="Tab2" ref-type="table">2</xref> is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p>Evolution of surrogate EQE during optimizations with initial guesses (<bold>a</bold>) <bold>x</bold><sub>1</sub>, (<bold>b</bold>) <bold>x</bold><sub>2</sub>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig5_HTML.jpg"/></fig></p><p id="Par28">The absorptivity and EQE spectrum of the initial solution <bold>x</bold><sub>1</sub> and the one obtained by optimization starting from <bold>x</bold><sub>1</sub> are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Note that the majority of improvement is due to a wider absorption spectrum in the case of the optimal solution, especially at wavelengths shorter than 450 nm. The optimal solution has more than 25% improvement in efficiency, is more broadband and has larger optical absorption despite a thinner silicon layer. The optimal solution has also 50% more EQE compared to optimal thickness bare silicon (~50 nm<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>).<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p>Absorptivity and EQE of initial (<bold>x</bold><sub>1</sub>) and optimized geometries in Table <xref rid="Tab2" ref-type="table">2</xref>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig6_HTML.jpg"/></fig></p><p id="Par29">The (surrogate) spectral absorptivity of optimized geometry is also compared with the results from FDTD for the same geometry in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Note that the profiles are in a good agreement in most of the spectrum except <italic>λ</italic> = 500−600 nm which is the reason of the discrepancy between <italic>EQE</italic> values obtained by NN and FDTD.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p>Absorptivity of optimized geometry obtained by NN and FDTD.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2018_26469_Fig7_HTML.jpg"/></fig></p></sec></sec><sec id="Sec12" sec-type="conclusion"><title>Conclusion</title><p id="Par30">We demonstrated that the wavelength-specific optical absorptivity of a thin film multi-layered amorphous-silicon-based solar cell can be modelled accurately with NNs, and can be efficiently approximated as a function of cell geometry and wavelength. Using this framework and modeling the external quantum efficiency of the cell as a function of absorptivity and electrical recombination factor, we optimized a multi-layer thin film solar cell structure consisting of ITO front coating and metallic back-reflectors and oxide layers for maximum efficiency. Our required computation time for an entire model fitting and optimization was 5 to 20 times faster than the optimization times of the best previous results, therefore proving the value of surrogate modeling. The final design suggests that a 50% improvement in the external quantum efficiency of silicon is achievable by using simple multi-layer front-back ITO/metallic and oxide coatings.</p></sec><sec id="Sec13" sec-type="materials|methods"><title>Methods</title><p id="Par31">Optical absorptivity of the multilayer solar cell was measured using the commercial Lumerical Inc. Software<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> which provides FDTD numerical simulations. All simulations were performed in a 2D environment, where boundary conditions of periodic in horizontal direction and perfectly matched layer (PML) in vertical direction were considered. Spectrums of material properties of ITO, SiO<sub>2</sub>, a-Si, Al<sub>2</sub>O<sub>3</sub> and Al where taken from the literature<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. A total of 1000 points were uniformly sampled from the input space for training the model, and the corresponding output values (absorptivity) were obtained from FDTD simulations. Running time for these 1000 simulations are equivalent to ~22 direct simulations for absorptivity of distinct geometries when simulated over the wavelength range with 10 nm increments. Neural network modeling was done using an in-house model generation, training and validation code written and implemented in MATLAB.</p><sec id="Sec14"><title>Data Availability</title><p id="Par32">The datasets generated during the current study are available from the corresponding author on reasonable request.</p></sec></sec></body><back><sec sec-type="author-contribution"><title>Author Contributions</title><p>Mine Kaya provided the results, prepared the figures and wrote the manuscript. Dr. Shima Hajimirza (Corresponding Author) reviewed and revised the results and figures and wrote and reviewed the manuscript.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing Interests</title><p id="Par33">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rios</surname><given-names>LM</given-names></name><name><surname>Sahinidis</surname><given-names>NV</given-names></name></person-group><article-title xml:lang="en">Derivative-free optimization: A review of algorithms and comparison of software implementations</article-title><source>J. Glob. Optim.</source><year>2013</year><volume>56</volume><fpage>1247</fpage><lpage>1293</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3070154</pub-id><pub-id pub-id-type="doi">10.1007/s10898-012-9951-y</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1272.90116</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolda</surname><given-names>TG</given-names></name><name><surname>Lewis</surname><given-names>RM</given-names></name><name><surname>Torczon</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Optimization by Direct Search: New Perspectives on Some Classical and Modern Methods</article-title><source>SIAM Rev.</source><year>2003</year><volume>45</volume><fpage>385</fpage><lpage>482</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2046504</pub-id><pub-id pub-id-type="doi">10.1137/S003614450242889</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1059.90146</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004SIAMR..45..385K</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koziel</surname><given-names>S</given-names></name><name><surname>Bekasiewicz</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Multi-objective optimization of expensive electromagnetic simulation models</article-title><source>Appl. Soft Comput.</source><year>2016</year><volume>47</volume><fpage>332</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1016/j.asoc.2016.05.033</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1395.78147</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name><name><surname>El Hitti</surname><given-names>G</given-names></name><name><surname>Heltzel</surname><given-names>A</given-names></name><name><surname>Howell</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Using inverse analysis to find optimum nano-scale radiative surface patterns to enhance solar cell performance</article-title><source>Int. J. Therm. Sci.</source><year>2012</year><volume>62</volume><fpage>93</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1016/j.ijthermalsci.2011.12.011</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhsFGit7nP</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Expedited Quasi-Updated Gradient Based Optimization Techniques for Energy Conversion Nano-Materials</article-title><source>J. Nanoelectron. Optoelectron.</source><year>2015</year><volume>10</volume><fpage>140</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1166/jno.2015.1717</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXht1SlsLnP</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name><name><surname>Howell</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Flexible Nanotexture Structures for Thin Film PV Cells Using Wavelet Functions</article-title><source>IEEE Trans. Nanotechnol.</source><year>2015</year><volume>14</volume><fpage>904</fpage><lpage>910</lpage><pub-id pub-id-type="doi">10.1109/TNANO.2015.2462078</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2015ITNan..14..904H</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhvFWktL4%3D</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Hajimirza, S. A novel machine-learning aided optimization technique for material design: application in thin film solar cells. In <italic>Proceedings of the ASME 2016 HT/FEDSM/ICNMM Summer Heat Transfer Conference</italic> (2016).</mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name><name><surname>Howell</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Design and analysis of spectrally selective patterned thin-film cells</article-title><source>Int. J. Thermophys.</source><year>2013</year><volume>34</volume><fpage>1930</fpage><lpage>1952</lpage><pub-id pub-id-type="doi">10.1007/s10765-013-1495-y</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013IJT....34.1930H</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhtlenurrP</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name><name><surname>Howell</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Statistical Analysis of Surface Nanopatterned Thin Film Solar Cells Obtained by Inverse Optimization</article-title><source>J. Heat Transfer</source><year>2013</year><volume>135</volume><fpage>91501</fpage><pub-id pub-id-type="doi">10.1115/1.4024464</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jäger</surname><given-names>K</given-names></name><name><surname>Fischer</surname><given-names>M</given-names></name><name><surname>van Swaaij</surname><given-names>RACMM</given-names></name><name><surname>Zeman</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Designing optimized nano textures for thin-film silicon solar cells</article-title><source>Opt. Express</source><year>2013</year><volume>21</volume><fpage>A656</fpage><pub-id pub-id-type="doi">10.1364/OE.21.00A656</pub-id><pub-id pub-id-type="pmid">24104492</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhtFGqs77L</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Aiello, G., Alfonzetti, S., Rizzo, S. A. &amp; Salerno, N. Multi-objective optimization of thin-film silicon solar cells with metallic and dielectric nanoparticles. <italic>Energies</italic><bold>10</bold> (2017).</mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goel</surname><given-names>T</given-names></name><name><surname>Haftka</surname><given-names>RT</given-names></name><name><surname>Shyy</surname><given-names>W</given-names></name><name><surname>Queipo</surname><given-names>NV</given-names></name></person-group><article-title xml:lang="en">Ensemble of surrogates</article-title><source>Struct. Multidiscip. Optim.</source><year>2007</year><volume>33</volume><fpage>199</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1007/s00158-006-0051-9</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaya</surname><given-names>M</given-names></name><name><surname>Hajimirza</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Surrogate based modeling and optimization of plasmonic thin film organic solar cells</article-title><source>Int. J. Heat Mass Transf.</source><year>2018</year><volume>118</volume><fpage>1128</fpage><lpage>1142</lpage><pub-id pub-id-type="doi">10.1016/j.ijheatmasstransfer.2017.11.044</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhvFSkurjJ</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaya</surname><given-names>M</given-names></name><name><surname>Hajimirza</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Extremely Efficient Design of Organic Thin Film Solar Cells via Learning-Based Optimization</article-title><source>Energies</source><year>2017</year><volume>10</volume><fpage>1981</fpage><lpage>1992</lpage><pub-id pub-id-type="doi">10.3390/en10121981</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhsFamsbvO</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaya</surname><given-names>M</given-names></name><name><surname>Hajimirza</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Application of artificial neural network for accelerated optimization of ultra thin organic solar cells</article-title><source>Sol. Energy</source><year>2018</year><volume>165</volume><fpage>159</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2018.02.062</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018SoEn..165..159K</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXkslCmtrs%3D</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajimirza</surname><given-names>S</given-names></name><name><surname>Howell</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">Computational and experimental study of a multi-layer absorptivity enhanced thin film silicon solar cell</article-title><source>J. Quant. Spectrosc. Radiat. Transf.</source><year>2014</year><volume>143</volume><fpage>56</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.jqsrt.2013.09.025</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014JQSRT.143...56H</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhs12ksLfF</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodes</surname><given-names>G</given-names></name><name><surname>Howell</surname><given-names>IDJ</given-names></name><name><surname>Peter</surname><given-names>LM</given-names></name></person-group><article-title xml:lang="en">Nanocrystalline Photoelectrochemical Cells: A New Concept In Photovoltaic Cells</article-title><source>J. Electrochem. Soc.</source><year>1992</year><volume>139</volume><fpage>3136</fpage><lpage>3140</lpage><pub-id pub-id-type="doi">10.1149/1.2069045</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1992JElS..139.3136H</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3sXkslygtw%3D%3D</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">American Society for Testing and Materials, 2003, ‘ASTM Standard Tables for Reference Solar Spectral Irradiances’. Available at: http:www.astm.org. (Accessed: 20th September 2017).</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Berginski, M. <italic>et al</italic>. Theeffect of front ZnO:Al surface texture and optical transparency on efficient light trapping in silicon thin-film solar cells. <italic>J. Appl. Phys</italic>. 1<bold>01</bold> (2007).</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thouti</surname><given-names>E</given-names></name><name><surname>Sharma</surname><given-names>AK</given-names></name><name><surname>Sardana</surname><given-names>SK</given-names></name><name><surname>Komarala</surname><given-names>VK</given-names></name></person-group><article-title xml:lang="en">Internal quantum efficiency analysis of plasmonic textured silicon solar cells: surface plasmon resonance and off-resonance effects</article-title><source>J. Phys. D. Appl. Phys.</source><year>2014</year><volume>47</volume><fpage>425101</fpage><pub-id pub-id-type="doi">10.1088/0022-3727/47/42/425101</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014JPhD...47P5101T</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXhvVWgsb7J</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferrero</surname><given-names>A</given-names></name><name><surname>Campos</surname><given-names>J</given-names></name><name><surname>Pons</surname><given-names>A</given-names></name><name><surname>Corrons</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">New model for the internal quantum efficiency of photodiodes based on photocurrent analysis</article-title><source>Appl. Opt.</source><year>2005</year><volume>44</volume><fpage>208</fpage><pub-id pub-id-type="doi">10.1364/AO.44.000208</pub-id><pub-id pub-id-type="pmid">15678772</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2005ApOpt..44..208F</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dibb</surname><given-names>GFA</given-names></name><etal/></person-group><article-title xml:lang="en">Influence of doping on charge carrier collection in normal and inverted geometry polymer:fullerene solar cells</article-title><source>Sci. Rep.</source><year>2013</year><volume>3</volume><pub-id pub-id-type="doi">10.1038/srep03335</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xue</surname><given-names>J</given-names></name><name><surname>Rand</surname><given-names>BP</given-names></name><name><surname>Uchida</surname><given-names>S</given-names></name><name><surname>Forrest</surname><given-names>SR</given-names></name></person-group><article-title xml:lang="en">A hybrid planar-mixed molecular heterojunction photovoltaic cell</article-title><source>Adv. Mater.</source><year>2005</year><volume>17</volume><fpage>66</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1002/adma.200400617</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXhtVGht7c%3D</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xue</surname><given-names>J</given-names></name><name><surname>Uchida</surname><given-names>S</given-names></name><name><surname>Rand</surname><given-names>BP</given-names></name><name><surname>Forrest</surname><given-names>SR</given-names></name></person-group><article-title xml:lang="en">Asymmetric tandem organic photovoltaic cells with hybrid planar-mixed molecular heterojunctions</article-title><source>Appl. Phys. Lett.</source><year>2004</year><volume>85</volume><fpage>5757</fpage><lpage>5759</lpage><pub-id pub-id-type="doi">10.1063/1.1829776</pub-id><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2004ApPhL..85.5757X</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXhtVKqsbzE</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>AV</given-names></name><etal/></person-group><article-title xml:lang="en">Thin-film Silicon Solar Cell Technology</article-title><source>Photovolt Res. Appl</source><year>2004</year><volume>12</volume><fpage>113</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1002/pip.533</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXjslygtr4%3D</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferry</surname><given-names>VE</given-names></name><name><surname>Polman</surname><given-names>A</given-names></name><name><surname>Atwater</surname><given-names>HA</given-names></name></person-group><article-title xml:lang="en">Modeling Light Trapping in Nanostructured Solar Cells</article-title><source>ACS Nano</source><year>2011</year><volume>5</volume><fpage>10055</fpage><lpage>10064</lpage><pub-id pub-id-type="doi">10.1021/nn203906t</pub-id><pub-id pub-id-type="pmid">22082201</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhsVKiu7rJ</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Foresee, F. D. &amp; Hagan, M. T. Gauss-Newton approximation to Bayesian regularization. In <italic>Proceedings of the 1997 International Joint Conference on Neural Networks</italic> 1930–1935, <ext-link xlink:href="10.1109/ICNN.1997.614194" ext-link-type="doi">https://doi.org/10.1109/ICNN.1997.614194</ext-link> (1997).</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Hagan, M. T., Demuth, H. B., Beale, M. H. &amp; De Jesus, O. <italic>Neural Network Desig</italic>n, <ext-link xlink:href="10.1007/1-84628-303-5" ext-link-type="doi">https://doi.org/10.1007/1-84628-303-5</ext-link> (PWS Publishing Company, 2014).</mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Queipo</surname><given-names>NV</given-names></name><etal/></person-group><article-title xml:lang="en">Surrogate-based analysis and optimization</article-title><source>Prog. Aerosp. Sci.</source><year>2005</year><volume>41</volume><fpage>1</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1016/j.paerosci.2005.02.001</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Lumerical Inc. Available at: <ext-link xlink:href="http://www.lumerical.com" ext-link-type="uri">www.lumerical.com</ext-link>. (Accessed: 15th June 2017).</mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="other">Palik, E. D. <italic>Handbook of optical constants of solids</italic>. <bold>3</bold>, (Academic Press, 1998).</mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec15"><title>Electronic supplementary material</title><p id="Par34"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material"><media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/41598_2018_26469_MOESM1_ESM.docx" position="anchor"><caption xml:lang="en"><p>Supplementary information</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Electronic supplementary material</title><p><bold>Supplementary information</bold> accompanies this paper at <ext-link xlink:href="10.1038/s41598-018-26469-3" ext-link-type="doi">https://doi.org/10.1038/s41598-018-26469-3</ext-link>.</p></notes><notes notes-type="Misc"><p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Scientific Reports</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
