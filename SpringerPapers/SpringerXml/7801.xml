<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s40565-017-0310-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40565</journal-id><journal-title-group><journal-title>Journal of Modern Power Systems and Clean Energy</journal-title><abbrev-journal-title abbrev-type="publisher">J. Mod. Power Syst. Clean Energy</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2196-5625</issn><issn pub-type="epub">2196-5420</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40565-017-0310-3</article-id><article-id pub-id-type="manuscript">310</article-id><article-id pub-id-type="doi">10.1007/s40565-017-0310-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Optimal allocation of hybrid energy storage for microgrids based on multi-attribute utility theory</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>FENG</surname><given-names>Xiaoshan</given-names></name><address><email>friendjoy@126.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar1"><title>Xiaoshan FENG</title><p id="Par1">received the B.S from the School of Electronic, Information and Electrical Engineering of Shanghai Jiao Tong University, Shanghai, China, in 2014. Currently she is pursuing Master degree at Shanghai Jiao Tong University. Her research interest is the allocation optimization of energy storage system in power system.</p></sec></bio></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><name><surname>GU</surname><given-names>Jie</given-names></name><address><email>gujie@sjtu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4056501703103_cor2">b</xref><bio><sec id="FPar2"><title>Jie GU</title><p id="Par2">received the B.S. and M.S. degrees from the Electric Power Department of Shanghai Jiao Tong University, Shanghai, China, in 1992 and 1995, respectively, and the Ph.D degree from Shanghai Jiao Tong University, Shanghai, China, in 2000. Currently, she is an associate professor in the Key Laboratory of Control of Power Transmission and Conversion, Ministry of Education, Department of Electrical Engineering, Shanghai Jiao Tong University, Shanghai, China. Her main interests and research fields are power system planning and application of big data in power system as well as the integration of the renewable energy.</p></sec></bio></contrib><contrib contrib-type="author" id="Au3"><name><surname>GUAN</surname><given-names>Xuefei</given-names></name><address><email>guanxf@sepd.com.cn</email></address><xref ref-type="aff" rid="Aff2">2</xref><bio><sec id="FPar3"><title>Xuefei GUAN</title><p id="Par3">received the B.S. and M.S. degrees from the Department of Electrical Engineering, Tsinghua University, Beijing, China, in 2006 and 2011, respectively. Currently, he is a researcher in the Research Center of New Technology, Shanghai Electric Power Design Institute Co., Ltd, Shanghai, China. His research interests include the application of energy storage technology in power system.</p></sec></bio></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution content-type="org-division">School of Electronic, Information and Electrical Engineering</institution><institution content-type="org-name">Shanghai Jiao Tong University</institution></institution-wrap><addr-line content-type="postcode">200240</addr-line><addr-line content-type="city">Shanghai</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution content-type="org-division">Research Center of New Technology</institution><institution content-type="org-name">Shanghai Electric Power Design Institute</institution></institution-wrap><addr-line content-type="postcode">200025</addr-line><addr-line content-type="city">Shanghai</addr-line><country country="CN">China</country></aff></contrib-group><author-notes><corresp id="IDs4056501703103_cor2"><label>b</label><email>gujie@sjtu.edu.cn</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>28</day><month>7</month><year>2017</year></pub-date><pub-date date-type="pub" publication-format="print"><month>1</month><year>2018</year></pub-date><volume>6</volume><issue seq="10">1</issue><fpage>107</fpage><lpage>117</lpage><history><date date-type="registration"><day>7</day><month>7</month><year>2017</year></date><date date-type="received"><day>16</day><month>6</month><year>2016</year></date><date date-type="accepted"><day>22</day><month>3</month><year>2017</year></date><date date-type="online"><day>28</day><month>7</month><year>2017</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2017</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par4">To satisfy the requirements of high energy density, high power density, quick response and long lifespan for energy storage systems (ESSs), hybrid energy storage systems (HESSs) have been investigated for their complementary characteristics of ‘high energy density components’ and ‘high power density components’. To optimize HESS combinations, related indices such as annual cost, fluctuation smoothing ability as well as safety and environmental impact have to be evaluated. The multi-attribute utility method investigated in this paper is aimed to draw an overall conclusion for HESS allocation optimization in microgrid. Building on multi-attribute utility theory, this method has significant advantages in solving the incommensurability and contradiction among multiple attributes. Instead of determining the weights of various attributes subjectively, when adopting the multi-attribute utility method, the characteristics of attributes and the relation among them can be investigated objectively. Also, the proper utility function and merging rules are identified to achieve the aggregate utility which can reflect comprehensive qualities of HESSs.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Hybrid energy storage system (HESS)</kwd><kwd>Capacity optimization</kwd><kwd>Multi-attribute utility theory</kwd><kwd>HESS combination evaluation</kwd><kwd>Utility function</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Ministry of Science and Technology of the People's Republic of China</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100002855</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">2013BAA01B04</award-id><principal-award-recipient><name><surname>GU</surname><given-names>Jie</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2017</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>7</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>7</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40565_2017_Article_310.pdf</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>22</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>SC17</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="Misc"><p>CrossCheck date: 22 March 2017</p></notes></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par5">Currently, the energy storage system (ESS) applications can be divided into 2 categories, which require high energy capacity ESSs and high power capacity ESSs [<xref ref-type="bibr" rid="CR1">1</xref>]. The energy ESS is used for large-volume energy storage for a long term. The power ESS is used during the peak power period and is normally for short-term use. With an energy ESS or a power ESS alone, the system could possibly fail at satisfying power or energy demand, and a common solution is to increase the size of the ESS, but this will increase the cost and bring challenges in thermal management and lifetime management [<xref ref-type="bibr" rid="CR2">2</xref>].</p><p id="Par6">The main idea of a hybrid energy storage system (HESS) is to exploit the complementarity between the 2 ESS types. HESS ensures that the energy ESS serves as the basic energy storage, and uses minimal charge and discharge operations to extend its lifetime, whereas the power ESS works mainly in the peak power period and without large amounts of energy storage. With a proper balance of characteristics, the system performance and cost can be optimized. In this paper, 5 ESSs are under investigation. They are lead acid batteries, NAS batteries, compressed-air energy storage (CAES), fly-wheel storage, and super capacitors. Based on an analysis of energy density, power density, efficiency and lifespan analysis, these 5 ESSs are studied to understand the basis for deciding their role in an HESS [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p><p id="Par7">Among the existing studies on ESS optimization, [<xref ref-type="bibr" rid="CR5">5</xref>] has offered a new capacity optimization method. In particular, two different real-time control algorithms for power allocation and power response control between HESSs were tested to achieve coordination and lower the total capacity required. In [<xref ref-type="bibr" rid="CR6">6</xref>], empirical mode composition has been applied to decompose the wind power into high and low frequency components, and a neural network model has been utilized to determine the capacity of a supercapacitor-battery HESS for power smoothing. However, these studies have mainly focused on capacity optimization of 2 predetermined ESSs without discussing the HESS combination.</p><p id="Par8">Among the current research on ESS evaluation, [<xref ref-type="bibr" rid="CR7">7</xref>] discussed the optimal ESS capacities and the comparison of different types of DG sources to minimize the cost of a microgrid, whilst [<xref ref-type="bibr" rid="CR8">8</xref>] built a model of photovoltaic power systems by using 3 different ESSs, including battery, fuel cell, and a battery/fuel-cell combination, and the 3 power systems are evaluated using cost metrics and efficiency metrics. Ref. [<xref ref-type="bibr" rid="CR9">9</xref>] evaluated ESSs in hybrid mining loaders and determined suitable ESSs for different technical requirements based on the ESS characteristics and vehicle simulation results.</p><p id="Par9">However, the papers mentioned above are mainly about the comparison between single ESSs and HESSs, and the evaluation is based on subjective judgment instead of the quantitative calculation of optimization results. Also, the impact on safety and the environment is not included.</p><p id="Par10">In this paper, a multi-attribute utility method is introduced [<xref ref-type="bibr" rid="CR10">10</xref>]. By adopting this method, the HESS combination evaluation is carried out after potential alternatives are determined and their capacities are optimized, without choosing 2 ESSs for the HESS subjectively.</p><p id="Par11">The multi-attribute utility method has the ability to evaluate and quantize each attribute into a utility measure, and to merge all the elementary utilities into an overall utility based on the features and their relationships.</p><p id="Par12">To solve their incommensurability, the manifold attributes are categorized and arranged according to the relationships between them. The quantitative and non-quantitative attributes can all be quantified by their utility, which can be normalized into non-dimensional parameter within a common range by using a multi-attribute utility function. To resolve any contradictions, the normalized attributes can be merged by proper merging rules, like an additive form, a multiplicative form, and a distance form corresponding to different relationships between parameters.</p><p id="Par13">Moreover, the paper combines both ‘islanded’ and ‘parallel’ modes of microgrid operation in capacity optimization. In parallel mode, the goal of optimization is to minimize the operation and investment cost. And in the islanded mode, the reliability limit is according to operational constraints. In the capacity optimization, the volatility of wind and solar generation output is smoothed by the HESS. After determining the HESS capacity and combination, in the light of the Monte Carlo simulation and the reliability evaluation method proposed in [<xref ref-type="bibr" rid="CR11">11</xref>], the regulation and control ability of the HESS could be assessed when taking the uncertainties of the distributed energy system into consideration in both modes.</p></sec><sec id="Sec2"><title>Overview of multi-attribute utility method</title><sec id="Sec3"><title>Theory of multidimensional utility merging</title><p id="Par14">To carry out the multi-attribute utility method, 3 premises are proposed as follows:<list list-type="order"><list-item><p id="Par15">Systematic principle. The attributes should be able to represent the aggregate function instead of a simple addition of all the attributes. An explicit and reasonable hierarchical structure, cohesive and coordinated, is essential.</p></list-item><list-item><p id="Par16">Comparability principle. The attributes should be practical and subjective, and decomposition or transformation should be applied ahead to avoid any inclusive relationships.</p></list-item><list-item><p id="Par17">Scientific principle. Quantitative and qualitative analysis is intended to be merged. For qualitative analysis, the collected data should be compatible and comparable.</p></list-item></list></p></sec><sec id="Sec4"><title>Basic rules of multidimensional utility function</title><p id="Par18">The interdependence among the attributes should be fully reflected in the aggregate utility function. The basic rules that must be satisfied are as follows:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">∂</mml:mi><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">∂</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\partial W(x)}{{\partial u_{i} }} \ge 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:munder><mml:mo movablelimits="false">lim</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop {\lim }\limits_{{u_{1} ,u_{2} , \ldots ,u_{n} \to 0}} W(x) = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:munder><mml:mo movablelimits="false">lim</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop {\lim }\limits_{{u_{1} ,u_{2} , \ldots ,u_{n} \to 1}} W(x) = 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ3.gif"/></alternatives></disp-formula>where <italic>W</italic>(<italic>x</italic>) and <italic>u</italic><sub><italic>n</italic></sub>(<italic>x</italic>) are the aggregate utility function and elementary utility function respectively.</p><p id="Par19">Equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) indicates the aggregate function should increase when the elementary utility increases. Equations (<xref rid="Equ2" ref-type="disp-formula">2</xref>) and (<xref rid="Equ3" ref-type="disp-formula">3</xref>) reflect that the aggregate utility function should be very low when none of the attributes is satisfied, and it should be very high when all of them are satisfied.</p><p id="Par20">Currently, utility theory is widely applied in risk and safety assessment as well as optimal planning of power systems [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. In our research, with capacity optimization, multiple technical and operational parameters of HESS are collected. A detailed utility function is constructed for normalization of each attribute, and the merging rule is applied, according to the relationships among operational parameters, cost and other attributes, to get aggregated utility.</p></sec></sec><sec id="Sec5"><title>Evaluation model for HESS combinations</title><sec id="Sec6"><title>Process of model development</title><p id="Par21">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the operations involved in the multi-attribute utility method. The standard evaluation process is given on the left, and the steps involved are shown on the right.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>HESS evaluation and selection process</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig1_HTML.gif" id="MO4"/></fig></p><p id="Par22">There are 5 ESSs available in this research. Therefore, the potential combinations of HESS are regarded as the decision alternatives.</p><p id="Par23">A comprehensive and reliable indication system (IS) is the first step to evaluate each HESS, and then the utility function can be identified on the basis of the IS. The technical parameters are then collected after capacity optimization.</p><p id="Par24">During elementary utility function normalization and aggregated function determination, the characteristics and the relationships of the entire index are studied to compute the comprehensive utility. The detailed process is presented in the remainder of this section.</p></sec><sec id="Sec7"><title>Classification of ESS</title><p id="Par25">In this paper, the complementarity of the 2 ESS types is exploited to improve the performance and reduce the cost. The applications for the high energy capacity ESSs are long-term and large-volume energy storage that require high energy density, long sustained discharge time, and low self-discharge rate.</p><p id="Par26">The applications for the high power capacity ESSs are periodic high-power output and frequent charge and discharge that require high power density, short response time, and long lifespan.</p><p id="Par27">Currently, there is no standard specification to describe the applications of ESSs. Additionally, some ESSs cannot clearly and absolutely be assigned to either application type. So based on the requirement above, the 6 characteristics are divided into energy type and power type to reflect the qualities of high energy capacity ESS and high power capacity ESS respectively [<xref ref-type="bibr" rid="CR14">14</xref>].</p><p id="Par28">In this research, the compare-and-sort evaluation method is therefore proposed to decide the relatively appropriate application for ESSs. Each ESS is graded according to 6 characteristics by ranking from the best fitting to the worst, and then it is classified into 2 application groups by comparing the sum of the grades of each ESS.</p><p id="Par29">Among the 5 ESSs, the lead acid battery, NAS battery, and CAES are classified as high energy capacity type for their better performance concerning the energy-type characteristics, whereas the flywheel and super capacitor are more suitable for high-power applications.</p></sec><sec id="Sec8"><title>Capacity optimization of HESS</title><p id="Par30">To acquire the parameters necessary to evaluate a HESS, such as load shifting index, equivalent annual cost and lifetime for each potential HESS combination, capacity optimization is carried out in a microgrid.</p><sec id="Sec9"><title>Optimization model</title><p id="Par31">In islanded microgrid mode, reliability and effective power output smoothing are essential without the support from the utility grid, whilst in parallel microgrid mode, the economical characteristics of a microgrid are the major concerns.</p><p id="Par32">Consequently, the optimization objective is set as minimizing the equivalent annual cost in parallel mode, and the operational constraints are the reliability index in an islanded microgrid. This optimization model sets the operational constraints according to the most challenging circumstance that ensures reliability in both islanded and parallel modes, also the equivalent annual cost is minimized to improve the economic characteristics of the microgrid. After capacity optimization, the load shifting index needs to be calculated to evaluate the load smoothing ability of each HESS.</p></sec><sec id="Sec10"><title>Model of ESS</title><p id="Par33">The state of charge (SOC) is the basis of a unified ESS model [<xref ref-type="bibr" rid="CR15">15</xref>] for both mechanical and chemical ESSs, with the following definition:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SoC = E(t)/E_{n} (t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ4.gif"/></alternatives></disp-formula>where <italic>E</italic>(<italic>t</italic>) is the remaining capacity of ESS at the current moment; <italic>E</italic><sub><italic>n</italic></sub>(<italic>t</italic>) is the maximum capacity.</p><p id="Par34">The following equations define the charge and discharge characteristics at moment <italic>t</italic>:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>C</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SoC(t) = SoC(t - 1) + P_{\text{C}} (t)\eta_{\text{c}} \Delta t/E_{n}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>D</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mtext>d</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SoC(t) = SoC(t - 1) - P_{\text{D}} (t)\Delta t/(E_{n} \eta_{\text{d}} )$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ6.gif"/></alternatives></disp-formula>where Δ<italic>t</italic> is the sampling interval; <italic>P</italic><sub>C</sub>(<italic>t</italic>) and <italic>P</italic><sub>D</sub>(<italic>t</italic>) are the charge and discharge power of the ESS at the current moment; <italic>η</italic><sub>c</sub> and <italic>η</italic><sub>d</sub> are the charge and discharge efficiency.</p><p id="Par35">The ESS constraints include input and output power limits and the SOC limit:<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>C</mml:mtext></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>C</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>C</mml:mtext></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{C}}^{\hbox{min} } \le P_{\text{C}} (t) \le P_{\text{C}}^{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>D</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{D}}^{\hbox{min} } \le P_{\text{D}} (t) \le P_{\text{D}}^{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ8.gif"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mtext>min</mml:mtext></mml:msup><mml:mo>≤</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mtext>max</mml:mtext></mml:msup></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SoC^{\hbox{min} } \le SoC(t) \le SoC^{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ9.gif"/></alternatives></disp-formula></p><p id="Par36">In the equations above, <italic>P</italic><sub arrange="stack">C</sub><sup arrange="stack">max</sup> and <italic>P</italic><sub arrange="stack">D</sub><sup arrange="stack">max</sup> are the maximum input (charging) and output (discharging) power, defined by:<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>C</mml:mtext></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>cm</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{C}}^{\hbox{max} } = \hbox{min} \left\{ {P_{\text{cm}} ,[E_{n} - E(t - \Delta t)]/(\Delta t\eta_{\text{c}} )\} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ10.gif"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>dm</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mtext>B</mml:mtext></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="italic">η</mml:mi><mml:mtext>d</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{D}}^{\hbox{max} } = \hbox{min} \left\{ {P_{\text{dm}} ,[E(t - \Delta t) - E_{\text{B}}^{\hbox{min} } ]\eta_{\text{d}} /\Delta t\} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ11.gif"/></alternatives></disp-formula>where <italic>P</italic><sub>cm</sub> and <italic>P</italic><sub>dm</sub> are the rated ESS power. Equations (<xref rid="Equ10" ref-type="disp-formula">10</xref>) and (<xref rid="Equ11" ref-type="disp-formula">11</xref>) compare the rated input/output with the possible input/output to get the actually feasible ESS input/output.</p></sec><sec id="Sec11"><title>Optimization algorithm</title><p id="Par37">Capacity optimization of a HESS is non-linear with a large computation requirement. Also, there exist only 2 decision variables that are the capacities of 2 ESS, which means, a multi-algorithm is not required to improve the astringency. Under these circumstances, the particle swarm optimization algorithm (PSO) is applied in this paper, because it can converge quickly, perform accurate iterative calculations and can be implemented easily.</p></sec></sec><sec id="Sec12"><title>Indication system</title><p id="Par38">The optimum capacity results of multiple HESS alternatives need to be assessed to get the most suitable combination for a particular microgrid application. Furthermore, during installation or operation, some ESSs, especially the chemical ESSs, might pose safety or pollution risks [<xref ref-type="bibr" rid="CR16">16</xref>]. Thus, in this research, besides the technical parameters, cost and lifetime, the environmental impact and operational safety are also included in the indication system.</p><sec id="Sec13"><title>Load shifting</title><p id="Par39">In a microgrid, a HESS can be applied to shift and smooth load to reduce peaks and valleys, and the corresponding optimization function is:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>ave</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>M</mml:mi></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f = \frac{{\sum\limits_{t = 1}^{M} {\left( {P_{\text{f}} (t) - P_{\text{ave}} } \right)^{2} } }}{M}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ12.gif"/></alternatives></disp-formula>where <italic>P</italic><sub>f</sub>(<italic>t</italic>) is the total output of the HESS and renewable energy system calculated by (13); <italic>P</italic><sub>ave</sub>(<italic>t</italic>) is the average output of the total microgrid system defined by (14).
<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>load</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>PVW</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{f}} (t) = P_{\text{load}} (t) - P_{\text{PVW}} (t) + P_{\text{str}} (t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>ave</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\text{ave}} = \frac{1}{M}\sum\limits_{t = 1}^{M} {P_{\text{f}} (t)}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ14.gif"/></alternatives></disp-formula>where <italic>P</italic><sub>load</sub>(<italic>t</italic>), <italic>P</italic><sub>PVW</sub>(<italic>t</italic>), <italic>P</italic><sub>srt</sub>(<italic>t</italic>) are the power load, total renewable energy system output, and HESS output; <italic>M</italic> is the number of discrete samples in the 24-hour period modeled.</p></sec><sec id="Sec14"><title>Equivalent annual cost</title><p id="Par41">When the microgrid functions in parallel or ‘on-grid’ mode, the power exchange between the microgrid and the utility grid could potentially bring profit or loss. Thus, in this paper, the cost model is regarded as the equivalent annual cost defined as the annual cost of the HESS minus the power trading profit assumed the same on every day. <disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mn>365</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mtext>eco</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\text{E}} = C_{\text{s}} - 365C_{\text{eco}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ15.gif"/></alternatives></disp-formula>where <italic>C</italic><sub>s</sub> is the annual cost of HESS; <italic>C</italic><sub>eco</sub> is the power trading profit in 24 hours. <italic>C</italic><sub>eco</sub> is positive when power trading results in profits and when <italic>C</italic><sub>eco</sub> is negative there exists an economic loss. The calculation of <italic>C</italic><sub>s</sub> and <italic>C</italic><sub>eco</sub> is defined as follows.<list list-type="order"><list-item><p id="Par43">Annual cost</p></list-item></list></p><p id="Par44">The capital cost, O&amp;M cost and retirement cost are taken into realistic consideration in this paper. All the costs can be transferred into annual cost using the bank interest and lifespan of the ESS.
<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mi>Y</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mi>Y</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>E</mml:mtext></mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mi>Y</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>M</mml:mtext></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\text{s}} = \frac{{d_{\text{r}} (d_{\text{r}} + 1){}^{Y}}}{{(d_{\text{r}} + 1){}^{Y} - 1}}[C_{\text{p}} P + C_{\text{E}} E + \frac{{C_{\text{R}} }}{{(d_{\text{r}} + 1){}^{Y}}} + C_{\text{M}} ]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ16.gif"/></alternatives></disp-formula>where <italic>C</italic><sub>p</sub> is the investment in each energy storage unit; <italic>C</italic><sub>E</sub> is the investment in the power transmission, inverter and control system; <italic>P</italic> and <italic>E</italic> are the rated power and rated capacity of the ESS module, which make <italic>C</italic><sub>p</sub><italic>P</italic> + <italic>C</italic><sub>E</sub><italic>E</italic> the capital cost for a single ESS module; <italic>C</italic><sub>R</sub> is the retirement cost; <italic>C</italic><sub>M</sub> is the O&amp;M cost; <italic>d</italic><sub>r</sub> is the interest rate; <italic>Y</italic> is the lifespan.<list list-type="order"><list-item><p id="Par46">Power trading profit</p></list-item></list></p><p id="Par47">In parallel mode a microgrid creates a profit given by:<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>eco</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>grid</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>Eprice</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\text{eco}} = \sum\limits_{t = 1}^{M} {P_{\text{grid}} (t)C_{\text{Eprice}} (t)\Delta t}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ17.gif"/></alternatives></disp-formula>where <italic>P</italic><sub>grid</sub>(<italic>t</italic>) is the power exported to the utility grid; <italic>C</italic><sub>Eprice</sub>(<italic>t</italic>) is the electricity cost. This assumes that electricity exported will be rewarded at the same price as electricity purchased. This is not necessarily true and the applicable feed-in tariff should be used where available.</p></sec><sec id="Sec15"><title>Reliability constraints</title><p id="Par48">In this research, the loss of power supply probability (LPSP) and the loss of produced power probability (LPPP) are applied to represent reliability in a microgrid [<xref ref-type="bibr" rid="CR17">17</xref>].</p><p id="Par49">LPSP expresses when the produced system power is less than the power requirement, and it is defined as follows:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>LPS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>l</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$LPSP = \sum\limits_{t = 1}^{M} {E_{\text{LPS}} (t)} /\sum\limits_{t = 1}^{M} {E_{\text{l}} (t)}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ18.gif"/></alternatives></disp-formula>where <italic>E</italic><sub>LPS</sub>(<italic>t</italic>) is the energy shortfall in interval <italic>t</italic>; <italic>E</italic><sub>l</sub>(<italic>t</italic>) is the energy demand in that interval.</p><p id="Par50">LPPP expresses the lost or curtailed power when the total produced power is more than the demand power, which is defined as follows:<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>LPP</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext>PVW</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$LPPP = \sum\limits_{t = 1}^{M} {E_{\text{LPP}} (t)} /\sum\limits_{t = 1}^{M} {E_{\text{PVW}} (t)}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ19.gif"/></alternatives></disp-formula>where <italic>E</italic><sub>LPP</sub>(<italic>t</italic>) is the unused or curtailed energy in interval <italic>t</italic>; <italic>E</italic><sub>PVW</sub>(<italic>t</italic>) is the total energy output of wind and solar generators in the microgrid.</p><p id="Par51">To make sure the microgrid works in a stable state, LPPP and LPSP should be constrained by:<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$LPSP \le LPSP_{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$LPPP \le LPPP_{\hbox{max} }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ21.gif"/></alternatives></disp-formula></p></sec><sec id="Sec16"><title>Lifespan</title><p id="Par52">Of all 5 ESSs discussed in this paper, a NAS battery, flywheel, CAES and super capacitor have a relatively long lifespan. To simplify the calculation and model, the lifespan for these ESSs is set at a constant value. However, the depth of discharge (DOD), the discharge rate and the number of cycles have large impact on the lifespan of a lead acid battery [<xref ref-type="bibr" rid="CR18">18</xref>], so the lifespan prediction model in [<xref ref-type="bibr" rid="CR19">19</xref>] is applied, as follows.</p><p id="Par53">The battery has a finite life, which is regarded as the sum of the effective ampere-hours in the entire lifecycle. There exists a rated discharge life for each lead acid battery. When the sum of the effective ampere-hours during every discharge event equals the rated discharge life, the battery is then considered to have reached the end of its lifespan.</p><p id="Par54">The rated discharge life <italic>Г</italic><sub>R</sub> is defined as:<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">Γ</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma_{\text{R}} = L_{\text{R}} D_{\text{R}} C_{\text{R}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ22.gif"/></alternatives></disp-formula>where <italic>D</italic><sub>R</sub> is the DOD at rated cycle life, and DOD equals to 1-<italic>SoC</italic>; <italic>L</italic><sub>R</sub> is the cycle life at the rated DOD and discharge current; <italic>C</italic><sub>R</sub> is the rated amp-hour capacity at the rated discharge current.</p><p id="Par55">The effective discharge is expressed in the form of effective ampere-hours as follows:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>eff</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup><mml:mo>exp</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mtext>A</mml:mtext></mml:msub></mml:mfrac></mml:mfenced><mml:msub><mml:mi>d</mml:mi><mml:mtext>act</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\text{eff}} = \left( {\frac{{D_{\text{A}} }}{{D_{\text{R}} }}} \right)^{{u_{0} }} \exp \left[ {u_{1} \left( {\frac{{D_{\text{A}} }}{{D_{\text{R}} }}} \right) - 1} \right]\left( {\frac{{C_{\text{R}} }}{{C_{\text{A}} }}} \right)d_{\text{act}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ23.gif"/></alternatives></disp-formula>where <italic>D</italic><sub>A</sub> is the actual DOD; <italic>d</italic><sub>act</sub> is the discharge ampere-hours during every discharge event; <italic>C</italic><sub>A</sub> is the discharge capacity that can be calculated from battery specification sheet; <italic>u</italic><sub>0</sub> and <italic>u</italic><sub>1</sub> are the fitting parameters of the ‘life cycles–DOD’ curve of the battery.</p></sec><sec id="Sec17"><title>Safety and environmental impact</title><p id="Par56">The environmental impact mainly comprises combustion of fuels or gas, toxic remains and other impacts during ESS construction. Ref. [<xref ref-type="bibr" rid="CR20">20</xref>] reviewed the environmental impact of several ESSs for comparison using a life cycle assessment method.</p><p id="Par57">In terms of safety, the condition during installation, operation and dismantling are taken into account.</p><p id="Par58">To evaluate the safety and environmental impact, this paper grades the ESSs under consideration into 3 levels according to collected data and results [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref>] so that further quantitative transformation can be simplified. The three levels express the performance of an ESS as ‘Good’, ‘Medium’ and ‘Poor’. Table <xref rid="Tab1" ref-type="table">1</xref> provides the given value of safety and environmental impact of ESSs.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Safety and environmental impact of ESSs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>ESS</p></th><th align="left"><p>Safety</p></th><th align="left"><p>Environmental impact</p></th></tr></thead><tbody><tr><td align="left"><p>Lead acid</p></td><td align="left"><p>Medium</p></td><td align="left"><p>Poor</p></td></tr><tr><td align="left"><p>NAS</p></td><td align="left"><p>Poor</p></td><td align="left"><p>Good</p></td></tr><tr><td align="left"><p>Flywheel</p></td><td align="left"><p>Good</p></td><td align="left"><p>Good</p></td></tr><tr><td align="left"><p>CAES</p></td><td align="left"><p>Good</p></td><td align="left"><p>Medium</p></td></tr><tr><td align="left"><p>Super capacitor</p></td><td align="left"><p>Good</p></td><td align="left"><p>Good</p></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec18"><title>Elementary utility functions and normalization</title><p id="Par59">Multiple attributes should be converted into non-dimensional and standard form for evaluation. Let <italic>D</italic> = {<italic>D</italic><sub>1</sub>, <italic>D</italic><sub>2</sub>, <sup><bold>…</bold></sup>, <italic>D</italic><sub><italic>n</italic></sub>} be the set of decision alternatives. Let <italic>A</italic> = {<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, <sup><bold>…</bold></sup>, <italic>A</italic><sub><italic>m</italic></sub>} be the set of attributes associated with the consequences, which can be evaluated. For decision alternative <italic>D</italic><sub><italic>i</italic></sub>, there exists a set of utility consequences <italic>g</italic> = <italic>{g</italic><sub><italic>i</italic>1</sub>, <italic>g</italic><sub><italic>i</italic>2</sub>, <sup><bold>…</bold></sup>, <italic>g</italic><sub><italic>ij</italic></sub>} (<italic>i</italic> = 1,2,<sup><bold>…</bold></sup>,<italic>n</italic>; <italic>j</italic> = 1,2,<sup><bold>…</bold></sup>,<italic>m</italic>) which is the impact of each decision alternative on every consequence attribute. The matrix <bold><italic>G</italic></bold> = (<italic>g</italic><sub><italic>ij</italic></sub>)<sub><italic>n</italic>×<italic>m</italic></sub> can be can be used to describe and compute attributes and is called ‘attribute matrix’ or ‘decision matrix’ [<xref ref-type="bibr" rid="CR24">24</xref>]. In this paper, <italic>D</italic> = {Load shifting optimal result, Equivalent annual cost, LPSP, Lifespan, Safety, Environmental impact}.</p><p id="Par60">The purpose of normalization is to convert all attributes into real numbers in the range [0, 1]. There exists a worst consequence <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">0</sup> and a best consequence <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack"><italic>*</italic></sup> which should be given values of 0 and 1 respectively, and other utility measures be between <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">0</sup> and <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack"><italic>*</italic></sup>.</p><sec id="Sec19"><title>Load shifting normalization</title><p id="Par61">The level of consumption is the main characteristic desired from load shifting, which means the smaller the index is, the better the utility is. Also, in capacity optimization, the design objective for load shifting involves squaring, which benefits capacity optimization by emphasizing large shifting indexes. However, for subjective evaluation, a lesser load shifting effect is preferable in the utility. So, to remove the squaring effect, the square root is applied in <italic>u</italic><sub>1</sub> for a more subjective result, and the following utility function is used.
<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{1j} = u_{1} (g_{1j} ) = \sqrt {\frac{{g_{1}^{\hbox{max} } - g_{1j} }}{{g_{1}^{\hbox{max} } - g_{1}^{\hbox{min} } }}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ24.gif"/></alternatives></disp-formula>where <italic>g</italic><sub arrange="stack">1</sub><sup arrange="stack">max</sup> and <italic>g</italic><sub arrange="stack">1</sub><sup arrange="stack">min</sup> are the largest and smallest values of attribute <italic>D</italic><sub>1</sub>; <italic>g</italic><sub arrange="stack">1</sub><sup arrange="stack">max</sup> is <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">0</sup> and <italic>g</italic><sub arrange="stack">1</sub><sup arrange="stack">min</sup> is <italic>g</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack"><italic>*</italic></sup> so that <italic>u</italic><sub>1</sub><italic>(g</italic><sub arrange="stack">1</sub><sup arrange="stack">max</sup>) = 0 and <italic>u</italic><sub>1</sub>(<italic>g</italic><sub arrange="stack">1</sub><sup arrange="stack">min</sup>) = 1.</p></sec><sec id="Sec20"><title>Normalized equivalent annual cost normalization</title><p id="Par63">The lower the cost is, the better the attribute should be. Since the cost is a major concern in industry applications, to enlarge the cost utility relative to decision alternatives, the utility function is defined as a simple linear function.
<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mtext>min</mml:mtext></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{2j} = u_{2} (g_{2j} ) = \frac{{g_{2}^{\hbox{max} } - g_{2j} }}{{g_{2}^{\hbox{max} } - g_{2}^{\hbox{min} } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ25.gif"/></alternatives></disp-formula>where <italic>g</italic><sub arrange="stack">2</sub><sup arrange="stack">max</sup> and <italic>g</italic><sub arrange="stack">2</sub><sup arrange="stack">min</sup> are the largest and smallest values of attribute <italic>D</italic><sub>2</sub>.</p></sec><sec id="Sec21"><title>Reliability normalization</title><p id="Par65">The reliability requirement is given as a restriction on the loss of power supply probability (LPSP) given in (20). The LPSP provides a binary constraints, with the evaluation result either satisfied or unmet, and thus the following utility function is proposed.<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{3j} = u_{3} (g_{3j} ) = \left\{ {\begin{array}{*{20}c} 1 &amp; {g_{3j} \le LPSP_{\hbox{max} } } \\ 0 &amp; {g_{3j} &gt; LPSP_{\hbox{max} } } \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ26.gif"/></alternatives></disp-formula></p></sec><sec id="Sec22"><title>Lifespan normalization</title><p id="Par66">There is a positive correlation between lifespan and elementary utility. Since the lifetimes estimated in this paper are approximate, the disparity among them should not be emphasized too much. Thus, lifespan can be normalized as follows:<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mtext>max</mml:mtext></mml:msubsup></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{4j} = u_{4} (g_{4j} ) = \frac{{g_{4j} }}{{g_{4}^{\hbox{max} } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ27.gif"/></alternatives></disp-formula></p><p id="Par67">Since (27) has a ratio based on the <italic>g</italic><sub arrange="stack">4</sub><sup arrange="stack">max</sup> instead of <italic>g</italic><sub arrange="stack">4</sub><sup arrange="stack">max</sup>–<italic>g</italic><sub arrange="stack">4</sub><sup arrange="stack">min</sup>, the disparity of the effect of approximate value is reduced.</p></sec><sec id="Sec23"><title>Safety and environmental impact normalization</title><p id="Par68">For qualitative attributes, in this paper, the utility function is based on grading, and the main characteristics are discussed in Sect. <xref rid="Sec17" ref-type="sec">3.4.5</xref>. The 3 levels defined there allow this normalized utility to be defined.<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>6</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>`Good'</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>`Medium'</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>`Poor'</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{5j} = z_{6j} = u_{5} (g_{5j} ) = u_{6} (g_{6j} ) = \left\{ {\begin{array}{*{20}c} 1 &amp; {g_{5j} = {\text{`Good'}}} &amp; {} \\ {2/3} &amp; {g_{5j} = {\text{`Medium'}}} &amp; {} \\ {1/3} &amp; {g_{5j} = {\text{`Poor'}}} &amp; {} \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ28.gif"/></alternatives></disp-formula></p><p id="Par69">For a HESS, the elementary utility is defined as the average value.<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{5j} = \frac{1}{2}[u_{5} (g_{5j}^{k} ) + u_{5} (g_{5j}^{l} )]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ29.gif"/></alternatives></disp-formula>where <italic>g</italic><sub arrange="stack"><italic>5j</italic></sub><sup arrange="stack"><italic>k</italic></sup> and <italic>g</italic><sub arrange="stack"><italic>5j</italic></sub><sup arrange="stack"><italic>l</italic></sup> are the storage type in the current HESS.</p></sec></sec><sec id="Sec24"><title>Merging rules and hierarchical structure</title><p id="Par70">With the independent elementary utilities defined above, the following method is applied to merge them and compute the aggregate utility.</p><sec id="Sec25"><title>Multiplicative rule</title><p id="Par71">When two attributes have mutual independence and equal influence on the aggregate utility, and if and only if both of them are equal to 1, the utility consequence can reach 1. This relationship is interpreted as follows:<list list-type="order"><list-item><p id="Par72"><inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {1,1} \right) = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq1.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par73"><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {0,0} \right) = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq2.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par74"><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {u_{1} ,0} \right) = 0,\;\;\,W\left( {0,u_{2} } \right) = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq3.gif"/></alternatives></inline-formula></p></list-item></list></p><p id="Par75">These are satisfied by a multiplicative rule defined as follows:<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{1} ,u_{2} ) = u_{1} u_{2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ30.gif"/></alternatives></disp-formula></p></sec><sec id="Sec26"><title>Additive rule</title><p id="Par76">When two attributes have additive independence, the additive rule reflects how they compensate each other in forming the aggregate utility. It is as follows:<list list-type="order"><list-item><p id="Par77"><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {1,1} \right) = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq4.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par78"><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {0,0} \right) = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq5.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par79"><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {1,0} \right) = \sigma_{1} ,\;\;\,W\left( {0,1} \right) = \sigma_{2} ,\;\;\;\sigma_{1} + \sigma_{2} = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_IEq6.gif"/></alternatives></inline-formula></p></list-item></list></p><p id="Par80">These are satisfied by an additive rule defined as follows:<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{1} ,u_{2} ) = u_{1} + u_{2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ31.gif"/></alternatives></disp-formula></p></sec><sec id="Sec27"><title>Distance rule</title><p id="Par81">In the distance rule, the attributes can be compensated by each other in a nonlinear way. The distance rule is usually applied to combine cost and benefit indices due to its ability to determine the best cost at a certain benefit or the best benefit at a certain cost.<list list-type="order"><list-item><p id="Par82"><disp-formula id="Equg"><alternatives><mml:math display="block" id="Equg_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="Equg_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {1,1} \right) = 1$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equg.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par83"><disp-formula id="Equh"><alternatives><mml:math display="block" id="Equh_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equh_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W\left( {0,0} \right) = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equh.gif"/></alternatives></disp-formula></p></list-item><list-item><p id="Par84"><disp-formula id="Equi"><alternatives><mml:math display="block" id="Equi_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>W</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equi_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}l} {0 &lt; W\left( {1,u_{2} } \right) \le 1,} \hfill &amp; {\left( {0 \le u_{2} \le 1} \right)} \hfill \\ {0 &lt; W\left( {u_{1} ,1} \right) \le 1,} \hfill &amp; {\left( {0 \le u_{1} \le 1} \right)} \hfill \\ \end{array}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equi.gif"/></alternatives></disp-formula></p></list-item></list></p><p id="Par85">The distance rule is defined as follows:<disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{1} ,u_{2} ) = 1 - \sqrt {\frac{1}{2}[(1 - u_{1} )^{2} + (1 - u_{2} )^{2} ]}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ32.gif"/></alternatives></disp-formula></p></sec><sec id="Sec28"><title>Multi-attribute merging hierarchical structure of HESS</title><p id="Par86">The merging hierarchical structure is built according to the relationships among the indices, which is explained as follows.</p><p id="Par87">Considering the equivalent annual cost and lifespan, if and only if both of them are the optimal results, the effective cost of the system would also be optimal, so the multiplicative rule is applied:<disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{2} ,u_{4} ) = u_{2} u_{4}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ33.gif"/></alternatives></disp-formula></p><p id="Par88">Considering safety and environmental impact, they are both non-operational indexes. They indicate the effect that the system brings to the surroundings. Thus the relation between them is additive. Moreover, they are regarded as equal in significance, therefore, <italic>σ</italic><sub>1</sub> and <italic>σ</italic><sub>2</sub> are both equal to 0.5 and<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{5} ,u_{6} ) = \frac{1}{2}u_{5} + \frac{1}{2}u_{6}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ34.gif"/></alternatives></disp-formula></p><p id="Par89">Considering load shifting and the effective cost, they are typically cost and benefit attributes, and the improvement of either could increase the satisfaction index of the final HESS combination. This compensation relationship indicates that distance rule should be used as follows:<disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W(u_{1} ,u_{2} ,u_{4} ) = 1 - \sqrt {\frac{1}{2}[(1 - u_{1} )^{2} + (1 - u_{2} u_{4} )^{2} ]}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ35.gif"/></alternatives></disp-formula></p><p id="Par90">In the overall evaluation, none of the aggregated attributes mentioned above can be ignored, and if and only if all of them achieve the optimal result, the aggregate utility could also be the highest, that is to say the rule applied for overall evaluation is multiplicative.</p><p id="Par91">The general utility function can be defined as follows:<disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{G} = \left\{ {1 - \sqrt {\frac{1}{2}[(1 - u_{1} )^{2} + (1 - u_{2} u_{4} )^{2} ]} } \right\}\left( {\frac{1}{2}u_{5} + \frac{1}{2}u_{6} } \right)u_{3}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2017_310_Article_Equ36.gif"/></alternatives></disp-formula></p><p id="Par92">Based on this analysis, the hierarchical structure for and HESS combination in a microgrid is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Evaluation hierarchical structure in microgrid</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig2_HTML.gif" id="MO47"/></fig></p></sec></sec></sec><sec id="Sec29"><title>Case study</title><p id="Par93">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the curve of wind, solar and load output, and the electricity price which are studied to test the model presented. The capacity of the wind generator is 1.2 MW, the capacity of the solar generator is 800 kW, the maximum load is 3 MW, and the power exchange limit between the microgrid and the utility grid is 500 kW.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Wind output, solar output, load and electricity price curve for an islanded microgrid</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig3_HTML.gif" id="MO48"/></fig></p><sec id="Sec30"><title>Multiple attributes computations</title><p id="Par94">After capacity optimization of a HESS for this microgrid, using PSO in MATLAB, the optimal results shown in Table <xref rid="Tab2" ref-type="table">2</xref> can be obtained. In this case, the original load shifting index without HESS optimization is 522350, and the original LPPP and LPSP are 0.1555 and 0.2723.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Capacity optimization in islanded microgrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>HESS</p></th><th align="left"><p>Capacity (kW)</p></th><th align="left"><p>Equivalent annual cost ($)</p></th><th align="left"><p>Load shifting optimal result</p></th><th align="left"><p>LPPP</p></th><th align="left"><p>LPSP</p></th><th align="left"><p>Lifespan (year)</p></th></tr></thead><tbody><tr><td align="left"><p>Lead acid + Flywheel</p></td><td align="left"><p>709.320</p></td><td align="left"><p>1316700</p></td><td align="left"><p>287290</p></td><td align="left"><p>0.1</p></td><td align="left"><p>0.2017</p></td><td align="left"><p>10</p><p>20</p></td></tr><tr><td align="left"><p>Lead acid + Super capacitor</p></td><td align="left"><p>709.320</p></td><td align="left"><p>1316700</p></td><td align="left"><p>287290</p></td><td align="left"><p>0.1</p></td><td align="left"><p>0.2017</p></td><td align="left"><p>10</p><p>15</p></td></tr><tr><td align="left"><p>NAS + Flywheel</p></td><td align="left"><p>300</p><p>400</p></td><td align="left"><p>1887900</p></td><td align="left"><p>347380</p></td><td align="left"><p>0.0989</p></td><td align="left"><p>0.225</p></td><td align="left"><p>15</p><p>20</p></td></tr><tr><td align="left"><p>NAS + Super capacitor</p></td><td align="left"><p>420</p><p>985.6</p></td><td align="left"><p>1893000</p></td><td align="left"><p>330910</p></td><td align="left"><p>0.1</p></td><td align="left"><p>0.2222</p></td><td align="left"><p>15</p><p>15</p></td></tr><tr><td align="left"><p>CAES + Flywheel</p></td><td align="left"><p>550</p><p>1100</p></td><td align="left"><p>1944800</p></td><td align="left"><p>325500</p></td><td align="left"><p>0.0995</p></td><td align="left"><p>0.2306</p></td><td align="left"><p>40</p><p>20</p></td></tr><tr><td align="left"><p>CAES + Super capacitor</p></td><td align="left"><p>550</p><p>0</p></td><td align="left"><p>776730</p></td><td align="left"><p>348270</p></td><td align="left"><p>0.12</p></td><td align="left"><p>0.2431</p></td><td align="left"><p>40</p><p>15</p></td></tr></tbody></table></table-wrap></p><p id="Par95">As shown in the Table <xref rid="Tab2" ref-type="table">2</xref>, all the HESSs are effective at smoothing output and improving reliability in total system.</p><p id="Par96">A lead acid battery which works as a single ESS has the best load shifting performance. On the other hand, the CAES and super capacitor combination has the lowest equivalent annual cost. However, this HESS cannot satisfy LPSP limit, which makes it unacceptable in this case.</p></sec><sec id="Sec31"><title>Elementary utility computations and merging</title><p id="Par97">After capacity optimization, the necessary attributes are collected to carry out the multi-attribute utility method. The elementary and aggregated utilities of 6 combinations are expressed in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Elementary utility after multi-attribute evaluation for islanding microgrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>HESS</p></th><th align="left" colspan="7"><p>Elementary utility of each attribute</p></th></tr><tr><th align="left"><p>Load shifting optimal result</p></th><th align="left"><p>Equivalent annual cost</p></th><th align="left"><p>LPPP/LPSP</p></th><th align="left"><p>Lifespan</p></th><th align="left"><p>Safety</p></th><th align="left"><p>Environmental impact</p></th><th align="left"><p>Aggregate utility</p></th></tr></thead><tbody><tr><td align="left"><p>Lead acid + Flywheel</p></td><td align="left"><p>1</p></td><td align="left"><p>0.5377</p></td><td align="left"><p>1</p></td><td align="left"><p>0.5</p></td><td align="left"><p>0.8333</p></td><td align="left"><p>0.6667</p></td><td align="left"><p>0.3623</p></td></tr><tr><td align="left"><p>Lead acid + Super capacitor</p></td><td align="left"><p>1</p></td><td align="left"><p>0.5377</p></td><td align="left"><p>1</p></td><td align="left"><p>0.5</p></td><td align="left"><p>0.8333</p></td><td align="left"><p>0.6667</p></td><td align="left"><p>0.3623</p></td></tr><tr><td align="left"><p>NAS + Flywheel</p></td><td align="left"><p>0.1208</p></td><td align="left"><p>0.0487</p></td><td align="left"><p>1</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.6667</p></td><td align="left"><p>1</p></td><td align="left"><p>0.0648</p></td></tr><tr><td align="left"><p>NAS + Super capacitor</p></td><td align="left"><p>0.5336</p></td><td align="left"><p>0.0443</p></td><td align="left"><p>1</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.6667</p></td><td align="left"><p>1</p></td><td align="left"><p>0.2001</p></td></tr><tr><td align="left"><p>CAES + Flywheel</p></td><td align="left"><p>0.6111</p></td><td align="left"><p>0</p></td><td align="left"><p>1</p></td><td align="left"><p>1</p></td><td align="left"><p>1</p></td><td align="left"><p>0.8333</p></td><td align="left"><p>0.2212</p></td></tr><tr><td align="left"><p>CAES + Super capacitor</p></td><td align="left"><p>0</p></td><td align="left"><p>1</p></td><td align="left"><p>0</p></td><td align="left"><p>0.75</p></td><td align="left"><p>1</p></td><td align="left"><p>0.8333</p></td><td align="left"><p>0</p></td></tr></tbody></table></table-wrap></p><p id="Par98">Figures <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig8" ref-type="fig">8</xref> present the utility functions of the 6 attributes with the safety and environment impact attributes are already merged. For load shifting index, the slope of the curve is smaller than for the other indices, which exactly expresses the smaller disparity between 2 HESSs, if they have similar abilities to reduce load shifting index. The other utility curves also show the correct behavior corresponding to the attributes’ characteristics.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Utility curve for load shifting</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig4_HTML.gif" id="MO49"/></fig><fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Utility curve for equivalent annual cost</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig5_HTML.gif" id="MO50"/></fig><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Utility curve for reliability</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig6_HTML.gif" id="MO51"/></fig><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Utility curve for lifespan</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig7_HTML.gif" id="MO52"/></fig><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Utility curve for safety and environmental impact</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig8_HTML.gif" id="MO53"/></fig></p><p id="Par99">Combining the results in Table <xref rid="Tab2" ref-type="table">2</xref> and the aggregate utility in Table <xref rid="Tab3" ref-type="table">3</xref>, the result shows that the most satisfying combination and capacity allocation is the lead acid battery with flywheel or supercapacitor, and the highest aggregate utility is 0.3623. This HESS has the lowest equivalent annual cost but has the best performance in load shifting and is also able to satisfy the reliability limit.</p><p id="Par100">Figure <xref rid="Fig9" ref-type="fig">9</xref> presents 4 elementary utilities, without LPSP and LPPP limits.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Elementary utility of 4 possible HESS combination</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2017_310_Fig9_HTML.gif" id="MO54"/></fig></p><p id="Par101">Combining Table <xref rid="Tab3" ref-type="table">3</xref> with Fig. <xref rid="Fig9" ref-type="fig">9</xref>, several conclusions can be drawn. For the CAES and flywheel HESS, even an excellent load shifting performance cannot make up for the highest equivalent annual cost, which makes it less suitable in this case, and the same assessment also applies to the NAS and flywheel HESS. The 709 kW lead acid battery has the best load shifting performance and a rather low equivalent annual cost. From Fig. <xref rid="Fig9" ref-type="fig">9</xref>, it can be seen that the lead acid battery doesn’t have any extremely low attributes, which makes it the most acceptable solution in this case.</p></sec></sec><sec id="Sec32" sec-type="conclusion"><title>Conclusion</title><p id="Par102">In this paper, based on ESS characteristics and power system requirements, both capacity optimization and multi-attribute combination optimization for HESSs in a microgrid are conducted. The effectiveness and validity of this model are verified by a case study. From the case study, the following conclusions can be drawn:<list list-type="order"><list-item><p id="Par103">For capacity optimization, with the proper amount of HESS integrated in a microgrid, the equivalent annual cost in parallel mode and the reliability in islanded mode are both substantially improved. Through this optimization model, the optimization objectives of both microgrid operational modes can be combined.</p></list-item><list-item><p id="Par104">For HESS combination optimization, instead of making a subjective choice in advance without considering a range of ESS characteristics, this paper proposes an evaluation method that can offer an aggregate utility of each HESS combination. This helps to reconcile sometimes conflicting requirements to reduce the cost and environmental impact, and at the same time to improve operating stability, reliability and safety.
</p></list-item></list></p></sec></body><back><ack><title>Acknowledgements</title><p>This work was supported by Science and Technology Foundation of State Grid Corporation of China (No. 520940120036) and the Key Project of the National Twelfth-Five Year Research Programme of China (No. 2013BAA01B04).</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>H</given-names></name><name><surname>Bhattacharya</surname><given-names>T</given-names></name><name><surname>Tran</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">Composite energy storage system involving battery and ultracapacitor with dynamic energy management in microgrid applications</article-title><source>IEEE Trans Power Electron</source><year>2011</year><volume>26</volume><issue>3</issue><fpage>923</fpage><lpage>930</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2010.2095040</pub-id></mixed-citation></ref><ref id="CR2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>J</given-names></name><name><surname>Emadi</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A new battery/ultracapacitor hybrid energy storage system for electric, hybrid, and plug-in hybrid electric vehicles</article-title><source>IEEE Trans Power Electron</source><year>2012</year><volume>27</volume><issue>1</issue><fpage>122</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2011.2151206</pub-id></mixed-citation></ref><ref id="CR3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>HL</given-names></name><name><surname>Garde</surname><given-names>R</given-names></name><name><surname>Fulli</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Characterisation of electrical energy storage technologies</article-title><source>Energy</source><year>2013</year><volume>53</volume><fpage>288</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2013.02.037</pub-id></mixed-citation></ref><ref id="CR4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>Y</given-names></name><name><surname>Koh</surname><given-names>J</given-names></name><name><surname>Xie</surname><given-names>Q</given-names></name><etal/></person-group><article-title xml:lang="en">A scalable and flexible hybrid energy storage system design and implementation</article-title><source>J Power Sources</source><year>2014</year><volume>255</volume><issue>6</issue><fpage>410</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2013.12.102</pub-id></mixed-citation></ref><ref id="CR5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arrigoni</surname><given-names>S</given-names></name><name><surname>Tarsitano</surname><given-names>D</given-names></name><name><surname>Cheli</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Comparison between different energy management algorithms for an urban electric bus with hybrid energy storage system based on battery and supercapacitors</article-title><source>Int J Heavy Veh Syst</source><year>2016</year><volume>23</volume><issue>2</issue><fpage>171</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1504/IJHVS.2016.075506</pub-id></mixed-citation></ref><ref id="CR6"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>C</given-names></name><name><surname>Yue</surname><given-names>Y</given-names></name><name><surname>Choi</surname><given-names>SS</given-names></name><etal/></person-group><article-title xml:lang="en">Capacity optimization of hybrid energy storage systems in microgrid using empirical mode decomposition and neural network</article-title><source>Autom Electr Power Syst</source><year>2015</year><volume>39</volume><issue>8</issue><fpage>19</fpage><lpage>26</lpage></mixed-citation></ref><ref id="CR7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Duan</surname><given-names>S</given-names></name><name><surname>Cai</surname><given-names>T</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal allocation and economic analysis of energy storage system in microgrids</article-title><source>IEEE Tran Power Electron</source><year>2011</year><volume>26</volume><issue>10</issue><fpage>2762</fpage><lpage>2773</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2011.2116808</pub-id></mixed-citation></ref><ref id="CR8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>CH</given-names></name><name><surname>Zhu</surname><given-names>XJ</given-names></name><name><surname>Cao</surname><given-names>GY</given-names></name><etal/></person-group><article-title xml:lang="en">Dynamic modeling and sizing optimization of stand-alone photovoltaic power systems using hybrid energy storage technology</article-title><source>Renew Energy</source><year>2009</year><volume>34</volume><issue>3</issue><fpage>815</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1016/j.renene.2008.04.018</pub-id></mixed-citation></ref><ref id="CR9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lajunen</surname><given-names>A</given-names></name><name><surname>Suomela</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Evaluation of energy storage system requirements for hybrid mining loaders</article-title><source>IEEE Trans Veh Technol</source><year>2012</year><volume>61</volume><issue>8</issue><fpage>3387</fpage><lpage>3393</lpage><pub-id pub-id-type="doi">10.1109/TVT.2012.2208485</pub-id></mixed-citation></ref><ref id="CR10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amali</surname><given-names>C</given-names></name><name><surname>Jayaprakash</surname><given-names>D</given-names></name><name><surname>Ramachandran</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Optimized network selection using aggregate utility function in heterogeneous wireless networks</article-title><source>Int Rev Comput Softw</source><year>2014</year><volume>9</volume><issue>7</issue><fpage>1293</fpage><lpage>1301</lpage></mixed-citation></ref><ref id="CR11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>H</given-names></name><name><surname>Cheng</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Monte Carlo simulation based reliability evaluation of distribution system containing microgrids</article-title><source>Power System Technol</source><year>2011</year><volume>35</volume><issue>10</issue><fpage>76</fpage><lpage>81</lpage></mixed-citation></ref><ref id="CR12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>GH</given-names></name><name><surname>Duan</surname><given-names>MY</given-names></name><name><surname>Zhang</surname><given-names>JH</given-names></name><etal/></person-group><article-title xml:lang="en">Power system risk assessment based on the evidence theory and utility theory</article-title><source>Autom Electr Power Syst</source><year>2009</year><volume>33</volume><issue>23</issue><fpage>1</fpage><lpage>4</lpage></mixed-citation></ref><ref id="CR13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golshannavaz</surname><given-names>S</given-names></name><name><surname>Nazarpour</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Multi attribute investment planning of a grid-connected diesel/wind/PV/battery hybrid energy system</article-title><source>J Renew Energy Environ</source><year>2014</year><volume>1</volume><issue>1</issue><fpage>43</fpage></mixed-citation></ref><ref id="CR14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>Y</given-names></name><name><surname>Chang</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Hybrid electrical energy storage systems design</article-title><source>Int Symp Low Power Electron Design</source><year>2010</year><volume>22</volume><fpage>363</fpage><lpage>368</lpage></mixed-citation></ref><ref id="CR15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>J</given-names></name><name><surname>Dai</surname><given-names>B</given-names></name><name><surname>Chao</surname><given-names>P</given-names></name><etal/></person-group><article-title xml:lang="en">Wind power smoothing method using hybrid energy storage system based on SOC hierarchical optimization</article-title><source>Autom Electr Power Syst</source><year>2013</year><volume>37</volume><issue>24</issue><fpage>1</fpage><lpage>6</lpage></mixed-citation></ref><ref id="CR16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larcher</surname><given-names>D</given-names></name><name><surname>Tarascon</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">Towards greener and more sustainable batteries for electrical energy storage</article-title><source>Nature Chem</source><year>2015</year><volume>7</volume><issue>1</issue><fpage>19</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1038/nchem.2085</pub-id></mixed-citation></ref><ref id="CR17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbes</surname><given-names>D</given-names></name><name><surname>Martinez</surname><given-names>A</given-names></name><name><surname>Champenois</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Life cycle cost, embodied energy and loss of power supply probability for the optimal design of hybrid power systems</article-title><source>Math Comput Simul</source><year>2014</year><volume>98</volume><fpage>46</fpage><lpage>62</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3161259</pub-id><pub-id pub-id-type="doi">10.1016/j.matcom.2013.05.004</pub-id></mixed-citation></ref><ref id="CR18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masih-Tehrani</surname><given-names>M</given-names></name><name><surname>Ha’Iri-Yazdi</surname><given-names>MR</given-names></name><name><surname>Esfahanian</surname><given-names>V</given-names></name><etal/></person-group><article-title xml:lang="en">Optimum sizing and optimum energy management of a hybrid energy storage system for lithium battery life improvement</article-title><source>J Power Sources</source><year>2013</year><volume>244</volume><issue>4</issue><fpage>2</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2013.04.154</pub-id></mixed-citation></ref><ref id="CR19"><label>[19]</label><mixed-citation publication-type="other">Drouilhet S, Johnson BL (1997) A battery life prediction method for hybrid power applications. In: AIAA aerospace sciences meeting and exhibit, Reno, Nevada, 6–9</mixed-citation></ref><ref id="CR20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mcmanus</surname><given-names>MC</given-names></name></person-group><article-title xml:lang="en">Environmental consequences of the use of batteries in low carbon systems: the impact of battery production</article-title><source>Appl Energy</source><year>2012</year><volume>93</volume><issue>5</issue><fpage>288</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2011.12.062</pub-id></mixed-citation></ref><ref id="CR21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Cong</surname><given-names>TN</given-names></name><name><surname>Yang</surname><given-names>W</given-names></name><etal/></person-group><article-title xml:lang="en">Progress in electrical energy storage system: a critical review</article-title><source>Prog Nat Sci</source><year>2009</year><volume>19</volume><issue>3</issue><fpage>291</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1016/j.pnsc.2008.07.014</pub-id></mixed-citation></ref><ref id="CR22"><label>[22]</label><mixed-citation publication-type="other">Rosewater D (2015) Guide to safety in utility integration of energy storage systems. Energy Storage Integration Council, 2015</mixed-citation></ref><ref id="CR23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kousksou</surname><given-names>T</given-names></name><name><surname>Bruel</surname><given-names>P</given-names></name><name><surname>Jamil</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Energy storage: applications and challenges</article-title><source>Sol Energy Mater Sol Cells</source><year>2014</year><volume>120</volume><issue>1</issue><fpage>59</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2013.08.015</pub-id></mixed-citation></ref><ref id="CR24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pohekar</surname><given-names>SD</given-names></name><name><surname>Ramachandran</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Application of multi-criteria decision making to sustainable energy planning—a review</article-title><source>Renew Sustain Energy Rev</source><year>2004</year><volume>8</volume><issue>4</issue><fpage>365</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2003.12.007</pub-id></mixed-citation></ref></ref-list></ref-list></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Capacity optimization</facet-value><facet-value count="1">HESS combination evaluation</facet-value><facet-value count="1">Hybrid energy storage system (HESS)</facet-value><facet-value count="1">Multi-attribute utility theory</facet-value><facet-value count="1">Utility function</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Modern Power Systems and Clean Energy</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
