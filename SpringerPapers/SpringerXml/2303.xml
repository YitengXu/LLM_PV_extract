<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41467-023-39279-7</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41467</journal-id><journal-id journal-id-type="doi">10.1038/41467.2041-1723</journal-id><journal-title-group><journal-title>Nature Communications</journal-title><abbrev-journal-title abbrev-type="publisher">Nat Commun</abbrev-journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41467-023-39279-7</article-id><article-id pub-id-type="manuscript">39279</article-id><article-id pub-id-type="doi">10.1038/s41467-023-39279-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/638/11/296</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/638/630</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/119</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/119/118</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/139</subject></subj-group><subj-group subj-group-type="TechniquePath"><subject>/140/58</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Ultra-fast and accurate electron ionization mass spectrum matching for compound identification with million-scale <italic>in-silico</italic> library</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Yang</surname><given-names>Qiong</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Ji</surname><given-names>Hongchao</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Xu</surname><given-names>Zhenbo</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Li</surname><given-names>Yiming</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1988-7604</contrib-id><name><surname>Wang</surname><given-names>Pingshan</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au6"><name><surname>Sun</surname><given-names>Jinyu</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au7"><name><surname>Fan</surname><given-names>Xiaqiong</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au8"><name><surname>Zhang</surname><given-names>Hailiang</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au9"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4686-4491</contrib-id><name><surname>Lu</surname><given-names>Hongmei</given-names></name><address><email>hongmeilu@csu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41467023392797_cor9">j</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au10"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4167-4234</contrib-id><name><surname>Zhang</surname><given-names>Zhimin</given-names></name><address><email>zmzhang@csu.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41467023392797_cor10">k</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution content-type="org-division">College of Chemistry and Chemical Engineering</institution><institution content-type="org-name">Central South University</institution></institution-wrap><addr-line content-type="postcode">410083</addr-line><addr-line content-type="city">Changsha</addr-line><addr-line content-type="state">PR</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410727.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0526 1937</institution-id><institution content-type="org-division">Agricultural Genomics Institute at Shenzhen</institution><institution content-type="org-name">Chinese Academy of Agricultural Sciences</institution></institution-wrap><addr-line content-type="postcode">518120</addr-line><addr-line content-type="city">Shenzhen</addr-line><addr-line content-type="state">PR</addr-line><country country="CN">China</country></aff></contrib-group><author-notes><fn fn-type="con"><p>These authors contributed equally: Qiong Yang, Hongchao Ji.</p></fn><corresp id="IDs41467023392797_cor9"><label>j</label><email>hongmeilu@csu.edu.cn</email></corresp><corresp id="IDs41467023392797_cor10"><label>k</label><email>zmzhang@csu.edu.cn</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>22</day><month>6</month><year>2023</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2023</year></pub-date><volume>14</volume><issue seq="3722">1</issue><elocation-id>3722</elocation-id><history><date date-type="registration"><day>7</day><month>6</month><year>2023</year></date><date date-type="received"><day>8</day><month>7</month><year>2022</year></date><date date-type="accepted"><day>7</day><month>6</month><year>2023</year></date><date date-type="online"><day>22</day><month>6</month><year>2023</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2023</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Spectrum matching is the most common method for compound identification in mass spectrometry (MS). However, some challenges limit its efficiency, including the coverage of spectral libraries, the accuracy, and the speed of matching. In this study, a million-scale <italic>in-silico</italic> EI-MS library is established. Furthermore, an ultra-fast and accurate spectrum matching (FastEI) method is proposed to substantially improve accuracy using Word2vec spectral embedding and boost the speed using the hierarchical navigable small-world graph (HNSW). It achieves 80.4% recall@10 accuracy (88.3% with 5 Da mass filter) with a speedup of two orders of magnitude compared with the weighted cosine similarity method (WCS). When FastEI is applied to identify the molecules beyond NIST 2017 library, it achieves 50% recall@1 accuracy. FastEI is packaged as a standalone and user-friendly software for common users with limited computational backgrounds. Overall, FastEI combined with a million-scale <italic>in-silico</italic> library facilitates compound identification as an accurate and ultra-fast tool.</p></abstract><abstract xml:lang="en" id="Abs2" abstract-type="ShortSummary"><p id="Par2">Accuracy loss and slow speed affect the identification of compounds through matching of mass spectra using a large-scale spectral library. Here the authors use Word2vec spectral embedding and hierarchical navigable small-world graph to improve accuracy and speed of spectral matching on their own million-scale in-silico library.</p></abstract><funding-group><award-group><funding-source><institution-wrap><institution>National Natural Science Foundation of China (Grant Numbers. 21873116, 22273120, and 21675174).</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Portfolio</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>3722</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>Springer Nature Limited</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>7</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41467_2023_Article_39279.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Mass spectrometry (MS) is a convenient, highly sensitive, and reliable method for the analysis of complex mixtures, which is vital for life sciences fields such as metabolomics and proteomics, and organic synthesis in chemistry<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. High throughput identification of compounds in these complex samples is enabled by MS generation of thousands to millions of spectra, from which many thousands of compounds are typically identified by matching the experimental MS spectra against libraries containing a list of known molecular masses and fragmentation patterns. However, the vast majority of compounds in an MS experiment cannot be identified due to limited coverage in existing libraries. For example, only approximately 20% of compounds based on gas chromatography-mass spectrometry (GC-MS) can be identified by spectrum matching with current libraries<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. If the sample contains compounds that are absent from spectral libraries, the correct identification of them is nearly impossible because of false negatives. For false positives, some additional information can be used for effective filtering, such as molecular weight, retention index, and domain knowledge. By contrast, there are seldom remedies for a false negative. Therefore, it can be said that the cost of making a false negative is much higher than a false positive when identifying compounds. The coverage of the libraries needs to be increased as much as possible to avoid false negatives.</p><p id="Par4">Many efforts have been made to solve this problem. Common methods include acquiring experimental spectra of standards and generating <italic>in-silico</italic> spectra. The quantum chemistry electron ionization MS (QCEIMS) is a typical method that combines Born-Oppenheimer molecular dynamics (BOMD) with statistical sampling to predict mass spectra<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. However, the experiment and quantum chemistry strategy are costly and time-consuming to generate spectra for thousands of molecules. As a matter of fact, there are &gt;111 million molecules with structures in PubChem<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and two million bioactive molecules in ChEMBL<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. There are only 0.27 million compounds with electron ionization mass spectra in NIST 2017 library<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Recently, the molecule structure information combined with machine learning has become a burgeoning alternative for predicting <italic>in-silico</italic> spectra. For example, competitive fragmentation modeling for electron ionization (CFM-EI) applies a probabilistic generative model to predict the electron ionization mass spectrum (EI-MS) from SMILES<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. The neural electron-ionization mass spectrometry (NEIMS) method takes the extended circular fingerprints (ECFPs) of molecules as inputs and applies fully connected neural networks to predict the spectra<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. It can quickly and easily generate large-scale <italic>in-silico</italic> spectra from molecular structures, thus extending the chemical space and immensely increasing the coverage compared to experimental and quantum chemistry methods.</p><p id="Par5">With a large-scale <italic>in-silico</italic> library, another challenge is how to rapidly match query spectra with millions or even tens of millions of spectra while ensuring the accuracy of compound identification. The accuracy of spectrum matching partly depends on whether the metric correctly reflects the similarity between the query spectrum and reference spectrum<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. The weighted cosine similarity (WCS) is the most common method in mass spectrometry<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Other metrics are also employed, including Euclidian or Hamming distance, probability-based matching<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, weighted average ratio<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, and neutral-loss matching<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Matyushin et al. utilize a convolutional neural network (CNN) to search the EI-MS library and achieve better accuracy than the default method of NIST MS Search software<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The above methods can be regarded as the exact nearest neighbor search (NNS) methods. They are particularly time-consuming for matching large-scale libraries because of the scalability issue<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. When searching a large-scale library, the approximate nearest neighbor search (ANNS) methods are preferred, including hierarchical navigable small world graphs<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, inverted file<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, locality-sensitive hashing<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, and product quantization<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. These methods achieve significantly improved speedup by allowing a small number of errors in the searching procedure.</p><p id="Par6">Here, we develop a strategy to expand the coverage of spectral libraries and propose an efficient method to search large-scale libraries. The overview of the proposed method is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The 2,146,690 molecular structures come from the <italic>f</italic>-NIST and <italic>f</italic>-ChEMBL, which are obtained by filtering and deduplicating the NIST 2017 and ChEMBL 28<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, respectively (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1a</xref>). The predicted EI-MS spectra of these 2,146,690 molecules included in the <italic>in-silico</italic> library (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b</xref>) are generated by NEIMS using their molecular ECFPs as inputs. An ultra-fast and accurate spectrum matching (FastEI) was proposed to match the million-scale <italic>in-silico</italic> library efficiently. It consists of Word2vec spectral embedding for better accuracy and the hierarchical navigable small-world graph (HNSW) for faster spectrum matching<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. We have demonstrated the performance of FastEI in terms of identification accuracy and spectrum matching speed on a test set and an extra test set. Over ten thousand measured spectra of molecules in the test set were collected from NIST 2017. The extra test set includes ten synthetic organic compounds with measured spectra, which are not included in the NIST 2017. In general, FastEI is promising for compound identification along with the large-scale <italic>in-silico</italic> library.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><title>Flowchart of FastEI and WCS methods.</title><p>First, a large-scale <italic>in-silico</italic> library is generated from the NIST and ChEMBL datasets. For the querying of spectra, FastEI (top branch) uses Word2vec to transform the spectrum into spectral embeddings. These embeddings are given a Hierarchical Navigable Small-world Graph (HNSW) index, which is used for retrieving similar candidates from the library. Comparatively, classical binning methods (bottom branch) divide the spectra in bins and compare them with the ones in the library, most commonly using the weighted cosine similarity (WCS) as the measure.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2023_39279_Fig1_HTML.png"/></fig></p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Million-scale <italic>in-silico</italic> EI-MS library</title><p id="Par7">To solve the <italic>coverage problem</italic> in compound identification, a million-scale <italic>in-silico</italic> library was generated using NEIMS to get predicted EI-MS spectra from molecular ECFPs. The NEIMS model was downloaded from its official repository without any further operations.</p><p id="Par8">Firstly, to evaluate the predictive performance of NEIMS, the weighted cosine similarity (WCS) distribution between the predicted and experimental spectra in the test set is shown in Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">2</xref>. The similarities between predicted and experimental spectra of 78% of molecules are greater than 0.7. It demonstrates that NEIMS can accurately predict the EI-MS spectra for molecules. Meanwhile, Fig. <xref rid="Fig2" ref-type="fig">2a</xref> shows the classes of molecules in the test set predicted by ClassyFire<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. It demonstrates that the test set covers vast chemical structures. On the other hand, to validate the applicability of the NEIMS model for predicting mass spectra of molecules in <italic>f-</italic>ChEMBL, the uniform manifold approximation and projection (UMAP)<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup> was used to visualize the extended circular fingerprints (ECFPs) of molecules from the training set and <italic>f</italic>-ChEMBL. A total of 240,000 molecules (about 12%) were randomly sampled from the <italic>f</italic>-ChEMBL dataset to reduce the computational cost without losing representativeness. Then, RDKit<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> was used to calculate the ECFPs of these molecules. The high-dimensional ECFPs (1024 bits) were transformed into two-dimensional representations by UMAP for visualization. As shown in Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, the training set completely covers the molecules randomly sampled from <italic>f</italic>-ChEMBL in the chemical space. Therefore, it is reasonable to apply the NEIMS model to predict the mass spectra of molecules in the <italic>f</italic>-ChEMBL. Finally, 2,146,690 predicted spectra were generated to build the <italic>in-silico</italic> library, adopting ECFPs of molecules from <italic>f</italic>-NIST and <italic>f</italic>-ChEMBL as inputs of the NEIMS model (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b</xref>).<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><title>Information of datasets and performance of FastEI.</title><p><bold>a</bold> The molecule classes predicted by ClassyFire for the test set. <bold>b</bold> The visualization of the ECFPs of 240,000 molecules randomly selected from <italic>f</italic>-CHEMBL and 232,826 molecules from the training set by UMAP. <bold>c</bold> The spectrum matching time of FastEI and WCS on libraries with different sizes. <bold>d</bold> The contribution of Word2vec embeddings and HNSW to FastEI (WCS weighted binning + cosine similarity, EC embeddings + cosine similarity, BH weighted binning + HNSW, FastEI embeddings + HNSW). <bold>e</bold> The performance of FastEI and WCS on the test set in terms of recall rates at different top <italic>x</italic> levels. Source data are provided as a Source Data file.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2023_39279_Fig2_HTML.png"/></fig></p></sec><sec id="Sec4"><title>Spectrum matching performance of FastEI</title><p id="Par9">The accuracy and speed of FastEI were compared with WCS (Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">1</xref>) on the test set. The measured spectra of the test set were collected from the NIST 2017 main library. The comparison results of FastEI and WCS are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. We can find that the run time of FastEI is 0.0042 s per query spectrum, and that of WCS is 2.4849 s per query spectrum. FastEI is about 592 times faster than WCS when matching one spectrum.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>The spectrum matching performance on the <italic>in-silico</italic> library</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Method</p></th><th><p>Recall@1 (%)</p></th><th><p>Recall@10 (%)</p></th><th><p>Matching speed (s per query spectrum)</p></th></tr></thead><tbody><tr><td><p>FastEI</p></td><td><p>36.7</p></td><td><p>80.4</p></td><td><p>0.0042</p></td></tr><tr><td><p>WCS</p></td><td><p>30.2</p></td><td><p>73.5</p></td><td><p>2.4849</p></td></tr><tr><td><p>FastEI + mass filter<sup>a</sup></p></td><td><p>45.3</p></td><td><p>88.3</p></td><td><p>–</p></td></tr><tr><td><p>WCS + mass filter<sup>a</sup></p></td><td><p>37.1</p></td><td><p>81.6</p></td><td><p>–</p></td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The mass filter was set to 5 Da of the query molecule’s mass.</p></table-wrap-foot></table-wrap></p><p id="Par10">In analyzing complex systems, such as untargeted metabolomics<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and environmental science, it is necessary to quickly identify unknown compounds in bulk based on mass spectrometry. For such cases, the speed of spectrum matching methods becomes more critical, especially if the <italic>in-silico</italic> library is large too. A total of 11,499 experimental spectra in the test set were matched with the <italic>in-silico</italic> library at once by FastEI and WCS methods. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, only 2.9 s were needed to get the matching results by FastEI. In contrast, about 11.2 min were required by WCS. FastEI is 232 times faster than WCS in large-scale spectrum matching. For the matching accuracy (Table <xref rid="Tab1" ref-type="table">1</xref>), FastEI achieves a matching result with 36.7% recall@1 and 80.4% recall@10. After applying a 5 Da mass filter to the spectrum matching result, FastEI achieves 45.3% recall@1 and 88.3% recall@10. By contrast, the matching accuracy of FastEI is better than WCS with 6.5 and 6.9 percentage points at recall@1 and recall@10, respectively, when without the mass filter. With the 5 Da mass filter, the difference in the matching accuracy of the two methods (FastEI and WCS) is 8.2 and 6.7 percentage points in recall@1 and recall@10, respectively. In short, the FastEI method outperforms the WCS method in matching speed and accuracy. In practice, this mass filter could be set according to the practical requirement<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>.</p><p id="Par11">In order to verify the impact of the library size on the spectrum matching speed, one mass spectrum was randomly selected from the test set to calculate the matching time of FastEI and WCS methods on the libraries with different sizes. The results are shown in Fig. <xref rid="Fig2" ref-type="fig">2c</xref>. It can be seen that the matching time of WCS linearly increases with the number of spectra in the library, and the time of FastEI hardly increases with the library size. As the number of spectra in the <italic>in-silico</italic> library increases, this advantage becomes more and more apparent. When the number goes up to ~2,000,000, the matching speed of FastEI is five hundred times faster than WCS. This unique characteristic should be attributed to the hierarchical graph structure of HNSW for efficient graph traversal.</p></sec><sec id="Sec5"><title>Contribution of Word2vec embeddings and HNSW</title><p id="Par12">As shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>, a comprehensive study is conducted to demonstrate the contribution of Word2vec embeddings and HNSW in the FastEI method. Speed in Fig. <xref rid="Fig2" ref-type="fig">2d</xref> is defined as how many mass spectra per second can be identified. Accuracy is the recall@1 of the identified spectra in the test set. FastEI can match 36.7% spectra with recall@1 at 238 spectra per second speed. It can be seen from Fig. <xref rid="Fig2" ref-type="fig">2d</xref> that FastEI is the best in terms of both speed and accuracy. Meanwhile, the accuracy of the EC (embeddings + cosine similarity) method, which is formed from the binning in WCS replaced by embeddings, is improved to a level comparable to that of FastEI, but with a similar matching speed to WCS. The matching speed of BH (weighted binning + HNSW) method, which is formed from the cosine similarity in WCS replaced by HNSW, is improved partly with the same accuracy as WCS. Results show that the Word2vec embeddings mainly improve accuracy. Meanwhile, the HNSW boosts the matching speed. The HNSW index is an efficient data structure (the hierarchically multi-layer graph) to store and organize data. It can significantly improve the speed of ANNS. In brief, the FastEI method achieves high accuracy and speed by combining Word2vec embeddings and HNSW.</p></sec><sec id="Sec6"><title>Applicability of FastEI to spectra from different sources</title><p id="Par13">To evaluate the generalizability to different mass spectral sources and qualities, the spectra of the test set were collected from two different sources, the NIST 2017 main library (<italic>mainlib</italic>) and replicate library (<italic>replib</italic>). The spectra of the <italic>mainlib</italic> test set are from <italic>mainlib</italic>, a collection of the “best spectrum” for each compound based on human evaluation. In contrast, the spectra in the <italic>replib</italic> test set are from the NIST 2017 replicates library, which is a collection of noisier spectra due to inconsistency of sources, such as instrument type, experiment condition, and laboratory. The spectrum matching performance of the FastEI and WCS methods was evaluated by the <italic>mainlib</italic> test set and the <italic>replib</italic> test set. As shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref>, the spectral matching performance of FastEI significantly outperforms WCS by an average of 6 percentage points in recall rates at different top x levels. The matching results of the <italic>replib</italic> spectra are basically the same as those of the <italic>mainlib</italic> spectra. It indicates that FastEI is a robust method.</p></sec><sec id="Sec7"><title>Incremental expansion of the library</title><p id="Par14">In practical application, mass spectral libraries often need to be expanded due to the introduction of new compounds. It is easy to implement by predicting the mass spectra of these new compounds using the existing NEIMS model and adding them to the <italic>in-silico</italic> library. The predicted spectra are converted into spectral embeddings by the trained Word2vec model. Then, these spectral embeddings are added to the original HNSW index to build the expanded HNSW index. This simple operation can complete the update of FastEI with the expansion of the mass spectral library.</p><p id="Par15">A total of 106,526 predicted spectra of new molecules from <italic>f</italic>-HMDB and the extra test set were added into the <italic>in-silico</italic> library to get the expanded library (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b</xref>). The expanded library includes 2,253,216 molecules and their predicted spectra. The experimental spectra (collected from the NIST 2017 main library) of molecules in the test set were used again to evaluate the identification performance of FastEI and WCS on the expanded library. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the recall@1 and recall@10 of FastEI are 36.4% and 79.9%, respectively. The recall@1 and recall@10 of WCS are 29.5% and 72.9%, respectively. It can be seen from Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref> that expanding the <italic>in-silico</italic> library with nearly 100,000 molecules reduces the recall rate of 0.3% of recall@1 and 0.5% of recall@10 in the FastEI method, respectively. It reduces the recall rate of 0.5% of recall@1 and 0.6% of recall@10 in the WCS method, respectively. The average run time (s) for matching one molecule against the expanded library of FastEI and WCS is 0.0046 s and 2.6368 s, respectively. The results in Table <xref rid="Tab2" ref-type="table">2</xref> indicate that the expansion of the <italic>in-silico</italic> library with nearly 100,000 molecules slightly reduces the accuracy of the matching performance and slightly increases the matching time. The slight decrease in the matching accuracy should be attributed to the expanded library having more compound structures than the <italic>in-silico</italic> library. As shown in Supplementary Figs. <xref ref-type="supplementary-material" rid="MOESM1">3</xref>, <xref ref-type="supplementary-material" rid="MOESM1">7</xref> new classes (ClassyFire) of compounds appear in the expanded library compared to the <italic>in-silico</italic> library. For a given query spectrum, there are more compounds with similar structures or similar spectra to the target compound in the expanded library. In short, the expansion of the <italic>in-silico</italic> library is simple and has little impact on the performance of FastEI.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>The matching performance on the expanded library</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Method</p></th><th><p>Recall@1 (%)</p></th><th><p>Recall@10 (%)</p></th><th><p>Matching speed (s per query spectrum)</p></th></tr></thead><tbody><tr><td><p>FastEI</p></td><td><p>36.4</p></td><td><p>79.9</p></td><td><p>0.0046</p></td></tr><tr><td><p>WCS</p></td><td><p>29.7</p></td><td><p>72.9</p></td><td><p>2.6368</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec8"><title>Unknown compound identification</title><p id="Par16">GC-MS is often used to monitor the reaction progress<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup> and analyze reaction samples<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> to identify reactants, reaction intermediates, and products in organic synthesis. However, it is difficult to identify compounds absent from the NIST 2017 library through spectrum matching due to the limited compound coverage. To demonstrate the advantage of the million-scale <italic>in-silico</italic> library and the accuracy of FastEI, 10 compounds beyond the NIST 2017 library were collected from an organic laboratory. Their structures are shown in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>. Compounds 1, 2, 4, and 5 are common aromatic compounds with different substituents on the benzene rings. If these 10 molecules are identified by matching the NIST 2017 library directly, the correct result cannot be achieved. Because there are no correct molecules in the NIST 2017 library, and all the candidates are false positives. With the aid of the large-scale <italic>in-silico</italic> library, these compounds can be mostly identified by FastEI. Their ranks are shown in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>. It can be seen that their top 1 accuracy is 50%, and the top 10 accuracy can reach 70%. The compound with a rank &gt;100 is only compound 10, which has a 12-carbon long-chain substituted on the benzene ring. Its MS spectrum is shown in Fig. <xref rid="Fig3" ref-type="fig">3b</xref>. It can be seen that most peaks are concentrated in m/z <bold>&lt;</bold> 200. Many chain alkanes candidates are ranked before the target compound, possibly due to the existence of a long-chain structure (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). Overall, these results show that FastEI with the large-scale <italic>in-silico</italic> library can achieve good identification results for molecules beyond the NIST 2017 library. Expanding the spectra library by machine learning-based methods is beneficial to compound identification through reducing the proportion of false negatives.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><title>The performance of FastEI on compounds beyond NIST 2017.</title><p><bold>a</bold> The molecular structures of 10 compounds outside the NIST 2017 library, and their identification results by FastEI. Rank 1 means the target molecule is ranked first in the candidate list. <bold>b</bold> The red spectrum represents the query spectrum of compound <bold>10</bold>. The blue spectrum represents the spectrum of the molecule ranked first in the candidate list. Rank 1 means the target molecule is ranked first in the candidate list. <bold>c</bold> Molecular Structure display of the top ten candidates of target compound <bold>10</bold>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2023_39279_Fig3_HTML.png"/></fig></p></sec><sec id="Sec9"><title>FastEI software</title><p id="Par17">We provide an integrated spectrum matching software with the <italic>in-silico</italic> library and matching algorithms. The core functions of FastEI are implemented with Python programming languages, and the graphical user interface (GUI) is based on the Qt framework. The software can run on Windows 7, 10, and 11 operating systems. As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the user interface is simple and friendly. For the universality, when the software is opened, the expanded library is loaded by default (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). Meanwhile, it can switch between different libraries without restarting the software. Researchers can also build tailored libraries according to their research aims.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><title>Screenshot of FastEI.</title><p><bold>a</bold> loading library, index, and model. <bold>b</bold> loading query spectra. <bold>c</bold> displaying the matched candidates <bold>d</bold> a progress bar showing the matching progress.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2023_39279_Fig4_HTML.png"/></fig></p><p id="Par18">Users can click the Query button to select experimental spectra for identification. As shown in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, the query spectra are loaded. The library matching results are available immediately after the query spectra are loaded. Users can click on any query spectrum to see its candidates list in the upper part of Fig. <xref rid="Fig4" ref-type="fig">4c</xref>. Then, users can click any compound in the candidate list to show its spectrum in the <italic>in-silico</italic> library against the measured query spectrum in the lower part of Fig.<xref rid="Fig4" ref-type="fig">4c</xref> along with its molecular structure. Figure <xref rid="Fig4" ref-type="fig">4d</xref> is a bar that displays the progress of data loading and spectrum matching. The installation package of FastEI is available at <ext-link xlink:href="https://github.com/Qiong-Yang/FastEI/releases" ext-link-type="uri">https://github.com/Qiong-Yang/FastEI/releases</ext-link>. Overall, FastEI is a convenient and easy-to-use software for searching a million-scale <italic>in-silico</italic> library quickly and accurately.</p></sec></sec><sec id="Sec10" sec-type="discussion"><title>Discussion</title><p id="Par19">Spectrum matching is one of the vital steps for identifying compounds in metabolomics, organic synthesis, biology, and others. In this study, an ultra-fast and accurate spectrum matching method, FastEI, was proposed. Firstly, a million-scale <italic>in-silico</italic> spectral library was included in FastEI to improve EI-MS-based compound identification. The <italic>in-silico</italic> library with predicted spectra of large-scale molecules can extend the chemical space and immensely increase the coverage compared to experimental libraries. By increasing the number of compounds in the <italic>in-silico</italic> library to more than two million in FastEI, the false negative rate can be significantly reduced during compound identification. It can be seen from the identification results of 10 compounds in the extra test set. Without improving the coverage, all these 10 molecules cannot be identified by matching the NIST 2017. After improving the coverage, its recall@1 is 50%, recall@10 is 70%, and recall@20 is 90% by FastEI, respectively.</p><p id="Par20">Secondly, the high accuracy of FastEI depends on the Word2vec spectral embedding. The mass spectra contain structural information. However, it cannot be entirely extracted by the cosine similarity based on the spectral binning vectors. Not all molecules with high structural similarity have a high cosine similarity based on spectral binning vectors. Cross-correlation can improve the correlation between spectral and structural similarity by shifting the fragment peaks in mass spectra<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. On the other hand, it is possible to transform the mass spectra appropriately so that the cosine similarity between the transformed spectra is more relevant to the structural similarity. Inspired by the Word2vec technique in natural language processing<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, the Spec2Vec method has been developed for tandem mass spectra (MS/MS). It can learn the co-occurrence of molecular fragments in large-scale spectra and represent highly related fragments by vectors in similar directions<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. As shown in Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">4</xref> and Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the Word2vec model successfully mines important features that are efficient for structure “discrimination” and improves the accuracy of true/false candidate selection. There are 1413 target molecules in the test set ranked top1 by FastEI but ranked outside of the top1 by WCS. After Word2vec spectral embeddings, the same molecules have high cosine similarity, and different molecules have low cosine similarity. The possible explanation for these performance improvements is that the conversion of spectral bins to embeddings by Word2vec successfully re-scales the chemical space. At the same time, the model removes noisy bins that may interfere with the possible discrimination (i.e., noisy bins weaken the power of the discrimination). Therefore, the Word2vec spectral embedding improves the accuracy of compound identification.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><title>Word2vec and HNSW.</title><p><bold>a</bold> Transforming the spectra into low-dimensional spectral embeddings using the Word2vec model. The Word2vec model is trained on fragments in the mass spectra. Each fragment is represented by a word that contains its position up to a defined integer precision (Peak@xx). For example, a fragment at m/z 89 translates into the word “Peak@89”. <bold>b</bold> Approximate nearest neighbor search based on the hierarchical navigable small-world graph. The top layer is the entry point and contains only the longest links. As moving down the layers, the link lengths become shorter and more numerous. The search process is as follows: traversing edges in each layer; greedily moving to the nearest vertex until finding a local minimum in the current layer; repeating the above process until finding the nearest neighbors of the query vector in the bottom layer (<italic>layer 0)</italic>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41467_2023_39279_Fig5_HTML.png"/></fig></p><p id="Par21">Thirdly, the high speed of FastEI depends on the HNSW-based spectrum matching. The HNSW provides an efficient way to find the approximate nearest spectral embeddings of a query spectral embedding. Because of the hierarchical graph structure and the efficient graph traversal method of HNSW, the number of spectra to be matched is reduced by several orders of magnitude compared to traditional methods.</p><p id="Par22">Lastly, FastEI was packaged as a standalone and user-friendly software for users without programming backgrounds. The users can quickly and accurately identify the compound by simply loading raw measured mass spectra in FastEI.</p><p id="Par23">Overall, FastEI has shown excellent accuracy and speed for spectrum matching. Furthermore, we believe that FastEI can be extended to other instruments that require spectrum matching against large spectral libraries, such as tandem mass spectrometry, nuclear magnetic resonance spectroscopy, infrared spectroscopy, and Raman spectroscopy. In summary, FastEI is an integrated and user-friendly tool with GUI for ultra-fast and accurate compound identification.</p></sec><sec id="Sec11" sec-type="methods"><title>Methods</title><sec id="Sec12"><title>Datasets for building the libraries</title><p id="Par24">Four datasets were used to build the <italic>in-silico</italic> and the expanded libraries. They are NIST 2017, ChEMBL 28, HMDB 5.0<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and the extra test set. Since the GC-MS technique is only suitable for analyzing volatile small molecules, five filtering steps (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">6</xref>) are applied to the molecules in these four datasets to obtain reasonable datasets. They are: (1) molecular mass is less than 1000 Da; (2) molecules only contain 11 common elements H, C, O, N, P, S, Cl, F, Br, I, Si; (3) molecules are not ionic compounds; (4) molecular LogP is within the range from −12 to 24; (5) repeating molecules was deduplicated within the dataset. After filtering, the deduplication was strictly conducted among all four datasets to ensure the uniqueness of the molecules in the library. The detailed information on excluded molecules by data filtering and deduplicating is displayed in Supplementary Data <xref ref-type="supplementary-material" rid="MOESM5">1</xref>.<list list-type="order"><list-item><p id="Par25">NIST 2017. The SMILES strings of the NIST 2017 were downloaded from the NEIMS GitHub repository (<ext-link xlink:href="https://github.com/brain-research/deep-molecular-massspec/tree/main/training_splits" ext-link-type="uri">https://github.com/brain-research/deep-molecular-massspec/tree/main/training_splits</ext-link>). It consists of three datasets, the NEIMS_training set (237,108), the NEIMS_ validation set (11,499), and the NEIMS_test set (11,600) set<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Using the five filtering rules (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">6</xref>), these three datasets were filtered to get the training set (232,826), validation set (11,496), and test set (11,499). The <italic>f</italic>-NIST (255,821) was obtained by combining the training set, the validation set, and the test set.</p></list-item><list-item><p id="Par26">ChEMBL 28. The gzipped structure-data file (SDF) of ChEMBL 28 was downloaded from <ext-link xlink:href="https://ftp.ebi.ac.uk/pub/databases/chembl/ChEMBLdb/releases/chembl_28/chembl_28.sdf.gz" ext-link-type="uri">https://ftp.ebi.ac.uk/pub/databases/chembl/ChEMBLdb/releases/chembl_28/chembl_28.sdf.gz</ext-link> (accessed on February 6th, 2022). The SMILES strings of molecules were read by RDKit (v2022.03.3). There are 2,066,376 molecules in the SDF file with mol files, of which 2,066,374 can be read using RDKit. After filtering with five rules and deduplicating with <italic>f</italic>-NIST, the number of remaining molecules is 1,890,869. The resulting library is called <italic>f</italic>-ChEMBL.</p></list-item><list-item><p id="Par27">HMDB 5.0. The zip archive of the SDF file of HMDB 5.0 was downloaded from its official website <ext-link xlink:href="https://hmdb.ca/system/downloads/current/structures.zip" ext-link-type="uri">https://hmdb.ca/system/downloads/current/structures.zip</ext-link> (accessed on February 23rd, 2022). The SMILES strings of 217,759 molecules were read using RDKit (v2022.03.3). After filtering and deduplication with <italic>f</italic>-NIST and <italic>f</italic>-ChEMBL, the resulting library is called <italic>f</italic>-HMDB with 106,516 molecules.</p></list-item><list-item><p id="Par28">Extra test set. All small molecules in the extra test set were obtained from the organic synthesis laboratory of Prof. Pingshan Wang. These molecules are important raw materials, intermediates, or products in organic synthesis. The Bromo-substituted compounds in the extra test set, like <bold>2,</bold><bold>3,</bold><bold>4,</bold><bold>5,</bold><bold>6</bold>, and <bold>10</bold>, play an important role as intermediates in producing adsorbent materials and pharmaceuticals<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. The ChEMBL includes many drug-like bioactive compounds, in which 4% of the molecules contain the element bromine. Compound <bold>3</bold>, methyl 6-bromohexanoate, is a useful intermediate for synthesizing drug carriers<sup><xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup> and adsorbents for dye-sensitized solar cells<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. Compound <bold>9</bold> is often used to synthesize metal-organic framework (MOF), which is a famous class of coordination materials<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>. Other oxyaromatic compounds (<bold>1,</bold><bold>7,</bold><bold>8</bold>) have been proven to be promising modifying agents for nylons to improve their physicomechanical properties<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. These ten molecules are beyond NIST 2017 and absent from <italic>f</italic>-ChEMBL and <italic>f</italic>-HMDB. Therefore, this dataset does not need to be deduplicated.</p></list-item></list></p><p id="Par29">With the above data filtering and deduplicating, there are no duplicate molecules between these four datasets (<italic>f-</italic>NIST, <italic>f</italic>-ChEMBL, <italic>f</italic>-HMDB, and the extra test set). All the molecular structure information in the <italic>f-</italic>NIST, <italic>f</italic>-ChEMBL, <italic>f</italic>-HMDB, and the extra test set are prepared as the inputs of the NEIMS model to generate the predicted spectra.</p></sec><sec id="Sec13"><title>Datasets for FastEI</title><p id="Par30">Four datasets were used to train the Word2vec model, optimize the hyperparameters of the Word2vec model, and evaluate the performance of the FastEI, respectively.<list list-type="order"><list-item><p id="Par31">Word2vec training set. The predicted spectra of molecules in the training set (232,826) and <italic>f</italic>-ChEMBL (1,890,869) were merged into the Word2vec training set (Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1c</xref>). It consists of 2,123,695 predicted spectra.</p></list-item><list-item><p id="Par32">Validation set. The Word2vec is a self-supervised learning method and cannot be validated and tested directly. The measured spectra of the validation set were collected from the NIST 2017 library. It consists of 11,496 measured spectra. It was used to optimize the hyperparameters of the Word2vec model according to its matched results of FastEI.</p></list-item><list-item><p id="Par33">Test set. The measured spectra of the test set were collected from the NIST 2017 library. It consists of 11,499 measured spectra. It was used to evaluate the performance of FastEI.</p></list-item><list-item><p id="Par34">Extra test set. The experimental spectra of the extra test set were measured on a Shimadzu GC-2010 gas chromatography coupled with a Shimadzu QP2010Ultra mass spectrometer (Shimadzu, Japan), equipped with an autosampler GL 221-34618. It consists of 10 measured spectra. It was used to evaluate the performance of FastEI for molecules beyond the NIST 2017 library. The detailed experimental condition can be seen in Supplementary Note <xref ref-type="supplementary-material" rid="MOESM1">2</xref>.</p></list-item></list></p></sec><sec id="Sec14"><title>Prediction of spectra by NEIMS and construction of the <italic>in-silico</italic> and expanded libraries</title><p id="Par35">The ECFPs of all molecules in <italic>f-</italic>NIST, <italic>f</italic>-ChEMBL, <italic>f</italic>-HMDB, and the extra test set were fed into the NEIMS model to obtain their predicted mass spectra. The NEIMS model was downloaded from its official repository (<ext-link xlink:href="https://storage.googleapis.com/deep-molecular-massspec/massspec_weights/massspec_weights.zip" ext-link-type="uri">https://storage.googleapis.com/deep-molecular-massspec/massspec_weights/massspec_weights.zip</ext-link>) without re-training. The input of NEIMS is the ECFPs, and the RDKit package is used to calculate the ECFPs from SMILES strings. The output of the NEIMS model is a spectral vector representing the intensity at each m/z. As shown in Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1b</xref>, the predicted spectra of molecules in <italic>f-</italic>NIST and <italic>f</italic>-ChEMBL were used to build the <italic>in-silico</italic> library, which included 2,146,690 molecules and their predicted spectra. The predicted spectra of molecules in <italic>f</italic>-HMDB and the extra test set were added to the <italic>in-silico</italic> library to build the expanded library, which included 2,253,216 molecules and their predicted spectra.</p></sec><sec id="Sec15"><title>Word2vec model building and spectral embedding</title><p id="Par36">Two methods were used to represent mass spectra in this study, the binning vectors and the Word2vec embeddings. For the binning vectors, mass spectra were represented as <italic>m</italic>-dimensional vectors representing the intensity at each m/z. For the embedding method, the Word2vec model was adapted to learn meaningful representations from mass spectra and get <italic>d</italic>-dimensional embeddings. By comparing Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">7a, b</xref> the Word2vec embeddings are more relevant to the chemical superclasses than the spectral binning vectors.</p><p id="Par37">As shown in Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">1c</xref>, the Word2vec model was trained using the Word2vec training set based on gensim<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, a Python library. The Word2vec model trained on peaks in the mass spectra (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>) differs significantly from typical natural language processing (NLP) applications in several aspects, and some critical hyperparameters of the model also differ from the default settings. All the hyperparameters of Word2vec are listed in Supplementary Table <xref ref-type="supplementary-material" rid="MOESM1">1</xref>. First, peaks in the mass spectra have no particular order comparable to the word order in a document. Moreover, larger windows tend to capture more topic/domain information<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Smaller windows tend to capture more about a specific word itself. An individual peak in mass spectra is meaningless. The combination of all peaks is meaningful in mass spectra. Hence, the window size was set to 1000. There are two ways to implement word embeddings using Word2vec: skip-gram and continuous bag of words (CBOW). The latter was observed to perform better for the embedding of mass spectra. All previously mentioned hyperparameters were adjusted according to the spectrum matching performance of FastEI on the validation set. The other hyperparameters were set as followings: (1) word vector dimension = 500, (2) negative sampling (negative = 5), (3) initial learning rate = 0.025, (4) learning rate decay per epoch = 0.00025, (5) epoch = 60. Commonly, training with a large epoch can improve the results of a Word2vec model in NLP tasks. However, this rule is not suitable for the embedding of mass spectra. When the epoch exceeds 60, the performance does not increase anymore.</p><p id="Par38">Then, with the optimized hyperparameters of the Word2vec model, all the predicted spectra were transformed into low-dimensional embeddings by summing the peak embedding to build the HNSW index for library matching. The measured query spectra were also transformed into low-dimensional embeddings using the trained Word2vec model to match the library through the HNSW index.</p></sec><sec id="Sec16"><title>HNSW-based spectrum matching</title><p id="Par39">HNSW is an ANNS method based on the hierarchical graph structure and the graph traversal method. HNSW indices have no learnable parameters and do not need to be trained with data. Essentially, the HNSW index is an efficient data structure (the hierarchically multi-layer graph) to store and organize data. It can be used to improve the speed of ANNS significantly. Traditional spectrum matching methods need to calculate the similarities between the query spectrum vector and all the spectral vectors in a library. They can be calculated by the Euclidean distance between two normalized vectors using faiss.IndexFlatL2<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The spectrum matching time of these methods is acceptable for experimental libraries with hundreds of thousands of spectra. But for <italic>in-silico</italic> libraries with millions of spectra, the spectrum matching time grows significantly and affects the efficiency of compound identification. The ANNS methods are good solutions to improve the spectrum matching efficiency for large libraries. They relax the exact solution of NNS by allowing a small number of errors. The ANNS methods accelerate the spectrum matching process by efficient indexing techniques, such as locality-sensitive hashing (LSH)<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>, space partition (tree)<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>, and graph traversal<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR50">50</xref></sup>. Essentially, these indexing techniques are highly efficient approaches to retrieving candidates similar to the query spectrum. Then, the squared L2 norm is calculated only between the query spectrum and these candidates. If the indexing method is good enough, the results based on these candidates will be almost as good as those based on all the spectra in the library. Here, HNSW was chosen because of its fast speed, excellent recall rate, and high-quality implementations.</p><p id="Par40">Building an index and searching with the index are two necessary steps for an ANNS-based spectrum matching method. To build an HNSW index, two most important techniques, the probability skip list and the navigable small-world graphs (NSW), are commonly used. The probability skip list consists of several additional layers of linked lists built upon an original linked list. The layers to add elements are randomly selected with an exponentially decaying probability distribution. NSW is a proximity graph with both long-range and short-range links. Due to using the greedy routing algorithm, the searching time of NSW is polylogarithmic complexity. The HNSW method can be obtained by replacing the linked lists in the probability skip list with proximity graphs, and it can also be regarded as the introduction of hierarchy into NSW. The hierarchically multi-layer graph architecture of HNSW is shown in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>. For a spectral vector s to be added into HNSW with <italic>L</italic> + <italic>1</italic> layers, its layer level <italic>l</italic> is randomly selected with an exponentially decaying probability distribution. A <italic>search-layer</italic> algorithm is implemented to find <italic>ef</italic> (size of the dynamic candidate list) nearest neighbors to s. It starts at the top layer (layer <italic>L</italic>) and ends until reaching the local minimum of a layer. Then, it moves down to the next layer and performs a similar search procedure with the nearest neighbor of the previous layer as an entry point. This process is repeated until reaching layer <italic>l</italic> + 1. From layer<italic>l</italic>to layer 0, the vector s will be added to each layer. More nearest neighbors can be obtained by increasing the <italic>ef</italic> parameter in the <italic>search-layer</italic> algorithm from 1 to <italic>efConstruction</italic>. After adding s to this layer, <italic>M</italic> nearest neighbors to s will establish bidirectional links with s. The above addition process is repeated until layer 0. Then, the vector s is successfully added to HNSW. The above steps are repeated for each spectral vector in the spectral library to add them to HNSW. After adding all spectral vectors, the HNSW index of this spectral library is built. With the built index, the nearest neighbors to the query spectral vector q can be found efficiently. From layer <italic>L</italic> to layer 1, each layer is searched by the <italic>search-layer</italic> algorithm with <italic>ef</italic> <bold>=</bold> 1, and the nearest neighbor in the previous layer is used as the entry point for the next layer. For layer 0, it is searched by the <italic>search-layer</italic> algorithm with <italic>ef</italic> set by users, and <italic>K</italic> nearest neighbors in the dynamic candidate list are returned as results.</p><p id="Par41">With 500 elements in each spectral embedding and more than two million spectra in the <italic>in-silico</italic> library, the <italic>efConstruction</italic> was set to 600. The other parameters <italic>(M, ef)</italic> are determined by the results shown in Supplementary Fig. <xref ref-type="supplementary-material" rid="MOESM1">8</xref>. The HNSW index of FastEI was created by spectral embeddings of the <italic>in-silico</italic> library using hnswlib (<ext-link xlink:href="https://github.com/nmslib/hnswlib" ext-link-type="uri">https://github.com/nmslib/hnswlib</ext-link>) with <italic>M</italic> <bold>=</bold> 64, <italic>efConstruction</italic> <bold>=</bold> <italic>600</italic>, and <italic>ef</italic> <bold>=</bold> 300.</p></sec><sec id="Sec17"><title>Reporting summary</title><p id="Par42">Further information on research design is available in the <xref ref-type="supplementary-material" rid="MOESM3">Nature Portfolio Reporting Summary</xref> linked to this article.</p></sec></sec></body><back><ack><title>Acknowledgements</title><p>This work is financially supported by the National Natural Science Foundation of China (21873116, 22273120, and 21675174) to H.L.. We are grateful for resources from the High-Performance Computing Center of Central South University.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>Q.Y., H.J., H.L., and Z.Z. conceived the idea and designed the database and software. Z.X., Y.L., P.W., and J.S. performed the sample preparation, data acquisition and data processing. X.F. and H.Z. performed the data analysis. Q.Y., Z.Z., Z.X., and H.L. tested and debugged the program. Q.Y. and H.J. contributed to part of codes. Q.Y., H.J., H.L., and Z.Z. wrote the manuscript. H.L. and Z.Z. supervised the project.</p></sec><sec sec-type="peer-review"><title>Peer review</title><sec id="FPar1"><title>Peer review information</title><p id="Par43"><italic>Nature Communications</italic> thanks Jennifer Wei and Xiaojian Wang, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p></sec></sec><sec sec-type="data-availability"><title>Data availability</title><p>The <italic>in-silico</italic> spectral library, the Word2vec model, and the index file generated in this study have been deposited in the Zenodo database under accession code <ext-link xlink:href="https://zenodo.org/record/7476120" ext-link-type="uri">7476120</ext-link>. <xref rid="Sec18" ref-type="sec">Source data</xref> are provided with this paper.</p></sec><sec sec-type="data-availability"><title>Code availability</title><p>All code of FastEI is released under the Apache 2.0 license at <ext-link xlink:href="https://github.com/Qiong-Yang/FastEI" ext-link-type="uri">https://github.com/Qiong-Yang/FastEI</ext-link>. This repository includes detailed instructions on how to install and run FastEI<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>.</p></sec><sec sec-type="ethics-statement"><sec id="FPar2" sec-type="COI-statement"><title>Competing interests</title><p id="Par44">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boiko</surname><given-names>DA</given-names></name><name><surname>Kozlov</surname><given-names>KS</given-names></name><name><surname>Burykina</surname><given-names>JV</given-names></name><name><surname>Ilyushenkova</surname><given-names>VV</given-names></name><name><surname>Ananikov</surname><given-names>VP</given-names></name></person-group><article-title xml:lang="en">Fully automated unconstrained analysis of high-resolution mass spectrometry data with machine learning</article-title><source>J. Am. Chem. Soc.</source><year>2022</year><volume>144</volume><fpage>14590</fpage><lpage>14606</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB38XitVCrs73O</pub-id><pub-id pub-id-type="pmid">35939718</pub-id><pub-id pub-id-type="doi">10.1021/jacs.2c03631</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuo</surname><given-names>T</given-names></name><name><surname>Tsugawa</surname><given-names>H</given-names></name><name><surname>Miyagawa</surname><given-names>H</given-names></name><name><surname>Fukusaki</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Integrated strategy for unknown EI-MS identification using quality control calibration curve, multivariate analysis, EI-MS spectral database, and retention index prediction</article-title><source>Anal. Chem.</source><year>2017</year><volume>89</volume><fpage>6766</fpage><lpage>6773</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXotVGnt7o%3D</pub-id><pub-id pub-id-type="pmid">28520403</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.7b01010</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimme</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Towards first principles calculation of electron impact mass spectra of molecules</article-title><source>Angew. Chem. Int. Ed.</source><year>2013</year><volume>52</volume><fpage>6306</fpage><lpage>6312</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXmslegt7s%3D</pub-id><pub-id pub-id-type="doi">10.1002/anie.201300158</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Thiessen</surname><given-names>PA</given-names></name><name><surname>Bolton</surname><given-names>EE</given-names></name><name><surname>Bryant</surname><given-names>SH</given-names></name></person-group><article-title xml:lang="en">PUG-SOAP and PUG-REST: web services for programmatic access to chemical information in PubChem</article-title><source>Nucl. Acids Res.</source><year>2015</year><volume>43</volume><fpage>W605</fpage><lpage>W611</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhtVymtbrE</pub-id><pub-id pub-id-type="pmid">25934803</pub-id><pub-id pub-id-type="pmcid">4489244</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkv396</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendez</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">ChEMBL: towards direct deposition of bioassay data</article-title><source>Nucl. Acids Res</source><year>2019</year><volume>47</volume><fpage>D930</fpage><lpage>D940</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhs1Gqtr%2FF</pub-id><pub-id pub-id-type="pmid">30398643</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky1075</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Mass spectral reference libraries: an ever-expanding resource for chemical identification</article-title><source>Anal. Chem.</source><year>2012</year><volume>84</volume><fpage>7274</fpage><lpage>7282</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XptFSrt7c%3D</pub-id><pub-id pub-id-type="pmid">22803687</pub-id><pub-id pub-id-type="doi">10.1021/ac301205z</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>F</given-names></name><name><surname>Pon</surname><given-names>A</given-names></name><name><surname>Greiner</surname><given-names>R</given-names></name><name><surname>Wishart</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Computational prediction of electron ionization mass spectra to assist in GC/MS compound identification</article-title><source>Anal. Chem.</source><year>2016</year><volume>88</volume><fpage>7689</fpage><lpage>7697</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhtFWiu7bE</pub-id><pub-id pub-id-type="pmid">27381172</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.6b01622</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>JN</given-names></name><name><surname>Belanger</surname><given-names>D</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Sculley</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Rapid prediction of electron–ionization mass spectrometry using neural networks</article-title><source>ACS Cent. Sci.</source><year>2019</year><volume>5</volume><fpage>700</fpage><lpage>708</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXltVCgu7s%3D</pub-id><pub-id pub-id-type="pmid">31041390</pub-id><pub-id pub-id-type="pmcid">6487538</pub-id><pub-id pub-id-type="doi">10.1021/acscentsci.9b00085</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLafferty</surname><given-names>FW</given-names></name><name><surname>Hertel</surname><given-names>RH</given-names></name><name><surname>Villwock</surname><given-names>RD</given-names></name></person-group><article-title xml:lang="en">Probability based matching of mass spectra. rapid identification of specific compounds in mixtures</article-title><source>Org. Mass Spectrom.</source><year>1974</year><volume>9</volume><fpage>690</fpage><lpage>702</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaE2MXmsl2isA%3D%3D</pub-id><pub-id pub-id-type="doi">10.1002/oms.1210090710</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>SE</given-names></name><name><surname>Scott</surname><given-names>DR</given-names></name></person-group><article-title xml:lang="en">Optimization and testing of mass spectral library search algorithms for compound identification</article-title><source>J. Am. Soc. Mass Spectrom.</source><year>1994</year><volume>5</volume><fpage>859</fpage><lpage>866</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2MXhtFGhsLk%3D</pub-id><pub-id pub-id-type="pmid">24222034</pub-id><pub-id pub-id-type="doi">10.1016/1044-0305(94)87009-8</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gangnon</surname><given-names>RE</given-names></name><name><surname>Clayton</surname><given-names>MK</given-names></name></person-group><article-title xml:lang="en">A weighted average likelihood ratio test for spatial clustering of disease</article-title><source>Stat. Med.</source><year>2001</year><volume>20</volume><fpage>2977</fpage><lpage>2987</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BD3Mrit1Khug%3D%3D</pub-id><pub-id pub-id-type="pmid">11568953</pub-id><pub-id pub-id-type="doi">10.1002/sim.917</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moorthy</surname><given-names>AS</given-names></name><etal/></person-group><article-title xml:lang="en">Combining fragment-ion and neutral-loss matching during mass spectral library searching: a new general purpose algorithm applicable to illicit drug identification</article-title><source>Anal. Chem.</source><year>2017</year><volume>89</volume><fpage>13261</fpage><lpage>13268</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhvVars7bN</pub-id><pub-id pub-id-type="pmid">29156120</pub-id><pub-id pub-id-type="pmcid">5841953</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.7b03320</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matyushin</surname><given-names>DD</given-names></name><name><surname>Sholokhova</surname><given-names>AY</given-names></name><name><surname>Buryak</surname><given-names>AK</given-names></name></person-group><article-title xml:lang="en">Deep learning driven GC-MS library search and its application for metabolomics</article-title><source>Anal. Chem.</source><year>2020</year><volume>92</volume><fpage>11818</fpage><lpage>11825</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXhsFOgtr7J</pub-id><pub-id pub-id-type="pmid">32867500</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.0c02082</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malkov</surname><given-names>YA</given-names></name><name><surname>Yashunin</surname><given-names>DA</given-names></name></person-group><article-title xml:lang="en">Efficient and robust approximate nearest neighbor search using hierarchical navigable small world graphs</article-title><source>IEEE Trans. Pattern Anal. Mach. Intell.</source><year>2020</year><volume>42</volume><fpage>824</fpage><lpage>836</lpage><pub-id pub-id-type="pmid">30602420</pub-id><pub-id pub-id-type="doi">10.1109/TPAMI.2018.2889473</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byeong-Soo</surname><given-names>J</given-names></name><name><surname>Omiecinski</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Inverted file partitioning schemes in multiple disk systems</article-title><source>IEEE Trans. Parallel Distrib. Syst.</source><year>1995</year><volume>6</volume><fpage>142</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1109/71.342125</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Datar, M., Immorlica, N., Indyk, P. &amp; Mirrokni, V. S. Locality-sensitive hashing scheme based on p-stable distributions. <italic>Proceedings of the Twentieth Annual Symposium on Computational Geometry</italic>. 253–262 (2004).</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jégou</surname><given-names>H</given-names></name><name><surname>Douze</surname><given-names>M</given-names></name><name><surname>Schmid</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Product quantization for nearest neighbor search</article-title><source>IEEE Trans. Pattern Anal. Mach. Intell.</source><year>2011</year><volume>33</volume><fpage>117</fpage><lpage>128</lpage><pub-id pub-id-type="pmid">21088323</pub-id><pub-id pub-id-type="doi">10.1109/TPAMI.2010.57</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendez</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">ChEMBL: a large-scale bioactivity database for drug discovery</article-title><source>Nucl. Acids Res.</source><year>2012</year><volume>40</volume><fpage>D1100</fpage><lpage>D1107</lpage><pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feunang</surname><given-names>YD</given-names></name></person-group><article-title xml:lang="en">ClassyFire: automated chemical classification with a comprehensive, computable taxonomy</article-title><source>J. Cheminform.</source><year>2016</year><volume>8</volume><fpage>1</fpage><lpage>20</lpage></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name><etal/></person-group><article-title xml:lang="en">Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nat. Biotechnol.</source><year>2019</year><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXitl2isbrN</pub-id><pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform manifold approximation and projection for dimension reduction. arXiv:1802.03426 [cs, stat] (2020).</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Landrum, G. RDKit: A software suite for cheminformatics, computational chemistry, and predictive modeling. <italic>Greg Landrum</italic><bold>8</bold>, (2013).</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alseekh</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Mass spectrometry-based metabolomics: a guide for annotation, quantification and best reporting practices</article-title><source>Nat. Methods</source><year>2021</year><volume>18</volume><fpage>747</fpage><lpage>756</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3MXhsFahs7fF</pub-id><pub-id pub-id-type="pmid">34239102</pub-id><pub-id pub-id-type="pmcid">8592384</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01197-1</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zushi</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Direct prediction of physicochemical properties and toxicities of chemicals from analytical descriptors by GC–MS</article-title><source>Anal. Chem.</source><year>2022</year><volume>94</volume><fpage>9149</fpage><lpage>9157</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB38XhsFSisLnK</pub-id><pub-id pub-id-type="pmid">35700270</pub-id><pub-id pub-id-type="pmcid">9246259</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.2c01667</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thathagar</surname><given-names>MB</given-names></name><name><surname>Beckers</surname><given-names>J</given-names></name><name><surname>Rothenberg</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Palladium-free and ligand-free sonogashira cross-coupling</article-title><source>Green. Chem.</source><year>2004</year><volume>6</volume><fpage>215</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXkvFajsrs%3D</pub-id><pub-id pub-id-type="doi">10.1039/b401586j</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gnanaprakasam</surname><given-names>B</given-names></name><name><surname>Balaraman</surname><given-names>E</given-names></name><name><surname>Ben-David</surname><given-names>Y</given-names></name><name><surname>Milstein</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Synthesis of peptides and pyrazines from β-Amino alcohols through extrusion of H2 catalyzed by ruthenium pincer complexes: ligand-controlled selectivity</article-title><source>Angew. Chem.</source><year>2011</year><volume>123</volume><fpage>12448</fpage><lpage>12452</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2011AngCh.12312448G</pub-id><pub-id pub-id-type="doi">10.1002/ange.201105876</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okonye</surname><given-names>LU</given-names></name><name><surname>Jalama</surname><given-names>K</given-names></name><name><surname>Hosaka</surname><given-names>A</given-names></name><name><surname>Watanabe</surname><given-names>C</given-names></name><name><surname>Meijboom</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Rapid online fischer-tropsch reaction monitoring using a modified frontier tandem micro-reactor GC-MS system: rapid on-line FT reaction monitoring using GC/MS</article-title><source>Environ. Prog. Sustain. Energy</source><year>2019</year><volume>38</volume><fpage>13079</fpage><pub-id pub-id-type="doi">10.1002/ep.13079</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>H</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">Deep MS/MS-aided structural-similarity scoring for unknown metabolite identification</article-title><source>Anal. Chem.</source><year>2019</year><volume>91</volume><fpage>5629</fpage><lpage>5637</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXnsV2qsLg%3D</pub-id><pub-id pub-id-type="pmid">30990670</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.8b05405</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="other">Mikolov, T., Sutskever, I., Chen, K., Corrado, G. S. &amp; Dean, J. Distributed representations of words and phrases and their compositionality. <italic>NIPS</italic>. <bold>26</bold> (2013).</mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>F</given-names></name><etal/></person-group><article-title xml:lang="en">Spec2Vec: Improved mass spectral similarity scoring through learning of structural relationships</article-title><source>PLoS Comput Biol.</source><year>2021</year><volume>17</volume><fpage>e1008724</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3MXls1Grtb0%3D</pub-id><pub-id pub-id-type="pmid">33591968</pub-id><pub-id pub-id-type="pmcid">7909622</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008724</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wishart</surname><given-names>DS</given-names></name><etal/></person-group><article-title xml:lang="en">HMDB: the human metabolome database</article-title><source>Nucl. Acids Res.</source><year>2007</year><volume>35</volume><fpage>D521</fpage><lpage>D526</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXivFKhtA%3D%3D</pub-id><pub-id pub-id-type="pmid">17202168</pub-id><pub-id pub-id-type="pmcid">1899095</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkl923</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saikia</surname><given-names>I</given-names></name><name><surname>Borah</surname><given-names>AJ</given-names></name><name><surname>Phukan</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Use of Bromine and bromo-organic compounds in organic synthesis</article-title><source>Chem. Rev.</source><year>2016</year><volume>116</volume><fpage>6837</fpage><lpage>7042</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28Xot1ertb8%3D</pub-id><pub-id pub-id-type="pmid">27199233</pub-id><pub-id pub-id-type="doi">10.1021/acs.chemrev.5b00400</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Phenylbutazone, a new long-acting agent that can improve the peptide pharmacokinetic based on serum albumin as a drug carrier</article-title><source>Chem. Biol. Drug Des.</source><year>2016</year><volume>87</volume><fpage>936</fpage><lpage>945</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XivVWnt7w%3D</pub-id><pub-id pub-id-type="pmid">26808199</pub-id><pub-id pub-id-type="doi">10.1111/cbdd.12726</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">Toll-Like receptor 7 inactive ligands enhanced cytokine induction by conjugation to weak antigens</article-title><source>ChemMedChem</source><year>2015</year><volume>10</volume><fpage>977</fpage><lpage>980</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXmsF2hu7o%3D</pub-id><pub-id pub-id-type="pmid">25882779</pub-id><pub-id pub-id-type="doi">10.1002/cmdc.201500088</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><etal/></person-group><article-title xml:lang="en">A light-scattering co-adsorbent for performance improvement of dye-sensitized solar cells</article-title><source>Electrochim. Acta</source><year>2016</year><volume>194</volume><fpage>67</fpage><lpage>73</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XivFKksrg%3D</pub-id><pub-id pub-id-type="doi">10.1016/j.electacta.2016.02.070</pub-id></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Q-L</given-names></name><name><surname>Xu</surname><given-names>Q</given-names></name></person-group><article-title xml:lang="en">Metal–organic framework composites</article-title><source>Chem. Soc. Rev.</source><year>2014</year><volume>43</volume><fpage>5468</fpage><lpage>5512</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXht1Slu7jE</pub-id><pub-id pub-id-type="pmid">24638055</pub-id><pub-id pub-id-type="doi">10.1039/C3CS60472A</pub-id></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>Y</given-names></name><etal/></person-group><article-title xml:lang="en">Pore space partition within a metal–organic framework for highly efficient C2H2 /CO2 separation</article-title><source>J. Am. Chem. Soc.</source><year>2019</year><volume>141</volume><fpage>4130</fpage><lpage>4136</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXjsVeltro%3D</pub-id><pub-id pub-id-type="pmid">30793890</pub-id><pub-id pub-id-type="doi">10.1021/jacs.9b00232</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arzhakov</surname><given-names>MS</given-names></name><name><surname>Volkov</surname><given-names>AV</given-names></name><name><surname>Volynskii</surname><given-names>AL</given-names></name><name><surname>Bakeyev</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">ON peculiarities of the influence of oxyaromatic compounds on physico-mechanical properties of nylons</article-title><source>Makromol. Chem. Macromol. Symp.</source><year>1991</year><volume>44</volume><fpage>165</fpage><lpage>174</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3MXls1Sntrc%3D</pub-id><pub-id pub-id-type="doi">10.1002/masy.19910440117</pub-id><comment>Ph</comment></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brand</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Fast low-rank modifications of the thin singular value decomposition</article-title><source>Linear Algebra Appl.</source><year>2006</year><volume>415</volume><fpage>20</fpage><lpage>30</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2214744</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1088.65037</pub-id><pub-id pub-id-type="doi">10.1016/j.laa.2005.07.021</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>O</given-names></name><name><surname>Goldberg</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Dependency-based word embeddings</article-title><source>Proc. 52nd Annu. Meet. Assoc. Comput. Linguist.</source><year>2014</year><volume>2</volume><fpage>302</fpage><lpage>308</lpage></mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>J</given-names></name><name><surname>Douze</surname><given-names>M</given-names></name><name><surname>Jegou</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Billion-ccale similarity search with GPUs</article-title><source>IEEE Trans. Big Data</source><year>2021</year><volume>7</volume><fpage>535</fpage><lpage>547</lpage><pub-id pub-id-type="doi">10.1109/TBDATA.2019.2921572</pub-id></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Andoni, A., Indyk, P., Laarhoven, T., Razenshteyn, I. &amp; Schmidt, L. Practical and optimal LSH for angular distance. arXiv:1509.02897 [cs] (2015).</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Indyk, P. &amp; Motwani, R. Approximate nearest neighbors: towards removing the curse of dimensionality. <italic>Proceedings of the Thirtieth Annual ACM Symposium on Theory Of Computing</italic>. 604–613 (1998).</mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muja</surname><given-names>M</given-names></name><name><surname>Lowe</surname><given-names>DG</given-names></name></person-group><article-title xml:lang="en">Scalable nearest neighbor algorithms for high dimensional data</article-title><source>IEEE Trans. Pattern Anal. Mach. Intell.</source><year>2014</year><volume>36</volume><fpage>2227</fpage><lpage>2240</lpage><pub-id pub-id-type="pmid">26353063</pub-id><pub-id pub-id-type="doi">10.1109/TPAMI.2014.2321376</pub-id></mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houle</surname><given-names>ME</given-names></name><name><surname>Nett</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Rank-based similarity search: reducing the dimensional dependence</article-title><source>IEEE Trans. Pattern Anal. Mach. Intell.</source><year>2015</year><volume>37</volume><fpage>136</fpage><lpage>150</lpage><pub-id pub-id-type="pmid">26353214</pub-id><pub-id pub-id-type="doi">10.1109/TPAMI.2014.2343223</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="other">Wang, J. et al. Fast neighborhood graph search using cartesian concatenation. <italic>2013 IEEE International Conference on Computer Vision</italic>. 2128–2135 (2013).</mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chávez</surname><given-names>E</given-names></name><name><surname>Sadit Tellez</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Navigating K-nearest neighbor graphs to solve nearest neighbor searches</article-title><source>Adv. Pattern Recognit.: Second Mexican Conf. Pattern Recognit., MCPR 2010, Puebla, Mex., September 27-29, 2010. Proc.</source><year>2010</year><volume>6256</volume><fpage>270</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-15992-3_29</pub-id></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="other">Aoyama, K., Saito, K., Sawada, H. &amp; Ueda, N. Fast approximate similarity search based on degree-reduced neighborhood graphs. <italic>Proceedings of the 17th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining - KDD ’11</italic>. 1055-1063 (2011).</mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malkov</surname><given-names>Y</given-names></name><name><surname>Ponomarenko</surname><given-names>A</given-names></name><name><surname>Logvinov</surname><given-names>A</given-names></name><name><surname>Krylov</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Scalable distributed algorithm for approximate nearest neighbor search problem in high dimensional general metric spaces</article-title><source>Similarity Search Appl. 5th Int. Conf.</source><year>2012</year><volume>7404</volume><fpage>132</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-32153-5_10</pub-id></mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malkov</surname><given-names>Y</given-names></name><name><surname>Ponomarenko</surname><given-names>A</given-names></name><name><surname>Logvinov</surname><given-names>A</given-names></name><name><surname>Krylov</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Approximate nearest neighbor algorithm based on navigable small world graphs</article-title><source>Inform. Syst.</source><year>2014</year><volume>45</volume><fpage>61</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/j.is.2013.10.006</pub-id></mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="other">Qiong, Y. et al. Ultra-fast and accurate electron ionization mass spectrum matching for compound identification with million-scale in-silico library. Qiong-Yang/FastEI: FastEI (Release). Zenodo <ext-link xlink:href="10.5281/zenodo.7907140" ext-link-type="doi">https://doi.org/10.5281/zenodo.7907140</ext-link> (2023).</mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec18"><title>Supplementary information</title><p id="Par45"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41467_2023_39279_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary Information</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41467_2023_39279_MOESM2_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Peer Review File</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41467_2023_39279_MOESM3_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Reporting Summary</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41467_2023_39279_MOESM4_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Description of Additional Supplementary Files</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Supplementary information"><media mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="MediaObjects/41467_2023_39279_MOESM5_ESM.xlsx" position="anchor"><caption xml:lang="en"><p>Supplementary Data 1</p></caption></media></supplementary-material></p></sec><sec id="Sec19"><title>Source data</title><p id="Par46"><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Source data"><media mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="MediaObjects/41467_2023_39279_MOESM6_ESM.xlsx" position="anchor"><caption xml:lang="en"><p>Source Data</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1038/s41467-023-39279-7" ext-link-type="doi">https://doi.org/10.1038/s41467-023-39279-7</ext-link>.</p></notes><notes notes-type="Misc"><p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Nature Communications</facet-value></facet><facet name="year"><facet-value count="1">2023</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
