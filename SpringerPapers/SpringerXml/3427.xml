<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s40565-018-0393-5</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40565</journal-id><journal-title-group><journal-title>Journal of Modern Power Systems and Clean Energy</journal-title><abbrev-journal-title abbrev-type="publisher">J. Mod. Power Syst. Clean Energy</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2196-5625</issn><issn pub-type="epub">2196-5420</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40565-018-0393-5</article-id><article-id pub-id-type="manuscript">393</article-id><article-id pub-id-type="doi">10.1007/s40565-018-0393-5</article-id><article-categories><subj-group subj-group-type="heading"><subject>Special Section on Forecasting in Modern Power Systems</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Photovoltaic yield prediction using an irradiance forecast model based on multiple neural networks</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>DURRANI</surname><given-names>Saad Parvaiz</given-names></name><address><email>saadpd@mail.uni-paderborn.de</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec><title>Saad Parvaiz DURRANI</title><p id="Par1">received his Master degree at Paderborn University in Electrical Systems Engineering. In his Master’s thesis he investigated photovoltaic yield predictions and forecasting of photovoltaic power generation. After graduating from Paderborn University in 2017 he is now working at Hanwha Q CELLS GmbH as specialist in processing technology.</p></sec></bio></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1189-851X</contrib-id><name><surname>BALLUFF</surname><given-names>Stefan</given-names></name><address><email>stefan.balluff@upb.de</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4056501803935_cor2">b</xref><bio><sec><title>Stefan BALLUFF</title><p id="Par2">is a scientific researcher and Ph.D. candidate at Paderborn University. His research topic includes meteorological forecasting for the offshore wind energy industry. He studied Information Technology at Paderborn University, graduating in 2012, and has worked in the offshore wind industry before starting his Ph.D. research in 2015.</p></sec></bio></contrib><contrib contrib-type="author" id="Au3"><name><surname>WURZER</surname><given-names>Lukas</given-names></name><address><email>lukas.wurzer@de.bosch.com</email></address><xref ref-type="aff" rid="Aff2">2</xref><bio><sec><title>Lukas WURZER</title><p id="Par3">works at Bosch Thermotechnik in Wernau, Germany, developing software and hardware for the photovoltaic industry. His fields of work and research are divided into photovoltaic specific devices like micro inverters and software and algorithms for control tasks.</p></sec></bio></contrib><contrib contrib-type="author" id="Au4"><name><surname>KRAUTER</surname><given-names>Stefan</given-names></name><address><email>stefan.krauter@upb.de</email></address><xref ref-type="aff" rid="Aff1">1</xref><bio><sec><title>Stefan KRAUTER</title><p id="Par4">is chair of the Electrical Energy Technology and Sustainable Energy Concepts department of Paderborn University, where research covers the area of renewable energy, photovoltaic energy in detail, smart grids and storage systems. He is technical lead of the department’s outdoor laboratory including photovoltaic and meteorological measurements.</p></sec></bio></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0940 2872</institution-id><institution-id institution-id-type="GRID">grid.5659.f</institution-id><institution content-type="org-name">Paderborn University</institution></institution-wrap><addr-line content-type="street">Warburger Str. 98</addr-line><addr-line content-type="postcode">33098</addr-line><addr-line content-type="city">Paderborn</addr-line><country country="DE">Germany</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0553 2276</institution-id><institution-id institution-id-type="GRID">grid.6584.f</institution-id><institution content-type="org-name">Bosch Thermotechnik GmbH</institution></institution-wrap><addr-line content-type="street">Junkerstrasse 20</addr-line><addr-line content-type="postcode">73249</addr-line><addr-line content-type="city">Wernau</addr-line><country country="DE">Germany</country></aff></contrib-group><author-notes><corresp id="IDs4056501803935_cor2"><label>b</label><email>stefan.balluff@upb.de</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>5</day><month>3</month><year>2018</year></pub-date><pub-date date-type="pub" publication-format="print"><month>3</month><year>2018</year></pub-date><volume>6</volume><issue seq="7">2</issue><issue-title>Special Issue: Special Section on Forecasting in Modern Power Systems</issue-title><fpage>255</fpage><lpage>267</lpage><history><date date-type="registration"><day>5</day><month>2</month><year>2018</year></date><date date-type="received"><day>30</day><month>6</month><year>2017</year></date><date date-type="accepted"><day>9</day><month>1</month><year>2018</year></date><date date-type="online"><day>5</day><month>3</month><year>2018</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2018</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par5">In order to develop predictive control algorithms for efficient energy management and monitoring for residential grid connected photovoltaic systems, accurate and reliable photovoltaic (PV) power forecasts are required. A PV yield prediction system is presented based on an irradiance forecast model and a PV model. The PV power forecast is obtained from the irradiance forecast using the PV model. The proposed irradiance forecast model is based on multiple feed-forward neural networks. The global horizontal irradiance forecast has a mean absolute percentage error of 3.4% on a sunny day and 23% on a cloudy day for Stuttgart. PV power forecasts based on the neural network irradiance forecast have performed much better than the PV power persistence forecast model.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Grid connected photovoltaic (GCPV)</kwd><kwd>Photovoltaic (PV)</kwd><kwd>PV power prediction</kwd><kwd>Irradiance forecast</kwd><kwd>Neural network (NN)</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>18</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>5</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40565_2018_Article_393.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>SC17</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="Misc"><p>CrossCheck date: 9 January 2018</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par6">Photovoltaic (PV) systems convert the radiation coming from the Sun to the Earth’s surface into electricity. Nowadays, PV systems are popular because they are pollution free, noise-free, reliable and durable. Due to global climate change, declining costs and financial incentives by governments for PV systems, the tendency of integrating photovoltaic systems into the grid has increased in the last decades. The high penetration of energy from PV systems makes smart grid management more challenging.</p><p id="Par7">PV power generation depends upon meteorological conditions. When the weather is sunny, the power generated by the PV system is high; when the weather is partly cloudy or cloudy, it is low. Therefore, PV power generation is uncertain, intermittent and variable. In order to manage the uncertain and variable power generation by PV systems, PV power forecasts are used by grid operators for smart grid management. Transmission system operators also use PV power forecasts for grid maintenance scheduling. In this research, our motivation is to use PV power forecasts for energy monitoring and management for residential grid connected PV systems. The paper is divided into ten sections.</p><p id="Par8">We have developed a daily PV power forecast model for monitoring and managing residential grid connected PV systems considering limitations of feed in tariff. In Germany, public funding of feed in tariffs for PV system is going to be decreased in the next few years. Photovoltaic systems will not be allowed to feed in more than 70% of their maximum power generation. This limit is even lower for PV systems with batteries. The main objectives of this policy are to ensure grid stability and to promote self-consumption of energy produced by grid connected PV systems. To achieve this on days when the power generation will exceed the feed-in limitation, a controller shall be able to adjust and shift residential loads and manage battery charging based on the day ahead PV power forecast. For this reason, it is necessary to have an accurate and reliable PV yield prediction over at least 24 hours.</p><p id="Par9">In Section <xref rid="Sec2" ref-type="sec">2</xref>, state of the art PV yield prediction methodology is reviewed. In Section <xref rid="Sec3" ref-type="sec">3</xref>, the new PV yield prediction methodology is proposed. The measures of accuracy used for evaluation and verification of the PV power global horizontal irradiance forecast are presented in Section <xref rid="Sec4" ref-type="sec">4</xref>. The meteorological data from Deustcher Wetterdienst used for forecasting the PV power and irradiance are discussed in Section <xref rid="Sec5" ref-type="sec">5</xref>. In Section <xref rid="Sec6" ref-type="sec">6</xref>, an irradiance forecast model based on neural network technology is presented. Feed forward neural network architecture is presented in Section <xref rid="Sec7" ref-type="sec">7</xref>. In Section <xref rid="Sec11" ref-type="sec">8</xref>, a PV model is presented which is used to convert an irradiance forecast into a PV power forecast. In Section <xref rid="Sec17" ref-type="sec">9</xref>, irradiance forecast and PV power forecast results and figures are presented. Finally, Section 10 concludes this paper.</p></sec><sec id="Sec2"><title>State of the art photovoltaic yield prediction review </title><p id="Par10">Solar irradiance forecasts are important for solar resource assesment and management of energy demand. To encourage the solar forecasting development suitable for smart grid technologies and renewable integration, the Global Energy Forecasting Competition (GEFCom) was conducted by a team led by Dr. Tao Hong in 2012 and 2014 [<xref ref-type="bibr" rid="CR1">1</xref>]. The techniques presented in these competitions were based on probabilistic forecasting. In this research, we present an artificial neural network (ANN) for forecasting irradiance, and particularly global horizontal irradiance. The reason for using an ANN is that they can learn meteorological conditions from the historic meteorological data and have better accuracy compared to conventional forecasting techniques. ANNs can determine the complex relationships among the dependent and independent variables and have the ability to solve nonlinear problems. But before presenting the methodology proposed for the irradiance forecast model, we outline the research done so far for forecasting irradiance using neural network approaches.</p><p id="Par11">In [<xref ref-type="bibr" rid="CR2">2</xref>] the authors used the air temperature and relative humidity as predictors for daily forecasting of the irradiance in (<inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mi mathvariant="normal">kWh</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">day</mml:mi></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {kWh/m^2/day}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq1.gif"/></alternatives></inline-formula>) for Saudi Arabia using a feed forward neural network. They used four years of historic meteorological data (1998–2002) for training the network using the back propagation algorithm. The forecast model predicted the dayly irradiance with an absolute percentage error of 4.49%, but it lacked the ability to model the day ahead irradiance profile. Moreover, the model was not tested for the entire year because only 240 days in the year 2002 were used for testing.</p><p id="Par12">In [<xref ref-type="bibr" rid="CR3">3</xref>] the authors proposed a the nonlinear auto-regressive neural network for predicting the irradiance at Sepang. They set the training sample size to 80%, validation sample size to 10% and testing sample size to 10% of one-year of historical global horizontal irradiance data. The number of neurons was set to 20 in the hidden layer and there were 20 delays on the predictor side. They achieved normalized mean square error of <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mrow><mml:mn>16.51</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$16.51 \times 10^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq2.gif"/></alternatives></inline-formula> in Jan-March, <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:mn>5.871</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.871\times 10^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq3.gif"/></alternatives></inline-formula> in Apr-Jun, <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:mn>18.24</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$18.24\times 10^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq4.gif"/></alternatives></inline-formula> in Jul-Sep and <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:mn>9.12</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9.12\times 10^{-3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq5.gif"/></alternatives></inline-formula> in Oct-Dec.</p><p id="Par13">Kardaskos and Alexiadis [<xref ref-type="bibr" rid="CR4">4</xref>] proposed two seasonal auto-regressive integrated moving average (SARIMA) models and two artificial neural network models with multiple inputs for forecasting the photovoltaic power at different PV power plants in Greece. Two SARIMA models were compared with the persistence forecast model: a SARIMA model with an exogenous factor predicted the PV power with yearly normalized root mean square error of 12.89%, an improvement of approximately 1% over the SARIMA model without the exogenous factor 13.71%. Neural Network models gave significantly better accuracy with normalized root mean square error of 11.42% and 11.24%. The SARIMA model and neural network model that use solar radiation forecasts as input performed better than other SARIMA and neural network models.</p><p id="Par14">In [<xref ref-type="bibr" rid="CR5">5</xref>] the author presented a multi-regression technique and an Elman backpropagation neural network for the prediction of PV power for various locations in Italy. One year’s data of the PV plant are used for forecasting. Three neural network models were discussed based on different input vectors. The neural network model that includes several meteorological parameters (ambient temperature, module temperature, irradiance at tilt angles of 3 and 15) and PV power as inputs has a lower normalized root mean square error (NRMSE) of 23.99% compared to the other models using fewer weather parameters as inputs (<inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mtext>NRMSE</mml:mtext><mml:mo>=</mml:mo><mml:mn>25.05</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {NRMSE}=25.05\%$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mrow><mml:mtext>NRMSE</mml:mtext><mml:mo>=</mml:mo><mml:mn>24.33</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {NRMSE}=24.33\%$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq7.gif"/></alternatives></inline-formula>).</p><p id="Par15">Mohana Alanazi and Amin Khodaei [<xref ref-type="bibr" rid="CR6">6</xref>] suggested a nonlinear autoregressive neural network with external inputs for the prediction of irradiance. They used 15 years of meterological data, historical global horizontal irradiance data and clear sky irradiance data for training the neural network. Their forecast model achieved a mean absolute percentage error (MAPE) of 9.9%.</p><p id="Par16">Adel Mellit and Massi Pavan [<xref ref-type="bibr" rid="CR7">7</xref>] suggested mean daily irradiance, mean daily air temperature and day of the month as important predictors for day ahead irradiance forecasting in Trieste, Italy. The model achieved a correlation coefficient greater than 98% for sunny days and less than 95% for cloudy days. The author suggests the usage of genetic algorithms in future research for multilayer perceptron forecasts, as this model is slow for forecasting the irradiance.</p><p id="Par17">Alzaharni [<xref ref-type="bibr" rid="CR8">8</xref>] implemented a nonlinear autoregressive exogenous (NARX) model with external inputs for forecasting the global solar radiation using meteorological parameters. The data from 1991 to 2005 for Vichy National Airport in Rolla was used. The model achieved a mean square error ranging from 5.7% to 15.33%.</p><p id="Par18">Christophe Paoli and his team [<xref ref-type="bibr" rid="CR9">9</xref>] demonstrated that their artificial neural network model outperforms ARIMA, Bayesian interference, Markov chains, and K-Nearest Neighbors methods. They utilized 19 years of meteorological station data of Ajaccio for the implementation of their simulator.</p><p id="Par19">M.E El-Hawary and his students [<xref ref-type="bibr" rid="CR10">10</xref>] performed a comparison to determine the selection of predictors (meteorological variables) for their neural network model. Historical data from the Solar Village in Riyadh between 2007 and 2010 were used to examine the influence of seven weather variables. The neural network models achieved accuracies ranging from 3% to 10% depending on the combination of predictors such as ambient temperature, pressure, relative humidity, cloudiness, wind speed and wind direction.</p><p id="Par20">Watetakarn [<xref ref-type="bibr" rid="CR11">11</xref>] presented a forecast of solar irradiation using a feed forward neural network. The inputs to the neural network are one week of historical irradiation data and the average values of weather parameters such as temperature, humidity, rainfall, and average cloud coverage for Thailand. The model achieved mean absolute percentage errors ranging from 3% to 6% for the day ahead prediction.</p><p id="Par21">In research described above, only meteorological data is used for training and testing the neural network forecast models and a single neural network is designed and trained with the meteorological data. Moreover, some researchers used more than five years of meteorological data for training the neural network. Large meteorological data sets are usually unavailable. In this research, the proposed model uses only five years of meteorological data for training the neural network. Due to training with a relatively small meteorological data set, multiple feed-forward neural network models are proposed to avoid the over fitting problem. Moreover, the proposed neural network model also includes three more predictors for forecasting the irradiation: the sun’s zenith angle, azimuth angle, and extraterrestrial irradiation apart from the meteorological data.</p></sec><sec id="Sec3"><title>PV yield prediction methodology</title><p id="Par22">The methodology proposed for predicting the yield of the grid-connected photovoltaic system is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The forecasting of the PV power starts with the prediction of global horizontal irradiance (GHI) and direct irradiance (DI), which are based on a machine learning technique. In this research, two forecast models for irradiation are presented: a irradiance forecast model based on artificial neural networks (multiple feed-forward networks using historical meteorological data and weather forecast data) and another persistence irradiance forecast model. The latter is used as reference forecast model for evaluation and verification of the irradiance forecast based on artificial neural networks. The persistence forecast assumes that the conditions remain as they were the day before [<xref ref-type="bibr" rid="CR12">12</xref>].</p><p id="Par23">After forecasting the global horizontal irradiance and direct irradiance, a PV irradiance model based on the Hay &amp; Davies model (discussed in Section <xref rid="Sec20" ref-type="sec">9.3</xref>) computes the tilted global irradiance. Then we compute global irradiance absorbed by the PV panel. The absorbed irradiance, ambient temperature and wind speed are the inputs for a model which predicts the PV module temperature. A photovoltaic electric model based on the five parameters single diode model computes the DC power generated by the PV panel according to the panel orientation and PV system specifications. Finally, the photovoltaic DC power forecast is obtained.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Photovoltaic yield prediction methodology</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig1_HTML.gif" id="MO1"/></fig></p></sec><sec id="Sec4"><title>Measures of forecast accuracy</title><p id="Par24">In this section, we describe the parameters used for the evaluation of the forecasts. We use mean absolute error (MAE), root mean square error (RMSE), mean absolute percentage error (MAPE), correlation coefficient and skill score for analyzing the accuracy of the global solar irradiance and PV power forecasts.</p><p id="Par25">Let <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq8.gif"/></alternatives></inline-formula> be the target time series and <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq9.gif"/></alternatives></inline-formula> be the forecast time series for a day ahead hourly forecast (<inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=24$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq10.gif"/></alternatives></inline-formula>).<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} MAE=\, &amp; {} \frac{\sum \limits _{i=1}^N |y_i-\widehat{y_i}|}{N} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} MAPE=\, &amp; {} \frac{\sum \limits _{i=1}^N |y_i-\widehat{y_i}|}{N} \times 100\% \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ2.gif"/></alternatives></disp-formula>Smaller values of the MAE and MAPE indicate better forecast accuracy.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} RMSE=\sqrt{\frac{\sum \limits _{i=1}^N \Big (y_i-\widehat{y_i}\Big )^{2}}{N}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ3.gif"/></alternatives></disp-formula></p><p id="Par26">Smaller values of RMSE indicate that the forecast is a closer approximation of the measured value.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R= \frac{\sum \limits _{i=1}^N \Big (y_i-\overline{y}\Big )\Big (\widehat{y_i}-\overline{\widehat{y}}\Big )}{\sqrt{\sum \limits _{i=1}^N \Big (y_i-\overline{y}\Big )^2\sum \limits _{i=1}^N\Big (\widehat{y_i}-\overline{\widehat{y}}\Big )^2}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ4.gif"/></alternatives></disp-formula>The correlation coefficient is defined in the range <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>R</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1 \le R \le 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq11.gif"/></alternatives></inline-formula> as:<list list-type="order"><list-item><p id="Par27">If <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq12.gif"/></alternatives></inline-formula>, then there is a perfect negative linear relationship between <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq14.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par28">If <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq15.gif"/></alternatives></inline-formula>, then there is a perfect positive linear relationship between <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq17.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par29">If <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq18.gif"/></alternatives></inline-formula>, then there is no linear relationship between <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y_i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq20.gif"/></alternatives></inline-formula>.</p></list-item></list></p></sec><sec id="Sec5"><title>Deutscher Wetterdienst (DWD) weather stations</title><p id="Par30">The numerical weather prediction (NWP) forecast of meteorological variables could be used as input to the PV model for PV power prediction, but numerical weather prediction methods are computationally expensive and only a few institutes have this facility. The main idea behind a solar irradiance forecast based on artificial neural network is that they are less computationally expensive compared to NWP methods. Also we could forecast solar resource using open source historical solar irradiance data and meteorological data from the German Weather services (Deutscher Wetterdienst (DWD)). At this first stage of research, an irradiance forecast model for the Stuttgart weather station is examined; the analysis of more areas is planned using interpolation and advanced machine learning techniques. In this research, we use meterological data from the DWD. The meterological data are in the public domain and can be downloaded [<xref ref-type="bibr" rid="CR13">13</xref>]. The irradiance data are available in hourly, daily, monthly and yearly resolution for 56 weather stations in Germany. In addition, data for other meterological parameters e.g. temperature, pressure, cloudiness, also available for different weather stations. Hourly meterological data of variables such as temperature, pressure, relative humidity, wind speed, wind direction, sunshine duration and cloudiness from the Germany Weather Station at Stuttgart are used for training and testing the neural network for forecasting solar irradiance.</p></sec><sec id="Sec6"><title>Irradiance neural network forecast model methodology </title><p id="Par31">The six years of weather data (from 2010 to 2015) are first divided into two subsets. The first subset of five years (from 2010 till 2014) is used for the design and training of the neural network. The second data set of one year (year 2015) is used to test the prediction of the neural network.</p><p id="Par32">The inputs of each neural networks are the meteorological parameters such as date number, temperature, pressure, relative humidity, wind speed, wind direction, sunshine duration, cloudiness, azimuth angle, zenith angle and extraterrestrial solar radiation. The variables such as temperature, pressure, relative humidity, wind speed, wind direction, sunshine duration and cloudiness are obtained from DWD weather data.</p><p id="Par33">The zenith angle, azimuth angle and extra-terrestrial radiation values are calculated using the equations presented in the <xref rid="Sec22" ref-type="sec">Appendix A</xref>.</p><p id="Par34">The data sets are initially pre-processed before feeding to each neural network. In the pre-processing stage, the training data set and test data set are reduced by removing the night time hours because solar radiation at night time is zero. The data sets are then normalized into a range [0, 1] using:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_N= \frac{X-X_{\mathrm {min}}}{X_{\mathrm {max}}-X_{\mathrm {min}}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ5.gif"/></alternatives></disp-formula>The data sets are normalized because artificial neural networks work with data values in the range of <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[-1, 1]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq21.gif"/></alternatives></inline-formula>. After normalization, the training data are fed into multiple neural networks.</p><p id="Par35">Each neural network is trained with the five years of data. The training algorithm used is Lavenberg Marquardt. After training the 15 neural networks selected for forecasting global solar radiation, each one is applied to the one test data to calculate a prediction. Each Feed Forward network is initialized with random weights and biases and returns a different output with different performance. After training the multiple neural networks they are tested with an unseen test data set. Solar radiation is predicted by taking the average of the outputs of all 15 neural networks. The error for the average output of the multiple neural networks is likely to be small compared to the error of the individual neural networks [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. The average output is then de-normalized using the equation given below resulting in the values in units of irradiance.<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X= X_N (X_{\mathrm {max}}-X_{\mathrm {min}})+X_{\mathrm {min}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ6.gif"/></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Irradiance forecast methodology using multiple feed-forward neural networks</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig2_HTML.gif" id="MO8"/></fig></p></sec><sec id="Sec7"><title>Feed forward network architecture</title><p id="Par36">A feed forward neural network has no feedback paths and inputs are processed in the forward direction. For forecasting GHI, we have implemented a three-layer feed forward neural network consisting of an input layer, a hidden layer and an output layer.</p><sec id="Sec8"><title>Input layer</title><p id="Par37">An input layer is a passive layer and its function is to transmit the input signals to the hidden layer. The number of neurons in the input layer corresponds to the number of input signals. Here we have used 11 input signals: temperature (T), pressure (P), relative humidity (RH), cloudiness (CC), sunshine duration (SS), wind speed (WS), wind direction (WD), zenith angle (ZA), azimuth angle (AA), extra-terrestrial irradiance (E) and date number (DN), a numerical representation of the timestamp.</p></sec><sec id="Sec9"><title>Hidden layer</title><p id="Par38">The hidden layer is active and the number of neurons in the hidden layer is arbitrary. The hidden layer is important because it performs the necessary signal modification: the weights and biases of the neurons in the hidden layer are modified during the training to achieve the desired performance. The activation function used in the hidden layer is log-sigmoid function due to its differentiated nature.</p></sec><sec id="Sec10"><title>Output layer</title><p id="Par39">The output layer is also active in its nature and the neurons in the output layer correspond to the number of outputs.The function used in the output layer is the linear function. Output in our case is the global horizontal irradiance (GHI).</p></sec></sec><sec id="Sec11"><title>Photovoltaic model</title><p id="Par40">In this section, we describe the photovoltaic model developed in MATLAB. It is composed of three parts: the photovoltaic irradiance model, the photovoltaic temperature model and the photovoltaic electric model.</p><sec id="Sec12"><title>Photovoltaic irradiance model</title><p id="Par41">The photovoltaic irradiance model consists of two parts. The first part computes the amount of global irradiance incident on the tilted PV module, the second part computes the amount of the global irradiance absorbed by the PV module.</p><sec id="Sec13"><title>Global irradiance on the tilted PV module</title><p id="Par42">We can compute the amount of global irradiance incident on the tilted PV module using the Hay &amp; Davies model [<xref ref-type="bibr" rid="CR16">16</xref>]. The meterological data usually includes the global irradiance on a horizontal surface. This is the sum of direct and the diffuse irradiance. The idea is to convert the global irradiance on the horizontal surface into tilted irradiance values based on the tilt of the PV panel. We present the irradiance model for an isotropic and an ansisotropic sky. The isotropic sky model assumes a uniform distribution of diffuse irradiance from the sky. For an isotropic sky model, global irradiance on the tilted surface is defined in [<xref ref-type="bibr" rid="CR17">17</xref>] by the equation below with g represents global, d represents direct, df represents diffuse, r represents reflected, t represents tilted, gr represents ground.<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">df</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {g,t}}=G_{\mathrm {d,t}}+G_{\mathrm {df,t}}+G_{\mathrm {r,t}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ7.gif"/></alternatives></disp-formula>For an anisotropic sky model, the global irradiance on the tilted surface is given in [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] by:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">aniso</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {g,t}}=G_{\mathrm {d,t}}+G_{\mathrm {aniso,d,t}}+G_{\mathrm {r,t}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ8.gif"/></alternatives></disp-formula>The beam irradiance on the tilted surface can be expressed in [<xref ref-type="bibr" rid="CR17">17</xref>] as:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {d,t}}=R_{\mathrm {d}}G_{\mathrm {d,t}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {d}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq28.gif"/></alternatives></inline-formula> is the geometric factor, defined in [<xref ref-type="bibr" rid="CR17">17</xref>] as:<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>cos</mml:mo><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {d}}=\frac{\cos {\varTheta }}{\cos {\varTheta _{\mathrm {z}}} } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ10.gif"/></alternatives></disp-formula>where <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mi>Θ</mml:mi></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varTheta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq29.gif"/></alternatives></inline-formula> is the incidence angle and <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>Θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varTheta _{\mathrm {z}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq30.gif"/></alternatives></inline-formula> is the zenith angle. The incidence angle can be calculated by using the equation in [<xref ref-type="bibr" rid="CR19">19</xref>] below.<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>cos</mml:mo><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub><mml:mo>cos</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo>sin</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub><mml:mo>sin</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \cos {\varTheta }=\cos {\varTheta _{\mathrm {z}}}\cos {\beta }+\sin {\varTheta _{\mathrm {z}}}\sin {\beta }+\cos {(\gamma -\gamma _{s})} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ11.gif"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>β</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq31.gif"/></alternatives></inline-formula> is the tilt angle; <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq32.gif"/></alternatives></inline-formula> is the azimuth angle of the sun and <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq33.gif"/></alternatives></inline-formula> is the PV panel azimuth angle. The diffuse irradiance on the tilted surface in [<xref ref-type="bibr" rid="CR17">17</xref>] is given by the expression:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">df</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">df</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">df</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">horizontal</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {df,t}}=R_{\mathrm {df}}G_{\mathrm {df,horizontal}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ12.gif"/></alternatives></disp-formula>where the geometric factor <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">df</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {df}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq34.gif"/></alternatives></inline-formula> is defined in [<xref ref-type="bibr" rid="CR17">17</xref>] by:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">df</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>cos</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {df}}= \frac{1}{2}(1+\cos {\beta }) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ13.gif"/></alternatives></disp-formula>For an anisotropic sky model, the geometric factor of the diffused irradiance on the tilted surface is slightly modified and is defined in [<xref ref-type="bibr" rid="CR17">17</xref>] as:<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">aniso</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">df</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>cos</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {aniso,df}}=\frac{1}{2} (1-A_{i}) (1+\cos {\beta })+A_{i} R_{\mathrm {d}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ14.gif"/></alternatives></disp-formula>where <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq35.gif"/></alternatives></inline-formula> is an anisotropic index, which is a function of transmittance of the atmosphere for the beam radiation and is defined in [<xref ref-type="bibr" rid="CR17">17</xref>] as:<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">horizontal</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">ext</mml:mi></mml:msub><mml:mo>cos</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} A_{i}=\frac{G_{\mathrm {d,horizontal}}}{G_{\mathrm {ext}}\cos {\varTheta _{\mathrm {z}}} } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ15.gif"/></alternatives></disp-formula>The reflected irradiance from the ground can be calculated in [<xref ref-type="bibr" rid="CR17">17</xref>] by:<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">gr</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">gr</mml:mi></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">horizontal</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {G_{\mathrm {gr,t}}}={R_{\mathrm {gr}}} {\rho _{\mathrm g}} {G_{\mathrm {g,horizontal}}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ16.gif"/></alternatives></disp-formula>where <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">gr</mml:mi></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {gr}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq36.gif"/></alternatives></inline-formula> is a geometric factor and is defined in [<xref ref-type="bibr" rid="CR17">17</xref>] by the equation below and <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{\mathrm g}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq37.gif"/></alternatives></inline-formula> is the Albedo coefficient.<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">gr</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>cos</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {gr}}= \frac{1}{2}(1-\cos {\beta }) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ17.gif"/></alternatives></disp-formula></p></sec><sec id="Sec14"><title>Global irradiance absorbed by the tilted PV module</title><p id="Par43">The output power of the photovoltaic system depends directly on the amount of tilted global irradiance absorbed by the surface which is a function of the incident tilted global irradiance, air mass and angle of incidence [<xref ref-type="bibr" rid="CR20">20</xref>].</p><p id="Par44">We can approximate the amount of the irradiance absorbed by the photovoltaic module by (as shown in [<xref ref-type="bibr" rid="CR20">20</xref>]):<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">df</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {absorbed}}=G_{\mathrm {d,t}}(\tau \alpha )+G_{\mathrm {df,t}}(\tau \alpha )+G_{\mathrm {g,t}}( \tau \alpha ) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ18.gif"/></alternatives></disp-formula>where <italic>α</italic> is transmittance absorption product. The transmittance-absorption product is based on Snell’s law, Fresnel’s law and Boughers’s law (compare to [<xref ref-type="bibr" rid="CR20">20</xref>]):<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mi>τ</mml:mi><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>sin</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>sin</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>tan</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>tan</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \alpha (\theta ) = {{\rm{e}}^{ - \left( {\frac{{KL}}{{\cos {\theta _{\rm{r}}}}}} \right)}}\left[ {1 - \frac{1}{2}\left( {\frac{{{{\sin }^2}\left( {{\theta _{\rm{r}}} + {\theta _{\rm{i}}}} \right)}}{{{{\sin }^2}\left( {{\theta _{\rm{r}}} + {\theta _{\rm{i}}}} \right)}} + \frac{{{{\tan }^2}\left( {{\theta _{\rm{r}}} + {\theta _{\rm{i}}}} \right)}}{{{{\tan }^2}\left( {{\theta _{\rm{r}}} + {\theta _{\rm{i}}}} \right)}}} \right)} \right]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ19.gif"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{\mathrm r}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq38.gif"/></alternatives></inline-formula> is the refraction angle; <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{\mathrm i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq39.gif"/></alternatives></inline-formula> is the incidence angle and is computed for direct, diffuse and reflected radiation; <italic>K</italic> is the glazing extinction coefficient and <italic>L</italic> is the glazing thickness. For most PV systems <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=4m^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=2mm$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq41.gif"/></alternatives></inline-formula> are used.</p><p id="Par45">For direct irradiance, the incidence angle <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{\mathrm {i,d}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq42.gif"/></alternatives></inline-formula> is computed using (<xref rid="Equ11" ref-type="disp-formula">11</xref>):<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>arccos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>α</mml:mi><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">sun</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo>sin</mml:mo><mml:mi>α</mml:mi><mml:mo>cos</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \theta _{\mathrm {i,d}}=\arccos {(\cos {\alpha }\cos {(\gamma _{\mathrm {sun}}-\gamma _{p})}\sin {\beta }+\sin {\alpha }\cos {\beta })} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ20.gif"/></alternatives></disp-formula>where <italic>γ</italic><sub>sun</sub> is the azimuth angle of the sun and <italic>γ</italic><sub><italic>p</italic></sub> is the azimuth angle of the panel. For diffused irradiance (isotropic sky is assumed), the incidence angle is computed in [<xref ref-type="bibr" rid="CR20">20</xref>] using:<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">df</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>59.7</mml:mn><mml:mo>-</mml:mo><mml:mn>0.1388</mml:mn><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mn>0.001497</mml:mn><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \theta _{\mathrm {i,df}}=59.7-0.1388\beta +0.001497\beta ^{2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ21.gif"/></alternatives></disp-formula>For reflected irradiance (isotropic sky is assumed), the incidence angle is calculated in [<xref ref-type="bibr" rid="CR20">20</xref>] in accordance to:<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>90</mml:mn><mml:mo>-</mml:mo><mml:mn>0.5788</mml:mn><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mn>0.002693</mml:mn><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \theta _{\mathrm {i,r}}=90-0.5788\beta +0.002693\beta ^{2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ22.gif"/></alternatives></disp-formula>The refraction angle for the direct, diffuse and reflected irradiance is given in [<xref ref-type="bibr" rid="CR20">20</xref>] by:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>arcsin</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>sin</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta _{{\mathrm r}}}= \arcsin \left( \frac{n_2 \sin \theta _2}{n_1}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ23.gif"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq43.gif"/></alternatives></inline-formula> is the refractive index of the air and <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq44.gif"/></alternatives></inline-formula> is the refractive index of the PV glazing.</p></sec></sec><sec id="Sec15"><title>Photovoltaic temperature model</title><p id="Par46">Photovoltaic module efficiency and performance depends, besides other effects, on the temperature of the module/cell. The photovoltaic cell temperature changes during operation either due to changes in the ambient temperature <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T_{\mathrm {amb}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq45.gif"/></alternatives></inline-formula> or due to the radiation absorbed by the PV module [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>].</p><p id="Par47">The PV module temperature <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">Module</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T_{\mathrm {Module}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq46.gif"/></alternatives></inline-formula> can be calculated by using the ambient temperature for any type of PV array mounting [<xref ref-type="bibr" rid="CR23">23</xref>]:<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">Module</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mn>0.32</mml:mn><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>8.91</mml:mn><mml:mo>+</mml:mo><mml:mn>2.0</mml:mn><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mn>0.67</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_{\mathrm {Module}}=T_{\mathrm {amb}}+\omega \left( \frac{0.32G}{8.91+2.0\frac{v_w}{0.67}}\right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ24.gif"/></alternatives></disp-formula></p><p id="Par48">The reason for using (<xref rid="Equ24" ref-type="disp-formula">24</xref>) for modeling the PV module temperature is that it is a preferred model for size optimization, simulation and design of PV systems [<xref ref-type="bibr" rid="CR24">24</xref>].</p></sec><sec id="Sec16"><title>Photovoltaic electric model</title><p id="Par49">The power produced by the photovoltaic module is a function of the irradiance absorbed by the PV module and PV module temperature. The irradiance absorbed by the PV module is obtained from the photovoltaic irradiance model. The PV temperature model accounts for the variation in the PV module temperature due to changes in the ambient temperature and the amount of the global irradiance absorbed by the PV module. A PV electric model is based on a single diode model of the solar cell [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR25">25</xref>].<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Single diode model</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig3_HTML.gif" id="MO27"/></fig></p><p id="Par50">The equivalent circuit consists of a current source (<inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm {ph}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq47.gif"/></alternatives></inline-formula>) dependent upon the absorbed irradiance <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\mathrm {absorbed}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq48.gif"/></alternatives></inline-formula>, which is in parallel with the diode <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mi mathvariant="normal">D</mml:mi></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm D$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq49.gif"/></alternatives></inline-formula>. The series resistance (<inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">series</mml:mi></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {series}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq50.gif"/></alternatives></inline-formula>) is due to resistance between metal contacts and silicon. The shunt resistance (<inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">shunt</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {shunt}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq51.gif"/></alternatives></inline-formula>) is due to defects created in the PV module during the manufacturing. The equation of the one diode model for the current <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mi mathvariant="normal">I</mml:mi></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq52.gif"/></alternatives></inline-formula> is given in [<xref ref-type="bibr" rid="CR20">20</xref>] by:<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">diode</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">diode</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">shunt</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=\left( {I_{\mathrm {ph}}}+{I_{\mathrm o}}\left( \exp {\left( \frac{V_{\mathrm {diode}}}{V_{\mathrm t}}\right) }-1\right) - \frac{V_{\mathrm {diode}}}{R_{\mathrm {shunt}}}\right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ25.gif"/></alternatives></disp-formula>where <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_\mathrm o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq53.gif"/></alternatives></inline-formula> is the reverse saturation current of the diode, the diode thermal voltage.</p><p id="Par51">The photocurrent <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm {ph}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq54.gif"/></alternatives></inline-formula> is given in [<xref ref-type="bibr" rid="CR20">20</xref>] by:<disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">ph</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">ph</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">SC</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_{\mathrm {ph}}=\frac{G_{\mathrm {absorbed}}}{G_{\mathrm {ref}}}\left( I_{\mathrm {ph,ref}}+ \mu _{\mathrm {SC}} \left( T_{\mathrm {amb}}-T_{\mathrm {ref}}\right) \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ26.gif"/></alternatives></disp-formula>where <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\mathrm {amb}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq55.gif"/></alternatives></inline-formula> is the ambient temperature; <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">ph</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm {ph,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq56.gif"/></alternatives></inline-formula> is the photo-current at standard test conditions and <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\mathrm {ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq57.gif"/></alternatives></inline-formula> is the temperature at standard test conditions (STC) which is <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mn>25</mml:mn><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$25\mathrm {^{\circ }C}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq58.gif"/></alternatives></inline-formula>; <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\mathrm {ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq59.gif"/></alternatives></inline-formula> is the reference irradiance at STC, 1000 <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {W/m^2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq60.gif"/></alternatives></inline-formula>; <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\mathrm {absorbed}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq61.gif"/></alternatives></inline-formula> is the irradiation absorbed at the surface and <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">SC</mml:mi></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\mathrm {SC}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq62.gif"/></alternatives></inline-formula> is the relative temperature coefficient of the short-circuit current, which represents the rate of change of the short-circuit current with respect to temperature.</p><p id="Par52">The equation for the saturation current <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_\mathrm o$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq63.gif"/></alternatives></inline-formula> is therefore given in [20] by:<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mn>3</mml:mn></mml:msup><mml:mo>exp</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">amb</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{{I_{\rm{o}}}}}{{{I_{{\rm{o}},{\rm{ref}}}}}} = {\left[ {\frac{{{T_{{\rm{amb}}}}}}{{{T_{{\rm{ref}}}}}}} \right]^3}\exp \left[ {\frac{1}{k}\left( {\frac{{{E_{{\rm{g}},{\rm{ref}}}}}}{{{T_{{\rm{ref}}}}}} - \frac{{{E_{\rm g}}}}{{{T_{{\rm{amb}}}}}}} \right)} \right]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ27.gif"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm {o,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq64.gif"/></alternatives></inline-formula> represents the reference diode reverse saturation current; <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\mathrm {g,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq65.gif"/></alternatives></inline-formula> is the reference band gap energy and <italic>k</italic> is the Boltzman constant <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1.38</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>23</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi mathvariant="normal">kgs</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(k=1.38\times 10^{-23}\mathrm {m^2kgs^{-2} K^{-1}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq66.gif"/></alternatives></inline-formula>. The values of the reference diode reverse saturation current and reference band gap energy can be obtained from PV panel data sheets. The band gap energy is given in [<xref ref-type="bibr" rid="CR20">20</xref>] by the expression:<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>0.0002677</mml:mn><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{{E_{\rm{g}}}}}{{{E_{{\rm{g}},{\rm{ref}}}}}} = 1 - 0.0002677\left( {T - {T_{{\rm{ref}}}}} \right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ28.gif"/></alternatives></disp-formula></p><p id="Par53">One way of calulating the current <italic>I</italic> of the one diode model is to solve the equation numerically using the Newton’s method. <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{h+1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq67.gif"/></alternatives></inline-formula> is the approximate solution of <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(I_{h})=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq68.gif"/></alternatives></inline-formula> and if <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f'(I_{h})\ne 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq69.gif"/></alternatives></inline-formula> then the next approximation is given by:<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_{h+1}=I_{h}-\frac{f(I_{h})}{f '(I_{h})} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ29.gif"/></alternatives></disp-formula></p><p id="Par54">Another way is to use the voltage over the diode, <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">diode</mml:mi></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm {diode}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq70.gif"/></alternatives></inline-formula>. For the results presented here we have used the second method for calulating the current <italic>I</italic>. The shunt resistance <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">shunt</mml:mi></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {shunt}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq71.gif"/></alternatives></inline-formula> at operating conditions is given in [<xref ref-type="bibr" rid="CR20">20</xref>] by:<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">shunt</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">shunt</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {shunt}}= \frac{G_{\mathrm {absorbed}}}{G_{\mathrm {ref}}} R_{\mathrm {shunt,ref}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ30.gif"/></alternatives></disp-formula>where <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">shunt</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {shunt,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq72.gif"/></alternatives></inline-formula> is the shunt resistance at STC. The series resistance is assumed to be independent of temperature and irradiation at both operating conditions and STC [<xref ref-type="bibr" rid="CR20">20</xref>]:<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">series</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">series</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm {series}}= R_{\mathrm {series,ref}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ31.gif"/></alternatives></disp-formula></p><p id="Par55">The values of the series resistance <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">series</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {series,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq73.gif"/></alternatives></inline-formula> and shunt resistance <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">shunt</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm {shunt,ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq74.gif"/></alternatives></inline-formula> for different PV panels are obtained from a Bosch PV Panel database.<disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">diode</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">series</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V= V_{\mathrm {diode}}-I R_{\mathrm {series}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ32.gif"/></alternatives></disp-formula></p><p id="Par56">Let <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\mathrm p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq75.gif"/></alternatives></inline-formula> be the number of PV modules in a string and <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\mathrm s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq76.gif"/></alternatives></inline-formula> be the number of the strings in the PV array, then the power of the PV array (<inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{\mathrm {PV,DC}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq77.gif"/></alternatives></inline-formula>) is calculated under the assumption of no mismatch and shading effects as follows:<disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>I</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_{\mathrm {PV,DC}}=\, &amp; {} I N_{\mathrm s} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ33.gif"/></alternatives></disp-formula><disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>V</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{\mathrm {PV,DC}}=\, &amp; {} V N_{\mathrm p} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ34.gif"/></alternatives></disp-formula><disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{\mathrm {PV,DC}}=\, &amp; {} V_{\mathrm {PV,DC}} I_{\mathrm {PV,DC}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ35.gif"/></alternatives></disp-formula></p><p id="Par57">A maximum power point tracker is usually used to ensure that the PV panels operate close to their the maximum power point. The maximum power point of the array is defined here as:<disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">MPP</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">PV</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{\mathrm {MPP,PV}}= \mathrm {max}(P_{\mathrm {PV,DC}}) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ36.gif"/></alternatives></disp-formula></p><p id="Par58">If we assume the constant efficiency of the PV panels, then the power can be computed using the equation in [<xref ref-type="bibr" rid="CR26">26</xref>] given below:<disp-formula id="Equ37"><label>37</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">PV</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">DC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">PV</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="normal">absorbed</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="normal">PV</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">Mod</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{\mathrm {PV,DC}}=\eta _{\mathrm {PV}} G_{\mathrm {absorbed}}\left( 1-\beta _{\mathrm {PV}}\left( T_{\mathrm {Mod}}-T_{\mathrm {ref}}\right) \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ37.gif"/></alternatives></disp-formula>where <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">PV</mml:mi></mml:msub></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{\mathrm {PV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq78.gif"/></alternatives></inline-formula> is the PV module efficiency; <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">PV</mml:mi></mml:msub></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{\mathrm {PV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq79.gif"/></alternatives></inline-formula> is the PV module surface area and <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="normal">PV</mml:mi></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{\mathrm {PV}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq80.gif"/></alternatives></inline-formula> is the temperature coefficient for the power of the PV panel.</p></sec></sec><sec id="Sec17"><title>Irradiance forecast and photovoltaic power forecast results</title><p id="Par59">In this section we present global horizontal irradiance (GHI) and photovoltaic forecast results respectively. The irradiance forecast is converted into a PV power forecast using the PV model as explained in the section above.</p><sec id="Sec18"><title>Global horizontal irradiance forecast</title><p id="Par60">The global horizontal irradiance forecast is obtained by averaging the output of the 15 feed-forward neural networks trained with five years of meteorological data. Each feed forward neural network has 3 layers with 11 meteorological parameters as inputs. In this section, we compare the global horizontal irradiance (GHI) forecast based on networks with a persistence forecast (as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Accuracy comparison of global horizontal irradiance(GHI) forecast models under different day types for Stuttgart</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Forecast</p></th><th align="left" colspan="12"><p>Weather condition</p></th></tr><tr><th align="left" rowspan="3"><p>model</p></th><th align="left" colspan="4"><p>Clear sky <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>191</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=191)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq81.gif"/></alternatives></inline-formula></p></th><th align="left" colspan="4"><p>Partly cloudy <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>176</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=176)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq82.gif"/></alternatives></inline-formula></p></th><th align="left" colspan="4"><p>Cloudy day <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>117</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=117)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq83.gif"/></alternatives></inline-formula></p></th></tr><tr><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th></tr><tr><th align="left"><p><inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq84.gif"/></alternatives></inline-formula></p></th><th align="left"><p><inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq85.gif"/></alternatives></inline-formula></p></th><th align="left"><p>(%)</p></th><th align="left"/><th align="left"><p><inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq86.gif"/></alternatives></inline-formula></p></th><th align="left"><p><inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq87.gif"/></alternatives></inline-formula></p></th><th align="left"><p>(%)</p></th><th align="left"/><th align="left"><p><inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq88.gif"/></alternatives></inline-formula></p></th><th align="left"><p><inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mtext>W/m</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {W/m}^{2})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq89.gif"/></alternatives></inline-formula></p></th><th align="left"><p>(%)</p></th><th align="left"/></tr></thead><tbody><tr><td align="left"><p>Neural network</p></td><td align="left"><p>7.03</p></td><td align="left"><p>8.60</p></td><td align="left"><p>3.41</p></td><td align="left"><p>0.99</p></td><td align="left"><p>26.06</p></td><td align="left"><p>37.06</p></td><td align="left"><p>7.90</p></td><td align="left"><p>0.99</p></td><td align="left"><p>30.42</p></td><td align="left"><p>38.52</p></td><td align="left"><p>23.07</p></td><td align="left"><p>0.99</p></td></tr><tr><td align="left"><p>Persistence</p></td><td align="left"><p>275.54</p></td><td align="left"><p>361.11</p></td><td align="left"><p>47.91</p></td><td align="left"><p>0.65</p></td><td align="left"><p>56.25</p></td><td align="left"><p>78.55</p></td><td align="left"><p>14.0</p></td><td align="left"><p>0.95</p></td><td align="left"><p>111.12</p></td><td align="left"><p>149.87</p></td><td align="left"><p>100.86</p></td><td align="left"><p>0.77</p></td></tr></tbody></table><table-wrap-foot><p>Note: DOY means day of the year (1 to 365)</p></table-wrap-foot></table-wrap></p><p id="Par61">Table <xref rid="Tab1" ref-type="table">1</xref> shows the accuracy comparison of the GHI neural network forecast model compared to the GHI persistence forecast model several meteorological conditions (days types). The type of the day is classified by cloudiness: clear sky, partly cloudy and cloudy. The GHI neural network forecast model has much better accuracy in all day types in comparison to the GHI persistence model. The regression values of the GHI persistence model are moderate but it has much higher mean absolute errors and root mean squared error values. Overall, the GHI neural network forecast model has strong regression values in comparison to GHI persistence forecast model (as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>) [<xref ref-type="bibr" rid="CR20">20</xref>].<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>A comparison between global horizontal irradiance (GHI) neural network forecast, persistence forecast and measured global horizontal irradiance (GHI) on clear sky day (day of the <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>191</mml:mn></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=191$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq90.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig4_HTML.gif" id="MO41"/></fig></p><p id="Par62">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows that the GHI neural network forecast on a clear sky day is quite accurate and is in line with the measured GHI profile, whereas the GHI persistence forecast underestimates the GHI.</p><p id="Par63">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the GHI forecast based on the neural network during a partly cloudy day. It can be seen that the measured GHI from DWD data and the predicted GHI are quite congruent compared to the GHI persistence forecast. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows that the measured GHI has lower values on a cloudy day compared to clear sky and partly cloudy days. However the GHI neural network forecast still follows the measured GHI profile more closely in comparison to the GHI persistence forecast. The GHI persistence forecast overestimates the GHI on a cloudy day. The accuracy of the GHI neural network forecast decreases as the weather changes from clear sky to cloudy.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>A comparison between global horizontal irradiance (GHI) neural network forecast, persistence forecast and measured global horizontal irradiance (GHI) on a day with a partly cloudy sky (day of the <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>176</mml:mn></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=176$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq91.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig5_HTML.gif" id="MO42"/></fig><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>A comparison between global horizontal irradiance (GHI) neural network forecast, persistence forecast and measured global horizontal irradiance (GHI) on a day with a cloudy sky (day of the <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>117</mml:mn></mml:mrow></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=117$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq92.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig6_HTML.gif" id="MO43"/></fig></p></sec><sec id="Sec19"><title>Sensitivity analysis neural network irradiance forecast model</title><p id="Par64">A sensitivity analysis of the global horizontal irradiance neural network forecast model has been performed for different weather variables, solar angles, and extraterrestrial irradiance to determine which are good predictors for forecasting the global horizontal irradiance. In the first case, each weather variable is excluded from the input set, one by one, while all other variables are included and accuracy is computed.</p><p id="Par65">The GHI neural network forecast model is more sensitive to the sunshine variable which is a very important predictor for forecasting GHI, as the accuracy of the model deteriorates if it is not included as input, MAE increases in Fig. <xref rid="Fig7" ref-type="fig">7</xref> when sunshine is excluded. The interquartile range of the MAE box labeled as SS (sunshine not included in the input set) is greater than rest of the boxes and the median value of the MAE box labelled SS is larger than the median values for rest of the box plots.</p><p id="Par66">In another sensitivity test the GHI neural network forecast model is given a different combination of the weather variables as shown in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Different combinations of weather variables as inputs to irradiance neural network model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Box plot label</p></th><th align="left"><p>Variables included</p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td align="left"><p>Temperature &amp; Relative humidity</p></td></tr><tr><td align="left"><p>2</p></td><td align="left"><p>Temperature, Relative humidity &amp; Wind speed</p></td></tr><tr><td align="left" rowspan="2"><p>3</p></td><td align="left"><p>Temperature, Relative humidity,</p></td></tr><tr><td align="left"><p>Wind speed &amp; Wind direction</p></td></tr><tr><td align="left" rowspan="2"><p>4</p></td><td align="left"><p>Temperature, Relative humidity,</p></td></tr><tr><td align="left"><p>Wind speed, Wind direction &amp; Cloudiness</p></td></tr><tr><td align="left" rowspan="3"><p>5</p></td><td align="left"><p>Temperature, Relative humidity,</p></td></tr><tr><td align="left"><p>Wind speed, Wind direction,</p></td></tr><tr><td align="left"><p>Cloudiness &amp; Sun shine</p></td></tr><tr><td align="left" rowspan="2"><p>6</p></td><td align="left"><p>Temperature, Relative humidity,</p></td></tr><tr><td align="left"><p>Cloudiness &amp; Sun shine</p></td></tr><tr><td align="left"><p>7</p></td><td align="left"><p>Temperature, Relative humidity and pressure</p></td></tr><tr><td align="left" rowspan="2"><p>ALL</p></td><td align="left"><p>All weather variables included</p></td></tr><tr><td align="left"><p>(08 weather parameters)</p></td></tr></tbody></table></table-wrap></p><p id="Par68">As shown in the Fig. <xref rid="Fig7" ref-type="fig">7</xref>, the median value of the MAE decreases as wind speed is added to the smallest input set (case 2). MAE decreases further if cloudiness is included as an input (case 4). This shows that temperature, relative humidity, cloudiness and the sunshine are important weather variables for forecasting the GHI. But if all the weather variables are included (case ALL) as input, the median value of the GHI neural network forecast error decreases and the maximum value of the MAE also decreases (as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Sensitivity analysis of the GHI neural network forecast model for different weather variables</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig7_HTML.gif" id="MO44"/></fig><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Sensitivity analysis of the GHI neural network forecast model for different combination of weather variables (see Table <xref rid="Tab2" ref-type="table">2</xref> for the box-labels)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig8_HTML.gif" id="MO45"/></fig></p><p id="Par69">Apart from the weather variables, three more predictors are proposed for forecasting the solar irradiance. As shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>, the MAE decreases if we include extraterrestrial irradiance (case E) in addition to weather data as inputs. The MAE decreases even further if we add azimuth angle (case AZ) and zenith angle (case ZA) in addition to the weather data and extraterrestrial irradiance. Hence, it shows that azimuth angle, zenith angle and extraterrestrial irradiance are important predictors in addition to weather variables.
<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Sensitivity analysis of the GHI neural network forecast model for different combination of weather variables</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig9_HTML.gif" id="MO46"/></fig></p></sec><sec id="Sec20"><title>Photovoltaic power forecast</title><p id="Par70">The PV power forecast is obtained after performing the PV simulation using an irradiance forecast obtained from the neural network model. The PV power forecast analysis is performed for different day types and then compared with the PV power persistence forecast. The actual PV power time series is estimated by performing a PV simulation using meteorological data.</p><p id="Par71">Fig. <xref rid="Fig10" ref-type="fig">10</xref> shows that the PV power forecast by the irradiance neural network model follows the estimated PV power on clear sky day whereas the PV power persistence forecast underestimates the PV power.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>A comparison between PV power neural network forecast, PV power persistence forecast and target PV power on clear sky day (day of the <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>191</mml:mn></mml:mrow></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=191$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq93.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig10_HTML.gif" id="MO47"/></fig></p><p id="Par72">Figure <xref rid="Fig11" ref-type="fig">11</xref> shows that the PV power forecast based on the irradiance neural network model follows the estimated PV power quite accurately in comparison to the persistence PV power forecast.<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>A comparison between PV power neural network forecast, PV power persistence forecast and target PV power on partly cloudy day (day of the <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>176</mml:mn></mml:mrow></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=176$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq94.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig11_HTML.gif" id="MO48"/></fig></p><p id="Par73">Figure <xref rid="Fig12" ref-type="fig">12</xref> shows that on a cloudy day the PV power forecast based on the irradiance neural network model still follows the target PV power accurately compared to the PV power persistence forecast, but the accuracy of the PV power forecast based on the irradiance neural network model decreases as the weather changes from a clear sky to a cloudy day.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>A comparison between PV power neural network forecast, PV power persistence forecast and target PV power on cloudy day (day of the <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mrow><mml:mtext>year</mml:mtext><mml:mo>=</mml:mo><mml:mn>117</mml:mn></mml:mrow></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {year}=117$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq95.gif"/></alternatives></inline-formula>)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40565_2018_393_Fig12_HTML.gif" id="MO49"/></fig></p><p id="Par74">Table <xref rid="Tab3" ref-type="table">3</xref> shows that PV DC power forecasts based on the neural network irradiance model are more accurate for all day types, i.e. clear sky, partly cloudy and cloudy, than the PV power persistence forecast. The mean absolute error (MAE) is quite small for the PV power neural network forecast compared to PV power persistence forecast. Also, the PV power neural network forecast has strong regression values on all day types whereas the PV power persistence forecast has modest regression values on clear sky and cloudy days. Moreover, the PV power persistence forecast also has a mean absolute percentage error of more than 50% on a clear sky and cloudy days. Therefore, the PV power persistence forecast could be used as approximate tool, but for an accurate prediction of the PV power the neural network model is the preferred choice.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Accuracy comparison PV DC power forecast models under different day types for Stuttgart</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Forecast</p></th><th align="left" colspan="12"><p>Weather condition</p></th></tr><tr><th align="left" rowspan="3"><p>model</p></th><th align="left" colspan="4"><p>Clear sky <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>191</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=191)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq96.gif"/></alternatives></inline-formula></p></th><th align="left" colspan="4"><p>Partly cloudy <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>176</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=176)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq97.gif"/></alternatives></inline-formula></p></th><th align="left" colspan="4"><p>Cloudy day <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DOY</mml:mtext><mml:mo>=</mml:mo><mml:mn>117</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {DOY}=117)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq98.gif"/></alternatives></inline-formula></p></th></tr><tr><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th><th align="left"><p>MAE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAPE</p></th><th align="left"><p><italic>R</italic></p></th></tr><tr><th align="left"><p>(W)</p></th><th align="left"><p>(W)</p></th><th align="left"><p>(%)</p></th><th align="left"/><th align="left"><p>(W)</p></th><th align="left"><p>(W)</p></th><th align="left"><p>(%)</p></th><th align="left"/><th align="left"><p>(W)</p></th><th align="left"><p>(W)</p></th><th align="left"><p>(%)</p></th><th align="left"/></tr></thead><tbody><tr><td align="left"><p>Neural network</p></td><td align="left"><p>99.10</p></td><td align="left"><p>122.98</p></td><td align="left"><p>12.79</p></td><td align="left"><p>0.99</p></td><td align="left"><p>110.73</p></td><td align="left"><p>148.07</p></td><td align="left"><p>12.20</p></td><td align="left"><p>0.98</p></td><td align="left"><p>164.88</p></td><td align="left"><p>198.84</p></td><td align="left"><p>13.83</p></td><td align="left"><p>0.99</p></td></tr><tr><td align="left"><p>Persistence</p></td><td align="left"><p>846.47</p></td><td align="left"><p>1050.80</p></td><td align="left"><p>51.96</p></td><td align="left"><p>0.65</p></td><td align="left"><p>203.91</p></td><td align="left"><p>262.95</p></td><td align="left"><p>13.33</p></td><td align="left"><p>0.96</p></td><td align="left"><p>437.54</p></td><td align="left"><p>517.23</p></td><td align="left"><p>66.12</p></td><td align="left"><p>0.69</p></td></tr></tbody></table><table-wrap-foot><p>Note: DOY means day of the year (1 to 365)</p></table-wrap-foot></table-wrap></p></sec></sec><sec id="Sec21"><title>Conclusion and future work</title><p id="Par75">In this research, we proposed a PV yield prediction system based on multiple feed-forward neural network irradiance forecast models. The PV power forecast based on this system outperforms the PV persistence power forecast model.</p><p id="Par76">The multiple feed-forward models predict the GHI with a mean absolute percentage error of 3% on a sunny day and a mean absolute percentage error of approximately 23% on a cloudy day for Stuttgart. The mean absolute error is analyzed for the entire year and its average is <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mrow><mml:mn>25</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$25 \,\mathrm {W/m}^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq99.gif"/></alternatives></inline-formula> for the day ahead forecast horizon. Hence, the GHI forecast based on multiple neural networka is selected for predicting the yield of the PV system. From the sensitivity analysis of the multiple feed-forward neural network GHI forecast model, it can be concluded that apart from weather variables, solar angles (azimuth angle and zenith angle) and extraterrestrial irradiance are possible predictors for forecasting the GHI. It can also be concluded that the GHI neural network forecast model is more sensitive to sunshine, cloudiness and temperature than to other inputs.</p><p id="Par77">PV DC power forecasts are obtained by converting irradiance to power using a PV model. PV power forecasts based on the multiple feed forward irradiance forecast model outperform the PV power persistence forecasts. The PV Power neural network forecast model has a MAPE of 18% to 21% in summer and spring and an overall MAPE of 26%.</p><p id="Par78">Upcoming work is the implementation of a controller that uses the PV power and load forecasts for efficient operational strategies for battery charging and load scheduling.</p><p id="Par79">The proposed irradiance forecast model based on multiple feed-forward neural networks uses five years of historical meteorological data for training the neural networks. Such a large meteorological data set for the location under observation is usually unavailable, so upcoming work includes the development of prediction algorithms capable of handling small data sets. This may use an irradiance forecast model based on other advanced neural network techniques. On the other hand, upcoming work will also include large-data approaches for accurate irradiance prediction development of a hybrid prediction algorithm based on satellite images, historical meteorological data and numerical weather prediction forecast models.</p></sec></body><back><ack><title>Acknowledgements</title><p>The framework for this research was given by the Energy Monitoring and Management Project by Bosch Thermotechnik GmbH, Germany. First, I would like to express my sincere gratitude to Lukas Wurzer, M.Sc., having offered me the opportunity to start my research at Bosch Thermotechnik GmbH in Wernau, Germany. I am also heartily thankful to Dipl.-Ing. Stefan Balluff for his precious advice, comments and remarks during research. I owe my profound gratitude to Prof. Dr.-Ing. Stefan Krauter for providing much needed supervision throughout the research.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hong</surname><given-names>T</given-names></name><name><surname>Pinson</surname><given-names>P</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Probabilistic energy forecasting: global energy forecasting competition 2014 and beyond</article-title><source>Int J Forecast</source><year>2016</year><volume>32</volume><issue>3</issue><fpage>896</fpage><lpage>913</lpage><pub-id pub-id-type="doi">10.1016/j.ijforecast.2016.02.001</pub-id></mixed-citation></ref><ref id="CR2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rehman</surname><given-names>S</given-names></name><name><surname>Mohandes</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Artificial neural network estimation of global solar radiation using air temperature and relative humidity</article-title><source>Energy Policy</source><year>2008</year><volume>36</volume><issue>2</issue><fpage>571</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1016/j.enpol.2007.09.033</pub-id></mixed-citation></ref><ref id="CR3"><label>[3]</label><mixed-citation publication-type="other">Baharin KA, Rahman HA, Hassan MY (2013) Hourly irradiance forecasting for Peninsular Malaysia using dynamic neural network with preprocessed data. In: Proceedings of IEEE student conference on research and development (SCOReD), Putrajaya, Malaysia, 16–17 December 2013, pp 191–197</mixed-citation></ref><ref id="CR4"><label>[4]</label><mixed-citation publication-type="other">Kardakos E, Alexiadis M, Vagropoulos S et al (2014) Application of time series and artificial neural network models in short-term forecasting of PV power generation. In: Proceedings of 49th international universities power engineering conference (UPEC), Cluj-Napoca, Romania, 2–5 September 2014, pp 1–6</mixed-citation></ref><ref id="CR5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giorgi</surname><given-names>MGDG</given-names></name><name><surname>Congdeo</surname><given-names>MP</given-names></name><name><surname>Malvoni</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Photovoltaic power forecasting using statistical methods: impact of weather data</article-title><source>IET Sci Meas Technol</source><year>2014</year><volume>8</volume><issue>3</issue><fpage>90</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1049/iet-smt.2013.0135</pub-id></mixed-citation></ref><ref id="CR6"><label>[6]</label><mixed-citation publication-type="other">Alanazi M, Alanazi A, Khodaei A (2016) Long term solar generation forecasting. In: Proceedings of IEEE PES transmission and distribution conference and exposition, Dallas, USA, 3–5 May 2016, pp 1–5</mixed-citation></ref><ref id="CR7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mellit</surname><given-names>A</given-names></name><name><surname>Pavan</surname><given-names>AM</given-names></name></person-group><article-title xml:lang="en">A 24-h forecast of solar irradiance using artificial neural network: application for performance prediction of a grid connected PV plant at Trieste</article-title><source>Sol Energy</source><year>2010</year><volume>84</volume><issue>5</issue><fpage>807</fpage><lpage>821</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2010.02.006</pub-id></mixed-citation></ref><ref id="CR8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimball</surname><given-names>A</given-names></name><name><surname>Dagli</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Predicting solar irradiance using time series neural networks</article-title><source>Proc Comput Sci</source><year>2014</year><volume>36</volume><fpage>623</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1016/j.procs.2014.09.065</pub-id></mixed-citation></ref><ref id="CR9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paoli</surname><given-names>C</given-names></name><name><surname>Voyant</surname><given-names>C</given-names></name><name><surname>Muselli</surname><given-names>M</given-names></name><etal/></person-group><article-title xml:lang="en">Forecasting of pre-processed daily solar radiation time series using neural networks</article-title><source>Sol Energy</source><year>2010</year><volume>84</volume><issue>12</issue><fpage>2146</fpage><lpage>2160</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2010.08.011</pub-id></mixed-citation></ref><ref id="CR10"><label>[10]</label><mixed-citation publication-type="other">Alluhaidah B, Shehadeh SM, El-Hawary M (2014) Most influential variables for solar radiation forecasting using artificial neural network. In: Proceedings of IEEE electrical power and energy conference, Calgary, Canada, 12–14 November 2014, pp 71-75</mixed-citation></ref><ref id="CR11"><label>[11]</label><mixed-citation publication-type="other">Watetakaran S, Premrudeepreechacharn S (2015) Forecasting of solar irradiance for solar power plants by artificial neural network. In: Proceedings of IEEE innovative smart grid technologies-Asia (ISGT-Asia), Bangkok, Thailand, 3–6 November 2015, pp 1–5</mixed-citation></ref><ref id="CR12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenz</surname><given-names>E</given-names></name><name><surname>Scheidsteger</surname><given-names>T</given-names></name><name><surname>Hurk</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Regional PV power prediction for improved grid integration</article-title><source>Prog Photovolt Res Appl</source><year>2010</year><volume>19</volume><issue>7</issue><fpage>757</fpage><lpage>910</lpage><pub-id pub-id-type="doi">10.1002/pip.1033</pub-id></mixed-citation></ref><ref id="CR13"><label>[13]</label><mixed-citation publication-type="other">Deutsche Wetter Dienst (2017) Climate Data Center. ftp://ftp-cdc.dwd.de/pub/CDC. Accessed 25 Mar 2017</mixed-citation></ref><ref id="CR14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adam</surname><given-names>PP</given-names></name><name><surname>Napiorkowski</surname><given-names>JJ</given-names></name></person-group><article-title xml:lang="en">A comparison of methods to avoid overfitting in neural networks training in the case of catchment runoff modelling</article-title><source>J Hydrol</source><year>2013</year><volume>476</volume><fpage>97</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.jhydrol.2012.10.019</pub-id></mixed-citation></ref><ref id="CR15"><label>[15]</label><mixed-citation publication-type="other">The MathWorks Inc. (2017) Improve neural network generalization and avoid overfitting. In: Getting started with MATLAB. <ext-link xlink:href="https://de.mathworks.com/help/nnet/ug/improve-neural-network-generalization-and-avoid-overfitting.html" ext-link-type="uri">https://de.mathworks.com/help/nnet/ug/improve-neural-network-generalization-and-avoid-overfitting.html</ext-link> Accessed 25 Mar 2017</mixed-citation></ref><ref id="CR16"><label>[16]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Duffie</surname><given-names>JA</given-names></name><name><surname>Beckman</surname><given-names>WA</given-names></name></person-group><source>Solar engineering of thermal processes</source><year>2013</year><publisher-loc>Toronto</publisher-loc><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/9781118671603</pub-id></mixed-citation></ref><ref id="CR17"><label>[17]</label><mixed-citation publication-type="other">Hay JE, Davies JA (1980) Calculation of the solar radiation incident on an inclined surface. In: Proceedings of the first Canadian solar radiation data workshop, ministry of supply and services, Toronto, Canada, pp 59</mixed-citation></ref><ref id="CR18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>PI</given-names></name></person-group><article-title xml:lang="en">The absorption of radiation in solar stills</article-title><source>Sol Energy</source><year>1969</year><volume>12</volume><issue>3</issue><fpage>333</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1016/0038-092X(69)90047-4</pub-id></mixed-citation></ref><ref id="CR19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dusabe</surname><given-names>D</given-names></name><name><surname>Munda</surname><given-names>J</given-names></name><name><surname>Jimoh</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Modelling of cloudless solar radiation for PV module performance analysis</article-title><source>J Electric Eng</source><year>2009</year><volume>60</volume><issue>4</issue><fpage>192</fpage><lpage>197</lpage></mixed-citation></ref><ref id="CR20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Soto</surname><given-names>W</given-names></name><name><surname>Klein</surname><given-names>S</given-names></name><name><surname>Beckman</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Improvement and validation of a model for photovoltaic array performance</article-title><source>Sol Energy</source><year>2006</year><volume>80</volume><issue>1</issue><fpage>78</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2005.06.010</pub-id></mixed-citation></ref><ref id="CR21"><label>[21]</label><mixed-citation publication-type="other">Nordmann T, Clavadetscher L (2003) Understanding temperature effects on PV system performance. In: Proceedings of 3rd world conference on photovoltaic energy conversion, vol 3, Osaka, Japan, 11–18 May 2003, pp 2243–2246</mixed-citation></ref><ref id="CR22"><label>[22]</label><mixed-citation publication-type="other">Pearsall N (2017) Introduction to photovoltaic system performance. In: The performance of photovoltaic systems modelling, measurement and assessment. Elesvier, London, pp 6–15</mixed-citation></ref><ref id="CR23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skoplaki</surname><given-names>E</given-names></name><name><surname>Playvos</surname><given-names>GA</given-names></name></person-group><article-title xml:lang="en">A simple correlation for the operating temperature of the photovoltaic modules of arbitrary mounting</article-title><source>Sol Energy Mater Sol Cells</source><year>2008</year><volume>92</volume><issue>11</issue><fpage>1393</fpage><lpage>1402</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2008.05.016</pub-id></mixed-citation></ref><ref id="CR24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jakhrani</surname><given-names>A</given-names></name><name><surname>Othman</surname><given-names>A</given-names></name><name><surname>Rigit</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Comparison of solar photovoltaic module temperature models</article-title><source>World Appl Sci J</source><year>2011</year><volume>14</volume><fpage>1</fpage><lpage>8</lpage></mixed-citation></ref><ref id="CR25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lo Brano</surname><given-names>V</given-names></name><name><surname>Orioli</surname><given-names>A</given-names></name><name><surname>Ciulla</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">An improved five-parameter model for photovoltaic modules</article-title><source>Solar Energy Mater Sol Cells</source><year>2010</year><volume>94</volume><issue>8</issue><fpage>1358</fpage><lpage>1370</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2010.04.003</pub-id></mixed-citation></ref><ref id="CR26"><label>[26]</label><mixed-citation publication-type="other">Velasco G, Guinjoan F, Pique R et al (2006) Sizing factor considerations for grid-connected PV systems based on a central inverter configuration. In: Proceedings of IEEE industrial electronics conference, Paris, France, 6–10 November 2006, pp 2718–2722</mixed-citation></ref><ref id="CR27"><label>[27]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Khatib</surname><given-names>T</given-names></name><name><surname>Elemenreich</surname><given-names>W</given-names></name></person-group><source>Modeling of photovoltaic systems using MATLAB</source><year>2016</year><publisher-loc>New Jersey</publisher-loc><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/9781119118138</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1"><sec id="Sec22"><title>Appendix A</title><p id="Par80">The sun’s zenith angle is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ38"><label>A1</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mi>R</mml:mi><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \cos {\theta _{\mathrm z}}= \cos {(\delta )}\cos {(L)}\cos {(HRA)}+\sin {(\delta )}\sin {(L)} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ38.gif" position="anchor"/></alternatives></disp-formula>where <italic>L</italic> is the latitude; <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq100.gif"/></alternatives></inline-formula> is the sun’s declination angle and <italic>HRA</italic> is the hour angle.</p><p id="Par81">The sun’s declination angle is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ39"><label>A2</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>23.45</mml:mn><mml:mo>sin</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>360</mml:mn><mml:mn>365</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>284</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \delta = 23.45 \sin {\left( \frac{360}{365}(284+n)\right) } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ39.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the day of the year <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>365</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1\le n\le 365)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq101.gif"/></alternatives></inline-formula>. The hour angle is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ40"><label>A3</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi><mml:mi>R</mml:mi><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>12</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} HRA= 15(LST-12) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ40.gif" position="anchor"/></alternatives></disp-formula>where <italic>LST</italic> is the local solar time in hours. Hour angle is zero at local noon. The local solar time (<italic>LST</italic>) is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ41"><label>A4</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TC</mml:mi></mml:mrow><mml:mn>60</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} LST= \frac{TC}{60}+LT \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ41.gif" position="anchor"/></alternatives></disp-formula>where <italic>LT</italic> is the local time; <italic>TC</italic> is time correction factor and is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ42"><label>A5</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mfenced close=")" open="(" separators=""><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>15</mml:mn><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">GMT</mml:mi></mml:msub></mml:mfenced><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TC</mml:mi></mml:mrow><mml:mn>60</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mi>o</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} TC= 4\left( Longitude -15\mathrm {\Delta } T_{\mathrm {GMT}}\right) \frac{TC}{60}+EoT \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ42.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">GMT</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {\Delta } T_{\mathrm {GMT}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_IEq102.gif"/></alternatives></inline-formula> is the time difference between local time and Greenwich Mean Time (GMT) in hours. We use the sign convention that longitude is positive if the location lies to the East of the Prime Meridian, and negative if the location lies to the West of the Prime Meridian. The equation of time (EoT) is defined as [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ43"><label>A6</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mi>o</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>9.87</mml:mn><mml:mo>sin</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mn>7.53</mml:mn><mml:mo>cos</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mn>1.5</mml:mn><mml:mo>sin</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} EoT=\, &amp; {} 9.87\sin (2B)-7.53\cos (B)-1.5\sin (B) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ43.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ44"><label>A7</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>360</mml:mn><mml:mn>365</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>81</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B=\, &amp; {} \frac{360}{365}(n-81) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ44.gif" position="anchor"/></alternatives></disp-formula>The extra-terrestrial irradiance on the horizontal can be computed using the following equation [<xref ref-type="bibr" rid="CR27">27</xref>].<disp-formula id="Equ45"><label>A8</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="normal">ext</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">horizontal</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1367</mml:mn><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>0.033</mml:mn><mml:mo>cos</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mn>365</mml:mn></mml:mfrac></mml:mfenced></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G_{\mathrm {ext,horizontal}}= 1367\left( 1+0.033 \cos {\left(\frac{2\pi n}{365}\right)}\right) (\cos {\theta _{\mathrm z}}) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40565_2018_393_Article_Equ45.gif" position="anchor"/></alternatives></disp-formula></p></sec></app></app-group></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Grid connected photovoltaic (GCPV)</facet-value><facet-value count="1">Irradiance forecast</facet-value><facet-value count="1">Neural network (NN)</facet-value><facet-value count="1">Photovoltaic (PV)</facet-value><facet-value count="1">PV power prediction</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Modern Power Systems and Clean Energy</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">Germany</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
