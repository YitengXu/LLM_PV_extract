<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41598-022-22952-0</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41598</journal-id><journal-id journal-id-type="doi">10.1038/41598.2045-2322</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title><abbrev-journal-title abbrev-type="publisher">Sci Rep</abbrev-journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41598-022-22952-0</article-id><article-id pub-id-type="manuscript">22952</article-id><article-id pub-id-type="doi">10.1038/s41598-022-22952-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/166/987</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/4077/909</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Maximum power extraction and DC-Bus voltage regulation in grid-connected PV/BES system using modified incremental inductance with a novel inverter control</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>AL-Wesabi</surname><given-names>Ibrahim</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><name><surname>Zhijian</surname><given-names>Fang</given-names></name><address><email>fzjwhu@foxmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="corresp" rid="IDs41598022229520_cor2">b</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Hussein Farh</surname><given-names>Hassan M.</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>A. Al-Shamma’a</surname><given-names>Abdullrahman</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Dong</surname><given-names>Hanlin</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" id="Au6"><name><surname>M. Al-Shaalan</surname><given-names>Abdullah</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author" id="Au7"><name><surname>Kandil</surname><given-names>Tarek</given-names></name><xref ref-type="aff" rid="Aff6">6</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.503241.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1760 9015</institution-id><institution content-type="org-division">School of Automation</institution><institution content-type="org-name">China University of Geoscience</institution></institution-wrap><addr-line content-type="postcode">430074</addr-line><addr-line content-type="city">Wuhan</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.503241.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1760 9015</institution-id><institution content-type="org-name">Hubei Key Laboratory of Advanced Control and Intelligent Automation for Complex Systems</institution></institution-wrap><addr-line content-type="postcode">430074</addr-line><addr-line content-type="city">Wuhan</addr-line><country country="CN">China</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.419897.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 313X</institution-id><institution content-type="org-division">Engineering Research Center of Intelligent Technology for Geo-Exploration</institution><institution content-type="org-name">Ministry of Education</institution></institution-wrap><addr-line content-type="postcode">430074</addr-line><addr-line content-type="city">Wuhan</addr-line><country country="CN">China</country></aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.440750.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2243 1790</institution-id><institution content-type="org-division">Electrical Engineering Department, College of Engineering</institution><institution content-type="org-name">Imam Mohammad Ibn Saud Islamic University</institution></institution-wrap><addr-line content-type="city">Riyadh</addr-line><country country="SA">Saudi Arabia</country></aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.56302.32</institution-id><institution-id institution-id-type="ISNI">0000 0004 1773 5396</institution-id><institution content-type="org-division">Electrical Engineering Department, College of Engineering</institution><institution content-type="org-name">King Saud University</institution></institution-wrap><addr-line content-type="city">Riyadh</addr-line><country country="SA">Saudi Arabia</country></aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.268170.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 0722 0389</institution-id><institution content-type="org-division">School of Engineering and Technology</institution><institution content-type="org-name">Western Carolina University</institution></institution-wrap><addr-line content-type="postcode">28723</addr-line><addr-line content-type="city">Cullowhee</addr-line><addr-line content-type="state">NC</addr-line><country country="US">USA</country></aff></contrib-group><author-notes><corresp id="IDs41598022229520_cor2"><label>b</label><email>fzjwhu@foxmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>11</month><year>2022</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2022</year></pub-date><volume>12</volume><issue seq="19958">1</issue><elocation-id>19958</elocation-id><history><date date-type="registration"><day>21</day><month>10</month><year>2022</year></date><date date-type="received"><day>21</day><month>8</month><year>2022</year></date><date date-type="accepted"><day>21</day><month>10</month><year>2022</year></date><date date-type="online"><day>19</day><month>11</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Low ripples and variations in the DC-Bus voltage in single-phase Photovoltaic/Battery Energy Storage (PV/BES) grid-connected systems may cause significant harmonics distortion, instability, and reduction in power factor. The use of short-life electrolytic capacitor on the DC-Bus is considered a standard way for reducing these ripples and variations because of its large capacitance but results in short lifetime of the inverter. Replacing large electrolytic capacitors with small film capacitors can extend the lifetime of a PV/BES grid-connected system because small film capacitors have longer lifetime than large electrolytic capacitors. These film capacitors have low capacitance, which causes severe oscillations in the output current, and voltage drop due to huge ripples on the DC-Bus voltage. In this research, the main goal is to eliminate the output current ripples and voltage fluctuations associated with employing film capacitors. First, a modified incremental conductance (MIC) technique is proposed for tracking the maximum power by controlling the duty ratio of the DC-DC boost converter. Second, for the first time, a simple and novel d-q current regulation technique, which employs flowchart decision logic, is used in the DC-Bus control system for both the PV power system and the state of charge (SOC) of the BES. In this case, the DC-Bus controller is characterized by a cost-effective implementation because of its low sampling frequency. Although the presented approaches are successful in eliminating voltage distortion and fluctuations, they have unacceptable dynamic performance. Therefore, to improve the dynamic performance, BES was used to maintain a reliable and stable harvest from PV modules for varying loads while also increasing the dynamic performance of the overall system. The proposed PV/BES grid-connected systems, which employs a small 10-µF bus capacitor, is simulated and connected to the grid (230 V, 50 Hz). The DC-Bus voltage overshoot, undershoot and the total harmonics distortion (THD) of the output current for the proposed MIC are (1 V), (2.5 V) and (less than 5%), respectively. The average time response under rising radiation to track the global peak for MIC, traditional incremental conductance and variable step size incremental conductance are 1.403 s, 1.501 s and 1.113 s respectively. The obtained findings demonstrated the efficacy and superiority of the proposed d-q current control and MIC technique.</p></abstract><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Portfolio</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>19957</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>10</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>21</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41598_2022_Article_22952.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">In comparison to previous photovoltaic (PV) architectures<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, the PV/BES grid-connected system is more useful since each component is optimized for optimal power generation, they are low cost and quick to install (known as "Plug and Play"), and have enhanced flexibility and modularity<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. The two-stage arrangement with a DC-Bus represents the standard configuration for PV/BES grid connected systems<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>.</p><p id="Par3">Two obvious difficulties associated with the DC-Bus in the single-phase PV/BES grid-connected systems which are the frequency ripples of the DC-Bus voltage and overshoots and/or undershoots in bus control loop<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. The ripples generally distort significantly the current reference with a visible distortion which is almost entirely a third harmonic and a phase shift. When voltage oscillations occur because of abrupt changes in input power, the safety mechanism is triggered, causing the input/output stage to be separated and the efficacy to be reduced. The control design’s goal is to reduce DC-Bus voltage fluctuations and output current ripples<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>.</p><p id="Par4">The AC-driven (PWM) inverters are power converters that convert DC-Bus voltage to AC voltage. The PWM inverter's DC-Bus capacitor functions as an energy barrier to stabilize and keep the DC-Bus voltage at a relatively constant level. Therefore, the large capacitance of the electrolytic capacitors is often used as DC-Bus capacitors. Due to the limited life expectancy of the inverter, the high capacity of the electrolytic capacitor in the DC-Bus has an impact on the reliability of the inverter. In addition, when using a three-phase passive rectifier, excessive DC-Bus capacitance results in an increase in the total harmonic distortion (THD) of the input supply current such as a three-phase diode rectifier. As a result, a lot of effort was put into replacing electrolytic capacitors with small film capacitors that have a longer lifetime<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>.</p><p id="Par5">Nevertheless, if the power inductance is important compared to the DC-Bus capacitor, the DC-Bus voltage of the inverter may get unbalanced, resulting in an overvoltage or undervoltage. Failure owing to the reduced DC-Bus capacitance may occur. As the constant power load has a negative dynamic impedance characteristics, this problem becomes a quite significant when the inverter supplies high power to it<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. Because of this negative impedance feature, when the DC-Bus voltage increases and the DC-Bus current decreases, ensuring that the load's power remains constant. On the DC-Bus, this response might result in overvoltage or undervoltage. Negative impedance features can be avoided by creating an input filter whose parameters match the stability requirement<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. If the filter settings are fixed, passive damping resistors can be used to modify the impedance of the system. Passive damping resistors, on the other hand, always add to the system's losses.</p><p id="Par6">In<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, the fluctuating DC-Bus voltage was actively stabilized by modifying the DC-Bus dynamic impedance to be positive. Since the output power is related to the output current, modifying the current command in<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> may be used to change impedance. If the DC-Bus voltage oscillation frequency exceeds the current control bandwidth, voltage commands are revised rather than the current commands<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. These techniques, on the other hand, presume that the input source voltage is constant DC while using linearized control law. This presumption results in the inverter's dynamic impedance to be dependent on the variation of the DC-Bus voltage since the changed impedance is exactly proportional to the DC-Bus voltage. Furthermore, under the control legislation, the technique in<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> mandates the usage of load impedance.</p><p id="Par7">Speedy load changes can potentially cause the DC-Bus to overvoltage or undervoltage<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. The DC-Bus voltage will reduce the substantially if the output power is raised in steps, for example, since the energy stored in the capacitor is inadequate to maintain the DC-Bus voltage. The inverter response or control bandwidth) must be minimized enough to eliminate this short DC-Bus voltage fluctuation and keep it within a tolerable range. The overall performance will suffer because of the restricted control bandwidth.</p><p id="Par8">Figure <xref rid="Fig1" ref-type="fig">1</xref> depicts a 1-ph PV/BES grid-connected system with a common bus control system. To establish the output current reference, the difference between the DC-Bus voltage and the reference voltage is fed to the bus voltage controller and multiplied by the phase-locked loop (PLL) output signal. PWM signals are generated by this reference, which are utilized to operate the inverter via the current controller.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p>A single phase PV/BES grid-connected system with a common DC-Bus control mechanism.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par9">On the other hand, maximizing the PV power is always going to be challenging. To optimize PV power, researchers have proposed a variety of MPPT algorithms, including Fractional short-circuit current (FSCC), Fractional open-circuit voltage (FOCV), fuzzy logic (FL), neural network (NN), perturb and observe (P&amp;O), and incremental conductance (IC)<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. The simplest maximum power point tracking (MPPT) algorithms FSCC and FOCV are relying on the linearity of short-circuit current or open-circuit voltage to the MPP’s current or voltage. However, the PV panel is isolated using these methods, nevertheless, in order to detect the voltage or short-circuit current. Consequently, the periodic isolation of the panel causes an increase in energy loss<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. As an alternative, fuzzy logic and neural networks are able to handle the nonlinearity of the PV panel and produce a consistent MPPT approach. The efficiency of this approach heavily depends on selecting the proper error calculation and a suitable rule foundation, which is fuzzy logic's fundamental weakness<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The data required for the training process for each PV array and location must be specifically gathered, and as PV features vary over time, the neural network must be trained on a regular basis<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Neural networks also have a number of other drawbacks. P&amp;O and IC, on the other hand, are often utilized. These methods make use of the PV panel's feature. When the MPP is identified for P&amp;O, steady-state oscillations are developed because of the disturbance caused by this approach to keep the MPP, which in turn causes an increase in power loss<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. For IC, it is supported by the fact that the maximum power has a slope of P–V characteristic of zero, and theoretically, there is no disturbance once the MPP is discovered. As a result, oscillations are reduced. Due to a digital processing issue called truncation, the zero value on the slope of the P–V characteristic is seldom ever observed during implementation. As a result, when the irradiation is abruptly increased, the IC method may provide an erroneous response<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. As a result, this study also intends to develop and put into practice a modified MIC algorithm that can correct the incorrect reaction that the traditional incremental conductance (TIC) algorithm makes when the irradiance is quickly raised. In order to identify the rise in solar irradiation, this article suggests a novel method. Instead of using the slope of the P-V characteristic, the fluctuation of voltage and current are employed to detect the increase in irradiation. The modified algorithm recognizes the rise in irradiance and renders an accurate judgment. Additionally, a small error is permitted in order to ensure that the slope is almost zero and to reduce steady-state oscillations.</p><p id="Par10">On the other hand, this research proposed a novel DC-Bus voltage stabilizing technique under small capacitor. The stabilization is essentially based on the d-q current control for a single-phase inverter using flowchart decision logic for both the PV power system and state of charge (SOC) of battery storage system. The reason behind this is to ensure smooth transfer of power from the DC part to the AC part and vice versa as well as eliminate the effect of (grid) source voltage variation, both the estimated PV power system and SOC are used in the control law. Additionally, to eliminate the transient DC-Bus voltage ripples to an acceptable range, a simple DC-Bus voltage regulation method is also proposed based on a modified incremental conductance (MIC). Finally, BES was used to maintain a reliable and stable harvest from PV modules for loads while also improving the entire generation system’s dynamic performance. With the proposed method, the inverter can be kept operating with reduced DC-Bus capacitor.</p><p id="Par11">The major contributions of this research are summarized as follows:<list list-type="order"><list-item><p id="Par12">Proposed a simple new control method for d-q current control for a single-phase PV/BES grid-connected system using flow chart decision logic for both the PV power system and SOC of BES to ensure smooth power transfer from the DC part to the AC part and vice versa.</p></list-item><list-item><p id="Par13">Applied MIC technique for tracking the maximum power point through controlling the duty ratio of the DC-DC boost converter to improve the efficiency of the hybrid PV/BES energy system and suppress the ripples in DC-bus voltage under rapid changing environmental condition.</p></list-item><list-item><p id="Par14">For validation purpose, the proposed MIC algorithm was compared with variable step size incremental conductance (VSZIC), TIC algorithm and meta-heuristic algorithms (i.e. cuckoo search (CS), grey wolf optimization (GWO) particle swarm optimization (PSO) and water cycle algorithm (WCA)) as well as P&amp;O method for tracking the global power under several different irradiance and temperature patterns.</p></list-item><list-item><p id="Par15">BES used to maintain a reliable and stable output power generated from the PV systems for varying loads while also improving the entire system’s dynamic performance.</p></list-item></list></p></sec><sec id="Sec2"><title>Effects of reduced DC-Bus capacitor</title><p id="Par16">In standalone and grid-connected PV structures, DC-Bus capacitor is the extremely important passive component. Harmonics and power factor reduction occur in single-phase PV inverters because the DC bus voltage exhibits a double frequency ripple. In order to reduce this ripple, large electrolytic capacitors, which have short lifetimes, are often used at the DC bus. To increase the lifetime of inverters, it is necessary to replace electrolytic capacitors with thin film capacitors, which have long life and low capacitance. This will result in three important outcomes: (1) size reduction, (2) cost reduction , and (3) dependability increase. The proposed high-power film capacitor may therefore be used to integrate the PV and inverter into a grid-connected PV system, decreasing the number of cables and their related losses and costs. On other hand, if the DC-Bus capacitor is very small, bus voltage overshoots will be large and unacceptable. There are three problems of using small DC-bus capacitor which has a low capacitance in PV/battery double stage single phase grid system which can be divided into three problems: instability of DC-bus voltage, output low-frequency ripple and system’s dynamic performance problem. Therefore, the main objective of this research is to overcome these three problems through using small DC-bus capacitor. In addition, a 10μF was used in our system because it is less than the values used in the literature. Therefore, a suitable DC-link capacitor size should be selected accurately to restrict the voltage ripple with in a permissible limit and to ensure a better and reliable system performance and to achieve high power density of the system.</p><sec id="Sec3"><title>Instability analysis due to reduced DC-Bus capacitor</title><p id="Par17">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the system model, which includes the source, inverter, and load but does not include the inverter’s PWM. A current source (<inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{inv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq1.gif"/></alternatives></inline-formula>) is used to simulate the inverter and load. The analogous source impedances are <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq3.gif"/></alternatives></inline-formula>, respectively, while the DC-Bus capacitance is <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{dc\_bus}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq4.gif"/></alternatives></inline-formula>. The system’s dynamic equations are described by the following.<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L_{s} \frac{{di_{s} }}{dt} = v_{s} - R_{s} i_{s} - v_{dc}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{dc\_bus} \frac{{dv_{dc} }}{dt} = i_{s} - i_{inv}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ2.gif"/></alternatives></disp-formula><fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p>Source/Inverter/Load equivalent model.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par18">If the load power is considered constant as <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq5.gif"/></alternatives></inline-formula> , the inverter output current,<inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ }i_{inv}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq6.gif"/></alternatives></inline-formula> , can be indicated as<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{inv} = \frac{{P_{L} }}{{v_{dc} }} = \frac{{P_{L} }}{{v_{dc0} + \tilde{v}_{dc} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{dc0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq7.gif"/></alternatives></inline-formula> is the DC-Bus voltage’s mean value, and <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{v}_{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq8.gif"/></alternatives></inline-formula> is a DC-Bus voltage variation. If <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{v}_{dc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq9.gif"/></alternatives></inline-formula> is comparatively small to its mean value, the inverter output current can be linearized as Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>).<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">inv</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≅</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{inv} = \frac{{P_{L} }}{{v_{dc0} + \tilde{v}_{dc} }} \cong \frac{{P_{L} }}{{v_{dc0} }} - \frac{{P_{L} }}{{v_{dc0}^{2} }}\tilde{v}_{dc}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ4.gif"/></alternatives></disp-formula></p><p id="Par19">The constant power demand works as a negative impedance against DC-Bus voltage change, as indicated in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>).</p><p id="Par20">The dynamic Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) equations are the feature equations in the linearized inverter current.<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s^{2} + (\frac{{R_{s} }}{{L_{s} }} - \frac{{P_{L} }}{{C_{dc\_bus} v_{dc0}^{2} }})s + (\frac{{v_{dc0}^{2} - R_{s} P_{L} }}{{L_{s} C_{dc\_bus} v_{dc0}^{2} }}) = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ5.gif"/></alternatives></disp-formula></p><p id="Par21">The DC-Bus capacitor's stability requirement may be calculated using Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>).<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{dc\_bus} &gt; \frac{{L_{s} P_{L} }}{{R_{s} v_{dc0}^{2} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ6.gif"/></alternatives></disp-formula></p><p id="Par22">As a result, if the inverter’s capacitance fails to meet the principle in Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>), the system conditions, with the DC-Bus voltage, become unbalanced or fluctuating. As a result, overvoltage breakdown can ruin semiconductor switches such as IGBTs.</p><p id="Par23">In this study, the maximum permitted voltage ripple and input dc voltage are used to determine the size of the DC-Bus capacitor. It is observed that when the DC input voltage rises, the capacitance decreases, increasing the voltage ripple. Therefore, it is important to select a proper DC-Bus capacitor size to keep the voltage ripple within a reasonable range, to provide better and more reliable system operation, and to maximize the system's power density. Additionally, the grid-connected inverter selected for our research has a 10µF capacitor size according to the calculation. This study also discusses the various types of capacitors used as DC-Bus, along with their benefits and drawbacks. Equation (<xref rid="Equ7" ref-type="disp-formula">7</xref>) demonstrates that the nominal DC-Bus voltage and voltage ripple have an inverse relationship with the capacitance of the DC-Bus capacitor. As a result, a higher DC-Bus voltage results in a capacitor with a smaller capacitane which in turn has a higher voltage ripple. If the voltage ripple is not correctly managed, it might impair the PV generator's maximum power point functioning. Typically, to get the best output of a PV generator, the magnitude of voltage ripple should be kept around 5%.<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">dc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{dc\_bus} = \frac{S}{{2\omega_{ac} V_{dc} + \tilde{v}_{dc} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ7.gif"/></alternatives></disp-formula></p></sec><sec id="Sec4"><title>The trade-off between total harmonic distortion and fluctuations in the DC-Bus</title><p id="Par24">For simplicity, the power stages are considered perfect in this section, and losses are ignored. According to the functioning of the common control loop in the DC-Bus that is represented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the grid output current, <italic>i</italic><sub><italic>g</italic></sub>, can be determined in Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>).<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{g} = i_{g,pk} (t)\sin (\omega_{ac} t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ8.gif"/></alternatives></disp-formula></p><p id="Par25">According to the power balancing, the frequency ripple’s peak-to-peak value which appears on the DC-Bus voltage can be calculated using Eq.(<xref rid="Equ8" ref-type="disp-formula">8</xref>)<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>.<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta V_{P - P} = \frac{{P_{PV} }}{{\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{PV}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq10.gif"/></alternatives></inline-formula> is the input power generated, <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega_{ac}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq11.gif"/></alternatives></inline-formula> is the grid frequency, <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{dc\_bus}^{ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq12.gif"/></alternatives></inline-formula> is the average DC-Bus voltage, and <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{dc\_bus}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq13.gif"/></alternatives></inline-formula> is the DC-Bus capacitance. The DC-Bus voltage, <italic>v</italic><sub><italic>bus</italic></sub>, can then be approximated by Eq. (<xref rid="Equ10" ref-type="disp-formula">10</xref>).<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="italic">bus</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{bus} (t) \approx V_{dc\_bus}^{ref} + \frac{{P_{PV} }}{{2\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}\sin (2\omega_{ac} t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ10.gif"/></alternatives></disp-formula></p><p id="Par26">The DC-Bus voltage’s double frequency term is then fed to the bus control loop which results in a steady-state grid peak current as:<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{g,pk} (t) = I_{g,pk} + \left| {G(j2\omega_{ac} )} \right|.\frac{{P_{PV} }}{{2\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}\sin (2\omega_{ac} t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ11.gif"/></alternatives></disp-formula></p><p id="Par27">where |<italic>G</italic>(<italic>j</italic>2 <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega_{ac}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_IEq14.gif"/></alternatives></inline-formula>)| is the gain of DC-Bus control loop in the second harmonic frequency, and <italic>I</italic><sub><italic>g,pk</italic></sub> is the grid output current’s average amplitude, which possibly expressed in terms of grid voltage’s amplitude (<italic>V</italic><sub><italic>g,pk</italic></sub>) and input or output power in the preceding equation. The grid output current can be indicated from Eq. (<xref rid="Equ12" ref-type="disp-formula">12</xref>)<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> by substituting Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>) into Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) and utilizing trigonometric formulae.<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:msqrt><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>.</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfenced><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{g} (t) = \left( {\sqrt {\left( {\frac{{2P_{PV} }}{{V_{g.pk} }}} \right)^{2} + \left( {\frac{{P_{PV} \left| {G(j2\omega_{ac} )} \right|}}{{4\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}} \right)^{2} } } \right)\sin (2\omega_{ac} t) + \frac{{P_{PV} \left| {G(j2\omega_{ac} )} \right|}}{{4\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}\cos (3\omega_{ac} t)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par28">In the grid single-phase applications, the output current’s third harmonic is dominant, and the other harmonics can be ignored. As a result, Eq. (<xref rid="Equ13" ref-type="disp-formula">13</xref>) can be used to compute the output current THD<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>.<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mi>T</mml:mi><mml:mi>H</mml:mi><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>.</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$THD = \frac{{P_{PV} \left| {G(j2\omega_{ac} )} \right|}}{{4\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }} \times \left( {\left( {\frac{{2P_{PV} }}{{V_{g.pk} }}} \right)^{2} + \left( {\frac{{P_{PV} \left| {G(j2\omega_{ac} )} \right|}}{{4\omega_{ac} V_{dc\_bus}^{ref} C_{dc\_bus} }}} \right)^{2} } \right)^{ - 0.5}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ13.gif"/></alternatives></disp-formula></p><p id="Par29">The Taylor series-based linear approximation of Eq. (<xref rid="Equ13" ref-type="disp-formula">13</xref>) is presented in Eq. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) and is accurate for THD values less than 20%<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>.<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mi>T</mml:mi><mml:mi>H</mml:mi><mml:mi>D</mml:mi><mml:mo>≈</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>8</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ac</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$THD \approx \left( {\frac{{V_{g,pk} }}{{8\omega_{ac} V_{dc\_bus}^{ref} }}} \right).\frac{{\left| {G(j2\omega_{ac} )} \right|}}{{C_{dc\_bus} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ14.gif"/></alternatives></disp-formula></p><p id="Par30">As the gain increases, the DC-Bus control loop becomes faster which minimizes the DC-Bus voltage/over/undershoot in the transient response while increasing the output current’s THD at steady-state<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>. In Eq. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) there is a trade-off in the steady-state response between bus voltage over/undershoots and THD of the output current in the transient response. The use of a standard PI controller as the DC-Bus controller has the straightforward consequence that it is impossible to lower these two values at the same time<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>.</p></sec></sec><sec id="Sec5"><title>Control of power converters</title><p id="Par31">In this part, a PV/BES grid-connected system is presented to remove the previously discussed trade-off and minimize DC-Bus capacitance. The proposed PV/BES grid-connected system is described in Fig. <xref rid="Fig3" ref-type="fig">3</xref> as a block diagram. The subsections below discuses several aspects of this diagram.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p>The block diagram of the proposed PV/BES grid-connected system.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig3_HTML.png" id="MO3"/></fig></p><sec id="Sec6"><title>DC/DC (step-up) boost converter control</title><p id="Par32">The DC/DC step-up converter is controlled to provide maximum power extraction from the PV system. The MPPT method is attained based on modifying the incremental conductance (IC) algorithm<sup><xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>, which uses a PI controller to modify the duty ratio of the step-up converter such that the output power of PV system consistently follows the MPPT-generated reference value. The overall step-up converter circuit and control blocks are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p>DC/DC boost converter with MPPT tracking.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig4_HTML.png" id="MO4"/></fig></p><p id="Par33">The slope of the PV curve is detected using the IC technique. The global maximum power point (GMPP) was tracked by looking for the PV curve’s peak. In this MPPT method, the instantaneous conductance (I/V) and incremental conductance (dI/dV) are used. These two quantities are used by the MPPT method to locate the operating point of the PV array in the PV curve. Equation (<xref rid="Equ15" ref-type="disp-formula">15</xref>) describes the PV array operation at MPP. Consequently, Eq. (<xref rid="Equ16" ref-type="disp-formula">16</xref>) indicates that the PV array is operating on the left side of the MPP; and Eq. (<xref rid="Equ17" ref-type="disp-formula">17</xref>) indicates that it is on the right side of the MPP<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR35">35</xref></sup>.<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>I</mml:mi><mml:mi>V</mml:mi></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dI}{{dV}} = - \frac{I}{V}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ15.gif"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>I</mml:mi><mml:mi>V</mml:mi></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dI}{{dV}} &gt; - \frac{I}{V}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mi>I</mml:mi><mml:mi>V</mml:mi></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dI}{{dV}} &lt; - \frac{I}{V}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ17.gif"/></alternatives></disp-formula></p><p id="Par34">The preceding equations are derived from the idea that the slope at MPP is zero of the PV curve, as demonstrated in Eq. (<xref rid="Equ18" ref-type="disp-formula">18</xref>)<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dP}{{dV}} = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ18.gif"/></alternatives></disp-formula></p><p id="Par35">The following equations can be found by rewriting Eq. (<xref rid="Equ18" ref-type="disp-formula">18</xref>).<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dP}{{dV}} = I\frac{dV}{{dV}} + \frac{dI}{{dV}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ19.gif"/></alternatives></disp-formula><disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dP}{{dV}} = I + V\frac{dI}{{dV}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I + V\frac{dI}{{dV}} = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ21.gif"/></alternatives></disp-formula></p><p id="Par36">Equation (<xref rid="Equ21" ref-type="disp-formula">21</xref>) is used to identify the MPP in the TIC approach, and the Flowchart of the TIC technique is illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref>(a). The sensors of the MPPT controller are the output PV voltage and current. If Eq. (<xref rid="Equ16" ref-type="disp-formula">16</xref>) is fulfilled, the converter’s duty cycle should be reduced, and vice versa if Eq. (<xref rid="Equ17" ref-type="disp-formula">17</xref>) is met. The duty cycle remains unchanged if Eq. (<xref rid="Equ21" ref-type="disp-formula">21</xref>) is fulfilled.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p>Flowcharts for (<bold>a</bold>) TIC algorithm and (<bold>b</bold>) VSZIC algorithm.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig5_HTML.png" id="MO5"/></fig></p><p id="Par37">The VSZIC approach developed in<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> can improve the MPPT controller’s tracking speed. Figure <xref rid="Fig5" ref-type="fig">5</xref>(b) depicts the VSZIC algorithm’s flowchart. The algorithm sequences are generally comparable to standard incremental conductance, with the exception of the step size computation. The variable step size approach uses Eq. (<xref rid="Equ22" ref-type="disp-formula">22</xref>) to change the step size of the duty cycle, where N is the scaling factor.<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Step = N^{*} abs(dP/dV)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ22.gif"/></alternatives></disp-formula></p><sec id="Sec7"><title>The weakness of TIC and VSZIC</title><p id="Par38">The IC approach detects the MPP by looking at the slope of the PV curve. If the algorithm indicates that the operational point is at the top of the P-V curve (slope = 0) and Eq. (<xref rid="Equ18" ref-type="disp-formula">18</xref>) is fulfilled, then the DC–DC converter's duty cycle is fixed, and no fluctuation happens until the slope variations. However, as highlighted in<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>, the zero slope criteria is seldom met in reality due to numerical differentiation truncation error.</p><p id="Par39">Apart from steady-state oscillation, when the sun irradiation rises, the TIC algorithm becomes confused. When the irradiance is 500 W/m<sup>2</sup>, the MPPT method changes the duty cycle such that the PV system works at load-2 line and the maximum power point (point B) is fully tracked, as illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. If the sun irradiation rises with time, but the duty cycle remains at load-2 line, load-2 line will intersect with the 1000 W/m<sup>2</sup> I-V curve at (point G), which matches to the power at (point C) in the P-V curve. The gradient between (points B and C) is determined using the TIC approach which gives a positive gradient, and the power obtained by load-2 line is at (point C). The gradient between (point C) and the 1000 W/m2 MPP (point A) is negative. Therefore, the usual incremental conductance technique responds to new gradient and rises the voltage of the PV module without realizing this inaccuracy. As a result, when the sun radiation levels vary from low to high, the standard method implements an erroneous initial step change. When the sun radiation level drops from high to low, nevertheless, this problematic does not arise. The reason for this is that the gradient is positive from (points E to H), or from (points A to D) on the P–V curve. (Points B and D) have a positive gradient as well.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p>The P–V and I-V curves under radiation 1000 W/m<sup>2</sup> and 500 W/m<sup>2</sup>.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig6_HTML.png" id="MO6"/></fig></p></sec><sec id="Sec8"><title>Proposed modified incremental conductance (MIC) algorithm</title><p id="Par40">The slope of the P-V curve, which is influenced by load resistance and solar radiation, is used in the IC method. The PV module’s current and voltage are used in the computation by the algorithm. As a result, the influence of solar radiation and load variations on the PV module’s current and voltage must be carefully addressed in the algorithm.</p><p id="Par41">Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the variations in the PV module’s voltage and current as a function of solar radiation level and load resistance. Once the PV system is running at (point F) of the load-2 line and solar radiation unexpectedly rises, the PV system’s operating point shifts to (point G), as illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. As a result, both voltage and current rise. On the contrary, once the PV system is running at (point E) of the load-1 line and solar radiation unexpectedly drops, the PV system’s operating point shifts to (point H). As a result, both voltage and current drop. These two sorts of variations are not effectively explored in the TIC technique. In the meantime, if the PV system is operating on load-1 line and the load resistance rises, the PV will be switched to load-2 line, and as a result, the PV panel’s voltage rises while the PV panel’s current falls. When the load resistance falls, the current increases and the voltage decreases.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>The variation of PV panels voltage and current as solar radiation and load resistance variation.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameters conditions</p></th><th align="left"><p>Variations of voltage (dV)</p></th><th align="left"><p>Variations of current (dI)</p></th></tr></thead><tbody><tr><td align="left"><p>Increase solar radiation</p></td><td align="left"><p>Increase</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Decrease solar radiation</p></td><td align="left"><p>Decrease</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Increase load resistance</p></td><td align="left"><p>Increase</p></td><td align="left"><p>Decrease</p></td></tr><tr><td align="left"><p>Decrease load resistance</p></td><td align="left"><p>Decrease</p></td><td align="left"><p>Increase</p></td></tr></tbody></table></table-wrap></p><p id="Par42">To remove the steady-state oscillation, a permissible error is used. Equation (<xref rid="Equ21" ref-type="disp-formula">21</xref>) can be rewritten as:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">dI</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dV</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I + V\frac{dI}{{dV}} &lt; 0.06$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_22952_Article_Equ23.gif"/></alternatives></disp-formula></p><p id="Par43">With a step size of 0.005 of the duty cycle, the steady-state error in the proposed MIC approach is around (0.7%) using the allowable error of 0.06. Using (1Soltech 1STH-250-WH) PV array, simulation data were gathered to choose the appropriate step size of the duty cycle for the suggested system. When the duty cycle is adjusted at the MPP, three dissimilar types of step sizes were assumed: 0.001, 0.005, and 0.01. However, the MPP may be efficiently tracked in any step size. Among all of the available step sizes, the 0.005 step size demonstrates that the variation in PV module power is the most acceptable, and the controller can respond accurately and quickly when employing it. As a result, the duty cycle step size in the system was set to 0.005. The allowable error in Eq. (<xref rid="Equ23" ref-type="disp-formula">23</xref>) was set using the lowest slope value. For the 0.005 step size, the minimal slope value is 0.0527. As a result, the allowable error is set at 0.06 to prevent the step size from altering when the slope value is less than this permitted error.</p><p id="Par44">Finally, the Flowchart of the proposed MIC method is depicted in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. A flag value is initially adjusted to be zero. When it sets to 1.0, this flag value shows that the MPP has been achieved. If the flag value is zero, Eq. (<xref rid="Equ23" ref-type="disp-formula">23</xref>) is used to execute the TIC technique. The system works at the MPP when the criterion in Eq. (<xref rid="Equ23" ref-type="disp-formula">23</xref>) is met. As a result, the algorithm first sets the flag to 1.0 before proceeding to the enhanced procedure. The program continues to examine the condition of Eq. (<xref rid="Equ23" ref-type="disp-formula">23</xref>) in the modified procedure. The duty cycle is not changed if the solar irradiance and load resistance stay unchanged. The algorithm sets the flag value to zero when changes in solar irradiation or load occur, and then regulates the variations in the PV module’s voltage and current. If the algorithm detects an increase in both current and voltage, the duty cycle is increased as well. As a result, the IC method has been tweaked to compensate for the erroneous response caused by the increased solar irradiation.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p>Flowchart of the proposed MIC algorithm.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig7_HTML.png" id="MO7"/></fig></p></sec></sec><sec id="Sec9"><title>Flowchart decision logic based control scheme for PV/BES grid-connected inverter</title><p id="Par45">Figure <xref rid="Fig8" ref-type="fig">8</xref> depicts a diagram of the proposed inverter control structure while Table <xref rid="Tab2" ref-type="table">2</xref> shows the PI control parameters of the inverter. The grid is connected to the current regulated voltage source inverter. The grid current and voltage are monitored here and sent to the control circuit, which in turn generates the pulse width modulated (PWM) signals required for the current controlled inverter. The sine/cosine signal necessary for Park and Inverse Park transformations is generated using the grid voltage. The feedback signal is calculated from the basic in-phase and quadrature component of grid current, which is then translated to a d-q synchronous reference frame. The PI controller receives the error in d-q currents. Non-interactive control eliminates the influence of voltage loss across the inductance. The PI output, coupling term, and grid voltage make up the whole control signal in the direct axis.<fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p>Schematic of proposed d-q control technique.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig8_HTML.png" id="MO8"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>The PI controller parameters for inverter and DC/DC bidirectional converter.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2"><p>Inverter</p></th><th align="left" colspan="2"><p>DC/DC bidirectional converter</p></th></tr><tr><th align="left"><p>Parameters</p></th><th align="left"><p>Tuned</p></th><th align="left"><p>Parameters</p></th><th align="left"><p>Tuned</p></th></tr></thead><tbody><tr><td align="left"><p><italic>Kp</italic></p></td><td align="left"><p>3</p></td><td align="left"><p><italic>Kp</italic></p></td><td char="." align="char"><p>0.00001</p></td></tr><tr><td align="left"><p><italic>Ki</italic></p></td><td align="left"><p>27</p></td><td align="left"><p><italic>Ki</italic></p></td><td char="." align="char"><p>0.05</p></td></tr></tbody></table></table-wrap></p><p id="Par46">As presented in the flowchart of (Fig. <xref rid="Fig9" ref-type="fig">9</xref>), some decision logics are implemented to send power from the PV-BES system to the grid via an inverter and LCL filter and also receive power from the grid to the battery and DC load when the PV system is unavailable. Therefore, the power of the PV system and the SOC of the battery were measured and compared with some defined value as shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Figure 9</label><caption xml:lang="en"><p>Flowchart of decision logic based control scheme for grid-connected inverter.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig9_HTML.png" id="MO9"/></fig></p></sec><sec id="Sec10"><title>The BES bidirectional buck/boost converter control</title><p id="Par47">A buck/boost converter circuit with two PI controllers is used to manage the charging/discharging of the BES, as shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. Table <xref rid="Tab2" ref-type="table">2</xref> shows the PI control parameters of the bidirectional Buck/Boost converter.<fig id="Fig10"><label>Figure 10</label><caption xml:lang="en"><p>The bidirectional buck/boost converter circuit.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig10_HTML.png" id="MO10"/></fig></p><p id="Par48">The DC-Bus voltage error was handled by PI gains, <italic>Kp</italic> and <italic>Ki</italic>, during disturbances at the DC-Bus such that the DC-Bus voltage followed the voltage set point (<italic>V</italic><sub><italic>dc-ref</italic></sub> = 400 V), as seen in the Fig. <xref rid="Fig11" ref-type="fig">11</xref>. The PWM generation circuit receives the output signal from the PI controller, which is then utilized to decide between buck and boost mode of operation. To engross power from the DC-Bus, switch S<sub>1</sub> is activated and S<sub>2</sub> is deactivated during step-up discharge mode, whereas S<sub>2</sub> is triggered and S1 is deactivated during step-down charge mode.<fig id="Fig11"><label>Figure 11</label><caption xml:lang="en"><p>Bidirectional buck/boost converter control.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig11_HTML.png" id="MO11"/></fig></p><p id="Par49">The control current <italic>I</italic><sub><italic>dc</italic></sub> that flows to the capacitor <italic>C</italic><sub><italic>dc_bus</italic></sub> is adjusted to its reference current <italic>I</italic><sub><italic>dc_Ref</italic></sub> in order to regulate the DC-Bus voltage <italic>V</italic><sub><italic>dc</italic></sub> to the desired value <italic>V</italic><sub><italic>dc_busRef</italic></sub>. According to Fig. <xref rid="Fig11" ref-type="fig">11</xref>, the outer voltage loop's PI controller is used to acquire the voltage control.</p></sec></sec><sec id="Sec11"><title>Results and discussion</title><p id="Par50">A case study was conducted in this work to prove the effectiveness and robustness of the suggested strategy utilizing MATLAB/ Simulink. The components of the suggested hybrid approach include a PV module, a DC-DC step-up converter, a DC-Bus, a BES and its bidirectional DC-DC converter, an inverter controller, and load modelling. The PV module's job is to provide electricity to the load, while the BES's job is to charge and discharge to store and release energy. Figure <xref rid="Fig3" ref-type="fig">3</xref> depicts a block schematic of the proposed system.</p><p id="Par51"><xref ref-type="supplementary-material" rid="MOESM1">Supplementary Information</xref> below has more details on the detailed models. The simulations are run under the next testing conditions to further demonstrate the performance of the proposed methods: first, the proposed MIC tested comparing to the TIC and VSZIC methods in term of steady state oscillations and tracking speed).second, the proposed MIC tested compared the meta heuristic algorithms as well as P&amp;O in term of : (1) temperature fixed at 25 °C and the variation of solar radiation; (2) the solar radiation fixed at 1000 W/m<sup>2</sup> and variation temperature; (3) constant temperature and radiation with variation in load current.</p><sec id="Sec12"><title>Performance of the proposed MIC, TIC and VSZIC methods during steady state oscillations and tracking speed</title><p id="Par52">In order to asses the performance of the three methodologies and compare their differences, simulation is carried out at different low and high solar radiation levels. The variable step size's scaling factor, N, is 0.03 and the MPPT controller's sampling time is 0.05 s. The TIC and MIC algorithms use duty cycle steps of 0.005 for the converter. The simulation results of the TIC  approach are shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(a). The radiation is set at 800 W/m<sup>2</sup> at the begining of the simulation, and the MPP is attained at t = 0.6 s. The duty cycle varies from 0.38 to 0.4. The PV module's power (1555–1560 W) and oscillates at the same time. The radiation is raised to 1000 W/m<sup>2</sup> at time t = 1 s, while the duty cycle stays at 0.38. As a result, the PV module's power rises. The TIC algorithm samples the MPPT controller at time t = 1.75 s. The first step shift in the duty cycle is unclear and elicits incorrect reactions. As a result, the PV module's power is reduced, as indicated by point A in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(a). The algorithm then reverses its course and boosts the PV module's power. The MPP for solar irradiation of 1000 W/m<sup>2</sup> is obtained at t = 1.5 s. The power of the PV module oscillates between (1992 and 1924 W) once more. When the radiation drops to 800 W/m<sup>2</sup> at time t = 2 s, the TIC method performs as expected.<fig id="Fig12"><label>Figure 12</label><caption xml:lang="en"><p>Simulation results: (<bold>a</bold>) TIC algorithm. (<bold>b</bold>) VSZIC algorithm. (<bold>c</bold>) Proposed MIC algorithm.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig12_HTML.png" id="MO12"/></fig></p><p id="Par53">Results of the VSZIC are displayed in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(b). The MPP is attained at t = 0.9 s when the radiation is adjusted to 1000 W/m<sup>2</sup>. The duty cycle varies between 0.5 and 0.6. Because Eq. (<xref rid="Equ21" ref-type="disp-formula">21</xref>) is used in the method, the duty cycle changes get less, as the operating point gets closer to the peak. As a result, it is also discovered that as time passes, the fluctuation in the power of the PV module (1550–1560 W, point D) gets reduced. The radiation rises to 1000 W/m<sup>2</sup> at t = 1 s. The MPPT controller, as seen in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(b), point C, experiences the same issue that the VSZIC algorithm does with the inaccuracies in duty cycle adjustments. This is a result of the algorithm sequence utilized during the variation in radiation, which is comparable to the TIC method. The power of the PV module oscillates while it is operating in steady state around (1596–1598 W). When the radiation intensity lowers to 800 W/m<sup>2</sup>, it can respond precisely and even more quickly due to the algorithm's use of varying step sizes.</p><p id="Par54">The proposed MIC algorithm's simulation results are shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(c). The MPP for 800 W/m<sup>2</sup> is obtained and the duty cycle is kept at 0.388 at t = 0.3 s. The PV module's power is kept constant at 1600 W. Because of the decreased steady-state oscillation, the power losses are smaller. The radiation increases to 1000 W/m2 at time t = 1 s. The rise in radiation is then accurately detected by the suggested technique at t = 1.042 s, as seen in Fig. <xref rid="Fig12" ref-type="fig">12</xref>(c), point E. As a result, the power is raised from the first step until the MPP is attained at t = 1.042 s, and the power of the PV module is fixed at 2000 W. The MPP can be reached by the proposed MIC method in just four stages. When compared to the TIC and VSZIC algorithms, which require six steps and five steps respectively, the proposed algorithm responds to changes in radiation more quickly. When the radiation level increases, the proposed MIC method is 0.1 s quicker than the TIC algorithm. Furthermore, when the allowable error approaches 0.06, the steady-state oscillation is minimized.</p><p id="Par55">The proposed method reaches the MPP in four steps. Also, it responds more quickly to changes in solar irradiance than the traditional and variable step size algorithms, which need six and five steps, respectively. During an increase in sun irradiance, the proposed algorithm converged 0.1 s quicker than the conventional algorithm. In addition, the steady-state oscillation is diminished when the permitted error reaches 0.06. Lastly, the computational time required by the proposed algorithm is only 4 instructions longer than the conventional algorithm, which are (1) initialize the flag value to zero, (2) check the flag value is equal to one or zero, (3) clear the flag value if the permitted error is not met, and (4) check the variation in both the current and voltage of PV modules. The proposed method detects the direction of fluctuation in voltage and current before raising or reducing the duty cycle at the next sample time, directly after changes in solar irradiance. In the meanwhile, the traditional algorithm responds instantly following the variation in sun irradiance at the subsequent sampling time.</p><p id="Par56">The accurate response time for a sharp radiation rise in order to catch the global peak (GP) can be seen in the Fig. <xref rid="Fig12" ref-type="fig">12</xref> and Table <xref rid="Tab3" ref-type="table">3</xref>. The proposed method responds accurately and faster when the solar irradiation level increases. Moreover, the proposed algorithm shows zero oscillation in the power of the solar module after the maximum power point (MPP) is tracked by using a small permitted error.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Experimental performance during radiation patterns for MIC with TIC and VSZIC algorithms.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="3" colspan="2"><p>Overall performance</p></th><th align="left" colspan="3"><p>Time interval</p></th><th align="left" rowspan="4"><p>Average of responding time (s)</p></th></tr><tr><th align="left"><p>Pattern_1</p></th><th align="left"><p>Pattern_2</p></th><th align="left"><p>Pattern_3</p></th></tr><tr><th align="left"><p>0–1 s</p></th><th align="left"><p>1–2 s</p></th><th align="left"><p>2–3 s</p></th></tr><tr><th align="left" colspan="2"><p>Power at GP (W)</p></th><th align="left"><p>1596</p></th><th align="left"><p>2000</p></th><th align="left"><p>1596</p></th></tr></thead><tbody><tr><td align="left" rowspan="3"><p>Responding Time (s)</p></td><td align="left"><p>TIC</p></td><td char="." align="char"><p>0.92 s</p></td><td char="." align="char"><p>1.2 s</p></td><td char="." align="char"><p>2.09 s</p></td><td char="." align="char"><p>1.403 s</p></td></tr><tr><td align="left"><p>VSZIC</p></td><td char="." align="char"><p>0.93 s</p></td><td char="." align="char"><p>1.454 s</p></td><td char="." align="char"><p>2.12 s</p></td><td char="." align="char"><p>1.501 s</p></td></tr><tr><td align="left"><p>MIC</p></td><td char="." align="char"><p>0.2597 s</p></td><td char="." align="char"><p>1.03 s</p></td><td char="." align="char"><p>2.05 s</p></td><td char="." align="char"><p>1.113 s</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec13"><title>Irradiance variation effect</title><p id="Par57">In this scenario, the irradiance is raised between 0.9 and 3 s and dropped between 0.3 and 0.9 s to measure the effectiveness of the hybrid PV/BES system, as seen in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(a). The temperature of the PV cell is maintained at 25 °C. At these operating conditions, Fig. <xref rid="Fig13" ref-type="fig">13</xref>(b) illustrates the robustness and performance of the proposed MIC-MPPT in terms of PV output power when exposed to a fast variation in solar irradiation. The proposed MIC technique, as shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(b), can offer greater dynamic operation, quicker convergence, less operating point fluctuations at MPP, and better GP tracking capability GP under varied conditions more successfully than P&amp;O, CSA, PSO, GWO, and WCA. Under rapidly changing atmospheric conditions, the operating point will not deviate too far from MPP, and it will be more effective and robustness.<fig id="Fig13"><label>Figure 13</label><caption xml:lang="en"><p>Simulation output of radiation changes in case 1: (<bold>a</bold>) irradiance; (<bold>b</bold>) PV system output power; (<bold>c</bold>) DC-Bus voltage output; (<bold>d</bold>) battery power; (<bold>e</bold>) state of charge (%); (<bold>f</bold>) inverter output-voltage; (<bold>g</bold>) inverter current.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig13_HTML.png" id="MO13"/></fig></p><p id="Par58">The efficiency of MPPT approaches is assessed qualitatively using simulations, taking into account the system's steady state response of the output DC-Bus voltage as shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(c). Aside from the proposed MIC algorithm and d-q current control for a single-phase inverter which are using flowchart decision logic for both the PV power system and the SOC of the battery storage system, the designed control circuit for charging/discharging of BES is achieved using a buck/boost converter with a DC-Bus capacitance of (10 µF). The bus voltage overshoot and undershoot are limited to (1 V) and (2.5 V), respectively, and the THD of the output current is reduced to less than 5%. When utilizing a traditional PI controller, it is simply not possible to use thin film capacitors on the DC-Bus. Therefore, the MIC is used in the DC-Bus control system to stop dual frequency ripples from reaching the output current control system, thus reducing the output current THD. The use of flowchart decision logic for d-q current regulation for a single-phase inverter is presented in this work to decrease DC-Bus voltage overshoot and undershoot. Because of applying the BES’s intended charging/discharging management, the dynamic performance is significantly improved without compromising grid current. Finally, employing the proposed technique, it is simply possible to use thin film capacitors on the DC-Bus.</p><p id="Par59">When the PV system is unable to supply all of the load demand, such as during solar fluctuations or transitory times, the utility grid is used as a backup source, and the BES bank is used as a short-duration power source to meet load need. It is worth noting that, as shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(d), when solar irradiation drops below a certain level, the battery is drained to give power to the local DC load and the grid, and its SOC drops (see Fig. <xref rid="Fig13" ref-type="fig">13</xref>e). In the various irradiance settings, Table <xref rid="Tab4" ref-type="table">4</xref> compares the real power levels to the proposed methodologies. In addition, as illustrated in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(f,g), the grid inverter’s output voltage and current are pure sinewaves.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>The output power of solar modules at changes radiation conditions.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Time (s)</p></th><th align="left"><p>Actual power value (W)</p></th><th align="left"><p>MIC (W)</p></th><th align="left"><p>CSA (W)</p></th><th align="left"><p>GWO (W)</p></th><th align="left"><p>WCA (W)</p></th><th align="left"><p>P&amp;O (W)</p></th><th align="left"><p>PSO (W)</p></th></tr></thead><tbody><tr><td char="–" align="char"><p>0–0.3</p></td><td char="." align="char"><p>2000</p></td><td char="." align="char"><p>1996</p></td><td char="." align="char"><p>1955</p></td><td char="." align="char"><p>1919</p></td><td char="." align="char"><p>1780</p></td><td char="." align="char"><p>1985</p></td><td char="." align="char"><p>1885</p></td></tr><tr><td char="–" align="char"><p>0.3–0.6</p></td><td char="." align="char"><p>1000</p></td><td char="." align="char"><p>995</p></td><td char="." align="char"><p>991</p></td><td char="." align="char"><p>931</p></td><td char="." align="char"><p>930</p></td><td char="." align="char"><p>989</p></td><td char="." align="char"><p>966</p></td></tr><tr><td char="–" align="char"><p>0.6–0.9</p></td><td char="." align="char"><p>20</p></td><td char="." align="char"><p>17</p></td><td char="." align="char"><p>6</p></td><td char="." align="char"><p>10</p></td><td char="." align="char"><p>5</p></td><td char="." align="char"><p>14</p></td><td char="." align="char"><p>6</p></td></tr><tr><td char="–" align="char"><p>0.9–1.2</p></td><td char="." align="char"><p>1000</p></td><td char="." align="char"><p>995</p></td><td char="." align="char"><p>986</p></td><td char="." align="char"><p>933</p></td><td char="." align="char"><p>890</p></td><td char="." align="char"><p>977</p></td><td char="." align="char"><p>979</p></td></tr><tr><td char="–" align="char"><p>1.2–3</p></td><td char="." align="char"><p>2000</p></td><td char="." align="char"><p>1996</p></td><td char="." align="char"><p>1982</p></td><td char="." align="char"><p>1918</p></td><td char="." align="char"><p>1990</p></td><td char="." align="char"><p>1983</p></td><td char="." align="char"><p>1990</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec14"><title>Temperature variation effect</title><p id="Par60">Figure <xref rid="Fig14" ref-type="fig">14</xref>(a) shows the influence of temperature fluctuations on the development of the PV array's operating point at a fixed radiation of 1000 W/m<sup>2</sup>. As demonstrated in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(b), the proposed MIC algorithm outperforms the P&amp;O, CSA, PSO, GWO, and WCA approaches in terms of tracking the system's MPP. When the cell temperature rises from 35 to 45 °C and from 15 to 55 °C, the MIC algorithm follows MPP softly with minor oscillations, compared to the mentioned techniques. Other MPPT approaches, on the other hand, deviate from the MPP during this temperature increase. The effectiveness of proposed MPPT approaches is assessed qualitatively based on simulations, taking into account the system's steady state response in the DC-bus voltage output, as illustrated in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(c). When the PV array has a big value, the battery is charged to give power to the local DC load and the grid when the PV array is not available, as illustrated in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(d), and its SOC increases as shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>(e). The inverter's output current and voltage are identical to those shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>(f,g). Table <xref rid="Tab5" ref-type="table">5</xref> compares real power outputs to the methodologies described under various temperature settings.<fig id="Fig14"><label>Figure 14</label><caption xml:lang="en"><p>Simulation output of temperature changes in case 2: (<bold>a</bold>) temperature scenarios; (<bold>b</bold>) PV system output power; (<bold>c</bold>) DC-bus voltage output; (<bold>d</bold>) battery output power; (<bold>e</bold>) the SOC % of the battery.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig14_HTML.png" id="MO14"/></fig><table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>The output power values of solar array in various temperature conditions.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Time (s)</p></th><th align="left"><p>Actual power value (W)</p></th><th align="left"><p>MIC (W)</p></th><th align="left"><p>CSA (W)</p></th><th align="left"><p>GWO (W)</p></th><th align="left"><p>WCA (W)</p></th><th align="left"><p>P&amp;O (W)</p></th><th align="left"><p>PSO (W)</p></th></tr></thead><tbody><tr><td char="–" align="char"><p>0–0.3</p></td><td char="." align="char"><p>1920</p></td><td char="." align="char"><p>1914</p></td><td char="." align="char"><p>1901</p></td><td char="." align="char"><p>1782</p></td><td char="." align="char"><p>1804</p></td><td char="." align="char"><p>1904</p></td><td char="." align="char"><p>1836</p></td></tr><tr><td char="–" align="char"><p>0.3–0.6</p></td><td char="." align="char"><p>1830</p></td><td char="." align="char"><p>1827</p></td><td char="." align="char"><p>1824</p></td><td char="." align="char"><p>1436</p></td><td char="." align="char"><p>1823</p></td><td char="." align="char"><p>1812</p></td><td char="." align="char"><p>1461</p></td></tr><tr><td char="–" align="char"><p>0.6–0.9</p></td><td char="." align="char"><p>2080</p></td><td char="." align="char"><p>2077</p></td><td char="." align="char"><p>1934</p></td><td char="." align="char"><p>2038</p></td><td char="." align="char"><p>1991</p></td><td char="." align="char"><p>2064</p></td><td char="." align="char"><p>1956</p></td></tr><tr><td char="–" align="char"><p>0.9–1.2</p></td><td char="." align="char"><p>1750</p></td><td char="." align="char"><p>1745</p></td><td char="." align="char"><p>1692</p></td><td char="." align="char"><p>1502</p></td><td char="." align="char"><p>1583</p></td><td char="." align="char"><p>1738</p></td><td char="." align="char"><p>1297</p></td></tr><tr><td char="–" align="char"><p>1.2–3</p></td><td char="." align="char"><p>2000</p></td><td char="." align="char"><p>1996</p></td><td char="." align="char"><p>1926</p></td><td char="." align="char"><p>1982</p></td><td char="." align="char"><p>1995</p></td><td char="." align="char"><p>1981</p></td><td char="." align="char"><p>1992</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec15"><title>Load variation effect</title><p id="Par61">Figure <xref rid="Fig15" ref-type="fig">15</xref>(a) shows the influence of load fluctuations on the development of the PV array's operating point at a fixed radiation of 1000 W/m<sup>2</sup> and a temperature of 25 °C. It is worth noting that, as illustrated in Fig. <xref rid="Fig16" ref-type="fig">16</xref>(b), the proposed MIC algorithm has improved performance in tracking the system's MPP. A unique approach for managing various elements of the system is suggested, which aids in adjusting the DC-Bus voltage in the event of abrupt load variations while also keeping the system more stable. The DC-Bus voltage under load variations was investigated to assess the PV array controller's robustness. In addition, since there is a small DC-Bus capacitor in the DC-Bus voltage, efforts will be made to find a feasible MIC solution to stabilize the DC-Bus voltage and minimize the power loss caused by photovoltaic voltage fluctuation in PV power generation, as well as develop the dynamic performance of the entire system, as shown in Figs<xref rid="Fig15" ref-type="fig">.15</xref>(b,c) and <xref rid="Fig16" ref-type="fig">16</xref>(a,c).<fig id="Fig15"><label>Figure 15</label><caption xml:lang="en"><p>The Current load and AC load output under load changes. (<bold>a</bold>) the load current curve. (<bold>b</bold>) grid voltage and (<bold>c</bold>) grid current.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig15_HTML.png" id="MO15"/></fig><fig id="Fig16"><label>Figure 16</label><caption xml:lang="en"><p>The DC-Bus voltage output under load changes; (<bold>a</bold>) DC-Bus voltage; (<bold>b</bold>) PV power output; (<bold>c</bold>) battery voltage.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig16_HTML.png" id="MO16"/></fig></p><p id="Par62">Finally, the resistive load is changed to confirm that the MIC algorithm is working properly. The resistive load was originally set to 100 Ohm, as illustrated in Fig. <xref rid="Fig15" ref-type="fig">15</xref>(a), and the MPP was tracked. The resistive load was then reduced to 50 Ohm. The PV module's current is boosted while the voltage is reduced. The PV array works on the PV curve's left side (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The MIC algorithm reduces the duty cycle of the converter so that it may once again follow the MPP. After that, the resistive load is changed to 80 Ohm, resulting in a drop in PV array current and a rise in PV module voltage. The PV module operates on the PV curve's right side (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).To verify the resilience of the proposed technique, the algorithm raises the duty cycle till it hits the MPP again, while the resistive load is still varied.</p></sec><sec id="Sec16"><title>Experimental Results and Analysis of the Hardware-in-Loop</title><p id="Par63">The experimental platform is set up to evaluate how well the proposed (MIC, TIC and VSZIC algorithms) strategies works. The control method is implemented using NI PXIE-1071. Hardware-In-Loop (HIL) simulation is carried out by the NI PXIE-1071 using HIL software, as shown in Fig. <xref rid="Fig17" ref-type="fig">17</xref>. The PV array, boost converter, battery, bidirectional Buck/Boost converter and inverter with LCL filter are the system’s power circuit, which is implemented by the FPGA board of the NI PXIE-1071. Using Simulink's NI standard C language code generation, the sampling and control circuit (MIC, TIC and VSZIC algorithms) based MPPT is converted into a C program and loaded into the NI PXIE-1071control board. The experimental findings are displayed on the power analyzer by connecting an external port board to a group of ports specified in NI PXIE-1071. The sample frequency used is 10 kHz.<fig id="Fig17"><label>Figure 17</label><caption xml:lang="en"><p>The configuration of Hardware-In-Loop (HIL) experiment.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/41598_2022_22952_Fig17_HTML.jpg" id="MO17"/></fig></p><p id="Par64">Two alternative scenarios were executed to test the recommended control scheme and model's behavior under various operating conditions, as well as to display the status of the various voltages, currents, power states, and harmonics of the system's components. The first depicts the system's control dynamics performance under different load conditions, while the second depicts dynamic radiation conditions at a constant load. The DC-Bus voltage capacitor's THD is reduced, as shown in Fig. <xref rid="Fig18" ref-type="fig">18</xref>. It is a critical component of power quality that should follow the grid rules as well as the nominal frequency design of the load. Even though the system is self-contained, the user must have access to high-quality electricity. The following curves shown in Fig. <xref rid="Fig18" ref-type="fig">18</xref> depict the experimental results under radiation changing situations, demonstrating the higher performance of the proposed control strategy employing MIC compared to TIC and VSZIC algorithms.<fig id="Fig18"><label>Figure18</label><caption xml:lang="en"><p>The experimental results of radiations scenarios, AC output, and the DC-Bus voltage output at various radiation levels (<bold>a</bold>, <bold>b</bold>) Proposed MIC; (<bold>c</bold>, <bold>d</bold>) TIC and (<bold>e</bold>, <bold>f</bold>) VSZIC algorithms.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_22952_Fig18_HTML.png" id="MO18"/></fig></p><p id="Par65">In Table <xref rid="Tab6" ref-type="table">6</xref>, the results of the proposed MIC technique is compared to the corresponding results from TIC, VSZIC, and other improved INC techniques proposed in the scientific literature in terms of steady-state oscillation, tracking effectiveness, response time during sudden increases in radiation, and failure of techniques under sudden increases in radiation. In comparison to existing strategies, the proposed MIC technique exhibits a much faster tracking speed, more efficiency, and no reaction to oscillations around the MPP. Therefore, only the proposed MIC algorithm and the technique proposed in<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> can produce an accurate result under a rapid rise in radiation, and in contrast to the standard approach and those proposed in<sup><xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>, which produce an inaccurate result.<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>The proposed approach comparison to various modified incremental conductance algorithms that have been proposed in published literature.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Technique</p></th><th align="left"><p>Steady-state oscillation</p></th><th align="left"><p>Response time to a sharp rise in radiation</p></th><th align="left"><p>Incorrect choice when radiation suddenly increases</p></th><th align="left"><p>Practical implementation</p></th></tr></thead><tbody><tr><td align="left"><p>TIC</p></td><td align="left"><p>Large</p></td><td align="left"><p>Slow</p></td><td align="left"><p>Yes</p></td><td align="left"><p>Yes</p></td></tr><tr><td align="left"><p>VSZIC</p></td><td align="left"><p>Small</p></td><td align="left"><p>Slow</p></td><td align="left"><p>Yes</p></td><td align="left"><p>Yes</p></td></tr><tr><td align="left"><p>Belkaid et al.<sup><xref ref-type="bibr" rid="CR38">38</xref></sup></p></td><td align="left"><p>Small</p></td><td align="left"><p>Fast</p></td><td align="left"><p>No</p></td><td align="left"><p>Yes</p></td></tr><tr><td align="left"><p>De Brito et al.<sup><xref ref-type="bibr" rid="CR39">39</xref></sup></p></td><td align="left"><p>Small</p></td><td align="left"><p>Fast</p></td><td align="left"><p>Yes</p></td><td align="left"><p>Yes</p></td></tr><tr><td align="left"><p>Sekhar and Mishra <sup><xref ref-type="bibr" rid="CR40">40</xref></sup></p></td><td align="left"><p>Small</p></td><td align="left"><p>Medium</p></td><td align="left"><p>Yes</p></td><td align="left"><p>Yes</p></td></tr><tr><td align="left"><p>Proposed MIC</p></td><td align="left"><p>No</p></td><td align="left"><p>Very fast</p></td><td align="left"><p>Yes</p></td><td align="left"><p>Yes</p></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec17" sec-type="conclusions"><title>Conclusions</title><p id="Par66">One of the main challenges in single-phase PV/BES grid-connected systems is the trade-off between DC-Bus voltage variations, total harmonic distortion (THD) of the output current, and the size of the DC-Bus capacitor. The work presented here investigates this problem and proposes a PV/BES grid-connected system that eliminates this trade-off. The DC-Bus control loop is prepared with the proposed MIC algorithm and d-q current control for this purpose. The proposed MIC algorithm operates to block the harmonics which leads to a low THD in the output current and provides a cost-effective application. Additionally, the d-q current control regulates the DC-Bus stability by controling the PV power and SOC of the battery to eliminate the fluctuations on the DC-Bus voltage. Finally, by avoiding a sudden shift in the energy of the DC-Bus capacitor in the transient reaction, the battery's bidirectional buck/boost converter can adjust the amplitude of the output current in an extremely fast manner. As a result, the dynamic performance is significantly improved while the grid current remains stable. Further, the proposed method is able to decrease the bus voltage overshoot and undershoot up to 97.4% and 90%, respectively, which minimized the DC-Bus capacitor to10-µF and reduced the THD to less than 5%. It was experimentally found that the proposed control of the MIC technique is less susceptible to the harmonic contents of the grid current, and is more robust to the line voltage drop than the conventional strategy.</p></sec></body><back><ack><title>Acknowledgements</title><p>The authors would like to acknowledge the Researchers Supporting Project number (RSP-2021/337), King Saud University, Riyadh, Saudi Arabia and Hubei Key Laboratory of Marine Geological Resources, China University of Geosciences, No. MGR202107.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>Conceptualization, I.A.-W., Z.F. and H.D.; methodology, I.A.-W. and H.M.H.F.; software, I.A.-W.; validation, H.M.H.F. and A.A.A.-S.; formal analysis, H.D.; investigation, A.M.A.-S. and T.K.; resources, Z.F.; data curation, I.A.-W.; writing—original draft preparation, I.A.-W., H.M.H.F. and A.A.A.-S.; writing—review and editing, I.A.-W., H.M.H.F. and A.A.A.-S.; visualization, T.K.; supervision, Z.F.; project administration, A.M.A.-S.; funding acquisition, A.M.A.-S. All authors have read and agreed to the published version of the manuscript.</p></sec><sec><title>Funding</title><p>This work was supported in part by the National Natural Science Foundation of China under Grants 51707138 and Researchers Supporting Project number (RSP-2021/337), King Saud University, Riyadh, Saudi Arabia.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>The datasets used and/or analysed during the current study available from the corresponding author on reasonable request.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par67">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kjaer</surname><given-names>SB</given-names></name><name><surname>Pedersen</surname><given-names>JK</given-names></name><name><surname>Blaabjerg</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">A review of single-phase grid-connected inverters for photovoltaic modules</article-title><source>IEEE Trans. Ind. Appl.</source><year>2005</year><volume>41</volume><issue>5</issue><fpage>1292</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1109/TIA.2005.853371</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Harb</surname><given-names>S</given-names></name><name><surname>Kutkut</surname><given-names>N</given-names></name><name><surname>Batarseh</surname><given-names>I</given-names></name><name><surname>Shen</surname><given-names>ZJ</given-names></name></person-group><article-title xml:lang="en">A review of power decoupling techniques for microinverters with three different decoupling capacitor locations in PV systems</article-title><source>IEEE Trans. Power Electron.</source><year>2012</year><volume>28</volume><issue>6</issue><fpage>2711</fpage><lpage>2726</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ITPE...28.2711H</pub-id><pub-id pub-id-type="doi">10.1109/TPEL.2012.2221482</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Wolfs</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">A review of the single phase photovoltaic module integrated converter topologies with three different DC link configurations</article-title><source>IEEE Trans. Power Electron.</source><year>2008</year><volume>23</volume><issue>3</issue><fpage>1320</fpage><lpage>1333</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2008ITPE...23.1320L</pub-id><pub-id pub-id-type="doi">10.1109/TPEL.2008.920883</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Farh</surname><given-names>HM</given-names></name></person-group><article-title xml:lang="en">Dynamic global maximum power point tracking of the PV systems under variant partial shading using hybrid GWO-FLC</article-title><source>Sol. Energy</source><year>2019</year><volume>177</volume><fpage>306</fpage><lpage>316</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019SoEn..177..306E</pub-id><pub-id pub-id-type="doi">10.1016/j.solener.2018.11.028</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farh</surname><given-names>HM</given-names></name><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Ibrahim</surname><given-names>AB</given-names></name><name><surname>Othman</surname><given-names>MF</given-names></name><name><surname>Al-Saud</surname><given-names>MS</given-names></name></person-group><article-title xml:lang="en">Dynamic global power extraction from partially shaded photovoltaic using deep recurrent neural network and improved PSO techniques</article-title><source>Int. Trans. Electr. Energy Syst.</source><year>2019</year><volume>29</volume><issue>9</issue><fpage>e12061</fpage><pub-id pub-id-type="doi">10.1002/2050-7038.12061</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Ibrahim, A. W., Shafik, M. B., Ding, M., Sarhan, M. A., Fang, Z., Alareqi, A. G. &amp; Al-Rassas, A. M. PV maximum power-point tracking using modified particle swarm optimization under partial shading conditions. <italic>Chin. J. Electr. Eng.</italic><bold>6</bold>, 106–121 (2020).</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Farh</surname><given-names>HM</given-names></name><name><surname>Othman</surname><given-names>MF</given-names></name></person-group><article-title xml:lang="en">A novel evaluation index for the photovoltaic maximum power point tracker techniques</article-title><source>Sol. Energy</source><year>2018</year><volume>174</volume><fpage>940</fpage><lpage>956</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018SoEn..174..940E</pub-id><pub-id pub-id-type="doi">10.1016/j.solener.2018.09.060</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Al-Wesabi</surname><given-names>I</given-names></name><name><surname>Fang</surname><given-names>Z</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Dong</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Direct sliding mode control for dynamic instabilities in DC-link voltage of standalone photovoltaic systems with a small capacitor</article-title><source>Electronics</source><year>2022</year><volume>11</volume><issue>1</issue><fpage>133</fpage><pub-id pub-id-type="doi">10.3390/electronics11010133</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krein</surname><given-names>PT</given-names></name><name><surname>Balog</surname><given-names>RS</given-names></name><name><surname>Mirjafari</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Minimum energy and capacitance requirements for single-phase inverters and rectifiers using a ripple port</article-title><source>IEEE Trans. Power Electron.</source><year>2012</year><volume>27</volume><issue>11</issue><fpage>4690</fpage><lpage>4698</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2012ITPE...27.4690K</pub-id><pub-id pub-id-type="doi">10.1109/TPEL.2012.2186640</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magableh</surname><given-names>MAK</given-names></name><name><surname>Radwan</surname><given-names>A</given-names></name><name><surname>Mohamed</surname><given-names>YARI</given-names></name></person-group><article-title xml:lang="en">Assessment and mitigation of dynamic instabilities in single-stage grid-connected photovoltaic systems with reduced DC-link capacitance</article-title><source>IEEE Access.</source><year>2021</year><volume>9</volume><fpage>55522</fpage><lpage>55536</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2021.3071056</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Bahraini, F., Abrishamifar, A., &amp; Ayatollahi, A. Fast DC bus voltage regulation for a low-cost single-phase grid-connected PV microinverter with a small dc bus capacitor. in <italic>2020 11th Power Electronics, Drive Systems, and Technologies Conference (PEDSTC) </italic>(1–6)<italic>.</italic></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khajehoddin</surname><given-names>SA</given-names></name><name><surname>Karimi-Ghartemani</surname><given-names>M</given-names></name><name><surname>Jain</surname><given-names>PK</given-names></name><name><surname>Bakhshai</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">DC-bus design and control for a single-phase grid-connected renewable converter with a small energy storage component</article-title><source>IEEE Trans. Power Electron.</source><year>2012</year><volume>28</volume><issue>7</issue><fpage>3245</fpage><lpage>3254</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013ITPE...28.3245K</pub-id><pub-id pub-id-type="doi">10.1109/TPEL.2012.2222449</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levron</surname><given-names>Y</given-names></name><name><surname>Canaday</surname><given-names>S</given-names></name><name><surname>Erickson</surname><given-names>RW</given-names></name></person-group><article-title xml:lang="en">Bus voltage control with zero distortion and high bandwidth for single-phase solar inverters</article-title><source>IEEE Trans. Power Electron.</source><year>2015</year><volume>31</volume><issue>1</issue><fpage>258</fpage><lpage>269</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016ITPE...31..258L</pub-id><pub-id pub-id-type="doi">10.1109/TPEL.2015.2399431</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daud</surname><given-names>MZ</given-names></name><name><surname>Mohamed</surname><given-names>A</given-names></name><name><surname>Hannan</surname><given-names>MA</given-names></name></person-group><article-title xml:lang="en">An optimal control strategy for DC bus voltage regulation in photovoltaic system with battery energy storage</article-title><source>Sci. World J.</source><year>2014</year><volume>2014</volume><fpage>1</fpage><lpage>16</lpage></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Sul</surname><given-names>SK</given-names></name><name><surname>Lipo</surname><given-names>TA</given-names></name></person-group><article-title xml:lang="en">AC/AC power conversion based on matrix converter topology with unidirectional switches</article-title><source>IEEE Trans. Ind. Appl.</source><year>2000</year><volume>36</volume><issue>1</issue><fpage>139</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1109/28.821808</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Piepenbreier, B. &amp; Sack, L. Regenerative drive converter with line-frequency switched rectifier and without DC link components.’ <italic>In</italic><italic>2004 IEEE 35th Annual power electronics specialists conference (IEEE Cat</italic>. 2004. 5, pp. 3917–3923).</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sudhoff</surname><given-names>SD</given-names></name><name><surname>Corzine</surname><given-names>KA</given-names></name><name><surname>Glover</surname><given-names>SF</given-names></name><name><surname>Hegner</surname><given-names>HJ</given-names></name><name><surname>Robey</surname><given-names>HN</given-names></name></person-group><article-title xml:lang="en">DC link stabilized field-oriented control of electric propulsion systems</article-title><source>IEEE Trans. Energy Convers.</source><year>1998</year><volume>13</volume><issue>1</issue><fpage>27</fpage><lpage>33</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1998ITEnC..13...27S</pub-id><pub-id pub-id-type="doi">10.1109/60.658200</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pietilainen</surname><given-names>K</given-names></name><name><surname>Harnefors</surname><given-names>L</given-names></name><name><surname>Petersson</surname><given-names>A</given-names></name><name><surname>Nee</surname><given-names>HP</given-names></name></person-group><article-title xml:lang="en">DC-link stabilization and voltage sag ride-through of inverter drives</article-title><source>IEEE Trans. Ind. Electron.</source><year>2006</year><volume>53</volume><fpage>1261</fpage><lpage>1268</lpage><pub-id pub-id-type="doi">10.1109/TIE.2006.878308</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Hinkkanen, M., Harnefors, L. &amp; Luorni, J. ‘Control of induction motor drives equipped with small DC-link capacitance.’ In <italic>2007 European Conference on Power Electronics and Applications</italic> 1–10. (2007).</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinkkanen</surname><given-names>M</given-names></name><name><surname>Luomi</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Induction motor drives equipped with diode rectifier and small DC-link capacitance</article-title><source>IEEE Trans. Ind. Electron.</source><year>2008</year><volume>55</volume><issue>1</issue><fpage>312</fpage><lpage>320</lpage><pub-id pub-id-type="doi">10.1109/TIE.2007.903959</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amir</surname><given-names>A</given-names></name><name><surname>Selvaraj</surname><given-names>J</given-names></name><name><surname>Rahim</surname><given-names>NA</given-names></name></person-group><article-title xml:lang="en">Study of the MPP tracking algorithms: Focusing the numerical method techniques</article-title><source>Renew. Sustain. Energy Rev.</source><year>2016</year><volume>62</volume><fpage>350</fpage><lpage>371</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2016.04.039</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Chauhan</surname><given-names>YK</given-names></name><name><surname>Pachauri</surname><given-names>RK</given-names></name></person-group><article-title xml:lang="en">A comparative investigation of maximum power point tracking methods for solar PV system’</article-title><source>Sol. Energy</source><year>2016</year><volume>136</volume><fpage>236</fpage><lpage>253</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016SoEn..136..236G</pub-id><pub-id pub-id-type="doi">10.1016/j.solener.2016.07.001</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verma</surname><given-names>D</given-names></name><etal/></person-group><article-title xml:lang="en">Maximum power point tracking (MPPT) techniques: Recapitulation in solar photovoltaic systems’</article-title><source>Renew. Sustain. Energy Rev.</source><year>2016</year><volume>54</volume><fpage>1018</fpage><lpage>1034</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2015.10.068</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ram</surname><given-names>JP</given-names></name><name><surname>Babu</surname><given-names>TS</given-names></name><name><surname>Rajasekar</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">A comprehensive review on solar PV maximum power point tracking techniques</article-title><source>Renew. Sustain. Energy Rev.</source><year>2017</year><volume>67</volume><fpage>826</fpage><lpage>847</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2016.09.076</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Motahhir</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Shading effect to energy withdrawn from the photovoltaic panel and implementation of DMPPT using C language</article-title><source>Int. Rev. Autom. Control</source><year>2016</year><volume>9</volume><issue>2</issue><fpage>88</fpage><lpage>94</lpage></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tey</surname><given-names>KS</given-names></name><name><surname>Mekhilef</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Modified incremental conductance MPPT algorithm to mitigate inaccurate responses under fast-changing solar irradiation level</article-title><source>Sol. Energy</source><year>2014</year><volume>101</volume><fpage>333</fpage><lpage>342</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2014SoEn..101..333T</pub-id><pub-id pub-id-type="doi">10.1016/j.solener.2014.01.003</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Rajapakse, A. D. &amp; Muthumuni, D. Simulation tools for photovoltaic system grid integration studies.’ <italic>In 2009 IEEE Electrical Power &amp; Energy Conference</italic>. 2009, (pp. 1–5).</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Farh</surname><given-names>HM</given-names></name><name><surname>Al-Saud</surname><given-names>MS</given-names></name></person-group><article-title xml:lang="en">Grade point average assessment for metaheuristic GMPP techniques of partial shaded PV systems</article-title><source>IET Renew. Power Gener.</source><year>2019</year><volume>13</volume><issue>8</issue><fpage>1215</fpage><lpage>1231</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg.2018.5336</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farh</surname><given-names>HM</given-names></name><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Al-Saud</surname><given-names>MS</given-names></name></person-group><article-title xml:lang="en">Interleaved boost converter for global maximum power extraction from the photovoltaic system under partial shading</article-title><source>IET Renew. Power Gener.</source><year>2019</year><volume>13</volume><issue>8</issue><fpage>1232</fpage><lpage>1238</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg.2018.5256</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farh</surname><given-names>HM</given-names></name><name><surname>Eltamaly</surname><given-names>AM</given-names></name><name><surname>Al-Shaalan</surname><given-names>AM</given-names></name><name><surname>Al-Shamma'a</surname><given-names>AA</given-names></name></person-group><article-title xml:lang="en">A novel sizing inherits allocation strategy of renewable distributed generations using crow search combined with particle swarm optimization algorithm</article-title><source>IET Renew. Power Gener.</source><year>2021</year><volume>15</volume><issue>7</issue><fpage>1436</fpage><lpage>1450</lpage><pub-id pub-id-type="doi">10.1049/rpg2.12107</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiang</surname><given-names>M</given-names></name><name><surname>Mingwei</surname><given-names>S</given-names></name><name><surname>Liying</surname><given-names>L</given-names></name><name><surname>Guerrero</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">A novel improved variable step-size incremental-resistance MPPT method for PV systems</article-title><source>IEEE Trans. Ind. Electron.</source><year>2011</year><volume>58</volume><fpage>2427</fpage><lpage>2434</lpage><pub-id pub-id-type="doi">10.1109/TIE.2010.2064275</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fangrui</surname><given-names>L</given-names></name><name><surname>Shanxu</surname><given-names>D</given-names></name><name><surname>Fei</surname><given-names>L</given-names></name><name><surname>Bangyin</surname><given-names>L</given-names></name><name><surname>Yong</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">A variable step size INC MPPT method for PV systems</article-title><source>IEEE Trans. Industr. Electron.</source><year>2008</year><volume>55</volume><fpage>2622</fpage><lpage>2628</lpage><pub-id pub-id-type="doi">10.1109/TIE.2008.920550</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Safari</surname><given-names>A</given-names></name><name><surname>Mekhilef</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Simulation and hardware implementation of incremental conductance MPPT with direct control method using Cuk converter</article-title><source>IEEE Trans. Ind. Electron.</source><year>2011</year><volume>58</volume><fpage>1154</fpage><lpage>1161</lpage><pub-id pub-id-type="doi">10.1109/TIE.2010.2048834</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mekhilef</surname><given-names>S</given-names></name><name><surname>Saidur</surname><given-names>R</given-names></name><name><surname>Safari</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A review on solar energy use in industries</article-title><source>Renew. Sustain. Energy Rev.</source><year>2011</year><volume>15</volume><fpage>1777</fpage><lpage>1790</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2010.12.018</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Zhou, Y., Liu, F., Yin, J., Duan, S. ‘Study on realizing MPPT by improved Incremental Conductance method with variable step-size.’ <italic>In 3rd IEEE Conference on Industrial Electronics and Applications</italic> pp. 547–550. (2008)</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Bo-Chiau, C., Chun-Liang, L. Implementation of maximum-power point-tracker for photovoltaic arrays. In<italic> 6th IEEE conference on industrial electronics and applications (ICIEA),</italic> pp. 1621–1626. (2011).</mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weidong</surname><given-names>X</given-names></name><name><surname>Dunford</surname><given-names>WG</given-names></name><name><surname>Palmer</surname><given-names>PR</given-names></name><name><surname>Capel</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Application of centered differentiation and steepest descent to maximum power point tracking</article-title><source>IEEE Trans. Ind. Electron.</source><year>2007</year><volume>54</volume><fpage>2539</fpage><lpage>2549</lpage><pub-id pub-id-type="doi">10.1109/TIE.2007.899922</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belkaid</surname><given-names>A</given-names></name><name><surname>Colak</surname><given-names>I</given-names></name><name><surname>Isik</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">Photovoltaic maximum power point tracking under fast varying of solar radiation</article-title><source>Appl. Energy</source><year>2016</year><volume>179</volume><fpage>523</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2016.07.034</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Brito</surname><given-names>MAG</given-names></name><name><surname>Galotto</surname><given-names>L</given-names></name><name><surname>Sampaio</surname><given-names>LP</given-names></name><name><surname>de Azevedo eMelo</surname><given-names>G</given-names></name><name><surname>Canesin</surname><given-names>CA</given-names></name></person-group><article-title xml:lang="en">Evaluation of the main MPPT techniques for photovoltaic applications’</article-title><source>IEEE Trans. Ind. Electron.</source><year>2013</year><volume>60</volume><issue>3</issue><fpage>1156</fpage><lpage>1167</lpage><pub-id pub-id-type="doi">10.1109/TIE.2012.2198036</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sekhar</surname><given-names>PC</given-names></name></person-group><article-title xml:lang="en">Mishra, S ‘Takagi–Sugeno fuzzy-based incremental conductance algorithm for maximum power point tracking of a photovoltaic generating system’</article-title><source>IET Renew. Power Gener.</source><year>2014</year><volume>8</volume><issue>8</issue><fpage>900</fpage><lpage>914</lpage><pub-id pub-id-type="doi">10.1049/iet-rpg.2013.0219</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec18"><title>Supplementary Information</title><p id="Par68"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/41598_2022_22952_MOESM1_ESM.docx" position="anchor"><caption xml:lang="en"><p>Supplementary Information.</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1038/s41598-022-22952-0" ext-link-type="doi">https://doi.org/10.1038/s41598-022-22952-0</ext-link>.</p></notes><notes notes-type="Misc"><title>Publisher's note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Scientific Reports</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value><facet-value count="1">Saudi Arabia</facet-value><facet-value count="1">United States</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
