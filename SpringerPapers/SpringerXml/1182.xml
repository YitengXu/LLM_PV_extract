<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s40684-022-00498-w</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40684</journal-id><journal-title-group><journal-title>International Journal of Precision Engineering and Manufacturing-Green Technology</journal-title><abbrev-journal-title abbrev-type="publisher">Int. J. of Precis. Eng. and Manuf.-Green Tech.</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2288-6206</issn><issn pub-type="epub">2198-0810</issn><publisher><publisher-name>Korean Society for Precision Engineering</publisher-name><publisher-loc>Seoul</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40684-022-00498-w</article-id><article-id pub-id-type="manuscript">498</article-id><article-id pub-id-type="doi">10.1007/s40684-022-00498-w</article-id><article-categories><subj-group subj-group-type="heading"><subject>Regular Paper</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Comprehensive Control Strategy and Verification for PEM Fuel Cell/Battery/Supercapacitor Hybrid Power Source</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Trinh</surname><given-names>Hoai-An</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar22"><title>Hoai-An Trinh </title><p>received B.S. and M.S. degrees in electrical and electronic engineering from Ho Chi Minh City University of Technology and Education, Ho Chi Minh City, Vietnam, in 2012 and 2015, respectively. He is currently working toward a Ph.D. degree in the School of Mechanical and Automotive Engineering, University of Ulsan, South Korea. His research interests include renewable energy, energy management strategy of hybrid systems, fuel cell applications, electric vehicles, and nonlinear control.<fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Figa_HTML.jpg" position="anchor" id="MO018"/></fig></p></sec></bio></contrib><contrib contrib-type="author" id="Au2"><name><surname>Truong</surname><given-names>Hoai Vu Anh</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar226"><title>Hoai Vu Anh Truong</title><p>received a B.S. degree in mechanical engineering from Ho Chi Minh City University of Technology, Ho Chi Minh City, Vietnam, in 2015, and a Ph.D. degree in School of Mechanical and Automotive Engineering, University of Ulsan, Ulsan, South Korea, in 2021. He is currently a postdoctoral researcher at the University of Ulsan, South Korea. His research interests include renewable energy, energy conversion system, energy management for hybrid power sources, advanced control and intelligent control for nonlinear systems, nonlinear observers, fault-tolerant control, and robotic manipulator. <fig id="Figb" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Figb_HTML.jpg" position="anchor" id="MO019"/></fig></p></sec></bio></contrib><contrib contrib-type="author" id="Au3"><name><surname>Pham</surname><given-names>Minh Duc</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><bio><sec id="FPar220"><title>Minh-Duc Pham</title><p>received a B.S. degree in electrical engineering from the Ho Chi Minh City University of Technology and Education, Ho Chi Minh City, Vietnam, in 2014, and a Ph.D. degree from the University of Ulsan, Ulsan, South Korea, in 2021. He is currently a researcher with the Department of Electrical, Electronic and Computer Engineering, University of Ulsan, South Korea. His current research interests include harmonic control technologies, renewable energy sources, and hybrid AC/DC microgrid systems. <fig id="Figc" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Figc_HTML.jpg" position="anchor" id="MO010"/></fig></p></sec></bio></contrib><contrib contrib-type="author" id="Au4"><name><surname>Do</surname><given-names>Tri Cuong</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><bio><sec id="FPar34"><title>Tri Cuong Do</title><p>received a B.S degree in the School of Transportation Engineering from Ha Noi University of Science and Technology, Vietnam in 2017, and an M.Sc. degree in School of Mechanical and Automotive Engineering from University of Ulsan, Korea in 2019. Currently, he is working toward his Ph.D. degree at the School of Mechanical and Automotive Engineering, University of Ulsan, South Korea. His research interests include energy regeneration system, hydraulic construction machine, renewable energy, and linear control theory.
<fig id="Figd" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Figd_HTML.jpg" position="anchor" id="MO0105"/></fig></p></sec></bio></contrib><contrib contrib-type="author" id="Au5"><name><surname>Lee</surname><given-names>Hong-Hee</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><bio><sec id="FPar33"><title>Hong-Hee Lee</title><p>received his B.S., M.S., and Ph.D. degrees in electrical engineering from Seoul National University, Seoul, South Korea, in 1980, 1982, and 1990, respectively. From 1994 to 1995, he was a Visiting Professor at the Texas A&amp;M University, College Station, TX, USA. Since 1985, he has been with the Department of Electrical Engineering, University of Ulsan, Ulsan, South Korea, where he is presently working as a Professor in the School of Electrical Engineering. From 2002 to 2018, he was the Director of the Network-Based Automation Research Center, which is sponsored by the Ministry of Trade, Industry and Energy. His current research interests include power electronics, network-based motor control, and renewable energy. Professor Lee is a Member of the Institute of Electrical and Electronics Engineers (IEEE), the Korean Institute of Power Electronics (KIPE), the Korean Institute of Electrical Engineers (KIEE), and the Institute of Control, Robotics and Systems (ICROS). He was the President of KIPE in 2014. <fig id="Fige" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Fige_HTML.jpg" position="anchor" id="MO0107"/></fig></p></sec></bio></contrib><contrib contrib-type="author" corresp="yes" id="Au6"><name><surname>Ahn</surname><given-names>Kyoung Kwan</given-names></name><address><email>kkahn@ulsan.ac.kr</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4068402200498w_cor6">f</xref><bio><sec id="FPar55"><title>Kyoung Kwan Ahn</title><p>received the B.S. degree in the Department of Mechanical Engineering from Seoul National University in 1990, the M. Sc. degree in Mechanical Engineering from Korea Advanced Institute of Science and Technology (KAIST) in 1992 and the Ph.D. degree from Tokyo Institute of Technology in 1999, respectively. Since 2000, he has been with the School of Mechanical Engineering, University of Ulsan, where he is currently a Professor and the Director of the Fluid Power Control and Machine Intelligence Laboratory. His main research interests lie in the modeling and control of fluid power system, energy saving construction machine, hydraulic robot, and power transmission in the ocean energy. He is the author or coauthor of over 150 SCI(E) papers and 4 books in these areas. Dr. Ahn serves as an editor of International Journal of Control, Automation and Systems and editorial board of renewable energy, Korean fluid power and construction machine, actuators and so on. <fig id="Figf" position="anchor"><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/40684_2022_498_Figf_HTML.jpg" position="anchor" id="MO01070"/></fig></p></sec></bio></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.267370.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0533 4667</institution-id><institution content-type="org-division">School of Mechanical and Automotive Engineering</institution><institution content-type="org-name">University of Ulsan</institution></institution-wrap><addr-line content-type="street">Deahak-ro 93, Nam-gu</addr-line><addr-line content-type="postcode">44610</addr-line><addr-line content-type="city">Ulsan</addr-line><country country="KR">Korea</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.267370.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0533 4667</institution-id><institution content-type="org-division">School of Electrical Engineering</institution><institution content-type="org-name">University of Ulsan</institution></institution-wrap><addr-line content-type="street">Deahak-ro 93, Nam-gu</addr-line><addr-line content-type="postcode">44610</addr-line><addr-line content-type="city">Ulsan</addr-line><country country="KR">Korea</country></aff></contrib-group><author-notes><corresp id="IDs4068402200498w_cor6"><label>f</label><email>kkahn@ulsan.ac.kr</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>30</day><month>12</month><year>2022</year></pub-date><pub-date date-type="pub" publication-format="print"><month>3</month><year>2023</year></pub-date><volume>10</volume><issue seq="9">2</issue><fpage>421</fpage><lpage>436</lpage><history><date date-type="registration"><day>14</day><month>12</month><year>2022</year></date><date date-type="received"><day>9</day><month>10</month><year>2021</year></date><date date-type="rev-recd"><day>18</day><month>1</month><year>2022</year></date><date date-type="accepted"><day>11</day><month>2</month><year>2022</year></date><date date-type="online"><day>30</day><month>12</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Using renewable energy is becoming a new tendency for vehicular applications to reduce fossil fuel consumption and minimize greenhouse gas emissions. Well-known as an eco-friendly energy source, the proton exchange membrane fuel cell (PEMFC) is extensively used in hybrid power systems to achieve the objective of zero-emission and air protection. However, this type of fuel cell offers slow dynamics and cannot adapt to abrupt load variations when used as a primary energy source. To overcome this shortcoming, battery (BAT) and/or supercapacitor (SC) are supplemented as auxiliary sources. In this paper, an innovative energy management strategy (EMS) for a PEMFC/BAT/SC hybrid power source (HPS) is proposed to improve the accuracy of power distribution from energy sources to the load. In detail, according to different characteristics of energy sources, a frequency decoupling (FD) method is designed to determine the required currents for PEMFC, BAT, and SC based on the load power demand. Besides, an adaptive DC bus control loop is utilized to guarantee a stable DC output voltage by using the BAT. The proposed EMS is simulated in a MATLAB/Simulink environment and experimentally implemented with a real-time DSP TMS320F28379D controller board. Subsequently, a test bench of a 200 W PEMFC, 24 V–12 Ah battery, and 25 V–60 F supercapacitor is conducted for experimental validation. The obtained results show that the proposed EMS is effective to coordinate energy flows between the three used sources and enhance the fuel cell performance in a hybrid power system.
</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>PEM fuel cell</kwd><kwd>Hybrid power source</kwd><kwd>Energy management strategy</kwd><kwd>Adaptive control</kwd><kwd>Frequency decoupling</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Korean Society for Precision Engineering, co-published with Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>20</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s), under exclusive licence to Korean Society for Precision Engineering</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>12</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>14</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40684_2022_Article_498.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2023</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>16</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Industrial and Production Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Efficiency</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Sustainable Development</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1007/s40684-022-00498-w" ext-link-type="doi">https://doi.org/10.1007/s40684-022-00498-w</ext-link>.</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par86">As a result of increasing environmental concerns, green energy has been highlighted as a promising solution for future development in times of energy crisis. Recently, the PEMFC has been attracted as a prominent and potential candidate to alternatively replace the common use of the energy storage devices such as a BAT or SC [<xref ref-type="bibr" rid="CR1">1</xref>]. Besides, the PEMFC earns worthy properties of lower operating temperatures, higher power density, and higher energy conversion in comparison with other types of fuel cells [<xref ref-type="bibr" rid="CR2">2</xref>].</p><p id="Par87">Despite earning prominent advantages, slow response and incapability of recovering exceeded energy have become the main technical limitations of the PEMFC. As a result, these drawbacks come up with high maintenance costs, short lifetime [<xref ref-type="bibr" rid="CR3">3</xref>], and restrict widespread applications for standalone usage. Therefore, it is necessary to develop an integration of the PEMFC with other interconnected electrical storage devices. In this configuration, the PEMFC serves as the primary power supply while the electrical storages function as secondary units to support the main source. Conventionally, either BATs or SCs, or both are employed as supplements due to their compatible characteristics for hybridization. Several works investigated the superiority of the PEMFC combined with BAT and SC. For example, Yi et al. conducted a hybrid PEMFC-SCs for a construction machine with consideration of EMS for long-term usage [<xref ref-type="bibr" rid="CR4">4</xref>]. In [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], Li et al. proposed the configuration where the fuzzy logic control was deployed for energy and battery management for hybrid electric construction vehicles. The hybridization of both BATs and SCs is also taken into consideration for hybrid electric vehicles [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], construction machinery [<xref ref-type="bibr" rid="CR10">10</xref>], hybrid tramway powertrain [<xref ref-type="bibr" rid="CR11">11</xref>], and some other fields of automation or power systems. The BATs obtain the ability of high energy density in comparison with the SCs that have the ability of fast dynamics. Thus, the BATs are capable of supplying energy in the case of the endurance process and the SCs are suitable for absorbing transient peak power where fast responses are required. Consequently, the integration of BATs and SCs with the PEMFC can exhibit better performance, reduce the system size, solve problems of fuel economy, and prolong devices’ lifespan. However, problems along with the advantages of the HPS include: design of an EMS for efficient power-sharing as high-level control and maintain the DC bus voltage at a constant and output performance in low-level control.</p><p id="Par88">The first concern, in the field of designing EMS strategies, has recently become an interesting topic for researchers. Truong et al. [<xref ref-type="bibr" rid="CR12">12</xref>] employed the fuzzy-based EMS, developed based on rule-based methodology from the previous work [<xref ref-type="bibr" rid="CR4">4</xref>], to satisfy the power demand, reduce the hydrogen consumption and maintain storage devices’ state of charge (SOC) for excavators. With the same objective, Dao et al. [<xref ref-type="bibr" rid="CR13">13</xref>] developed a fuzzy-based EMS with the integration of a backtracking search algorithm and sequential quadratic programming to adjust the fuzzy membership functions (MFs); thus, reducing the fuel consumptions and enhancing supplements qualification. Ahmadi et al. constructed a fuzzy-based EMS with a genetic algorithm for an integrated PEMFC-BATs-SCs to improve the hybrid vehicle behaviors [<xref ref-type="bibr" rid="CR14">14</xref>]. In [<xref ref-type="bibr" rid="CR15">15</xref>], Ameur et al. exploited the master–slave model-based fuzzy logic strategy (FLS) to design an EMS for efficient energy management and component lifespan prolonging. Marzougui et al. [<xref ref-type="bibr" rid="CR16">16</xref>] deployed the flatness control-based FLS and rule-based methodology towards hybridization of the PEMFC, ultra-capacitor, and BAT for an electric vehicle. Come up with the idea of the HPS management, Han et al. developed a strategy for multi-source management of PEMFCs-BATs-SCs on hybrid tramways [<xref ref-type="bibr" rid="CR17">17</xref>]. The author employed a pair of set PEMFC-BAT-SC systems to generate multiple motor units with self-convergence droop control for power distribution among all devices. Consideration of renewable energy resources, Benlahbib et al. [<xref ref-type="bibr" rid="CR18">18</xref>] proposed a hybrid topology where wind and solar power captured from wind energy and solar panels systems were interconnected with FC and BAT. Then, a control strategy of maximized power point tracking algorithm based on FLS for pulse width modulation (PWM) was developed to support the alternating current load. In [<xref ref-type="bibr" rid="CR19">19</xref>], Arevalo et al. investigated two configurations toward hybrid tramway in which renewable resources (solar and hydrokinetic energy) and grid were included in the hybrid PEMFC-BAT-SC configuration. Such reports revealed a variety of feasible configurations with certified effectiveness of using the HPS for industrial automation systems.</p><p id="Par89">Following the historical literature of the EMS designs, the main task is to distribute the power flow between the PEMFC and other energy sources by executing the current regulation while maintaining a constant DC bus voltage through a converter. Despite achieving good performance under arbitrary working conditions, most presented works did focus on designing EMSs as high-level concern without dedicatedly considering the problems of DC/DC converter behaviors and DC bus voltage stabilization due to the variation of the load power and its influence on the whole system. Besides, regarding the physical characteristics of the switching regulator for PWM rectifiers, voltage ripple also occurs [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]; thus, reducing the system efficiency and voltage instability subjected to the load variations [<xref ref-type="bibr" rid="CR22">22</xref>]. Additionally, in terms of the signal processing, some works assigned the pair of voltage and current measured in the input side of the DC/DC converter (power source side), whereas others allocated the pair of voltage and current measured in the output side (DC bus side), as feedback signals. Due to the efficiency and characteristics of the DC/DC converter, this makes differences in the system output performance for different measured point locations, which was ignored in published works. Therefore, it is necessary to investigate the influence of different signal measurement points of each element on the whole system qualification.</p><p id="Par90">Motivated from the above analyses, in this paper, an FD-based EMS combined with an adaptive PID control method is proposed. A mini-scaled fuel cell HPS is also designed to verify the proposed algorithms. The main contributions of this paper are summarized as follows:<list list-type="order"><list-item><p id="Par91">A novel FD-based EMS is proposed to define three frequency ranges of required currents based on the different characteristics of energy sources.</p></list-item><list-item><p id="Par92">The influence of signal measurement locations is investigated to compare the system performance with different measured positions at two sides of the converter.</p></list-item><list-item><p id="Par93">Adaptive proportional-integral-derivative (PID) controls are employed for the steady DC bus voltage control by using the BAT, and for the current control loops with two separated operation modes for bidirectional buck-boost converters, to enhance the system qualification.</p></list-item><list-item><p id="Par94">Simulations and experiments are implemented to verify the aforementioned concerns.</p></list-item></list></p><p id="Par95">The rest of this paper is organized as follows. The hybrid power system configuration is described in Sect. <xref rid="Sec2" ref-type="sec">2</xref>. In Sect. <xref rid="Sec9" ref-type="sec">3</xref>, the proposed energy control strategy including frequency decoupling method, DC bus control loop, and pulse width modulation operating modes are introduced to coordinate the power between fuel cell, BAT, supercapacitor into load power demand. Simulation and experimental results are given in Sect. <xref rid="Sec13" ref-type="sec">4</xref> to validate the effectiveness of the proposed strategy. Finally, the conclusions of this paper are presented in Sect. <xref rid="Sec16" ref-type="sec">5</xref>.</p></sec><sec id="Sec2"><title>Hybrid Power System</title><sec id="Sec3"><title>System Configuration</title><p id="Par96">Due to the slow dynamic response, using a standalone PEMFC cannot adapt to abrupt load variations and store the energy regeneration from the load system. For this reason, the SC and BAT are supplemented to supply the lacking power in the incipient stage, the transient or peak power demands, or store the regenerative energy. Both BAT and SC are devices that can charge, discharge, and store energy in which the BAT, with high capacity and low energy leakage, is supposed as an ideal electrochemical storage system, whereas the SC is appropriate for high power in a short time. Therefore, a combination of PEMFC, BAT, and SC is expected to construct a fast dynamics system, enhance working performance, optimize the fuel savings, reduce the PEMFC size and power consumption. In this system, the PEMFC operates with the lowest frequency power source, while the SC performs with the highest frequency and BAT works at the frequency between PEMFC and SC. The power responses of the PEMFC, BAT, SC are described in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>The response of PEMFC and energy sources [<xref ref-type="bibr" rid="CR23">23</xref>]</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par97">The suggested topology for a hybrid power system is described in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The PEMFC is used as a primary energy source, and the BAT and SC function as the secondary energy storage system (ESS). All these sources are connected to the DC bus by using DC/DC converters with a parallel configuration to transfer the power flow to the load with the charge and discharge modes. In detail, a boost converter controls the fuel cell output voltage to adapt with the reference value. A bidirectional converter transfers the power flow in both directions to the ESS for delivery and recovery cycles. Besides, a DC/AC inverter is also incorporated to convert the DC energy to AC energy and feed it into the powertrain.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Configuration of the proposed hybrid power system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig2_HTML.png" id="MO2"/></fig></p><p id="Par98">For simulation purposes, the dynamics of each subsystem component will be modeled first to understand the system behavior and for an effective EMS design. The detailed characteristics of each power source and DC/DC converter are described in the next sub-sections.</p></sec><sec id="Sec4"><title>PEMFC Characteristic</title><p id="Par99">The PEMFC model that composes of a stack module as a core of the fuel cell system, auxiliary components of air delivery, hydrogen supplying, water-cooling circulation, and humidification is acquired in MATLAB/Simulink Simscape toolbox, which neglects the dynamics of reactant flow inside the electrode [<xref ref-type="bibr" rid="CR24">24</xref>]. In this model, system parameters can be easily set up from the datasheet or by using the simple polarization curve of the testing process.</p><p id="Par100">From the dynamic model of PEMFC in [<xref ref-type="bibr" rid="CR25">25</xref>] and the simulation and experiment test results in [<xref ref-type="bibr" rid="CR26">26</xref>], the cell output voltage can be expressed as follows:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">cell</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">oc</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">act</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{cell} = E_{oc} - V_{act} - V_{r}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ1.gif"/></alternatives></disp-formula>where <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">cell</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{cell}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq70.gif"/></alternatives></inline-formula> is the cell output voltage (V), <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">oc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{oc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq71.gif"/></alternatives></inline-formula> is the open-circuit voltage (V), <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">act</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{act}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq72.gif"/></alternatives></inline-formula> is the activation voltage loss (V), <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{r}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq73.gif"/></alternatives></inline-formula> denotes the resistive and diffusion voltage loss (V).</p><p id="Par101">The open-circuit voltage can be presented by:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">oc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{oc} = K_{c} E_{n}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ2.gif"/></alternatives></disp-formula>where <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq74.gif"/></alternatives></inline-formula> is the voltage constant at the nominal condition of operation (V), <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq75.gif"/></alternatives></inline-formula> is the Nernst voltage (V).</p><p id="Par102">The activation voltage loss due to reaction kinetics at low current densities can be calculated through<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">act</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{act} = A\ln \left( {\frac{{i_{FC} }}{{i_{0} }}} \right).\frac{1}{{\frac{{sT_{d} }}{3} + 1}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ3.gif"/></alternatives></disp-formula>where <italic>A</italic> is the Tafel slope (V), <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq76.gif"/></alternatives></inline-formula> is the exchange current (A), <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq77.gif"/></alternatives></inline-formula> is the PEMFC output current (A), <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{d}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq78.gif"/></alternatives></inline-formula> is the cell settling time to a current step (s).</p><p id="Par103">The resistive and diffusion voltage loss of PEMFC due to the internal resistance of the electrolyte membrane is expressed as the following equation:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ohm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{r} = r_{ohm} i_{FC}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ4.gif"/></alternatives></disp-formula>where <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ohm</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{ohm}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq79.gif"/></alternatives></inline-formula> is the combined cell and diffusion resistance (Ω).</p><p id="Par104">The cell voltage is assumed to display a delay that is roughly equivalent to three times the time constant when the cell current change rapidly. Then, the total voltage is generated from combining the number of cell <italic>N</italic> as follows:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">cell</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{FC} = N.V_{cell}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ5.gif"/></alternatives></disp-formula>where <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq80.gif"/></alternatives></inline-formula> is the stack output voltage of the PEMFC (V), <italic>N</italic> is the total number of cells.</p><p id="Par105">During the operation, the output power of PEMFC is not only supplied to the DC bus but also partly used to operate the auxiliary systems such as cooling and temperature management systems. Thus, the supplied power from the PEMFC stack is obtained by:<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">stack</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{stack} = \eta V_{FC} i_{FC}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ6.gif"/></alternatives></disp-formula>where <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">stack</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{stack}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq81.gif"/></alternatives></inline-formula> is the supplied power of the PEMFC stack (W), <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq82.gif"/></alternatives></inline-formula> represents the efficiency of the PEMFC power source.</p><p id="Par106">Based on the input parameters of the model, the simulated polarization curves of the PEMFC stack can be described as in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Polarization curves of stack voltage–current and stack power–current</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig3_HTML.png" id="MO3"/></fig></p></sec><sec id="Sec5"><title>Energy Storage System</title><sec id="Sec6"><title>Battery Model</title><p id="Par107">The BAT is used as a secondary power source of the hybrid energy system. During the operation, it compensates for the excess power that PEMFC cannot supply. Besides, it also works as a storage device with a large capacity. In this paper, the Simscape model of a BAT that uses the Shepherd curve-fitting model is employed as follows [<xref ref-type="bibr" rid="CR27">27</xref>]:<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mfrac><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>.</mml:mo><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mfrac><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{BAT} = E_{0} - K\frac{Q}{Q - it}i^{*} - R_{b} i_{BAT} + A_{b} \exp \left( { - B.it} \right) - K\frac{Q}{Q - it}it$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ7.gif"/></alternatives></disp-formula>where <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq83.gif"/></alternatives></inline-formula> is the BAT voltage (V), <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq84.gif"/></alternatives></inline-formula> is the BAT constant voltage (V), <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mi>Q</mml:mi></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq85.gif"/></alternatives></inline-formula> is the maximum BAT capacity (Ah), <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{b}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq86.gif"/></alternatives></inline-formula> is the BAT internal resistance (Ω), <italic>B</italic> is the exponential capacity (Ah<sup>−1</sup>), <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq87.gif"/></alternatives></inline-formula> is the BAT output current (A), <italic>it</italic> is the extracted capacity (Ah), <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i^{*}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq88.gif"/></alternatives></inline-formula> is the low-frequency current dynamics (A). Besides, the term <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:mi>K</mml:mi><mml:mfrac><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\frac{Q}{Q - it}it$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq89.gif"/></alternatives></inline-formula> is referred to as polarization voltage and <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mi>K</mml:mi><mml:mfrac><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\frac{Q}{Q - it}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq90.gif"/></alternatives></inline-formula> is the polarization resistance.</p><p id="Par108">The SOC of the BAT can be obtained from the relationship of the current charge and the maximum capacity by:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi></mml:mfenced></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT} \left( t \right) = SOC_{BAT} \left( {t_{0} } \right) - \frac{1}{Q}\int\limits_{{t_{0} }}^{t} {i_{BAT} \left( \tau \right)} d\tau$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ8.gif"/></alternatives></disp-formula>where <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq91.gif"/></alternatives></inline-formula> is the SOC level of the BAT (%)<italic>, t</italic> is the instant time, and <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq92.gif"/></alternatives></inline-formula> is the initial time.</p><p id="Par109">From the input parameters of the BAT model, the simulation result of discharge curves is portrayed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Polarization curves of nominal current discharge characteristic</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig4_HTML.png" id="MO4"/></fig></p></sec><sec id="Sec7"><title>Supercapacitor Model</title><p id="Par110">The SC is an electric double-layer capacitor that can store and release fast energy due to its high capacitance. This component should be properly designed to compensate for the PEMFC dynamics during the load surge. The output voltage (V) of an elementary SC can be estimated as follows:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{SC} = \frac{{Q_{T} }}{{C_{T} }} - R_{SC} i_{SC}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq93.gif"/></alternatives></inline-formula> is the SC output current (A), <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq94.gif"/></alternatives></inline-formula> is the SC module resistance (Ω), <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq95.gif"/></alternatives></inline-formula> is the total capacitance (F), and <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq96.gif"/></alternatives></inline-formula> represents the total electric charge (C).</p><p id="Par111">The SC model in the Simscape toolbox is designed by using the Stern model [<xref ref-type="bibr" rid="CR28">28</xref>]. The total capacitance with an SC module of cells is given by<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{T} = N_{SC} .C$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ10.gif"/></alternatives></disp-formula>where <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq97.gif"/></alternatives></inline-formula> presents the total number of SC cells, <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mi>C</mml:mi></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq98.gif"/></alternatives></inline-formula> is the capacitance (F) of a cell that can be expressed as [<xref ref-type="bibr" rid="CR28">28</xref>]<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">GC</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = \left( {\frac{1}{{C_{H} }} + \frac{1}{{C_{GC} }}} \right)^{ - 1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ11.gif"/></alternatives></disp-formula>where <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq99.gif"/></alternatives></inline-formula> and <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">GC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{GC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq100.gif"/></alternatives></inline-formula> are the Helmholtz and Gouy–Chapman capacitance (F), respectively.</p><p id="Par112">Next, the total electric charge is formulated by:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{T} = \int\limits_{{t_{0} }}^{t} {i_{SC} \left( \tau \right)d\tau }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par113">The SOC of the SC is estimated as the relationship between the current and the maximum capacity. This SOC value is computed by using the following equation:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>τ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC} \left( t \right) = SOC_{SC} \left( {t_{0} } \right) - \frac{1}{{Q_{SC} }}\int\limits_{{t_{0} }}^{t} {i_{SC} \left( \tau \right)d\tau }$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ13.gif"/></alternatives></disp-formula>where <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq101.gif"/></alternatives></inline-formula> is the SOC level of the SC (%), represents the maximum SC capacity (Ah).</p></sec></sec><sec id="Sec8"><title>DC/DC Converter Design</title><p id="Par114">In the HPS, DC/DC converters are designed to control the current of PEMFC/BAT/SC as well as DC bus voltage. Based on the load power demand, the boost mode of the converter is employed to convert the lower voltage on the PEMFC side to the higher voltage on the DC bus side whereas bidirectional mode (buck-boost) of the converter is utilized to convert the voltage in two directions between BAT or SC and DC bus with the boost mode for discharging operation and buck mode for the charging operation.</p><p id="Par115">Generally, there are two types of DC/DC converter models, usually used for simulation activities, which are the average-value model and the switching model. In the first model, the controlled voltage/current sources are used to replace the switching component. The advantage of the average-value model is the neglect of switching harmonics and less time-consuming. However, it cannot observe all the switching actions and converter dynamics. The switching model, on the contrary, regards switching harmonics and losses of switching components. This model is mainly utilized for experimental boards designed with a PWM control strategy. Due to the low sampling time requirement, all the switching actions and the converter dynamics can be investigated. In this paper, the switching model of DC/DC converter is used and an adaptive control loop is designed to generate the control signal for switching components. The structures of DC/DC converters based on the switching model are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>The switching model of DC/DC converters with boost mode and bidirectional mode</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig5_HTML.png" id="MO5"/></fig></p><p id="Par116">When designing a DC/DC converter, the necessary parameters of input voltage range, nominal output voltage, maximum output current should be defined to calculate maximum switching current, the range of recommended inductor values, and the capacitance of output capacitors. This calculation is important to select the suitable components that match the requirements of the HPS. Besides, a duty cycle plays an important role to control the converter according to reference current in buck mode or boost mode. This duty cycle can be calculated by:<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{buck} = \frac{{V_{out} }}{{V_{in\_\max } \eta_{buck} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{boost} = 1 - \frac{{V_{in\_\min } \eta_{boost} }}{{V_{out} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ15.gif"/></alternatives></disp-formula>where <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{boost}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq102.gif"/></alternatives></inline-formula> is the duty cycle of boost mode (%), <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{buck}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq103.gif"/></alternatives></inline-formula> is the duty cycle of buck mode (%), <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{in\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq104.gif"/></alternatives></inline-formula>,<inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{in\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq105.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{out}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq106.gif"/></alternatives></inline-formula> are the minimum, maximum input voltage and output voltage (V) of the converter, respectively. <inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{buck}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{boost}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq108.gif"/></alternatives></inline-formula> are the efficiencies of the converter which are estimated to equal 90% for buck mode and 80% for boost mode, respectively.</p></sec></sec><sec id="Sec9"><title>Energy Control Strategy of HPS</title><p id="Par117">In this work, the proposed control strategy is based on the FD and adaptive PID control to determine the required currents of three energy sources, as well as to guarantee the stable DC bus voltage by using the BAT. The overall proposed control strategy is described in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. In this figure, the rule-based power regulator block is applied to define three power levels of the PEMFC based on the magnitude of load profile. This fuel cell power divides by the measured fuel cell voltage to generate the input current for the lowpass filter 1 (LPF 1). Besides, no matter how load changes, the DC bus control loop allows the system to guarantee DC output voltage steadily based on its reference values. The output of the DC bus voltage control block is the input current for the lowpass filter 2 (LPF 2). Finally, the current control loops must be implemented to separate two operation modes of bidirectional buck-boost converters.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>The proposed energy management strategy for the hybrid power source</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig6_HTML.png" id="MO6"/></fig></p><p id="Par118">The load power demand and total power of energy sources should be defined to ensure the balanced power-sharing of the system at all times as Eq. (<xref rid="Equ16" ref-type="disp-formula">16</xref>).<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">ESS</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{load} = P_{FC} + P_{ESS}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ16.gif"/></alternatives></disp-formula>where <inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{load}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq109.gif"/></alternatives></inline-formula> is the load power demand (W), <inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">ESS</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{ESS}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq110.gif"/></alternatives></inline-formula> is the power of the energy storage system including BAT and SC (W).</p><sec id="Sec10"><title>The Frequency Decoupling Strategy</title><p id="Par119">Based on the dynamic characteristics of energy sources, the Rangone diagram [<xref ref-type="bibr" rid="CR29">29</xref>] is usually used to define the specific power and specific energy of each device. This diagram shows the performance of energy and power density of one specific source. According to these two densities, a specific frequency as the ratio between power density and energy density is designed to define the frequency ranges allowed by each power source as follows:<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">power</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">energy</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{c} = \frac{{\rho_{power} }}{{\rho_{energy} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ17.gif"/></alternatives></disp-formula>where <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq111.gif"/></alternatives></inline-formula> is the cut-off frequency of each source (Hz), <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">power</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{power}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq112.gif"/></alternatives></inline-formula> is the power density of each source (W/kg), <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">energy</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{energy}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq113.gif"/></alternatives></inline-formula> is the energy density of each source (J/kg).</p><p id="Par120">From the Rangone diagram, the fuel cell has the lowest-frequency range, the BAT can adapt to the faster frequency range than the fuel cell, and the SC can deal with the highest-frequency range. Therefore, The FD method is used to decompose the load power demand into three frequency bands. This method has the advantages of short-time calculation and simple design for experimental applications. To implement the FD algorithm, the LPF is chosen as a transfer function as follows:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(s) = \frac{1}{{T_{s} s + 1}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ18.gif"/></alternatives></disp-formula>
with:<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{s} = \frac{1}{{f_{c} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ19.gif"/></alternatives></disp-formula>where <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq114.gif"/></alternatives></inline-formula> is the time constant.</p><p id="Par121">In this proposed strategy, two LPFs are designed with two different cut-off frequencies <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(f_{c1} ,f_{c2} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq115.gif"/></alternatives></inline-formula>. The LPF 1 is used to generate the lower frequency current of the PEMFC <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(I_{FC\_ref} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq116.gif"/></alternatives></inline-formula> which is fed to the boost converter of the fuel cell. The LPF 2 is applied to achieve the faster frequency current <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(I_{BAT\_lpf} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq117.gif"/></alternatives></inline-formula> to be used in the bidirectional converter of the BAT.</p><p id="Par122">Because the PEMFC is a primary source in the HPS, the fuel cell power distribution is regulated to match the load power demand as well as ensure the working point of PEMFC in the high-efficiency range following the U-I polarization curves. From the working profile of load, the power demand is divided into different levels to define the appropriate power levels for the dynamics of PEMFC. In this work, a load power demand in [<xref ref-type="bibr" rid="CR16">16</xref>] is applied and partitioned into three levels: high, medium, low as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> in which PEMFC will provide maximum power <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC\_\max } )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq118.gif"/></alternatives></inline-formula>, nominal power <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC\_nom} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq119.gif"/></alternatives></inline-formula>, or normal power depending on each load power level.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>The required power levels of load</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig7_HTML.png" id="MO7"/></fig></p><p id="Par123">The working principle of the rule-based power regulator is portrayed in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. In this flow chart, the required power of the PEMFC is defined depending on the power levels of the load. Firstly, the voltage and current of load are measured to calculate the power demand from the system. In the case of a low level, where the load power is lower than the nominal PEMFC power <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{load} &lt; P_{FC\_nom} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq120.gif"/></alternatives></inline-formula>, the PEMFC is a primary source that sufficiently provides power to satisfy the load demand <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC} = P_{load} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq121.gif"/></alternatives></inline-formula>, while BAT and SC are only used to compensate for the PEMFC dynamics in the transient state when an abrupt change of load power occurs. Besides, extra power generated from PEMFC can also be used to charge the BAT or SC if needed. The medium level is determined when the load power demand exceeds the nominal value but is still less than the maximum power of the PEMFC <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC\_nom} \le P_{load} &lt; P_{FC\_\max } )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq122.gif"/></alternatives></inline-formula>. In this case, the PEMFC output power is regulated at the nominal value <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC} = P_{FC\_nom} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq123.gif"/></alternatives></inline-formula>, and the BAT and SC are enabled to complement the residual induced from insufficient power of the PEMFC via the converters as discharging and charging processes. At the high level, if the load power demand is greater than the maximum power of the fuel cell <inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{load} \ge P_{FC\_\max } )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq124.gif"/></alternatives></inline-formula>, the PEMFC releases the maximum value <inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC} = P_{FC\_\max } )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq125.gif"/></alternatives></inline-formula>, and the remaining load power will be provided by the BAT and SC, depending on the status of these devices and the particular working conditions.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>The flowchart of rule-based fuel cell power distribution</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig8_HTML.png" id="MO8"/></fig></p><p id="Par124">The required PEMFC current <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(I_{FC} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq126.gif"/></alternatives></inline-formula> can be calculated from the required power <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(P_{FC} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq127.gif"/></alternatives></inline-formula> divided by the measured voltage <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V_{FC\_mea} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq128.gif"/></alternatives></inline-formula>. However, to match the characteristic of the PEMFC, this current will be filtered by using the LPF 1 which can decompose low-frequency current and high-frequency current as follows:<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_ref} = G_{1} (s).I_{FC}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_res} = I_{FC} - I_{FC\_ref}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ21.gif"/></alternatives></disp-formula>where <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1} (s)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq129.gif"/></alternatives></inline-formula> is a transfer function of LPF 1,<inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq130.gif"/></alternatives></inline-formula> is the input current of LPF 1 (A),<inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq131.gif"/></alternatives></inline-formula> and <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq132.gif"/></alternatives></inline-formula> are the low- and high-frequency current of the PEMFC (A), respectively.</p><p id="Par125">Similarly for the BAT, the LPF 2 is also utilized to separate the low- and high-frequency BAT current obtained from the DC bus voltage control loop, which will be analyzed in the next section. These currents can be defined as follows:<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_lpf} = G_{2} (s).I_{BAT}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ22.gif"/></alternatives></disp-formula><disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_res} = I_{BAT} - I_{BAT\_lpf}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ23.gif"/></alternatives></disp-formula>where <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2} (s)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq133.gif"/></alternatives></inline-formula> is the transfer function of LPF 2,<inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq134.gif"/></alternatives></inline-formula> is the input current of LPF 2 (A), <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_lpf}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq135.gif"/></alternatives></inline-formula> and <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq136.gif"/></alternatives></inline-formula> are the low- and high-frequency current of the BAT (A), respectively.</p><p id="Par126">In addition, a SOC regulator scheme is proposed to maintain the battery SOC level of the BAT in a limited range <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {SOC_{BAT\_\min } &lt; SOC_{BAT} &lt; SOC_{BAT\_\max } } \right)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq137.gif"/></alternatives></inline-formula>. The value of SOC status is compared with <inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq138.gif"/></alternatives></inline-formula> and <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq139.gif"/></alternatives></inline-formula> to decide the reference current of the BAT by [<xref ref-type="bibr" rid="CR30">30</xref>]:<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_ref} = \left\{ {\begin{array}{*{20}c} {\alpha_{1} \left| {I_{BAT\_lpf} } \right|} &amp; {if} &amp; {SOC_{BAT} \le SOC_{BAT\_\min } } \\ {I_{BAT\_lpf} } &amp; {if} &amp; {SOC_{BAT\_\min } &lt; SOC_{BAT} &lt; SOC_{BAT\_\max } } \\ {\beta_{1} \left| {I_{BAT\_lpf} } \right|} &amp; {if} &amp; {SOC_{BAT} \ge SOC_{BAT\_\max } } \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ24.gif"/></alternatives></disp-formula>where <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq140.gif"/></alternatives></inline-formula> is the reference current of the BAT (A), <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq141.gif"/></alternatives></inline-formula> is the BAT status, <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq143.gif"/></alternatives></inline-formula> are the minimum and maximum allowable SOC level of the BAT, <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq144.gif"/></alternatives></inline-formula> and <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq145.gif"/></alternatives></inline-formula> are the tuning parameters.</p><p id="Par127">Based on the SOC conditions of the BAT, the above tuning parameters are defined below:<disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{1} = - \frac{{\gamma_{1} \left| {SOC_{BAT} - SOC_{BAT\_\min } } \right|}}{{SOC_{BAT\_\min } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ25.gif"/></alternatives></disp-formula><disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta_{1} = \frac{{\delta_{1} \left| {SOC_{BAT} - SOC_{BAT\_\max } } \right|}}{{SOC_{BAT\_\max } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ26.gif"/></alternatives></disp-formula>where <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq146.gif"/></alternatives></inline-formula> and <inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq147.gif"/></alternatives></inline-formula> are the positive constants depending on the charge/discharge characteristics of the BAT.</p><p id="Par128">Due to the slow dynamic, the PEMFC and BAT cannot adapt to high-frequency currents <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq148.gif"/></alternatives></inline-formula> and <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq149.gif"/></alternatives></inline-formula> instantly. Fortunately, the SC, with the high power density and fast dynamic response, is combined to compensate for the load fluctuation and high-frequency currents of PEMFC and BAT. The same as BAT, a SOC regulator is also considered to guarantee the SOC of SC in the limited ranges. Hence, the reference current for the SC can be considered as follows:<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC} = I_{FC\_res} + I_{BAT\_res}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ27.gif"/></alternatives></disp-formula><disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">if</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC\_ref} = \left\{ {\begin{array}{*{20}c} {\alpha_{2} \left| {I_{SC} } \right|} &amp; {if} &amp; {SOC_{SC} \le SOC_{SC\_\min } } \\ {I_{SC} } &amp; {if} &amp; {SOC_{SC\_\min } &lt; SOC_{SC} &lt; SOC_{SC\_\max } } \\ {\beta_{2} \left| {I_{SC} } \right|} &amp; {if} &amp; {SOC_{SC} \ge SOC_{SC\_\max } } \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ28.gif"/></alternatives></disp-formula>where <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq150.gif"/></alternatives></inline-formula> is the reference current of the SC (A), <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq151.gif"/></alternatives></inline-formula> is the required SC current (A), <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq152.gif"/></alternatives></inline-formula> is the SC status, <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq153.gif"/></alternatives></inline-formula> and <inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq154.gif"/></alternatives></inline-formula> are the minimum and maximum allowable SOC of the SC, respectively; <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq156.gif"/></alternatives></inline-formula> are the tuning parameters.</p><p id="Par129">Based on the <inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq157.gif"/></alternatives></inline-formula> conditions, the value of <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq158.gif"/></alternatives></inline-formula> and <inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq159.gif"/></alternatives></inline-formula> is governed by:<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{2} = - \frac{{\gamma_{2} \left| {SOC_{SC} - SOC_{SC\_\min } } \right|}}{{SOC_{SC\_\min } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ29.gif"/></alternatives></disp-formula><disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta_{2} = \frac{{\delta_{2} \left| {SOC_{SC} - SOC_{SC\_\max } } \right|}}{{SOC_{SC\_\max } }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ30.gif"/></alternatives></disp-formula>where <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq161.gif"/></alternatives></inline-formula> are the positive constants depending on the charge/discharge characteristics of the SC.</p><p id="Par130">During the operation, the EMS appropriately distributes power to each power supply to not only sufficiently satisfy the workload demand but also maintain the supplements’ SOCs. These parameters should be properly determined to avoid the state of overcharging or deep discharging. For the charging process, if a certain storage device has higher SOC, the injected power is lower and vice versa. Meanwhile, in the discharging process, the output power is higher with higher SOC and is lower with lower SOC. Furthermore, if the SOC of the BAT or SC reaches its upper bound, or lower bound, disconnected action is executed and this device will wait for the next discharging or charging process, respectively.</p></sec><sec id="Sec11"><title>DC Bus Voltage Control</title><p id="Par131">In the HPS, the DC bus voltage decreases when load power demand increases rapidly, whereas this voltage will boost if the power load declines. A bus regulation, thus, is necessary to obtain the stability of DC bus voltage. In order to control the bus output voltage, the adaptive controller is constructed as shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Diagram of the DC bus voltage control loop</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig9_HTML.png" id="MO9"/></fig></p><p id="Par132">Herein, the deviation between the measured DC output voltage <inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">DC</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V_{DC} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq162.gif"/></alternatives></inline-formula> and a reference <inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V_{DC\_ref} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq163.gif"/></alternatives></inline-formula> is input to an adaptive PID controller to generate the total current required <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(I_{BAT} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq164.gif"/></alternatives></inline-formula> for the BAT source. The adaptive PID control is constructed as<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">DC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e = V_{DC\_ref} - V_{DC}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ31.gif"/></alternatives></disp-formula><disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>η</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot{\hat{K}}_{P} = \left\{ \begin{gathered} \eta_{P} \left( {\delta + \left| e \right|} \right)^{{sign\left( {\left| e \right| - \varepsilon } \right)}} sign\left( {\left| e \right| - \varepsilon } \right),\begin{array}{*{20}c} {} &amp; {\hat{K}_{P} &gt; 0} \\ \end{array} \hfill \\ \eta_{P} \left( {\delta + \left| e \right|} \right),\begin{array}{*{20}c} {} &amp; {\hat{K}_{P} = 0} \\ \end{array} \hfill \\ \end{gathered} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ32.gif"/></alternatives></disp-formula><disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>η</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>∫</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot{\hat{K}}_{I} = \left\{ \begin{gathered} \eta_{I} \left( {\delta + \left| e \right|} \right)\int {\left( {\delta + \left| e \right|} \right)}^{{sign\left( {\left| e \right| - \varepsilon } \right)}} sign\left( {\left| e \right| - \varepsilon } \right),\begin{array}{*{20}c} {} &amp; {\hat{K}_{I} &gt; 0} \\ \end{array} \hfill \\ \eta_{I} \left( {\delta + \left| e \right|} \right)\int {\left( {\delta + \left| e \right|} \right)} ,\begin{array}{*{20}c} {} &amp; {\hat{K}_{I} = 0} \\ \end{array} \hfill \\ \end{gathered} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ33.gif"/></alternatives></disp-formula>where <inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{K}_{P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{K}_{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq166.gif"/></alternatives></inline-formula> denote estimated adaptive gains; <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq168.gif"/></alternatives></inline-formula> are tunable positive gains, <inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq169.gif"/></alternatives></inline-formula> is an arbitrarily small positive constant to avoid singularity, and ε = 0.2 is a constraint to regulate the DC voltage to the vicinity of the reference. It is noteworthy that <inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{K}_{P}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq170.gif"/></alternatives></inline-formula> and <inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{K}_{I}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq171.gif"/></alternatives></inline-formula> are upper bounded by predetermined positive constant <inline-formula id="IEq172"><alternatives><mml:math id="IEq172_Math"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq172_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{_{P} }}^{*}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq172.gif"/></alternatives></inline-formula> and <inline-formula id="IEq173"><alternatives><mml:math id="IEq173_Math"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq173_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{_{I} }}^{*}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq173.gif"/></alternatives></inline-formula>, respectively, to avoid an over-estimated problem.</p></sec><sec id="Sec12"><title>Buck-Boost Modes Control</title><p id="Par133">In this HPS topology, there are two bidirectional converters employed for the BAT and SC, which have two operation modes as buck mode and boost mode. Thereby, the buck-boost control loop should be separately carried out for two modes by PI controllers, as shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, where <inline-formula id="IEq174"><alternatives><mml:math id="IEq174_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq174_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq174.gif"/></alternatives></inline-formula> is the auxiliary reference current, i.e., <inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq175.gif"/></alternatives></inline-formula> and <inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq176.gif"/></alternatives></inline-formula> for a case of using BAT and SC, respectively, and <inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">mea</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{mea}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq177.gif"/></alternatives></inline-formula> is the homologous measured current.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Diagram of the buck-boost mode control loop</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig10_HTML.png" id="MO10"/></fig></p><p id="Par134">If the reference current of the BAT or SC is less than zero, the bidirectional converters work in buck mode and the duty cycle can be defined by:<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mtext>I1</mml:mtext></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">mea</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{buck} = \left( {K_{P1} + \frac{{K_{{{\text{I1}}}} }}{s}} \right)\left( {I_{ref} - I_{mea} } \right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ34.gif"/></alternatives></disp-formula>where <inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{buck}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq178.gif"/></alternatives></inline-formula> is the duty cycle for the buck switch component (%), <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{P1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq179.gif"/></alternatives></inline-formula> and <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:msub><mml:mi>K</mml:mi><mml:mtext>I1</mml:mtext></mml:msub></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{{\text{I1}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq180.gif"/></alternatives></inline-formula> are gains of PID buck mode controller.</p><p id="Par135">Otherwise, when the reference current of the BAT or SC is greater than zero, the bidirectional converters work in boost mode and the duty cycle is described by:<disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mtext>I2</mml:mtext></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">mea</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{boost} = \left( {K_{P2} + \frac{{K_{{{\text{I2}}}} }}{s}} \right)\left( {I_{ref} - I_{mea} } \right)$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_Equ35.gif"/></alternatives></disp-formula>where <inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{boost}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq181.gif"/></alternatives></inline-formula> is the duty cycle for the boost switch component (%), <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{P2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq182.gif"/></alternatives></inline-formula> and <inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:msub><mml:mi>K</mml:mi><mml:mtext>I2</mml:mtext></mml:msub></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{{\text{I2}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq183.gif"/></alternatives></inline-formula> are gains of PID boost mode controller.</p></sec></sec><sec id="Sec13"><title>Simulation and Experimental Validation</title><sec id="Sec14"><title>Simulation Results</title><p id="Par136">In the following simulations and experimental tests, a load power profile was chosen as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> to evaluate the effectiveness of the proposed control strategy. In this profile, several load levels were considered with abrupt variations in the form of power steps, such as acceleration and deceleration in practical applications, to examine the system behaviors. The component characteristics of the HPS were chosen from commercially available devices which could satisfy the load power demand and verify the proposed approach as listed in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref>. In addition, appropriate cut-off frequencies were also determined such that they could produce the smooth reference current for the FC and BAT converters. These frequency values were <italic>f</italic><sub><italic>c1</italic></sub> = 10 Hz [<xref ref-type="bibr" rid="CR31">31</xref>] and <italic>f</italic><sub><italic>c2</italic></sub> = 32 Hz [<xref ref-type="bibr" rid="CR32">32</xref>] for LPF 1 and LPF 2, respectively. The DC bus voltage was controlled to track the reference value <italic>V</italic><sub><italic>DC_ref</italic></sub> = 36 V. The initial SOC of BAT and SC was set to 0.6 and 0.85, respectively. The parameters of boost control for PEMFC converter and buck-boost mode control for BAT and SC converters were given in Table <xref rid="Tab4" ref-type="table">4</xref>. The system qualification was performed from Fig. <xref rid="Fig11" ref-type="fig">11</xref> to Fig. <xref rid="Fig14" ref-type="fig">14</xref>. It is noteworthy that for this investigated scenario, all devices’ signals for processing, i.e., voltage and current, were measured in the low-voltage side of the DC/DC converters.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Specifications of PEMFC Horizon (H-200)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th><th align="left"><p>Unit</p></th></tr></thead><tbody><tr><td align="left"><p>Number of cells</p></td><td align="left"><p>40</p></td><td align="left"/></tr><tr><td align="left"><p>Voltage range</p></td><td align="left"><p>20–36</p></td><td align="left"><p>[V]</p></td></tr><tr><td align="left"><p>Rated power</p></td><td align="left"><p>240</p></td><td align="left"><p>[W]</p></td></tr><tr><td align="left"><p>Maximum current</p></td><td align="left"><p>12</p></td><td align="left"><p>[A]</p></td></tr><tr><td align="left"><p>Hydrogen pressure</p></td><td align="left"><p>0.45–0.55</p></td><td align="left"><p>[bar]</p></td></tr><tr><td align="left"><p>Flow rate at maximum output</p></td><td align="left"><p>2.6</p></td><td align="left"><p>[L/min]</p></td></tr><tr><td align="left"><p>Maximum stack temperature</p></td><td align="left"><p>65</p></td><td align="left"><p>[<inline-formula id="IEq184"><alternatives><mml:math id="IEq184_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mi>o</mml:mi></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq184_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{o}C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq184.gif"/></alternatives></inline-formula>]</p></td></tr><tr><td align="left"><p>Cooling</p></td><td align="left"><p>Air</p></td><td align="left"/></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>SC bank parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th><th align="left"><p>Unit</p></th></tr></thead><tbody><tr><td align="left"><p>Model</p></td><td align="left"><p>DLCAP</p></td><td align="left"/></tr><tr><td align="left"><p>Number of supercapacitors</p></td><td align="left"><p>10</p></td><td align="left"/></tr><tr><td align="left"><p>Rated voltage</p></td><td align="left"><p>25</p></td><td align="left"><p>[V]</p></td></tr><tr><td align="left"><p>Capacitance</p></td><td align="left"><p>60</p></td><td align="left"><p>[F]</p></td></tr><tr><td align="left"><p>Operating temperature</p></td><td align="left"><p>40–65</p></td><td align="left"><p>[<inline-formula id="IEq185"><alternatives><mml:math id="IEq185_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mi>o</mml:mi></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq185_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{o}C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq185.gif"/></alternatives></inline-formula>]</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>BAT parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th><th align="left"><p>Unit</p></th></tr></thead><tbody><tr><td align="left"><p>Capacity</p></td><td align="left"><p>40</p></td><td align="left"><p>[Ah]</p></td></tr><tr><td align="left"><p>Rated voltage</p></td><td align="left"><p>24</p></td><td align="left"><p>[V]</p></td></tr><tr><td align="left"><p>Internal resistance</p></td><td align="left"><p>0.0047</p></td><td align="left"><p>[<inline-formula id="IEq186"><alternatives><mml:math id="IEq186_Math"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><tex-math id="IEq186_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq186.gif"/></alternatives></inline-formula>]</p></td></tr><tr><td align="left"><p>Number of batteries</p></td><td align="left"><p>2</p></td><td align="left"/></tr></tbody></table></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Simulation parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC\_nom}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq187.gif"/></alternatives></inline-formula></p></td><td align="left"><p>180 [W]</p></td><td align="left"><p><inline-formula id="IEq188"><alternatives><mml:math id="IEq188_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq188_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{P\_PEMFC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq188.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.001</p></td></tr><tr><td align="left"><p><inline-formula id="IEq189"><alternatives><mml:math id="IEq189_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq189_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq189.gif"/></alternatives></inline-formula></p></td><td align="left"><p>220 [W]</p></td><td align="left"><p><inline-formula id="IEq190"><alternatives><mml:math id="IEq190_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq190_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{I\_PEMFC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq190.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.15</p></td></tr><tr><td align="left"><p><inline-formula id="IEq191"><alternatives><mml:math id="IEq191_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq191_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq191.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.4</p></td><td align="left"><p><inline-formula id="IEq192"><alternatives><mml:math id="IEq192_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq192_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{P1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq192.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.043</p></td></tr><tr><td align="left"><p><inline-formula id="IEq193"><alternatives><mml:math id="IEq193_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq193_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq193.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.8</p></td><td align="left"><p><inline-formula id="IEq194"><alternatives><mml:math id="IEq194_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq194_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{I1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq194.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.65</p></td></tr><tr><td align="left"><p><inline-formula id="IEq195"><alternatives><mml:math id="IEq195_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq195_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq195.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.4</p></td><td align="left"><p><inline-formula id="IEq196"><alternatives><mml:math id="IEq196_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq196_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{P2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq196.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.05</p></td></tr><tr><td align="left"><p><inline-formula id="IEq197"><alternatives><mml:math id="IEq197_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq197_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq197.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.9</p></td><td align="left"><p><inline-formula id="IEq198"><alternatives><mml:math id="IEq198_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq198_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{I2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq198.gif"/></alternatives></inline-formula></p></td><td align="left"><p>10</p></td></tr></tbody></table></table-wrap><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>The simulation results of energy sources and load power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig11_HTML.png" id="MO11"/></fig></p><p id="Par137">The simulation results of energy sources and load power in the HPS are displayed as given in Fig. <xref rid="Fig11" ref-type="fig">11</xref>a, b, respectively. Due to using the FD technique regarding each device's characteristics, the power command was appropriately distributed from the requirement into each component, as shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>a. It can be seen that SC bank not only supplied the peak power when the load changed abruptly but also delivered the fast response of required power and minimizes the fluctuating power on PEMFC and BAT. Conversely, PEMFC provided a base portion of the load power without satisfying the required power in the transient state. In addition, BAT supported the PEMFC to provide the power in the steady-state to reduce the PEMFC’s power fluctuation. Although the PEMFC, with the lowest dynamics, could not instantly react to the load change, the load tracking effort could still be ensured due to the power compensation from the BAT and SC at each time of transient peak power. As a result, the total power supplied from the HPS could completely fulfill the load requirement, even when an abrupt change occurred, as shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>b.</p><p id="Par138">Figure <xref rid="Fig12" ref-type="fig">12</xref> shows the DC bus voltage regulation and load current, corresponding to the load power demand. Because the PEMFC, the SC bank, and the BAT were connected in parallel to the DC bus, the output voltage of these sources was the same as the DC bus voltage. By using the adaptive PID control, the DC bus voltage was steadily maintained at around 36 V with a very small fluctuation, despite the abrupt change of the load, as displayed in Fig. <xref rid="Fig12" ref-type="fig">12</xref>a. In particular, the peak voltage of the DC bus was in the range of (35.97 → 36.03) V, which was approximated by 0.2% voltage ripple. Besides, the DC bus current reached a maximum of 11.1 A in the interval from 15 to 20 s that matched the maximum load power demand, as presented in Fig. <xref rid="Fig12" ref-type="fig">12</xref>b.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>The voltage and current of DC bus</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig12_HTML.png" id="MO13"/></fig></p><p id="Par139">The SOC levels of both BAT and SC bank are performed in Fig. <xref rid="Fig13" ref-type="fig">13</xref>, which describe the charged and discharged status at each timeline when the load changes. The proposed approach could maintain the fluctuation of BAT SOC level in the range of (59.82 → 60) %. Similarly, the SOC SC had a varying range within (84.55 → 85.1) %.<fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>The SOC levels of BAT and SC</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig13_HTML.png" id="MO14"/></fig></p><p id="Par140">Besides, due to the DC/DC converter dynamics and its efficiency, we investigated the system performances in two cases where all signal measurement points (voltage and current) were located in the low-voltage side (config 1) and the high-voltage side (config 2) of the DC/DC converters. The comparative simulation results are shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>, in which the dash-red line denotes the power measured in the low-voltage side (Power config 1), and the dot-dash-green line denotes the power measured in the high-voltage side (Power config 2), of the DC/DC converters. The simulated results indicated that the signals measurement point on the low-voltage side could yield faster and more accurate power response in comparison with the case of measured points on the high-voltage side. The reason is that when choosing config 1, the signal processing did not include the DC/DC converter dynamics whereas this influence, specifically dominated by an inside inductance, is systematically included in the computation for the case of config 2. Consequently, this measurement setup generated more oscillation and delayed performance than the first one. This was also displayed through the DC bus voltage regulation in Fig. <xref rid="Fig15" ref-type="fig">15</xref>, with more voltage oscillation executed under config 2 than the former when the load power abruptly changes. As can be seen, when an abrupt variation of load power occurred at the time of the 5, 10, 15, 20, 23, 26th second, the DC bus voltage regulation of config 1 was better than config 2 subjects to the same scenario of load variation. This voltage is stably remained at roughly 36 V by using config 1, whereas the range of overshoot and undershoot DC bus voltage was within (35.25 → 36.85) V, with the voltage ripple being approximated by 4.45% when using config 2. Therefore, the location for signals measurement has a significant influence on the system output qualification. Based on this expression, config 1 was chosen for the examined experiment.<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>The comparison results of load power performance between config 1 and config 2</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig14_HTML.png" id="MO12"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>The comparison of DC bus voltage by using config 1 and config 2</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig15_HTML.png" id="MO15"/></fig></p></sec><sec id="Sec15"><title>Experimental Results</title><p id="Par141">In this work, a small-scaled HPS test bench was implemented with three power sources (PEMFC/BAT/SC), a unidirectional DC/DC converter, two bidirectional DC/DC converters, controller board, DC load simulator, power supply, and measurement devices as shown in Fig. <xref rid="Fig16" ref-type="fig">16</xref>. The used test bench was designed with PEMFC, as a primary power source, integrated with BATs and SC bank, as an auxiliary power system, to compensate for the PEMFC dynamics. A PEMFC system of Horizon company (H-200 FC stack) was selected with its parameters shown in Table <xref rid="Tab1" ref-type="table">1</xref>. This fuel cell is composed of 40 cells that are serially connected with an area of 100 cm<sup>2</sup>. For the SC bank, ten components of Nippon Chemi-Con DLCAP were connected in series, with each cell having a rated voltage of 2.5 VDC and a rated capacitance of 600 F. The detailed characteristics of the SC bank are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Besides, two lead-acid BATs were connected in series to store the energy with the parameters presented in Table <xref rid="Tab3" ref-type="table">3</xref>.<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>The scaled-down hybrid power system test bench</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig16_HTML.png" id="MO16"/></fig></p><p id="Par142">In this system, the DC/DC converter for the PEMFC is unidirectional with a boost mode topology, whereas the BAT and SC converters are bidirectional with buck/boost topology. Three DC/DC converters were connected in parallel and the output voltage side is integrated into the DC bus. These converters were composed of a high-frequency inductor (L = 68 μH<italic>)</italic>, capacitors in two sides of the converter (C<sub>1</sub> = C<sub>2</sub> = 2590 μF), a resistor (R = 0.05 Ω), a diode (D), and MOSFET switches (S, S<sub>1</sub>, S<sub>2</sub>). The DC load with a power of 400 W was connected to the DC bus. For the load variation, a controllable DC load simulator was used with the characteristics described in Table <xref rid="Tab5" ref-type="table">5</xref>.<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>DC load simulator </p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th><th align="left"><p>Unit</p></th></tr></thead><tbody><tr><td align="left"><p>Voltage</p></td><td align="left"><p>0–150</p></td><td align="left"><p>[V]</p></td></tr><tr><td align="left"><p>Current</p></td><td align="left"><p>0–60</p></td><td align="left"><p>[A]</p></td></tr><tr><td align="left"><p>Power</p></td><td align="left"><p>350 max</p></td><td align="left"><p>[W]</p></td></tr><tr><td align="left"><p>Constant current range</p></td><td align="left"><p>2/6/60</p></td><td align="left"><p>[A]</p></td></tr><tr><td align="left"><p>Constant voltage range</p></td><td align="left"><p>16/80/150</p></td><td align="left"><p>[V]</p></td></tr><tr><td align="left"><p>Constant power range</p></td><td align="left"><p>7/35/350</p></td><td align="left"><p>[W]</p></td></tr><tr><td align="left"><p>Constant resistance range</p></td><td align="left"><p>0.05–250</p></td><td align="left"><p>[<inline-formula id="IEq199"><alternatives><mml:math id="IEq199_Math"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><tex-math id="IEq199_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq199.gif"/></alternatives></inline-formula>]</p></td></tr></tbody></table></table-wrap></p><p id="Par143">Besides, the DC bus voltage was maintained at 36 V by the DC voltage control loop of the BAT. The control loops of three DC/DC converters were executed in real-time by using the DSP TMS320F28379D controller board through a mathematical environment of Code Composer Studio software with the use of C language. The switching frequency was generated to drive the MOSFET switching gates of each converter by means of a PWM control signal at 20 kHz. The measured values of DC bus voltage, voltage, and current of the PEMFC, BATs, and SC bank were acquired by the LEM transducer sensors with the Hall effect.</p><p id="Par144">The experiment was carried out to increase the persuasion of the proposed control strategy. The experiment was conducted using the step load with three power levels. The experimental results of energy sources and DC bus voltage are presented in Figs. <xref rid="Fig17" ref-type="fig">17</xref> and <xref rid="Fig18" ref-type="fig">18</xref>. Firstly, the power distribution of three energy sources is shown as in Fig. <xref rid="Fig17" ref-type="fig">17</xref>a in which the continuous light blue line represents the required power of PEMFC, the continuous green line depicts the power of BAT, and the power of SC is described as a continuous orange line. It can be observed that during the low level of load power (0–10 s) and (26–30 s), the PEMFC supplied energy as a primary power source and increases slowly until reaching the required power of the load. The lacking power was provided by the BAT in the steady-state and the SC in the transient state. For the medium level of load power (20–23 s), the PEMFC delivered the nominal power at 180 W and the BAT compensates for the remaining load power requirement. With the high level of load power (10–20 s) and (23–26 s), the PEMFC was implemented at the maximum power of 220 W. In order to reduce the power fluctuation of the PEMFC, the BAT provided the supplemental power to the PEMFC with a faster power response than the PEMFC’s power response. Meanwhile, the SC bank delivered the highest power response to deal with the peak power demand of load at the transient states, which also compensated for the total insufficient power of PEMFC and BAT to meet the requirement of load at a slow rate.<fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p>The power distribution of energy sources and comparison results of power released between experiment and simulation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig17_HTML.png" id="MO17"/></fig><fig id="Fig18"><label>Fig. 18</label><caption xml:lang="en"><p>The comparison results of DC bus voltage between experiment and simulation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/40684_2022_498_Fig18_HTML.png" id="MO18"/></fig></p><p id="Par145">Additionally, both BAT and SC absorbed the redundant power when there was a sudden reduction of the load power, which was profitable for lengthening the lifetime and improving the working performance of the PEMFC stack. Based on the power allocation of energy sources, the load power demand between simulation and experiment with the same initial conditions is compared in Fig. <xref rid="Fig17" ref-type="fig">17</xref>b. Generally, the experimental result shows a good working performance with the closely same response as the simulation in load demand satisfaction. As a result, the experiment’s load power provided an oscillated power in the range of (3 → 5) W, approximated by (1.25 → 1.58) % in comparison to the required load power under various working conditions. When the load abruptly changes, the power distribution of energy sources is appropriately conducted to guarantee the load power in a small fluctuation range.</p><p id="Par146">The comparison of DC bus voltage between experiment and simulation is described in Fig. <xref rid="Fig18" ref-type="fig">18</xref>. It is easily observed that the DC bus voltage of the experiment was steadily maintained at around the desirable value (36 V) with a small voltage ripple in a range of (35.8 → 36.35) V, approximated by 1.53%. This result shows the effectiveness of the proposed adaptive DC bus voltage controller that could maintain the stable bus voltage despite the load power variation.</p></sec></sec><sec id="Sec16" sec-type="conclusions"><title>Conclusions</title><p id="Par147">In this paper, a novel EMS was proposed to properly carry out the power-sharing between energy sources to the load power demand for the HPS, which consisted of PEMFC, BATs, and SC bank. This strategy was based on the combination of adaptive control and the FD method. According to the different characteristics of energy sources, the FD decomposed the load power demand into three frequency power ranges which involved the PEMFC, BAT, and SC behaviors. Three operation modes were defined to reasonably distribute the reference power for the PEMFC, BAT, and SC through controlling the unidirectional and bidirectional DC/DC converters. To guarantee the stability of the DC bus regulated by the BAT, the adaptive PID controller was employed to maintain the bus voltage around the desired value and satisfy the variation of load. Besides, the influence of signal measuring points at two sides of the converter was investigated to evaluate the system performance. The result showed that the choice of measured points at the low-voltage side of the converter achieved a better load power response than the high-voltage side.</p><p id="Par148">The obtained results of the simulation and experiment demonstrated that the PEMFC could deal with the low-frequency power demand while the BAT was able to provide a supplement of low-frequency power demand to diminish the burden of PEMFC. Meanwhile, the SC bank satisfied all the high-frequency power demands which compensated for the incomplete power of the PEMFC and BAT. The results showed that the proposed strategy could effectively satisfy the load power demand under different working conditions with a deviation in the range of (1.25 → 1.58) %. Moreover, the DC bus voltage was guaranteed at the desired value of 36 V with a small ripple of 1.53% and short settling times. In summary, the achievements in this study not only ensured the power supply performance but also obtained the high efficiency of the hybrid system. Therefore, this study is a premise for developing an advanced EMS to apply for hybrid electric vehicles, hybrid construction machinery, or hybrid tramway system.</p></sec></body><back><ack><title>Acknowledgements</title><p>This research was supported by Basic Science Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science and ICT, South Korea (NRF 2020R1A2B5B03001480) and by the “Hydrogen Electric Tram Demonstration Project” through the Ministry of Trade, Industry &amp; Energy (MOTIE) and Korea Institute for Advancement of Technology (KIAT)(G02P16110000511) and by “Regional Innovation Strategy (RIS)” through the National Research Foundation of Korea(NRF) funded by the Ministry of Education(MOE)(2021RIS-003).</p></ack><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar1" sec-type="COI-statement"><title>Conflict of Interest</title><p id="Par149">The authors declare that they have no conflict of interest.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">MacEwen, R. (2019). <italic>The Hidden Problems Within the Electric Vehicle Battery Supply Chain</italic>, in <italic>Ballard Power Systems Inc. </italic><ext-link xlink:href="https://blog.ballard.com/electric-vehicle-battery-supply-chain" ext-link-type="uri">https://blog.ballard.com/electric-vehicle-battery-supply-chain</ext-link>.Accessed 01 Oct 2021.</mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><etal/></person-group><article-title xml:lang="en">Development of energy management system based on a power sharing strategy for a fuel cell-battery-supercapacitor hybrid tramway</article-title><source>Journal of Power Sources</source><year>2015</year><volume>279</volume><fpage>267</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2014.12.042</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>TC</given-names></name><etal/></person-group><article-title xml:lang="en">Energy management strategy of a pem fuel cell excavator with a supercapacitor/battery hybrid power source</article-title><source>Energies</source><year>2019</year><volume>12</volume><issue>22</issue><fpage>4362</fpage><pub-id pub-id-type="doi">10.3390/en12224362</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yi</surname><given-names>H-S</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal component sizing of fuel cell-battery excavator based on workload</article-title><source>International Journal of Precision Engineering and Manufacturing-Green Technology</source><year>2018</year><volume>5</volume><issue>1</issue><fpage>103</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1007/s40684-018-0011-z</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Ding</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Predictive energy management of fuel cell supercapacitor hybrid construction equipment</article-title><source>Energy</source><year>2018</year><volume>149</volume><fpage>718</fpage><lpage>729</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2018.02.101</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Huang</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Energy management and economic analysis for a fuel cell supercapacitor excavator</article-title><source>Energy</source><year>2019</year><volume>172</volume><fpage>840</fpage><lpage>851</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2019.02.016</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dinh</surname><given-names>TX</given-names></name><etal/></person-group><article-title xml:lang="en">Modeling and energy management strategy in energetic macroscopic representation for a fuel cell hybrid electric vehicle</article-title><source>Journal of Drive and Control</source><year>2019</year><volume>16</volume><issue>2</issue><fpage>11</fpage></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>SG</given-names></name><etal/></person-group><article-title xml:lang="en">Energy and battery management of a plug-in series hybrid electric vehicle using fuzzy logic</article-title><source>IEEE Transactions on Vehicular Technology</source><year>2011</year><volume>60</volume><issue>8</issue><fpage>3571</fpage><lpage>3585</lpage><pub-id pub-id-type="doi">10.1109/TVT.2011.2165571</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><etal/></person-group><article-title xml:lang="en">Experimental investigation on the online fuzzy energy management of hybrid fuel cell/battery power system for UAVs</article-title><source>International Journal of Hydrogen Energy</source><year>2018</year><volume>43</volume><issue>21</issue><fpage>10094</fpage><lpage>10103</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2018.04.075</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dang</surname><given-names>TD</given-names></name><etal/></person-group><article-title xml:lang="en">Design, modeling and analysis of a PEM fuel cell excavator with supercapacitor/battery hybrid power source</article-title><source>Journal of Drive and Control</source><year>2019</year><volume>16</volume><issue>1</issue><fpage>45</fpage><lpage>53</lpage></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>F</given-names></name><etal/></person-group><article-title xml:lang="en">Development of master-slave energy management strategy based on fuzzy logic hysteresis state machine and differential power processing compensation for a PEMFC-LIB-SC hybrid tramway</article-title><source>Applied Energy</source><year>2017</year><volume>206</volume><fpage>346</fpage><lpage>363</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2017.08.128</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Truong</surname><given-names>HVA</given-names></name><etal/></person-group><article-title xml:lang="en">Mapping fuzzy energy management strategy for PEM fuel cell–battery–supercapacitor hybrid excavator</article-title><source>Energies</source><year>2020</year><volume>13</volume><issue>13</issue><fpage>3387</fpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">4129392</pub-id><pub-id pub-id-type="doi">10.3390/en13133387</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dao</surname><given-names>HV</given-names></name><etal/></person-group><article-title xml:lang="en">Optimization-based fuzzy energy management strategy for PEM fuel cell/battery/supercapacitor hybrid construction excavator</article-title><source>International Journal of Precision Engineering and Manufacturing-Green Technology</source><year>2021</year><volume>8</volume><issue>4</issue><fpage>1267</fpage><lpage>1285</lpage><pub-id pub-id-type="doi">10.1007/s40684-020-00262-y</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadi</surname><given-names>S</given-names></name><name><surname>Bathaee</surname><given-names>SMT</given-names></name><name><surname>Hosseinpour</surname><given-names>AH</given-names></name></person-group><article-title xml:lang="en">Improving fuel economy and performance of a fuel-cell hybrid electric vehicle (fuel-cell, battery, and ultra-capacitor) using optimized energy management strategy</article-title><source>Energy Conversion and Management</source><year>2018</year><volume>160</volume><fpage>74</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2018.01.020</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ameu</surname><given-names>K</given-names></name><etal/></person-group><article-title xml:lang="en">Fuzzy energy management of hybrid renewable power system with the aim to extend component lifetime</article-title><source>International Journal of Energy Research</source><year>2017</year><volume>41</volume><fpage>1867</fpage><lpage>1879</lpage><pub-id pub-id-type="doi">10.1002/er.3748</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marzougui</surname><given-names>H</given-names></name><etal/></person-group><article-title xml:lang="en">Implementation of energy management strategy of hybrid power source for electrical vehicle</article-title><source>Energy Conversion and Management</source><year>2019</year><volume>195</volume><fpage>830</fpage><lpage>843</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2019.05.037</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>Y</given-names></name><etal/></person-group><article-title xml:lang="en">Multisource coordination energy management strategy based on SOC consensus for a PEMFC–battery–supercapacitor hybrid tramway</article-title><source>IEEE Transactions on Vehicular Technology</source><year>2018</year><volume>67</volume><issue>1</issue><fpage>296</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1109/TVT.2017.2747135</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benlahbib</surname><given-names>B</given-names></name><etal/></person-group><article-title xml:lang="en">Experimental investigation of power management and control of a PV/wind/fuel cell/battery hybrid energy system microgrid</article-title><source>International Journal of Hydrogen Energy</source><year>2020</year><volume>45</volume><issue>53</issue><fpage>29110</fpage><lpage>29122</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.07.251</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arévalo</surname><given-names>P</given-names></name><name><surname>Cano</surname><given-names>A</given-names></name><name><surname>Jurado</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Comparative study of two new energy control systems based on PEMFC for a hybrid tramway in Ecuador</article-title><source>International Journal of Hydrogen Energy</source><year>2020</year><volume>45</volume><issue>46</issue><fpage>25357</fpage><lpage>25377</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.06.212</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Somkun, S. and V. Chunkag. (2016). <italic>Fast DC bus voltage control of single-phase PWM rectifiers using a ripple voltage estimator</italic>. in <italic>IECON 2016 - 42nd Annual Conference of the IEEE Industrial Electronics Society</italic></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sabanci</surname><given-names>K</given-names></name><name><surname>Balci</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Development of an expression for the output voltage ripple of the DC-DC boost converter circuits by using particle swarm optimization algorithm</article-title><source>Measurement</source><year>2020</year><volume>158</volume><pub-id pub-id-type="doi">10.1016/j.measurement.2020.107694</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sekhar</surname><given-names>PC</given-names></name><name><surname>Krishna</surname><given-names>UV</given-names></name></person-group><article-title xml:lang="en">Voltage ripple mitigation in DC microgrid with constant power loads</article-title><source>IFAC-PapersOnLine</source><year>2019</year><volume>52</volume><issue>4</issue><fpage>300</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1016/j.ifacol.2019.08.215</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thounthong</surname><given-names>P</given-names></name><name><surname>Raël</surname><given-names>S</given-names></name><name><surname>Davat</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Energy management of fuel cell/battery/supercapacitor hybrid power source for vehicle applications</article-title><source>Journal of Power Sources</source><year>2009</year><volume>193</volume><issue>1</issue><fpage>376</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2008.12.120</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padullés</surname><given-names>J</given-names></name><name><surname>Ault</surname><given-names>GW</given-names></name><name><surname>McDonald</surname><given-names>JR</given-names></name></person-group><article-title xml:lang="en">An integrated SOFC plant dynamic model for power systems simulation</article-title><source>Journal of Power Sources</source><year>2000</year><volume>86</volume><issue>1</issue><fpage>495</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1016/S0378-7753(99)00430-9</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">S. N, M., O. Tremblay, and L. Dessaint. (2009). <italic>A generic fuel cell model for the simulation of fuel cell vehicles</italic>. in <italic>2009 IEEE Vehicle Power and Propulsion Conference</italic></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Motapon</surname><given-names>SN</given-names></name><name><surname>Dessaint</surname><given-names>L</given-names></name><name><surname>Al-Haddad</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">A comparative study of energy management schemes for a fuel-cell hybrid emergency power system of more-electric aircraft</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2014</year><volume>61</volume><issue>3</issue><fpage>1320</fpage><lpage>1334</lpage><pub-id pub-id-type="doi">10.1109/TIE.2013.2257152</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Tremblay, O., L. Dessaint, and A. Dekkiche. (2007). <italic>A Generic Battery Model for the Dynamic Simulation of Hybrid Electric Vehicles</italic>. in <italic>2007 IEEE Vehicle Power and Propulsion Conference</italic></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oldham</surname><given-names>KB</given-names></name></person-group><article-title xml:lang="en">A Gouy–Chapman–Stern model of the double layer at a (metal)/(ionic liquid) interface</article-title><source>Journal of Electroanalytical Chemistry</source><year>2008</year><volume>613</volume><issue>2</issue><fpage>131</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/j.jelechem.2007.10.017</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snoussi</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Optimal sizing of energy storage systems using frequency-separation-based energy management for fuel cell hybrid electric vehicles</article-title><source>IEEE Transactions on Vehicular Technology</source><year>2018</year><volume>67</volume><issue>10</issue><fpage>9337</fpage><lpage>9346</lpage><pub-id pub-id-type="doi">10.1109/TVT.2018.2863185</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><etal/></person-group><article-title xml:lang="en">Adaptive energy management strategy for fuel cell/battery hybrid vehicles using Pontryagin's Minimal Principle</article-title><source>Journal of Power Sources</source><year>2019</year><volume>440</volume><fpage>227105</fpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2019.227105</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="other">Lohse-Busch, H., Stutenberg, K., Douba, M., Iliev, S., Kern, M., Richards, B., &amp; Christenson, M. (2018). Technology assessment of a fuel cell vehicle: 2017 Toyota Mirai. <italic>ANL Report ANL/ESD-18/12, </italic>1–7.</mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thounthong</surname><given-names>P</given-names></name><name><surname>RaËl</surname><given-names>S</given-names></name><name><surname>Davat</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Control algorithm of fuel cell and batteries for distributed generation system</article-title><source>IEEE Transactions on Energy Conversion</source><year>2008</year><volume>23</volume><issue>1</issue><fpage>148</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1109/TEC.2006.888028</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec17"><title>Supplementary Information</title><p id="Par150">Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/40684_2022_498_MOESM1_ESM.docx" position="anchor"><caption xml:lang="en"><p>Supplementary file1 (DOCX 220 KB)</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/40684_2022_498_MOESM2_ESM.docx" position="anchor"><caption xml:lang="en"><p>Supplementary file2 (DOCX 32 KB)</p></caption></media></supplementary-material></p></sec></app></app-group><glossary><glossary id="AGS1"><title>Abbreviations</title><def-list><def-item><term>AC</term><def><p id="Par2">Alternating current</p></def></def-item><def-item><term>BAT</term><def><p id="Par3">Battery</p></def></def-item><def-item><term>DC</term><def><p id="Par4">Direct current</p></def></def-item><def-item><term>DSP</term><def><p id="Par5">Digital signal processor</p></def></def-item><def-item><term>EMS</term><def><p id="Par6">Energy management strategy</p></def></def-item><def-item><term>ESS</term><def><p id="Par7">Energy storage system</p></def></def-item><def-item><term>FD</term><def><p id="Par8">Frequency decoupling</p></def></def-item><def-item><term>FLS</term><def><p id="Par9">Fuzzy logic strategy</p></def></def-item><def-item><term>HPS</term><def><p id="Par10">Hybrid power source</p></def></def-item><def-item><term>LPF</term><def><p id="Par11">Low-pass filter</p></def></def-item><def-item><term>PEMFC</term><def><p id="Par12">Proton exchange membrane fuel cell</p></def></def-item><def-item><term>PID</term><def><p id="Par13">Proportional-integral-derivative</p></def></def-item><def-item><term>PWM</term><def><p id="Par14">Pulse width modulation</p></def></def-item><def-item><term>SC</term><def><p id="Par15">Supercapacitor</p></def></def-item><def-item><term>SOC</term><def><p id="Par16">State of charge</p></def></def-item></def-list></glossary><glossary id="AGS2"><title>Symbols</title><def-list><def-item><term><inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi>A</mml:mi></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq1.gif"/></alternatives></inline-formula></term><def><p id="Par17">Tafel slope (V)</p></def></def-item><def-item><term><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi>B</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq2.gif"/></alternatives></inline-formula></term><def><p id="Par18">Exponential capacity (Ah<sup>−</sup><sup>1</sup>)</p></def></def-item><def-item><term><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi>C</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq3.gif"/></alternatives></inline-formula></term><def><p id="Par19">A cell capacitance in SC module (F)</p></def></def-item><def-item><term><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq4.gif"/></alternatives></inline-formula></term><def><p id="Par20">Total capacitance (F)</p></def></def-item><def-item><term><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq5.gif"/></alternatives></inline-formula></term><def><p id="Par21">Helmholtz capacitance (F)</p></def></def-item><def-item><term><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">GC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{GC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq6.gif"/></alternatives></inline-formula></term><def><p id="Par22">Gouy–Chapman capacitance (F)</p></def></def-item><def-item><term><inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{boost}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq7.gif"/></alternatives></inline-formula></term><def><p id="Par23">Duty cycle of boost mode (%)</p></def></def-item><def-item><term><inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{buck}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq8.gif"/></alternatives></inline-formula></term><def><p id="Par24">Duty cycle of buck mode (%)</p></def></def-item><def-item><term><inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">oc</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{oc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq9.gif"/></alternatives></inline-formula></term><def><p id="Par25">Open-circuit voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq10.gif"/></alternatives></inline-formula></term><def><p id="Par26">BAT constant voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq11.gif"/></alternatives></inline-formula></term><def><p id="Par27">Nernst voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq12.gif"/></alternatives></inline-formula></term><def><p id="Par28">Cut-off frequency of power source (Hz)</p></def></def-item><def-item><term><inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq13.gif"/></alternatives></inline-formula></term><def><p id="Par29">BAT output current (A)</p></def></def-item><def-item><term><inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq14.gif"/></alternatives></inline-formula></term><def><p id="Par30">Required current of the BAT (A)</p></def></def-item><def-item><term><inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_lpf}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq15.gif"/></alternatives></inline-formula></term><def><p id="Par31">BAT current after LPF (A)</p></def></def-item><def-item><term><inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_mea}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq16.gif"/></alternatives></inline-formula></term><def><p id="Par32">Measured current of BAT (A)</p></def></def-item><def-item><term><inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq17.gif"/></alternatives></inline-formula></term><def><p id="Par33">Reference (low-frequency) current of BAT (A)</p></def></def-item><def-item><term><inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{BAT\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq18.gif"/></alternatives></inline-formula></term><def><p id="Par34">Residual (high-frequency) current of BAT (A)</p></def></def-item><def-item><term><inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq19.gif"/></alternatives></inline-formula></term><def><p id="Par35">PEMFC output current (A)</p></def></def-item><def-item><term><inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq20.gif"/></alternatives></inline-formula></term><def><p id="Par36">Required current of PEMFC (A)</p></def></def-item><def-item><term><inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_mea}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq21.gif"/></alternatives></inline-formula></term><def><p id="Par37">Measured current of PEMFC (A)</p></def></def-item><def-item><term><inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq22.gif"/></alternatives></inline-formula></term><def><p id="Par38">Reference (low-frequency) current of PEMFC (A)</p></def></def-item><def-item><term><inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{FC\_res}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq23.gif"/></alternatives></inline-formula></term><def><p id="Par39">Residual (high-frequency) current of PEMFC (A)</p></def></def-item><def-item><term><inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq24.gif"/></alternatives></inline-formula></term><def><p id="Par40">Exchange current (A)</p></def></def-item><def-item><term><inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:mi mathvariant="italic">it</mml:mi></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$it$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq25.gif"/></alternatives></inline-formula></term><def><p id="Par41">Extracted capacity (Ah)</p></def></def-item><def-item><term><inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq26.gif"/></alternatives></inline-formula></term><def><p id="Par42">SC output current (A)</p></def></def-item><def-item><term><inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq27.gif"/></alternatives></inline-formula></term><def><p id="Par43">Required SC current (A)</p></def></def-item><def-item><term><inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC\_mea}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq28.gif"/></alternatives></inline-formula></term><def><p id="Par44">Measured current of SC (A)</p></def></def-item><def-item><term><inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{SC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq29.gif"/></alternatives></inline-formula></term><def><p id="Par45">Reference current of SC (A)</p></def></def-item><def-item><term><inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i^{*}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq30.gif"/></alternatives></inline-formula></term><def><p id="Par46">Low-frequency current dynamics (A)</p></def></def-item><def-item><term><inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq31.gif"/></alternatives></inline-formula></term><def><p id="Par47">Voltage constant at the nominal operation (V)</p></def></def-item><def-item><term><inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>N</mml:mi></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq32.gif"/></alternatives></inline-formula></term><def><p id="Par48">Total number of cells inside PEMFC stack</p></def></def-item><def-item><term><inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq33.gif"/></alternatives></inline-formula></term><def><p id="Par49">Total number of SC cells</p></def></def-item><def-item><term><inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">ESS</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{ESS}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq34.gif"/></alternatives></inline-formula></term><def><p id="Par50">Power of the energy storage system (W)</p></def></def-item><def-item><term><inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq35.gif"/></alternatives></inline-formula></term><def><p id="Par51">Required power of PEMFC (W)</p></def></def-item><def-item><term><inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq36.gif"/></alternatives></inline-formula></term><def><p id="Par52">Maximum power of PEMFC (W)</p></def></def-item><def-item><term><inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{FC\_nom}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq37.gif"/></alternatives></inline-formula></term><def><p id="Par53">Nominal power of PEMFC (W)</p></def></def-item><def-item><term><inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">load</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{load}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq38.gif"/></alternatives></inline-formula></term><def><p id="Par54">Load power demand (W)</p></def></def-item><def-item><term><inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">stack</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{stack}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq39.gif"/></alternatives></inline-formula></term><def><p id="Par55">Supplied power of the PEMFC stack (W)</p></def></def-item><def-item><term><inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mi>Q</mml:mi></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq40.gif"/></alternatives></inline-formula></term><def><p id="Par56">Maximum BAT capacity (Ah)</p></def></def-item><def-item><term><inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq41.gif"/></alternatives></inline-formula></term><def><p id="Par57">Total electric charge (C)</p></def></def-item><def-item><term><inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq42.gif"/></alternatives></inline-formula></term><def><p id="Par58">BAT internal resistance (Ω)</p></def></def-item><def-item><term><inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ohm</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{ohm}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq43.gif"/></alternatives></inline-formula></term><def><p id="Par59">Combined cell and diffusion resistance (Ω)</p></def></def-item><def-item><term><inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq44.gif"/></alternatives></inline-formula></term><def><p id="Par60">SC module resistance (Ω)</p></def></def-item><def-item><term><inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq45.gif"/></alternatives></inline-formula></term><def><p id="Par61">SOC of the BAT (%)</p></def></def-item><def-item><term><inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq46.gif"/></alternatives></inline-formula></term><def><p id="Par62">Minimum SOC of the BAT (%)</p></def></def-item><def-item><term><inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{BAT\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq47.gif"/></alternatives></inline-formula></term><def><p id="Par63">Maximum SOC of the BAT (%)</p></def></def-item><def-item><term><inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq48.gif"/></alternatives></inline-formula></term><def><p id="Par64">SOC of the SC (%)</p></def></def-item><def-item><term><inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq49.gif"/></alternatives></inline-formula></term><def><p id="Par65">Minimum SOC of the SC (%)</p></def></def-item><def-item><term><inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC_{SC\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq50.gif"/></alternatives></inline-formula></term><def><p id="Par66">Maximum SOC of the SC (%)</p></def></def-item><def-item><term><inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{d}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq51.gif"/></alternatives></inline-formula></term><def><p id="Par67">Cell settling time to a current step (s)</p></def></def-item><def-item><term><inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq52.gif"/></alternatives></inline-formula></term><def><p id="Par68">Time constant</p></def></def-item><def-item><term><inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">act</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{act}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq53.gif"/></alternatives></inline-formula></term><def><p id="Par69">Activation voltage loss (V)</p></def></def-item><def-item><term><inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BAT</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{BAT}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq54.gif"/></alternatives></inline-formula></term><def><p id="Par70">BAT output voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">cell</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{cell}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq55.gif"/></alternatives></inline-formula></term><def><p id="Par71">Cell output voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">DC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{DC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq56.gif"/></alternatives></inline-formula></term><def><p id="Par72">Measured voltage of DC bus (V)</p></def></def-item><def-item><term><inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{DC\_ref}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq57.gif"/></alternatives></inline-formula></term><def><p id="Par73">Reference voltage of DC bus (V)</p></def></def-item><def-item><term><inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">FC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{FC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq58.gif"/></alternatives></inline-formula></term><def><p id="Par74">PEMFC stack output voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{FC\_mea}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq59.gif"/></alternatives></inline-formula></term><def><p id="Par75">Measured voltage of PEMFC (V)</p></def></def-item><def-item><term><inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{in\_\min }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq60.gif"/></alternatives></inline-formula></term><def><p id="Par76">Minimum input voltage of the converter (V)</p></def></def-item><def-item><term><inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{in\_\max }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq61.gif"/></alternatives></inline-formula></term><def><p id="Par77">Maximum input voltage of the converter (V)</p></def></def-item><def-item><term><inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{out}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq62.gif"/></alternatives></inline-formula></term><def><p id="Par78">Output voltage of the converter (V)</p></def></def-item><def-item><term><inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{SC}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq63.gif"/></alternatives></inline-formula></term><def><p id="Par79">SC output voltage (V)</p></def></def-item><def-item><term><inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{r}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq64.gif"/></alternatives></inline-formula></term><def><p id="Par80">Resistive and diffusion voltage loss (V)</p></def></def-item><def-item><term><inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq65.gif"/></alternatives></inline-formula></term><def><p id="Par81">PEMFC stack efficiency</p></def></def-item><def-item><term><inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">boost</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{boost}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq66.gif"/></alternatives></inline-formula></term><def><p id="Par82">Converter efficiency of boost mode</p></def></def-item><def-item><term><inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">buck</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta_{buck}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq67.gif"/></alternatives></inline-formula></term><def><p id="Par83">Converter efficiency of buck mode</p></def></def-item><def-item><term><inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">power</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{power}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq68.gif"/></alternatives></inline-formula></term><def><p id="Par84">Power density of each source (W/kg)</p></def></def-item><def-item><term><inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">energy</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{energy}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40684_2022_498_Article_IEq69.gif"/></alternatives></inline-formula></term><def><p id="Par85">Energy density of each source (J/kg)</p></def></def-item></def-list></glossary></glossary><notes notes-type="Misc"><title>Publisher's Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Energy Efficiency</facet-value><facet-value count="1">Engineering</facet-value><facet-value count="1">Industrial and Production Engineering</facet-value><facet-value count="1">Sustainable Development</facet-value></facet><facet name="keyword"><facet-value count="1">Adaptive control</facet-value><facet-value count="1">Energy management strategy</facet-value><facet-value count="1">Frequency decoupling</facet-value><facet-value count="1">Hybrid power source</facet-value><facet-value count="1">PEM fuel cell</facet-value></facet><facet name="pub"><facet-value count="1">International Journal of Precision Engineering and Manufacturing-Green Technology</facet-value></facet><facet name="year"><facet-value count="1">2023</facet-value></facet><facet name="country"><facet-value count="1">South Korea</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
