<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s41601-022-00240-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41601</journal-id><journal-title-group><journal-title>Protection and Control of Modern Power Systems</journal-title><abbrev-journal-title abbrev-type="publisher">Prot Control Mod Power Syst</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2367-2617</issn><issn pub-type="epub">2367-0983</issn><publisher><publisher-name>Springer Nature Singapore</publisher-name><publisher-loc>Singapore</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41601-022-00240-3</article-id><article-id pub-id-type="manuscript">240</article-id><article-id pub-id-type="doi">10.1186/s41601-022-00240-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title xml:lang="en">A new five-level inverter with reduced leakage current for photovoltaic system applications</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Hosseinkhani</surname><given-names>Vahid</given-names></name><address><email>vahid.hosseinkhani@yahoo.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9417-4727</contrib-id><name><surname>Sarvi</surname><given-names>Mohammad</given-names></name><address><email>sarvi@eng.ikiu.ac.ir</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs41601022002403_cor2">b</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.411537.5</institution-id><institution-id institution-id-type="ISNI">0000 0000 8608 1112</institution-id><institution content-type="org-division">Department of Electrical Engineering</institution><institution content-type="org-name">Imam Khomeini International University</institution></institution-wrap><addr-line content-type="city">Qazvin</addr-line><country country="IR">Iran</country></aff></contrib-group><author-notes><corresp id="IDs41601022002403_cor2"><label>b</label><email>sarvi@eng.ikiu.ac.ir</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>16</day><month>5</month><year>2022</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2022</year></pub-date><volume>7</volume><issue seq="19">1</issue><elocation-id>19</elocation-id><history><date date-type="registration"><day>18</day><month>4</month><year>2022</year></date><date date-type="received"><day>7</day><month>1</month><year>2022</year></date><date date-type="accepted"><day>14</day><month>4</month><year>2022</year></date><date date-type="online"><day>16</day><month>5</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">A general growth is being seen in the use of renewable energy resources, and photovoltaic cells are becoming increasingly popular for converting green renewable solar energy into electricity. Since the voltage produced by photovoltaic cells is DC, an inverter is required to connect them to the grid with or without transformers. Transformerless inverters are often used for their low cost and low power loss, and light weight. However, these inverters suffer from leakage current in the system, a challenge that needs to be addressed. In this paper, a topology with two alternative connection models is presented to stabilize the common mode voltage and reduce the leakage current. The output voltage characteristic of the proposed inverter is five-level, which reduces the harmonic distortion in the output current compared to the two- and three-level inverters. The operation modes and output of the proposed topology are described and analyzed. The structures of the proposed inverter are simulated in MATLAB/Simulink and are compared with some well-known structures. Results show that the proposed structure with both connection models effectively reduces leakage current and improves grid current THD.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Grid-connected inverters</kwd><kwd>Multilevel inverters</kwd><kwd>Common mode voltage</kwd><kwd>Leakage current</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>19</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>18</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41601_2022_Article_240.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par24">Solar energy is one of the fastest growing sources of energy. There have been significant growth trends in both developing and using photovoltaic (PV) systems for harnessing green energy from the sun over the last few decades. Unlike fossil fuels, renewable sources of energy such as solar do not pollute the environment during their production and consumption [<xref ref-type="bibr" rid="CR1">1</xref>].</p><p id="Par25">In PV systems, voltage source inverters installed between the PV cells and the grid are required to connect the outputs to the electrical grid [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. These inverters can be connected to the grid with or without a transformer.</p><p id="Par26">In recent years, grid-connected transformerless inverters have been widely used because of their higher efficiency and lower cost and weight when compared to systems with a transformer [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. However, the problem with the transformerless inverters is the galvanic connection of the solar panels to the ground. This can cause leakage current [<xref ref-type="bibr" rid="CR7">7</xref>]. Despite the generally acceptable efficiency of new inverters, issues such as grounding cells are still required to be addressed as they are essential in reducing leakage current. In transformerless inverters, the ground of the cells is not isolated from the ground of the grid and thus a parasitic capacitor exists between the cells and the ground. The presence of this capacitor introduces a leakage current in the system. This can flow through a human body and pose serious risks if exceeding a specific value. Also, the leakage current can cause efficiency reduction, harmonic injection, and increased total harmonic distortion (THD) in the grid current [<xref ref-type="bibr" rid="CR8">8</xref>]. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows an overview of the PV system, including the inverter, output inductor and grid.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Grid-connected photovoltaic system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par27">Many topologies have been proposed in the literature to reduce leakage current. The most prominent topologies are the full-bridge structure with bipolar switching method, H5 structure [<xref ref-type="bibr" rid="CR9">9</xref>], H6 [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], and HERIC [<xref ref-type="bibr" rid="CR12">12</xref>] etc. A full-bridge structure with bipolar switching method has a fixed common mode voltage and therefore results in very low leakage current. However, because of the two-level output voltage, large output filters are required and this increases losses. The advantages of a full-bridge inverter with a unipolar switching method include excellent differential characteristic, low inductance current ripple, and higher efficiency. However, the drawbacks are the unsuitable common mode characteristics and very high leakage current [<xref ref-type="bibr" rid="CR13">13</xref>].</p><p id="Par28">Another approach is to disconnect the AC side from the DC side in the freewheeling modes. The structure proposed in [<xref ref-type="bibr" rid="CR14">14</xref>] uses a connection between the negative terminal of the solar cell and the neutral point of the grid to reduce the leakage current. The input voltage of this structure is the same as that of the full-bridge structure, though in spite of ease of operation, this structure requires more devices. Also, in this structure, one of the output inductors is taken out and only one inductor is used. For this reason, H5, H6, and HERIC structures were designed based on the full-bridge structure and unipolar modulation. In this type of inverter, the weight and cost of the filters are higher because the cores of the filter inductors must be separated.</p><p id="Par29">Many structures have been developed based on these topologies. For instance, a group of inverters based on the HERIC topology are designed by connecting the middle point of the two capacitors on the input side to the inverter output. This allows them to keep the common mode voltage constant in the freewheeling mode that further reduces leakage current [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. In [<xref ref-type="bibr" rid="CR19">19</xref>], a structure with six switches and two diodes is proposed, in which two additional switches are placed between the legs of the full-bridge structure. The inverter output is a short circuit in the freewheeling mode which prevents large fluctuations in the common mode voltage resulting in reduced leakage current. In another study, a HERIC-based cascade structure is introduced in [<xref ref-type="bibr" rid="CR20">20</xref>] with a 9-level inverter connecting several PV cells. This topology, in addition to being multilevel, is able to reduce leakage current by separating the grid from PV cells in freewheeling mode. However, the large numbers of switches used in this structure increase the costs. Also, the additional switches in the current path during operation increase the conduction losses. In [<xref ref-type="bibr" rid="CR21">21</xref>], a 5-level inverter is proposed consisting of six switches, two capacitors, and one diode. Only one inductor is used in the output of this inverter while its switching is controlled using Space Vector (SV) modulation. Furthermore, a transformerless five-level inverter is designed in [<xref ref-type="bibr" rid="CR22">22</xref>] with a grid-tied single-phase PV system to reduce leakage current. The neutral of the grid links to a common node in which the negative and positive terminals of the DC-link are connected via parasitic capacitors to eliminate the leakage current. In this structure, eight switches and six diodes are used. This increases losses, while it also requires a high DC voltage level at the input. Another new structure of a single-phase transformerless grid connected multilevel inverter is presented in [<xref ref-type="bibr" rid="CR23">23</xref>] based on a switched-capacitor structure. In this structure, the series–parallel switching conversion of the integrated switched-capacitor module is employed in a packed unit. In [<xref ref-type="bibr" rid="CR24">24</xref>] a new topology of the switched-capacitor multilevel inverter (SCMLI) is proposed for PV systems, one which can eliminate the leakage current. Nevertheless, this structure uses more capacitors than similar structures and is less efficient than many other competing structures. The transformerless PV inverter proposed in [<xref ref-type="bibr" rid="CR25">25</xref>] uses a cascaded 5-level H-bridge (CHB), which can also be developed into higher levels. However, leakage current circulation between PV panels in each 5-level block is a disadvantage. Finally, a single-phase three-level split-inductor neutral point clamped inverter is developed in [<xref ref-type="bibr" rid="CR26">26</xref>] for transformerless PV application. However, the inverter also requires a high DC voltage at the input.</p><p id="Par30">This paper presents a high-efficiency 5-level inverter with two structures capable of reducing leakage current. These structures reduce common-mode voltage oscillation and leakage current by connecting the inverter outputs to the midpoint of the DC bus in the freewheeling mode. In addition, the structures are designed so that the inverter output voltage is five-level leading to improved quality in the output current and reduced total harmonic distortion in the inverter output. The performance of the proposed topology is evaluated through comparisons with the HERIC topology [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] and the MOSFET neutral-point-clamped (M-NPC) structure presented in [<xref ref-type="bibr" rid="CR16">16</xref>]. The study shows the advantages of the proposed inverter in terms of common mode voltage stabilization, leakage current reduction, multilevel output in the inverter, and improved THD, as well as a higher efficiency than other topologies proposed in the literature.</p><p id="Par31">After reviewing the literature extensively in Sect. <xref rid="Sec1" ref-type="sec">1</xref>, the concept of leakage current in a HERIC inverter is described in Sect. <xref rid="Sec2" ref-type="sec">2</xref>. The proposed topology is presented and described with two connection models in Sect. <xref rid="Sec3" ref-type="sec">3</xref>. Section <xref rid="Sec6" ref-type="sec">4</xref> presents the simulation results, and Sect. <xref rid="Sec7" ref-type="sec">5</xref> concludes the paper.</p></sec><sec id="Sec2"><title>Leakage current in inverters</title><p id="Par32">In transformerless inverters, leakage current flows through the parasitic capacitor (between the ground and the PV panel (C<sub>PV</sub>)), the output inductors (L<sub>1</sub>, L<sub>2</sub>), and the ground impedance (Z<sub>G</sub>) as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The detailed model of the corresponding common-mode noise is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, while the simplified model is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b irrespective of Z<sub>G</sub>. The value of the parasitic capacitor depends on many factors such as the surface of the solar array, weather conditions, the distance of the plate from the ground, humidity, and dust [<xref ref-type="bibr" rid="CR27">27</xref>], and is often considered to be between 50 and 150 nF/kW [<xref ref-type="bibr" rid="CR8">8</xref>]. A full-bridge inverter has a relatively high leakage current with unipolar switching. Therefore, the AC separation method is recommended to avoid increasing the common mode voltage by creating a freewheeling path between AC and DC. Here, freewheeling is when the inverter output is short circuited. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows one of the most common AC separation structures, namely, the HERIC inverter. This topology is usually used to test leakage current behavior.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Common-mode model: <bold>a</bold> detailed<italic>,</italic><bold>b</bold> simplified</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig2_HTML.png" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>The HERIC topology [<xref ref-type="bibr" rid="CR12">12</xref>]</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig3_HTML.png" id="MO3"/></fig></p><p id="Par33">According to the definitions in [<xref ref-type="bibr" rid="CR28">28</xref>], the equivalent common-mode voltage V<sub>ECM</sub>, differential and common mode voltages as well as leakage currents are calculated as:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ECM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">DM</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V_{ECM} = V_{CM} + \frac{V_{DM}}{2}\frac{L_{1} - L_{2}}{{L_{1} + L_{2}}}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">DM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{DM} = V_{AN} - V_{BN}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ3.gif"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">Leakage</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{Leakage} = C_{PV}\frac{dV_{CM}}{{dt}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ4.gif"/></alternatives></disp-formula>where V<sub>AN</sub> and V<sub>BN</sub> are the respective potential differences between points A and B relative to the negative terminal of the PV array (point N in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). If the values of L<sub>1</sub> and L<sub>2</sub> are equal, the second part of (1) is eliminated.</p><p id="Par34">As noted from (<xref rid="Equ4" ref-type="disp-formula">4</xref>), the leakage current depends on the changes in the common mode voltage. In order to control the common mode voltage in the freewheeling mode in the HERIC inverter, two switches (S5 and S6) are placed on the AC side. This is achieved by turning on S5 and the diode parallel to S6 in the positive half cycle, and by turning on S6 and the diode parallel to S5 in the negative half cycle. The other switches are OFF in the freewheeling mode.</p><p id="Par35">In the present study, in addition to the HERIC structure, other proposed structures [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] are considered for comparison. The structure of the MOSFET neutral-point-clamped (M-NPC) inverter [<xref ref-type="bibr" rid="CR16">16</xref>] is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. This consists of seven switches and four diodes. It also has two operations in freewheeling mode. In the positive freewheeling cycle, D1, D2, S2, and S5 are ON, while D1, D3, D4, and S7 are ON in the negative freewheeling cycle. This structure is not symmetrical in the positive and negative cycles of the conduction modes since in the positive cycle, S1, S2, S5, and S6 are ON, whereas in the negative cycle only S3 and S4 are ON.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Some other topologies: <bold>a</bold> the structure of [<xref ref-type="bibr" rid="CR16">16</xref>], <bold>b</bold> the structure of [<xref ref-type="bibr" rid="CR23">23</xref>], <bold>c</bold> the structure of [<xref ref-type="bibr" rid="CR25">25</xref>]</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig4_HTML.png" id="MO4"/></fig></p><p id="Par36">The structure of [<xref ref-type="bibr" rid="CR23">23</xref>] is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, which consists of six switches, two diodes and capacitors. It has six operation modes that generate a five-level output voltage. The structure of [<xref ref-type="bibr" rid="CR25">25</xref>] provides a multilevel cascaded H-bridge inverter, which can also be generalized to higher levels. Its five-level structure consisting of eight switches is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c.</p></sec><sec id="Sec3"><title>The proposed topology</title><p id="Par37">Here, a new five-level topology which contains 11 switches is proposed. This has the ability to reduce leakage current. This topology is presented in two structures. The main difference between them is the way the inverters are connected to the PV panels. The different connections provide choices in connecting the inverter to the solar panels based on the existing panels, with each connection option offering unique features. In the first structure, the THD of the output current is lower than the second, while the second structure has lower leakage current of each panel (not the grid leakage current) than the first structure. This increases the safety of using the panels.</p><sec id="Sec4"><title>The topology with the first structure</title><p id="Par38">The first structure is illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The voltage level of PV1 is twice that of PV2 (V<sub>PV1</sub> = 2V<sub>PV2</sub>). Using capacitors parallel to the panels (C<sub>dc</sub>), a voltage division is performed and different voltage levels relative to point N at the input side are obtained. Among different PWM methods, SPWM is mostly used for multilevel inverters, because of simple implementation with good performance. In this paper, a type of level-shifted carrier PWM (LSC-PWM) method is selected which includes two high frequency carriers that have the same phase, amplitude and frequency.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>The first structure of the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig5_HTML.png" id="MO5"/></fig></p><p id="Par39">According to this method, the amplitude of the carriers is 1/(Number of carriers), which in this paper is equal to 0.5 with 2 carriers. The switching of this method is based on the comparison of two high frequency triangular waves with a grid frequency modulation wave as shown in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref>. The frequency of the carrier waves is 16 kHz.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Synthesizing the gate commands based on the proposed switching algorithm</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig6_HTML.png" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Switching pattern</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig7_HTML.png" id="MO7"/></fig></p><p id="Par40">The control rules are defined as follows:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mrow><mml:mtext>If</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">control</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>then S1</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>S4 are ON</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{If }}\left( {V_{control} } \right) &gt; V_{tri1} \;{\text{then S1}},\;{\text{S4 are ON}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mrow><mml:mtext>If</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">control</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>then S2</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>S3 are ON</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{If }}\left( { - V_{control} } \right) &gt; V_{tri1} \;{\text{then S2}},\;{\text{S3 are ON}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ6.gif"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mrow><mml:mtext>If</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">control</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>then S5</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>S6,</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>S7 are ON</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{If }}\left( {\left| {V_{control} } \right|} \right) &lt; V_{tri1} \;{\text{then S5}},\;{\text{S6,}}\;{\text{S7 are ON}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mrow><mml:mtext>If</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">control</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>then S8</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>S11 are ON</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{If }}\left( {\left| {V_{control} } \right|} \right) &gt; V_{tri2} \;{\text{then S8}},\;{\text{S11 are ON}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ8.gif"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mrow><mml:mtext>If</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">control</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>then S9</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>S10 are ON</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{If }}\left( {\left| {V_{control} } \right|} \right) &lt; V_{tri2} \;{\text{then S9}},\;{\text{S10 are ON}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ9.gif"/></alternatives></disp-formula></p><p id="Par41">The proposed inverter is comprised of five operation modes, two of which are in the positive cycle (Modes 1 and 2), two are in the negative cycle (Modes 3 and 4), and one is in the freewheeling cycle (Mode 5). In the positive or negative cycle, four switches are ON, while in the freewheeling mode, three switches are ON. The circuit diagram with switch status demonstrating different operational modes is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Circuit diagram with switch status demonstration for the first structure of the proposed topology in different operation modes: <bold>a</bold> Mode 1, <bold>b</bold> Mode 2, <bold>c</bold> Mode 3, <bold>d</bold> Mode 4, and <bold>e</bold> Mode 5</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig8_HTML.png" id="MO8"/></fig></p><p id="Par42"><bold>Mode 1</bold>: S1, S4, S9, and S10 are ON while the other switches are OFF. In this case, the positive and negative terminals of PV2 are connected to points A and B, respectively. Figure <xref rid="Fig8" ref-type="fig">8</xref>a shows the circuit diagram with the corresponding switch status. Differential (output voltage) and common mode voltages are calculated as:<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AN} = \frac{3}{4}V_{PV1},\quad V_{BN} = \frac{1}{4}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ10.gif"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AB} = V_{AN} - V_{BN} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ11.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ12.gif"/></alternatives></disp-formula></p><p id="Par43"><bold>Mode 2:</bold> S1, S4, S8, and S11 are ON while the other switches are OFF. In this case, the positive and negative terminals of PV1 are connected to points A and B, respectively (shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b). Differential (output voltage) and common mode voltages are calculated as:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AN} = V_{PV1},\quad V_{BN} = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AB} = V_{AN} - V_{BN} = V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ14.gif"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ15.gif"/></alternatives></disp-formula></p><p id="Par44"><bold>Mode 3:</bold> S2, S3, S9, and S10 are ON while the other switches are OFF. In this mode, the positive and negative terminals of PV2 are connected to points B and A, respectively (shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>c), and the voltages are calculated as:<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AN} = \frac{1}{4}V_{PV1},\quad V_{BN} = \frac{3}{4}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AB} = V_{AN} - V_{BN} = - \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ17.gif"/></alternatives></disp-formula><disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ18.gif"/></alternatives></disp-formula></p><p id="Par45"><bold>Mode 4:</bold> S2, S3, S8, and S11 are ON while the other switches are OFF. In this mode, the positive and negative terminals of PV1 are connected to points B and A, respectively (as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>d), and the voltage are defined as:<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AN} = 0,\quad V_{BN} = V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ19.gif"/></alternatives></disp-formula><disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AB} = V_{AN} - V_{BN} = - V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ20.gif"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ21.gif"/></alternatives></disp-formula></p><p id="Par46"><bold>Mode 5:</bold> This mode is the freewheeling cycle, so S5, S6, and S7 are ON, while the midpoint of the PV panels is connected to both points A and B (shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>e). In this case, the voltages are determined as:<disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AN} = V_{BN} = \frac{1}{2}V_{PV1} = V_{PV2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ22.gif"/></alternatives></disp-formula><disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{AB} = 0$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ23.gif"/></alternatives></disp-formula><disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">AN</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">BN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{CM} = \frac{V_{AN} + V_{BN}}{2} = \frac{1}{2}V_{PV1}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_Equ24.gif"/></alternatives></disp-formula></p><p id="Par47">The voltages in points A and B relative to the reference point (N), and the voltages in the common and differential modes in each of the operation modes are given in Table <xref rid="Tab1" ref-type="table">1</xref>. As observed in all the equations above, the common mode voltages in all the operating modes are constant and equal to V<sub>PV1</sub>/2. In this structure, the leakage current is reduced by stabilizing the common mode voltage in all modes to V<sub>PV1</sub>/2. There are five levels of output voltage, including − V<sub>PV1</sub>, − <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq1.gif"/></alternatives></inline-formula> V<sub>PV1</sub>, 0, + <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq2.gif"/></alternatives></inline-formula> V<sub>PV1</sub>, + V<sub>PV1</sub>, which are more than other structures such as HERIC.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Differential (output) and common mode voltage values in different operation modes for the first structure</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Mode</p></th><th align="left"><p>V<sub>AN</sub></p></th><th align="left"><p>V<sub>BN</sub></p></th><th align="left"><p>V<sub>DM</sub></p></th><th align="left"><p>V<sub>CM</sub></p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td align="left"><p><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq3.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq4.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq5.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq6.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td></tr><tr><td align="left"><p>2</p></td><td align="left"><p>V<sub>PV1</sub></p></td><td align="left"><p>0</p></td><td align="left"><p>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq7.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td></tr><tr><td align="left"><p>3</p></td><td align="left"><p><inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq8.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq9.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p>− <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq10.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq11.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td></tr><tr><td align="left"><p>4</p></td><td align="left"><p>0</p></td><td align="left"><p>V<sub>PV1</sub></p></td><td align="left"><p>− V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq12.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td></tr><tr><td align="left"><p>5</p></td><td align="left"><p><inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq13.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p><inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq14.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td><td align="left"><p>0</p></td><td align="left"><p><inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2022_240_Article_IEq15.gif"/></alternatives></inline-formula>V<sub>PV1</sub></p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec5"><title>The second structure with a different connection in the DC-Link</title><p id="Par48">In the first structure, two PV panels are used on the input side. In addition to the aforementioned configuration, the connections can be designed based on some other methods. The second structure uses four PV panels with equal voltage level. By series connection of these panels, different levels of voltage can be achieved, as shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>The second structure of the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig9_HTML.png" id="MO9"/></fig></p><p id="Par49">The switching pattern of this structure is the same as the previous structure (shown in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref>). Also, this structure has five operation modes similar to the previous one. The circuit diagram with switch status for this topology in different operation modes is presented in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, while V<sub>AN</sub>, V<sub>BN</sub>, differential voltage, and common mode voltage are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>. From Table <xref rid="Tab2" ref-type="table">2</xref>, the common mode voltages in all the operating modes are constant and equal to 2V<sub>PV</sub>. Also, the output voltages (differential) in different operational modes have five levels: − 4V<sub>PV</sub>, − 2V<sub>PV</sub>, 0, + 2V<sub>PV</sub>, and + 4V<sub>PV</sub>.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Circuit diagram with switch status demonstration for the second structure of the proposed topology in different operation modes; <bold>a</bold> Mode 1, <bold>b</bold> Mode 2, <bold>c</bold> Mode 3, <bold>d</bold> Mode 4, <bold>e</bold> Mode 5</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig10_HTML.png" id="MO10"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Differential (output) and common mode voltage values in different operation modes for the first structure</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Mode</p></th><th align="left"><p>V<sub>AN</sub></p></th><th align="left"><p>V<sub>BN</sub></p></th><th align="left"><p>V<sub>DM</sub></p></th><th align="left"><p><sub>CM</sub></p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td align="left"><p>3V<sub>PV</sub></p></td><td align="left"><p>V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td></tr><tr><td align="left"><p>2</p></td><td align="left"><p>4V<sub>PV</sub></p></td><td align="left"><p>0</p></td><td align="left"><p>4V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td></tr><tr><td align="left"><p>3</p></td><td align="left"><p>V<sub>PV</sub></p></td><td align="left"><p>3V<sub>PV</sub></p></td><td align="left"><p>− 2V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td></tr><tr><td align="left"><p>4</p></td><td align="left"><p>0</p></td><td align="left"><p>4V<sub>PV</sub></p></td><td align="left"><p>− 4V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td></tr><tr><td align="left"><p>5</p></td><td align="left"><p>2V<sub>PV</sub></p></td><td align="left"><p>2V<sub>PV</sub></p></td><td align="left"><p>0</p></td><td align="left"><p>2V<sub>PV</sub></p></td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec6"><title>Results and discussions</title><p id="Par50">To evaluate the performance of the proposed topology, simulations are performed in MATLAB/Simulink. Data is obtained for the proposed topology (with two different structures), the HERIC topology, the M-NPC topology in [<xref ref-type="bibr" rid="CR16">16</xref>], the topology in [<xref ref-type="bibr" rid="CR23">23</xref>] and the CHB topology in [<xref ref-type="bibr" rid="CR25">25</xref>]. The simulation results from MATLAB/Simulink are further validated by PSIM software with similar results obtained. In the simulations, for HERIC and M-NPC, a solar panel is considered with a voltage level of 400 V. For studies of the topologies in [<xref ref-type="bibr" rid="CR23">23</xref>] and [<xref ref-type="bibr" rid="CR25">25</xref>], one and two solar panels are considered, respectively, with a voltage level of 200 V. For the first structure of the proposed topology, the voltage levels of PV1 and PV2 are 400 V and 200 V, respectively, while the voltage level of each panel in the second structure of the proposed topology is 100 V. The grid voltage and frequency in all cases are 220 V and 50 Hz, respectively. The output filter inductors are 2 mH, and C<sub>dc</sub> is 0.47 mF. The amount of radiation and temperature for these simulations are 1000 W/m<sup>2</sup> and 25 ℃, respectively, while the value of parasitic capacitors (C<sub>PV</sub>) is 100 nF/kW. As several PV panels with different power are used in the proposed topology, the value of the leakage capacitance for each cell is proportional to the cell power (according to the ratio of 100 nF/kW). The simulations are carried out at 2 kW with unit power factor and the switching frequency is 16 kHz. The values of the simulation parameters are given in Table <xref rid="Tab3" ref-type="table">3</xref>. In the simulations, the transient state is not considered and only the steady state of the systems is presented.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Values of the simulation parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter</p></th><th align="left"><p>Value</p></th></tr></thead><tbody><tr><td align="left"><p>Input voltage</p></td><td align="left"><p>400 V</p></td></tr><tr><td align="left"><p>Grid voltage</p></td><td align="left"><p>220 V AC/50 Hz</p></td></tr><tr><td align="left"><p>Pout</p></td><td align="left"><p>2 kW</p></td></tr><tr><td align="left"><p>Switching frequency</p></td><td align="left"><p>16 kHz</p></td></tr><tr><td align="left"><p>Cdc</p></td><td align="left"><p>0.47 mF</p></td></tr><tr><td align="left"><p>L<sub>1</sub>, L<sub>2</sub></p></td><td align="left"><p>2 mH</p></td></tr><tr><td align="left"><p>Cpv</p></td><td align="left"><p>100 nF/1 kW</p></td></tr><tr><td align="left"><p>Rg</p></td><td align="left"><p>3 Ω</p></td></tr><tr><td align="left"><p>PF</p></td><td align="left"><p>1</p></td></tr></tbody></table></table-wrap></p><p id="Par51">From the simulation, the behaviors of the two proposed structures are similar. Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the voltage waveforms of the two structures. As can be seen, the voltages in both structures are the same, while the main differences between the two proposed structures are the leakage current and total harmonic distortion, as previously discussed. Thus the first structure is used to compare the proposed topology with conventional topologies.<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>V<sub>AN</sub>, V<sub>BN</sub>, V<sub>DM</sub> and V<sub>CM</sub> in the proposed topology; <bold>a</bold> the first structure, <bold>b</bold> the second structure</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig11_HTML.png" id="MO11"/></fig></p><p id="Par52">Figure <xref rid="Fig12" ref-type="fig">12</xref> shows V<sub>AN</sub> and V<sub>BN</sub> in HERIC, M-NPC, and the proposed topology, where the five-level voltage in the proposed topology is evident. Figure <xref rid="Fig13" ref-type="fig">13</xref> demonstrates the output voltage and the common mode voltage of the inverter in each topology, demonstrating that the common voltage variations in M-NPC and the proposed topology are much lower than that of the HERIC.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>V<sub>AN</sub> and V<sub>BN</sub> in the studied topology; <bold>a</bold> HERIC, <bold>b</bold> M-NPC, <bold>c</bold> the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig12_HTML.png" id="MO12"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>V<sub>DM</sub> and V<sub>CM</sub> in the studied topologies; <bold>a</bold> HERIC, <bold>b</bold> M-NPC, <bold>c</bold> the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig13_HTML.png" id="MO13"/></fig></p><p id="Par53">Figure <xref rid="Fig14" ref-type="fig">14</xref> shows the grid and leakage currents in each topology. Unlike HERIC, in the proposed topology several PV panels are used at the input side, and therefore, the leakage current is divided between the PV panels. Accordingly, for a more accurate comparison, grid leakage currents in different topologies are compared. As seen from Fig. <xref rid="Fig14" ref-type="fig">14</xref>, M-NPC and the proposed topology perform better at reducing and improving leakage current than HERIC. The RMS of the leakage current is 34.8 mA in HERIC compared with 14.73 mA and 13.82 mA for M-NPC and the proposed topology, respectively.<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>i<sub>grid</sub> and i<sub>leakage</sub> in the studied topologies; <bold>a</bold> HERIC, <bold>b</bold> M-NPC, <bold>c</bold> the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig14_HTML.png" id="MO14"/></fig></p><p id="Par54">For a better comparison of M-NPC with the proposed topology, the leakage current waveforms are shown in Fig. <xref rid="Fig15" ref-type="fig">15</xref> with magnification. As it clearly illustrates, the leakage current in the proposed topology is better than that of M-NPC.<fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>The magnified leakage current; <bold>a</bold> M-NPC, <bold>b</bold> the proposed topology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig15_HTML.png" id="MO15"/></fig></p><p id="Par55">By using FFT analysis, THD is obtained for the output current of each structure. From this, THD values for HERIC, M-NPC, and the proposed structure with the first and second connections are 8.6%, 8.85%, 3.64% and 4.48%, respectively.</p><p id="Par56">Figure <xref rid="Fig16" ref-type="fig">16</xref> shows the variations in the efficiency of HERIC, inverters in [<xref ref-type="bibr" rid="CR16">16</xref>] and [<xref ref-type="bibr" rid="CR23">23</xref>], and the proposed structure for different loads. The overall performance of the topologies under investigation is presented in Table <xref rid="Tab4" ref-type="table">4</xref>.<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>Efficiency changes in terms of different loads</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2022_240_Fig16_HTML.png" id="MO16"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Comparison of the performance of the topologies under investigation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Topology</p></th><th align="left"><p>HERIC</p></th><th align="left"><p>M-NPC [<xref ref-type="bibr" rid="CR16">16</xref>]</p></th><th align="left"><p>Proposed in [<xref ref-type="bibr" rid="CR23">23</xref>]</p></th><th align="left"><p>Proposed in [<xref ref-type="bibr" rid="CR25">25</xref>]</p></th><th align="left"><p>The first proposed structure</p></th><th align="left"><p>The second proposed structure</p></th></tr></thead><tbody><tr><td align="left"><p>V<sub>CM</sub> (V)</p></td><td align="left"><p>Floating (∼ 200)</p></td><td align="left"><p>Constant (200)</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td><td align="left"><p>Constant (200)</p></td><td align="left"><p>Constant (200)</p></td></tr><tr><td align="left"><p>I<sub>leakage</sub> (mA)</p></td><td align="left"><p>34.85</p></td><td align="left"><p>14.73</p></td><td align="left"><p>14.65</p></td><td align="left"><p>20.75</p></td><td align="left"><p>13.82</p></td><td align="left"><p>13.82</p></td></tr><tr><td align="left"><p>THD %</p></td><td align="left"><p>8.6</p></td><td align="left"><p>8.85</p></td><td align="left"><p>7.75</p></td><td align="left"><p>5.83</p></td><td align="left"><p>3.64</p></td><td align="left"><p>4.48</p></td></tr><tr><td align="left"><p>Efficiency</p></td><td align="left"><p>99.7</p></td><td align="left"><p>98.22</p></td><td align="left"><p>98.6</p></td><td align="left"><p>91</p></td><td align="left"><p>99.5</p></td><td align="left"><p>99.7</p></td></tr></tbody></table></table-wrap></p><p id="Par57">As mentioned earlier, the parasitic capacitor (C<sub>PV</sub>) capacitance value is often between 50 and 150 nF/kW. In the main simulations, 100 nF/kW is considered. To further investigate the effect of the capacitance value on the leakage current, simulations with values of 50 and 150 nF/kW are performed on the proposed topology and the results are given in Table <xref rid="Tab5" ref-type="table">5</xref>. These results show that upon increasing the parasitic capacitance, leakage current increases.<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Leakage current for different capacitors in the proposed topology</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parasitic capacitors (nF/kW)</p></th><th align="left"><p>Leakage current (mA)</p></th></tr></thead><tbody><tr><td align="left"><p>50</p></td><td char="." align="char"><p>6.91</p></td></tr><tr><td align="left"><p>100</p></td><td char="." align="char"><p>13.82</p></td></tr><tr><td align="left"><p>150</p></td><td char="." align="char"><p>20.74</p></td></tr></tbody></table></table-wrap></p><p id="Par58">We should mention that the findings presented in Table <xref rid="Tab4" ref-type="table">4</xref> are obtained at 1000 W/m<sup>2</sup> and 25 ℃. In addition to these values, variations in the radiation and temperature and their effects on leakage current and THD are investigated in each topology and the results are illustrated in Tables <xref rid="Tab6" ref-type="table">6</xref> and <xref rid="Tab7" ref-type="table">7</xref>. In Table <xref rid="Tab6" ref-type="table">6</xref>, it can be seen that variations in the temperature and radiation change the leakage current in HERIC and M-NPC topologies. However, the leakage current in the proposed topology is not dependent on the environmental changes and has a desirable low value under different environmental conditions. Also, under varying temperatures and radiations as shown in Table <xref rid="Tab7" ref-type="table">7</xref>, THD values of the previous two topologies are very high and undesirable while it is favorably low and acceptable in the proposed structure.<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>The impact of radiation and temperature changes on the leakage current (mA)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Radiation (W/m<sup>2</sup>)</p></th><th align="left"><p>Temperature (°C)</p></th><th align="left"><p>HERIC</p></th><th align="left"><p>M-NPC</p></th><th align="left"><p>Proposed (structure1)</p></th></tr></thead><tbody><tr><td align="left"><p>500</p></td><td char="." align="char"><p>25</p></td><td align="left"><p>34.1</p></td><td align="left"><p>16.2</p></td><td align="left"><p>13.82</p></td></tr><tr><td align="left"><p>750</p></td><td char="." align="char"><p>25</p></td><td align="left"><p>34.12</p></td><td align="left"><p>15.9</p></td><td align="left"><p>13.82</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>10</p></td><td align="left"><p>63</p></td><td align="left"><p>14.73</p></td><td align="left"><p>13.82</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>15</p></td><td align="left"><p>60.1</p></td><td align="left"><p>14.7</p></td><td char="." align="left"><p>13.82</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>20</p></td><td align="left"><p>45.7</p></td><td align="left"><p>14.76</p></td><td align="left"><p>13.82</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>The impact of radiation and temperature changes on the THD (%)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Radiation (W/m<sup>2</sup>)</p></th><th align="left"><p>Temperature (°C)</p></th><th align="left"><p>HERIC</p></th><th align="left"><p>M-NPC</p></th><th align="left"><p>Proposed (structure1)</p></th></tr></thead><tbody><tr><td align="left"><p>500</p></td><td char="." align="char"><p>25</p></td><td align="left"><p>31</p></td><td align="left"><p>27.6</p></td><td align="left"><p>10.6</p></td></tr><tr><td align="left"><p>750</p></td><td char="." align="char"><p>25</p></td><td align="left"><p>11.2</p></td><td align="left"><p>9.76</p></td><td align="left"><p>4.57</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>10</p></td><td align="left"><p>19.25</p></td><td align="left"><p>20.57</p></td><td align="left"><p>4.93</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>15</p></td><td align="left"><p>17.1</p></td><td align="left"><p>18.17</p></td><td align="left"><p>4.5</p></td></tr><tr><td align="left"><p>1000</p></td><td char="." align="char"><p>20</p></td><td align="left"><p>13.4</p></td><td align="left"><p>14.27</p></td><td align="left"><p>4.01</p></td></tr></tbody></table></table-wrap></p></sec><sec id="Sec7" sec-type="conclusions"><title>Conclusion</title><p id="Par59">In this paper, a new inverter has been presented to reduce leakage current. HERIC and M-NPC inverters and their effects on reducing leakage current are discussed and compared with the proposed topology. In addition to reducing leakage current, the output voltage of the proposed topology has five levels. This is more efficient than HERIC in reducing the output current THD. Although the proposed topology is slightly complex in terms of structure and switching, the most notable advantages of the proposed inverter are:<list list-type="bullet"><list-item><p id="Par60">Common mode voltage stabilization and leakage current reduction</p></list-item><list-item><p id="Par61">Multilevel output with improved THD</p></list-item><list-item><p id="Par62">Higher efficiency than the other competing topologies</p></list-item></list></p></sec></body><back><ack><title>Acknowledgements</title><p>The authors would like to acknowledge the Imam Khomeini International University, Qazvin, Iran.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><p>The paper was a collaborative effort among the authors. All authors read and approved the final manuscript.</p></sec><sec><title>Funding</title><p>Not applicable.</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>All data used or analyzed during this study are included in the published article.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par63">The authors declare that they have no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romero-Cadaval</surname><given-names>E</given-names></name><name><surname>Spagnuolo</surname><given-names>G</given-names></name><name><surname>Franquelo</surname><given-names>LG</given-names></name><etal/></person-group><article-title xml:lang="en">Grid-connected photovoltaic generation plants: Components and operation</article-title><source>IEEE Ind Electron Mag</source><year>2013</year><volume>7</volume><issue>3</issue><fpage>6</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1109/MIE.2013.2264540</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="other">Ozkan Z, Hava AM editors. Leakage current analysis of grid connected transformerless solar inverters with zero vector isolation. In 2011 IEEE energy conversion congress and exposition; 2011.</mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cha</surname><given-names>WJ</given-names></name><name><surname>Kim</surname><given-names>KT</given-names></name><name><surname>Cho</surname><given-names>YW</given-names></name><etal/></person-group><article-title xml:lang="en">Evaluation and analysis of transformerless photovoltaic inverter topology for efficiency improvement and reduction of leakage current</article-title><source>IET Power Electron</source><year>2015</year><volume>8</volume><issue>2</issue><fpage>255</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1049/iet-pel.2014.0401</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faraji</surname><given-names>F</given-names></name><name><surname>Hajirayat</surname><given-names>A</given-names></name><name><surname>Birjandi</surname><given-names>AAM</given-names></name><etal/></person-group><article-title xml:lang="en">Single-stage single-phase three-level neutral-point-clamped transformerless grid-connected photovoltaic inverters: Topology review</article-title><source>Renew Sustain Energy Rev</source><year>2017</year><volume>80</volume><fpage>197</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2017.05.181</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Luo</surname><given-names>H</given-names></name><etal/></person-group><article-title xml:lang="en">Topology review and derivation methodology of single-phase transformerless photovoltaic inverters for leakage current suppression</article-title><source>IEEE Trans Ind Electron</source><year>2015</year><volume>62</volume><issue>7</issue><fpage>4537</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1109/TIE.2015.2399278</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Poliseno M, Mastromauro R, Liserre M, et al., editors. High efficiency transformerless PV power converters. In: International symposium on power electronics power electronics, electrical drives, automation and motion; 2012. IEEE.</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gubia</surname><given-names>E</given-names></name><name><surname>Sanchis</surname><given-names>P</given-names></name><name><surname>Ursua</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Ground currents in single-phase transformerless photovoltaic systems</article-title><source>Prog Photovolt Res Appl</source><year>2007</year><volume>15</volume><issue>7</issue><fpage>629</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1002/pip.761</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Myrzik JM, Calais M, editors. String and module integrated inverters for single-phase grid connected photovoltaic systems-a review. In: 2003 IEEE Bologna Power Tech conference proceedings; 2003. IEEE.</mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Victor M, Greizer F, Bremicker S, et al. Method of converting a direct current voltage from a source of direct current voltage, more specifically from a photovoltaic source of direct current voltage, into a alternating current voltage. Google Patents; 2008.</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Xu M, Zhang L, Xing Y, et al., editors. A novel H6-type transformerless inverter for grid-connected photovoltaic application. In: 2012 7th IEEE conference on industrial electronics and applications (ICIEA); 2012. IEEE.</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>González</surname><given-names>R</given-names></name><name><surname>Lopez</surname><given-names>J</given-names></name><name><surname>Sanchis</surname><given-names>P</given-names></name><etal/></person-group><article-title xml:lang="en">Transformerless inverter for single-phase photovoltaic systems</article-title><source>IEEE Trans Power Electron</source><year>2007</year><volume>22</volume><issue>2</issue><fpage>693</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2007.892120</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Schmidt H, Siedle C, Ketterer J. DC/AC converter to convert direct electric voltage into alternating voltage or into alternating current. Google Patents; 2006.</mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name></person-group><article-title xml:lang="en">Hardware-based cascaded topology and modulation strategy with leakage current reduction for transformerless PV systems</article-title><source>IEEE Trans Ind Electron</source><year>2016</year><volume>63</volume><issue>12</issue><fpage>7823</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1109/TIE.2016.2607163</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vázquez</surname><given-names>N</given-names></name><name><surname>Rosas</surname><given-names>M</given-names></name><name><surname>Hernández</surname><given-names>C</given-names></name><etal/></person-group><article-title xml:lang="en">A new common-mode transformerless photovoltaic inverter</article-title><source>IEEE Trans Ind Electron</source><year>2015</year><volume>62</volume><issue>10</issue><fpage>6381</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1109/TIE.2015.2426146</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mei</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><etal/></person-group><article-title xml:lang="en">Highly efficient and reliable inverter concept-based transformerless photovoltaic inverters with tri-direction clamping cell for leakage current elimination</article-title><source>IET Power Electron</source><year>2016</year><volume>9</volume><issue>8</issue><fpage>1675</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1049/iet-pel.2015.0654</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Syed</surname><given-names>A</given-names></name><name><surname>Sandipamu</surname><given-names>TK</given-names></name><name><surname>Suan</surname><given-names>FTK</given-names></name></person-group><article-title xml:lang="en">High-efficiency neutral-point-clamped transformerless MOSFET inverter for photovoltaic applications</article-title><source>IET Power Electron</source><year>2017</year><volume>11</volume><issue>2</issue><fpage>246</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1049/iet-pel.2017.0389</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Khan SA, Guo Y, Zhu J, editors. A high efficiency transformerless PV grid-connected inverter with leakage current suppression. In: 2016 9th International conference on electrical and computer engineering (ICECE); 2016. IEEE.</mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Hu S, Li C, Li W, et al., editors. Enhanced HERIC based transformerless inverter with hybrid clamping cell for leakage current elimination. In: 2015 IEEE energy conversion congress and exposition (ECCE); 2015. IEEE.</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tey</surname><given-names>KS</given-names></name><name><surname>Mekhilef</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">A reduced leakage current transformerless photovoltaic inverter</article-title><source>Renew Energy</source><year>2016</year><volume>86</volume><fpage>1103</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.renene.2015.09.039</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Kukade P, Sonti V, Jain S, editors. A cascaded HERIC based multilevel inverter for reducing leakage current in the PV applications. In: IECON 2017–43rd annual conference of the IEEE industrial electronics society; 2017. IEEE.</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grigoletto</surname><given-names>FB</given-names></name></person-group><article-title xml:lang="en">Five-level transformerless inverter for single-phase solar photovoltaic applications</article-title><source>IEEE J Emerg Sel Top Power Electron</source><year>2019</year><volume>8</volume><issue>4</issue><fpage>3411</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1109/JESTPE.2019.2891937</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sabry</surname><given-names>AH</given-names></name><name><surname>Mohammed</surname><given-names>ZM</given-names></name><name><surname>Nordin</surname><given-names>FH</given-names></name><etal/></person-group><article-title xml:lang="en">Single-phase grid-tied transformerless inverter of zero leakage current for PV system</article-title><source>IEEE Access</source><year>2019</year><volume>8</volume><fpage>4361</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2019.2963284</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vosoughi</surname><given-names>N</given-names></name><name><surname>Hosseini</surname><given-names>SH</given-names></name><name><surname>Sabahi</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">A new transformer-less five-level grid-tied inverter for photovoltaic applications</article-title><source>IEEE Trans Energy Convers</source><year>2019</year><volume>35</volume><issue>1</issue><fpage>106</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1109/TEC.2019.2940539</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samizadeh</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>X</given-names></name><name><surname>Karami</surname><given-names>B</given-names></name><etal/></person-group><article-title xml:lang="en">A new topology of switched-capacitor multilevel inverter with eliminating leakage current</article-title><source>IEEE Access</source><year>2020</year><volume>8</volume><fpage>76951</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2020.2983654</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahabadini</surname><given-names>M</given-names></name><name><surname>Imaneini</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">Leakage Current Suppression in Multilevel Cascaded H-bridge Based Photovoltaic Inverters</article-title><source>IEEE Trans Power Electron</source><year>2021</year><volume>36</volume><fpage>13754</fpage><lpage>13762</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2021.3084699</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faraji</surname><given-names>F</given-names></name><name><surname>Birjandi</surname><given-names>AAM</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">An improved multilevel inverter for single-phase transformerless PV system</article-title><source>IEEE Trans Energy Convers</source><year>2020</year><volume>36</volume><issue>1</issue><fpage>281</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1109/TEC.2020.3006552</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><etal/></person-group><article-title xml:lang="en">Leakage current calculation for PV inverter system based on a parasitic capacitor model</article-title><source>IEEE Trans Power Electron</source><year>2016</year><volume>31</volume><issue>12</issue><fpage>8205</fpage><lpage>17</lpage></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">High-efficiency single-phase transformerless PV H6 inverter with hybrid modulation method</article-title><source>IEEE Trans Ind Electron</source><year>2012</year><volume>60</volume><issue>5</issue><fpage>2104</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1109/TIE.2012.2225391</pub-id></mixed-citation></ref></ref-list></ref-list><glossary><title>Abbreviations</title><def-list><def-item><term>THD</term><def><p id="Par2">Total harmonic distortion</p></def></def-item><def-item><term>PV</term><def><p id="Par3">Photovoltaic</p></def></def-item><def-item><term>HERIC</term><def><p id="Par4">Highly efficient and reliable inverter concept</p></def></def-item><def-item><term>SV</term><def><p id="Par5">Space vector</p></def></def-item><def-item><term>SCMLI</term><def><p id="Par6">Switched-capacitor multilevel inverter</p></def></def-item><def-item><term>CHB</term><def><p id="Par7">Cascaded H-bridge</p></def></def-item><def-item><term>M-NPC</term><def><p id="Par8">MOSFET neutral-point-clamped</p></def></def-item><def-item><term>C<sub>PV</sub></term><def><p id="Par9">Parasitic capacitor</p></def></def-item><def-item><term>L<sub>1</sub>, L<sub>2</sub></term><def><p id="Par10">Output inductors</p></def></def-item><def-item><term>Z<sub>G</sub></term><def><p id="Par11">Ground impedance</p></def></def-item><def-item><term>R<sub>G</sub></term><def><p id="Par12">Ground resistance</p></def></def-item><def-item><term>C<sub>dc</sub></term><def><p id="Par13">Capacitor parallel to the DC bus</p></def></def-item><def-item><term>V<sub>ECM</sub></term><def><p id="Par14">Equivalent common-mode voltage</p></def></def-item><def-item><term>V<sub>CM</sub></term><def><p id="Par15">Common mode voltage</p></def></def-item><def-item><term>V<sub>DM</sub></term><def><p id="Par16">Differential voltage</p></def></def-item><def-item><term>V<sub>PV</sub></term><def><p id="Par17">Photovoltaic panel voltage</p></def></def-item><def-item><term>I<sub>Leakage</sub></term><def><p id="Par18">Leakage current</p></def></def-item><def-item><term>I<sub>Grid</sub></term><def><p id="Par19">Grid current</p></def></def-item><def-item><term>P<sub>Out</sub></term><def><p id="Par20">Output power</p></def></def-item><def-item><term>PF</term><def><p id="Par21">Power factor</p></def></def-item><def-item><term>LSC-PWM</term><def><p id="Par22">Level-shifted carrier PWM</p></def></def-item><def-item><term>FFT</term><def><p id="Par23">Fast Fourier transform</p></def></def-item></def-list></glossary></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Common mode voltage</facet-value><facet-value count="1">Grid-connected inverters</facet-value><facet-value count="1">Leakage current</facet-value><facet-value count="1">Multilevel inverters</facet-value></facet><facet name="pub"><facet-value count="1">Protection and Control of Modern Power Systems</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">Iran</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
