<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s42162-022-00233-4</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">42162</journal-id><journal-title-group><journal-title>Energy Informatics</journal-title><abbrev-journal-title abbrev-type="publisher">Energy Inform</abbrev-journal-title></journal-title-group><issn pub-type="epub">2520-8942</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s42162-022-00233-4</article-id><article-id pub-id-type="manuscript">233</article-id><article-id pub-id-type="doi">10.1186/s42162-022-00233-4</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Recursive training based physics-inspired neural network for electric water heater modeling</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><name><surname>Pandiyan</surname><given-names>Surya Venkatesh</given-names></name><address><email>surya.v.pandiyan@ntnu.no</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs42162022002334_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Rajasekharan</surname><given-names>Jayaprakash</given-names></name><address><email>jayaprakash.rajasekharan@ntnu.no</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5947.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 1516 2393</institution-id><institution content-type="org-division">Department of Electric Power Engineering</institution><institution content-type="org-name">NTNU</institution></institution-wrap><addr-line content-type="postcode">7491</addr-line><addr-line content-type="city">Trondheim</addr-line><country country="NO">Norway</country></aff></contrib-group><author-notes><corresp id="IDs42162022002334_cor1"><label>a</label><email>surya.v.pandiyan@ntnu.no</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>21</day><month>12</month><year>2022</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2022</year></pub-date><volume>5</volume><issue seq="14">Suppl 4</issue><issue-title>Proceedings of the Energy Informatics.Academy Conference 2022 (EI.A 2022)</issue-title><issue-sponsor>Publication of this supplement was funded by SDU – Center for Energy Informatics, University of Southern Denmark. The articles have undergone the journal's standard peer review process for supplements. Supplement Editors did not handle peer review on any article that they co-authored. The Supplement Editors declare that they have no other competing interests.</issue-sponsor><elocation-id>58</elocation-id><history><date date-type="registration"><day>11</day><month>10</month><year>2022</year></date><date date-type="online"><day>21</day><month>12</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Aggregating flexibility from residential electric water heaters (EWHs) is fast gaining commercial interest. Flexibility modeling of an EWH involves highly precise and quick simulation of EWH water temperature using the EWH thermal dynamics model for various flexibility control actions. Since EWH tank water temperature data is usually unavailable or costly to obtain, developing an accurate and computationally inexpensive EWH thermal dynamics model with limited sensor data is essential for devising advanced control strategies for EWH flexibility aggregation. In this paper, we present a novel recursive training-based unsupervised physics-informed neural network (PINN) model for predicting tank water temperature which requires only historical EWH power consumption data to train the model. PINN models enable the integration of domain knowledge from traditional physical processes and methods into neural network (NN) models. Single-zone thermal grey-box differential equation model (DEM) is used as the basis to develop and demonstrate proof-of-concept of the proposed approach. Physics from the single-zone model is encoded into the PINN loss function to incorporate domain knowledge and the PINN architecture is structured to mimic the single-zone DEM. The recursive training approach enables the use of previous-step water temperature as an input to the simulation model. Two separate models for EWH ON- and OFF-states are developed and trained with real-world EWH power consumption data. Water temperature prediction results indicate that the proposed approach has similar performance as the traditional single-zone DEM model, thereby demonstrating the ability of the proposed model to learn the underlying physics behind the single-zone model without water temperature data. The proposed model has high accuracy and performs well outside the control set point temperatures indicating its suitability for simulating load shifting and other DR events. Additionally, EWH simulation results for two different scenarios with different water demand compositions are presented to study the effects of propagation errors on temperature prediction. The proposed approach paves the way for developing advanced EWH flexibility modeling tools for the aggregator to precisely control a large portfolio of EWHs considering user comfort and rebound effects.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Physics-informed neural networks</kwd><kwd>Electric water heater</kwd><kwd>Temperature prediction</kwd><kwd>Flexibility modeling</kwd><kwd>Recursive training</kwd></kwd-group><conference><conf-name>Energy Informatics.Academy Conference 2022 (EI.A 2022)</conf-name><conf-loc>Vejle, Denmark</conf-loc><conf-date>24-25 August 2022</conf-date></conference><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>28</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>10</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>11</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/42162_2022_Article_233.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>12</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>12</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Supplement</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Computer Science</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Information Systems and Communication Service</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Computer Science</meta-value></custom-meta><custom-meta><meta-name>conf-event-url-1</meta-name><meta-value>https://www.energyinformatics.academy/eia-2022-conference</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par27">To reduce greenhouse gases and achieve carbon emissions reduction targets, many governments are rapidly increasing the share of highly intermittent renewable energy sources in their country’s energy mix. These resources are distributed over the grid as opposed to the centralized generation units. Due to their inherent nature and distributed setup, renewable generation will pose considerable challenges to grid stability in the future. This calls for increased power system flexibility for the reliable operation of modern smart energy systems.</p><p id="Par28">Power system flexibility needs are expected to increase by 66% in the EU from 2018 to 2040 under sustainable development scenarios (Iea <xref ref-type="bibr" rid="CR13">2022</xref>). The required flexibility will increase significantly once the renewable energy shares increase above 30 percent of annual electricity production in Europe (Huber et al. <xref ref-type="bibr" rid="CR12">2014</xref>). Traditional flexibility sources like conventional generators alone will not suffice to meet increasing flexibility requirements. Digitalization of the electricity grid resulting in smart grids presents an opportunity to tap more flexible resources from the demand side. Demand-side flexibility (DSF) is seen as one of the key contributing factors to tackling increasing flexibility needs. IEA estimates a global DSF potential of 4000 TWh/year or 15 percent of global electricity demand (Zhongming et al. <xref ref-type="bibr" rid="CR29">2017</xref>). A study estimates 12–23 GW of DSF in the northern European system with a total peak load of 77 GW (Söder et al. <xref ref-type="bibr" rid="CR24">2018</xref>). Additionally, DSF can provide various ancillary services such as frequency regulation, reactive power management, etc., to the grid at a lower cost. However, technical challenges involved in harnessing and realizing the full potential of DSF should be addressed first in order to develop appropriate solutions.</p><p id="Par29">In the domestic sector, Electric Water Heaters (EWHs) have a great potential for providing DSF as they are power-intensive devices with thermal storage capabilities. A basic analysis commissioned by NVE shows that EWHs in Europe have an approximate daily flexibility capacity of 20 GW (Norges vassdrags-og energidirektorat <xref ref-type="bibr" rid="CR25">2021</xref>) which is equal to the total installed capacity in Czech Republic and more than the generation capacity in Finland. Aggregated flexibility potential of EWHs from 50% of Norwegian households is estimated to be around 1000 MWh/h (Lakshmanan et al. <xref ref-type="bibr" rid="CR16">2021</xref>). Aggregated control and operation of distributed EWHs can significantly address the flexibility needs at both distribution and transmission levels. Thus, it is of great importance to develop tools that can aggregate flexibility from EWHs for providing grid solutions.</p><p id="Par30">Estimating near-term flexibility available from EWHs requires the prediction of future water temperature for different control actions considering future hot water demand. It is crucial to maintain the tank water temperature within a range, both for the user’s comfort and to avoid legionella bacteria growth. Various control strategies for EWH have been explored in the literature and can be classified into model-based control (Ahmed et al. <xref ref-type="bibr" rid="CR1">2018</xref>; Nehrir et al. <xref ref-type="bibr" rid="CR18">2007</xref>; Vrettos et al. <xref ref-type="bibr" rid="CR26">2012</xref>) and model-free control (Ruelens et al. <xref ref-type="bibr" rid="CR22">2016</xref>; Cao et al. <xref ref-type="bibr" rid="CR3">2020</xref>; Kazmi et al. <xref ref-type="bibr" rid="CR15">2016</xref>). As the name suggests, model-based control requires an EWH model for finding optimum control action as opposed to model-free control. Most approaches in the model-based control use a simplified model with low accuracy or assume access to data that is not possible/expensive in real world or use a complex model with high computational complexity. Most popular model-free control techniques such as reinforcement learning require a temperature sensor for online training or a simulator model for offline training. In-built temperature sensor from EWHs usually does not provide data and it is expensive to install and collect data from a new sensor. Therefore, an EWH model is required for developing model-free control. Thus, the control strategy for scheduling domestic EWHs for flexibility activation without affecting user comfort and severe rebound effect requires precise knowledge of appliance thermal dynamics and hot water usage profile.</p><p id="Par31">EWH modeling can be classified into white-box, grey-box, and black-box based models. White-box or physics-based modeling of EWHs requires complete individual system information of each EWH which is either very difficult to obtain or unavailable to aggregators (Hossain et al. <xref ref-type="bibr" rid="CR10">2021</xref>). These models are developed using detailed knowledge of the underlying physical processes (Farooq et al. <xref ref-type="bibr" rid="CR6">2015</xref>) with few or no assumptions and do not require input-output data. However, they require significant effort to develop and tune the parameters such as friction parameter, mixing ratio, thickness of tank wall, etc. Even though white-box based models have good generalization capabilities, they have low accuracy compared to data-driven models (Farooq et al. <xref ref-type="bibr" rid="CR6">2015</xref>).</p><p id="Par32">The grey-box differential equation model (DEM) based on energy flow analysis is a less complex approach compared to white-box modeling. Grey-box models use simplified mathematical structure from white-box models and require input-output data to estimate parameters such as thermal capacity and thermal resistance. Most studies use single-zone grey-box model for EWH modeling due to its simplicity and analytical tractability (Paull et al. <xref ref-type="bibr" rid="CR20">2010</xref>; Xiang et al. <xref ref-type="bibr" rid="CR27">2019</xref>; Ahmed et al. <xref ref-type="bibr" rid="CR1">2018</xref>). Single-zone models assume uniform tank water temperature which is quite simplistic. A DEM for single-zone EWH that uses only power consumption for parameter estimation and average water usage estimation is proposed in Shad et al. (<xref ref-type="bibr" rid="CR23">2015</xref>).  Despite its simplicity, accuracy of single-zone model is not suited for precise control of EWHs (Xu et al. <xref ref-type="bibr" rid="CR28">2014</xref>). Some grey-box approaches include thermal stratification effects in their models, assuming two or more thermal zones inside the EWH (Farooq et al. <xref ref-type="bibr" rid="CR6">2015</xref>; Nel et al. <xref ref-type="bibr" rid="CR19">2016</xref>; Alvarez et al. <xref ref-type="bibr" rid="CR2">2019</xref>; Zuñiga et al. <xref ref-type="bibr" rid="CR31">2017</xref>) and need more than one first-order differential equation for each thermal zone. While multiple-zone grey-box models have higher accuracy than single-zone models, they are computationally expensive.</p><p id="Par33">Alternatively, data-driven black-box models can model non-linear dynamics and provide faster computation during temperature estimation but require expensive and extensive data collection (Han and Jentzen <xref ref-type="bibr" rid="CR9">2018</xref>). Moreover, black-box models cannot guarantee learning underlying EWH physical processes (Karniadakis et al. <xref ref-type="bibr" rid="CR14">2021</xref>). Therefore, there is a need for computationally efficient models that require limited data but also capture the detailed physics of EWH operation.</p><p id="Par34">Scientific machine learning (SML) is an emerging field that seeks to integrate traditional engineering methods into machine learning-based techniques to utilize prior domain knowledge and physical phenomena in the learning process (Rackauckas et al. <xref ref-type="bibr" rid="CR21">2020</xref>). SML-based physics-informed neural networks (PINN) have been explored for modeling building thermal dynamics (Drgoňa et al. <xref ref-type="bibr" rid="CR5">2021</xref>; Gokhale et al. <xref ref-type="bibr" rid="CR8">2022</xref>) and for estimating battery state of charge (Luzi et al. <xref ref-type="bibr" rid="CR17">2019</xref>). PINN is gaining popularity across many fields and their application in power systems are discussed in Huang and Wang (<xref ref-type="bibr" rid="CR11">2022</xref>).</p><p id="Par35">SML-based approaches replacing traditional methods are gaining interest due to their speed and comparable performance. A recursive training based unsupervised PINN is proposed in this paper for developing EWH water temperature prediction model where the current water temperature is used as an important variable for accurate prediction of future water temperature. This paper provides proof-of-concept for applying SML-based approaches for developing data-driven temperature prediction models for EWHs when only historical power consumption data is available. The goal is to replace DEM with computationally efficient PINN models that can achieve similar or better performance. In addition to learning the physics of EWH operation, results from the proposed approach provide plenty of scope and insights for further developing advanced high-precision PINN-based EWH models for large-scale flexibility aggregation. The proposed model can also be easily extended to multiple-zone stratified model as the physics of each zone is similar to the single-zone model.</p><p id="Par36">The main contributions of this paper are:<list list-type="bullet"><list-item><p id="Par37">Developing an unsupervised PINN-based temperature prediction model for EWHs when only historical power consumption data is available.</p></list-item><list-item><p id="Par38">Formulating a recursive training approach to model previous temperature as an input parameter in unsupervised learning setting.</p></list-item><list-item><p id="Par39">Demonstrating that the proposed model performs comparably with traditional single-zone DEM.</p></list-item></list>The rest of the paper is organized as follows. “<xref rid="Sec2" ref-type="sec">Background</xref>” section provides theoretical background on single-zone DEM and summarizes parameter and water-rate estimation steps. Under the “<xref rid="Sec5" ref-type="sec">Methodology</xref>” section, the loss functions, the PINN architecture and the recursive training procedure are discussed. Simulation results are presented, compared and discussed in “<xref rid="Sec14" ref-type="sec">Results and discussion</xref>” section and the conclusion and future work are summarized in “<xref rid="Sec15" ref-type="sec">Conclusion and future work</xref>” section.</p></sec><sec id="Sec2"><title>Background</title><p id="Par40">Thermostat temperature settings determine the ON/OFF states of the EWH. When water temperature reaches a lower threshold temperature <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq1.gif"/></alternatives></inline-formula>, the in-built controller turns on the heater and vice-versa when the temperature reaches a higher threshold temperature <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq2.gif"/></alternatives></inline-formula>. The evolution of water temperature profile depends upon EWH characteristics, current water temperature <italic>T</italic>(<italic>t</italic>), future hot water demand, ambient temperature <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">amb</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{amb}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq3.gif"/></alternatives></inline-formula>, inlet water temperature <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{in}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq4.gif"/></alternatives></inline-formula>, etc. This section presents the theory behind single-zone EWH model and also summarizes the steps involved in parameter estimation and water rate estimation when only power consumption data is available.</p><sec id="Sec3"><title>Single-zone DEM</title><p id="Par41">The single-zone DEM assumes that water inside the EWH is perfectly mixed and the water temperature is uniform. It also assumes that the EWH has a single heating element. The schematic representation of single-zone DEM model is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The energy balance equation representing single-zone DEM is calculated as follows.<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="italic">flow</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="italic">loss</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{T}}(t)=\frac{1}{C}[Q_{flow}+Q_{loss}+Q_H]. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ1.gif"/></alternatives></disp-formula><fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Schematic representation of the energy flow in single-zone model</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig1_HTML.png" id="MO2"/></fig></p><p id="Par42">where C = <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq5.gif"/></alternatives></inline-formula><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq6.gif"/></alternatives></inline-formula>V is the thermal capacity(Ws/<inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq7.gif"/></alternatives></inline-formula>C), <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq8.gif"/></alternatives></inline-formula> represent the water density (1000 kg/m<sup>3</sup>), <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq10.gif"/></alternatives></inline-formula> is specific heat capacity (4196 <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mi>W</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Ws/ Kg^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq11.gif"/></alternatives></inline-formula>) of water. <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="italic">flow</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{flow}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq12.gif"/></alternatives></inline-formula> represents energy loss due to hot water demand and is a function of the water demand and the temperature difference between <italic>T</italic>(<italic>t</italic>) and <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{in}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq13.gif"/></alternatives></inline-formula>. <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="italic">loss</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{loss}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq14.gif"/></alternatives></inline-formula> represents natural heat loss to the atmosphere due to the temperature difference between T(t) and <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">amb</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{amb}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq15.gif"/></alternatives></inline-formula>. <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq16.gif"/></alternatives></inline-formula> represents the energy gain due to the heating element converting electrical energy into thermal energy. Water temperature can be obtained by solving Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>).</p><p id="Par43">The Ordinary Differential Equation (ODE) describing temperature rate <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}} (t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq17.gif"/></alternatives></inline-formula> in the single-zone thermal model (Shad et al. <xref ref-type="bibr" rid="CR23">2015</xref>) is given in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>).<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">amb</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{T}}(t)=\frac{1}{C}[Q(t)-G(T(t)-T_{amb}(t))-\rho c_p W_d(t)(T(t)-T_{in}(t))], \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ2.gif"/></alternatives></disp-formula>where G = A/R is the thermal conductance(W/<inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq18.gif"/></alternatives></inline-formula>C) of the tank, V is the volume of the tank, A is the surface area of the tank, and R is the thermal resistance of the tank. <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_d(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq19.gif"/></alternatives></inline-formula> denotes the hot water demand.</p><p id="Par44">Q(t) is the rate of energy input and is a function of water temperature in a thermostatically controlled water heater as described in Eq. (<xref rid="Equ3" ref-type="disp-formula">3</xref>). <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq20.gif"/></alternatives></inline-formula> denotes the nominal power rating of the EWH and Q(t − <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mi>δ</mml:mi></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq21.gif"/></alternatives></inline-formula>t) denotes the previous value of consumed power.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Q(t)=&amp;\,\,{\left\{ \begin{array}{ll} Q_{0} &amp;{} T(t) \le T_{lo}\\ 0 &amp;{} T(t) \ge T_{hi}\\ Q(t - \delta t) &amp;{} otherwise. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ3.gif"/></alternatives></disp-formula>Analytical solution to Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>). is given as:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T(t)=T(t_{0})e^{-(t-t_{0})/\tau }+K(1-e^{-(t-t_{0})/\tau }), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ4.gif"/></alternatives></disp-formula><disp-formula id="Equ12"><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tau ={C\over G+\rho c_pW_{d}}, \quad K={GT_{out}+\rho c_pW_{d}T_{in}+Q\over G+\rho c_pW_{d}}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ12.gif"/></alternatives></disp-formula>where <italic>t</italic> and <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq22.gif"/></alternatives></inline-formula> represents current and initial time step and <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(t_{0})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq23.gif"/></alternatives></inline-formula> represents temperature at initial time-step. Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) can be used estimate water temperature at any time-step.</p></sec><sec id="Sec4"><title>Parameter and water rate estimation</title><p id="Par45">There are multiple parameters in the single-zone DEM model that needs to be estimated. <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">amb</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{amb}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{in}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq25.gif"/></alternatives></inline-formula> are assumed to be constant for simplicity. Thermostat set-points <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq27.gif"/></alternatives></inline-formula> are assumed based on literature review (Lakshmanan et al. <xref ref-type="bibr" rid="CR16">2021</xref>). These values are easily available for a particular geographical area and from the EWH’s technical specifications sheet.</p><p id="Par46">Physical parameters <italic>C</italic> and <italic>G</italic> need to be estimated solely from power consumption data. Using the method proposed in Shad et al. (<xref ref-type="bibr" rid="CR23">2015</xref>), <italic>C</italic> and <italic>G</italic> in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) are estimated and the steps are summarized as follows.<list list-type="bullet"><list-item><p id="Par47">It can be fairly assumed that maximum OFF duration Max<inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">off</mml:mi></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{off}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq28.gif"/></alternatives></inline-formula> and minimum ON duration Min<inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">on</mml:mi></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{on}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq29.gif"/></alternatives></inline-formula> happen when hot water demand is zero.</p></list-item><list-item><p id="Par48">Max<inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">off</mml:mi></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{off}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq30.gif"/></alternatives></inline-formula> and Min<inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">on</mml:mi></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{on}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq31.gif"/></alternatives></inline-formula> can be obtained from the power consumption data and water demand is assumed zero.</p></list-item><list-item><p id="Par49">Replacing <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t-t_{0})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq32.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) using Max<inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">off</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{off}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq33.gif"/></alternatives></inline-formula> and Min<inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">on</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{on}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq34.gif"/></alternatives></inline-formula> and solving the pair of the obtained equation provides an estimated value for C and G.</p></list-item></list>Hot water demand <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{d}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq35.gif"/></alternatives></inline-formula> is stochastic to some extent and can not be assumed constant. The duration for which EWH stays on or off depends upon the hot water demand during that duration. The average water rate during a particular event is also estimated using the method proposed in Shad et al. (<xref ref-type="bibr" rid="CR23">2015</xref>) and is summarized as follows.<list list-type="bullet"><list-item><p id="Par50">From the power consumption data, the duration of each ON event and OFF event can be obtained. ON/OFF event represents the operation/non-operation of EWH between two control commands (turn-on and turn-off).</p></list-item><list-item><p id="Par51">Calculated duration along with estimated parameters C and G can be used in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) to obtain the average water demand during a particular event.</p></list-item></list></p></sec></sec><sec id="Sec5" sec-type="methods"><title>Methodology</title><p id="Par52">Prior knowledge from EWH thermal dynamics can be employed in PINN loss functions and in designing PINN architecture. Two separate temperature prediction models with one-minute prediction intervals for ON- and OFF-events of an EWH are developed. This section describes data preparation, setting up physics-based loss functions, PINN architecture, and recursive training steps for the proposed approach.</p><sec id="Sec6"><title>Data preparation</title><p id="Par53">The training data set used in this work contains minute-wise continuous power consumption data. The number of ON/OFF events and their duration can be inferred from power consumption data. From the data set, ON and OFF events are separated for training ON- and OFF-dynamics models respectively. Average water rates are estimated for randomly selected events and used for training.</p></sec><sec id="Sec7"><title>Loss functions</title><p id="Par54">Custom loss functions developed to train the neural network (NN) are explained here. Since temperature data is unavailable, it is necessary that developed loss functions well represent the physics of EWH in order for the NN to learn. Multiple loss functions that represent the physics are developed and listed here.</p><sec id="Sec8"><title>Temperature range</title><p id="Par55">In a thermostat-controlled EWH, under normal operation, the water temperature will not exceed <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq36.gif"/></alternatives></inline-formula> and will not drop below <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq37.gif"/></alternatives></inline-formula>. This knowledge is modeled as a loss function <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq38.gif"/></alternatives></inline-formula> and is shown in Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>).<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} L_1=&amp;\,\,{\left\{ \begin{array}{ll}(T_{prd}(t)-\frac{(T_{hi}+T_{lo})}{2}) &amp;{} T_{prd}(t)&gt;T_{hi} \\ &amp;{} or\; T_{prd}(t)&lt; T_{lo}\\ 0 &amp;{} T_{lo}&lt; T_{prd}(t)&lt; T_{hi}.\end{array}\right. } \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ5.gif"/></alternatives></disp-formula>Loss function L<inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mrow/><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq39.gif"/></alternatives></inline-formula> penalizes the network during training when the predicted temperature is not between <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq41.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec9"><title>Temperature change</title><p id="Par56">When the EWH is OFF, water temperature continues to decrease until <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq42.gif"/></alternatives></inline-formula> before the EWH turns on. So in the OFF-dynamics model, the difference between two consecutive predictions for two consecutive time steps of an event should be positive. For the OFF-dynamics model, this information is modeled as a loss function <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">off</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^{off}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq43.gif"/></alternatives></inline-formula> as shown in (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>).<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">off</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">pred</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} L^{off}_2={\left\{ \begin{array}{ll}(T_{prd}(t)-T_{pred}(t-1)) &amp;{} T_{prd}(t)\ge T_{prd}(t-1)\\ 0 &amp;{} otherwise. \end{array}\right. } \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ6.gif"/></alternatives></disp-formula>When the EWH is ON, water temperature will increase when water rate is sufficiently low or will decrease/stay the same when water rate is sufficiently high. Since the estimated average water rate is used in this model, water temperature will not decrease at any instant when EWH is ON according to DEM. For the ON-dynamics model, this information is modeled as loss function <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">on</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^{on}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq44.gif"/></alternatives></inline-formula> as shown in Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>).<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">on</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">pred</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} L^{on}_2={\left\{ \begin{array}{ll}(T_{prd}(t-1)-T_{pred}(t)) &amp;{} T_{prd}(t-1)\ge T_{prd}(t)\\ 0 &amp;{} otherwise. \end{array}\right. } \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ7.gif"/></alternatives></disp-formula></p></sec><sec id="Sec10"><title>Total temperature change per event</title><p id="Par57">The water temperature at start (T<inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">start</mml:mi></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{start}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq45.gif"/></alternatives></inline-formula>) and end of an event (T<inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">end</mml:mi></mml:msub></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{end}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq46.gif"/></alternatives></inline-formula>) is known for a particular event. T<inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">start</mml:mi></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{start}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq47.gif"/></alternatives></inline-formula> and T<inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">end</mml:mi></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{end}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq48.gif"/></alternatives></inline-formula> are equal to thermostat control set-points <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq50.gif"/></alternatives></inline-formula> for OFF events. T<inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">start</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{start}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq51.gif"/></alternatives></inline-formula> and T<inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">end</mml:mi></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{end}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq52.gif"/></alternatives></inline-formula> are equal to <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq54.gif"/></alternatives></inline-formula> for ON events. Time t<inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">end</mml:mi></mml:msub></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{end}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq55.gif"/></alternatives></inline-formula> can be inferred from the power consumption data. This information is modeled as loss function L<inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:msub><mml:mrow/><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq56.gif"/></alternatives></inline-formula> as shown in Eq. (<xref rid="Equ10" ref-type="disp-formula">10</xref>).<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>∣</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_{spd}= &amp; {} \mid (T_{hi}-T_{lo})\mid. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ8.gif"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>∣</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">start</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">pred</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">end</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">start</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">on</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">start</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">off</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">start</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T^{prd}_{spd}= &amp; {} \mid (T(t_{start})-T_{pred}(t_{end}))\mid \nonumber \\ t_{start}= &amp; {} 0\quad \quad T^{on}(t_{start})=T_{lo}\quad \quad T^{off}(t_{start})=T_{hi}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ9.gif"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>∣</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_3= &amp; {} {\left\{ \begin{array}{ll}\mid (T_{spd}-T^{prd}_{spd})\mid &amp;{} T^{prd}_{spd}\ne T_{spd}\\ 0 &amp;{} otherwise. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ10.gif"/></alternatives></disp-formula><inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{spd}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^{prd}_{spd}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq58.gif"/></alternatives></inline-formula> represent actual and predicted set points difference. <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:msub><mml:mi>L</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq59.gif"/></alternatives></inline-formula> loss function ensures that the predicted temperature <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">end</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{end}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq60.gif"/></alternatives></inline-formula> is equal to the set-point temperature for a particular event.</p></sec><sec id="Sec11"><title>Relevant-ODE</title><p id="Par58">L<inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mrow/><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq61.gif"/></alternatives></inline-formula>-L<inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mrow/><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{3}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq62.gif"/></alternatives></inline-formula> loss functions do not reflect the influence of water temperature <italic>T</italic>(<italic>t</italic>) on the rate of change in water temperature <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq63.gif"/></alternatives></inline-formula>. Temperature change is continuous in the real world. Hence, <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq64.gif"/></alternatives></inline-formula> also changes continuously. The predictions can have constant <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq65.gif"/></alternatives></inline-formula> and still satisfy L1–L3 losses. For a constant water rate, <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq66.gif"/></alternatives></inline-formula> will decrease when <italic>T</italic>(<italic>t</italic>) moves closer to <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq67.gif"/></alternatives></inline-formula> when EWH is ON and <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq68.gif"/></alternatives></inline-formula> will decrease when <italic>T</italic>(<italic>t</italic>) moves closer to <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq69.gif"/></alternatives></inline-formula> when EWH is OFF.</p><p id="Par59">In a supervised PINN model, generally relevant ODE is used to model an additional loss function to incorporate prior scientific knowledge. ODE used in this work is given in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>). The goal is to minimize the difference between the gradient of the network’s output with respect to its inputs and the gradient calculated using DEM. This ensures that PINN solutions are consistent with the known physics. The modeled loss function L<inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mrow/><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq70.gif"/></alternatives></inline-formula> is shown in Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>).<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">DEM</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_4=\left(\frac{dT_{DEM}(x_i)}{dt}-\frac{dNN(x_i)}{dt}\right), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_Equ11.gif"/></alternatives></disp-formula><inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{dT(x_i)}{dt}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq71.gif"/></alternatives></inline-formula> is calculated using Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>). L4 loss function ensures that for a constant water rate, <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq72.gif"/></alternatives></inline-formula> will decrease when <italic>T</italic>(<italic>t</italic>) moves closer to <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq73.gif"/></alternatives></inline-formula> when EWH is on and <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq74.gif"/></alternatives></inline-formula> will decrease when <italic>T</italic>(<italic>t</italic>) moves closer to <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq75.gif"/></alternatives></inline-formula> when EWH is off.</p><p id="Par60">All loss values are scaled and combined together for training the PINN.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Schematic representation of the proposed architecture for PINN for learning EWH ON- and OFF-dynamics . The difference in network architecture between ON- and OFF-dynamics model is shown using the zoomed-in view of the initial layers of PINN using different colors. The green view represents initial layers of ON-dynamics model and the black view represents initial layers of OFF-dynamics model</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig2_HTML.png" id="MO14"/></fig></p></sec></sec><sec id="Sec12"><title>Network architecture</title><p id="Par61">A simple feed-forward artificial neural network is used to develop the proposed architecture. A priori knowledge from single-zone model is used to define the network architecture. More precisely, the initial layers are structured to mimic the differential equation defined in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>). This ensures that physics from single-zone model is embedded in the NN architecture and inputs are processed according to it before feeding it to neural layers. The schematic representation of the proposed architecture for the ON- and OFF-dynamics model is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The number of layers and neurons in the figure does not reflect the actual model. NN parameters such as the number of layers, neurons, activation functions, etc., were selected heuristically. The inputs to the models are previous time step temperature, average water rate, and other relevant inputs to Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) which are assumed constant. The output is current water temperature.</p><p id="Par62">There is also another constant input representing the time step (60s) of the prediction. This input is constant for all predictions and yet relevant to training the network. Without the time input, there is no time reference in the network. The time input is also required to calculate the L<inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msub><mml:mrow/><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq76.gif"/></alternatives></inline-formula> loss function as it requires a gradient of NN with respect to the input time-step.</p><p id="Par63">The proposed architecture mimicking the DEM requires previous step temperature as an input. However, the goal is to learn the underlying EWH thermal dynamics in the absence of temperature data. A recursive training approach is selected to train the network.</p></sec><sec id="Sec13"><title>Recursive training</title><fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Figa_HTML.png" position="anchor" id="MO15"/></fig><p id="Par64">In time series data, the current value is highly correlated with the immediate past values. Hence, previous step temperature is highly relevant for current temperature prediction model. Recursive training is an iterative training approach in which the next input is created based on the output from the previous training input. During training, new input is created recursively after processing the previous input. In this case, the previous step temperature input is created based on the PINN output to the previous input. The pseudo-code for recursive training approach is given as follows.</p><p id="Par65">First, the network weights are initialized randomly. For each event, the initial point for previous step temperature is required and is available. It is known that the initial temperature for an event is equal to <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq77.gif"/></alternatives></inline-formula> or <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">low</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{low}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq78.gif"/></alternatives></inline-formula> depending upon whether it is an OFF or ON event. <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq79.gif"/></alternatives></inline-formula> or <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">low</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{low}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq80.gif"/></alternatives></inline-formula> will act as an initial point for previous step temperature. The next input is created based on the output predicted by PINN. This process repeats until the end of an event. Since the event duration is known, once an event ends, the input is reset to <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq81.gif"/></alternatives></inline-formula> or <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">low</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{low}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq82.gif"/></alternatives></inline-formula> for the next event and the steps are repeated. Once all events are completed, the loss value is calculated for the epoch and the weights are updated. The same procedure is repeated for the next remaining epochs.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>The flow chart summarizing the entire model development procedure to model EWH dynamics without water temperature data</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig3_HTML.png" id="MO16"/></fig><fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>The schematic representation of the procedure to use the trained model to simulate EWH over a certain period</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig4_HTML.png" id="MO17"/></fig></p><p id="Par66">The flow chart summarizing the entire model development is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Once the NN is trained to reduce total custom loss function, ON- and OFF-dynamics models can be used recursively to predict the water temperature and power consumption can be inferred from the <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{prd}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq83.gif"/></alternatives></inline-formula> for the future events. The schematic representation of the procedure to use the trained model is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The model requires an initial point for starting the prediction. If the initial point is the beginning of the ON-event, it will continue to use the ON-dynamics model until <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{prd}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq84.gif"/></alternatives></inline-formula> reaches <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq85.gif"/></alternatives></inline-formula>, after which it switches to the OFF-dynamics model. This continues till the end of the simulation period.</p></sec></sec><sec id="Sec14"><title>Results and discussion</title><p id="Par67">The proposed approach was tested using real-world power consumption data for an EWH available from the open-source data set Pecan Street Dataport (Dataport <xref ref-type="bibr" rid="CR4">2022</xref>). The frequency of power measurements is 1 min. An EWH was chosen randomly and was assumed to have a single heating element and uniform water tank temperature. The predicted temperature profiles were compared with temperature profiles estimated by single-zone DEM as true temperature data is unavailable in the data set. The presented discussions are still relevant as the goal is to demonstrate that PINN can replace DEM methods and can have similar performance.</p><p id="Par68">Max<inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">off</mml:mi></mml:msub></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{off}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq86.gif"/></alternatives></inline-formula> and MIN<inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">on</mml:mi></mml:msub></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{on}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq87.gif"/></alternatives></inline-formula> were obtained from power consumption data and the parameters were estimated. The estimated parameters were used in the loss function L<inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msub><mml:mrow/><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq88.gif"/></alternatives></inline-formula>. The obtained values are presented in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>The estimated parameters for single-zone DEM and the maximum and minimum duration of OFF and ON events found in the dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p><bold>Parameter</bold></p></th><th align="left"><p><bold>C</bold></p></th><th align="left"><p><bold>G</bold></p></th><th align="left"><p>Max<inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">off</mml:mi></mml:msub></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{off}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq89.gif"/></alternatives></inline-formula></p></th><th align="left"><p>Min<inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">on</mml:mi></mml:msub></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{on}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq90.gif"/></alternatives></inline-formula></p></th></tr></thead><tbody><tr><td align="left"><p>Value</p></td><td align="left"><p>1,167,000 (Ws/<inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq91.gif"/></alternatives></inline-formula>C)</p></td><td align="left"><p>2.05 (W/<inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq92.gif"/></alternatives></inline-formula>C)</p></td><td align="left"><p>959 min</p></td><td align="left"><p>21 min</p></td></tr></tbody></table></table-wrap></p><p id="Par69">50 random events each for ON- and OFF-dynamics model were selected. The duration of events were obtained from power consumption data and the average water demand for selected events were estimated using the duration and estimated parameters. The duration and water demand of selected events are presented in Figs. <xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref>. The selected events well reflect the actual distribution of the water demand and the duration of EWH operation. It can be observed from Fig. <xref rid="Fig6" ref-type="fig">6</xref> that water demand is higher during ON events than during OFF events. It is fair to assume that this is due to major activities such as taking showers, washing clothes, etc. This also indicates that temperature will fall quickly during demand response and supports the goal of this work.</p><p id="Par70">The duration and water demand were used to create inputs to the NN. The models were built in Python using the Keras library and Adam optimizer was used for training. The proposed approach is generic and applies to any EWH with power consumption data.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>EWH operation duration during ON and OFF events found in the training dataset</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig5_HTML.png" id="MO18"/></fig><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Estimated average water demand for OFF and ON events found in the training data set</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig6_HTML.png" id="MO19"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Prediction performance of trained OFF-dynamics PINN model for the training dataset compared to DEM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Metric</p></th><th align="left"><p>MSE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAE</p></th></tr></thead><tbody><tr><td align="left"><p>Value (<inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq93.gif"/></alternatives></inline-formula>C)</p></td><td align="left"><p>0.13</p></td><td align="left"><p>0.36</p></td><td align="left"><p>0.15</p></td></tr></tbody></table></table-wrap></p><p id="Par71">The models were trained and their performance for the training dataset was analyzed first. Different error metrics were calculated and presented in Table <xref rid="Tab2" ref-type="table">2</xref> and Table <xref rid="Tab3" ref-type="table">3</xref> for both models. For the OFF-dynamics model, the mean absolute error (MAE) for training dataset shows that PINN predictions differ on average only by 0.15 <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq94.gif"/></alternatives></inline-formula>C from DEM predictions. OFF-dynamics model predictions for three different events with different water demands are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. It shows that PINN predictions are similar to DEM predictions. However, event-1 predictions seem to be inaccurate compared to events 2 and 3. This can be explained by the fact that water demand is very high for event 1 and high water demand is not well represented in the OFF-training dataset as can be seen in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. This shows the importance of having an evenly distributed dataset for training.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Prediction performance of trained ON-dynamics PINN model for the training dataset compared to DEM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Metric</p></th><th align="left"><p>MSE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAE</p></th></tr></thead><tbody><tr><td align="left"><p>Value (<inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq95.gif"/></alternatives></inline-formula>C)</p></td><td align="left"><p>0.37</p></td><td align="left"><p>0.61</p></td><td align="left"><p>0.25</p></td></tr></tbody></table></table-wrap></p><p id="Par72"><fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>OFF-dynamics model predictions for three different OFF-events with different water demands compared with DEM predictions</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig7_HTML.png" id="MO20"/></fig><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>ON-dynamics model predictions for three different ON-events with different water demands compared with DEM predictions</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig8_HTML.png" id="MO21"/></fig></p><p id="Par73">Similarly, predictions for three different ON events with different water demands by the ON-dynamics model are shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. It can also be seen in Table <xref rid="Tab3" ref-type="table">3</xref> that the error is higher (MAE = 0.25 <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq96.gif"/></alternatives></inline-formula>C) for ON-dynamics model compared to the OFF-dynamics model. However, in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, the predictions for events 1 and 2 appear almost accurate. The inaccurate prediction for events with very high water demand like event-3 is the reason for high error in ON-dynamics model predictions. This can again be explained by the non-uniform distribution of water demands in the ON-training dataset and can be seen in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>OFF dynamics model performance outside thermostat control region</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig9_HTML.png" id="MO22"/></fig><fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>ON dynamics model performance outside thermostat control region</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig10_HTML.png" id="MO23"/></fig></p><p id="Par74">In general, performance analysis for individual events from the training dataset indicates that the proposed model is capable of modeling the thermal dynamics of EWH between control set-points fairly accurately. However, during Demand response (DR), EWH operates outside control set-point temperatures. Thus it is important to assess the model’s performance outside the thermostat control range. It was assumed that there was no thermostat-based control and the evolution of the temperature profile predicted by PINN was examined for the case when EWH was not turned ON/OFF when it reaches T<inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">lo</mml:mi></mml:msub></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{lo}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq97.gif"/></alternatives></inline-formula>/T<inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:msub><mml:mrow/><mml:mi mathvariant="normal">hi</mml:mi></mml:msub></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_\mathrm{{hi}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq98.gif"/></alternatives></inline-formula>. The results were compared with the temperature profile provided by DEM and are shown in Figs. <xref rid="Fig9" ref-type="fig">9</xref> and <xref rid="Fig10" ref-type="fig">10</xref>. It can be seen that PINN is able to capture the non-linear temperature evolution for both ON and OFF events without thermostat control. This shows that the proposed model can be used for flexibility modeling of EWH for load shifting during a DR event.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Scenario-1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Event</p></th><th align="left"><p>1</p></th><th align="left"><p>2</p></th><th align="left"><p>3</p></th><th align="left"><p>4</p></th><th align="left"><p>5</p></th><th align="left"><p>6</p></th></tr></thead><tbody><tr><td align="left"><p>Operation</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td></tr><tr><td align="left"><p>Water demand (L/min)</p></td><td align="left"><p>0.60</p></td><td align="left"><p>0.13</p></td><td align="left"><p>0.33</p></td><td align="left"><p>0.3</p></td><td align="left"><p>0.76</p></td><td align="left"><p>0.42</p></td></tr></tbody></table></table-wrap></p><p id="Par75"><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>The temperatures predicted by the PINN for the scenario-1 compared to DEM predictions</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig11_HTML.png" id="MO24"/></fig><fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>The temperatures predicted by the PINN for the scenario-2 compared to DEM predictions</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig12_HTML.png" id="MO25"/></fig></p><p id="Par76">The combined performance of OFF-dynamics and ON-dynamics models in simulating EWH for future events is evaluated through two constructed scenarios. Scenario 1 consists of three ON and OFF events each. Scenario 2 consists of five ON and OFF events each. Water demands during events for scenarios 1 and 2 are presented in Tables <xref rid="Tab4" ref-type="table">4</xref> and <xref rid="Tab5" ref-type="table">5</xref>. Water demands were carefully selected to be different from the data present in the training dataset. Since PINN is based on a single-zone DEM model, the same is used for comparison purposes. The temperature predicted by PINN and DEM models for both scenarios are presented in Figs. <xref rid="Fig11" ref-type="fig">11</xref> and <xref rid="Fig12" ref-type="fig">12</xref>. The plots show that for both scenarios, temperature predicted by PINN is fairly similar to the temperature predicted by DEM at least in the first few events. A lag in PINN predictions compared to DEM predictions can be observed in the later stages of the scenarios. This is due to the effect of error propagation from initial stages occurring in recursive prediction strategy and is a very well-known phenomenon.<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Scenario-2</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Event</p></th><th align="left"><p>1</p></th><th align="left"><p>2</p></th><th align="left"><p>3</p></th><th align="left"><p>4</p></th><th align="left"><p>5</p></th><th align="left"><p>6</p></th><th align="left"><p>7</p></th><th align="left"><p>8</p></th><th align="left"><p>9</p></th><th align="left"><p>10</p></th></tr></thead><tbody><tr><td align="left"><p>Operation</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td><td align="left"><p>ON</p></td><td align="left"><p>OFF</p></td></tr><tr><td align="left"><p>Water demand (L/min)</p></td><td align="left"><p>0.48</p></td><td align="left"><p>0.18</p></td><td align="left"><p>0.66</p></td><td align="left"><p>0.27</p></td><td align="left"><p>0.58</p></td><td align="left"><p>0.45</p></td><td align="left"><p>0.76</p></td><td align="left"><p>0.13</p></td><td align="left"><p>0.39</p></td><td align="left"><p>0.3</p></td></tr></tbody></table></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>Simulation performance of PINN for different scenarios compared to DEM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>-</p></th><th align="left"><p>Metric</p></th><th align="left"><p>MSE</p></th><th align="left"><p>RMSE</p></th><th align="left"><p>MAE</p></th></tr></thead><tbody><tr><td align="left"><p>Scenario-1</p></td><td align="left"><p>Value (<inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq99.gif"/></alternatives></inline-formula>C)</p></td><td char="." align="char"><p>0.11</p></td><td char="." align="char"><p>0.33</p></td><td char="." align="char"><p>0.22</p></td></tr><tr><td align="left"><p>Scenario-2</p></td><td align="left"><p>Value (<inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq100.gif"/></alternatives></inline-formula>C)</p></td><td char="." align="char"><p>0.44</p></td><td char="." align="char"><p>0.66</p></td><td char="." align="char"><p>0.47</p></td></tr></tbody></table></table-wrap></p><p id="Par77"><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>The power inferred from the predicted temperatures from PINN for the scenario-1 compared to actual power consumption</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig13_HTML.png" id="MO26"/></fig><fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>The power inferred from the predicted temperatures from PINN for the scenario-2 compared to actual power consumption</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/42162_2022_233_Fig14_HTML.png" id="MO27"/></fig></p><p id="Par78">Different error metrics were calculated for both scenarios to compare the performance of PINN with DEM and are shown in Table <xref rid="Tab6" ref-type="table">6</xref>. The MAE for scenario-1 with the simulated duration of almost 7.5 h shows that PINN predictions can differ on average only by 0.22 <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq101.gif"/></alternatives></inline-formula>C from DEM predictions. For scenario-2 with the simulated duration of almost 12 h, MAE is 0.47 <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq102.gif"/></alternatives></inline-formula>C. This clearly shows the impact of error propagation from initial stages. Also, mean error metrics can be misleading as they can not explain the impact of the propagated error. Though the error values are small, the plots show that the error for a single point will be large when the time step is further from zero. This would cause the entire event to lag by large time-steps if not corrected. This is not desirable for DR programs as the aggregator would have to pay a huge penalty for not fulfilling contractual obligations in terms of flexibility delivered or user comfort. However, the more accurate predictions for the first few events in initial stages is promising since aggregator participating in DR programs usually requires shorter simulation periods.<table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Performance of PINN in predicting EWH operational states compared with actual states</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Metric</p></th><th align="left"><p>Precision</p></th><th align="left"><p>Recall</p></th><th align="left"><p>F1-score</p></th></tr></thead><tbody><tr><td align="left"><p>Scenario-1</p></td><td char="." align="char"><p>0.95</p></td><td char="." align="char"><p>0.92</p></td><td char="." align="char"><p>0.93</p></td></tr><tr><td align="left"><p>Scenario-2</p></td><td char="." align="char"><p>0.85</p></td><td char="." align="char"><p>0.82</p></td><td char="." align="char"><p>0.83</p></td></tr></tbody></table></table-wrap></p><p id="Par79">Power consumption for scenarios 1 and 2 can be inferred from predicted temperatures and is presented in Figs. <xref rid="Fig13" ref-type="fig">13</xref> and <xref rid="Fig14" ref-type="fig">14</xref>. The plots show that inferred power consumption using PINN model closely matches the actual power consumption. The lag in output observed for PINN model is due to an error in the time step at which the model switches between the ON- and OFF-dynamics model. This in turn is due to the propagating error from initial stages as explained earlier. Precision, Recall, and F1 scores were calculated based on the correct prediction of EWH ON and OFF states using inferred power consumption data and are presented in Table <xref rid="Tab7" ref-type="table">7</xref>. The results for scenario-1 show that PINN can infer 92% of actual ON states correctly and 95% of total inferred ON states are actual ON states. The performance degrades for scenario-2 as the values are 82% and 85%, respectively. This is expected as scenario-2 is simulated for a longer period.</p><p id="Par80">This analysis emphasizes the impact of propagating error from initial stages on flexibility modeling if not corrected. For example, consider two cases where EWH power consumption data is available after simulation in one case and not available in another case. EWH power consumption data can be used to correct the lag in predicted events simulation since the true power consumption of a simulated event is available after sometime. Non-intrusive load monitoring (NILM) can be used as a correcting strategy for the case where EWH power consumption data is not available after simulation. NILM is a technique to disaggregate individual appliance power consumption from total power consumption from household smart meter measurements (Garcia et al. <xref ref-type="bibr" rid="CR7">2020</xref>; Zufferey et al. <xref ref-type="bibr" rid="CR30">2020</xref>). As aggregators can have access to total consumption through smart meter data, it is possible to infer EWH consumption to a good extent from total power consumption using NILM techniques. An aggregator can compare the NILM output and PINN simulation. The PINN simulation model can be readjusted for the accounted error and EWH can be simulated again. For example, consider an aggregator simulated EWH for the next 24 h. After 12 h, the aggregator can use NILM to infer EWH consumption for the past 12 h from total consumption data. PINN results and NILM results can be compared for these 12hrs and any observed deviation can be noted. The aggregator can then reset PINN simulation for the next 12 h based on NILM results as it can provide the actual time-step of recent event start/end. It should be noted that such approaches are suitable only for short-term decision-making problems.</p><p id="Par81">To summarize, individual event analysis and simulation beyond control set-points indicate that the proposed model learns the physics described in Eq. (<xref rid="Equ2" ref-type="disp-formula">2</xref>) and the trained model has high prediction accuracy for individual events. Average water demand in the training set should be uniformly distributed. The propagating error is of concern for simulating EWH for longer periods using the proposed approach.</p><p id="Par82">The advantages of the proposed approach are:<list list-type="bullet"><list-item><p id="Par83">The proposed approach is generic and can be used for any water heater.</p></list-item><list-item><p id="Par84">Neural network based EWH temperature prediction model can be developed without having actual temperature data.</p></list-item><list-item><p id="Par85">Recursive approach allows previous step temperature as input and thus NN can mimic the differential equation.</p></list-item><list-item><p id="Par86">Can easily be integrated into decision support tools for DR programs. This is mainly because the previous temperature input allows starting point of the simulation from any point in the temperature range of interest. This makes it convenient to simulate DR event without additional steps required.</p></list-item></list>The disadvantages of the proposed approach are:<list list-type="bullet"><list-item><p id="Par87">Temperature stratification effects in the water tank are not captured.</p></list-item><list-item><p id="Par88">The average water demand doesn’t reflect real-world scenarios making the proposed approach slightly less accurate for flexibility modeling. However, the proposed approach can be easily modified to adapt to stochastic water demand input.</p></list-item><list-item><p id="Par89">It is not possible to predict the time-step of interest directly. Recursively moving towards the time-step of interest might not be desirable at sometimes.</p></list-item></list></p></sec><sec id="Sec15"><title>Conclusion and future work</title><p id="Par90">This paper presents a framework for developing PINN based EWH simulation model with only historical power consumption data. The proposed approach is generic and can be applied to any EWH. Training dataset preparation involving thermal parameter estimation and water demand estimation is described. The PINN architecture is structured to mimic DEM and physics-based custom loss functions are designed to facilitate unsupervised learning. A recursive training procedure supporting previous time-step temperature to be modeled as a PINN input is introduced for learning EWH thermal dynamics. Two different models representing EWH ON and OFF states are trained with real-world EWH power consumption data from open-source data set available in Pecan Street Dataport.</p><p id="Par91">The temperature prediction results for individual events show that the proposed approach has comparable performance to traditional single-zone-DEM. The results promise the possibility of employing unsupervised learning for advanced thermal modeling of EWH using PINN. The trained model also showed considerably good results when the EWH was simulated outside the thermostat control range. The proposed model was also used to simulate EWH for two scenarios with different event compositions. The usability of the proposed approach for EWH simulation during a DR event is demonstrated through these two analyses. However, the recursive prediction strategy introduces propagation errors into the prediction results necessitating measures to reduce or correct propagating errors.</p><p id="Par92">This work demonstrates the application of PINN for developing an EWH simulation model based on single-zone DEM. The proposed approach can serve as a stepping stone for building advanced PINN-based thermal dynamics models that could potentially result in less computationally intensive, high accuracy model that can help the aggregator to develop effective control strategies for precisely controlling EWH portfolio without causing user discomfort and rebound effects.</p><p id="Par93">Future work will focus on (1) incorporating EWH stratification effects into PINN and comparing the results with actual temperature measurements, (2) improving loss function and PINN architecture for better performance, (3) evaluating the developed model for EWH flexibility modeling and aggregation and (4) methods to reduce propagation errors.</p></sec></body><back><ack><title>Acknowledgements</title><p>Not applicable.</p></ack><sec sec-type="author-contribution"><title>Author contributions</title><sec><p>SVP was involved in conceiving the idea for applying PINN to EWH modeling, developing the model, generating results and creating the manuscript. JR was involved in conceptualizing the idea, reviewing the approach, results and manuscript. All authors read and approved the final manuscript.</p></sec><sec id="FPar5"><title>About this supplement</title><p id="Par94">This article has been published as part of Energy Informatics Volume 5 Supplement 4, 2022: Proceedings of the Energy Informatics. Academy Conference 2022 (EI.A 2022). The full contents of the supplement are available online at <ext-link xlink:href="https://energyinformatics.springeropen.com/articles/supplements/volume-5-supplement-4" ext-link-type="uri">https://energyinformatics.springeropen.com/articles/supplements/volume-5-supplement-4</ext-link>.</p></sec></sec><sec><title>Funding</title><p>This paper is funded by the authors affiliations.</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>The data used in this work is from open source dataset available in Pecan Street Dataport. The data can be obtained from in <ext-link xlink:href="https://www.pecanstreet.org/dataport/" ext-link-type="uri">https://www.pecanstreet.org/dataport/</ext-link>.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar1"><title>Ethics approval and consent to participate</title><p id="Par95">Not applicable.</p></sec><sec id="FPar2"><title>Consent for publication</title><p id="Par96">Not applicable.</p></sec><sec id="FPar3" sec-type="COI-statement"><title>Competing interests</title><p id="Par97">The authors declare that they have no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><mixed-citation publication-type="other">Ahmed MT, Faria P, Abrishambaf O, Vale Z (2018) Electric water heater modelling for direct load control demand response. In: 2018 IEEE 16th International Conference on Industrial Informatics (INDIN). IEEE; p. 490–495</mixed-citation></ref><ref id="CR2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alvarez</surname><given-names>MAZ</given-names></name><name><surname>Agbossou</surname><given-names>K</given-names></name><name><surname>Cardenas</surname><given-names>A</given-names></name><name><surname>Kelouwani</surname><given-names>S</given-names></name><name><surname>Boulon</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Demand response strategy applied to residential electric water heaters using dynamic programming and K-means clustering</article-title><source>IEEE Trans Sustain Energy.</source><year>2019</year><volume>11</volume><issue>1</issue><fpage>524</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2019.2897288</pub-id></mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="other">Cao J, Dong L, Xue L (2020) Load Scheduling for an Electric Water Heater With Forecasted Price Using Deep Reinforcement Learning. In: 2020 Chinese Automation Congress (CAC). IEEE; p. 2500–2505</mixed-citation></ref><ref id="CR4"><mixed-citation publication-type="other">Dataport (2022). Available from:<ext-link xlink:href="https://www.pecanstreet.org/dataport/about-dataport/" ext-link-type="uri">https://www.pecanstreet.org/dataport/about-dataport/</ext-link>. Accessed 10 Mar 2022</mixed-citation></ref><ref id="CR5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drgoňa</surname><given-names>J</given-names></name><name><surname>Tuor</surname><given-names>AR</given-names></name><name><surname>Chandan</surname><given-names>V</given-names></name><name><surname>Vrabie</surname><given-names>DL</given-names></name></person-group><article-title xml:lang="en">Physics-constrained deep learning of multi-zone building thermal dynamics</article-title><source>Energy Build</source><year>2021</year><volume>243</volume><pub-id pub-id-type="doi">10.1016/j.enbuild.2021.110992</pub-id></mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farooq</surname><given-names>AA</given-names></name><name><surname>Afram</surname><given-names>A</given-names></name><name><surname>Schulz</surname><given-names>N</given-names></name><name><surname>Janabi-Sharifi</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Grey-box modeling of a low pressure electric boiler for domestic hot water system</article-title><source>Appl Therm Eng</source><year>2015</year><volume>84</volume><fpage>257</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1016/j.applthermaleng.2015.03.050</pub-id></mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname><given-names>FD</given-names></name><name><surname>Souza</surname><given-names>WA</given-names></name><name><surname>Diniz</surname><given-names>IS</given-names></name><name><surname>Marafão</surname><given-names>FP</given-names></name></person-group><article-title xml:lang="en">NILM-based approach for energy efficiency assessment of household appliances</article-title><source>Energy Informat</source><year>2020</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>21</lpage></mixed-citation></ref><ref id="CR8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gokhale</surname><given-names>G</given-names></name><name><surname>Claessens</surname><given-names>B</given-names></name><name><surname>Develder</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">Physics informed neural networks for control oriented thermal modeling of buildings</article-title><source>Appl Energy</source><year>2022</year><volume>314</volume><pub-id pub-id-type="doi">10.1016/j.apenergy.2022.118852</pub-id></mixed-citation></ref><ref id="CR9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Jentzen</surname><given-names>AEW</given-names></name></person-group><article-title xml:lang="en">Solving high-dimensional partial differential equations using deep learning</article-title><source>Proc National Acad Sci</source><year>2018</year><volume>115</volume><issue>34</issue><fpage>8505</fpage><lpage>8510</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">3847747</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1718942115</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1416.35137</pub-id></mixed-citation></ref><ref id="CR10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hossain</surname><given-names>MM</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Ardakanian</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">Identifying grey-box thermal models with Bayesian neural networks</article-title><source>Energy Build</source><year>2021</year><volume>238</volume><pub-id pub-id-type="doi">10.1016/j.enbuild.2021.110836</pub-id></mixed-citation></ref><ref id="CR11"><mixed-citation publication-type="other">Huang B, Wang J (2022) Applications of physics-informed neural networks in power systems—a review. IEEE Trans Power Syst</mixed-citation></ref><ref id="CR12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>M</given-names></name><name><surname>Dimkova</surname><given-names>D</given-names></name><name><surname>Hamacher</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Integration of wind and solar power in Europe: assessment of flexibility requirements</article-title><source>Energy</source><year>2014</year><volume>69</volume><fpage>236</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2014.02.109</pub-id></mixed-citation></ref><ref id="CR13"><mixed-citation publication-type="other">Iea (2022) World energy outlook 2019 analysis; 2019. Available from:<ext-link xlink:href="https://www.iea.org/reports/world-energy-outlook-2019" ext-link-type="uri">https://www.iea.org/reports/world-energy-outlook-2019</ext-link>. Accessed 4 Apr 2022</mixed-citation></ref><ref id="CR14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karniadakis</surname><given-names>GE</given-names></name><name><surname>Kevrekidis</surname><given-names>IG</given-names></name><name><surname>Lu</surname><given-names>L</given-names></name><name><surname>Perdikaris</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Physics-informed machine learning</article-title><source>Nat Rev Phys</source><year>2021</year><volume>3</volume><issue>6</issue><fpage>422</fpage><lpage>440</lpage><pub-id pub-id-type="doi">10.1038/s42254-021-00314-5</pub-id></mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kazmi</surname><given-names>H</given-names></name><name><surname>D’Oca</surname><given-names>S</given-names></name><name><surname>Delmastro</surname><given-names>C</given-names></name><name><surname>Lodeweyckx</surname><given-names>S</given-names></name><name><surname>Corgnati</surname><given-names>SP</given-names></name></person-group><article-title xml:lang="en">Generalizable occupant-driven optimization model for domestic hot water production in NZEB</article-title><source>Appl Energy</source><year>2016</year><volume>175</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2016.04.108</pub-id></mixed-citation></ref><ref id="CR16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lakshmanan</surname><given-names>V</given-names></name><name><surname>Sæle</surname><given-names>H</given-names></name><name><surname>Degefa</surname><given-names>MZ</given-names></name></person-group><article-title xml:lang="en">Electric water heater flexibility potential and activation impact in system operator perspective-Norwegian scenario case study</article-title><source>Energy</source><year>2021</year><volume>236</volume><pub-id pub-id-type="doi">10.1016/j.energy.2021.121490</pub-id></mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luzi</surname><given-names>M</given-names></name><name><surname>Mascioli</surname><given-names>FMF</given-names></name><name><surname>Paschero</surname><given-names>M</given-names></name><name><surname>Rizzi</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A white-box equivalent neural network circuit model for SoC estimation of electrochemical cells</article-title><source>IEEE Trans Neural Netw Learn Syst</source><year>2019</year><volume>31</volume><issue>2</issue><fpage>371</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1109/TNNLS.2019.2901062</pub-id></mixed-citation></ref><ref id="CR18"><mixed-citation publication-type="other">Nehrir MH, Jia R, Pierre DA, Hammerstrom DJ (2007) Power management of aggregate electric water heater loads by voltage control. In: 2007 IEEE Power Engineering Society General Meeting. IEEE :1–6</mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nel</surname><given-names>P</given-names></name><name><surname>Booysen</surname><given-names>MJ</given-names></name><name><surname>van der Merwe</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">A computationally inexpensive energy model for horizontal electric water heaters with scheduling</article-title><source>IEEE Trans Smart Grid</source><year>2016</year><volume>9</volume><issue>1</issue><fpage>48</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1109/TSG.2016.2544882</pub-id></mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paull</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Chang</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">A novel domestic electric water heater model for a multi-objective demand side management program</article-title><source>Electric Power Syst Res</source><year>2010</year><volume>80</volume><issue>12</issue><fpage>1446</fpage><lpage>1451</lpage><pub-id pub-id-type="doi">10.1016/j.epsr.2010.06.013</pub-id></mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="other">Rackauckas C, Ma Y, Martensen J, Warner C, Zubov K, Supekar R et al. (2020) Universal differential equations for scientific machine learning. arXiv preprint <ext-link xlink:href="http://arxiv.org/abs/2001.04385" ext-link-type="uri">arXiv:2001.04385</ext-link></mixed-citation></ref><ref id="CR22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruelens</surname><given-names>F</given-names></name><name><surname>Claessens</surname><given-names>BJ</given-names></name><name><surname>Quaiyum</surname><given-names>S</given-names></name><name><surname>De Schutter</surname><given-names>B</given-names></name><name><surname>Babuška</surname><given-names>R</given-names></name><name><surname>Belmans</surname><given-names>R</given-names></name></person-group><article-title xml:lang="en">Reinforcement learning applied to an electric water heater: from theory to practice</article-title><source>IEEE Trans Smart Grid</source><year>2016</year><volume>9</volume><issue>4</issue><fpage>3792</fpage><lpage>3800</lpage><pub-id pub-id-type="doi">10.1109/TSG.2016.2640184</pub-id></mixed-citation></ref><ref id="CR23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shad</surname><given-names>M</given-names></name><name><surname>Momeni</surname><given-names>A</given-names></name><name><surname>Errouissi</surname><given-names>R</given-names></name><name><surname>Diduch</surname><given-names>CP</given-names></name><name><surname>Kaye</surname><given-names>ME</given-names></name><name><surname>Chang</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Identification and estimation for electric water heaters in direct load control programs</article-title><source>IEEE Trans Smart Grid</source><year>2015</year><volume>8</volume><issue>2</issue><fpage>947</fpage><lpage>955</lpage></mixed-citation></ref><ref id="CR24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Söder</surname><given-names>L</given-names></name><name><surname>Lund</surname><given-names>PD</given-names></name><name><surname>Koduvere</surname><given-names>H</given-names></name><name><surname>Bolkesjø</surname><given-names>TF</given-names></name><name><surname>Rossebø</surname><given-names>GH</given-names></name><name><surname>Rosenlund-Soysal</surname><given-names>E</given-names></name><etal/></person-group><article-title xml:lang="en">A review of demand side flexibility potential in Northern Europe</article-title><source>Renewable Sustain Energy Rev</source><year>2018</year><volume>91</volume><fpage>654</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2018.03.104</pub-id></mixed-citation></ref><ref id="CR25"><mixed-citation publication-type="other">Value of flexibility from electrical storage water heaters (2022) Norges vassdrags- og energidirektorat; 2021. Available from:<ext-link xlink:href="https://publikasjoner.nve.no/eksternrapport/2021/eksternrapport2021_05.pdf" ext-link-type="uri">https://publikasjoner.nve.no/eksternrapport/2021/eksternrapport2021_05.pdf</ext-link>. Accessed 15 Apr 2022</mixed-citation></ref><ref id="CR26"><mixed-citation publication-type="other">Vrettos E, Koch S, Andersson G (2012) Load frequency control by aggregations of thermally stratified electric water heaters. In: 2012 3rd IEEE PES Innovative Smart Grid Technologies Europe (ISGT Europe). IEEE:1–8</mixed-citation></ref><ref id="CR27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>S</given-names></name><name><surname>Chang</surname><given-names>L</given-names></name><name><surname>Cao</surname><given-names>B</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name></person-group><article-title xml:lang="en">A novel domestic electric water heater control method</article-title><source>IEEE Trans Smart Grid</source><year>2019</year><volume>11</volume><issue>4</issue><fpage>3246</fpage><lpage>3256</lpage><pub-id pub-id-type="doi">10.1109/TSG.2019.2961214</pub-id></mixed-citation></ref><ref id="CR28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Z</given-names></name><name><surname>Diao</surname><given-names>R</given-names></name><name><surname>Lu</surname><given-names>S</given-names></name><name><surname>Lian</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Modeling of electric water heaters for demand response: a baseline PDE model</article-title><source>IEEE Trans Smart Grid</source><year>2014</year><volume>5</volume><issue>5</issue><fpage>2203</fpage><lpage>2210</lpage><pub-id pub-id-type="doi">10.1109/TSG.2014.2317149</pub-id></mixed-citation></ref><ref id="CR29"><mixed-citation publication-type="other">Zhongming Z, Linong L, Xiaona Y, Wangqiang Z, Wei L et al (2017) A world in transformation: World Energy Outlook 2017</mixed-citation></ref><ref id="CR30"><mixed-citation publication-type="other">Zufferey T, Valverde G, Hug G (2020) Unsupervised disaggregation of water heater load from smart meter data processing. In: The 12th Mediterranean Conference on Power Generation, Transmission, Distribution and Energy Conversion (MEDPOWER 2020). vol. 2020; p. 283–288</mixed-citation></ref><ref id="CR31"><mixed-citation publication-type="other">Zuñiga M, Agbossou K, Cardenas A, Boulon L (2017) Parameter estimation of electric water heater models using extended kalman filter. In: IECON 2017-43rd Annual Conference of the IEEE Industrial Electronics Society. IEEE; p. 386–391</mixed-citation></ref></ref-list></ref-list><glossary><glossary id="AGS1"><title>Abbreviations</title><def-list><def-item><term>EWH</term><def><p id="Par2">Electric water heater</p></def></def-item><def-item><term>PINN</term><def><p id="Par3">Physics inspired neural network</p></def></def-item><def-item><term>DSF</term><def><p id="Par4">Demand side flexibility</p></def></def-item><def-item><term>DR</term><def><p id="Par5">Demand response</p></def></def-item><def-item><term>NN</term><def><p id="Par6">Neural network</p></def></def-item><def-item><term>DEM</term><def><p id="Par7">Differential equation model</p></def></def-item><def-item><term>SML</term><def><p id="Par8">Scientific machine learning</p></def></def-item><def-item><term>ODE</term><def><p id="Par9">Ordinary differential equation</p></def></def-item><def-item><term>MAE</term><def><p id="Par10">Mean absolute error</p></def></def-item><def-item><term>RMSE</term><def><p id="Par11">Root mean squared error</p></def></def-item><def-item><term>MSE</term><def><p id="Par12">Mean squared error</p></def></def-item><def-item><term>NILM</term><def><p id="Par13">Non-intrusive load monitoring</p></def></def-item></def-list></glossary><glossary id="AGS2"><title>Nomenclature</title><def-list><def-item><term><italic>t</italic></term><def><p id="Par14">Time step of an event [min]</p></def></def-item><def-item><term><italic>T</italic>(<italic>t</italic>)</term><def><p id="Par15">Water temperature at time t [<inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq103.gif"/></alternatives></inline-formula>C]</p></def></def-item><def-item><term><inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">amb</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{amb}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq104.gif"/></alternatives></inline-formula></term><def><p id="Par16">Ambient temperature [<inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq105.gif"/></alternatives></inline-formula>C]</p></def></def-item><def-item><term><inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{in}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq106.gif"/></alternatives></inline-formula></term><def><p id="Par17">Inlet water temperature [<inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq107.gif"/></alternatives></inline-formula>C]</p></def></def-item><def-item><term><inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{lo}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq108.gif"/></alternatives></inline-formula></term><def><p id="Par18">Thermostat lower set-point temperature [<inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq109.gif"/></alternatives></inline-formula>]</p></def></def-item><def-item><term><inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hi}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq110.gif"/></alternatives></inline-formula></term><def><p id="Par19">Thermostat higher set-point temperature [<inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq111.gif"/></alternatives></inline-formula>]</p></def></def-item><def-item><term><italic>Q</italic>(<italic>t</italic>)</term><def><p id="Par20">Power consumption [W]</p></def></def-item><def-item><term><inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{T}} (t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq112.gif"/></alternatives></inline-formula></term><def><p id="Par21">Rate of change of temperature [<inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq113.gif"/></alternatives></inline-formula>]</p></def></def-item><def-item><term><inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_d(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq114.gif"/></alternatives></inline-formula></term><def><p id="Par22">Hot water demand [L/min]</p></def></def-item><def-item><term><inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">prd</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{prd}(t)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq115.gif"/></alternatives></inline-formula></term><def><p id="Par23">Predicted water temperature [<inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq116.gif"/></alternatives></inline-formula>]</p></def></def-item><def-item><term><inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">st</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{st}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq117.gif"/></alternatives></inline-formula></term><def><p id="Par24">Water temperature at the start of an event [<inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq118.gif"/></alternatives></inline-formula>]</p></def></def-item><def-item><term><inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">end</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{end}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq119.gif"/></alternatives></inline-formula></term><def><p id="Par25">Water temperature at the end of an event [<inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq120.gif"/></alternatives></inline-formula>C]</p></def></def-item><def-item><term><inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">spd</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{spd}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq121.gif"/></alternatives></inline-formula></term><def><p id="Par26">Temperature difference between control set-points [<inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="42162_2022_233_Article_IEq122.gif"/></alternatives></inline-formula>C]</p></def></def-item></def-list></glossary></glossary><notes notes-type="Misc"><title>Publisher’s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Computer Science</facet-value><facet-value count="1">Information Systems and Communication Service</facet-value></facet><facet name="keyword"><facet-value count="1">Electric water heater</facet-value><facet-value count="1">Flexibility modeling</facet-value><facet-value count="1">Physics-informed neural networks</facet-value><facet-value count="1">Recursive training</facet-value><facet-value count="1">Temperature prediction</facet-value></facet><facet name="pub"><facet-value count="1">Energy Informatics</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">Norway</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
