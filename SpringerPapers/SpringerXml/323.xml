<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s10825-018-1171-3</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">10825</journal-id><journal-id journal-id-type="doi">10.1007/10825.1572-8137</journal-id><journal-title-group><journal-title>Journal of Computational Electronics</journal-title><abbrev-journal-title abbrev-type="publisher">J Comput Electron</abbrev-journal-title></journal-title-group><issn pub-type="ppub">1569-8025</issn><issn pub-type="epub">1572-8137</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s10825-018-1171-3</article-id><article-id pub-id-type="manuscript">1171</article-id><article-id pub-id-type="doi">10.1007/s10825-018-1171-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Solcore: a multi-scale, Python-based library for modelling solar cells and semiconductor materials</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0060-9495</contrib-id><name><surname>Alonso-Álvarez</surname><given-names>D.</given-names></name><address><email>d.alonso-alvarez@imperial.ac.uk</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs1082501811713_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1049-5222</contrib-id><name><surname>Wilson</surname><given-names>T.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9082-9506</contrib-id><name><surname>Pearce</surname><given-names>P.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Führer</surname><given-names>M.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Farrell</surname><given-names>D.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au6"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1875-9739</contrib-id><name><surname>Ekins-Daukes</surname><given-names>N.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2113 8111</institution-id><institution-id institution-id-type="GRID">grid.7445.2</institution-id><institution content-type="org-division">Department of Physics</institution><institution content-type="org-name">Imperial College London</institution></institution-wrap><addr-line content-type="city">London</addr-line><country country="GB">UK</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution content-type="org-division">School of Photovoltaic and Renewable Energy Engineering</institution><institution content-type="org-name">University of New South Wales</institution></institution-wrap><addr-line content-type="city">Sydney</addr-line><country country="AU">Australia</country></aff></contrib-group><author-notes><corresp id="IDs1082501811713_cor1"><label>a</label><email>d.alonso-alvarez@imperial.ac.uk</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>12</day><month>4</month><year>2018</year></pub-date><pub-date date-type="pub" publication-format="print"><month>9</month><year>2018</year></pub-date><volume>17</volume><issue seq="24">3</issue><fpage>1099</fpage><lpage>1123</lpage><history><date date-type="registration"><day>2</day><month>4</month><year>2018</year></date><date date-type="online"><day>12</day><month>4</month><year>2018</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2018</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Computational models can provide significant insight into the operation mechanisms and deficiencies of photovoltaic solar cells. Solcore is a modular set of computational tools, written in Python 3, for the design and simulation of photovoltaic solar cells. Calculations can be performed on ideal, thermodynamic limiting behaviour, through to fitting experimentally accessible parameters such as dark and light IV curves and luminescence. Uniquely, it combines a complete semiconductor solver capable of modelling the optical and electrical properties of a wide range of solar cells, from quantum well devices to multi-junction solar cells. The model is a multi-scale simulation accounting for nanoscale phenomena such as the quantum confinement effects of semiconductor nanostructures, to micron level propagation of light through to the overall performance of solar arrays, including the modelling of the spectral irradiance based on atmospheric conditions. In this article, we summarize the capabilities in addition to providing the physical insight and mathematical formulation behind the software with the purpose of serving as both a research and teaching tool.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Solar cell modelling</kwd><kwd>Quantum solvers</kwd><kwd>Semiconductor properties</kwd><kwd>Solar irradiance</kwd><kwd>Optical modelling</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Imperial College London</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>51</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>Springer Science+Business Media, LLC, part of Springer Nature</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>2</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/10825_2018_Article_1171.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/10825_2018_1171_TEX.zip</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>TEX</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>8</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>24</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2018</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>8</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>24</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mathematical and Computational Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Electrical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Theoretical, Mathematical and Computational Physics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Optical and Electronic Materials</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Mechanical Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta><notes notes-type="ESMHint"><title>Electronic supplementary material</title><p>The online version of this article (<ext-link xlink:href="10.1007/s10825-018-1171-3" ext-link-type="doi">https://doi.org/10.1007/s10825-018-1171-3</ext-link>) contains supplementary material, which is available to authorized users.</p></notes></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Computer-aided design and device models are valuable tools when developing and evaluating photovoltaic solar cells. Laboratory scale tests can be usefully compared against detailed models that account for all relevant processes or with ideal, thermodynamically limited behaviour. Over the years, and with different degrees of sophistication, many pieces of software have been developed and published to tackle different aspects of solar energy research. For example, to calculate the solar spectrum as a function of the atmospheric conditions a traditional solution is to use SMARTS [<xref ref-type="bibr" rid="CR1">1</xref>]; the light absorption profile in the solar cell or even at module level could be addressed by OPTOS [<xref ref-type="bibr" rid="CR2">2</xref>] or OPAL2 [<xref ref-type="bibr" rid="CR3">3</xref>]; while to solve the transport equations of a solar cell one could use PC1D [<xref ref-type="bibr" rid="CR4">4</xref>], SCAPS [<xref ref-type="bibr" rid="CR5">5</xref>] or Quokka [<xref ref-type="bibr" rid="CR6">6</xref>]. Several free and commercial programs, not specifically designed for solar energy research, have also been used historically, including AFORS-HET [<xref ref-type="bibr" rid="CR7">7</xref>], Nextnano [<xref ref-type="bibr" rid="CR8">8</xref>], ATLAS [<xref ref-type="bibr" rid="CR9">9</xref>] or SENTAURUS [<xref ref-type="bibr" rid="CR10">10</xref>], with the first two focused on the device and semiconductor properties and the latter two also solving the optics of the solar cells, among other properties. An extensive list of software for solar energy research—both online calculators and downloadable programs—has been compiled by PV Lighthouse [<xref ref-type="bibr" rid="CR11">11</xref>]. In general, programs like ATLAS and SENTAURUS provide a general purpose, easy to use interface—often solving multi-physics problems, such as electrical transport coupled with thermal transport—to the detriment of performance. On the contrary, specific programs like AFORS-HET or PC1D are extremely fast and efficient, but limited in the problems they can solve, in this case 1D heterostructures and solar cells.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>General structure and workflow of Solcore</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig1_HTML.gif" id="MO100"/></fig></p><p id="Par3">Apart from a few exceptions, such as PVlib [<xref ref-type="bibr" rid="CR12">12</xref>], all these solvers are high-level, self-contained applications. While users can provide their own inputs and, in some cases, access the source code of the programs and customize some aspects of them, they are not designed with that purpose in mind.</p><p id="Par4">Solcore is a multi-scale, modular simulation framework for solar energy research, written mostly in Python. Solcore evolved from SOL, a Fortran-based, quantum well solar cell solver developed by Nelson and Connelly [<xref ref-type="bibr" rid="CR13">13</xref>], with the explicit purpose of simplifying its integration in other programs, its expansion with custom routines and algorithms, and being didactic and informative. It is a teaching and learning tool as much as a rigorous research tool. Solcore is also extremely flexible. It integrates several algorithms for the multi-scale modelling of semiconductors and solar cells, allowing a user without access to other methods, but with some experience with Python, to solve many different problems out of the box. On the other hand, most of its functionality can be interfaced with external tools, optimized to solve a specific problem, which are more advanced and accurate or that use an approach not considered in Solcore. The most recent version has been released under the GNU Lesser General Public License (GNU-LGPL) and can be found on GitHub [<xref ref-type="bibr" rid="CR14">14</xref>].</p><p id="Par5">Solcore’s capabilities can be grouped into four categories: materials science (Sect. <xref rid="Sec2" ref-type="sec">2</xref>), light sources (Sect. <xref rid="Sec10" ref-type="sec">3</xref>), solar cells (Sects. <xref rid="Sec11" ref-type="sec">4</xref>–<xref rid="Sec23" ref-type="sec">6</xref>) and large-scale calculators (Sect. <xref rid="Sec28" ref-type="sec">7</xref>), each of them tackling a different area and scale relevant for research in solar energy. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows how these parts relate to each other and summarizes some of their content.</p></sec><sec id="Sec2"><title>Materials science</title><p id="Par6">The materials science modules in Solcore deal with the retrieval and calculation of material properties as well as those of quantum nanostructures, in particular quantum wells. They form the building blocks necessary to create the structures and calculate the performance of full solar cell devices. While focused on its application for solar cells, this part of Solcore is widely applicable to any research area related to semiconductor materials, as a way of managing the material properties, customizing them and using them in other calculations.</p><p id="Par7">It should be noted that, in reality, electronic and optical properties are not independent but related to each other via the material band structure. As the case in most programs, Solcore uses a non-consistent approach, with independent electronic and optical parameters obtained from different sources. The reader should consider full band structure methods, like pseudopotential or tight-binding, for a consistent set of electronic and optical properties.</p><sec id="Sec3"><title>Parameters database</title><p id="Par8">The parameters database contains the basic properties of many semiconductor materials, including silicon, germanium and many III–V semiconductor binary and ternary alloys. Among other parameters, it includes the energy bandgap, the electron and hole effective masses, the lattice constants and the elastic constants.</p><p id="Par9">The main sources of data are the article by Vurgaftman on <italic>Band parameters for III–V semiconductors</italic> [<xref ref-type="bibr" rid="CR15">15</xref>] and the <italic>Handbook Series on Semiconductor Parameters</italic> by Levinshtein et al. [<xref ref-type="bibr" rid="CR16">16</xref>]. The carrier mobility calculator is based on the empirical low-field mobility model by Sotoodeh et al. [<xref ref-type="bibr" rid="CR17">17</xref>], and it is available only for some materials where the inputs for the model are available.</p><p id="Par10">There are two methods for retrieving parameters from the database. The first one consists simply of getting the data using the get_parameter function with the required inputs. For example:<fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figa_HTML.gif" position="anchor" id="MO2"/></fig></p><p id="Par11">will return the bandgap of GaAsP for a phosphorus concentration of 45% at a temperature of 300 K, equal to 1.988 eV. This method only uses the existing data. Another method is to create a material object which will contain all the properties existing in the database for that material, as well as those included as input, which will override the value of the database parameter, if it exists. The following example creates a GaAs object and an AlGaAs object, using a custom electron effective mass in the latter:<fig id="Figb" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figb_HTML.gif" position="anchor" id="MO3"/></fig></p><p id="Par12">Now, any parameter—including the custom ones—are attributes that can be easily accessed and used anywhere in the program. For example, GaAs.band_gap is the GaAs bandgap and AlGaAs.lattice_constant is the AlGaAs lattice constant, both at the composition and temperature chosen when creating the objects.</p><p id="Par13">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the well-known bandgap versus lattice constant map of all semiconductor materials and alloys (only ternary compounds) currently implemented into Solcore. However, any other material can be used in all of the Solcore functions, as long as the necessary input parameters are provided. This can be done by overriding all the properties of an existing material during the creation as above, or adding it as an external material in the configuration files.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Materials with most parameters included in Solcore’s database (excluding the optical properties)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig2_HTML.gif" id="MO101"/></fig></p></sec><sec id="Sec4"><title>Optical properties database</title><p id="Par14">In order to calculate and model the optical response of potential solar cell architectures and material systems, access to a library of accurate optical constant data is essential. Therefore, Solcore incorporates a resource of freely available optical constant data measured by Sopra S. A. and provided by Software Spectra Inc. [<xref ref-type="bibr" rid="CR18">18</xref>]. The refractive index <italic>n</italic> and extinction coefficient <italic>k</italic> are provided for over 200 materials, including many III–V, II–VI and group IV compounds in addition to a range of common metals, glasses and dielectrics.</p><p id="Par15">Any material within the Sopra S. A. optical constant database can be used with the “material” function described above, but they will have only the optical parameters <italic>n</italic> and <italic>k</italic>. In the case of materials that are in both databases, the keyword “sopra” will need to be set to “True” when creating the material. Once a material is loaded its <italic>n</italic>, <italic>k</italic> and absorption coefficient data are returned by calling the appropriate method, for example SiO2.n(wavelength) and SiO2.k(wavelength). For certain materials in the database, the optical constants are provided for a range of alloy compositions. In these cases, any desired composition within the range can be specified and the interpolated <italic>n</italic> and <italic>k</italic> data are returned. Several examples of materials created from the Sopra database are shown in Listing 1.<fig id="Figc" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figc_HTML.gif" position="anchor" id="MO5"/></fig><fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Example output from the Sopra S. A. optical constant database accessed from Solcore. <bold>a</bold> Refractive index and extinction coefficient data for GaAs (solid lines) and Ge (dashed lines), <bold>b</bold> interpolated AlGaAs extinction coefficient data with aluminium fractions ranging from 10 to 100%</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig3_HTML.gif" id="MO102"/></fig></p><p id="Par16">Figure <xref rid="Fig3" ref-type="fig">3</xref> highlights example output from the Sopra materials library with Fig. <xref rid="Fig3" ref-type="fig">3</xref>a showing GaAs and Ge optical constant data and Fig. <xref rid="Fig3" ref-type="fig">3</xref>b showing interpolated AlGaAs extinction coefficients for a range of aluminium fractions.</p></sec><sec id="Sec5"><title>Quantum solver</title><p id="Par17">The electronic band structure of semiconductor materials is responsible for their light absorption and emission properties as well as for many of their transport properties, ultimately depending on the carriers’ effective masses. These properties are not intrinsic to the material, but depend on external factors, too, most notably the strain and the quantum confinement.</p><p id="Par18">Given the crystalline nature of most semiconductor materials, there will be strain whenever two materials with different crystal lattice constants are grown on top of each other pseudomorphically. Even those with the same lattice constant might be under stress due to other effects such as the presence of impurities or if used at different temperatures having dissimilar thermal expansion coefficients. Quantum confinement, in turn, takes place when the size of the semiconductor material in one or more dimensions is reduced to a few nanometres. In that situation, the energy levels available to the carriers become quantized in the direction of confinement, also changing the density of states. Both conditions take place simultaneously when dealing with strain-balanced quantum wells (QW).</p><p id="Par19">Quantum wells—and more recently quantum wires—have been employed to tune the absorption properties of high efficiency solar cells for the past two decades. The need for appropriate tools to study them in the context of photovoltaics led to the development of the simulation models that were the seed of Solcore [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. As strained materials with quantum confinement, special care must be taken to obtain a sensible set of parameters for the QW structures, including the band edges with confined energy levels, the effective masses and the absorption coefficient.</p><p id="Par20">Solcore’s approach for evaluating the properties of QWs involves calculating first the effect of strain using a 8-band Pikus–Bir Hamiltonian (Sect. <xref rid="Sec6" ref-type="sec">2.3.1</xref>), treating each material in the structure as bulk, and then using the shifted bands and effective masses to solve the 1D Schödinger equation, after a proper alignment between layers (Sect. <xref rid="Sec7" ref-type="sec">2.3.2</xref>) [<xref ref-type="bibr" rid="CR23">23</xref>]. Finally, the absorption coefficient is calculated based on the 2D density of states, including the effect of excitons (Sect. <xref rid="Sec9" ref-type="sec">2.5</xref>).</p><sec id="Sec6"><title>Bulk 8-band k<inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mo>·</mml:mo></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq1.gif"/></alternatives></inline-formula>p calculator</title><p id="Par21">There are many numerical methods to calculate the band structure of a material with a varied degree of sophistication and complexity, such as the tight binding, pseudopotential, Green’s function or <bold>k</bold><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mo>·</mml:mo></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq2.gif"/></alternatives></inline-formula><bold>p</bold> methods. Solcore includes a modified 8-band Pikus–Bir Hamiltonian to calculate the band structure of bulk materials under biaxial strain [<xref ref-type="bibr" rid="CR24">24</xref>], considering the coupling between the conduction, heavy hole, light hole and split-off bands. The eigenfunctions <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi>Ψ</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varPsi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq3.gif"/></alternatives></inline-formula> and eigenstates <italic>E</italic> are the solutions of the following equation, where <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi mathvariant="script">H</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq4.gif"/></alternatives></inline-formula> is the Pikus–Bir Hamiltonian:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mi>Ψ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">cb</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>T</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>U</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mi>U</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">hh</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>S</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mi>R</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">lh</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>Q</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mi>R</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>S</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">so</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>R</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>S</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">cb</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>U</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mi>U</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">hh</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msup><mml:mi>S</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>S</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">lh</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>Q</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">so</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>Ψ</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mi>Ψ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathcal {H}\varPsi = \left( \begin{array}{llllllll} E_{\mathrm{cb}} &amp;{}\quad -\,\sqrt{3}T &amp;{}\quad \sqrt{2}U &amp;{}\quad -\,U &amp;{}\quad 0 &amp;{}\quad 0 &amp;{}\quad -\,T^* &amp;{}\quad -\,\sqrt{2}T^* \\ &amp;{}\quad E_{\mathrm{hh}} &amp;{}\quad \sqrt{2}S &amp;{}\quad -\,S &amp;{}\quad 0 &amp;{}\quad 0 &amp;{}\quad -\,R &amp;{}\quad -\,\sqrt{2}R \\ &amp;{}\quad &amp;{}\quad E_{\mathrm{lh}} &amp;{}\quad -\,\sqrt{2}Q &amp;{}\quad T^* &amp;{}\quad R &amp;{}\quad 0 &amp;{}\quad \sqrt{3}S \\ &amp;{}\quad &amp;{}\quad &amp;{}\quad E_{\mathrm{so}} &amp;{}\quad \sqrt{2}T^* &amp;{}\quad \sqrt{2}R &amp;{}\quad -\,\sqrt{3}S &amp;{}\quad 0 \\ &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad E_{\mathrm{cb}} &amp;{}\quad -\,\sqrt{3}T^* &amp;{}\quad \sqrt{2}U &amp;{}\quad -\,U \\ &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad E_{\mathrm{hh}} &amp;{}\quad \sqrt{2}S^* &amp;{}\quad -\,S^* \\ &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad E_{\mathrm{lh}} &amp;{}\quad -\,\sqrt{2}Q \\ &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad &amp;{}\quad E_{\mathrm{so}} \\ \end{array} \right) \varPsi = E\varPsi \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ1.gif"/></alternatives></disp-formula>Here, the sub-diagonal elements are just the complex conjugate of the corresponding upper elements. Diagonal terms have three components: the information about the unstrained band edges, a kinematic term and a strain term. As an example, the term <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">cb</mml:mi></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\mathrm{cb}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq5.gif"/></alternatives></inline-formula> is given by:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">cb</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>ϵ</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E_{\mathrm{cb}}&amp;= E_{\mathrm{c}0} + O_k + O_{\epsilon } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ2.gif"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>O</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>ħ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>k</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O_k&amp;= \frac{\hbar ^2}{2m_0} \gamma _\mathrm{c} \left( k_x^2 + k_y^2 + k_z^2 \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ3.gif"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>O</mml:mi><mml:mi>ϵ</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">zz</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">zz</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O_{\epsilon }&amp;= a_\mathrm{c} \left( \epsilon _{xx} + \epsilon _{zz} + \epsilon _{zz} \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ4.gif"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{\mathrm{c}0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq6.gif"/></alternatives></inline-formula> is the position of the unstrained conduction band edge, <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq7.gif"/></alternatives></inline-formula> a modified Luttinger parameter, the <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq8.gif"/></alternatives></inline-formula> the momenta in the different directions of the reciprocal space, <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>a</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq9.gif"/></alternatives></inline-formula> the conduction band hydrostatic deformation potential and the <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{ij}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq10.gif"/></alternatives></inline-formula>s the strain tensor components. Off-diagonal terms have similar expressions, not involving the unstrained band edges. A detailed description of all these terms and their origin can be found in Tomic [<xref ref-type="bibr" rid="CR24">24</xref>].</p><p id="Par22">This system is readily solved for the given <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq11.gif"/></alternatives></inline-formula> using Numpy’s linalg.eig function, which provides as output the eigenfunctions and the corresponding eigenvalues. Typically, we are interested in the new band edges due to the effect of strain and the resulting effective masses, given by the curvature of the bands near <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_i = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq12.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows an example of the bands calculated in this way for the case of a strained InGaAs layer grown pseudomorphically on GaAs, and the resulting dependence of the effective mass with the indium content of the layer. Notice that, due to the effect of strain, the heavy and light hole bands are no longer degenerate at the gamma point <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi>Γ</mml:mi></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq13.gif"/></alternatives></inline-formula> (<inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq14.gif"/></alternatives></inline-formula>).<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Band structure of <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mrow><mml:msub><mml:mtext>In</mml:mtext><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mn>0.8</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {In}_{0.2}\hbox {Ga}_{0.8}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq15.gif"/></alternatives></inline-formula>As calculated with the bulk <bold>k</bold><inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mo>·</mml:mo></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq16.gif"/></alternatives></inline-formula><bold>p</bold> solver. The inset shows the effective mass determined for a range of indium fractions and a comparison with the experimental data from Volk et al. [<xref ref-type="bibr" rid="CR25">25</xref>]</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig4_HTML.gif" id="MO103"/></fig></p></sec><sec id="Sec7"><title>1D Schrödinger equation</title><p id="Par23">Once the new band edges and effective masses for each of the materials forming the quantum well structure are known, the quantum properties can be calculated by solving the 1-dimensional Schrödinger’s equation. Solcore uses the method described by Frensley [<xref ref-type="bibr" rid="CR26">26</xref>], which allows calculation of the eigenvalues and eigenvectors of an arbitrary potential. However, only closed and periodic boundary conditions are implemented. Solcore does not incorporate the quantum transmitting boundary method (QTBM) described by Frensley, meaning that unbounded states will be, in general, not correct. A tridiagonal matrix is constructed by writing the variable effective mass Schrödinger’s equation over a series of mesh points. The eigenvalues of the matrix correspond to the allowed energy levels of the system. Thus, the system of equations to solve over the mesh points is given by:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>Ψ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathcal {H}\varPsi _i = -s_i\varPsi _{i-1} + d_i\varPsi _i - s_{i+1}\varPsi _{i+1} = E\varPsi _i \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ5.gif"/></alternatives></disp-formula>where <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq18.gif"/></alternatives></inline-formula> depend on the mesh spacing <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mi>Δ</mml:mi></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq19.gif"/></alternatives></inline-formula> and the position-dependent potential <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq20.gif"/></alternatives></inline-formula> and effective masses <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq21.gif"/></alternatives></inline-formula> as:<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>ħ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>Δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_i&amp;= \frac{\hbar ^2}{4 \varDelta ^2 m_0} \left( \frac{1}{m_{i-1}} + \frac{2}{m_{i-1}} + \frac{1}{m_{i+1}}\right) + V_i \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ6.gif"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>ħ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>Δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s_i&amp;= \frac{\hbar ^2}{4 \varDelta ^2 m_0} \left( \frac{1}{m_{i-1}} + \frac{1}{m_{i-1}} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ7.gif"/></alternatives></disp-formula>This system is solved using the tools available in the Scipy package for solving sparse linear systems of equations, in particular sparse.linalg.eigs.</p><p id="Par24">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows two examples of the band profile and wavefunctions calculated by Solcore. The first one (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b) is a single InGaAs QW with GaAs interlayers and GaAsP barriers. The strain and quantum confinement shift the light hole valence band (dashed line) with respect to the heavy hole valence band (continuous line). In the GaAsP barriers, under tensile strain, this shift is in the opposite direction to the shift inside the QW, which is under compressive strain and experiences the effects of confinement. Figure <xref rid="Fig5" ref-type="fig">5</xref>c, d compares the position of the energy levels predicted by Solcore in this structure with the more rigorous treatment of the 1-dimensional 8-band kp solver implemented by Nextnano<inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mrow><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$++$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq22.gif"/></alternatives></inline-formula>. As shown, the electron energy levels are barely modified, but hole levels are shifted due to the coupling between the bands [<xref ref-type="bibr" rid="CR8">8</xref>]. The in-plane dispersion when using a 8-band solver will no longer be parabolic, and we would expect this to have an impact into the absorption coefficient and especially the selection rules for the transitions due to the band mixing effects (see Sect. <xref rid="Sec9" ref-type="sec">2.5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p><bold>a</bold>, <bold>b</bold> Band profile of a single 7.2 nm-thick <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mrow><mml:msub><mml:mtext>In</mml:mtext><mml:mrow><mml:mn>0.15</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mn>0.85</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {In}_{0.15}\hbox {Ga}_{0.85}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq23.gif"/></alternatives></inline-formula>As QW with 3 nm GaAs interlayers and <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:msub><mml:mtext>GaAs</mml:mtext><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mtext>P</mml:mtext><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {GaAs}_{0.9}\hbox {P}_{0.1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq24.gif"/></alternatives></inline-formula> barriers. <bold>c</bold>, <bold>d</bold> Comparison of the energy levels calculated by Solcore and using the more rigorous 1D 8-band kp solver implemented in Nextnano [<xref ref-type="bibr" rid="CR8">8</xref>]. <bold>e</bold>, <bold>f</bold> 1D-LDOS of a multi-QW structure with 10 coupled QWs, as before but without interlayers</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig5_HTML.gif" id="MO104"/></fig></p><p id="Par25">Finally, Fig. <xref rid="Fig5" ref-type="fig">5</xref>e, f shows 1D the local density of states (LDOS) of a multi-QW structure with thin barriers, including a Lorentzian broadening of 5 meV. For the electrons, there is strong coupling between the QWs, resulting in a range of energies for the ground state. The heavy hole ground states are too deep, resulting in lower coupling between wells. This figure also shows the artefacts in the LDOS of unbound states due to the use of closed boundary conditions rather than QTBM.</p></sec></sec><sec id="Sec8"><title>Critical-point parabolic-band optical constant model</title><p id="Par26">Understanding the optical response of both established and novel materials is crucial to effective solar cell design. To efficiently model the complex dielectric function of a material, Solcore incorporates an optical constant calculator based on the well-known critical-point parabolic-band (CPPB) formalism popularized by Adachi [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>]. In this model, contributions to <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _2(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq25.gif"/></alternatives></inline-formula> from critical points in the Brillouin Zone at which the probability for optical transitions is large (van Hove singularities) are considered. The transition probability for such transitions is proportional to the joint density of states (JDOS) <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mi mathvariant="normal">cv</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf J _{\mathrm{cv}}(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq26.gif"/></alternatives></inline-formula>, which describes the number of available electronic states between the valence and conduction bands at given photon energy. The imaginary part of the complex dielectric function is related to the JDOS by:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>ħ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mfenced close="|" open="|" separators=""><mml:mfenced close="〉" open="〈" separators=""><mml:mi>c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi mathvariant="bold">J</mml:mi><mml:mi mathvariant="normal">cv</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon _2(\omega ) = \frac{4 \hbar ^2 e^2}{\pi \mu _{0}^{2} \omega ^2} \left| \left\langle c | p | v \right\rangle \right| ^2 \mathbf J _{\mathrm{cv}}(\omega ) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ8.gif"/></alternatives></disp-formula>where <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mfenced close="|" open="|" separators=""><mml:mfenced close="〉" open="〈" separators=""><mml:mi>c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| \left\langle c | p | v \right\rangle \right| $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq27.gif"/></alternatives></inline-formula> is the momentum matrix element for transitions from the valence band (<italic>v</italic>) to the conduction band (<italic>c</italic>). Critical point transitions are considered at the following points of symmetry in the band structure: <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq28.gif"/></alternatives></inline-formula> corresponds to the optical transition at the <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mi>Γ</mml:mi></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq29.gif"/></alternatives></inline-formula> point and <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_0 + \varDelta _0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq30.gif"/></alternatives></inline-formula> to the transition from the spin-orbit split off band to the conduction band at the <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>Γ</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq31.gif"/></alternatives></inline-formula> point. <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_1 + \varDelta _1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq33.gif"/></alternatives></inline-formula> denote the transitions from the valence heavy-hole (HH) band and the valence light-hole (LH) band, respectively, to the conduction band at the <italic>L</italic> point. The <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msubsup><mml:mi>E</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq34.gif"/></alternatives></inline-formula> triplet and <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq35.gif"/></alternatives></inline-formula> transitions occur at higher energies, between the HH band and the split conduction bands at the <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mi>Γ</mml:mi></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq36.gif"/></alternatives></inline-formula> point as well as across the wide gap <italic>X</italic> valley. The model also includes contributions from the lowest energy indirect bandgap transition and the exciton absorption at the <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq37.gif"/></alternatives></inline-formula> critical point. The contributions listed above are summed to compute the overall value of <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _2(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq38.gif"/></alternatives></inline-formula>. The real and imaginary components of the overall complex dielectric function <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon (\omega ) = \epsilon _1(\omega ) - i\epsilon _2(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq39.gif"/></alternatives></inline-formula> are then related via the Kramers–Kronig relations;<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon _1(\omega )= &amp; {} 1 + \frac{2}{\pi } \int _{0}^{\infty } \frac{\omega ' \epsilon _2(\omega ')}{(\omega ')^2 - \omega ^2} \mathrm{d}\omega ' \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ9.gif"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>ω</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon _2(\omega )= &amp; {} - \frac{2}{\pi } \int _{0}^{\infty } \frac{\epsilon _1(\omega ')}{(\omega ')^2 - \omega ^2} \mathrm{d}\omega '. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ10.gif"/></alternatives></disp-formula>The CPPB model included with Solcore also incorporates a modification to the critical point broadening present in Adachi’s description, which is shown to produce a poor fit to experimental data in the vicinity of the <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq41.gif"/></alternatives></inline-formula> critical points [<xref ref-type="bibr" rid="CR30">30</xref>]. To give a more accurate description of the broadening of the optical dielectric function, Kim et al. [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] proposed that a frequency-dependent damping parameter be used to replace the damping constant given by Adachi at each critical point;<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>Γ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>Γ</mml:mi><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>ħ</mml:mi><mml:mi>ω</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>Γ</mml:mi></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varGamma '(\omega ) = \varGamma \mathrm{exp} \left[ -\alpha \left( \frac{\hbar \omega - E_0}{\varGamma }\right) ^2 \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ11.gif"/></alternatives></disp-formula>where <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mi>Γ</mml:mi></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq42.gif"/></alternatives></inline-formula> is the damping constant used by Adachi and <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq43.gif"/></alternatives></inline-formula> describes the shape of the lineshape broadening with <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq44.gif"/></alternatives></inline-formula> producing purely Lorentzian character and <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 0.3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq45.gif"/></alternatives></inline-formula> producing a good approximation to Gaussian broadening.</p><p id="Par27">The Solcore module absorption_calculator contains the CPPB model within the Custom_CPPB class. The class offers a flexible way to build up the optical constant model by adding individual critical point contributions through the <italic>Oscillator</italic> structure type within Solcore. In addition to the oscillator functions described by Adachi, the Custom_CPPB class also provides additional oscillator models and the Sellmeier equation for describing the real part of the dielectric function for non-absorbing materials [<xref ref-type="bibr" rid="CR33">33</xref>]. For example, the code in Listing 2 calculates the complex dielectric function of GaAs.<fig id="Figd" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figd_HTML.gif" position="anchor" id="MO20"/></fig><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Output of the CPPB model provided by Solcore fit to existing experimental data for GaAs, from Palik [<xref ref-type="bibr" rid="CR34">34</xref>]</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig6_HTML.gif" id="MO105"/></fig></p><p id="Par28">Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the real and imaginary components of the complex dielectric function of GaAs as calculated by the Custom_CPPB class. The model, using a set of parameters for GaAs similar to those specified in [<xref ref-type="bibr" rid="CR28">28</xref>], shows excellent agreement with the experimental data taken from Palik [<xref ref-type="bibr" rid="CR34">34</xref>]. For a recent demonstration of Solcore’s CPPB model, please refer to the discussion on Wilson et al. [<xref ref-type="bibr" rid="CR35">35</xref>].</p></sec><sec id="Sec9"><title>QW absorption calculator</title><p id="Par29">For modelling the optical properties of QWs, we use the method described by Chuang [<xref ref-type="bibr" rid="CR36">36</xref>]. The absorption coefficient at thermal equilibrium in a QW is given by:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">rmn</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \alpha _0(E)&amp;= C_0(E) \sum _{n,m} |I_{hm}^{en}|^2 | \hat{e} \cdot \mathbf {p} |^2 \rho _{rmn}^{2D} \\&amp;\quad \times \left[ H(E-E^{en} + E_{hm}) + F_{nm}(E) \right] \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ12.gif"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|I_{hm}^{en}|^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq46.gif"/></alternatives></inline-formula> is the overlap integral between the holes in level <italic>m</italic> and the electrons in level <italic>n</italic>; <italic>H</italic> is a step function, <italic>H</italic>(<italic>x</italic>) = 1 for <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x&gt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq47.gif"/></alternatives></inline-formula>, 0 and 0 for <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x&lt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq48.gif"/></alternatives></inline-formula>, <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="italic">rmn</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{rmn}^{2D}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq49.gif"/></alternatives></inline-formula> is the 2D joint density of states, <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq50.gif"/></alternatives></inline-formula> a proportionality constant dependent on the energy, and <italic>F</italic> the excitonic contribution, which will be discussed later.<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ħ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>m</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mi>E</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_0 (E)&amp;= \frac{\pi q^2 \hbar }{n_r c \epsilon _0 m_0^2 E} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ13.gif"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">rmn</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:mi>π</mml:mi><mml:mi>ħ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho _r^{2D}&amp;= \frac{m_{rmn}^*}{\pi \hbar L}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ14.gif"/></alternatives></disp-formula>Here, <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq51.gif"/></alternatives></inline-formula> is the refractive index of the material, <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">rmn</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{rmn} = m_{en} m_{hm} / (m_{en} + m_{hm})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq52.gif"/></alternatives></inline-formula> the reduced, in-plane, effective mass and <italic>L</italic> an effective period of the quantum wells. The in-plane effective mass of each type of carriers is calculated for each level, accounting for the spread of the wavefunction into the barriers as [<xref ref-type="bibr" rid="CR37">37</xref>]:<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mo>⊥</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m_{\perp } = \int _{0}^{L} m(z) | \psi (z) |^2. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ15.gif"/></alternatives></disp-formula>This in-plane effective mass is also used to calculate the local density of states shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b. In Eq. <xref rid="Equ12" ref-type="disp-formula">12</xref>, <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$| \hat{e} \cdot \mathbf {p} |^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq53.gif"/></alternatives></inline-formula> is the momentum matrix element, which depends on the polarization of the light and on the Kane’s energy <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq54.gif"/></alternatives></inline-formula>, specific to each material and determined experimentally. For band edge absorption, where <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq55.gif"/></alternatives></inline-formula>, the matrix elements for the absorption of TE and TM polarized light for the transitions involving the conduction band and the heavy and light holes bands are given in Table <xref rid="Tab1" ref-type="table">1</xref>. As can be deduced from this table, transitions involving heavy holes cannot absorb TM polarized light.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Momentum matrix elements for transitions in QWs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><p>TE</p></th><th align="left"><p>TM</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c-hh$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq56.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>M</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3/2 M_b^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq57.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0</p></td></tr><tr><td align="left"><p><inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c-lh$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq58.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>M</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/2 M_b^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq59.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>M</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 M_b^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq60.gif"/></alternatives></inline-formula></p></td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_b^2=m_0 E_p /6$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq61.gif"/></alternatives></inline-formula> is the bulk matrix element</p></table-wrap-foot></table-wrap></p><p id="Par30">In addition to the band-to-band transitions, QWs usually have strong excitonic absorption, included in Eq. <xref rid="Equ13" ref-type="disp-formula">13</xref> in the term <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{nm}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq62.gif"/></alternatives></inline-formula>. This term is a Lorentzian (or Gaussian) defined by an energy <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_{nmx, j}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq63.gif"/></alternatives></inline-formula> and oscillator strength <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{ex, j}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq64.gif"/></alternatives></inline-formula>. It is zero except for <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>≡</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=n \equiv j$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq65.gif"/></alternatives></inline-formula> where it is given by Klipstein et al. [<xref ref-type="bibr" rid="CR38">38</xref>]:<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F_{nm}&amp;= f_{ex, j} \mathcal {L}(E - E_{nmx, j}, \sigma ) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ16.gif"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">en</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">hm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mi>R</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E_{nmx, j}&amp;= E^{en} - E_{hm} - \frac{R}{(j-\nu )^2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ17.gif"/></alternatives></disp-formula><disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{ex, j}&amp;= \frac{2R}{(j-\nu )^3} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ18.gif"/></alternatives></disp-formula><disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>R</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ħ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R&amp;= \frac{m_r q^4}{2 ( 4\pi \epsilon _r \epsilon _0)^2 \hbar ^2 }. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ19.gif"/></alternatives></disp-formula>Here, <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mi>ν</mml:mi></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq66.gif"/></alternatives></inline-formula> is a constant with a value between 0 and 0.5 and <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mi>σ</mml:mi></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq67.gif"/></alternatives></inline-formula> is the width of the Lorentzian, both often adjusted to fit some experimental data. In Solcore, they have default values of <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu = 0.15$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq68.gif"/></alternatives></inline-formula> and <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma = 6$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq69.gif"/></alternatives></inline-formula> meV. <italic>R</italic> is the exciton Rydberg energy [<xref ref-type="bibr" rid="CR36">36</xref>].</p><p id="Par31">Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the absorption coefficient of a range of InGaAs/GaAsP QWs with a GaAs interlayer and different in content. Higher indium content increases the depth of the well, allowing the absorption of less energetic light and more transitions.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Absorption coefficient of a single 7.2 nm-thick InGaAs QW with 3 nm GaAs interlayers and GaAs<inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:msub><mml:mrow/><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{0.9}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq70.gif"/></alternatives></inline-formula>P<inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mrow/><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{0.1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq71.gif"/></alternatives></inline-formula> barriers as a function of the indium content</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig7_HTML.gif" id="MO106"/></fig></p></sec></sec><sec id="Sec10"><title>Light sources</title><p id="Par32">Transforming sunlight into electricity is the final goal of any solar cell, and it is therefore necessary to have a convenient way of creating, manipulating, and modifying the properties of the spectrum of the light. Ideally, solar cells will be designed and evaluated under a standard solar spectrum—e.g. the air mass 1.5 direct solar spectrum, AM1.5D—but practical light sources are not standard. More often than not, we are interested in modelling the performance of a solar cell under the experimental spectrum of a solar simulator or lamp in a laboratory, simulated data calculated from atmospheric conditions (temperature, humidity, aerosol content, etc.) or even under real irradiance data measured at different locations worldwide. This can then be compared with the experimental performance or tailored to work best under certain conditions.</p><p id="Par33">The Solcore module light_source is designed to deal easily with different light sources. It has direct support for:<list list-type="bullet"><list-item><p id="Par34">Gaussian emission, typical of lasers and light-emitting diodes.</p></list-item><list-item><p id="Par35">Black-body radiation, characteristic of halogen lamps defined by a temperature, but also used very often to simulate the spectrum of the Sun, very close to a black body source at 5800 K.</p></list-item><list-item><p id="Par36">Standard solar spectra: the extraterrestial spectrum AM0 and the two terrestial ones, AM1.5D and AM1.5G as defined by the ASTM G173-03(2008) standard.</p></list-item><list-item><p id="Par37">Irradiance models, using location, time and atmospheric parameters to calculate a synthetic solar spectrum. Solcore includes two models: SPECTRAL2, fully implemented in Python, and an interface to SMARTS binaries (which need to be installed separately), which greatly simplifies its use in batch mode.</p></list-item><list-item><p id="Par38">User-defined irradiances, provided externally from a database or any other source, allowing for maximum flexibility.</p></list-item></list>The syntax in all cases is simple and intuitive considering the type of source that needs to be created. In the case of the irradiance models, which often have a large number of inputs, Solcore defines a set of default values, so only those that are different need to be provided. The code in Listing 3 illustrates the creation of several light sources using the minimum required input in each case. A plot of those light sources is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fige" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fige_HTML.gif" position="anchor" id="MO31"/></fig><fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Plot of the spectra of different light sources</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig8_HTML.gif" id="MO107"/></fig></p><p id="Par39">Once created, specific parameters of the light sources can be easily modified without the need for creating the source from scratch. That is particularly useful for the irradiance models, where we might be interested in getting the spectrum as a function of a certain parameter (e.g. the hour of the day, or the humidity) without changing the others. For example, smarts.spectrum(HOUR=11) and smarts.spectrum(HOUR=17) will provide the spectrum of the SMART light source defined above calculated at 11 h and at 17 h, respectively; all additional parameters have the default values. This method has been used to model experimental solar irradiances measured by different spectroradiometers based on the local atmospheric conditions [<xref ref-type="bibr" rid="CR39">39</xref>].</p><p id="Par40">A final, very convenient feature of the LightSource class is the ability to request the spectrum in a range of different units. The default is power density per nanometre, but other common units are power density per eV or photon flux per nanometre, among others. While these unit conversions are straightforward, it is often an initial source of errors due to missing constants or incompatible magnitudes.</p><p id="Par41">The light_source module has been described in the context of the solar spectrum, but it can be applied broadly where there is spectral data involved, such as the fitting of photoluminescence, electroluminescence, or Raman spectra.</p></sec><sec id="Sec11"><title>Optical solvers</title><p id="Par42">The purpose of the optical solvers is to obtain the fraction of incoming light reflected, absorbed, and transmitted in a solar cell as a function of the wavelength of the light and the position inside the structure. Solcore includes three models to tackle this problem: Beer–Lambert law (BL), transfer matrix method (TMM), and rigorous coupled-wave analysis (RCWA). At the moment, Solcore does not have explicit support for light trapping effects using general textured surfaces, which are usually present in silicon solar cells. However, this can be implemented to a large extent using the RCWA method, although not very efficiently. Additionally, the reflected, absorbed, and transmitted light can be calculated externally and then provided as input to Solcore to obtain the electrical properties of a solar cell structure, giving it full flexibility.</p><p id="Par43">All the optical solvers apply to the solar cell structure as a whole, providing as output the fraction of light reflected (<inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R(\lambda )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq72.gif"/></alternatives></inline-formula>), transmitted (<inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(\lambda )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq73.gif"/></alternatives></inline-formula>), and absorbed per unit length at a depth <italic>z</italic> from the front surface (<inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A(\lambda , z)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq74.gif"/></alternatives></inline-formula>).</p><p id="Par44">Figure <xref rid="Fig9" ref-type="fig">9</xref> shows a comparison of the quantum efficiency of a thin GaAs solar cell with a distributed Bragg reflector (DBR) and an array of TiO<inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq75.gif"/></alternatives></inline-formula> nanoparticles (NP) on top calculated using the three optical solvers described in the following sections. Supplementary Information shows the full code needed to produce these curves [<xref ref-type="bibr" rid="CR40">40</xref>].<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Comparison of the quantum efficiency of a thin GaAs solar cell with a distributed Bragg reflector (DBR) and an array of TiO<inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq76.gif"/></alternatives></inline-formula> nanoparticles (NP) on top calculated using the three optical solvers. The BL model ignores the NP and the DBR and does not include the front surface reflection, overestimating the result at all wavelengths. TMM correctly accounts for the reflection and the DBR but cannot model the effect of diffraction due to the NP layer. RCWA takes into account scattering from the NP, although it is significantly more time consuming</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig9_HTML.gif" id="MO108"/></fig></p><sec id="Sec12"><title>Beer–Lambert law (BL)</title><p id="Par45">This is the simplest model to calculate the absorption in a multi-layer structure. It ignores all reflection at the interfaces—the front surface reflection can be provided externally, and is zero otherwise at all wavelengths—and the absorption per unit length as a function of the wavelength <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:mi>λ</mml:mi></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq77.gif"/></alternatives></inline-formula> and the position <italic>z</italic> in layer <italic>n</italic> is given by:<disp-formula id="Equ20"><label>20</label><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} A_n(\lambda , z) = \alpha _n (\lambda ) \exp \left( - \sum _{i=1}^{n-1} \alpha _i (\lambda ) w_i - \alpha _n (\lambda ) (z - z_n) \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ20.gif"/></alternatives></disp-formula>where <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq78.gif"/></alternatives></inline-formula> is the absorption coefficient of layer <italic>n</italic>, <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq79.gif"/></alternatives></inline-formula> its thickness and <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:msub><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq80.gif"/></alternatives></inline-formula> the position of the beginning of the layer. Due to its simplicity, the BL law is used widely in photovoltaics but in reality it is only applicable when the contrast in the refractive index between layers can be ignored and when there is strong absorption, reducing the effects of light reflection at the interfaces.</p></sec><sec id="Sec13"><title>Transfer matrix method (TMM)</title><p id="Par46">In order to evaluate the realistic optical behaviour of a solar cell design, it is important to consider the interaction of incident electromagnetic (EM) radiation with a succession of both absorbing and non-absorbing planar layers. The combined optical response of such a layered structure is crucial when considering the minimization of extrinsic front surface reflection losses [<xref ref-type="bibr" rid="CR41">41</xref>], the emissivity in the mid-IR of low emissivity coatings for hybrid PV-thermal applications [<xref ref-type="bibr" rid="CR42">42</xref>] and also when studying the optical constants and layer thicknesses of material using the experimental technique of spectroscopic ellipsometry. Therefore, Solcore evaluates the interaction of incident EM radiation through a layered structure using the TMM. The incident light radiation takes the form of homogeneous, electromagnetic plane-polarized waves and is represented by components describing the electric, <bold><italic>E</italic></bold> and magnetic field strengths, <bold><italic>H</italic></bold>:<disp-formula id="Equ21"><label>21</label><alternatives><mml:math display="block" id="Equ21_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="bold">E</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mi>i</mml:mi><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac></mml:mfenced><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mi>φ</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {E}&amp;= \mathcal {E} \mathrm{exp} \left[ i \omega t - \left( \frac{2 \pi N}{\lambda } \right) z + \varphi \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ21.gif"/></alternatives></disp-formula><disp-formula id="Equ22"><label>22</label><alternatives><mml:math display="block" id="Equ22_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="bold">H</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mi>i</mml:mi><mml:mi>ω</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac></mml:mfenced><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>φ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf {H}&amp;= \mathcal {H} \mathrm{exp} \left[ i \omega t - \left( \frac{2 \pi N}{\lambda } \right) z + \varphi ^{\prime } \right] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ22.gif"/></alternatives></disp-formula>where <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mi mathvariant="script">E</mml:mi></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {E}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mi mathvariant="script">H</mml:mi></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq82.gif"/></alternatives></inline-formula> denote the electric and magnetic field amplitudes, respectively, <italic>N</italic> the complex refractive index, <italic>z</italic> the distance in the direction of propagation, <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mi>ω</mml:mi></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq83.gif"/></alternatives></inline-formula> the angular frequency and <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mi>λ</mml:mi></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq84.gif"/></alternatives></inline-formula> the wavelength of radiation. <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mi>φ</mml:mi></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:msup><mml:mi>φ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi ^{\prime }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq86.gif"/></alternatives></inline-formula> represent arbitrary phase angles for both the electric and magnetic travelling wave components and are not independent of each other. The characteristic transfer matrix for evaluating the interaction between planar electric and magnetic waves at the interface of <italic>n</italic> thin films on a semi-infinite substrate is derived in detail elsewhere [<xref ref-type="bibr" rid="CR43">43</xref>] and given by the equation:<disp-formula id="Equ23"><label>23</label><alternatives><mml:math display="block" id="Equ23_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">E</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>i</mml:mi><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi mathvariant="normal">sin</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{bmatrix} \mathbf {E} \\ \mathbf {H} \end{bmatrix} = \left\{ \prod _{q=1}^{n} \begin{bmatrix} \mathrm{cos}(\delta _q)&amp;\quad [i \mathrm{sin}(\delta _q)]/ \eta _q \\ i \eta _q \mathrm{sin}(\delta _q)&amp;\quad \mathrm{cos}(\delta _q) \end{bmatrix} \right\} \begin{bmatrix} 1 \\ \eta _m \end{bmatrix} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ23.gif"/></alternatives></disp-formula>where <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq87.gif"/></alternatives></inline-formula> is defined as the phase factor of the <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{\mathrm{th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq88.gif"/></alternatives></inline-formula> planar layer, <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq89.gif"/></alternatives></inline-formula> the optical admittance of the <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msub></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{\mathrm{th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq90.gif"/></alternatives></inline-formula> layer, and <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:msub><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _m$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq91.gif"/></alternatives></inline-formula> the optical admittance of the substrate. The layer closest to the incident medium is evaluated first before working through the <italic>n</italic> layer structure in order. The term <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:msub><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq92.gif"/></alternatives></inline-formula> describes the phase shift required to translate the <italic>z</italic> coordinate of the <italic>E</italic> and <italic>H</italic> interactions by the thickness of each layer, <italic>q</italic>. The spectrally varying Fresnel coefficients describing reflection, transmission, and absorption of the multi-layer structure can be calculated from the solutions to Eq. <xref rid="Equ23" ref-type="disp-formula">23</xref> at discrete wavelengths:<disp-formula id="Equ24"><label>24</label><alternatives><mml:math display="block" id="Equ24_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>R</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R&amp;= \left( \frac{\eta _0 \mathbf {E} - \mathbf {H}}{\eta _0 \mathbf {E} + \mathbf {H}}\right) \left( \frac{\eta _0 \mathbf {E} - \mathbf {H}}{\eta _0 \mathbf {E} + \mathbf {H}}\right) ^* \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ24.gif"/></alternatives></disp-formula><disp-formula id="Equ25"><label>25</label><alternatives><mml:math display="block" id="Equ25_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>T</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T&amp;= \frac{4 \eta _0 Re(\eta _m)}{(\eta _0 \mathbf {E} + \mathbf {H})(\eta _0 \mathbf {E} + \mathbf {H})^*}\end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ25.gif"/></alternatives></disp-formula><disp-formula id="Equ26"><label>26</label><alternatives><mml:math display="block" id="Equ26_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>A</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">E</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} A&amp;= \frac{4 \eta _0 Re(\mathbf {E}\mathbf {H}^* - \eta _m)}{(\eta _0 \mathbf {E} + \mathbf {H})(\eta _0 \mathbf {E} + \mathbf {H})^*}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ26.gif"/></alternatives></disp-formula><fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Example solutions from the TMM module in Solcore calculating Reflection, Transmission and complex dielectric function. <bold>a</bold> Spectral reflection (solid lines) and transmission (dashed lines) over a range of angles for the optimized triple layer ARC reported in [<xref ref-type="bibr" rid="CR41">41</xref>], <bold>b</bold> the calculated real and imaginary parts of the complex dielectric function obtained from spectroscopic ellipsometry of a Ge substrate at <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:msup><mml:mn>79</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$79^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq93.gif"/></alternatives></inline-formula> (points), and the dielectric constant calculated using TMM for a model consisting of a semi-infinite Ge substrate and 4.5 nm GeO<inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq94.gif"/></alternatives></inline-formula> (lines)</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig10_HTML.gif" id="MO109"/></fig></p><p id="Par47">The implementation of the TMM in Solcore uses the freely available tmm module developed by Byrnes [<xref ref-type="bibr" rid="CR44">44</xref>]. The multi-layer optical stack is built up using Solcore’s <italic>Structure</italic> object. Some example code evaluating the TMM for a triple layer anti-reflection coating (ARC) on top of conventional multi-junction solar cell materials AlInP and GaInP is included in Listing 4.<fig id="Figf" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figf_HTML.gif" position="anchor" id="MO42"/></fig></p><p id="Par48">Figure <xref rid="Fig10" ref-type="fig">10</xref>a depicts calculated reflection and transmission from the solutions to the characteristic TMM equation over a range of incident angles for an optimized triple layer ARC design reported in [<xref ref-type="bibr" rid="CR41">41</xref>]. The solid lines indicate the optical reflection at the front surface, while the dashed lines correspond to the transmitted light into the substrate, in this case taken to be the optically thick top sub-cell material of GaInP.</p><p id="Par49">In addition to using the TMM for calculating the reflection, transmission, and absorption in a multi-layer optical stack, it can also be applied to the popular spectroscopic technique of ellipsometry. This measures a change in the polarization of incident light reflected at the surface of a sample. A more detailed description of ellipsometry and its uses can be found elsewhere [<xref ref-type="bibr" rid="CR33">33</xref>]. The measured values are expressed as the angles Psi (<inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mi>Ψ</mml:mi></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varPsi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq95.gif"/></alternatives></inline-formula>) and Delta (<inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mi>Δ</mml:mi></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq96.gif"/></alternatives></inline-formula>), which are related to <inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {R_s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">p</mml:mi></mml:msub></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {R_p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq98.gif"/></alternatives></inline-formula> (the Fresnel reflection coefficients for <italic>s</italic> and <italic>p</italic>-polarized light, respectively) by<xref ref-type="fn" rid="Fn1">1</xref>:<disp-formula id="Equ27"><label>27</label><alternatives><mml:math display="block" id="Equ27_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">p</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi mathvariant="normal">tan</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ψ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>Δ</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho = \frac{\mathbf {R_p}}{\mathbf {R_s}} = \mathrm{tan}(\varPsi ) e^{i \varDelta }. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ27.gif"/></alternatives></disp-formula>As the ratio between <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {R_s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq103.gif"/></alternatives></inline-formula> and <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">p</mml:mi></mml:msub></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {R_p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq104.gif"/></alternatives></inline-formula> is a complex quantity, phase change information is contained within <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mi>Δ</mml:mi></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq105.gif"/></alternatives></inline-formula> in Eq. <xref rid="Equ27" ref-type="disp-formula">27</xref>. The change in phase of the reflected electric and magnetic plane waves can be evaluated from the solution of Eq. <xref rid="Equ23" ref-type="disp-formula">23</xref> and is given by:<disp-formula id="Equ28"><label>28</label><alternatives><mml:math display="block" id="Equ28_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>φ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arctan</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>η</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold">E</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varphi = \mathrm{arctan}\left( \frac{Im\left[ \eta _m (\mathbf {E}\mathbf {H}^* - \mathbf {H}\mathbf {E}^*)\right] }{(\eta _{m}^{2} \mathbf {E}\mathbf {E}^* - \mathbf {H}\mathbf {H}^*)} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ28.gif"/></alternatives></disp-formula>The complex dielectric function of a sample can be calculated from the experimental ellipsometry results with the solutions to Eq. <xref rid="Equ27" ref-type="disp-formula">27</xref>:<disp-formula id="Equ29"><label>29</label><alternatives><mml:math display="block" id="Equ29_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="〉" open="〈"><mml:mi>ϵ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\langle \epsilon \right\rangle = \epsilon _1 - i\epsilon _2 = \mathrm{sin}^2(\theta ) \left[ 1 + \mathrm{tan}^2(\theta ) \left( \frac{1 - \rho }{1 + \rho }\right) ^2 \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ29.gif"/></alternatives></disp-formula>Some example code calculating the complex dielectric function from the ellipsometric response of a sample of Ge substrate is shown in Listing 5. The output of the model is shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>b and is compared with experimentally obtained data at an incident angle of <inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msup><mml:mn>79</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$79^{\circ }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq106.gif"/></alternatives></inline-formula>. Good agreement with the experimental data is observed when a thin 4.5 nm layer of germanium oxide (GeO<inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq107.gif"/></alternatives></inline-formula>) is included in the layer model.<fig id="Figg" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figg_HTML.gif" position="anchor" id="MO46"/></fig></p></sec><sec id="Sec14"><title>Rigorous coupled-wave analysis (RCWA)</title><p id="Par51">Finally, Solcore includes an interface to the <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msup><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq108.gif"/></alternatives></inline-formula> solver (which must be installed separately), developed at Stanford University, in order to model solar cells with nanophotonic designs [<xref ref-type="bibr" rid="CR45">45</xref>]. <inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msup><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq109.gif"/></alternatives></inline-formula> is an implementation of RCWA, also sometimes referred to as the Fourier Model Method (FMM), which solves the linear Maxwell’s equations in structures containing 2D periodicity. Structures with 2D periodicity can be found in advanced solar cell designs aiming, for example, to reduce the solar cell thickness by scattering the incoming light using a periodic diffraction grating at the front or rear of the absorbing layer [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>].</p><p id="Par52"><inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msup><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq110.gif"/></alternatives></inline-formula> defines structures by creating a layer stack of the desired materials using Solcore’s <italic>Layer</italic> and <italic>Junction</italic> classes, in which each layer’s composition can be modified by adding circles, rectangles, ellipses, or a generalized polygon made of a specified Solcore material. Each layer is assumed to be infinitely periodic in the <italic>x</italic> and <italic>y</italic> direction, and uniform in the <italic>z</italic> direction. A unit cell must be defined for the whole structure (using the size attribute in the user options), and each shape is placed at a specified location (and, where relevant, angular orientation) in the unit cell; as many shapes as necessary can be added, supplied as a list of dictionaries with the relevant parameters for each shape. An example for each type of shape supported by <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:msup><mml:mi>S</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S^4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq111.gif"/></alternatives></inline-formula> is shown in Listing 6. The size of the unit cell in the <italic>x</italic> and <italic>y</italic> directions and the base size of the unit cell must be given in nm. The number of Fourier components used in the calculation [<xref ref-type="bibr" rid="CR45">45</xref>] must also be specified; this is done using the orders attribute in the user options passed to the solver of choice.<fig id="Figh" position="anchor"><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Figh_HTML.gif" position="anchor" id="MO47"/></fig></p></sec></sec><sec id="Sec15"><title>Single-junction solar cells</title><p id="Par53">Solcore includes four solvers to calculate the electrical properties of a single-junction device. In order of increasing accuracy, these are: detailed balance, 2-diode equation, depletion approximation, and Poisson–drift–diffusion.</p><sec id="Sec16"><title>Detailed balance (DB)</title><p id="Par54">This solver calculates the electrical properties of the junction by balancing the elementary processes taking place in the solar cell, carrier generation, and radiative recombination, using the formalism described by Araújo and Martí [<xref ref-type="bibr" rid="CR48">48</xref>]. The method is widely used by the photovoltaic community to calculate the limiting conversion efficiencies of the different solar cell architectures or materials. The simplest DB formulation only needs an absorption edge energy and an absorptivity value above that edge. Out of this, the carrier generation and radiative recombination are calculated for different internal chemical potentials, equal to the external electrical bias, in the ideal case. Solcore includes this basic model, but also allows the user to provide a more complex absorption profile.</p><p id="Par55">The radiative recombination or thermal generation current <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{rad}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq112.gif"/></alternatives></inline-formula> from the solar cell is calculated following the formalism described by Nelson et al. [<xref ref-type="bibr" rid="CR20">20</xref>], considering all the possible paths of the light absorbed by the cell and the reciprocity relation between emission and absorption. The total radiative current, using the generalized Planck equation, is given by:<disp-formula id="Equ30"><label>30</label><alternatives><mml:math display="block" id="Equ30_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:msup><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mo>∫</mml:mo><mml:mi>S</mml:mi></mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>Ω</mml:mi><mml:mi mathvariant="bold">dS</mml:mi></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:msup><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} J_{\mathrm{rad}}(V, T)&amp;= q \frac{2 n^2}{h^3c^2} \int _{0}^{\infty } \frac{E^2}{e^{ \frac{E - qV}{k_bT}} - 1 } \\&amp;\quad \times \left[ \int _{S} A(E, \theta , \mathbf {s}) \mathrm{d}\varOmega \mathbf {dS} \right] \mathrm{d}E \\&amp;=q \frac{2 n^2}{h^3c^2} \int _{0}^{\infty } \frac{E^2}{e^{ \frac{E - qV}{k_bT}} - 1 } \\&amp;\quad \times \left[ A_{\mathrm{front}}(E) + A_{\mathrm{back}}(E) \right] \mathrm{d}E \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ30.gif"/></alternatives></disp-formula>where <italic>A</italic>(<italic>E</italic>, <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:mi>θ</mml:mi></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mi mathvariant="bold">s</mml:mi></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq114.gif"/></alternatives></inline-formula>) is the probability that a photon of energy <italic>E</italic> will be emitted (absorbed) from the point <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:mi mathvariant="bold">s</mml:mi></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq115.gif"/></alternatives></inline-formula> on the surface at an <italic>internal</italic> angle <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:mi>θ</mml:mi></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq116.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{\mathrm{front}}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq117.gif"/></alternatives></inline-formula> and <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{\mathrm{back}}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq118.gif"/></alternatives></inline-formula> are the combined probability of the photon to be emitted (absorbed) by the front and the back of the cell, respectively.</p><p id="Par56">The different paths of the absorbed light are depicted in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. Path A represents light that reaches the front surface within the escape cone (<inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta &lt; \theta _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq119.gif"/></alternatives></inline-formula>) and that crosses the structure. Path B is the light that reaches the back surface outside the escape cone of the front surface (<inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta &gt; \theta _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq120.gif"/></alternatives></inline-formula>), being totally internally reflected and crossing the structure twice. Light reaching the back surface within the escape cone (<inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta &lt; \theta _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq121.gif"/></alternatives></inline-formula>) can either escape through the front (path C) or be reflected (path D). With these considerations, the contribution to the surface integral of the four terms will be [<xref ref-type="bibr" rid="CR20">20</xref>]:<disp-formula id="Equ31"><label>31</label><alternatives><mml:math display="block" id="Equ31_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mtext>A---</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>B---</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>C---</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mtext>D---</mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \text {A---}&amp;2\pi S_{\mathrm{front}} \int _{\cos \theta _c}^{1} \left[ 1-r(E,\theta ) \right] \left( 1 - e^{-\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ) \\ \text {B---}&amp;2\pi S_{\mathrm{back}} \int _{0}^{ \cos \theta _c } \left( 1 - e^{-2\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ) \\ \text {C---}&amp;2\pi S_{\mathrm{back}} \int _{\cos \theta _c}^{1} \left[ 1-r(E, \theta ) \right] \left( 1 - e^{-\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ) \\ \text {D---}&amp;2\pi S_{\mathrm{back}} \int _{\cos \theta _c}^{1} r(E, \theta ) \left( 1 - e^{-2\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ31.gif"/></alternatives></disp-formula><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>All the paths that radiation can follow within the cell, used to calculate the absorptivity<inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mo>≡</mml:mo></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\equiv $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq122.gif"/></alternatives></inline-formula>emissivity as a function of the angle</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig11_HTML.gif" id="MO110"/></fig></p><p id="Par57">These equations can be written in a more compact form by noting that <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq123.gif"/></alternatives></inline-formula> for <inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta &gt; \theta _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq124.gif"/></alternatives></inline-formula>. In this situation, <italic>B</italic>, <italic>C</italic>, and <italic>D</italic> can be combined and the integral extended from 0 to 1, resulting simply in:<disp-formula id="Equ32"><label>32</label><alternatives><mml:math display="block" id="Equ32_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} A_{\mathrm{back}}(E)&amp;= 2\pi \int _{0}^{1} \left[ 1+r(E, \theta ) e^{-\alpha w / \cos \theta } \right] \\&amp;\quad \times \left( 1 - e^{-\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ32.gif"/></alternatives></disp-formula>The factor <inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{\mathrm{back}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq125.gif"/></alternatives></inline-formula> representing the area of the back of the cell has been omitted here as we are interested in the current density, and therefore independent of the area. Likewise, <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{\mathrm{front}}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq126.gif"/></alternatives></inline-formula> will be given simply by the component <italic>A</italic> in Eq. <xref rid="Equ31" ref-type="disp-formula">31</xref>:<disp-formula id="Equ33"><label>33</label><alternatives><mml:math display="block" id="Equ33_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>cos</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} A_{\mathrm{front}}(E)&amp;= 2\pi \int _{\cos \theta _\mathrm{c}}^{1} \left[ 1-r(E,\theta ) \right] \\&amp;\quad \times \left( 1 - e^{-\alpha w / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ33.gif"/></alternatives></disp-formula><inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{rad}}(V, T_{\mathrm{cell}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq127.gif"/></alternatives></inline-formula> will represent the radiative recombination of the cell at a bias <italic>V</italic> and temperature <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\mathrm{cell}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq128.gif"/></alternatives></inline-formula>, while <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{rad}}(0, T_{\mathrm{a}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq129.gif"/></alternatives></inline-formula> will be the carrier generation due to thermal radiation from the ambient at a temperature <inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq130.gif"/></alternatives></inline-formula>. Typically, <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{\mathrm{cell}} = T_\mathrm{a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq131.gif"/></alternatives></inline-formula>.</p><p id="Par58">Carrier generation in the solar cell due to the absorption of the solar irradiance <italic>H</italic>(<italic>E</italic>) can be written simply as:<disp-formula id="Equ34"><label>34</label><alternatives><mml:math display="block" id="Equ34_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{\mathrm{sc}} = q \int _{0}^{\infty } [1-R(E)] A_n(E) H(E) \mathrm{d}E \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ34.gif"/></alternatives></disp-formula>where <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = r(E, 0)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq132.gif"/></alternatives></inline-formula> is the normal incidence reflection and <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq133.gif"/></alternatives></inline-formula> is the normal incidence absorptivity of the cell, given by <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A(E) = 1- \exp (-\alpha (E) w)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq134.gif"/></alternatives></inline-formula> where <italic>w</italic> is the thickness of the junction and <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq135.gif"/></alternatives></inline-formula> is the absorption coefficient.</p><p id="Par59">Combining all these equations, the total current as a function of the bias calculated with the DB model will be given by:<disp-formula id="Equ35"><label>35</label><alternatives><mml:math display="block" id="Equ35_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J = J_{\mathrm{sc}} + J_{\mathrm{rad}}(0, T_{\mathrm{a}}) - J_{\mathrm{rad}}(V, T_{\mathrm{cell}}). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ35.gif"/></alternatives></disp-formula>If <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{a} = T_{\mathrm{cell}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:mrow><mml:mi>E</mml:mi><mml:mo>≫</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E \gg k_bT$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq137.gif"/></alternatives></inline-formula>, Eq. <xref rid="Equ35" ref-type="disp-formula">35</xref> simplifies, resulting in:<disp-formula id="Equ36"><label>36</label><alternatives><mml:math display="block" id="Equ36_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qV</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J = J_{\mathrm{sc}} - J_{01} \left( e^{\frac{qV}{k_bT_{\mathrm{cell}}} } -1 \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ36.gif"/></alternatives></disp-formula>with <inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{01}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq138.gif"/></alternatives></inline-formula> the reverse saturation current, given by:<disp-formula id="Equ37"><label>37</label><alternatives><mml:math display="block" id="Equ37_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:msup><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">cell</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">front</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{01} = q \frac{2 n^2}{h^3c^2} \int _{0}^{\infty } E^2e^{ -\frac{E}{k_bT_{\mathrm{cell}}}} \left[ A_{\mathrm{front}}(E) + A_{\mathrm{back}}(E) \right] \mathrm{d}E. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ37.gif"/></alternatives></disp-formula>While in these equations the term <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exp (-\alpha w)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq139.gif"/></alternatives></inline-formula> is used, it should be noted that none of the two parameters <italic>alpha</italic> and <italic>w</italic> are needed as the product is calculated internally by Solcore from the normal incidence absorptivity <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_n(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq140.gif"/></alternatives></inline-formula>, which is the value given as input:<disp-formula id="Equ38"><label>38</label><alternatives><mml:math display="block" id="Equ38_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e^{-\alpha w} = 1-A_n(E). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ38.gif"/></alternatives></disp-formula></p></sec><sec id="Sec17"><title>2-diode model (2D)</title><p id="Par60">This is the simplest method for simulating the behaviour of a solar cell, using electrical components to model the different transport and recombination mechanisms of the device. The 2D model is widely applied when modelling solar cells at the most engineering end of the topic, when a detailed knowledge of the solar cell structure (layers, absorption coefficient, etc.) are not known or sought. It is often used to fit experimental IV curves and find approximate, general information on the solar cell quality without entering on the fundamental processes. It can provide valuable information to engineers, when designing solar modules for example, or for diagnostic purposes The complete form of the equation is:<disp-formula id="Equ39"><label>39</label><alternatives><mml:math display="block" id="Equ39_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>J</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>J</mml:mi></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} J&amp;= J_{\mathrm{sc}} - J_{01} \left( e^ \frac{q(V-R_sJ)}{n_1 k_b T} - 1 \right) \\&amp;\quad - J_{02} \left( e^ \frac{q(V-R_sJ)}{n_2 k_b T} - 1 \right) \\&amp;\quad - \frac{V-R_sJ}{R_{\mathrm{sh}}}. \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ39.gif"/></alternatives></disp-formula>Generally, the photocurrent is modelled as a current source (<inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{sc}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq141.gif"/></alternatives></inline-formula>), with radiative and non-radiative recombination modelled as two diodes with reverse saturation currents <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{01}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{02}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq143.gif"/></alternatives></inline-formula>, and ideality factors <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1\approx 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq144.gif"/></alternatives></inline-formula> and <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2\approx 2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq145.gif"/></alternatives></inline-formula>, respectively. The shunt resistance <inline-formula id="IEq146"><alternatives><mml:math id="IEq146_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:math><tex-math id="IEq146_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq146.gif"/></alternatives></inline-formula> accounts for alternative current paths between the contacts of the solar cell, being infinite in the ideal case, and the series resistance <inline-formula id="IEq147"><alternatives><mml:math id="IEq147_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq147_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq147.gif"/></alternatives></inline-formula> accounts for the other transport losses. The values of the saturation currents and ideality factors can, ultimately, be calculated from the material properties and device structure, as is done in the depletion approximation model (Sect. <xref rid="Sec22" ref-type="sec">5.4</xref>), but the 2D model allows them to be provided directly as input, obtained from a fit to experimental data, for example. They can also be calculated internally, using the DB solver to obtain <inline-formula id="IEq148"><alternatives><mml:math id="IEq148_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><tex-math id="IEq148_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{01}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq148.gif"/></alternatives></inline-formula> and <inline-formula id="IEq149"><alternatives><mml:math id="IEq149_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub></mml:math><tex-math id="IEq149_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{sc}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq149.gif"/></alternatives></inline-formula>, and then using a radiative efficiency coefficient to obtain <inline-formula id="IEq150"><alternatives><mml:math id="IEq150_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub></mml:math><tex-math id="IEq150_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{02}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq150.gif"/></alternatives></inline-formula>. The radiative efficiency <inline-formula id="IEq151"><alternatives><mml:math id="IEq151_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq151_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq151.gif"/></alternatives></inline-formula> is defined as the fraction of radiative current <inline-formula id="IEq152"><alternatives><mml:math id="IEq152_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub></mml:math><tex-math id="IEq152_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{rad}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq152.gif"/></alternatives></inline-formula> at a given reference total current <inline-formula id="IEq153"><alternatives><mml:math id="IEq153_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq153_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq153.gif"/></alternatives></inline-formula>:<disp-formula id="Equ40"><label>40</label><alternatives><mml:math display="block" id="Equ40_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \eta = \frac{J_{\mathrm{rad}}}{J_{\mathrm{ref}}} = \frac{J_{01}}{J_{\mathrm{ref}}} \left( e ^{\frac{qV_{\mathrm{ref}}}{n_1k_bT}} - 1 \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ40.gif"/></alternatives></disp-formula>The reference voltage <inline-formula id="IEq154"><alternatives><mml:math id="IEq154_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq154_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq154.gif"/></alternatives></inline-formula> can be written as a function of <inline-formula id="IEq155"><alternatives><mml:math id="IEq155_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq155_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><mml:math id="IEq156_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:math><tex-math id="IEq156_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{ref}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq156.gif"/></alternatives></inline-formula> as:<disp-formula id="Equ41"><label>41</label><alternatives><mml:math display="block" id="Equ41_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>η</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{\mathrm{ref}} = \frac{n_1k_bT}{q} \log \left( \frac{\eta J_{\mathrm{ref}}}{J_{01}} + 1 \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ41.gif"/></alternatives></disp-formula>On the other hand, the radiative coefficient can also be written as:<disp-formula id="Equ42"><label>42</label><alternatives><mml:math display="block" id="Equ42_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi mathvariant="normal">rad</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \eta = \frac{J_{\mathrm{ref}} - J_{n\mathrm{rad}} - V_{\mathrm{ref}}/R_{\mathrm{sh}}}{J_{\mathrm{ref}}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ42.gif"/></alternatives></disp-formula>Combining Eqs. <xref rid="Equ41" ref-type="disp-formula">41</xref> and <xref rid="Equ42" ref-type="disp-formula">42</xref> and using the expression for the diode with ideality factor <inline-formula id="IEq157"><alternatives><mml:math id="IEq157_Math"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq157_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq157.gif"/></alternatives></inline-formula>, <inline-formula id="IEq158"><alternatives><mml:math id="IEq158_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub></mml:math><tex-math id="IEq158_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{02}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq158.gif"/></alternatives></inline-formula> can be written as:<disp-formula id="Equ43"><label>43</label><alternatives><mml:math display="block" id="Equ43_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{02} = \frac{(1-\eta ) J_{\mathrm{ref}} - V_{\mathrm{ref}} / R_{\mathrm{sh}}}{e^ {\frac{qV_{\mathrm{ref}}}{n_2k_bT} } - 1}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ43.gif"/></alternatives></disp-formula>In the common situation of very large shunt resistance and <inline-formula id="IEq159"><alternatives><mml:math id="IEq159_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><tex-math id="IEq159_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{ref}} \gg k_bT/q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq159.gif"/></alternatives></inline-formula>, this equation further simplifies to:<disp-formula id="Equ44"><label>44</label><alternatives><mml:math display="block" id="Equ44_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mi>η</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{02} = (1-\eta ) J_{\mathrm{ref}} \left( \frac{J_{01} }{ J_{\mathrm{ref}} \eta } \right) ^{n_1/n_2}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ44.gif"/></alternatives></disp-formula>This process can, of course, be reversed to use knowledge of <inline-formula id="IEq160"><alternatives><mml:math id="IEq160_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><tex-math id="IEq160_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{01}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><mml:math id="IEq161_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub></mml:math><tex-math id="IEq161_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{02}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq161.gif"/></alternatives></inline-formula> at a given reference current to calculate the radiative efficiency of a solar cell, which is useful to compare different materials, technologies or processing methods. This was done by Chan et al. using <inline-formula id="IEq162"><alternatives><mml:math id="IEq162_Math"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ref</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><tex-math id="IEq162_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{ref}} = 30$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq162.gif"/></alternatives></inline-formula> mA/cm<inline-formula id="IEq163"><alternatives><mml:math id="IEq163_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq163_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq163.gif"/></alternatives></inline-formula>, obtaining <inline-formula id="IEq164"><alternatives><mml:math id="IEq164_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq164_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq164.gif"/></alternatives></inline-formula> values of 20% for InGaP, 22% for GaAs, and 27% for InGaAs devices [<xref ref-type="bibr" rid="CR49">49</xref>]. It should be pointed out that this method is only valid under the assumption that <inline-formula id="IEq165"><alternatives><mml:math id="IEq165_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math><tex-math id="IEq165_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{01}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq165.gif"/></alternatives></inline-formula> corresponds only to radiative recombination and <inline-formula id="IEq166"><alternatives><mml:math id="IEq166_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>02</mml:mn></mml:msub></mml:math><tex-math id="IEq166_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{02}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq166.gif"/></alternatives></inline-formula> only to non-radiative recombination, which is generally true for QW solar cells and some III–V solar cells, like those made of GaAs or InGaP, but not for Si or Ge, for example. Other definitions of the radiative efficiency are based on the external quantum efficiency, the <inline-formula id="IEq167"><alternatives><mml:math id="IEq167_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">sc</mml:mi></mml:msub></mml:math><tex-math id="IEq167_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{\mathrm{sc}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><mml:math id="IEq168_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub></mml:math><tex-math id="IEq168_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_\mathrm{oc}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq168.gif"/></alternatives></inline-formula> of the cell, as described by Green [<xref ref-type="bibr" rid="CR50">50</xref>].</p><p id="Par61">Despite the simplicity of the 2-diode model, it is very useful to guide the design of new solar cells and explore the performance of new materials, such as dilute bismuth alloys [<xref ref-type="bibr" rid="CR51">51</xref>], or to asses the performance of large arrays of solar cells, as will be shown in Sect. <xref rid="Sec28" ref-type="sec">7</xref> [<xref ref-type="bibr" rid="CR52">52</xref>].</p></sec><sec id="Sec18"><title>Poisson–drift–diffusion (PDD)</title><p id="Par62">This method solves the Poisson equation for the electrostatic potential coupled with the transport equations for electrons and holes and suitable boundary conditions in the steady state. It is the standard method for calculating the electrical properties of most semiconductor devices, including solar cells, transistors, or light-emitting diodes. It is also the only method included in most software packages for simulating semiconductor devices, such as PC-1D, Nextnano, SCAPS and AFORS-HET.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p><bold>a</bold> Work flow of Solcore’s PDD solver, <bold>b</bold> process of obtaining the effective band structure of QWs to use in the PDD solver. From left to right: simple sequence of layers; band profile and energy levels after considering the strain and quantum confinement; effective band structure, <bold>c</bold> description of the inhomogeneous mesh scheme used in Solcore</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig12_HTML.gif" id="MO111"/></fig></p><p id="Par63">Figure <xref rid="Fig12" ref-type="fig">12</xref>a shows the flow chart of Solcore’s PDD solver, which currently only solves the time-independent PDD equations (steady state). Any simulation starts by calculating the band structure under equilibrium conditions (no illumination or bias). If the simulation includes illumination, the photogeneration as a function of the position in the structure is calculated externally to the PDD solver using any of the models described in Sect. <xref rid="Sec11" ref-type="sec">4</xref>. To aid convergence, the solution at short circuit conditions is calculated by increasing the light intensity from zero to the nominal value in small steps. Similarly, the solution at any bias is obtained by solving the problem first at zero bias and then increasing it in small steps, using the previous solution as the initial condition for the next one. Re-meshing is performed several times during the simulation of the current-voltage characteristics (see Sect. <xref rid="Sec21" ref-type="sec">5.3.3</xref>).</p><p id="Par64">To calculate the internal quantum efficiency (IQE), a small differential increase is included in the photogeneration profile as a function of wavelength. The IQE is then calculated as the ratio between the resulting increase in the photocurrent and the increase in the photogeneration at that wavelength. This procedure is comparable to the actual experimental measurement of the quantum efficiency.</p><sec id="Sec19"><title>Solver assumptions and formulation</title><p id="Par65">The Poisson’s and drift–diffusion equations relate the electrostatic potential created by the free and fixed charges with the carrier densities and their variation across the structure due to generation, recombination and externally applied bias. The reader is referred to any semiconductor textbook for a detailed description of their derivation (see for example [<xref ref-type="bibr" rid="CR53">53</xref>] or [<xref ref-type="bibr" rid="CR54">54</xref>]). The solver uses the Boltzmann approximation for the carrier distribution with the following assumptions:<list list-type="bullet"><list-item><p id="Par66">All carrier populations are in quasi-thermal equilibrium.</p></list-item><list-item><p id="Par67">The mobility of carriers is independent of the electric field.</p></list-item><list-item><p id="Par68">Temperature is uniform.</p></list-item><list-item><p id="Par69">There are no magnetic fields.</p></list-item></list>As a consequence of the field-independent mobility, Solcore’s PDD solver will be valid only in situations where electric field is not very strong. Poisson’s equation relates the electrostatic potential <inline-formula id="IEq169"><alternatives><mml:math id="IEq169_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq169_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq169.gif"/></alternatives></inline-formula> and the electrical charges in the structure. In one dimension, it can be written as:<disp-formula id="Equ45"><label>45</label><alternatives><mml:math display="block" id="Equ45_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mi>ϵ</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\mathrm{d}}{\mathrm{d}x} \left( \epsilon \frac{\mathrm{d}\phi }{\mathrm{d}x} \right) + q \left( p - n + N_\mathrm{D} - N_\mathrm{A} \right) = 0 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ45.gif"/></alternatives></disp-formula>where <inline-formula id="IEq170"><alternatives><mml:math id="IEq170_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub></mml:math><tex-math id="IEq170_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\mathrm{A}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq170.gif"/></alternatives></inline-formula>, <inline-formula id="IEq171"><alternatives><mml:math id="IEq171_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math><tex-math id="IEq171_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\mathrm{D}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq171.gif"/></alternatives></inline-formula>, <italic>n</italic>, and <italic>p</italic> are the density of ionized acceptors, donors, the density of free electrons and holes, respectively, and <inline-formula id="IEq172"><alternatives><mml:math id="IEq172_Math"><mml:mi>ϵ</mml:mi></mml:math><tex-math id="IEq172_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq172.gif"/></alternatives></inline-formula> the dielectric constant. The current density equations account for the movement of carriers due to the electric field (drift component) and the carrier concentration gradient (diffusion component):<disp-formula id="Equ46"><label>46</label><alternatives><mml:math display="block" id="Equ46_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>q</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mi>n</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_n= &amp; {} q \mu _n \left( n F + \frac{k_b T}{q} \frac{\mathrm{d}n}{\mathrm{d}x} \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ46.gif"/></alternatives></disp-formula><disp-formula id="Equ47"><label>47</label><alternatives><mml:math display="block" id="Equ47_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>q</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mi>p</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_p= &amp; {} q \mu _p \left( p F + \frac{k_b T}{q} \frac{\mathrm{d}p}{\mathrm{d}x} \right) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ47.gif"/></alternatives></disp-formula>where <inline-formula id="IEq173"><alternatives><mml:math id="IEq173_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq173_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq173.gif"/></alternatives></inline-formula> is the carrier mobility and <inline-formula id="IEq174"><alternatives><mml:math id="IEq174_Math"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><tex-math id="IEq174_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F= - \mathrm{d} \phi / \mathrm{d}x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq174.gif"/></alternatives></inline-formula> the electric field. Finally, the continuity equations ensure particle conservation, balancing the carriers that enter and leave any point of the structure. Under steady state, this means that the variation of the current must be equal to the generation <italic>G</italic> and recombination <italic>R</italic> processes, which are equal for electrons and holes since they are created and annihilated in pairs:<disp-formula id="Equ48"><label>48</label><alternatives><mml:math display="block" id="Equ48_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\mathrm{d}J_n}{\mathrm{d}x} + q G - q R= &amp; {} 0 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ48.gif"/></alternatives></disp-formula><disp-formula id="Equ49"><label>49</label><alternatives><mml:math display="block" id="Equ49_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} -\,\frac{\mathrm{d}J_p}{\mathrm{d}x} + q G - q R= &amp; {} 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ49.gif"/></alternatives></disp-formula>Combining Eqs. <xref rid="Equ46" ref-type="disp-formula">46</xref>–<xref rid="Equ49" ref-type="disp-formula">49</xref> gives:<disp-formula id="Equ50"><label>50</label><alternatives><mml:math display="block" id="Equ50_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;q \mu _n \left( \frac{k_b T}{q} \frac{\mathrm{d}^2n}{\mathrm{d}x^2} + F \frac{\mathrm{d}n}{\mathrm{d}x} + n\frac{\mathrm{d}F}{\mathrm{d}x} \right) + q G - q R = 0 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ50.gif"/></alternatives></disp-formula><disp-formula id="Equ51"><label>51</label><alternatives><mml:math display="block" id="Equ51_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;q \mu _p \left( \frac{k_b T}{q} \frac{\mathrm{d}^2p}{\mathrm{d}x^2} - F \frac{\mathrm{d}p}{\mathrm{d}x} - p\frac{\mathrm{d}F}{\mathrm{d}x} \right) + q G - q R = 0. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ51.gif"/></alternatives></disp-formula>Poisson’s equation (Eq. <xref rid="Equ45" ref-type="disp-formula">45</xref>) and the continuity equations (Eqs. <xref rid="Equ50" ref-type="disp-formula">50</xref>, <xref rid="Equ51" ref-type="disp-formula">51</xref>), together with the definitions for <italic>n</italic>, <italic>p</italic> and <italic>R</italic>, represent the complete system that needs to be solved in order to obtain the performance of the solar cell. The PDD solver included in Solcore uses the same discretization scheme used by PC-1D [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR55">55</xref>] taking as independent variables the electrostatic potential <inline-formula id="IEq175"><alternatives><mml:math id="IEq175_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq175_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq175.gif"/></alternatives></inline-formula> and the quasi-Fermi potentials for electrons and holes, <inline-formula id="IEq176"><alternatives><mml:math id="IEq176_Math"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq176_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq176.gif"/></alternatives></inline-formula> and <inline-formula id="IEq177"><alternatives><mml:math id="IEq177_Math"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq177_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _{p}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq177.gif"/></alternatives></inline-formula>, respectively. These three variables are continuous across the whole structure and have comparable magnitudes in the voltage range. Details of the discretization process are included in [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR55">55</xref>], but they are based on minimizing the total electrostatic energy in the case of the Poisson’s equation, and in the Scharfetter–Gummel discretization scheme for the drift–diffusion equations [<xref ref-type="bibr" rid="CR56">56</xref>].</p><p id="Par70">The bulk recombination models included in Solcore are Shockley–Read–Hall recombination, radiative recombination, and Auger recombination, as well as a surface recombination velocity model for the recombination at the contacts. The three recombination models are given by the following equations, respectively:<disp-formula id="Equ52"><label>52</label><alternatives><mml:math display="block" id="Equ52_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">SRH</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm{SRH}}= &amp; {} \frac{pn-n_i^2}{\tau _n (p+n_i) + \tau _p (n+n_i)} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ52.gif"/></alternatives></disp-formula><disp-formula id="Equ53"><label>53</label><alternatives><mml:math display="block" id="Equ53_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">RAD</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm{RAD}}= &amp; {} B(pn-n_i^2) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ53.gif"/></alternatives></disp-formula><disp-formula id="Equ54"><label>54</label><alternatives><mml:math display="block" id="Equ54_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">AUG</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm{AUG}}= &amp; {} (C_n n + C_p p) (pn-n_i^2) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ54.gif"/></alternatives></disp-formula>with <inline-formula id="IEq178"><alternatives><mml:math id="IEq178_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq178_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq178.gif"/></alternatives></inline-formula> and <inline-formula id="IEq179"><alternatives><mml:math id="IEq179_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq179_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq179.gif"/></alternatives></inline-formula> the non-radiative lifetimes of electrons and holes, <italic>B</italic> the radiative recombination coefficient and <inline-formula id="IEq180"><alternatives><mml:math id="IEq180_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq180_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq180.gif"/></alternatives></inline-formula> and <inline-formula id="IEq181"><alternatives><mml:math id="IEq181_Math"><mml:msub><mml:mi>C</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq181_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq181.gif"/></alternatives></inline-formula> the Auger recombination coefficient for electrons and holes. By default, the radiative recombination coefficient is calculated internally by Solcore based on the absorption coefficient, as described by Nelson [<xref ref-type="bibr" rid="CR54">54</xref>], and given by:<disp-formula id="Equ55"><label>55</label><alternatives><mml:math display="block" id="Equ55_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B = \frac{1}{n_i^2}\frac{2 \pi }{h^3 c^2} \int _{0}^{\infty } n_s(E)^2 \alpha (E) E^2e^{ -\frac{E}{k_bT}} \mathrm{d}E \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ55.gif"/></alternatives></disp-formula>where <inline-formula id="IEq182"><alternatives><mml:math id="IEq182_Math"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq182_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq182.gif"/></alternatives></inline-formula> is the intrinsic carrier concentration, <inline-formula id="IEq183"><alternatives><mml:math id="IEq183_Math"><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq183_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq183.gif"/></alternatives></inline-formula> the refractive index and <inline-formula id="IEq184"><alternatives><mml:math id="IEq184_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq184_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq184.gif"/></alternatives></inline-formula> the absorption coefficient.</p><p id="Par71">At the moment, Solcore’s PDD solver cannot include interface charges or bandgap narrowing due to heavy doping and only implements Ohmic contacts. Additionally, it only includes local carrier recombination processes and therefore cannot deal with tunnel transport, which relates remote nodes.</p><p id="Par72">This is the only part of Solcore implemented in Fortran using quadruple precision variables in order to increase the numerical accuracy and improve convergence.</p></sec><sec id="Sec20"><title>QWs in the PDD solver</title><p id="Par73">Quantum wells have been developed in the context of solar cells mainly to tailor the absorption edge of the sub-cells in multi-junction devices to their optimum values [<xref ref-type="bibr" rid="CR57">57</xref>]. Typically, achieving the proper performance requires a delicate trade-off between carrier collection and light absorption [<xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>]. Solcore includes a simplified QW structure in the PDD solver in order to calculate the performance of solar cells containing them. Contrary to other programs like Nextnano, Solcore does not solve the Schrödinger equation and the PDD equations self-consistently: first, the energy levels of the quantum wells are solved using a flat-band condition, considering also the strain in the materials, and then an effective band structure is used to solve the transport equations in a bulk-like fashion. This is illustrated in Fig. <xref rid="Fig12" ref-type="fig">12</xref>b.</p><p id="Par74">From the perspective of the PDD solver, the actual bandgap and electron affinity of each layer in a quantum well depend on the energy levels, i.e. the minimum energy for electrons is not the band edge of the conduction band, but the ground confined level. The same applies to holes, with the actual band edge being the maximum between the ground states of light holes and heavy holes. The resulting band profiles used in the PDD solver are shown in the right picture of Fig. <xref rid="Fig12" ref-type="fig">12</xref>b.</p><p id="Par75">To use QWs in the PDD solver, we create an effective electron affinity and bandgaps for all layers in the QW. For the barriers, the electron affinity and band gap are the same as they are in bulk, modified by the strain, if necessary. For interlayers, if present, it depends on what is higher, the band edges of the interlayer or the confined carrier levels.</p><p id="Par76">The density of states and the absorption profile need to be modified in a similar way. For the density of states:<list list-type="bullet"><list-item><p id="Par77"><italic>Barriers</italic> have the bulk density of states and absorption profile.</p></list-item><list-item><p id="Par78"><italic>Interlayers</italic> only have the bulk density of states above the barrier and the bulk absorption from the barrier energy and zero below that.</p></list-item><list-item><p id="Par79"><italic>Wells</italic> have all the density of states associated with the confined states and the bulk density of states above the barrier, while they have the absorption of the confined levels below the barrier energy and of the bulk above it.</p></list-item></list>These simplifications are similar to those in Nelson et al. [<xref ref-type="bibr" rid="CR54">54</xref>] and in Cabrera et al. [<xref ref-type="bibr" rid="CR60">60</xref>] and allow us to keep the bulk-like form of the carrier densities in the drift diffusion equations under the Boltzmann approximation. A more rigorous treatment will be necessary in the presence of tunnel transport across a superlattice, tunnel escape from the QWs to the barriers—possible in the presence of high electric fields—and in the case of very deep QWs, when carrier escape from the less confined levels might be possible but not from the deeper ones. In these situations, a set of rate equations linking the different levels, as well as a self-consistent solution of the transport and Schrödinger equations would be required, besides using more advanced methods such as a non-equilibrium Green’s functions (NEGF) formalism [<xref ref-type="bibr" rid="CR61">61</xref>].</p></sec><sec id="Sec21"><title>Mesh creation and dynamic meshing</title><p id="Par80">The PDD solver discretizes the device into a finite number of mesh points at which to calculate the band structure, carrier densities, the generation and recombination. The mesh can be static and homogeneous, but the default configuration and the one that results in the least number of mesh points, most accurate result and best convergence uses an inhomogeneous mesh with dynamic re-meshing.</p><p id="Par81">There are two types of nodes in the mesh: masternodes and normal nodes. There are two masternodes at the ends of the device and two more at each side of an interface separated by 0.1 nm. These nodes are static and not affected by re-meshing. The rest of the nodes are automatically distributed depending on the distance to the closest masternode, as illustrated in Fig. <xref rid="Fig12" ref-type="fig">12</xref>c. During re-meshing, nodes can be added or removed according to the following rules:</p><p id="Par82">An element will be divided into smaller elements by adding new nodes if any of the following statements is true:<list list-type="bullet"><list-item><p id="Par83">The variation of the potentials or the carrier densities across the element is large.</p></list-item><list-item><p id="Par84">The element is too close to the masternodes limiting the layer.</p></list-item><list-item><p id="Par85">The element is too big for the region.</p></list-item></list>A node will be removed if it fulfils all the following conditions:<list list-type="bullet"><list-item><p id="Par86">It is not a masternode.</p></list-item><list-item><p id="Par87">The variation of the potentials or the carrier densities with respect the previous and next nodes is small.</p></list-item><list-item><p id="Par88">It is not too close to the masternodes limiting the layer.</p></list-item><list-item><p id="Par89">Removing it does not create an element too big for the region.</p></list-item></list>After the initial meshing and every time there is a re-meshing, the position of the nodes (except that of the masternodes) is smoothed to avoid having adjacent elements too different in size. This re-meshing process is controlled by a <italic>growth</italic> parameter, which can be adjusted by the user.</p><p id="Par90">Using the inhomogeneous mesh in addition to the dynamic re-meshing ensures that those regions where material properties change abruptly are modelled with more detail, aiding the convergence. It also allows the modelling of devices which have layers with very different thickness, such as QWs a few nanometres thick and bulk absorbers of several microns, without increasing the number of nodes significantly.</p></sec></sec><sec id="Sec22"><title>Depletion approximation</title><p id="Par91">The depletion approximation provides an analytical—or semi-analytical—solution to the Poisson–drift–diffusion equations described in the previous section applied to simple PN homojunction solar cells. Historically, it has been used extensively to model solar cells and it is still valid, to a large extent, for traditional PN junctions. More importantly, it requires less input parameters than the PDD solver and these can be easily related to macroscopic measurable quantities, like mobility or diffusion lengths. The DA model is based on the assumption that around the junction between the P and N regions, there are no free carriers and therefore all the electric field is due to the fixed, ionized dopants. This “depletion” of free carriers reaches a certain depth towards the N and P sides; beyond this region, free and fixed carriers of opposite charges balance and the regions are neutral. Under these conditions, Poisson’s equation decouples from the drift and diffusion equations and it can be solved analytically for each region. For example, for a PN junction with the interface between the two regions at <inline-formula id="IEq185"><alternatives><mml:math id="IEq185_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq185_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq185.gif"/></alternatives></inline-formula>, the solution to Eq. <xref rid="Equ45" ref-type="disp-formula">45</xref> will be:<disp-formula id="Equ56"><label>56</label><alternatives><mml:math display="block" id="Equ56_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.166667em"/><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.166667em"/><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.166667em"/><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi (z) = \left\{ \begin{array}{ll} 0 &amp;{}\quad \text{ if }\,z&lt; -w_p \\ \frac{qN_a}{2\epsilon _s}(z+w_p)^2 &amp;{}\quad \text{ if } \,-w_p&lt; z&lt; 0 \\ -\frac{qN_d}{2\epsilon _s}(z-w_n)^2 + V_\mathrm{bi} &amp;{}\quad \text{ if }\,0&lt; z&lt; w_n \\ V_{\mathrm{bi}} &amp;{}\quad \text{ if } w_n &lt; z \end{array} \right. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ56.gif"/></alternatives></disp-formula>where <inline-formula id="IEq186"><alternatives><mml:math id="IEq186_Math"><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq186_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><mml:math id="IEq187_Math"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><tex-math id="IEq187_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq187.gif"/></alternatives></inline-formula> are the extensions of the depletion region towards the N and P sides, respectively, and can be found by the requirement that the electric field <italic>F</italic> and the potential <inline-formula id="IEq188"><alternatives><mml:math id="IEq188_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq188_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq188.gif"/></alternatives></inline-formula> need to be continuous at <inline-formula id="IEq189"><alternatives><mml:math id="IEq189_Math"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq189_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq189.gif"/></alternatives></inline-formula>. <inline-formula id="IEq190"><alternatives><mml:math id="IEq190_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub></mml:math><tex-math id="IEq190_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{bi}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq190.gif"/></alternatives></inline-formula> is the built-in voltage, which can be expressed in terms of the doping concentration on each side, <inline-formula id="IEq191"><alternatives><mml:math id="IEq191_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq191_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{d}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq191.gif"/></alternatives></inline-formula> and <inline-formula id="IEq192"><alternatives><mml:math id="IEq192_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><tex-math id="IEq192_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq192.gif"/></alternatives></inline-formula>, and the intrinsic carrier concentration in the material, <inline-formula id="IEq193"><alternatives><mml:math id="IEq193_Math"><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><tex-math id="IEq193_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq193.gif"/></alternatives></inline-formula>:<disp-formula id="Equ57"><label>57</label><alternatives><mml:math display="block" id="Equ57_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">bi</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{\mathrm{bi}} = \frac{k_bT}{q} \ln \left( \frac{N_{d}N_{a}}{n_i^2} \right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ57.gif"/></alternatives></disp-formula>Another consequence of the depletion approximation is that the quasi-Fermi level energies are constant throughout the corresponding neutral regions and also constant in the depletion region, where their separation is equal to the external bias <italic>qV</italic>. Based on these assumptions, Eqs. <xref rid="Equ46" ref-type="disp-formula">46</xref> and <xref rid="Equ47" ref-type="disp-formula">47</xref> simplify and an analytical expression can be found for the dependence of the recombination and generation currents on the applied voltage. A full derivation of these expressions is included in Nelson [<xref ref-type="bibr" rid="CR54">54</xref>].</p><p id="Par92">Solcore’s implementation of the depletion approximation includes two modifications to the basic equations. The first one is allowing for an intrinsic region to be included between the P and N regions to form a PIN junction. For low injection conditions (low illumination or low bias) this situation can be treated as described before, simply considering that the depletion region is now widened by the thickness of the intrinsic region. Correctly, no low doping level is allowed for this region.</p><p id="Par93">The second modification is related to the generation profile, which in the equations provided by Nelson is given by the BL law (Eq. <xref rid="Equ20" ref-type="disp-formula">20</xref>) which has an explicit dependence on <italic>z</italic> and results in analytic expressions for the current densities. In Solcore, we integrate the expressions for the drift–diffusion equations under the depletion approximation numerically to allow for an arbitrary generation profile calculated with any of the methods described in Sect. <xref rid="Sec11" ref-type="sec">4</xref>. It should be noted that although the equations are integrated numerically this will not be a self-consistent solution of the Poisson–drift–diffusion equations, as is achieved by the PDD solver (Sect. <xref rid="Sec18" ref-type="sec">5.3</xref>).</p></sec></sec><sec id="Sec23"><title>Multi-junction solar cells</title><p id="Par94">A complete photovoltaic solar cell can include one or more junctions, metal contacts, optical layers (including anti-reflective coatings and nanophotonic structures) and tunnel junctions. The junctions, in turn, might range from simple PN homojunctions to complex heterojunctions, including multi-quantum well structures. The solvers described in Sect. <xref rid="Sec15" ref-type="sec">5</xref> only calculate the properties of single junction devices. To combine them into a multi-junction device, it is necessary to consider that the individual junctions are electrically connected in series and the potential coupling of light emitted by the wider bandgap junctions into those with smaller bandgap. The Supplementary Information includes a full step-by-step example of the modelling of a dual junction solar cell with QWs, anti-reflecting coating and a tunnel junction, calculating the external quantum efficiency, the IV characteristics under illumination and the performance of the solar cell as a function of light concentration.</p><sec id="Sec24"><title>No radiative coupling</title><p id="Par95">We first consider the case of no radiative coupling between junctions. This is a good approximation for materials which do not radiate efficiently or radiative materials working at low concentration, when the fraction of radiative recombination compared to non-radiative recombination is low. In this case, the IV curve of each junction can be calculated independently of each other and the current flowing through the MJ structure is limited by the junction with the lowest current at any given voltage. Series resistances defined for each junction are now added together and included as a single term. The operating voltage of each of the junctions is finally back-calculated and added together to get the voltage of the MJ device.</p><p id="Par96">The pseudocode for this solver is:<list list-type="order"><list-item><p id="Par97">Calculate the <inline-formula id="IEq194"><alternatives><mml:math id="IEq194_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq194_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_j(V)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq194.gif"/></alternatives></inline-formula> of each junction <italic>j</italic> in the structure.</p></list-item><list-item><p id="Par98">Find the current flowing through the MJ device as <inline-formula id="IEq195"><alternatives><mml:math id="IEq195_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="-0.166667em"/><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq195_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm{MJ}}(V)\! =\! I_j(V)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq195.gif"/></alternatives></inline-formula>, if <inline-formula id="IEq196"><alternatives><mml:math id="IEq196_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="-0.166667em"/><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>…</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq196_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|I_j(V)| \!=\! \min ([|I_1(V)|\ldots |I_N(V)|])$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq196.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par99">Calculate the voltage of each junction by interpolating its IV curve at the new current values, <inline-formula id="IEq197"><alternatives><mml:math id="IEq197_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq197_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_j(I_\mathrm{MJ})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq197.gif"/></alternatives></inline-formula>, and the voltage dropped due to the series resistances, <inline-formula id="IEq198"><alternatives><mml:math id="IEq198_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">Rs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq198_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{Rs} = R_\mathrm{s} I_{\mathrm{MJ}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq198.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par100">Calculate the total voltage at a given current as <inline-formula id="IEq199"><alternatives><mml:math id="IEq199_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">Rs</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq199_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{MJ}} = V_{Rs} + \sum _j V_j$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq199.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par101">Interpolate the <inline-formula id="IEq200"><alternatives><mml:math id="IEq200_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq200_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm{MJ}}(V_{\mathrm{MJ}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq200.gif"/></alternatives></inline-formula> and the <inline-formula id="IEq201"><alternatives><mml:math id="IEq201_Math"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">MJ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq201_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm{MJ}}(V_j)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq201.gif"/></alternatives></inline-formula> to the desired output voltage values.</p></list-item></list>Figure <xref rid="Fig13" ref-type="fig">13</xref> shows the simulated IV curve of a 3J solar cell made of Ge/InGaAs/GaAsP. The electrical properties of the three junctions were calculated using the depletion approximation solver. In the dark (Fig. <xref rid="Fig13" ref-type="fig">13</xref>a) the voltages of each of the junctions at a given current add together, resulting in the total voltage of the MJ structure. The <inline-formula id="IEq202"><alternatives><mml:math id="IEq202_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq202_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq202.gif"/></alternatives></inline-formula> contribution to the voltage goes in the same direction as those of the junctions. Under illumination (Fig. <xref rid="Fig13" ref-type="fig">13</xref>b) the junction producing the lower current (the top junction in this case) limits the overall current of the MJ device. At zero bias, or even at some negative bias, the non-limiting junctions are positively biased, recombining all the photocurrent that cannot be extracted because of the limiting top cell. The contribution of the <inline-formula id="IEq203"><alternatives><mml:math id="IEq203_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq203_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq203.gif"/></alternatives></inline-formula> to the voltage of the MJ device is negative, resulting in a reduction of the fill factor and the overall efficiency of the solar cell.<fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p><bold>a</bold> Dark IV curve of a MJ solar cell, including the IV of the individual junctions separately (continuous lines) and the junctions as part of the MJ structure, <bold>b</bold> light IV curve of the same MJ solar cell</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig13_HTML.gif" id="MO112"/></fig></p></sec><sec id="Sec25"><title>With radiative coupling</title><p id="Par102">Radiative coupling takes place when the light produced by a high bandgap junction due to radiative recombination is absorbed by a lower bandgap junction, contributing to its photocurrent and changing the operating point. It has been identified in numerous highly radiative materials such as quantum well solar cells and III–V MJ solar cells [<xref ref-type="bibr" rid="CR62">62</xref>–<xref ref-type="bibr" rid="CR64">64</xref>]. It appears as an artefact during the QE measurements of MJ solar cells [<xref ref-type="bibr" rid="CR65">65</xref>], but it is also an effect that can be exploited to increase the performance of MJ devices [<xref ref-type="bibr" rid="CR57">57</xref>] and their tolerance to spectral changes, resulting in superior annual energy yield [<xref ref-type="bibr" rid="CR66">66</xref>].</p><p id="Par103">The radiative coupling formalism included in Solcore is based on the works by Chan et al. [<xref ref-type="bibr" rid="CR66">66</xref>] and Nelson et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. It is implemented only for the DB junction model and for the 2D model when it is defined in terms of a radiative efficiency and the parameters calculated form the DB model. The current of a junction <italic>j</italic> including radiative coupling from the junction immediately above it <inline-formula id="IEq204"><alternatives><mml:math id="IEq204_Math"><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq204_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j-1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq204.gif"/></alternatives></inline-formula> is given by:<disp-formula id="Equ58"><label>58</label><alternatives><mml:math display="block" id="Equ58_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">total</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">nc</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">coupled</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_j^{\mathrm{total}} = J_j^\mathrm{nc} + J_{j-1 \rightarrow j}^{\mathrm{coupled}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ58.gif"/></alternatives></disp-formula>This current depends on two factors: the amount of radiation effectively emitted downwards, towards the lower junction, and the fraction of it that is absorbed and converted into electricity. If we ignore the possible reflection of light at the interface between both junctions, this current can be written by using a modified version of Eq. <xref rid="Equ30" ref-type="disp-formula">30</xref> that considers only the radiation emitted towards the back:<disp-formula id="Equ59"><label>59</label><alternatives><mml:math display="block" id="Equ59_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">coupled</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:msup><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} J_{j-1 \rightarrow j}^{\mathrm{coupled}}(V, T)&amp;= q \frac{2 n^2}{h^3c^2} \int _{0}^{\infty } \frac{E^2}{e^{ \frac{E - qV}{k_bT}} - 1 } A_{j-1 \rightarrow j}(E) \mathrm{d}E \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ59.gif"/></alternatives></disp-formula>with <inline-formula id="IEq205"><alternatives><mml:math id="IEq205_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq205_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j-1 \rightarrow j}(E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq205.gif"/></alternatives></inline-formula> given by:<disp-formula id="Equ60"><label>60</label><alternatives><mml:math display="block" id="Equ60_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mspace width="0.166667em"/><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>×</mml:mo><mml:mspace width="0.166667em"/><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} A_{j-1 \rightarrow j}(E)&amp;= 2\pi \int _{0}^{1} \left[ 1+r(E, \theta ) e^{-\alpha _{j-1} w_{j-1} / \cos \theta } \right] \\&amp;\quad \times \,\left( 1 - e^{-\alpha _{j-1} w_{j-1} / \cos \theta } \right) \\&amp;\quad \times \,\left( 1 - e^{-\alpha _j w_j / \cos \theta } \right) \cos \theta \mathrm{d}(\cos \theta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ60.gif"/></alternatives></disp-formula>As discussed previously, any information related to total internal reflection will be contained in the <inline-formula id="IEq206"><alternatives><mml:math id="IEq206_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq206_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r(E, \theta )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq206.gif"/></alternatives></inline-formula> term, and therefore the integral over <inline-formula id="IEq207"><alternatives><mml:math id="IEq207_Math"><mml:mrow><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math><tex-math id="IEq207_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cos \theta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq207.gif"/></alternatives></inline-formula> can be done from 0 to 1. In the case of thin junctions, some radiation could reach the next junction <inline-formula id="IEq208"><alternatives><mml:math id="IEq208_Math"><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq208_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq208.gif"/></alternatives></inline-formula>. The coupled current in that case can be easily calculated by modifying Eq. <xref rid="Equ60" ref-type="disp-formula">60</xref> to account for the fraction of light absorbed by the junctions between the emitting junction and the junction of interest. In the general case, the current coupled into junction <italic>j</italic> will be given by:<disp-formula id="Equ61"><label>61</label><alternatives><mml:math display="block" id="Equ61_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">coupled</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="normal">coupled</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{j}^{\mathrm{coupled}} = \sum _{i=1}^{j-1} J_{i \rightarrow j}^{\mathrm{coupled}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ61.gif"/></alternatives></disp-formula>Radiative coupling might change the junction that is current limiting the MJ device, so the process to obtain the IV curves in this case proceeds in two steps. First, the IV of the junctions and the total IV are calculated without coupling. The resulting IV curves are then used as the initial conditions for the numerical solver that will calculate the correct voltage of each junction including the radiative coupling.</p><p id="Par104">Figure <xref rid="Fig14" ref-type="fig">14</xref> shows the IV curve under the AM1.5G solar spectrum of a three junction solar cell (a) without and (b) with radiative coupling. Without coupling, the middle junction severely limits the current of the MJ solar cell. When coupling is enabled, the middle junction is still the limiting one but part of the excess current of the top junction is transferred to it, increasing its photocurrent by around 20 A/m<inline-formula id="IEq209"><alternatives><mml:math id="IEq209_Math"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq209_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq209.gif"/></alternatives></inline-formula>. Part of the radiative recombination is also transferred to the bottom cell, increasing slightly its photocurrent. In this case, given that the junction was overproducing current already, such coupling is only visible as an increase in the voltage. Altogether, the radiative coupling results in an enhancement of the <inline-formula id="IEq210"><alternatives><mml:math id="IEq210_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">oc</mml:mi></mml:msub></mml:math><tex-math id="IEq210_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{oc}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq210.gif"/></alternatives></inline-formula> of 30 mV and of the efficiency <inline-formula id="IEq211"><alternatives><mml:math id="IEq211_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq211_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq211.gif"/></alternatives></inline-formula> of 5.3%. This example uses junctions with 100% radiative efficiency to illustrate the effect, but this phenomenon is always present to some extent, becoming especially important under concentration [<xref ref-type="bibr" rid="CR57">57</xref>, <xref ref-type="bibr" rid="CR66">66</xref>].<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>Light IV curve of a 3J solar cell <bold>a</bold> without and <bold>b</bold> with radiative coupling. Continuous lines represent the individual IV curves of the junctions isolated and the dash lines when they are inside the MJ device, illustrating the effect of the coupling</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig14_HTML.gif" id="MO113"/></fig></p></sec><sec id="Sec26"><title>Restrictions in the junction definitions</title><p id="Par105">Having multiple methods for modelling the junctions gives a lot of freedom and flexibility but it also imposes some restrictions in how and when they can be combined in order to create a MJ solar cell. The following compatibility rules apply:<list list-type="bullet"><list-item><p id="Par106">When there is no radiative coupling and we are interested only in the dark IV characteristics, all junction models can be combined with each other. This allows a MJ device where the top junction is defined using the DB model, the middle junction is defined with the 2D model and the bottom junction uses a more accurate PDD model, for example.</p></list-item><list-item><p id="Par107">The same applies for light IV and quantum efficiency simulations as long as the optical model chosen is the BL law. In this case, any junction defined using the 2D model needs to include an absorptivity value.</p></list-item><list-item><p id="Par108">The TMM and RCWA optical models are supported only by the PDD and DA junction models.</p></list-item><list-item><p id="Par109">In the presence of radiative coupling, the only junction models that can be used are DB and 2D, as long as the latter includes an absorptivity value.</p></list-item></list></p></sec><sec id="Sec27"><title>Tunnel junctions</title><p id="Par110">Solcore includes partial support for tunnel junctions. They represent an optical loss due to parasitic absorption in the layers, but also an electrical loss. At the moment, there are two models for tunnel junctions. The first one is a simple resistive model, where the tunnel junction is simply modelled as a series resistance. This approximation should be valid in most cases, but will break down if the current is close to or higher than the peak current density of the junction.</p><p id="Par111">The second model is a parametric model, based on the simple formalism described by Sze [<xref ref-type="bibr" rid="CR53">53</xref>]. In this model, the total current of the tunnel junction will have three components: the tunnel current <inline-formula id="IEq212"><alternatives><mml:math id="IEq212_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math><tex-math id="IEq212_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_\mathrm{T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq212.gif"/></alternatives></inline-formula> accounting for band-to-band transport, the excess current <inline-formula id="IEq213"><alternatives><mml:math id="IEq213_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub></mml:math><tex-math id="IEq213_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{ex}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq213.gif"/></alternatives></inline-formula> related to transport across states inside the forbidden gap, and the diffusion current <inline-formula id="IEq214"><alternatives><mml:math id="IEq214_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:math><tex-math id="IEq214_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_\mathrm{D}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq214.gif"/></alternatives></inline-formula>, which is the usual minority-carrier injection current in PN junctions. The following equations summarize all these components.<disp-formula id="Equ62"><label>62</label><alternatives><mml:math display="block" id="Equ62_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">TJ</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{\mathrm{TJ}}= &amp; {} J_{\mathrm{T}} + J_{\mathrm{ex}} + J_\mathrm{D} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ62.gif"/></alternatives></disp-formula><disp-formula id="Equ63"><label>63</label><alternatives><mml:math display="block" id="Equ63_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mi>V</mml:mi></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>V</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{\mathrm{T}}= &amp; {} \frac{J_{\mathrm{P}} V}{V_{\mathrm{P}}} \exp {\left( 1 - \frac{V}{V_{\mathrm{P}}} \right) } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ63.gif"/></alternatives></disp-formula><disp-formula id="Equ64"><label>64</label><alternatives><mml:math display="block" id="Equ64_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{\mathrm{ex}}= &amp; {} J_{\mathrm{V}} \exp {\left[ C \left( V - V_{\mathrm{V}} \right) \right] } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ64.gif"/></alternatives></disp-formula><disp-formula id="Equ65"><label>65</label><alternatives><mml:math display="block" id="Equ65_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>J</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">qV</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J_{\mathrm{D}}= &amp; {} J_0 \left[ \exp { \left( \frac{qV}{k_b T} \right) } - 1 \right] . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ65.gif"/></alternatives></disp-formula>As illustrated in Fig. <xref rid="Fig15" ref-type="fig">15</xref>, <inline-formula id="IEq215"><alternatives><mml:math id="IEq215_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math><tex-math id="IEq215_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq215.gif"/></alternatives></inline-formula> and <inline-formula id="IEq216"><alternatives><mml:math id="IEq216_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math><tex-math id="IEq216_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq216.gif"/></alternatives></inline-formula> are the peak current and voltage, <inline-formula id="IEq217"><alternatives><mml:math id="IEq217_Math"><mml:msub><mml:mi>J</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:math><tex-math id="IEq217_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{\mathrm{V}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq217.gif"/></alternatives></inline-formula> and <inline-formula id="IEq218"><alternatives><mml:math id="IEq218_Math"><mml:msub><mml:mi>V</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:math><tex-math id="IEq218_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{\mathrm{V}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq218.gif"/></alternatives></inline-formula> are the valley current and voltages, <italic>C</italic> is a prefactor of the exponent and <inline-formula id="IEq219"><alternatives><mml:math id="IEq219_Math"><mml:msub><mml:mi>J</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq219_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq219.gif"/></alternatives></inline-formula> the reverse saturation current. In this simple implementation, these six parameters need to be provided as inputs, and can be used as fitting parameters to reproduce experimental data. This allows to correctly account for the break down of the tunnel junction in situations when the current is above the peak current.<fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>IV curve of a tunnel junction defined according to the parametric model</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig15_HTML.gif" id="MO114"/></fig><fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>Schema of the quasi-3D solar cell modelling included in Solcore. The solar cell is discretized <bold>a</bold> in the plane and <bold>b</bold> in the vertical direction. Illuminated and dark regions are then modelled using electrical components that, when combined, form a 3D electrical mesh giving the voltages and currents at any point of the structure. <bold>c</bold> An example of the vertical discretization of a N-junction solar cell</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig16_HTML.gif" id="MO115"/></fig></p><p id="Par112">Solcore can also accept external IV data for the tunnel junctions and the implementation of the more rigorous, but still analytic model, described by Louarn et al. [<xref ref-type="bibr" rid="CR67">67</xref>] is currently under way in order to relate the tunnel currents with the actual materials and layer structure used in the tunnel junction definition.</p></sec></sec><sec id="Sec28"><title>Large circuit solver</title><p id="Par113">When the two-diode model is used to define the junctions in a MJ solar cell, then larger scale circuits can be constructed. Solcore includes two levels of large-scale equivalent circuits: quasi-3D solar cell modelling and solar array modelling. Both solvers are based on the interface between Solcore and SPICE, allowing for a fast calculation of complex structures with many elements.</p><sec id="Sec29"><title>Quasi-3D solar cell model</title><p id="Par114">The quasi-3D solar cell model included in Solcore uses a SPICE-based electrical network to model the flow of injected current through the solar cell, as depicted in Fig. <xref rid="Fig16" ref-type="fig">16</xref>. The plane of the cell is discretized into many elements, each of them representing a small portion of the cell. Depending on the location of the element—exposed to the sunlight or underneath a metal finger—the IV curve of the cell will be the light IV or the dark IV. Each element is linked to their neighbours with resistors, representing the lateral current flow and dependent on the sheet resistance of the cells. This method can be applied to any number of junctions.</p><p id="Par115">This type of formalism is widely used to simulate the performance of solar cells when the effect of a spatial variable needs to be incorporated in the model. This variable can be the design of the front metal grid, in order to minimize the effect of series resistances [<xref ref-type="bibr" rid="CR68">68</xref>]; the inhomogeneous illumination profile in concentrator devices; the impact of such inhomogeneity on the transport through the tunnel junctions [<xref ref-type="bibr" rid="CR69">69</xref>, <xref ref-type="bibr" rid="CR70">70</xref>]; or the distribution of defects or inhomogeneities [<xref ref-type="bibr" rid="CR71">71</xref>, <xref ref-type="bibr" rid="CR72">72</xref>]. Recently, this formalism was used to model the photoluminescence and the electroluminescence-based IV curves of MJ devices, accounting for the limited lateral carrier transport [<xref ref-type="bibr" rid="CR73">73</xref>].</p><p id="Par116">Specifically for the modelling and optimization of the front grid of solar cells in order to minimize shading losses and series resistance, there are two packages already available: PVMOS, developed by Pieters in C and released as open source [<xref ref-type="bibr" rid="CR74">74</xref>, <xref ref-type="bibr" rid="CR75">75</xref>], and Griddler, developed by Wong using Matlab and available at PV Lighthouse [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR76">76</xref>].</p><sec id="Sec30"><title>In-plane discretization</title><p id="Par117">As shown in Fig. <xref rid="Fig16" ref-type="fig">16</xref>, there are two regions in the plane: the metal and the aperture. These two are provided to Solcore as grey scale images that will work as masks. The resolution of the images, in pixels, will define the in-plane discretization. By default, the aspect ratio of the pixels in the image will be 1:1, but this can be set to a different value in order to reduce the number of elements and improve speed. For example, the in-plane discretization of Fig. <xref rid="Fig16" ref-type="fig">16</xref>a has an aspect ratio <inline-formula id="IEq220"><alternatives><mml:math id="IEq220_Math"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq220_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_r=L_y/L_x = 4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq220.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq221"><alternatives><mml:math id="IEq221_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq221_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq221.gif"/></alternatives></inline-formula> and <inline-formula id="IEq222"><alternatives><mml:math id="IEq222_Math"><mml:msub><mml:mi>L</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><tex-math id="IEq222_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq222.gif"/></alternatives></inline-formula> the pixel size in each direction. The values of the pixels in the metal mask are 0 where there is no metal (the aperture area), 255 where there is metal and the external electrical contacts (the boundaries with fixed, externally set voltage values) and any other value in between to represent regions with metal but not fixed voltage. The pixels of the illumination mask—which become the aperture mask after removing the areas shadowed by the metal—can have any value between 0 and 255. These values divided by 255 will indicate the intensity of the sunlight at that pixel relative to the maximum intensity. Figure <xref rid="Fig17" ref-type="fig">17</xref> illustrates two examples of metal masks (a and b) and an illumination mask (c) with 120 <inline-formula id="IEq223"><alternatives><mml:math id="IEq223_Math"><mml:mo>×</mml:mo></mml:math><tex-math id="IEq223_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq223.gif"/></alternatives></inline-formula> 120 pixels. As it can be seen, while rectangular metal fingers are well reproduced, diagonal fingers are less accurate and could require a finer discretization. The illumination mask is mostly homogeneous except around the edges and in the corners, where intensity is much lower. This pattern could be produced, for example, by the secondary optics of a concentration system.</p><p id="Par118">The minimum total number of nodes where SPICE will need to calculate the voltages will be <inline-formula id="IEq224"><alternatives><mml:math id="IEq224_Math"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><tex-math id="IEq224_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\times M\times 2\times Q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq224.gif"/></alternatives></inline-formula>, with <italic>N</italic> and <italic>M</italic> the number of pixels in both in-plane directions and <italic>Q</italic> the number of junctions, which require 2 nodes each. To this, the front and back metal contacts could add a maximum of <inline-formula id="IEq225"><alternatives><mml:math id="IEq225_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq225_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2M\times M$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq225.gif"/></alternatives></inline-formula> nodes. Exploiting symmetries of the problem as well as choosing an appropriate pixel aspect ratio will significantly reduce the number of nodes and therefore the time required for the computation of the problem.<fig id="Fig17"><label>Fig. 17</label><caption xml:lang="en"><p><bold>a</bold>, <bold>b</bold> Two examples of metal masks and <bold>c</bold> an illumination mask. The thin metal fingers in (<bold>a</bold>) and (<bold>b</bold>) are grey, indicating that there is metal in those pixels but that their bias is not set to be equal to the external bias</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig17_HTML.gif" id="MO116"/></fig></p></sec><sec id="Sec31"><title>Vertical discretization</title><p id="Par119">First, the solar cell is solved as described in Sects. <xref rid="Sec15" ref-type="sec">5</xref> and <xref rid="Sec23" ref-type="sec">6</xref> in order to obtain the parameters for the 2-diode model at the given illumination conditions. These parameters are then used to replicate the 2-diode model in SPICE. The <inline-formula id="IEq226"><alternatives><mml:math id="IEq226_Math"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="normal">SC</mml:mi></mml:msub></mml:math><tex-math id="IEq226_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathrm{SC}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq226.gif"/></alternatives></inline-formula> is scaled in each pixel by the intensity of the illumination given by the illumination mask. Sheet resistances above and below each junction, <inline-formula id="IEq227"><alternatives><mml:math id="IEq227_Math"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">top</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq227_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}(\mathrm{top})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq227.gif"/></alternatives></inline-formula> and <inline-formula id="IEq228"><alternatives><mml:math id="IEq228_Math"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">bot</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq228_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}(\mathrm{bot})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq228.gif"/></alternatives></inline-formula>, account for the lateral transport. Beneath the metal, there is no current source, as the region is in the dark, and there are extra resistances accounting for the contact between the metal and the semiconductor <inline-formula id="IEq229"><alternatives><mml:math id="IEq229_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math><tex-math id="IEq229_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq229.gif"/></alternatives></inline-formula> and the transport along the metal finger <inline-formula id="IEq230"><alternatives><mml:math id="IEq230_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math><tex-math id="IEq230_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_\mathrm{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq230.gif"/></alternatives></inline-formula>  [<xref ref-type="bibr" rid="CR68">68</xref>]. Given that the pixels can be asymmetric, these resistances need to be defined in both in-plane directions, <italic>x</italic> and <italic>y</italic>:<disp-formula id="Equ66"><label>66</label><alternatives><mml:math display="block" id="Equ66_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">sh</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm{sh}}^x&amp;= \frac{1}{A_\mathrm{r}} R_{\mathrm{sh}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ66.gif"/></alternatives></disp-formula><disp-formula id="Equ67"><label>67</label><alternatives><mml:math display="block" id="Equ67_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">sh</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_{\mathrm{sh}}^y&amp;= A_\mathrm{r} R_{\mathrm{sh}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ67.gif"/></alternatives></disp-formula><disp-formula id="Equ68"><label>68</label><alternatives><mml:math display="block" id="Equ68_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>h</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_\mathrm{s}^x&amp;= \frac{1}{hA_\mathrm{r}} \rho _\mathrm{m} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ68.gif"/></alternatives></disp-formula><disp-formula id="Equ69"><label>69</label><alternatives><mml:math display="block" id="Equ69_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mi>h</mml:mi></mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_\mathrm{s}^y&amp;= \frac{A_\mathrm{r}}{h} \rho _\mathrm{m} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ69.gif"/></alternatives></disp-formula><disp-formula id="Equ70"><label>70</label><alternatives><mml:math display="block" id="Equ70_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">back</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R_\mathrm{c}&amp;= R_{\mathrm{back}} = \frac{1}{L_x^2 A_\mathrm{r}} \rho _\mathrm{c} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ70.gif"/></alternatives></disp-formula>where <italic>h</italic> is the height of the metal, <inline-formula id="IEq231"><alternatives><mml:math id="IEq231_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><tex-math id="IEq231_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _\mathrm{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq231.gif"/></alternatives></inline-formula> their linear resistivity, and <inline-formula id="IEq232"><alternatives><mml:math id="IEq232_Math"><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math><tex-math id="IEq232_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _\mathrm{c}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq232.gif"/></alternatives></inline-formula> the contact resistivity between metal and semiconductor. The sheet resistance of a stack of semiconductor layers <inline-formula id="IEq233"><alternatives><mml:math id="IEq233_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:math><tex-math id="IEq233_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq233.gif"/></alternatives></inline-formula> is equal to the combination in parallel of the individual sheet resistances. Using the single junction example of Fig. <xref rid="Fig16" ref-type="fig">16</xref>, <inline-formula id="IEq234"><alternatives><mml:math id="IEq234_Math"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">top</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq234_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}(\mathrm{top})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq234.gif"/></alternatives></inline-formula> will be given by:<disp-formula id="Equ71"><label>71</label><alternatives><mml:math display="block" id="Equ71_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">top</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">window</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">emitter</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{1}{R_{\mathrm{sh}}(\mathrm{top})} = \frac{1}{R_{\mathrm{sh}}(\mathrm{window)}} + \frac{1}{R_{\mathrm{sh}}(\mathrm{emitter)}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ71.gif"/></alternatives></disp-formula>Each of these can be estimated from the thickness of the layer <italic>d</italic>, the majority carrier mobility <inline-formula id="IEq235"><alternatives><mml:math id="IEq235_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq235_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq235.gif"/></alternatives></inline-formula> and the doping <italic>N</italic> as [<xref ref-type="bibr" rid="CR70">70</xref>]:<disp-formula id="Equ72"><label>72</label><alternatives><mml:math display="block" id="Equ72_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mi>d</mml:mi><mml:mi>μ</mml:mi><mml:mi>N</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{1}{R_{\mathrm{sh}}} = q{d}\mu N. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_Equ72.gif"/></alternatives></disp-formula>If the solar cell has been defined using only the DA and PDD junction models, this information is already available for all the layers of the structure. For junctions using the DB and two diode models, <inline-formula id="IEq236"><alternatives><mml:math id="IEq236_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">sh</mml:mi></mml:msub></mml:math><tex-math id="IEq236_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathrm{sh}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq236.gif"/></alternatives></inline-formula> will need to be provided for the top and bottom regions of each junction. Intrinsic layers will be ignored as they do not contribute to the lateral current transport.</p></sec></sec><sec id="Sec32"><title>Solar array model</title><p id="Par120">The ability to use Solcore to build a SPICE equivalent circuit allows entire PV systems to be simulated from the bottom up [<xref ref-type="bibr" rid="CR77">77</xref>]. Each photovoltaic solar cell is described using an equivalent circuit which can then be arranged in strings of series and parallel cells to represent the entire system. An example for a triple junction solar cell, complete with a bypass diode is shown in Fig. <xref rid="Fig18" ref-type="fig">18</xref>; this unit is the basic building block for a concentrator PV module [<xref ref-type="bibr" rid="CR52">52</xref>].<fig id="Fig18"><label>Fig. 18</label><caption xml:lang="en"><p>Equivalent circuit for a triple junction solar cell</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/10825_2018_1171_Fig18_HTML.gif" id="MO117"/></fig></p><p id="Par121">The diode and resistance values for the equivalent circuit are determined from solar cell testing, while the current source is evaluated by integrating the product of the spectral irradiance (estimated using an appropriate radiative transfer code, e.g. SPCTRL2 or SMARTS) and the quantum efficiency which in turn can be calculated dynamically as a function of temperature by Solcore [<xref ref-type="bibr" rid="CR78">78</xref>].</p><p id="Par122">Since the entire module (and subsequently the system) is assembled from individual solar cell components, it is possible (and indeed, necessary) to distribute the component values to accommodate for manufacturing tolerances. This enables a close match between the modelled output power and that measured experimentally and has been used to determine how both aerosols and precipitable water affect the electricity yield from concentrator PV systems [<xref ref-type="bibr" rid="CR79">79</xref>, <xref ref-type="bibr" rid="CR80">80</xref>]. Where system IV data are available, the emergence of electrical faults, (e.g. shunts or shading) can also be accounted for [<xref ref-type="bibr" rid="CR81">81</xref>].</p></sec></sec><sec id="Sec33"><title>Closing remarks</title><p id="Par123">In this article, we have described the capabilities of Solcore, a multi-scale, Python-based, modular simulation framework for semiconductor materials and solar cells. Its main strengths are:<list list-type="bullet"><list-item><p id="Par124"><italic>Flexibility</italic> Provides a variety of tools, rather than a single solution, for the study of traditional and novel semiconductor materials and devices.</p></list-item><list-item><p id="Par125"><italic>Modularity</italic> Can be expanded with new capabilities, innovative solvers and tools.</p></list-item><list-item><p id="Par126"><italic>Accessibility</italic> Not only is it open source, but it is also designed to be easy to learn and to use, serving as a teaching tool as much as a research tool.</p></list-item><list-item><p id="Par127"><italic>Rigour</italic> The physics behind every functionality are well understood and supported by numerous references, as are the approximations made in order to simplify the implementation of the problem or the interpretation of the results.</p></list-item><list-item><p id="Par128"><italic>Integrated</italic> All of Solcore’s features are designed to be compatible with one another to allow for truly multi-scale modelling in an integrated way.</p></list-item></list></p></sec></body><back><ack><title>Acknowledgements</title><p>Solcore is not the creation of a single person but the combined effort of present and past members of the Quantum Photovoltaics Group at Imperial College London. Therefore, the authors would like to thank T. Thomas, N. L. A. Chan, J. Nelson and J. Connolly, who also contributed significantly to its development. The authors will also like to acknowledge the financial support of the Engineering and Physical Science Research council (EPSRC) through the research Grant EP/M025012/1.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Gueymard, C.: “SMARTS2” [Online] (1995). <ext-link xlink:href="https://www.nrel.gov/rredc/smarts/" ext-link-type="uri">https://www.nrel.gov/rredc/smarts/</ext-link></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisenlohr</surname><given-names>J</given-names></name><name><surname>Tucher</surname><given-names>N</given-names></name><name><surname>Höhn</surname><given-names>O</given-names></name><name><surname>Hauser</surname><given-names>H</given-names></name><name><surname>Peters</surname><given-names>M</given-names></name><name><surname>Kiefel</surname><given-names>P</given-names></name><name><surname>Goldschmidt</surname><given-names>JC</given-names></name><name><surname>Bläsi</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Matrix formalism for light propagation and absorption in thick textured optical sheets</article-title><source>Opt. Express</source><year>2015</year><volume>23</volume><issue>11</issue><fpage>A502</fpage><lpage>A518</lpage><pub-id pub-id-type="doi">10.1364/OE.23.00A502</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Baker-Finch, S.C., McIntosh, K.R.: A freeware program for precise optical analysis of the front surface of a solar cell. In: 2014 IEEE 40th Photovoltaic Specialist Conference (PVSC), pp. 002 184–002 187. IEEE (2010)</mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">Basore, P.A.: PC-1D version 3: improved speed and convergence. In IEEE 20nd Photovoltaic Specialists Conference, pp. 299–302 (1991)</mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgelman</surname><given-names>M</given-names></name><name><surname>Nollet</surname><given-names>P</given-names></name><name><surname>Degrave</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Modelling polycrystalline semiconductor solar cells</article-title><source>Thin Solid Films</source><year>2000</year><volume>361–362</volume><fpage>527</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1016/S0040-6090(99)00825-1</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fell</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">A free and fast three-dimensional/two-dimensional solar cell simulator featuring conductive boundary and quasi-neutrality approximations</article-title><source>IEEE Trans. Electron Devices</source><year>2013</year><volume>60</volume><issue>2</issue><fpage>733</fpage><lpage>738</lpage><pub-id pub-id-type="doi">10.1109/TED.2012.2231415</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varache</surname><given-names>R</given-names></name><name><surname>Leendertz</surname><given-names>C</given-names></name><name><surname>Gueunier-Farret</surname><given-names>M</given-names></name><name><surname>Haschke</surname><given-names>J</given-names></name><name><surname>Muñoz</surname><given-names>D</given-names></name><name><surname>Korte</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Investigation of selective junctions using a newly developed tunnel current model for solar cell applications</article-title><source>Sol. Energy Mater. Sol. Cells</source><year>2015</year><volume>141</volume><issue>Supplement C</issue><fpage>14</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2015.05.014</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birner</surname><given-names>S</given-names></name><name><surname>Zibold</surname><given-names>T</given-names></name><name><surname>Andlauer</surname><given-names>T</given-names></name><name><surname>Kubis</surname><given-names>T</given-names></name><name><surname>Sabathil</surname><given-names>M</given-names></name><name><surname>Trellakis</surname><given-names>A</given-names></name><name><surname>Vogl</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">nextnano: general purpose 3-D simulations</article-title><source>IEEE Trans. Electron Devices</source><year>2007</year><volume>54</volume><issue>9</issue><fpage>2137</fpage><lpage>2142</lpage><pub-id pub-id-type="doi">10.1109/TED.2007.902871</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Silvaco, “Atlas: Device Simulation Framework” (2017)</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Synopsis, “Sentaurus Device” (2017)</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">P. L. team and contributors. PV Lightouse. [Online] (2018). <ext-link xlink:href="http://www.pvlighthouse.com.au" ext-link-type="uri">http://www.pvlighthouse.com.au</ext-link></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Andrews, R.W., Stein, J.S., Hansen, C.: Introduction to the open source PV LIB for python Photovoltaic system modelling package. In: 2016 IEEE 43rd Photovoltaic Specialists Conference (PVSC), pp. 0170–0174 (2014)</mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="other">Connolly, J.P.: Analytical models of bulk and quantum well solar cells and relevance of the radiative limit. In: Fara, L., Yamaguchi, M. (eds.) Advanced Solar Cell Materials, Technology, Modelling, and Simulation, chap. 5, pp. 59–77. IGI Global, Hershey, PA (2013). <ext-link xlink:href="10.4018/978-1-4666-1927-2" ext-link-type="doi">https://doi.org/10.4018/978-1-4666-1927-2</ext-link></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">Alonso-Álvarez, D., Wilson, T., Pearce, P., Führer, M., Farrell, D., Ekins-Daukes, N.J.: Solocre Code Repository. [Online] (2018). <ext-link xlink:href="http://doi.org/10.5281/zenodo.1185316" ext-link-type="uri">http://doi.org/10.5281/zenodo.1185316</ext-link></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vurgaftman</surname><given-names>I</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Ram-Mohan</surname><given-names>LR</given-names></name></person-group><article-title xml:lang="en">Band parameters for III–V compound semiconductors and their alloys</article-title><source>J. Appl. Phys.</source><year>2001</year><volume>89</volume><issue>11</issue><fpage>5815</fpage><lpage>5875</lpage><pub-id pub-id-type="doi">10.1063/1.1368156</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Levinshtein, M., Rumyantsev, S., Shur, M., Levinshtein, M., Rumyantsev, S., Shur, M.: Handbook Series on Semiconductor Parameters, ser. Volume 2: Ternary and Quaternary III-V Compounds, vol. 2. World Scientific, Singapore (2012)</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sotoodeh</surname><given-names>M</given-names></name><name><surname>Khalid</surname><given-names>AH</given-names></name><name><surname>Rezazadeh</surname><given-names>AA</given-names></name></person-group><article-title xml:lang="en">Empirical low-field mobility model for III–V compounds applicable in device simulation codes</article-title><source>J. Appl. Phys.</source><year>2000</year><volume>87</volume><issue>6</issue><fpage>2890-12</fpage><pub-id pub-id-type="doi">10.1063/1.372274</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Software Spectra Inc., “Optical Data from Sopra S. A.” (2008)</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paxman</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>J</given-names></name><name><surname>Braun</surname><given-names>B</given-names></name><name><surname>Connolly</surname><given-names>J</given-names></name><name><surname>Barnham</surname><given-names>KWJ</given-names></name><name><surname>Foxon</surname><given-names>CT</given-names></name><name><surname>Roberts</surname><given-names>JS</given-names></name></person-group><article-title xml:lang="en">Modeling the spectral response of the quantum well solar cell</article-title><source>J. Appl. Phys.</source><year>1993</year><volume>74</volume><issue>1</issue><fpage>614</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.1063/1.355275</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>J</given-names></name><name><surname>Barnes</surname><given-names>J</given-names></name><name><surname>Ekins-Daukes</surname><given-names>N</given-names></name><name><surname>Kluftinger</surname><given-names>B</given-names></name><name><surname>Tsui</surname><given-names>E</given-names></name><name><surname>Barnham</surname><given-names>K</given-names></name><name><surname>Foxon</surname><given-names>CT</given-names></name><name><surname>Cheng</surname><given-names>T</given-names></name><name><surname>Roberts</surname><given-names>JS</given-names></name></person-group><article-title xml:lang="en">Observation of suppressed radiative recombination in single quantum well p–i–n photodiodes</article-title><source>J. Appl. Phys.</source><year>1997</year><volume>82</volume><issue>12</issue><fpage>6240</fpage><lpage>6246</lpage><pub-id pub-id-type="doi">10.1063/1.366510</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>J</given-names></name><name><surname>Ballard</surname><given-names>I</given-names></name><name><surname>Barnham</surname><given-names>K</given-names></name><name><surname>Connolly</surname><given-names>JP</given-names></name><name><surname>Roberts</surname><given-names>JS</given-names></name><name><surname>Pate</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Effect of quantum well location on single quantum well p–i–n photodiode dark currents</article-title><source>J. Appl. Phys.</source><year>1999</year><volume>86</volume><issue>10</issue><fpage>5898</fpage><lpage>5905</lpage><pub-id pub-id-type="doi">10.1063/1.371609</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Fuhrer, M.F., Adams, J.G.J., Barnham, K.W.J., Browne, B.C., Chan, N.L.A., Farrell, D.J., Hirst, L., Lee, K.-H., Ekins-Daukes, N.J., Ogura, A., Yoshida, K., Okada, Y.: Extensible modelling framework for nanostructured III–V solar cells. In: 2011 37th IEEE Photovoltaic Specialists Conference (PVSC), pp. 002 615–002 618 (2011)</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Führer, M., Farrell, D., Ekins-Daukes, N.: CPV modelling with Solcore: an extensible modelling framework for the rapid computational simulation and evaluation of solar cell designs and concepts. In: 9th International Conference on Concentrator Photovoltaic Systems: CPV-9, pp. 34–37. AIP (2014)</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomić</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Electronic structure of InyGa1-yAs1-xNx/GaAs(N) quantum dots by ten-band kp theory</article-title><source>Phys. Rev. B</source><year>2006</year><volume>73</volume><issue>12</issue><fpage>125348</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.73.125348</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volk</surname><given-names>M</given-names></name><name><surname>Lutgen</surname><given-names>S</given-names></name><name><surname>Marschner</surname><given-names>T</given-names></name><name><surname>Stolz</surname><given-names>W</given-names></name><name><surname>Göbel</surname><given-names>EO</given-names></name><name><surname>Christianen</surname><given-names>PCM</given-names></name><name><surname>Maan</surname><given-names>JC</given-names></name></person-group><article-title xml:lang="en">Carrier effective masses in symmetrically strained (GaIn)As/Ga(PAs) multiple-quantum-well structures</article-title><source>Phys. Rev. B</source><year>1995</year><volume>52</volume><issue>15</issue><fpage>11 096</fpage><lpage>11 104</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.52.11096</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frensley</surname><given-names>WR</given-names></name></person-group><article-title xml:lang="en">Numerical evaluation of resonant states</article-title><source>Superlattices Microstruct.</source><year>1992</year><volume>11</volume><issue>3</issue><fpage>347</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1016/0749-6036(92)90396-M</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adachi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Model dielectric constants of GaP, GaAs, GaSb, InP, InAs, and InSb</article-title><source>Phys. Rev. B</source><year>1987</year><volume>35</volume><issue>14</issue><fpage>7454</fpage><lpage>7463</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.35.7454</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adachi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Optical dispersion relations for GaP, GaAs, GaSb, InP, InAs, InSb, Al<inline-formula id="IEq243"><alternatives><mml:math id="IEq243_Math"><mml:msub><mml:mrow/><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq243_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq243.gif"/></alternatives></inline-formula>Ga<inline-formula id="IEq244"><alternatives><mml:math id="IEq244_Math"><mml:msub><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq244_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{1-x}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq244.gif"/></alternatives></inline-formula>As, and In<inline-formula id="IEq245"><alternatives><mml:math id="IEq245_Math"><mml:msub><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq245_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{1-x}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq245.gif"/></alternatives></inline-formula>Ga<inline-formula id="IEq246"><alternatives><mml:math id="IEq246_Math"><mml:msub><mml:mrow/><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq246_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq246.gif"/></alternatives></inline-formula>As<inline-formula id="IEq247"><alternatives><mml:math id="IEq247_Math"><mml:msub><mml:mrow/><mml:mi>y</mml:mi></mml:msub></mml:math><tex-math id="IEq247_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq247.gif"/></alternatives></inline-formula>P<inline-formula id="IEq248"><alternatives><mml:math id="IEq248_Math"><mml:msub><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq248_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{1-y}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq248.gif"/></alternatives></inline-formula></article-title><source>J. Appl. Phys.</source><year>1989</year><volume>66</volume><issue>12</issue><fpage>6030</fpage><lpage>6040</lpage><pub-id pub-id-type="doi">10.1063/1.343580</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adachi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Optical dispersion relations for Si and Ge</article-title><source>J. Appl. Phys.</source><year>1989</year><volume>66</volume><issue>7</issue><fpage>3224</fpage><lpage>3231</lpage><pub-id pub-id-type="doi">10.1063/1.344140</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rakić</surname><given-names>AD</given-names></name><name><surname>Majewski</surname><given-names>ML</given-names></name></person-group><article-title xml:lang="en">Modeling the optical dielectric function of GaAs and AlAs: extension of Adachi’s model</article-title><source>J. Appl. Phys.</source><year>1996</year><volume>80</volume><issue>10</issue><fpage>5909</fpage><lpage>5914</lpage><pub-id pub-id-type="doi">10.1063/1.363586</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>CC</given-names></name><name><surname>Garland</surname><given-names>JW</given-names></name><name><surname>Abad</surname><given-names>H</given-names></name><name><surname>Raccah</surname><given-names>PM</given-names></name></person-group><article-title xml:lang="en">Modeling the optical dielectric function of semiconductors: extension of the critical-point parabolic-band approximation</article-title><source>Phys. Rev. B</source><year>1992</year><volume>45</volume><issue>20</issue><fpage>11 749</fpage><lpage>11 767</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.45.11749</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>CC</given-names></name><name><surname>Garland</surname><given-names>JW</given-names></name><name><surname>Raccah</surname><given-names>PM</given-names></name></person-group><article-title xml:lang="en">Modeling the optical dielectric function of the alloy system AlxGa1-xAs</article-title><source>Phys. Rev. B</source><year>1993</year><volume>47</volume><issue>4</issue><fpage>1876</fpage><lpage>1888</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.47.1876</pub-id></mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Woollam, J.A.: Guide to using WVASE 32: spectroscopic ellipsometry data acquisition and analysis software. J. A. Woollam Company (2008). <ext-link xlink:href="https://books.google.co.uk/books?id=xOupYgEACAAJ" ext-link-type="uri">https://books.google.co.uk/books?id=xOupYgEACAAJ</ext-link></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="other">Palik, E.D.: Gallium Arsenide (GaAs). In: Handbook of Optical Constants of Solids, pp. 429–443. Elsevier, Amsterdam (1997)</mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Wilson, T., Mellor, A., Hylton, N.P., Ekins-Daukes, N.J.: The effects of short-range alloy disorder on the potential voltage performance in GaAsBi based solar cells. In: Proceedings of the 33rd European Photovoltaic Solar Energy Conference and Exhibition (2017)</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chuang</surname><given-names>SL</given-names></name></person-group><source>Physics of Optoelectronic Devices</source><year>1995</year><publisher-loc>New York</publisher-loc><publisher-name>Wiley-Interscience</publisher-name></mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="book"><person-group person-group-type="editor"><name><surname>Barnham</surname><given-names>K</given-names></name><name><surname>Vvedensky</surname><given-names>D</given-names></name></person-group><source>Low-Dimensional Semiconductor Structures: Fundamentals and Device Applications</source><year>2001</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klipstein</surname><given-names>PC</given-names></name><name><surname>Apsley</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">A theory for the electroreflectance spectra of quantum well structures</article-title><source>J. Phys. C Solid State Phys.</source><year>2000</year><volume>19</volume><issue>32</issue><fpage>6461</fpage><lpage>6478</lpage><pub-id pub-id-type="doi">10.1088/0022-3719/19/32/020</pub-id></mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galleano</surname><given-names>R</given-names></name><name><surname>Zaaiman</surname><given-names>W</given-names></name><name><surname>Alonso-Álvarez</surname><given-names>D</given-names></name><name><surname>Minuto</surname><given-names>A</given-names></name><name><surname>Ferretti</surname><given-names>N</given-names></name><name><surname>Fucci</surname><given-names>R</given-names></name><name><surname>Pravettoni</surname><given-names>M</given-names></name><name><surname>Halwachs</surname><given-names>M</given-names></name><name><surname>Friederichs</surname><given-names>M</given-names></name><name><surname>Plag</surname><given-names>F</given-names></name><name><surname>Friedrich</surname><given-names>D</given-names></name><name><surname>Haverkamp</surname><given-names>E</given-names></name></person-group><article-title xml:lang="en">Results of the fifth international spectroradiometer comparison for improved solar spectral irradiance measurements and related impact on reference solar cell calibration</article-title><source>IEEE J. Photovolt.</source><year>2016</year><volume>6</volume><issue>6</issue><fpage>1587</fpage><lpage>1597</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2016.2606698</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other">Alonso-Álvarez, D., Wilsond, D., Pearce, P., Führer, M., Farrell, D., Ekins-Daukes, N.J.: Supplementary Information—Solcore: a multi-scale, Python-based library for modelling solar cells and semiconductor materials. J. Comput. Electron., vol. Supplementary Information (2018)</mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>T</given-names></name><name><surname>Thomas</surname><given-names>T</given-names></name><name><surname>Führer</surname><given-names>M</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">Addressing reflectivity losses in multi-junction solar cells to achieve 50 conversion efficiency</article-title><source>Mater. Res. Innov.</source><year>2016</year><volume>19</volume><issue>7</issue><fpage>503</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1080/14328917.2015.1115630</pub-id></mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso-Álvarez</surname><given-names>D</given-names></name><name><surname>Ferre Llin</surname><given-names>L</given-names></name><name><surname>Mellor</surname><given-names>A</given-names></name><name><surname>Paul</surname><given-names>DJ</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">ITO and AZO films for low emissivity coatings in hybrid photovoltaic-thermal applications</article-title><source>Sol. Energy</source><year>2017</year><volume>155</volume><fpage>82</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.solener.2017.06.033</pub-id></mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Macleod</surname><given-names>HA</given-names></name></person-group><source>Thin-Film Optical Filters</source><year>2001</year><publisher-loc>Bristol</publisher-loc><publisher-name>Institute of Physics Publishing</publisher-name><pub-id pub-id-type="doi">10.1201/9781420033236</pub-id></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">Byrnes, S.J.: Multilayer Optical Calculations. <ext-link xlink:href="https://arxiv.org/abs/1603.02720v2" ext-link-type="uri">https://arxiv.org/abs/1603.02720v2</ext-link> (2016)</mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>V</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">S4: a free electromagnetic solver for layered periodic structures</article-title><source>Comput. Phys. Commun.</source><year>2012</year><volume>183</volume><issue>10</issue><fpage>2233</fpage><lpage>2244</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2950374</pub-id><pub-id pub-id-type="doi">10.1016/j.cpc.2012.04.026</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1296.78002</pub-id></mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hylton</surname><given-names>NP</given-names></name><name><surname>Li</surname><given-names>XF</given-names></name><name><surname>Giannini</surname><given-names>V</given-names></name><name><surname>Lee</surname><given-names>KH</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name><name><surname>Loo</surname><given-names>J</given-names></name><name><surname>Vercruysse</surname><given-names>D</given-names></name><name><surname>Van Dorpe</surname><given-names>P</given-names></name><name><surname>Sodabanlu</surname><given-names>H</given-names></name><name><surname>Sugiyama</surname><given-names>M</given-names></name><name><surname>Maier</surname><given-names>SA</given-names></name></person-group><article-title xml:lang="en">Loss mitigation in plasmonic solar cells: aluminium nanoparticles for broadband photocurrent enhancements in GaAs photodiodes</article-title><source>Sci. Rep.</source><year>2013</year><volume>3</volume><issue>1</issue><fpage>2874</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/srep02874</pub-id></mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mellor</surname><given-names>A</given-names></name><name><surname>Hylton</surname><given-names>NP</given-names></name><name><surname>Maier</surname><given-names>SA</given-names></name><name><surname>Ekins-Daukes</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Interstitial light-trapping design for multi-junction solar cells</article-title><source>Sol. Energy Mater. Solar Cells</source><year>2017</year><volume>159</volume><fpage>212</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1016/j.solmat.2016.09.005</pub-id></mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martí</surname><given-names>A</given-names></name><name><surname>Araújo</surname><given-names>GL</given-names></name></person-group><article-title xml:lang="en">Limiting efficiencies for photovoltaic energy conversion in multigap systems</article-title><source>Sol. Energy Mater. Sol. Cells</source><year>1996</year><volume>43</volume><issue>2</issue><fpage>203</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1016/0927-0248(96)00015-3</pub-id></mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>NLA</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name><name><surname>Adams</surname><given-names>JGJ</given-names></name><name><surname>Lumb</surname><given-names>MP</given-names></name><name><surname>Gonzalez</surname><given-names>M</given-names></name><name><surname>Jenkins</surname><given-names>PP</given-names></name><name><surname>Vurgaftman</surname><given-names>I</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Walters</surname><given-names>RJ</given-names></name></person-group><article-title xml:lang="en">Optimal bandgap combinations—does material quality matter?</article-title><source>IEEE J. Photovolt.</source><year>2012</year><volume>2</volume><issue>2</issue><fpage>202</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2011.2180513</pub-id></mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>MA</given-names></name></person-group><article-title xml:lang="en">Radiative efficiency of state-of-the-art photovoltaic cells</article-title><source>Prog. Photovolt. Res. Appl.</source><year>2011</year><volume>20</volume><issue>4</issue><fpage>472</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1002/pip.1147</pub-id></mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>T</given-names></name><name><surname>Mellor</surname><given-names>A</given-names></name><name><surname>Hylton</surname><given-names>NP</given-names></name><name><surname>Führer</surname><given-names>M</given-names></name><name><surname>Alonso-Álvarez</surname><given-names>D</given-names></name><name><surname>Braun</surname><given-names>A</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name><name><surname>David</surname><given-names>JPR</given-names></name><name><surname>Sweeney</surname><given-names>SJ</given-names></name></person-group><article-title xml:lang="en">Requirements for a GaAsBi 1 eV sub-cell in a GaAs-based multi-junction solar cell</article-title><source>Semicond. Sci. Technol.</source><year>2015</year><volume>30</volume><issue>9</issue><fpage>094010-6</fpage><pub-id pub-id-type="doi">10.1088/0268-1242/30/9/094010</pub-id></mixed-citation></ref><ref id="CR52"><label>52.</label><mixed-citation publication-type="other">Ekins-Daukes, N.J., Kemmoku, Y., Araki, K., Betts, T.R., Gottschalg, R., Infield, D.G., Yamaguchi, M.: The design specification for Syracuse; a multi-junction concentrator system computer model. In: Proceedings of the 19th European Photovoltaic Solar Energy Conference, pp. 1–4 (2004)</mixed-citation></ref><ref id="CR53"><label>53.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sze</surname><given-names>SM</given-names></name></person-group><source>Physics of Semiconductor Devices</source><year>1981</year><edition>2</edition><publisher-loc>New York, NY</publisher-loc><publisher-name>Wiley</publisher-name></mixed-citation></ref><ref id="CR54"><label>54.</label><mixed-citation publication-type="other">Nelson, J.: The Physics of Solar Cells. Imperial College Press, London; River Edge, NJ: Distributed by World Scientific Pub. Co, (2003)</mixed-citation></ref><ref id="CR55"><label>55.</label><mixed-citation publication-type="other">Basore, P.A.: PC-1D Installation Manual and User’s Guide Version 3.1, pp. 1–96 (2009)</mixed-citation></ref><ref id="CR56"><label>56.</label><mixed-citation publication-type="other">Farrell, P.A., Gartland, E.C.: On the Sharfetter–Gummer discretization for drift–diffusion continuity equations. In: Miller, J.J.H. (ed.) Computational Methods for Boundary and Interior Layers in Several Dimensions, pp. 51–79 (1991)</mixed-citation></ref><ref id="CR57"><label>57.</label><mixed-citation publication-type="other">Thomas, T., Wilson, T., Führer, M., Alonso-Álvarez, D., Ekins-Daukes, N.J., Lackner, D., Kailuweit, P., Philipps, S.P., Bett, A.W., Toprasertpong, K., Sugiyama, M., Okada, Y.: Potential for reaching 50% power conversion efficiency using quantum heterostructures. In: 6th World Conference on Photovoltaic Energy Conversion, pp. 1–2 (2014)</mixed-citation></ref><ref id="CR58"><label>58.</label><mixed-citation publication-type="other">Alonso-Álvarez, D., Führer, M., Thomas, T., Ekins-Daukes, N.: Elements of modelling and design of multi-quantum well solar cells. In: 2014 IEEE 40th Photovoltaic Specialists Conference (PVSC), pp. 2865–2870 (2014)</mixed-citation></ref><ref id="CR59"><label>59.</label><mixed-citation publication-type="other">Alonso-Álvarez, D., Ekins-Daukes, N.J.: Quantum wells for high-efficiency photovoltaics. In: Freundlich, A., Lombez, L., Sugiyama, M. (eds.) Physics, Simulation, and Photonic Engineering of Photovoltaic Devices V, vol. 9743, p. 974311. SPIE OPTO, San Francisco, CA (2016). <ext-link xlink:href="10.1117/12.2217590" ext-link-type="doi">https://doi.org/10.1117/12.2217590</ext-link></mixed-citation></ref><ref id="CR60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabrera</surname><given-names>CI</given-names></name><name><surname>Rimada</surname><given-names>JC</given-names></name><name><surname>Connolly</surname><given-names>JP</given-names></name><name><surname>Hernandez</surname><given-names>L</given-names></name></person-group><article-title xml:lang="en">Modelling of GaAsP/InGaAs/GaAs strain-balanced multiple-quantum well solar cells</article-title><source>J. Appl. Phys.</source><year>2013</year><volume>113</volume><issue>2</issue><fpage>024512-7</fpage><pub-id pub-id-type="doi">10.1063/1.4775404</pub-id></mixed-citation></ref><ref id="CR61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aeberhard</surname><given-names>U</given-names></name></person-group><article-title xml:lang="en">Quantum-kinetic perspective on photovoltaic device operation in nanostructure-based solar cells</article-title><source>J. Mater. Res.</source><year>2018</year><volume>33</volume><fpage>373</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1557/jmr.2017.468</pub-id></mixed-citation></ref><ref id="CR62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>K-H</given-names></name><name><surname>Barnham</surname><given-names>KWJ</given-names></name><name><surname>Connolly</surname><given-names>JP</given-names></name><name><surname>Browne</surname><given-names>BC</given-names></name><name><surname>Airey</surname><given-names>RJ</given-names></name><name><surname>Roberts</surname><given-names>JS</given-names></name><name><surname>Führer</surname><given-names>M</given-names></name><name><surname>Tibbits</surname><given-names>TND</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">Demonstration of photon coupling in dual multiple-quantum-well solar cells</article-title><source>IEEE J. Photovolt.</source><year>2012</year><volume>2</volume><issue>1</issue><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2011.2177444</pub-id></mixed-citation></ref><ref id="CR63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>MA</given-names></name><name><surname>Geisz</surname><given-names>JF</given-names></name><name><surname>Moriarty</surname><given-names>TE</given-names></name><name><surname>France</surname><given-names>RM</given-names></name><name><surname>McMahon</surname><given-names>WE</given-names></name><name><surname>Olson</surname><given-names>JM</given-names></name><name><surname>Kurtz</surname><given-names>SR</given-names></name><name><surname>Friedman</surname><given-names>DJ</given-names></name></person-group><article-title xml:lang="en">Measuring IV curves and subcell photocurrents in the presence of luminescent coupling</article-title><source>IEEE J. Photovolt.</source><year>2013</year><volume>3</volume><issue>2</issue><fpage>879</fpage><lpage>887</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2012.2228298</pub-id></mixed-citation></ref><ref id="CR64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>MA</given-names></name><name><surname>Geisz</surname><given-names>JF</given-names></name></person-group><article-title xml:lang="en">Non-linear luminescent coupling in series-connected multijunction solar cells</article-title><source>Appl. Phys. Lett.</source><year>2012</year><volume>100</volume><issue>25</issue><fpage>251106-5</fpage><pub-id pub-id-type="doi">10.1063/1.4729827</pub-id></mixed-citation></ref><ref id="CR65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>MA</given-names></name><name><surname>Kurtz</surname><given-names>SR</given-names></name><name><surname>Geisz</surname><given-names>JF</given-names></name><name><surname>McMahon</surname><given-names>WE</given-names></name><name><surname>Olson</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">Using phase effects to understand measurements of the quantum efficiency and related luminescent coupling in a multijunction solar cell</article-title><source>IEEE J. Photovolt.</source><year>2012</year><volume>2</volume><issue>4</issue><fpage>424</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2012.2206566</pub-id></mixed-citation></ref><ref id="CR66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>NLA</given-names></name><name><surname>Thomas</surname><given-names>T</given-names></name><name><surname>Führer</surname><given-names>M</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">Practical limits of multijunction solar cell performance enhancement from radiative coupling considering realistic spectral conditions</article-title><source>IEEE J. Photovolt.</source><year>2014</year><volume>4</volume><issue>5</issue><fpage>1306</fpage><lpage>1313</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2014.2337520</pub-id></mixed-citation></ref><ref id="CR67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louarn</surname><given-names>K</given-names></name><name><surname>Fontaine</surname><given-names>C</given-names></name><name><surname>Arnoult</surname><given-names>A</given-names></name><name><surname>Olivié</surname><given-names>F</given-names></name><name><surname>Lacoste</surname><given-names>G</given-names></name><name><surname>Piquemal</surname><given-names>F</given-names></name><name><surname>Bounouh</surname><given-names>A</given-names></name><name><surname>Almuneau</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Modelling of interband transitions in GaAs tunnel diode</article-title><source>Semicond. Sci. Technol.</source><year>2016</year><volume>31</volume><issue>6</issue><fpage>06LT01-6</fpage><pub-id pub-id-type="doi">10.1088/0268-1242/31/6/06LT01</pub-id></mixed-citation></ref><ref id="CR68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>M</given-names></name><name><surname>Philipps</surname><given-names>SP</given-names></name><name><surname>Hermle</surname><given-names>M</given-names></name><name><surname>Bett</surname><given-names>AW</given-names></name><name><surname>Dimroth</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Validated front contact grid simulation for GaAs solar cells under concentrated sunlight</article-title><source>Prog. Photovolt. Res. Appl.</source><year>2010</year><volume>19</volume><issue>1</issue><fpage>73</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1002/pip.989</pub-id></mixed-citation></ref><ref id="CR69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishioka</surname><given-names>K</given-names></name><name><surname>Takamoto</surname><given-names>T</given-names></name><name><surname>Agui</surname><given-names>T</given-names></name><name><surname>Kaneiwa</surname><given-names>M</given-names></name><name><surname>Uraoka</surname><given-names>Y</given-names></name><name><surname>Fuyuki</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Evaluation of InGaP/InGaAs/Ge triple-junction solar cell under concentrated light by simulation program with integrated circuit emphasis</article-title><source>Jpn. J. Appl. Phys.</source><year>2004</year><volume>43</volume><issue>3</issue><fpage>882</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.1143/JJAP.43.882</pub-id></mixed-citation></ref><ref id="CR70"><label>70.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steiner</surname><given-names>M</given-names></name><name><surname>Guter</surname><given-names>W</given-names></name><name><surname>Peharz</surname><given-names>G</given-names></name><name><surname>Philipps</surname><given-names>SP</given-names></name><name><surname>Dimroth</surname><given-names>F</given-names></name><name><surname>Bett</surname><given-names>AW</given-names></name></person-group><article-title xml:lang="en">A validated SPICE network simulation study on improving tunnel diodes by introducing lateral conduction layers</article-title><source>Prog. Photovolt. Res. Appl.</source><year>2011</year><volume>20</volume><issue>3</issue><fpage>274</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1002/pip.1133</pub-id></mixed-citation></ref><ref id="CR71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jürgens</surname><given-names>T</given-names></name><name><surname>Gütay</surname><given-names>L</given-names></name><name><surname>Bauer</surname><given-names>GH</given-names></name></person-group><article-title xml:lang="en">Photoluminescence, open circuit voltage, and photocurrents in Cu(In, Ga)Se2 solar cells with lateral submicron resolution</article-title><source>Thin Solid Films</source><year>2006</year><volume>511–512</volume><fpage>678</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1016/j.tsf.2005.11.065</pub-id></mixed-citation></ref><ref id="CR72"><label>72.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paire</surname><given-names>M</given-names></name><name><surname>Lombez</surname><given-names>L</given-names></name><name><surname>Guillemoles</surname><given-names>J-F</given-names></name><name><surname>Lincot</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Measuring sheet resistance of CIGS solar cell’s window layer by spatially resolved electroluminescence imaging</article-title><source>Thin Solid Films</source><year>2011</year><volume>519</volume><issue>21</issue><fpage>7493</fpage><lpage>7496</lpage><pub-id pub-id-type="doi">10.1016/j.tsf.2010.12.214</pub-id></mixed-citation></ref><ref id="CR73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso-Álvarez</surname><given-names>D</given-names></name><name><surname>Ekins-Daukes</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">SPICE modelling of photoluminescence and electroluminescence based current-voltage curves of solar cells for concentration applications</article-title><source>J. Green Eng.</source><year>2016</year><volume>5</volume><issue>4</issue><fpage>33</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.13052/jge1904-4720.5343</pub-id></mixed-citation></ref><ref id="CR74"><label>74.</label><mixed-citation publication-type="other">Pieters, B.E.: A free and open source finite-difference simulation tool for solar modules. In: 2014 IEEE 40th Photovoltaic Specialist Conference. PVSC 2014, pp. 1370–1375 (2014)</mixed-citation></ref><ref id="CR75"><label>75.</label><mixed-citation publication-type="other">Pieters, B.E.: PVMOS Code Repository. [Online] (2018). <ext-link xlink:href="https://github.com/IEK-5/PVMOS" ext-link-type="uri">https://github.com/IEK-5/PVMOS</ext-link></mixed-citation></ref><ref id="CR76"><label>76.</label><mixed-citation publication-type="other">Wong, J.: Griddler: intelligent computer aided design of complex solar cell metallization patterns. In: 2013 IEEE 39th Photovoltaic Specialists Conference (PVSC), pp. 0933–0938 (2013)</mixed-citation></ref><ref id="CR77"><label>77.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Castaner</surname><given-names>L</given-names></name><name><surname>Silvestre</surname><given-names>S</given-names></name></person-group><source>Modelling PV-Systems Using PSPice</source><year>2002</year><publisher-loc>New York</publisher-loc><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/0470855541</pub-id></mixed-citation></ref><ref id="CR78"><label>78.</label><mixed-citation publication-type="other">Ekins-Daukes, N.J., Betts, T.R., Kemmoku, Y., Araki, K., Lee, H.S., Gottschalg, R., Boreland, M.B., Infield, D.G., Yamaguchi, M.: Syracuse—a multi-junction concentrator system computer model. In: Proceedings of the 31st IEEE Photovoltaic Specialists Conference, pp. 651–654 (2005)</mixed-citation></ref><ref id="CR79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>NLA</given-names></name><name><surname>Young</surname><given-names>TB</given-names></name><name><surname>Brindley</surname><given-names>HE</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name><name><surname>Araki</surname><given-names>K</given-names></name><name><surname>Kemmoku</surname><given-names>Y</given-names></name><name><surname>Yamaguchi</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Validation of energy prediction method for a concentrator photovoltaic module in Toyohashi Japan</article-title><source>Prog. Photovolt. Res. Appl.</source><year>2012</year><volume>21</volume><issue>8</issue><fpage>1598</fpage><lpage>1610</lpage><pub-id pub-id-type="doi">10.1002/pip.2241</pub-id></mixed-citation></ref><ref id="CR80"><label>80.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>NLA</given-names></name><name><surname>Brindley</surname><given-names>HE</given-names></name><name><surname>Ekins-Daukes</surname><given-names>NJ</given-names></name></person-group><article-title xml:lang="en">Impact of individual atmospheric parameters on CPV system power, energy yield and cost of energy</article-title><source>Prog. Photovolt. Res. Appl.</source><year>2014</year><volume>22</volume><issue>10</issue><fpage>1080</fpage><lpage>1095</lpage><pub-id pub-id-type="doi">10.1002/pip.2376</pub-id></mixed-citation></ref><ref id="CR81"><label>81.</label><mixed-citation publication-type="other">Kamath, H.G., Araki, K., Ekins-Daukes, N.J., Ramasesha, S.K.: Performance analysis and fault detection method for concentrator photovoltaic modules. Submitted to Journal of Photovoltaics (2018)</mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec34"><title>Electronic supplementary material</title><p id="Par129">Below is the link to the electronic supplementary material.


<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/10825_2018_1171_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary material 1 (pdf 346 KB)</p></caption></media></supplementary-material></p></sec></app></app-group><fn-group><fn id="Fn1"><label>1</label><p id="Par50">The definition of the phase <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mi>Δ</mml:mi></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq99.gif"/></alternatives></inline-formula> in the definition of <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mi>ρ</mml:mi></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq100.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ27" ref-type="disp-formula">27</xref>), which affects the sign of <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq101.gif"/></alternatives></inline-formula> in Eq. <xref rid="Equ29" ref-type="disp-formula">29</xref>, is the same here as in [<xref ref-type="bibr" rid="CR33">33</xref>]. However, other conventions are in use; for instance, <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:mi>Δ</mml:mi></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="10825_2018_1171_Article_IEq102.gif"/></alternatives></inline-formula> is defined with the opposite sign in [<xref ref-type="bibr" rid="CR44">44</xref>].</p></fn></fn-group></back></article></records><facets><facet name="subject"><facet-value count="1">Electrical Engineering</facet-value><facet-value count="1">Engineering</facet-value><facet-value count="1">Mathematical and Computational Engineering</facet-value><facet-value count="1">Mechanical Engineering</facet-value><facet-value count="1">Optical and Electronic Materials</facet-value><facet-value count="1">Theoretical, Mathematical and Computational Physics</facet-value></facet><facet name="keyword"><facet-value count="1">Optical modelling</facet-value><facet-value count="1">Quantum solvers</facet-value><facet-value count="1">Semiconductor properties</facet-value><facet-value count="1">Solar cell modelling</facet-value><facet-value count="1">Solar irradiance</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Computational Electronics</facet-value></facet><facet name="year"><facet-value count="1">2018</facet-value></facet><facet name="country"><facet-value count="1">Australia</facet-value><facet-value count="1">United Kingdom</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
