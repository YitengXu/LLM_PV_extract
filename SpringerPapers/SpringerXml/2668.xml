<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1186/s41601-021-00210-1</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41601</journal-id><journal-title-group><journal-title>Protection and Control of Modern Power Systems</journal-title><abbrev-journal-title abbrev-type="publisher">Prot Control Mod Power Syst</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2367-2617</issn><issn pub-type="epub">2367-0983</issn><publisher><publisher-name>Springer Singapore</publisher-name><publisher-loc>Singapore</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41601-021-00210-1</article-id><article-id pub-id-type="manuscript">210</article-id><article-id pub-id-type="doi">10.1186/s41601-021-00210-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Model predictive control of grid-connected PV power generation system considering optimal MPPT control of PV modules</article-title></title-group><contrib-group><contrib contrib-type="author" id="Au1"><name><surname>Zhao</surname><given-names>Yingying</given-names></name><address><email>CarolChence@163.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" id="Au2"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3607-6536</contrib-id><name><surname>An</surname><given-names>Aimin</given-names></name><address><email>anaiminll@163.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="corresp" rid="IDs41601021002101_cor2">b</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Xu</surname><given-names>Yifan</given-names></name><address><email>1106061799@qq.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Wang</surname><given-names>Qianqian</given-names></name><address><email>wangqianqian1120@163.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Wang</surname><given-names>Minmin</given-names></name><address><email>2724942522@qq.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.411291.e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9431 4158</institution-id><institution content-type="org-division">College of Electrical and Information Engineering</institution><institution content-type="org-name">Lanzhou University of Technology</institution></institution-wrap><addr-line content-type="postcode">730050</addr-line><addr-line content-type="city">Lanzhou</addr-line><addr-line content-type="state">Gansu</addr-line><country country="CN">China</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution content-type="org-name">Key Laboratory of Gansu Advanced Control for Industrial Processes</institution></institution-wrap><addr-line content-type="postcode">730050</addr-line><addr-line content-type="city">Lanzhou</addr-line><addr-line content-type="state">Gansu</addr-line><country country="CN">China</country></aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.411291.e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9431 4158</institution-id><institution content-type="org-division">National Demonstration Center for Experimental Electrical and Control Engineering Education</institution><institution content-type="org-name">Lanzhou University of Technology</institution></institution-wrap><addr-line content-type="postcode">730050</addr-line><addr-line content-type="city">Lanzhou</addr-line><addr-line content-type="state">Gansu</addr-line><country country="CN">China</country></aff></contrib-group><author-notes><corresp id="IDs41601021002101_cor2"><label>b</label><email>anaiminll@163.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>14</day><month>10</month><year>2021</year></pub-date><pub-date date-type="pub" publication-format="print"><month>12</month><year>2021</year></pub-date><volume>6</volume><issue seq="32">1</issue><elocation-id>32</elocation-id><history><date date-type="registration"><day>17</day><month>9</month><year>2021</year></date><date date-type="received"><day>16</day><month>4</month><year>2021</year></date><date date-type="accepted"><day>16</day><month>9</month><year>2021</year></date><date date-type="online"><day>14</day><month>10</month><year>2021</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2021</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">Because of system constraints caused by the external environment and grid faults, the conventional maximum power point tracking (MPPT) and inverter control methods of a PV power generation system cannot achieve optimal power output. They can also lead to misjudgments and poor dynamic performance. To address these issues, this paper proposes a new MPPT method of PV modules based on model predictive control (MPC) and a finite control set model predictive current control (FCS-MPCC) of an inverter. Using the identification model of PV arrays, the module-based MPC controller is designed, and maximum output power is achieved by coordinating the optimal combination of spectral wavelength and module temperature. An FCS-MPCC algorithm is then designed to predict the inverter current under different voltage vectors, the optimal voltage vector is selected according to the optimal value function, and the corresponding optimal switching state is applied to power semiconductor devices of the inverter. The MPPT performance of the MPC controller and the responses of the inverter under different constraints are verified, and the steady-state and dynamic control effects of the inverter using FCS-MPCC are compared with the traditional feedforward decoupling PI control in Matlab/Simulink. The results show that MPC has better tracking performance under constraints, and the system has faster and more accurate dynamic response and flexibility than conventional PI control.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Grid-connected PV power generation system</kwd><kwd>Model predictive control</kwd><kwd>Maximum power point tracking</kwd><kwd>Inverter</kwd><kwd>Optimal value function</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Project of the National Natural Science Foundation of China (CN)</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">61563032</award-id><award-id award-type="FundRef grant">61963025</award-id><principal-award-recipient><name><surname>An</surname><given-names>Aimin</given-names></name></principal-award-recipient><principal-award-recipient><name><surname>An</surname><given-names>Aimin</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>Foundation for Innovation Groups of Basic Research in Gansu Province</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100012555</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">2019KX01</award-id><principal-award-recipient><name><surname>An</surname><given-names>Aimin</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>Industrial Support and Guidance Project  for Higher Education Institutions of Gansu Province, China</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">2019C-05</award-id><principal-award-recipient><name><surname>An</surname><given-names>Aimin</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution>Open Fund Project  of Key Laboratory of Industrial Process Advanced Control of Gansu Province, China.</institution></institution-wrap></funding-source><award-id award-type="FundRef grant">2019KFJJ02</award-id><principal-award-recipient><name><surname>An</surname><given-names>Aimin</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>32</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2021</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>9</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>17</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41601_2021_Article_210.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Energy Systems</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Power Electronics, Electrical Machines and Networks</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Energy</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par18">In addressing global climate change, the proposal of reducing carbon dioxide emission and carbon neutrality has accelerated the speed of energy low-carbon transformation [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. This has stimulated the rapid development of solar energy, and the permeability of grid-connection photovoltaic (PV) has been increasing [<xref ref-type="bibr" rid="CR4">4</xref>]. MPPT and inverter control strategy in a grid-connected PV power generation system ensure that the system operates in a stable and optimal state of maximum power by adjusting the voltage and current dynamically [<xref ref-type="bibr" rid="CR5">5</xref>]. This improves the energy conversion efficiency, power quality and stability of system operation without increasing the hardware cost.</p><p id="Par19">The MPPT control method is the main technology to improve the efficiency of a PV system [<xref ref-type="bibr" rid="CR6">6</xref>]. At present, most MPPT control algorithms do not consider the impact of irradiance and temperature mutation on tracking speed and system control accuracy, e.g., the traditional incremental conductance method [<xref ref-type="bibr" rid="CR7">7</xref>] finds it difficult to meet the requirements of tracking efficiency when there are interference and constraints from the external environment. The MPPT algorithm in the case of external environment mutation has been studied in [<xref ref-type="bibr" rid="CR8">8</xref>], while in [<xref ref-type="bibr" rid="CR9">9</xref>], the mathematical model of PV modules under partial shadow interference is established, and the relationship between output characteristics of PV arrays and outside interference factors is analyzed. The MPPT algorithm combining current control and disturbance observation method is proposed in [<xref ref-type="bibr" rid="CR10">10</xref>]. However, the above methods have high power consumption and find it difficult to consider both the tracking speed and the control accuracy when the external constraints change rapidly.</p><p id="Par20">The grid-connected PV inverter control technology has become a research hotspot. Traditional control methods include linear methods, such as feedforward decoupling control based on PI regulation [<xref ref-type="bibr" rid="CR11">11</xref>], and nonlinear methods, such as proportional resonance control [<xref ref-type="bibr" rid="CR12">12</xref>]. The former needs the PWM modulation module, while the static and dynamic performance of the system depend on the PI regulator. Although the latter has good dynamic performance, the switching frequency is not fixed, which makes the harmonic filter design difficult. With the improvement of digital processors, new control methods have been proposed, including fuzzy, adaptive and predictive control. The fuzzy logic control strategy of a grid-connected PV inverter is used in [<xref ref-type="bibr" rid="CR13">13</xref>], while fuzzy rules and membership functions of fuzzy control depend on experience, which has some limitations, and the control stability needs to be improved. Reference [<xref ref-type="bibr" rid="CR14">14</xref>] proposes an adaptive control method for a 3-phase inverter in the distributed generation system. The design of adaptive control is complex. The parameter adjustment is not only time-consuming, but also needs to be tuned under various working conditions. Predictive control adopts strategies of multi-step test, rolling optimization and feedback correction, and mainly includes deadbeat, repetitive [<xref ref-type="bibr" rid="CR15">15</xref>] and model predictive control (MPC) [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Because MPC can effectively overcome the uncertainty and nonlinearity of the process and deal with various constraints of spatial state variables, optimal control can be achieved by selecting the control mode that minimizes the evaluation function after establishing the system predictive model. Reference [<xref ref-type="bibr" rid="CR19">19</xref>] studies the performance verification method of a finite control set model predictive control (FCS-MPC) strategy applied to the power electronic converter, and evaluates the performance of the algorithm using statistical model checking. Reference [<xref ref-type="bibr" rid="CR20">20</xref>] studies the weighting factor design based on an artificial neural network of a converter under MPC, whereas in [<xref ref-type="bibr" rid="CR21">21</xref>], MPC is applied to modular multilevel converters. The strategy of FCS-MPC is introduced into the voltage source converter and applied to an AC microgrid system in [<xref ref-type="bibr" rid="CR22">22</xref>]. However, the above methods are focused on converters, whereas research on new energy power generation systems has been limited. This paper combines a PV power generation system with MPC to realize fast tracking of the maximum power point of PV arrays and optimization of the inverter control performance.</p><p id="Par21">In order to achieve the optimal control of a grid-connected PV power generation system, and maximize the utilization of solar energy, MPC strategies for PV modules and the inverter are proposed, respectively. From the linear PV array model obtained by model identification, a model predictive controller is designed for modules. By predicting the incident light wavelength, the maximum cut-off spectral wavelength is found and filtered to reduce the module temperature and achieve maximum power tracking. The FCS-MPCC algorithm is then applied to the inverter current control in the <italic>dq</italic> coordinate system. The voltage vectors are evaluated through the predictive model and the optimized value function is established in each PWM sampling period. The voltage vector which minimizes the value function is used for the next sampling period to generate the switching control signals for the inverter. Finally, the system is simulated in Matlab/Simulink to demonstrate the performance in steady-state and dynamic operation. It shows that MPC can track the maximum power point of PV arrays and has an ability for fast current regulation. It also verifies the effectiveness of FCS-MPCC for a 3-phase grid-connected PV inverter.</p></sec><sec id="Sec2"><title>Grid-connected PV power generation system model</title><p id="Par22">The grid-connected PV power generation system consists of PV modules, a DC capacitor, a 3-phase inverter bridge, RL filters, step-up transformers, etc. [<xref ref-type="bibr" rid="CR23">23</xref>], and its typical topology is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Given the output characteristics of the PV cell, the PV array converts the absorbed solar energy into direct current under the control of MPPT, and the inverter converts the DC power to AC power, which is then transmitted to the power grid after filtering and boosting [<xref ref-type="bibr" rid="CR24">24</xref>].<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Topological structure of grid-connected PV power generation system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig1_HTML.png" id="MO1"/></fig></p><sec id="Sec3"><title>Mathematical model of PV array</title><p id="Par23">In practical application, PV modules connect multiple single PV cells to transmit electrical energy. The relation between the output current and voltage of the PV array is given as:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>sc</mml:mtext></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mo>exp</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AKT</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I = I_{{\text{L}}} - I_{{{\text{sc}}}} \left[ {\exp - \left( {\frac{{q(U + IR_{{\text{s}}} )}}{AKT}} \right) - 1} \right] - \frac{{U + IR_{{\text{s}}} }}{{R_{{\text{p}}} }}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ1.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{\text{L}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq17.gif"/></alternatives></inline-formula> is the photo-generated current and <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>sc</mml:mtext></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{{\text{sc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq18.gif"/></alternatives></inline-formula> is the reverse saturation current. <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mi>K</mml:mi></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq19.gif"/></alternatives></inline-formula> is the Boltzmann constant, <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mi>q</mml:mi></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq20.gif"/></alternatives></inline-formula> is the electron charge, <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mi>T</mml:mi></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq21.gif"/></alternatives></inline-formula> is the ambient temperature, and <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mi>A</mml:mi></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq22.gif"/></alternatives></inline-formula> is the diode factor. <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{{\text{s}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq23.gif"/></alternatives></inline-formula>,<inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>R</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{{\text{p}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq24.gif"/></alternatives></inline-formula> are the equivalent series and parallel resistances, respectively.</p><p id="Par24">When sunlight irradiates, only a small part of the incident radiation is transformed into electrical energy by PV cells, while a large part of the energy increases the module temperature through heat transfer. However, the influence of irradiance and temperature on the output power are diametrically opposite, and the relationship between the PV module temperature and output power is given as:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>module</mml:mtext></mml:msub><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>T</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mtext>sw</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mtext>lw</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mtext>conv</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>out</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{{\text{module}}}} \frac{{{\text{d}}T_{{\text{m}}} }}{{{\text{d}}t}} = q_{{{\text{sw}}}} - q_{{{\text{lw}}}} - q_{{{\text{conv}}}} - P_{{{\text{out}}}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ2.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>C</mml:mi><mml:mtext>module</mml:mtext></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{{\text{module}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq25.gif"/></alternatives></inline-formula> is the module heat capacity, <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>T</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{\text{m}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq26.gif"/></alternatives></inline-formula> is the module temperature, <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mtext>sw</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mtext>lw</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{{{\text{sw}}}} ,q_{{{\text{lw}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq27.gif"/></alternatives></inline-formula> are the short and long wave radiations of the incident light, respectively. <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>q</mml:mi><mml:mtext>conv</mml:mtext></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{{{\text{conv}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq28.gif"/></alternatives></inline-formula> is the heat exchange and <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>out</mml:mtext></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{out}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq29.gif"/></alternatives></inline-formula> is the output power.</p></sec><sec id="Sec4"><title>Mathematical model of 3-phase PV grid-connected inverter</title><p id="Par25">Considering all possible switching states of the 3-phase inverter, there are eight combinations. The inverter switching states are defined as:<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext>(The</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>upper</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>arm</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>is</mml:mtext></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>on ,the</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>lower</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>arm</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>is</mml:mtext></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>off)</mml:mtext></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mtext>(The</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>upper</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>arm</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>off</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>on,</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>the</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>lower</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mrow><mml:mtext>arm</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.277778em"/><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>on)</mml:mtext></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{k} = \left\{ {\begin{array}{*{20}l} 1 \hfill &amp; {{\text{(The}}\;{\text{upper }}\;{\text{arm}}\;{\text{ is}}\;{\text{ on ,the }}\;{\text{lower }}\;{\text{arm}}\;{\text{ is}}\;{\text{ off)}}} \hfill \\ 0 \hfill &amp; {{\text{(The }}\;{\text{upper }}\;{\text{arm }}\;{\text{off }}\;{\text{on,}}\;{\text{the }}\;{\text{lower }}\;{\text{arm }}\;{\text{is}}\;{\text{ on)}}} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ3.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>a,b</mml:mtext><mml:mo>,</mml:mo><mml:mtext>c</mml:mtext></mml:mrow></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = {\text{a,b}},{\text{c}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq30.gif"/></alternatives></inline-formula> is the three-phase sequence.</p><p id="Par26">According to Kirchhoff’s voltage law and switching function, the mathematical model of an inverter in the 3-phase static coordinate system is shown as:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mtext>a</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mtext>dc</mml:mtext></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mtext>b</mml:mtext><mml:mo>,</mml:mo><mml:mtext>c</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>a</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>R</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mtext>b</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mtext>dc</mml:mtext></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mtext>b</mml:mtext><mml:mo>,</mml:mo><mml:mtext>c</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>b</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>R</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mtext>dc</mml:mtext></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>a</mml:mtext><mml:mo>,</mml:mo><mml:mtext>b</mml:mtext><mml:mo>,</mml:mo><mml:mtext>c</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} Ri_{{\text{a}}} + L\frac{{{\text{d}}i_{{\text{a}}} }}{{{\text{d}}t}} = u_{{{\text{dc}}}} \left( {S_{{\text{a}}} - \frac{1}{3}\sum\limits_{{k = {\text{a}},{\text{b}},{\text{c}}}} {S_{k} } } \right) - e_{{\text{a}}} \hfill \\ Ri_{{\text{b}}} + L\frac{{{\text{d}}i_{{\text{b}}} }}{{{\text{d}}t}} = u_{{{\text{dc}}}} \left( {S_{{\text{b}}} - \frac{1}{3}\sum\limits_{{k = {\text{a}},{\text{b}},{\text{c}}}} {S_{k} } } \right) - e_{{\text{b}}} \hfill \\ Ri_{{\text{c}}} + L\frac{{{\text{d}}i_{{\text{c}}} }}{{{\text{d}}t}} = u_{{{\text{dc}}}} \left( {S_{{\text{c}}} - \frac{1}{3}\sum\limits_{{k = {\text{a}},{\text{b}},{\text{c}}}} {S_{k} } } \right) - e_{{\text{c}}} \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ4.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{\text{a}}} ,i_{{\text{b}}} ,i_{{\text{c}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq31.gif"/></alternatives></inline-formula> are the inverter output currents, <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>u</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq32.gif"/></alternatives></inline-formula> is the DC bus voltage, and <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>c</mml:mtext></mml:msub></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{{\text{a}}} ,e_{{\text{b}}} ,e_{{\text{c}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq33.gif"/></alternatives></inline-formula> are the 3-phase grid voltages. Through Clark transformation, the 3-phase static coordinate system is transformed into the <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq34.gif"/></alternatives></inline-formula> coordinate system, and the inverter output voltages are:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msqrt><mml:msub><mml:mi>U</mml:mi><mml:mtext>dc</mml:mtext></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mtext>dc</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>b</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>c</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} u_{\alpha } = \sqrt{\frac{2}{3}} U_{{{\text{dc}}}} \left[ {S_{{\text{a}}} - \frac{1}{2}(S_{{\text{b}}} + S_{{\text{c}}} )} \right] \hfill \\ u_{\beta } = \frac{\sqrt 2 }{2}U_{{{\text{dc}}}} (S_{{\text{b}}} - S_{{\text{c}}} ) \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ5.gif"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} u_{\alpha } = L\frac{{{\text{d}}i_{\alpha } }}{{{\text{d}}t}} + Ri_{\alpha } + e_{\alpha } \hfill \\ u_{\beta } = L\frac{{{\text{d}}i_{\beta } }}{{{\text{d}}t}} + Ri_{\beta } + e_{\beta } \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ6.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{\alpha } ,u_{\beta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{\alpha } ,i_{\beta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq36.gif"/></alternatives></inline-formula> are the inverter output voltages and currents in the <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq37.gif"/></alternatives></inline-formula> coordinate system, respectively. <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{\alpha } ,e_{\beta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq38.gif"/></alternatives></inline-formula> are the grid voltages in the <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq39.gif"/></alternatives></inline-formula> coordinate system.</p><p id="Par27">By aligning the grid voltage synthesis vector <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mi>E</mml:mi></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq40.gif"/></alternatives></inline-formula> and the <italic>d</italic>-axis of the <italic>dq</italic> coordinate system [<xref ref-type="bibr" rid="CR14">14</xref>], the inverter output active power and reactive power in the <italic>dq</italic> coordinate system are obtained as:<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>E</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>E</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} P = \frac{3}{2}(e_{d} i_{d} + e_{q} i_{q} ) = \frac{3}{2}Ei_{d} \hfill \\ Q = \frac{3}{2}(e_{q} i_{d} + e_{d} i_{q} ) = - \frac{3}{2}Ei_{q} \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ7.gif"/></alternatives></disp-formula></p><p id="Par28">From (<xref rid="Equ7" ref-type="disp-formula">7</xref>), it can be seen that the active current <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{d}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq41.gif"/></alternatives></inline-formula> and reactive current <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{q}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq42.gif"/></alternatives></inline-formula> have a linear relationship with <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P,Q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq43.gif"/></alternatives></inline-formula>, respectively. By independently adjusting the active and reactive currents, the inverter output active power and reactive power can be decoupled and separately controlled.</p></sec></sec><sec id="Sec5"><title>MPPT control of PV modules based on model predictive control</title><p id="Par29">MPPT has become the key technology to increase output power, improve photoelectric conversion efficiency and decrease power generation cost [<xref ref-type="bibr" rid="CR25">25</xref>]. The influence of temperature on power generation efficiency is negative, so when the surface temperature of the PV module rises, the photoelectric conversion efficiency reduces [<xref ref-type="bibr" rid="CR26">26</xref>]. Therefore, the MPC controller is designed to predict the influence of incident light wavelength on module temperature and power, control the active filter to filter the maximum cut-off spectral wavelength, and dynamically adjust the relationship between module temperature and optimal output power, so as to minimize module temperature while maximizing output power at the same time. This not only achieves the purpose of maximum power tracking, but also improves power generation efficiency and durability. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the structure block diagram of a model predictive controller for PV modules.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>The structure block diagram of MPC controller of PV arrays</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig2_HTML.png" id="MO2"/></fig></p><sec id="Sec6"><title>Mechanism model identification of PV modules</title><p id="Par30">To design a model predictive controller it is necessary to obtain a linear model of PV modules. The two-step change of ultraviolet cut-off wavelength <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>UV</mml:mtext></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{{{\text{UV}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq44.gif"/></alternatives></inline-formula> is set as the excitation signal of system input, and the infrared cut-off wavelength <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>IR</mml:mtext></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{{{\text{IR}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq45.gif"/></alternatives></inline-formula> is set as 1100 nm. The ambient temperature and wind speed are obtained from a data table. The reference module temperature <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msub><mml:mi>T</mml:mi><mml:mtext>m\_f</mml:mtext></mml:msub></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{{\text{m\_f}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq46.gif"/></alternatives></inline-formula>, the change of ultraviolet cut-off wavelength <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>UV</mml:mtext></mml:msub></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{{{\text{UV}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq47.gif"/></alternatives></inline-formula> and the actual output power <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>out</mml:mtext></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{out}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq48.gif"/></alternatives></inline-formula> are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Input parameters and output power of model identification</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig3_HTML.png" id="MO3"/></fig></p><p id="Par31">In order to ensure that the PV modules fully reach a stable state, the total simulation time is set to 2.22 h. Using the system identification toolbox in Matlab, the initial linearization model is generated by a subspace identification method, which is then further optimized by the prediction error method. The coefficients of the state space equation obtained by the identification toolbox are given in Table <xref rid="Tab1" ref-type="table">1</xref>, and the fitting curve between the actual output of the system and the linear model is obtained, as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The fitting degree reaches 92.36%. Final prediction error (FPE) is 0.01307, and mean squared error (MSE) is 0.01287.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Coefficients of state space equation of the linearized model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>A</p></th><th align="left"><p>B</p></th><th align="left"><p>C</p></th><th align="left"><p>D</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mn>0.9681</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:mn>2.936</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>2.968</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {\begin{array}{*{20}c} 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ {0.9681} &amp; { - 2.936} &amp; {2.968} \\ \end{array} } \right]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq49.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.0007632</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.0007444</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.000726</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {\begin{array}{*{20}c} { - 0.0007632} \\ { - 0.0007444} \\ { - 0.000726} \\ \end{array} } \right]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq50.gif"/></alternatives></inline-formula></p></td><td align="left"><p><inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mtext>T</mml:mtext></mml:msup></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {\begin{array}{*{20}c} 0 \\ 0 \\ 0 \\ \end{array} } \right]^{{\text{T}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq51.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0</p></td></tr></tbody></table></table-wrap><fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Fitting curves of actual plant data and linear model</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig4_HTML.png" id="MO4"/></fig></p></sec><sec id="Sec7"><title>Design of the model predictive controller for PV arrays</title><sec id="Sec8"><title>Theory of model predictive control</title><p id="Par32">MPC is a model-based closed-loop optimal control strategy [<xref ref-type="bibr" rid="CR27">27</xref>], and the mathematical model describing the research object in discrete form is given as:<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} x(k + 1) = Ax(k) + Bu(k) \hfill \\ y(k) = Cx(k) + Du(k) \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ8.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mi>k</mml:mi></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq52.gif"/></alternatives></inline-formula> is the sampling time, <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mi>u</mml:mi></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq53.gif"/></alternatives></inline-formula> is the input vector, <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mi>y</mml:mi></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq54.gif"/></alternatives></inline-formula> is the output vector, and <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mi>x</mml:mi></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq55.gif"/></alternatives></inline-formula> is the state variable. When the input and output variables are defined as <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mi>U</mml:mi></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:mi>Y</mml:mi></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq57.gif"/></alternatives></inline-formula>, the output prediction sequence is defined as:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y = Fx(k_{i} ) + \Phi U$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ9.gif"/></alternatives></disp-formula>
where<inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mspace width="0.166667em"/><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/><mml:mo>⋯</mml:mo><mml:mspace width="0.166667em"/><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F = [CA \, CA^{2} \, \cdots \, CA^{{N_{p} }} ]^{{\text{T}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq58.gif"/></alternatives></inline-formula>, and<disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">CB</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">CAB</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="italic">CB</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi = \left[ {\begin{array}{*{20}c} {CB} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\ {CAB} &amp; {CB} &amp; 0 &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {CA^{{N_{p} - 1}} B} &amp; {CA^{{N_{p} - 2}} B} &amp; {CA^{{N_{p} - 3}} B} &amp; {} &amp; {CA^{{N_{p} - N_{c} }} B} \\ \end{array} } \right]$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equa.gif"/></alternatives></disp-formula></p><p id="Par33">The objective function is defined as:<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mtext>T</mml:mtext></mml:msup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>U</mml:mi></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J = (R_{s} - Y)^{{\text{T}}} (R_{s} - Y) + U^{{\text{T}}} \overline{R}U$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ10.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{R}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq59.gif"/></alternatives></inline-formula> is the weight of the input influence on the objective function and <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq60.gif"/></alternatives></inline-formula> is the expected output.</p><p id="Par34">When the predictive control achieves the optimal control objective, the objective function takes the minimum value, as:<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">⇒</mml:mo><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mtext>T</mml:mtext></mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mtext>T</mml:mtext></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\partial J}{{\partial U}} = 0 \Rightarrow U = (\Phi^{{\text{T}}} \Phi + \overline{R})^{ - 1} \Phi^{{\text{T}}} (R_{s} - Fx(k_{i} ))$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ11.gif"/></alternatives></disp-formula></p><p id="Par35">The predicted value of the state variable at the next time is:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x(k_{i} + 1) = Ax(k_{i} ) + Bx(k_{i} ) = (A - BK_{x} )x(k_{i} ) + BK_{y} r(k_{i} )$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ12.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{x}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq61.gif"/></alternatives></inline-formula> is the first row of matrix <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mtext>T</mml:mtext></mml:msup><mml:mi>F</mml:mi></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\Phi^{T} \Phi + \overline{R})^{ - 1} \Phi^{{\text{T}}} F$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq62.gif"/></alternatives></inline-formula>, <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{y}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq63.gif"/></alternatives></inline-formula> is the first element of matrix <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mtext>T</mml:mtext></mml:msup><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\Phi^{T} \Phi + \overline{R})^{ - 1} \Phi^{{\text{T}}} R_{s}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq64.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r(k_{i} )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq65.gif"/></alternatives></inline-formula> is the expected value of <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mi>r</mml:mi></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq66.gif"/></alternatives></inline-formula> dimensional output at a certain sampling time.</p><p id="Par36">The output prediction value of the system is:<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y(k_{i} + 1) = C(A - BK_{x} )x(k_{i} ) + CBK_{y} r(k_{i} )$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ13.gif"/></alternatives></disp-formula></p><p id="Par37">From the above inference, the structure of the MPC system is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Structure block diagram of MPC system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig5_HTML.png" id="MO5"/></fig></p></sec><sec id="Sec9"><title>Design process of PV modules MPC controller</title><p id="Par38">The aim of the MPC controller is to maximize the output power by filtering the spectral wavelength to control the module temperature to track the reference value. Because the PV power generation is limited by the natural environment, the input, output and errors are constrained as follows:<disp-formula id="Equb"><alternatives><mml:math display="block" id="Equb_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>300</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>nm</mml:mtext><mml:mo>≤</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mtext>UV</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mn>430</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>nm</mml:mtext><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>nm</mml:mtext><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mtext>UV</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mn>130</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>nm</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>262</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>K</mml:mtext><mml:mo>≤</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mn>482</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>K</mml:mtext><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>-</mml:mo><mml:mn>100</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>K</mml:mtext><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mn>100</mml:mn><mml:mspace width="0.277778em"/><mml:mtext>K</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; 300\;{\text{nm}} \le \lambda_{{{\text{UV}}}} \le 430\;{\text{nm}},{ 0}\;{\text{nm}} \le \Delta \lambda_{{{\text{UV}}}} \le 130\;{\text{nm}} \\ &amp; 262\;{\text{K}} \le T_{{\text{m}}} \le 482\;{\text{K}}, \, - {100}\;{\text{K}} \le \Delta T_{{\text{m}}} \le 100\;{\text{K}} \\ \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equb.gif"/></alternatives></disp-formula></p><p id="Par39">To obtain the optimum output power at a given ambient temperature, the quantitative relationship between the ambient temperature and the module temperature is simulated according to the actual measurement data. The reference value of the module temperature is calculated as:<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>mf</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9155</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mtext>amb</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>80.01</mml:mn></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{{\text{mf}}}} = 0.9155T_{{{\text{amb}}}} + 80.01$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ14.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:msub><mml:mi>T</mml:mi><mml:mtext>amb</mml:mtext></mml:msub></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{{\text{amb}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq67.gif"/></alternatives></inline-formula> is the ambient temperature.</p><p id="Par40">The simulation of an MPC controller of PV modules is established in Simulink/Matalb, as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, with sampling time <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{\text{s}}} { = }10$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq68.gif"/></alternatives></inline-formula>, prediction step <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{P}}} { = }10$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq69.gif"/></alternatives></inline-formula> and control step <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{m}}} { = }2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq70.gif"/></alternatives></inline-formula>.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Simulation diagram of MPC controller of PV modules in Simulink</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig6_HTML.png" id="MO6"/></fig></p><p id="Par41">It can be seen from the results in Fig. <xref rid="Fig7" ref-type="fig">7</xref> that the module temperature is slightly lower than the reference temperature in the first hour of the simulation. The minimum value of <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>UV</mml:mtext></mml:msub></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{{{\text{UV}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq71.gif"/></alternatives></inline-formula> is 300 nm and the maximum value is 430 nm. This does not exceed the constraint range. In the second hour of the simulation, although there is a small fluctuation in the module temperature, the temperature tracking effect has been achieved. At about 2 h, the power gradually reaches the maximum value. Overall, MPC tracking performance is fast and good, and the purpose of MPPT is realized.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Simulation results of the MPC controller of PV modules</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig7_HTML.png" id="MO7"/></fig></p></sec></sec></sec><sec id="Sec10"><title>Control of the 3-phase PV grid-connected inverter</title><sec id="Sec11"><title>Feedforward decoupling control of inverter based on PI regulation</title><p id="Par42">The feedforward decoupling control strategy based on double-loop PI regulation is a common PWM inverter control strategy. Its core is the design of a DC voltage outer loop, a current inner loop and PI regulators. The structure of inverter control strategy is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Feedforward decoupling control structure of the grid-connected PV inverter based on PI regulation</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig8_HTML.png" id="MO8"/></fig></p><p id="Par43">In order to prevent the mutual influence between <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d,q$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq72.gif"/></alternatives></inline-formula> axes in the current inner loop and eliminate the influence between active and reactive power, decoupling control is used, as:<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ip</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">dref</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>U</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ip</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">qref</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>ω</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} U_{d} = - \left( {K_{ip} + \frac{{K_{il} }}{s}} \right)(i_{dref} - I_{d} ) + \omega LI_{q} + e_{d} \hfill \\ U_{q} = - \left( {K_{ip} + \frac{{K_{il} }}{s}} \right)(i_{qref} - I_{q} ) - \omega LI_{d} + e_{q} \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ15.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ip</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{il} ,K_{ip}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq73.gif"/></alternatives></inline-formula> are the proportional and integral regulation coefficients of the current inner loop PI regulators, respectively.</p><p id="Par44">The feedforward decoupling control of an inverter based on a PI regulator combines SVPWM and feedforward decoupling control strategy. The control process is as follows: (1) Phase-locked loop is used to obtain the rotating flux position angle <italic>θ</italic>; (2)<inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{d} ,i_{q}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq74.gif"/></alternatives></inline-formula> are obtained by coordinate transformation; (3) According to the feedback currents <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{d{\text{ref}}}} ,i_{{q{\text{ref}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq75.gif"/></alternatives></inline-formula>, the PI controllers are used to control the current inner loop to obtain <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{d} ,u_{q}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq76.gif"/></alternatives></inline-formula>; (4)<inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{d} ,u_{q}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq77.gif"/></alternatives></inline-formula> are transformed into <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{\alpha } ,u_{\beta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq78.gif"/></alternatives></inline-formula> through the <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mrow><mml:mi mathvariant="italic">dq</mml:mi></mml:mrow></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dq$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq79.gif"/></alternatives></inline-formula> to <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \beta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq80.gif"/></alternatives></inline-formula> coordinate transformation; (5)<inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{\alpha } ,u_{\beta }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq81.gif"/></alternatives></inline-formula> are input to the SVPWM module to generate PWM signals to control the inverter.</p></sec><sec id="Sec12"><title>Model predictive current control (MPCC) of the 3-phase inverter</title><p id="Par45">The MPCC technology uses current and past states to predict inverter current values in the next switching cycle derived from an accurate mathematical model of the system. The optimal value function is then used to select the optimal switch combination, so as to precisely track the current information [<xref ref-type="bibr" rid="CR28">28</xref>]. The prediction model and system optimization value function are determined as follows:</p><p id="Par46">The predictive model is the basic element of the MPCC algorithm. The Forward Euler is used to discretize (6) to obtain the current prediction value at <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq82.gif"/></alternatives></inline-formula> time, as:<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} i_{\alpha } (k + 1) = (1 - \frac{{RT_{{\text{s}}} }}{L})i_{\alpha } (k) + \frac{{T_{{\text{s}}} }}{L}\left[ {u_{\alpha } (k) - e_{\alpha } (k)} \right] \hfill \\ i_{\beta } (k + 1) = (1 - \frac{{RT_{{\text{s}}} }}{L})i_{\beta } (k) + \frac{{T_{{\text{s}}} }}{L}\left[ {u_{\beta } (k) - e_{\beta } (k)} \right] \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ16.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:msub><mml:mi>T</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{{\text{s}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq83.gif"/></alternatives></inline-formula> is the sampling period. Transforming (16) into <italic>dq</italic> coordinates yields the discrete space state prediction model of the grid-connected inverter, as:<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>sin</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>cos</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \begin{aligned} i_{d} (k + 1) = i_{\alpha } (k + 1)cos\theta + i_{\beta } (k + 1)\sin \theta \hfill \\ i_{q} (k + 1) = - i_{\alpha } (k + 1)\sin \theta + i_{\beta } (k + 1)\cos \theta \hfill \\ \end{aligned} \right.$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ17.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mi>θ</mml:mi></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq84.gif"/></alternatives></inline-formula> is the angle between the <italic>a</italic>-axis and <italic>d</italic>-axis, and <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{d} (k + 1),i_{q} (k + 1)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq85.gif"/></alternatives></inline-formula> are the <italic>dq</italic> axis components of the predicted current at <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq86.gif"/></alternatives></inline-formula> time.</p><p id="Par47">The optimal value function uses the quadratic performance index of prediction error to select the optimal combination of switching variables from different prediction values to minimize the error between the output current and the reference current at <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq87.gif"/></alternatives></inline-formula> time. The value function is constituted by the quadratic difference between the predicted current value and the reference current value at <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq88.gif"/></alternatives></inline-formula> time, as:<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g = \left[ {i_{d}^{ * } (k + 1) - i_{d} (k + 1)} \right]^{2} + \left[ {i_{q}^{ * } (k + 1) - i_{q} (k + 1)} \right]^{2}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_Equ18.gif"/></alternatives></disp-formula>
where <inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{d}^{ * } (k + 1),i_{q}^{ * } (k + 1)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq89.gif"/></alternatives></inline-formula> are the <italic>dq</italic> axis current references at <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq90.gif"/></alternatives></inline-formula> time.</p><p id="Par48">The FCS-MPCC algorithm flow is presented in Fig. <xref rid="Fig9" ref-type="fig">9</xref>, and the structure of FCS-MPCC for the PV inverter is shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. The details of the control strategy mainly include the following 6 parts:<list list-type="order"><list-item><p id="Par49">The measurement module. Through real-time measurements of grid voltages, inverter currents and DC bus voltages, the actual operating data is transmitted to the prediction model.</p></list-item><list-item><p id="Par50">PLL. PLL provides the phase angle for coordinate transformation and calculation of the prediction model.</p></list-item><list-item><p id="Par51">Prediction model. The prediction model uses the recursive relationship in (17) to calculate the current prediction value at <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq91.gif"/></alternatives></inline-formula> time through the measured value of the system at <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mi>k</mml:mi></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq92.gif"/></alternatives></inline-formula> time.</p></list-item><list-item><p id="Par52">Optimize the value function. The quadratic error of the reference current and the predicted current at <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq93.gif"/></alternatives></inline-formula> time is taken as the optimization value function in (18).</p></list-item><list-item><p id="Par53">Current reference. The active current reference comes from the outer DC voltage loop, i.e., the reference voltage <inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>dcref</mml:mtext></mml:msub></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{dcref}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq94.gif"/></alternatives></inline-formula> of the PV module is generated by MPPT control, and is then compared to the measured DC bus voltage <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq95.gif"/></alternatives></inline-formula>, before passing to a PI regulator. In order to be connected to the power grid with unit power factor, the reactive current reference is set to 0.</p></list-item><list-item><p id="Par54">Signal driver. From the optimized value function, the switch state corresponding to the minimum value function is taken as the optimal switch state of the following sampling period, and the power semiconductor devices are switched accordingly.</p></list-item></list><fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>The algorithm flow of FCS-MPCC</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig9_HTML.png" id="MO9"/></fig><fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>FCS-MPCC control structure of the PV inverter</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig10_HTML.png" id="MO10"/></fig></p></sec></sec><sec id="Sec13"><title>Simulation verification and analysis</title><p id="Par55">A simulation model is built in MATLAB to verify the feasibility of the control strategy. In order to implement the control effect, the FCS-MPCC algorithm is programmed through the S-function. The system model is shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>, the sampling period is set to 2 × 10<sup>–5</sup> s, and the parameters of the simulated system are shown in Table <xref rid="Tab2" ref-type="table">2</xref>.<fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Simulation model of a grid-connected PV power generation system</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig11_HTML.png" id="MO11"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Parameters of the simulated system</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameters of the PV module</p></th><th align="left"><p>value</p></th><th align="left"><p>Parameters of the system</p></th><th align="left"><p>value</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mi>S</mml:mi></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq96.gif"/></alternatives></inline-formula>/W·m<sup>−2</sup></p></td><td align="left"><p>1000</p></td><td align="left"><p><inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mi>P</mml:mi></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq97.gif"/></alternatives></inline-formula>/W</p></td><td align="left"><p>0.35 × 10<sup>4</sup></p></td></tr><tr><td align="left"><p><inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mi>T</mml:mi></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq98.gif"/></alternatives></inline-formula>/℃</p></td><td align="left"><p>25</p></td><td align="left"><p><inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mi>f</mml:mi></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq99.gif"/></alternatives></inline-formula>/Hz</p></td><td align="left"><p>60</p></td></tr><tr><td align="left"><p><inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>oc</mml:mtext></mml:msub></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{oc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq100.gif"/></alternatives></inline-formula>/V</p></td><td align="left"><p>85.40</p></td><td align="left"><p><inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:msub><mml:mi>C</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq101.gif"/></alternatives></inline-formula>/F</p></td><td align="left"><p>0.06</p></td></tr><tr><td align="left"><p><inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>sc</mml:mtext></mml:msub></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{{\text{sc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq102.gif"/></alternatives></inline-formula>/A</p></td><td align="left"><p>6.09</p></td><td align="left"><p><inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:mi>L</mml:mi></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq103.gif"/></alternatives></inline-formula>/H</p></td><td align="left"><p>0.01 × 10<sup>–6</sup></p></td></tr><tr><td align="left"><p><inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{\text{m}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq104.gif"/></alternatives></inline-formula>/V</p></td><td align="left"><p>72.90</p></td><td align="left"><p><inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mi>R</mml:mi></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq105.gif"/></alternatives></inline-formula>/Ω</p></td><td align="left"><p>0.03 × 10<sup>–6</sup></p></td></tr><tr><td align="left"><p><inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{\text{m}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq106.gif"/></alternatives></inline-formula>/A</p></td><td align="left"><p>5.69</p></td><td align="left"><p><inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq107.gif"/></alternatives></inline-formula>/V</p></td><td align="left"><p>480</p></td></tr><tr><td align="left"><p><inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:msub><mml:mi>N</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{s}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq108.gif"/></alternatives></inline-formula></p></td><td align="left"><p>7</p></td><td align="left"><p><inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>T1</mml:mtext></mml:msub></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{T1}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq109.gif"/></alternatives></inline-formula>/VA</p></td><td align="left"><p>0.25 × 10<sup>6</sup></p></td></tr><tr><td align="left"><p><inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:msub><mml:mi>N</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{p}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq110.gif"/></alternatives></inline-formula></p></td><td align="left"><p>88</p></td><td align="left"><p><inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>T2</mml:mtext></mml:msub></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{T2}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq111.gif"/></alternatives></inline-formula>/VA</p></td><td align="left"><p>0.50 × 10<sup>8</sup></p></td></tr></tbody></table></table-wrap></p><p id="Par56">Figure <xref rid="Fig12" ref-type="fig">12</xref>a, b show the response curves of the PV array output DC voltage and current, and the active and reactive power into the grid during sudden changes of irradiance and temperature, respectively. As can be seen, when irradiance and temperature change suddenly at 1.0 s and 2.0 s respectively, the voltage is adjusted quickly to follow the maximum power point, and the MPPT tracking effect is effectively realized by the MPC controller. It is also seen that the FCS-MPCC algorithm quickly stabilizes the inverter output power at the maximum power point after disturbances at 1.0 s and 2.0 s. In addition, as shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, the increase of irradiance leads to a power increase indicating a positive relationship between the light intensity and PV output power, while temperature change is inversely related to PV output power. This is in line with the theory of PV power generation.<fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>Response curves of PV arrays output during external conditions changes <bold>a</bold> PV arrays output during sudden change of irradiance, <bold>b</bold> PV arrays output during sudden change of temperature</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig12_HTML.png" id="MO12"/></fig></p><p id="Par57">Figure <xref rid="Fig13" ref-type="fig">13</xref> presents the active powers into the grid and the voltages at the point of common coupling (PCC) under different grid faults. Four different types of faults are applied at 1.5 s, and cleared after 0.5 s. It is seen from Fig. <xref rid="Fig13" ref-type="fig">13</xref> that the active power and voltage can reach stable states within 0.2 s after fault clearance. This indicates that the grid-connected PV inverter with FCS-MPCC strategy can operate during faults with fast response. It can be seen from the partial enlarged diagram that the power oscillation and voltage fluctuation caused by the three-phase fault are the most severe, and have the greatest impact on the stability of the system, while the single-phase fault has the least impact. This is in line with practical working conditions.<fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>Response curves of system under short circuit faults <bold>a</bold> comparison of active powers into power grid under different faults, <bold>b </bold>comparison of voltages at PCC under different faults</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig13_HTML.png" id="MO13"/></fig></p><p id="Par58">System performance with the traditional feedforward decoupling PI control and the proposed FCS-MPCC control method is shown in Figs. <xref rid="Fig14" ref-type="fig">14</xref> and <xref rid="Fig15" ref-type="fig">15</xref>, respectively. During the simulation, the active current reference <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{d{\text{ref}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq112.gif"/></alternatives></inline-formula> is provided by the voltage outer loop, with the reactive current reference <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>A</mml:mtext></mml:mrow></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{q{\text{ref}}}} = 0{\text{A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq113.gif"/></alternatives></inline-formula>. The parameters of the traditional feedforward decoupling PI controller are given in Table <xref rid="Tab3" ref-type="table">3</xref>.<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>A-phase waveforms of inverter with traditional feedforward decoupling PI control under initial condition <bold>a</bold> A-phase voltage and current at PCC, <bold>b </bold>harmonic analysis of A-phase grid current, <bold>c </bold>active and reactive power into power grid, <bold>d </bold>power factor</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig14_HTML.png" id="MO14"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>A-phase waveforms of inverter with FCS-MPCC under initial condition <bold>a </bold>A-phase voltage and current at PCC, <bold>b </bold>harmonic analysis of A-phase grid current, <bold>c </bold>active and reactive power into power grid, <bold>d </bold>power factor</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig15_HTML.png" id="MO15"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Parameters of PI controller</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameters</p></th><th align="left"><p>Value</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{il}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq114.gif"/></alternatives></inline-formula></p></td><td align="left"><p>369</p></td></tr><tr><td align="left"><p><inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ip</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{ip}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq115.gif"/></alternatives></inline-formula></p></td><td align="left"><p>0.852</p></td></tr><tr><td align="left"><p><inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">vl</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{vl}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq116.gif"/></alternatives></inline-formula></p></td><td align="left"><p>600</p></td></tr><tr><td align="left"><p><inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">vp</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{vp}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq117.gif"/></alternatives></inline-formula></p></td><td align="left"><p>5</p></td></tr></tbody></table></table-wrap></p><p id="Par59">It can be seen from Figs. <xref rid="Fig14" ref-type="fig">14</xref> and <xref rid="Fig15" ref-type="fig">15</xref> that after initial transients, both methods reach stable operational states<underline>.</underline> The voltage and current are in phase, the system realizes the operation of unity-power factor, and the total harmonic distortion (THD) rate of grid current is less than 5%. This achieves the grid connection requirements.</p><p id="Par60">Comparing the THD of the grid current shown in Figs. <xref rid="Fig14" ref-type="fig">14</xref>b and <xref rid="Fig15" ref-type="fig">15</xref>b shows that the current THD is reduced from 4.82% with the traditional feedforward decoupling PI control to 2.54% with the proposed FCS-MPCC. In addition, as seen from Figs. <xref rid="Fig14" ref-type="fig">14</xref>c, d and <xref rid="Fig15" ref-type="fig">15</xref>c, d, the system under FCS-MPCC strategy only takes 0.08 s to reach stable operation, compared to 0.15 s with the traditional feedforward decoupling PI control. Overall, the quality of the output waveforms is greatly improved, and the control accuracy is significantly increased with the proposed FCS-MPCC method.</p><p id="Par61">To test the stability of the system under abnormal operating conditions, the initial conditions of the system are changed. The references of the active and reactive currents are suddenly changed to <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.78</mml:mn><mml:mtext>A</mml:mtext></mml:mrow></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{d{\text{ref}}}} = 0.78{\text{A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.45</mml:mn><mml:mtext>A</mml:mtext></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{q{\text{ref}}}} = - 0.45{\text{A}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq119.gif"/></alternatives></inline-formula> at 0.2 s. The simulation results with the FCS-MPCC method and the traditional feedforward decoupling PI control are compared in Fig. <xref rid="Fig16" ref-type="fig">16</xref>.<fig id="Fig16"><label>Fig. 16</label><caption xml:lang="en"><p>Comparisons of waveforms with FCS-MPCC and traditional feedforward decoupling PI control after changing initial conditions <bold>a</bold> active current, <bold>b</bold> reactive current, <bold>c</bold> inverter output active power, <bold>d</bold> inverter output reactive power</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41601_2021_210_Fig16_HTML.png" id="MO16"/></fig></p><p id="Par62">As can be seen from Fig. <xref rid="Fig16" ref-type="fig">16</xref>a, b, compared with the traditional feedforward decoupling PI control, <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{d} ,i_{q}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq120.gif"/></alternatives></inline-formula> can better track <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{{d{\text{ref}}}} ,i_{{q{\text{ref}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq121.gif"/></alternatives></inline-formula> with FCS-MPCC strategy. Comparing the response speed of the active power and reactive power shown in Fig. <xref rid="Fig16" ref-type="fig">16</xref>c, d, FCS-MPCC strategy takes 0.05 s, while the feedforward decoupling PI controller requires 0.08 s, indicating better dynamic response of FCS-MPCC through decoupling control of active and reactive power. In addition, the reactive power transmission to the grid can be controlled by the <italic>q</italic>-axis current.</p></sec><sec id="Sec14" sec-type="conclusions"><title>Conclusion</title><p id="Par63">This paper addresses the optimal control problem of a grid-connected PV inverter system and optimizes the tracking performance of MPPT. To better deal with the small external constraints and system interference, an MPC-based MPPT method for PV arrays and an FCS-MPCC strategy for the inverter in <italic>dq</italic> coordinate are proposed. The steady-state and dynamic performance of the MPC-based system are verified by simulation under different external constraints, faults, and change of initial conditions. The performance is also compared with the traditional feedforward decoupling PI controller. The following conclusions are obtained:<list list-type="order"><list-item><p id="Par64">During sudden change of the external factors (ambient temperature, irradiance) or power grid faults, the grid-connected PV power generation system with MPC has rapid response speed, good anti-interference ability and satisfactory dynamic response. The MPC controller can quickly track the maximum power point of the PV array and output stable active power. This effectively increases the tracking sensitivity and accuracy of a PV power generation system, and improves the MPPT control performance.</p></list-item><list-item><p id="Par65">Under FCS-MPCC, the grid current and voltage can be precisely controlled to operate in unity-power factor. Compared to the feedforward decoupling PI controller, the proposed FCS-MPCC results in lower current THD, better power quality, faster current tracking and improved dynamic performance.</p></list-item></list></p></sec></body><back><ack><title>Acknowledgements</title><p>Not applicable.</p></ack><sec sec-type="author-contribution"><title>Authors' contributions</title><sec><p>All authors contributed to the study conception and commented on previous versions of the manuscript. YZ modeled the system, designed the algorithms of control strategy and wrote the paper. AA brought up the original conception and provided the technical guidance as a corresponding author. YX checked the data and tested simulation model in the paper. QW and MW contributed to revise and typeset the manuscript. All authors read and approved the final manuscript.</p></sec><sec><title>Author's information</title><p id="Par66">Yingying Zhao, (1997-), female, postgraduate, the main research direction is renewable energy access to Smart Grid.</p><p>Aimin An, (1972-), male, Ph.D. and Professor, Major in the artificial intelligence control technology, advanced industrial process control, renewable energy access to Smart Grid.</p><p>Yifan Xu, (1996-), male, postgraduate, the main research direction is renewable energy access to Smart Grid.</p><p>Qianqian Wang, (1995-), female, Ph.D. candidate, Major in the artificial intelligence control technology and advanced industrial process control.</p><p>Minmin Wang, (1995-), female, postgraduate, the main research direction is renewable energy access to Smart Grid.</p></sec></sec><sec><title>Funding</title><p>This work was supported by National Science Foundation of China (61563032, 61963025), Project supported by Gansu Basic Research Innovation Group (18JR3RA133), Industrial Support and Guidance Project for Higher Education Institutions of Gansu Province (2019C-05), Open Fund Project of Key Laboratory of Industrial Process Advanced Control of Gansu Province (2019KFJJ02).</p></sec><sec sec-type="data-availability"><title>Availability of data and materials</title><p>All data used or analyzed during this study are included in the published article.</p></sec><sec sec-type="ethics-statement"><title>Declarations</title><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par71">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostad-Ali-Askari</surname><given-names>K</given-names></name><name><surname>Ghorbanizadeh Kharazi</surname><given-names>H</given-names></name><name><surname>Shayannejad</surname><given-names>M</given-names></name><name><surname>Zareian</surname><given-names>MJ</given-names></name></person-group><article-title xml:lang="en">Effect of management strategies on reducing negative impacts of climate change on water resources of the Isfahan-Borkhar aquifer using MODFLOW</article-title><source>River Research and Applications</source><year>2019</year><volume>35</volume><issue>6</issue><fpage>611</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1002/rra.3463</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostad-Ali-Askari</surname><given-names>K</given-names></name><name><surname>Ghorbanizadeh Kharazi</surname><given-names>H</given-names></name><name><surname>Shayannejad</surname><given-names>M</given-names></name><name><surname>Zareian</surname><given-names>MJ</given-names></name></person-group><article-title xml:lang="en">Effect of Climate change on precipitation patterns in an arid region using GCM models: Case study of Isfahan-Borkhar plain</article-title><source>Natural Hazards Review</source><year>2020</year><volume>21</volume><issue>2</issue><fpage>04020006</fpage><pub-id pub-id-type="doi">10.1061/(ASCE)NH.1527-6996.0000367</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostad-Ali-Askari</surname><given-names>K</given-names></name><name><surname>Su</surname><given-names>RD</given-names></name><name><surname>Liu</surname><given-names>LM</given-names></name></person-group><article-title xml:lang="en">Water resources and climate change</article-title><source>Journal of Water and Climate Change</source><year>2018</year><volume>9</volume><issue>2</issue><fpage>239</fpage><pub-id pub-id-type="doi">10.2166/wcc.2018.999</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magdy</surname><given-names>G</given-names></name><name><surname>Mohamed</surname><given-names>EA</given-names></name><name><surname>Shabib</surname><given-names>G</given-names></name><etal/></person-group><article-title xml:lang="en">Microgrid dynamic security considering high penetration of renewable energy</article-title><source>Protection and Control of Modern Power Systems</source><year>2018</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1186/s41601-017-0075-8</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shan</surname><given-names>YH</given-names></name><name><surname>Hu</surname><given-names>JF</given-names></name><name><surname>Guerrero</surname><given-names>JM</given-names></name></person-group><article-title xml:lang="en">A model predictive power control method for pv and energy storage systems with voltage support capability</article-title><source>IEEE Transactions on Smart Grid</source><year>2019</year><volume>11</volume><issue>2</issue><fpage>1018</fpage><lpage>1029</lpage><pub-id pub-id-type="doi">10.1109/TSG.2019.2929751</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaibi</surname><given-names>Y</given-names></name><name><surname>Allouhi</surname><given-names>A</given-names></name><name><surname>Salhi</surname><given-names>M</given-names></name><name><surname>EI-jouni</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Annual performance analysis of different maximum power point tracking techniques used in photovoltaic systems</article-title><source>Protection and Control of Modern Power Systems</source><year>2019</year><volume>4</volume><issue>1</issue><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1186/s41601-019-0129-1</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shang</surname><given-names>L</given-names></name><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Zhu</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">An improved MPPT control strategy based on incremental conductance algorithm</article-title><source>Protection and Control of Modern Power Systems</source><year>2020</year><volume>5</volume><issue>1</issue><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1186/s41601-020-00161-z</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peter</surname><given-names>PK</given-names></name><name><surname>Agarwal</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Photovoltaic module-integrated stand-alone single-stage switched capacitor inverter with maximum power point tracking</article-title><source>IEEE Transactions on Power Electronics</source><year>2016</year><volume>32</volume><issue>5</issue><fpage>3571</fpage><lpage>3584</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2016.2587118</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nishant</surname><given-names>K</given-names></name><name><surname>Ikhlaq</surname><given-names>H</given-names></name><name><surname>Bhim</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Rapid MPPT for uniformly and partial shaded PV system by using JayaDE algorithm in highly fluctuating atmospheric conditions</article-title><source>IEEE Transactions on Industrial Informatics</source><year>2017</year><volume>13</volume><issue>5</issue><fpage>2406</fpage><lpage>2416</lpage><pub-id pub-id-type="doi">10.1109/TII.2017.2700327</pub-id></mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatramanan</surname><given-names>D</given-names></name><name><surname>John</surname><given-names>V</given-names></name></person-group><article-title xml:lang="en">Dynamic modeling and analysis of buck converter based solar PV charge controller for improved MPPT performance</article-title><source>IEEE Transactions on Industry Applications</source><year>2019</year><volume>55</volume><issue>6</issue><fpage>6234</fpage><lpage>6246</lpage><pub-id pub-id-type="doi">10.1109/TIA.2019.2937856</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>FY</given-names></name><name><surname>Du</surname><given-names>Q</given-names></name><name><surname>Qiao</surname><given-names>Y</given-names></name><name><surname>Qiang</surname><given-names>GD</given-names></name></person-group><article-title xml:lang="en">Decoupling control strategy with inverter-side current feedback for LCL-type three-phase PV grid-connected inverter</article-title><source>Power System Protection and Control</source><year>2018</year><volume>46</volume><issue>09</issue><fpage>122</fpage><lpage>128</lpage></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhimish</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name></person-group><article-title xml:lang="en">Optimized design of multiresonant AC current regulators for single-phase grid-connected photovoltaic inverters</article-title><source>IEEE Journal of Photovoltaics</source><year>2019</year><volume>9</volume><issue>6</issue><fpage>1815</fpage><lpage>1818</lpage><pub-id pub-id-type="doi">10.1109/JPHOTOV.2019.2940892</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hannan</surname><given-names>MA</given-names></name><name><surname>Ghani</surname><given-names>ZA</given-names></name><name><surname>Mohamed</surname><given-names>A</given-names></name><name><surname>Uddin</surname><given-names>MN</given-names></name></person-group><article-title xml:lang="en">Real-time testing of a fuzzy-logic-controller-based grid-connected photovoltaic inverter system</article-title><source>IEEE Transactions on Industry Applications</source><year>2015</year><volume>51</volume><issue>6</issue><fpage>4775</fpage><lpage>4784</lpage><pub-id pub-id-type="doi">10.1109/TIA.2015.2455025</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wai</surname><given-names>RJ</given-names></name><name><surname>Lin</surname><given-names>YF</given-names></name><name><surname>Liu</surname><given-names>YK</given-names></name></person-group><article-title xml:lang="en">Design of adaptive control and fuzzy neural network control for single-stage boost inverter</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2015</year><volume>62</volume><issue>12</issue><fpage>5434</fpage><lpage>5445</lpage><pub-id pub-id-type="doi">10.1109/TIE.2015.2408571</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qu</surname><given-names>AW</given-names></name><name><surname>Chen</surname><given-names>DL</given-names></name></person-group><article-title xml:lang="en">Three-phase voltage-fed quasi-z-source photovoltaic grid-connected inverter system with repetitive control</article-title><source>Power System Technology</source><year>2017</year><volume>41</volume><issue>06</issue><fpage>1997</fpage><lpage>2006</lpage></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>N</given-names></name><name><surname>Hu</surname><given-names>SY</given-names></name><name><surname>Cui</surname><given-names>GZ</given-names></name><name><surname>Jiang</surname><given-names>SX</given-names></name></person-group><article-title xml:lang="en">Finite state model predictive current control of grid-connected inverters for PV systems</article-title><source>Proceedings of the CSEE</source><year>2015</year><volume>35</volume><issue>1</issue><fpage>190</fpage><lpage>196</lpage></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Gu</surname><given-names>DD</given-names></name><name><surname>Sun</surname><given-names>MH</given-names></name><etal/></person-group><article-title xml:lang="en">Multi-objective optimization model-predictive control of PV grid-connected inverters</article-title><source>Power System Protection and Control</source><year>2016</year><volume>44</volume><issue>15</issue><fpage>112</fpage><lpage>119</lpage></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morfin-Magaa</surname><given-names>R</given-names></name><name><surname>Rico-Melgoza</surname><given-names>JJ</given-names></name><name><surname>Ornelas-Tellez</surname><given-names>F</given-names></name><name><surname>Vasca</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Complementarity model of a photovoltaic power electronic system with model predictive control</article-title><source>IEEE Transactions on Circuits and Systems I: Regular Papers</source><year>2019</year><volume>66</volume><issue>11</issue><fpage>4402</fpage><lpage>4414</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">4029971</pub-id><pub-id pub-id-type="doi">10.1109/TCSI.2019.2923978</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Novak, M., Dragicevic, T., Blaabjerg, F., &amp; Nyman, U. M. (2017). Analytical performance verification of FCS-MPC applied to power electronic converters: A model checking approach. In <italic>2017 IEEE 18th workshop on control and modeling for power electronics</italic> (pp. 1–6). IEEE: California.</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragicevic</surname><given-names>T</given-names></name><name><surname>Novak</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Weighting factor design in model predictive control of power electronic converters: An artificial neural network approach</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2018</year><volume>66</volume><issue>11</issue><fpage>8870</fpage><lpage>8880</lpage><pub-id pub-id-type="doi">10.1109/TIE.2018.2875660</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Xiao</surname><given-names>Q</given-names></name><name><surname>Zhou</surname><given-names>D</given-names></name><name><surname>Qiu</surname><given-names>H</given-names></name><name><surname>Tang</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Modulated model predictive control for modular multilevel converters with easy implementation and enhanced steady-state performance</article-title><source>IEEE Transactions on Power Electronics</source><year>2020</year><volume>35</volume><issue>9</issue><fpage>9107</fpage><lpage>9118</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2020.2969688</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragicevic</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Model predictive control of power converters for robust and fast operation of AC microgrids</article-title><source>IEEE Transactions on Power Electronics</source><year>2017</year><volume>33</volume><issue>7</issue><fpage>6304</fpage><lpage>6317</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2017.2744986</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>CY</given-names></name><name><surname>Lin</surname><given-names>WS</given-names></name><name><surname>Chen</surname><given-names>YM</given-names></name><name><surname>Chou</surname><given-names>CY</given-names></name></person-group><article-title xml:lang="en">A PV micro-inverter with PV current decoupling strategy</article-title><source>IEEE Transactions on Power Electronics</source><year>2016</year><volume>32</volume><issue>8</issue><fpage>6544</fpage><lpage>6557</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2016.2616371</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salman</surname><given-names>S</given-names></name><name><surname>Xin</surname><given-names>AI</given-names></name><name><surname>Zhou</surname><given-names>WU</given-names></name></person-group><article-title xml:lang="en">Design of a P-&amp;-O algorithm based MPPT charge controller for a stand-alone 200W PV system</article-title><source>Protection and Control of Modern Power Systems</source><year>2018</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1186/s41601-018-0099-8</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dabra</surname><given-names>V</given-names></name><name><surname>Paliwal</surname><given-names>KK</given-names></name><name><surname>Sharma</surname><given-names>P</given-names></name><name><surname>Kumar</surname><given-names>N</given-names></name></person-group><article-title xml:lang="en">Optimization of photovoltaic power system: A comparative study</article-title><source>Protection and Control of Modern Power Systems</source><year>2017</year><volume>2</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1186/s41601-017-0036-2</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdel-Rahim</surname><given-names>O</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name></person-group><article-title xml:lang="en">A new high gain DC-DC converter with model-predictive-control based MPPT technique for photovoltaic systems</article-title><source>CPSS Transactions on Power Electronics and Applications</source><year>2020</year><volume>5</volume><issue>2</issue><fpage>191</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.24295/CPSSTPEA.2020.00016</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scoltock</surname><given-names>J</given-names></name><name><surname>Geyer</surname><given-names>T</given-names></name><name><surname>Madawala</surname><given-names>UK</given-names></name></person-group><article-title xml:lang="en">Model predictive direct power control for grid-connected NPC converters</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2015</year><volume>62</volume><issue>9</issue><fpage>5319</fpage><lpage>5328</lpage><pub-id pub-id-type="doi">10.1109/TIE.2015.2410259</pub-id></mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayhan</surname><given-names>S</given-names></name><name><surname>Trabelsi</surname><given-names>M</given-names></name><name><surname>Abu-Rub</surname><given-names>H</given-names></name><name><surname>Malinowski</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Finite-control-set model-predictive control for a quasi-Z-source four-leg inverter under unbalanced load condition</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2017</year><volume>64</volume><issue>4</issue><fpage>2560</fpage><lpage>2569</lpage><pub-id pub-id-type="doi">10.1109/TIE.2016.2632062</pub-id></mixed-citation></ref></ref-list></ref-list><glossary><title>Abbreviations</title><def-list><def-item><term><inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi>S</mml:mi></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq1.gif"/></alternatives></inline-formula></term><def><p id="Par2">Irradiance</p></def></def-item><def-item><term><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi>T</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq2.gif"/></alternatives></inline-formula></term><def><p id="Par3">Ambient temperature</p></def></def-item><def-item><term><inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>oc</mml:mtext></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{oc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq3.gif"/></alternatives></inline-formula></term><def><p id="Par4">Open-circuit voltage</p></def></def-item><def-item><term><inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>sc</mml:mtext></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{{\text{sc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq4.gif"/></alternatives></inline-formula></term><def><p id="Par5">Short-circuit current</p></def></def-item><def-item><term><inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{\text{m}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq5.gif"/></alternatives></inline-formula></term><def><p id="Par6">Peak voltage</p></def></def-item><def-item><term><inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>I</mml:mi><mml:mtext>m</mml:mtext></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{\text{m}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq6.gif"/></alternatives></inline-formula></term><def><p id="Par7">Peak current</p></def></def-item><def-item><term><inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>N</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{s}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq7.gif"/></alternatives></inline-formula></term><def><p id="Par8">Number of PV modules in series</p></def></def-item><def-item><term><inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>N</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\text{p}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq8.gif"/></alternatives></inline-formula></term><def><p id="Par9">Number of PV modules in parallel</p></def></def-item><def-item><term><inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mi>P</mml:mi></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq9.gif"/></alternatives></inline-formula></term><def><p id="Par10">Rated power of grid-connected PV power generation system</p></def></def-item><def-item><term><inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mi>f</mml:mi></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq10.gif"/></alternatives></inline-formula></term><def><p id="Par11">Power frequency</p></def></def-item><def-item><term><inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>C</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq11.gif"/></alternatives></inline-formula></term><def><p id="Par12">Voltage stabilizing capacitor</p></def></def-item><def-item><term><inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mi>L</mml:mi></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq12.gif"/></alternatives></inline-formula></term><def><p id="Par13">Filter inductor</p></def></def-item><def-item><term><inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi>R</mml:mi></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq13.gif"/></alternatives></inline-formula></term><def><p id="Par14">Filter resistor</p></def></def-item><def-item><term><inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>U</mml:mi><mml:mtext>dc</mml:mtext></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{{{\text{dc}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq14.gif"/></alternatives></inline-formula></term><def><p id="Par15">The DC bus voltage</p></def></def-item><def-item><term><inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>T1</mml:mtext></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{T1}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq15.gif"/></alternatives></inline-formula></term><def><p id="Par16">Rated power of 1#transformer</p></def></def-item><def-item><term><inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>P</mml:mi><mml:mtext>T2</mml:mtext></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{{\text{T2}}}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41601_2021_210_Article_IEq16.gif"/></alternatives></inline-formula></term><def><p id="Par17">Rated power of 2#transformer</p></def></def-item></def-list></glossary></back></article></records><facets><facet name="subject"><facet-value count="1">Energy</facet-value><facet-value count="1">Energy Systems</facet-value><facet-value count="1">Power Electronics, Electrical Machines and Networks</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">Grid-connected PV power generation system</facet-value><facet-value count="1">Inverter</facet-value><facet-value count="1">Maximum power point tracking</facet-value><facet-value count="1">Model predictive control</facet-value><facet-value count="1">Optimal value function</facet-value></facet><facet name="pub"><facet-value count="1">Protection and Control of Modern Power Systems</facet-value></facet><facet name="year"><facet-value count="1">2021</facet-value></facet><facet name="country"><facet-value count="1">China</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
