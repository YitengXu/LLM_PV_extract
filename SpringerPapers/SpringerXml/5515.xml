<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1007/s40722-016-0052-8</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">40722</journal-id><journal-title-group><journal-title>Journal of Ocean Engineering and Marine Energy</journal-title><abbrev-journal-title abbrev-type="publisher">J. Ocean Eng. Mar. Energy</abbrev-journal-title></journal-title-group><issn pub-type="ppub">2198-6444</issn><issn pub-type="epub">2198-6452</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s40722-016-0052-8</article-id><article-id pub-id-type="manuscript">52</article-id><article-id pub-id-type="doi">10.1007/s40722-016-0052-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Implementation of latching control in a numerical wave tank with regular waves</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><name><surname>Giorgi</surname><given-names>Giuseppe</given-names></name><address><email>ggiorgi@eeng.nuim.ie</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4072201600528_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Ringwood</surname><given-names>John V.</given-names></name><address><email>john.ringwood@eeng.nuim.ie</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.95004.38</institution-id><institution-id institution-id-type="ISNI">0000000093319029</institution-id><institution content-type="org-division">Centre for Ocean Energy Research</institution><institution content-type="org-name">Maynooth University</institution></institution-wrap><addr-line content-type="city">Co.Kildare</addr-line><country country="IE">Ireland</country></aff></contrib-group><author-notes><corresp id="IDs4072201600528_cor1"><label>a</label><email>ggiorgi@eeng.nuim.ie</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>19</day><month>4</month><year>2016</year></pub-date><pub-date date-type="pub" publication-format="print"><month>5</month><year>2016</year></pub-date><volume>2</volume><issue seq="7">2</issue><fpage>211</fpage><lpage>226</lpage><history><date date-type="registration"><day>6</day><month>4</month><year>2016</year></date><date date-type="received"><day>15</day><month>9</month><year>2015</year></date><date date-type="accepted"><day>5</day><month>4</month><year>2016</year></date><date date-type="online"><day>19</day><month>4</month><year>2016</year></date></history><permissions><copyright-statement content-type="compact">© Springer International Publishing Switzerland 2016</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Springer International Publishing Switzerland</copyright-holder></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">In order to increase the overall power production efficiency of wave energy technology in the face of sea state variability, the presence of the control is mandatory. A model of the system is required to tune the controller parameters and predict the resulting performances. Even though the relevance of nonlinearities is magnified by the presence of the controller, the device model employed is usually linear. An implementation of control in a fully nonlinear simulation model is desirable, but missing. Hence, this paper proposes to use the fully nonlinear computational fluid dynamics (CFD) environment, implementing the latching control strategy in the open source software OpenFOAM. A case study has been analyzed to highlight the nonlinear behavior of a device under latching control and to evaluate the differences between linear and nonlinear simulation models. The results show that the linear model overestimates the amplitude of motion, and, as a result, the extracted power. Moreover, the choice of the optimal control parameter is significantly affected by the nonlinear effect on the natural period of the device.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Latching control</kwd><kwd>CFD</kwd><kwd>OpenFOAM</kwd><kwd>NWT</kwd><kwd>Nonlinear</kwd><kwd>Optimal latching duration</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Science Foundation Ireland</institution><institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100001602</institution-id></institution-wrap></funding-source><award-id award-type="FundRef grant">SFI/13/IA/1886</award-id><principal-award-recipient><name><surname>Ringwood</surname><given-names>John V.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Springer</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>9</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>Springer International Publishing Switzerland</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>No</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>6</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>ArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>ContentOnly</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40722_2016_Article_52.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/40722_2016_52_TEX.zip</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>TEX</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-online-date-day</meta-name><meta-value>26</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-year</meta-name><meta-value>2016</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-month</meta-name><meta-value>4</meta-value></custom-meta><custom-meta><meta-name>issue-print-date-day</meta-name><meta-value>26</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Offshore Engineering</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Renewable and Green Energy</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Engineering Fluid Dynamics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Geoengineering, Foundations, Hydraulics</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Oceanography</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Coastal Sciences</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>SC8</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>false</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">For several countries around the world, the exploitation of ocean wave power may constitute a significant contribution to the diversification of the energy production scenario, increasing the portion of sustainable and renewable resources (Halamay and Simmons <xref ref-type="bibr" rid="CR23">2011</xref>; Fusco et al. <xref ref-type="bibr" rid="CR20">2010</xref>; Yang et al. <xref ref-type="bibr" rid="CR50">2010</xref>). However, in most cases Wave Energy Converters (WECs) are not yet efficient enough to be economically competitive in the renewable energy market. An important role in the achievement of the economic viability is played by the control strategy, able to double the energy harvested (Babarit and Clément <xref ref-type="bibr" rid="CR2">2006</xref>).</p><p id="Par3">On the other hand, the ability of the controller to magnify power absorption is extremely sensitive to the ratio of wavelength to device size (Greenhow et al. <xref ref-type="bibr" rid="CR22">1984</xref>). A small device tends to have a larger absorbed-power increase than a big device, so its performances gain more benefits from the inclusion of the controller. In order to maximize the power extracted, a WEC must effectively convert energy in a range of frequency as wide as possible. For heaving point absorbers, for example, the resonance frequency of the WEC is usually quite pronounced and the response rapidly decays for frequencies far from resonance. Indeed, the main aim of the control strategy is to address the sea state variability and significantly enlarge the amplitude of motion, especially at frequencies far from the resonance peak. The most common WEC control strategies for linear WEC models are based on a form of complex-conjugate (Nebel <xref ref-type="bibr" rid="CR33">1992</xref>) or reactive (Salter <xref ref-type="bibr" rid="CR43">1979</xref>) control, which returns the optimal conditions, in the frequency domain, to maximize the energy absorption, as shown in chapter 6 of Falnes (<xref ref-type="bibr" rid="CR17">2002</xref>). On the other hand, examples of time domain approaches are given by latching (Budal et al. <xref ref-type="bibr" rid="CR10">1979</xref>; Babarit and Clément <xref ref-type="bibr" rid="CR2">2006</xref>; Kara <xref ref-type="bibr" rid="CR30">2010</xref>) and methods based on numerical optimization (Bacelli et al. <xref ref-type="bibr" rid="CR6">2009</xref>).</p><p id="Par4">Regardless of which particular control strategy is adopted, a comprehensive model of the system is required and the performance of the controller is highly dependent on the model accuracy. The simplest and common choice is to linearize the system, implicitly assuming small amplitudes of motion. However, under controlled conditions the motion may be exaggerated and, as a consequence, the relevance of nonlinearities increases.</p><p id="Par5">In absence of control, the only external action comes from the waves, whose steepness is physically limited, as shown in chapter 17 of Mehaute (<xref ref-type="bibr" rid="CR32">1976</xref>). The resulting wave excitation force is smooth and without high-frequency components. Conversely, the controller acts directly on the device with an arbitrary force, limited only by the structural constraints of the system. An example is given by latching control, which imposes a discrete on/off force. Peñalba et al. (<xref ref-type="bibr" rid="CR38">2015</xref>) implement latching control with both a linear and a partially nonlinear hydrodynamic model and show how the predicted power output and the optimal control calculations are affected by presence/absence of the nonlinear terms. While the linear and nonlinear models produce similar WEC motion in the uncontrolled case, the motions diverge when control is applied. Specifically, nonlinearities becomes relevant when the sharp exciting force of the controller directly influences the dynamics of the device leading to, among other effects, an asymmetric response.</p><p id="Par6">An accurate evaluation of the performance of the controller, as well as a validation of the results of the simulations, may be achieved through experimental tests in the sea or in wave tanks. Bjarte-Larsson and Falnes (<xref ref-type="bibr" rid="CR9">2006</xref>) tested latching on an axisymmetric floating body in a wave tank and the implementation of the control increased the power captured up to 4.3 times. A comparison between a simulation and tank tests is reported by Durand et al. (<xref ref-type="bibr" rid="CR16">2007</xref>), where a latching control strategy is applied in a wave tank to the SEAREV device. The controller increased the energy production up to ten times with regular waves, from 50 to 86 % with irregular waves.</p><p id="Par7">Unfortunately, experimental tests are not widely performed because they are time consuming, expensive and require both a device, usually scaled, and a wave tank. A more feasible evaluation tool is represented by the numerical wave tank (NWT) that implements a real tank in a computational fluid dynamics (CFD) environment. The application of the Navier–Stokes equations allows the inclusion of all the nonlinearities while the numerical domain makes possible to simulate the full-scale device and avoid scale effects. On the other hand, CFD has several drawbacks, among which the most relevant are: expensive large clusters needed to perform the computation in a reasonable time, long setup time and the expertise required to produce reliable results, as well as long computational time for each simulation.</p><p id="Par8">Nowadays, in wave energy applications, numerical wave tanks are mainly used to evaluate fluid–structure interaction on one or more floating bodies in operational conditions, to test survivability in extreme conditions (Clauss et al. <xref ref-type="bibr" rid="CR12">2005</xref>), to quantify viscous effects in order to identify the terms of the Morrison equation and model an equivalent viscous force (Bhinder et al. <xref ref-type="bibr" rid="CR8">2012</xref>) or to provide data for system identification techniques (Davidson et al. <xref ref-type="bibr" rid="CR15">2015b</xref>). Even though the experimental results demonstrate the impact of a controller on the system’s dynamics, a real-time control in an NWT is missing. This paper addresses the absence of a control strategy in a CFD environment, implementing latching in the open source software OpenFOAM<sup>®</sup>. Rather than focusing on a nonlinear control algorithm, which could be based on the mathematical formulation of Hoskin and Nichols (<xref ref-type="bibr" rid="CR27">1986</xref>), the objective of the paper is to show that a real-time controller in CFD is implementable and to highlight the prominence of nonlinear WEC behavior under controlled conditions, which leads to a significant difference between optimal latching duration for linear and nonlinear WEC simulation. In particular, the focus is on nonlinearities deriving from the wave–body interaction, therefore only linear waves are analyzed.</p><p id="Par9">Likewise, additional PTO damping has not been included since, even without PTO, the system is already damped enough to avoid unacceptably large oscillations; it will be shown that the maximum oscillation achieved (0.028 m) is just the 22 % of the device radius (see Fig. <xref rid="Fig11" ref-type="fig">11</xref> or Table <xref rid="Tab1" ref-type="table">1</xref>). With no PTO, there is no power extraction, so the objective of the optimization is to exaggerate the amplitude of oscillation. Nevertheless, Babarit et al. (<xref ref-type="bibr" rid="CR4">2004</xref>) show that, for latching control in a linear system with regular waves, maximization of the amplitude of oscillation is as effective as the maximization of the power extracted.</p><p id="Par10">The reminder of the paper is organized as follows: Sect. <xref rid="Sec2" ref-type="sec">2</xref> presents the mathematical and computational description of the software’s structure while Sect. <xref rid="Sec5" ref-type="sec">3</xref> shows the control strategies available in the proposed latching algorithm. In Sect. <xref rid="Sec14" ref-type="sec">4</xref>, results are presented and, in Sect. <xref rid="Sec15" ref-type="sec">5</xref>, comparisons are drawn between CFD simulations and linear simulations. In Sect. <xref rid="Sec17" ref-type="sec">6</xref>, some conclusions and final remarks are presented.</p></sec><sec id="Sec2"><title>Numerical wave tank</title><p id="Par11">Numerical wave tanks are computer implementations, in either two or three dimensions, of wave tanks (Tanizawa <xref ref-type="bibr" rid="CR46">2000</xref>). Having a numerical facility brings several advantages over the real one: a more cost-effective evaluation of motion and power capture, passive access to individual hydrodynamic forces (e.g., restoring or viscous forces) and status variables (e.g., pressure or velocity) in every point of the fluid domain, implementation of ideal constraints and restraints and no need of a real tank and device, so no scale effects. Several drawbacks also exist, among which the most relevant by far is the high computational time, typically 1000 times bigger then the simulation time (Ringwood et al. <xref ref-type="bibr" rid="CR41">2015</xref>). Furthermore, the setup of a spatial mesh, which ensures a reasonable compromise between computational time and accuracy, requires time and experience.</p><p id="Par12">The fluid dynamic in CFD is ruled by a set of differential equations called Navier–Stokes equations, chapter 2 of Temam (<xref ref-type="bibr" rid="CR48">2001</xref>). Under the incompressibility assumption, only the equation of transfer of mass (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and momentum (<xref rid="Equ2" ref-type="disp-formula">2</xref>) are utilized:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\nabla \cdot \mathbf{u }= 0\end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ1.gif"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="italic">ρ</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">∂</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ρ</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ρ</mml:mi><mml:mi mathvariant="bold">g</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\rho \frac{\partial {\mathbf{u }}}{\partial {t}} + \rho \mathbf{u } \cdot \nabla \mathbf{u }= - \nabla p + \nabla \cdot \mathbf T + \rho \mathbf g \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ2.gif"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi mathvariant="bold">u</mml:mi></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{u }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq1.gif"/></alternatives></inline-formula> is the fluid velocity, <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi mathvariant="italic">ρ</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq2.gif"/></alternatives></inline-formula> is the fluid density, <italic>p</italic> is the pressure, <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi mathvariant="bold">g</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf g $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq3.gif"/></alternatives></inline-formula> is the acceleration of gravity and <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mi mathvariant="bold">T</mml:mi></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf T $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq4.gif"/></alternatives></inline-formula> is the stress deviator, given by.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">μ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf{T =\mu [\nabla \mathbf{u }+(\nabla \mathbf{u })^T]} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi mathvariant="italic">μ</mml:mi></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq5.gif"/></alternatives></inline-formula> is the dynamic viscosity.</p><p id="Par13">The software discretizes the time and space domains in order to form a system of linear algebraic equations. The software utilized in this paper is the open source OpenFOAM, version 2.3.</p><sec id="Sec3"><title>OpenFOAM</title><p id="Par14">The development of NWTs in OpenFOAM is a rich research topic and numerous research theses and reports are available (Afshar <xref ref-type="bibr" rid="CR1">2010</xref>; Cathelain <xref ref-type="bibr" rid="CR11">2013</xref>). In the wave energy field, OpenFOAM has been used to simulate wave energy converters in operational (Palm et al. <xref ref-type="bibr" rid="CR37">2013</xref>; Schmitt et al. <xref ref-type="bibr" rid="CR44">2012</xref>) and extreme events (Vyzikas et al. <xref ref-type="bibr" rid="CR49">2013</xref>) conditions.</p><p id="Par15">The wave generation application is called waveFoam and was created by Jacobsen et al. (<xref ref-type="bibr" rid="CR28">2012</xref>) as an extension of the built-in interFoam. The free surface elevation is described by an interface-capturing method known as volume of fluid (VOF) (Hirt and Nicholis <xref ref-type="bibr" rid="CR26">1979</xref>). Within the tank, there are three different zones: in the middle region the dynamics are purely governed by the Navier–Stokes equations; hence, this is the actual experimental area of the tank. Upstream, there is the wave generation zone, where the required wave profile is gradually imposed on the fluid domain. Downstream, there is the absorption zone, where the waves are gradually erased to avoid reflections. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the generic configuration of a numerical wave tank, where the curved profiles in the generation and absorption zones represent the proportion with which the wave profile is imposed on the fluid domain.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Scheme of a numerical wave tank implemented in OpenFOAM using waveFoam</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig1_HTML.gif" id="MO4"/></fig></p><p id="Par16">A further development of the wave generation application is called waveDyMFoam, based on the built-in interDyMFoam, which allows the presence of a floating body thanks to a dynamic mesh that moves and deforms according to the body motion. In the version 2.3 of OpenFOAM, the introduction of the sixDoFRigidBodyMotion solver considerably improves the mechanism taking care of the movement of the body and the consequent deformation of the surrounding mesh. Moreover, constraints and restraints are more reliable and efficient than in the previous versions.</p><p id="Par17">The main reason for the choice of OpenFOAM instead of other CFD commercial software is its flexibility and open source availability. Besides the undeniable relevance of being cost-free, the biggest value is the possibility to access and modify the source code, which allows a deep understanding and total control over the calculations performed by the software.</p><p id="Par18">OpenFOAM is written in C++, which makes straightforward to insert a new customized subroutine into the main structure of the software. Indeed, new compatible applications are easy to create, making the software flexible and adaptable to the user’s needs. In Sect. <xref rid="Sec4" ref-type="sec">2.2</xref>, the basic steps to follow to implement a new application are explained, as well as the instructions to download, compile and use the latching control application created by the authors.</p></sec><sec id="Sec4"><title>Implementation of latching control</title><p id="Par19">The proposed control algorithm is born as a customized version of the built-in sixDoFRigidBodyMotion, which can be found in the source code folder of OpenFOAM. The original application’s task is to apply Newton’s second law of dynamics, integrating all the forces acting on the body surface, eventually including external restraints, to calculate and update both linear and rotational acceleration, velocity and position. Furthermore, if present, constraints are analytically imposed, directly setting to zero the displacement in the blocked degree of freedom. Note that, in previous versions of OpenFOAM, constraints were indirectly obtained by adding a counteracting force against the resulting force in the direction of the blocked degree of freedom. Even though this approach is theoretically valid, the numerical finite accuracy can cause a defective constraint.</p><p id="Par20">Since every controller essentially acts on the device by means of either restraints or constraints, sixDoFRigidBodyMotion is suitable as the backbone of the new application, implementing the real-time control algorithm. The reader can either code his own control algorithm or download the ready-to-use latching control algorithm available at Giorgi and Ringwood (<xref ref-type="bibr" rid="CR21">2015</xref>). Details about the control strategy features and options are provided in Sect. <xref rid="Sec5" ref-type="sec">3</xref>, while practical instructions are given in the user manual in Giorgi and Ringwood (<xref ref-type="bibr" rid="CR21">2015</xref>).</p></sec></sec><sec id="Sec5"><title>Latching control</title><p id="Par21">After a brief overview on the latching control given in Sect. <xref rid="Sec6" ref-type="sec">3.1</xref>, the control strategy actually implemented in the proposed control algorithm is unfolded. Section <xref rid="Sec8" ref-type="sec">3.2</xref> describes the basic logic of the new source code. Section <xref rid="Sec9" ref-type="sec">3.3</xref> highlights a nonlinear behavior of the natural period with relevant consequences on the latching strategy, leading to an expansion of the control algorithm explained in Sect. <xref rid="Sec12" ref-type="sec">3.4</xref>. Finally, in Sect. <xref rid="Sec13" ref-type="sec">3.5</xref>, a case study is presented, along with a description of some issues related to the CFD simulation environment.</p><sec id="Sec6"><title>Latching control</title><p id="Par22">The purpose of latching control strategy is to force the velocity into phase with the excitation force. An on/off PTO force is applied by means of a latching system, in order to avoid a phase difference between the velocity and the incoming wave excitation force. Referring to Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the device is locked at times <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_5$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq8.gif"/></alternatives></inline-formula> at the extrema of displacement, namely when the velocity is zero, and released at times <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq10.gif"/></alternatives></inline-formula> after a latched duration <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq11.gif"/></alternatives></inline-formula>. The two latching durations, upper position <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_2-t_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq12.gif"/></alternatives></inline-formula> and lower position <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_4-t_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq13.gif"/></alternatives></inline-formula>, may, in certain cases, preferably be chosen to be different (Falnes and Lillebekken <xref ref-type="bibr" rid="CR18">2003</xref>).<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Latching calculations to put position and force in phase. Latching instants at extrema of position P and <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mo>-</mml:mo></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq14.gif"/></alternatives></inline-formula>P: <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_5$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq17.gif"/></alternatives></inline-formula>; latching duration: <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq18.gif"/></alternatives></inline-formula>; unlatching instants: <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq20.gif"/></alternatives></inline-formula></p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig2_HTML.gif" id="MO5"/></fig></p><p id="Par23">If the wave is regular and monochromatic, with period <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>W</mml:mi></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_W$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq21.gif"/></alternatives></inline-formula>, the natural period <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq22.gif"/></alternatives></inline-formula> of the device is known and if the damping is negligible, the control variable <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq23.gif"/></alternatives></inline-formula> is optimally calculated (Ringwood and Butler <xref ref-type="bibr" rid="CR40">2004</xref>) as:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_\mathrm{L}=\frac{t_5-t_1}{2}-(t_5-t_4)=\frac{T_W}{2}-\frac{T_\mathrm{n}}{2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ4.gif"/></alternatives></disp-formula>Equation (<xref rid="Equ4" ref-type="disp-formula">4</xref>) implicitly suggests that the latching control strategy best suits conditions in which the wave period is bigger than the natural period, with <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}&gt;0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq24.gif"/></alternatives></inline-formula>. Conversely, another control strategy called declutching is able to control devices facing an incoming wave with period smaller than the natural period (Teillant et al. <xref ref-type="bibr" rid="CR47">2010</xref>).</p><p id="Par24">The definition of the natural period in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) presents several issues. While, in a linear case, the natural period is a well known and univocal concept, the presence of nonlinearities or large amplitude of motion makes it ambiguous to define. Section <xref rid="Sec9" ref-type="sec">3.3</xref> focuses on the variability of the natural period and the consequences on the choice of the latching duration. Furthermore, Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) is exact only if damping is absent or negligible. More correctly, the natural period should be substituted by the damped natural period, which approaches the natural period as the damping goes to zero. Section <xref rid="Sec7" ref-type="sec">3.1.1</xref> shows the linear hydrodynamic model approximation of the system and proposes a model order reduction to estimate the influence of the damping on the natural period.</p><p id="Par25">Finally, if the sea state is characterized by polychromatic waves, the requirement of phase accordance between velocity and excitation force becomes blurred, so the optimization criterion is not unique (Babarit et al. <xref ref-type="bibr" rid="CR4">2004</xref>). Different targets can be pursued, such as the synchronization of the velocity and excitation peaks (Hals et al. <xref ref-type="bibr" rid="CR24">2002</xref>) or the maximization of the absorbed power (Babarit and Clément <xref ref-type="bibr" rid="CR2">2006</xref>).</p><sec id="Sec7"><title>Linear model approximation</title><p id="Par26">The linear equation of motion of a floating body, as in chapter 6 of Newman (<xref ref-type="bibr" rid="CR34">1977</xref>), is defined in the frequency domain as:<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="italic">ω</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mi mathvariant="italic">ω</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \{-\omega ^2[M+A(\omega )]+j\omega B(\omega )+G\} x(j\omega )=F_\mathrm{ex}(\omega ), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ5.gif"/></alternatives></disp-formula>where <italic>M</italic> is the mass, <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq25.gif"/></alternatives></inline-formula> the added mass, <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq26.gif"/></alternatives></inline-formula> the radiation damping, <italic>G</italic> the stiffness, <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_\mathrm{ex}(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq27.gif"/></alternatives></inline-formula> is the wave excitation force and <italic>x</italic> a generic degree of freedom. In the present paper, the hydrodynamic parameters <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq29.gif"/></alternatives></inline-formula> are calculated by solving the potential problem with the BEM open source software NEMOH.</p><p id="Par27">For the purposes of real-time control, a time domain formulation is needed, obtained applying the Cummins equation (Cummins <xref ref-type="bibr" rid="CR13">1962</xref>):<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¨</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (M+A_\infty )\ddot{x}(t)+\int _0^tK(t-t')\dot{x}(t')dt'+Gx(t)=f_\mathrm{ex}(t), \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ6.gif"/></alternatives></disp-formula>where <italic>x</italic> is the generic degree of freedom, <italic>M</italic> is the mass, <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>∞</mml:mi></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_\infty $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq30.gif"/></alternatives></inline-formula> is the infinity frequency added mass asymptote, <italic>G</italic> is the stiffness, <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">ex</mml:mi></mml:msub></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_\mathrm{ex}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq31.gif"/></alternatives></inline-formula> is the exciting force and the kernel <italic>K</italic> of the convolution term is the retardation function. The calculation of <italic>K</italic> and <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>A</mml:mi><mml:mi>∞</mml:mi></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_\infty $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq32.gif"/></alternatives></inline-formula> is made applying Ogilvie’s relationships (Ogilvie <xref ref-type="bibr" rid="CR35">1964</xref>):<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi mathvariant="italic">π</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="italic">ω</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;K(t)=\frac{2}{\pi }\int _0^\infty B(\omega ){cos}(\omega t)\mathrm{d}\omega ,\end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ7.gif"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;A_\infty =\lim _{\omega \rightarrow \infty } A(\omega ). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ8.gif"/></alternatives></disp-formula>Finally, since the direct computation of the integral in (<xref rid="Equ6" ref-type="disp-formula">6</xref>) is expensive, the convolution term can been replaced by a state space representation (Jefferys <xref ref-type="bibr" rid="CR29">1980</xref>) pages 413–438, as showed by Taghipour et al. (<xref ref-type="bibr" rid="CR45">2007</xref>). In this way, the whole dynamic problem becomes a computationally efficient set of first-order differential equations.</p><p id="Par28">The identification of a state space model is performed using the toolbox provided by Perez and Fossen (<xref ref-type="bibr" rid="CR39">2009</xref>), which automatically selects a proper order, hereafter called <italic>n</italic>, to approximate the convolution integral. Therefore, the overall dynamical system order of the system (<xref rid="Equ6" ref-type="disp-formula">6</xref>) becomes <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 + n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq33.gif"/></alternatives></inline-formula>.</p><p id="Par29">In any case, since the oscillatory behavior of a floating object resembles the dynamics of a simple constant mass–damper–spring system, Fusco and Ringwood (<xref ref-type="bibr" rid="CR19">2011</xref>) propose a second-order approximation, namely reducing the state space order to zero, i.e., the complete system order to two. The reduction is reasonable if the system is described by a dominant pole pair. The evaluation of the relevance of each order is made by means of the Hankel singular values of the complete system <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq34.gif"/></alternatives></inline-formula>, which are used to quantify the energy content of each order <italic>i</italic> (Safonov et al. <xref ref-type="bibr" rid="CR42">1990</xref>). If arranged in descending order, namely <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:mo>⋯</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _1 \ge \sigma _2 \ge \cdots \ge \sigma _{n+2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq35.gif"/></alternatives></inline-formula>, the second-order approximation is reliable if <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _2&gt;&gt;\sigma _3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq36.gif"/></alternatives></inline-formula>.</p><p id="Par30">The second-order system approximation presents a constant damping term, so Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>) can be rearranged to match the standard second-order dynamical system:<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¨</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="italic">ζ</mml:mi><mml:msub><mml:mi mathvariant="italic">ω</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="italic">ω</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ddot{x}+2 \zeta \omega _\mathrm{n} \dot{x} + \omega _\mathrm{n}^2 x = 0, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ9.gif"/></alternatives></disp-formula>where <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mi mathvariant="italic">ζ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\zeta &lt;1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq37.gif"/></alternatives></inline-formula> is the damping ratio and <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:msub><mml:mi mathvariant="italic">ω</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="italic">π</mml:mi></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _\mathrm{n}=\frac{2\pi }{T_\mathrm{n}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq38.gif"/></alternatives></inline-formula> is the natural frequency. Notwithstanding the approximation introduced, the advantage of the order reduction is the possibility to analytically evaluate the effect of damping on the system dynamics. Since the damped natural frequency is defined as<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="italic">ω</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">ω</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="italic">ζ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \omega _\mathrm{d} = \omega _\mathrm{n} \sqrt{1-\zeta ^2}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ10.gif"/></alternatives></disp-formula>it is smaller than the natural frequency. Consequently, the presence of damping reduces the ideal optimal latching duration:<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">ω</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">ω</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="italic">ζ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_\mathrm{L} = \frac{T_\omega }{2} - \frac{T_\mathrm{L}}{2} = \frac{T_\omega }{2} - \frac{T_\mathrm{n}}{2 \sqrt{1-\zeta ^2}} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ11.gif"/></alternatives></disp-formula>The approximation error introduced by Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) is proportional to the damping factor of the non-reduced system, which is not as explicitly accessible as in the standard second-order differential equation (<xref rid="Equ9" ref-type="disp-formula">9</xref>). The second-order reduction may be of assistance if the whole system is clearly second-order-dominant, namely if the approximation introduced by the order reduction is negligible. Since every case should be assessed for second-order dominance, it is not possible to give to the method a general validity. Therefore, <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq39.gif"/></alternatives></inline-formula> is not always exactly definable and <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{n}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq40.gif"/></alternatives></inline-formula> is used instead, aware that the actual optimal <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq41.gif"/></alternatives></inline-formula> will be smaller, accordingly to the damping factor of the system.</p></sec></sec><sec id="Sec8"><title>Constant latching duration</title><p id="Par31">The basic latching control algorithm applies to devices subject to monochromatic waves, and utilizes a constant latching duration, which is equal for both positive and negative peaks. Conversely, alternative and adaptive latching duration options are available to deal with nonlinear dynamics, as further explained in <xref rid="Sec12" ref-type="sec">3.4</xref>.</p><p id="Par32">The control algorithm allows the user to choose which axis the latching control should be applied to, either in surge (<italic>X</italic> axis), sway (<italic>Y</italic> axis) or heave (<italic>Z</italic> axis) motion. The conventional right-handed coordinate system assumes the incoming wave along the <italic>x</italic>-axis, the gravity acting on the negative direction of the <italic>z</italic>-axis and the <italic>y</italic>-axis oriented according to the right-hand-rule.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Constant latching duration control strategy. Simulation time: <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">sim</mml:mi></mml:msub></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{sim}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq42.gif"/></alternatives></inline-formula>; time step: <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq43.gif"/></alternatives></inline-formula>; transition time: <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">transition</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{transition}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq44.gif"/></alternatives></inline-formula>; velocity: <italic>v</italic>; latching duration <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq45.gif"/></alternatives></inline-formula>; unlatching instant: <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:msub></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{u}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq46.gif"/></alternatives></inline-formula></p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig3_HTML.gif" id="MO14"/></fig></p><p id="Par33">In order to be effective, the controller must be able to detect when the latching conditions are verified and actually lock the motion for as long as required by the latching controller. The innovation introduced by the new control algorithm is the dynamical use of constraints to perform the latching act: instead of being applied just at the beginning of the simulation, constraints in the controlled degree of freedom are imposed when the body is latched and removed when the body is released. The timing with which the controller intervenes is defined by the control strategy, whose logic is shown in the flowchart in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p><p id="Par34">The control algorithm is programmed to apply Newton’s second law of dynamics at every time step <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq47.gif"/></alternatives></inline-formula> of the simulation time <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">sim</mml:mi></mml:msub></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{sim}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq48.gif"/></alternatives></inline-formula> and update the state variables of position, velocity and acceleration. Prior to the application of Newton’s law, the control algorithm sets the constraints accordingly to the latching status.</p><p id="Par35">The initial conditions normally assume the floating body in quiet equilibrium in the numerical wave tank at the still water level. When the simulation starts, the waves are gradually created in the generation zone and travel towards the device which, in turn, begins to move. Hence, the control loop is bypassed for a transition time <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">transition</mml:mi></mml:msub></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{transition}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq49.gif"/></alternatives></inline-formula>, defined by the user, to allow the device motion to reach steady state.</p><p id="Par36">Then, the latching condition of zero velocity at the extrema of displacement needs to be verified. Due to numerical precision, a null velocity is very unlikely, so the multiplication between the values in two successive time steps (<inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">sim</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">sim</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(t_\mathrm{sim}) \cdot v(t_\mathrm{sim}-\Delta t )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq50.gif"/></alternatives></inline-formula>) is checked instead: in the case of an extremum, the product must be either negative or null. Furthermore, when the body is latched, the velocity is exactly set equal to zero, so the null-multiplication-condition is verified as well. Consequently, it is important to asses whether the body has just reached the peak or it was already locked in the extremum from the previous time step, i.e., whether or not the body was latched in the last iteration. In the very first sample point that the controller locks the device, the unlatching instant <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:msub></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_\mathrm{u}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq51.gif"/></alternatives></inline-formula> is defined by adding the latching duration to the simulation time. The body is kept in position until the latching duration is elapsed, then is freed to escape from the extreme position.</p><p id="Par37">Summing up, use of the latching control algorithm requires the user to declare the type of latching control (constant, alternative or adaptive), the degree of freedom (surge, sway or heave) that is to be latched, the value of latching time and starting time. If some of the parameters are omitted, default values are set in the source code.</p></sec><sec id="Sec9"><title>Latching duration and natural period</title><p id="Par38">The main important parameter to choose to perform the latching control is the latching duration. If the incoming wave is monochromatic, Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) achieves an optimal control, as long as the natural period of the controlled device is known and the damping term <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mi mathvariant="italic">ζ</mml:mi></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\zeta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq52.gif"/></alternatives></inline-formula> is negligible. If damping is not negligible, then (<xref rid="Equ11" ref-type="disp-formula">11</xref>) can be used instead. Unfortunately, the definition of a unique characteristic natural period is not straightforward if the linear assumption of small motion is not made, as explained in <xref rid="Sec10" ref-type="sec">3.3.1</xref>. Since the amplitude of the motion is exaggerated by the latching control, the small motion hypothesis is generally mistaken.</p><sec id="Sec10"><title>Natural period</title><p id="Par39">In dynamics, the natural period (or frequency) describes how fast the body oscillates if displaced from an equilibrium position and set free to move. The natural frequency is calculated from the inertia and the stiffness terms of the equation of motion. Equation (<xref rid="Equ5" ref-type="disp-formula">5</xref>) shows the frequency dependence of the added mass <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq53.gif"/></alternatives></inline-formula> and damping term <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B(\omega )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq54.gif"/></alternatives></inline-formula>, while the mass <italic>M</italic> and the stiffness <italic>G</italic> are constant.</p><p id="Par40">Actually, Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>) is accurate only in a range of motion around the equilibrium, small enough to consider the wetted body surface constant. The added mass (which is the mass of water accelerated by the body motion, therefore depending on the submerged portion of the body) and the hydrostatic stiffness (which depends on the cross section piercing the water) both depend on the instantaneous wetted surface, with the notional dependence shown by <italic>A</italic>(<italic>x</italic>(<italic>t</italic>)) and <italic>G</italic>(<italic>x</italic>(<italic>t</italic>)) in (<xref rid="Equ12" ref-type="disp-formula">12</xref>), respectively. The natural period, which is defined for a linear case as a time-invariant characteristic of the body, is not a proper descriptor under large motion conditions. A new quantity called the instantaneous natural period is defined by (<xref rid="Equ12" ref-type="disp-formula">12</xref>), which returns the natural period relative to the actual submerged portion of the body at each time instant. Hence, the instantaneous natural period is able to capture the nonlinear relation between the natural period and the motion of the body.<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="italic">π</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_\mathrm{n}(x(t))= 2 \pi \sqrt{\frac{M+A(x(t))}{G(x(t))}}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ12.gif"/></alternatives></disp-formula>Consequently, the instantaneous damped natural period depends on the instantaneous natural period as well as on the hydrodynamics of the system.<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T_\mathrm{L}(x(t))= T_\mathrm{n}(x(t))f(B,M,A). \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ13.gif"/></alternatives></disp-formula>In <xref rid="Sec11" ref-type="sec">3.3.2</xref> a free decay time series from CFD simulation is used to appreciate the range of variability of the instantaneous natural period.</p></sec><sec id="Sec11"><title>Free response tests</title><p id="Par41">The natural period is a description of the dynamical behavior of a body left free to move from a position of non-equilibrium. Therefore, a reliable measurement of the actual natural period can be obtained from a free decay test, performed either in a real or numerical tank. While in a linear analysis, eventually inaccurate assumptions are needed to calculate the natural period, here it is directly measured from the time series, which is inclusive of all the nonlinearities instead.</p><p id="Par42">During the evolution of the free decay, both the amplitude and the frequency are changing in time. For the sake of simplicity, the two variables are separated, so that:<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="italic">ω</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x(t)=A(t)\mathrm{sin}(\omega _\mathrm{n}(t)t+\phi ) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_Equ14.gif"/></alternatives></disp-formula>The natural period is defined as the time lag between two successive homologous (referring to points of equal displacement, a period apart) points of the harmonic function. Since the amplitude is not constant, it is straightforward to sample the natural period at the extrema or the zero-crossings. While a discrete description is valuable, a more precise and continuous trend is required to understand how the nonlinearities gradually modify the dynamics as the amplitude varies. Hence, in order to spot all the couples of consequent homologous points, Eq. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) needs to be normalized, i.e., divided by the envelope that connects the absolute value of all the peaks and troughs.</p><p id="Par43">As an example, the instantaneous natural period has been calculated for a semisubmerged sphere with radius and draft of 0.125 m, hence with the center of gravity at the free surface height. A heave-free decay is simulated in a CFD environment, starting with the center of gravity at -0.1 m. The resulting instantaneous natural period variations in time are shown via the solid line in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In the same graph, the envelope of the free decay time series is drawn in dotted line, along with the indication of peaks and troughs.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Instantaneous natural period for a CFD heave-free decay test of a sphere with radius of 0.125 m</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig4_HTML.gif" id="MO18"/></fig></p><p id="Par44">As the time elapses, the amplitude of the free decay decreases and the natural period becomes shorter, until it matches the linear natural period, represented by the horizontal dashed line. The transition toward the minimum of 0.69 s is smooth, with a maximum variation of about 7 %, from the highest value of 0.74 s that occurs for an amplitude around 0.1 m. Note a systematic alternation of concavity and convexity, respectively, occurring at the peaks and troughs of the free decay displacement. As a consequence, it is possible to infer that, at equal amplitude, the natural period is relatively longer at positive displacement, than at negative. Indeed, at the right side of Fig. <xref rid="Fig4" ref-type="fig">4</xref>, where the steepness of the curve is lower, the variability of the natural period between peaks and troughs is more evident. Further insight can be produced by simulating a free decay from a symmetric initial condition, namely starting from 0.1 m instead of <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mo>-</mml:mo></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq55.gif"/></alternatives></inline-formula>0.1 m. The resulting instantaneous natural period, shown in dash-dot line in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, follows the same average trend, but with a symmetric alternation of concavity and convexity, which confirms that at equal magnitude of motion, the natural period is different inside and outside the water. The discrepancy between peaks and troughs becomes smaller as the amplitude decreases. The principal effect responsible for the different natural periods at peaks and troughs is the asymmetric action of the viscous forces, since the body is surrounded by two fluids, mainly water at troughs and mainly air at peaks, with very different viscous coefficients.</p><p id="Par45">Finally, as far as the constant latching duration algorithm is concerned, the instantaneous natural period analysis allows a more effective selection of the latching period. A reasonable forecast of the amplitude of motion acquirable, for example, through a linear simulation, can point to the zone of the envelope in which the body will oscillate under control. Consequently, the corresponding natural period allows the selection of a more suitable latching duration.</p></sec></sec><sec id="Sec12"><title>Alternative and adaptive latching durations</title><p id="Par46">Following the discussion about the variability of the natural period in Sect. <xref rid="Sec11" ref-type="sec">3.3.2</xref>, the choice of the latching duration is not obvious. Since the instantaneous natural period is systematically longer than the linear one, Eqs. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) or (<xref rid="Equ11" ref-type="disp-formula">11</xref>) lead to a shorter latching period. The optimal duration is not clearly defined, since it depends on the amplitude of the motion, which in turn, depends on the latching duration itself. Moreover, the asymmetric behavior between peaks and troughs adds a further degree of complexity. The present control algorithm proposes two options to partially overcome the issues of the non-constant natural period: alternative and adaptive latching control strategies.</p><p id="Par47">The alternative latching control aims to provide more flexibility to the control algorithm, allowing the definition of two different latching periods for peaks and troughs. Even though the choice is still arbitrary, an instantaneous natural period analysis of a free decay test, as in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, may be of assistance. Since the natural period at peaks is longer than at troughs, typically the latching duration should be shorter at positive extrema.</p><p id="Par48">The second option available is the adaptive latching control, which is an optimization tool used to find out the latching period that maximizes the amplitude of oscillation of the controlled body. A similar approach has already been applied by Peñalba et al. (<xref ref-type="bibr" rid="CR38">2015</xref>) to overcome the uncertainty of the latching duration due to a partially nonlinear model.</p><p id="Par49">The optimization loop is based on the assumption of the existence and uniqueness of an optimal point, which is the only maximum of a convex performance function. As widely explained in <xref rid="Sec11" ref-type="sec">3.3.2</xref>, the presence of nonlinearities decreases the optimal latching duration. On the other hand, a null value for the latching period implies absence of control, which is implicitly not optimal, unless the natural period is the same of the wave period. The uniqueness of the optimal solution is not straightforward to prove, but a comparison with linear case can bring confidence: constant latching duration control has been implemented in a linear simulation model with several latching periods in order to draw the performance curve in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Performance curve of latching control using a linear simulation for a sphere with radius of 0.125 m</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig5_HTML.gif" id="MO19"/></fig></p><p id="Par50">The graph in Fig. <xref rid="Fig5" ref-type="fig">5</xref> validates the assumption of uniqueness of the optimal point in a linear model, equal to 0.205 s, correspondent to an equivalent natural period of 0.709 s. The optimal latching duration is highlighted by a circle marker on the top of the convex curve of Fig. <xref rid="Fig5" ref-type="fig">5</xref>.</p><p id="Par51">Also in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the square marker represents the linear undamped approximation calculated by Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>). As expected, the damping makes the actual optimal latching duration smaller than the undamped, in this case 3.8 % smaller.</p><p id="Par52">The model order reduction using the Hankel singular values as estimators of the significant order of the system, proposed in <xref rid="Sec10" ref-type="sec">3.3.1</xref>, has been applied to approximate the linear model with a second-order differential equation and evaluate the damped natural frequency. The ratio of the second and third-order Hankel singular values, about 43, is big but not enough to give absolute confidence in the reduction. As a matter of fact, the method was successfully applied by Fusco and Ringwood (<xref ref-type="bibr" rid="CR19">2011</xref>) to geometries with ratio ranging between 230 and 3204. Nevertheless, the reduction suggests a value of damping factor <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mi mathvariant="italic">ζ</mml:mi></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\zeta $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq56.gif"/></alternatives></inline-formula> of about 0.1, which in turn make the damped natural period rise from 0.693 to 0.698 s.</p><p id="Par53">The calculation of the optimal point in the linear case is made possible by the low computational cost of the simulations. A similar approach in CFD is not feasible, due to the huge computational effort required by each simulation.</p><p id="Par54">The approach pursued by the adaptive control algorithm is to tune the latching period within just one simulation run, aiming to maximize the displacement of the body. The first latching duration is an educated guess based, for example, on the linear or the instantaneous natural period. When latching is applied, the amplitude gradually increases, either monotonically or with an intermediate maximum, and stabilizes to a steady value. As the amplitude changes, the period of motion adapts accordingly and, after a transient, stabilizes, matching the forcing wave period. Likewise, when a modification to the latching duration is carried out, both the amplitude and the response period experience a transient that ultimately leads to a steady state. Clearly, the transient is longer when the latching is applied for the first time than when the latching period is adapted. The adaptive algorithm’s task is to wait for the steady state to occur, then update the latching period in order to increase the response of the device, taking into account the records of previous modifications.</p><p id="Par55">The adaptive strategy code is nested in the constant algorithm shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The constant latching duration algorithm takes care of applying the control when peaks occur, using the latching period previously established by the adaptive algorithm. As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, the adaptive strategy is coded right before the latching algorithm and eventually modifies the latching duration.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Adaptive latching duration control strategy. Latching duration: <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq57.gif"/></alternatives></inline-formula>; latching duration increment: <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq58.gif"/></alternatives></inline-formula></p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig6_HTML.gif" id="MO20"/></fig></p><p id="Par56">The adaptive strategy is divided in two phases: it first identifies when the period and amplitude are stable, then modifies the latching duration. The steadiness is achieved when the motion period matches the wave period and the amplitude is constant, both within the percentage tolerances set either by the user or by default. Once the transient has elapsed, the stable value of the amplitude is recorded and compared with the last stable value in memory, in order to ascertain whether the last modification of the latching duration increased the stable amplitude. Assuming the convexity of the performance function, similar to Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the latching duration is progressively reduced, with a certain step <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta T_\mathrm{L}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq59.gif"/></alternatives></inline-formula>, as long as the performance improves. Conversely, a worsening happens if the maxima has been exceeded, so the direction of research is inverted and the step is halved to refine the quest.</p></sec><sec id="Sec13"><title>Case study</title><p id="Par57">In order to actually show the performance of the latching control algorithm and to highlight the strengths and weaknesses of the CFD implementation, a case study is presented. The CFD simulations are carried out in both 3D and 2D, hence the body is, respectively, a sphere (3D simulations) and a circle (2D simulations) of radius 0.125 m and draft of 0.125 m. The device is constrained to move in the heave direction. The incoming wave is a linear harmonic function with constant amplitude and period in order to clearly show the nonlinear effects and the action of the adaptive latching algorithm. The wave amplitude is 0.015 m, such that the oscillation of the body is comparable to its dimension, highlighting nonlinearities. The wave period is 1.118 s, longer than the natural period of both the sphere and the circle, which are between 0.671 s and 0.894 s, allowing latching to be an effective controller, as explained in <xref rid="Sec6" ref-type="sec">3.1</xref>.</p><p id="Par58">A schematic representation of the device within the Numerical Wave Tank is given in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. For all the details about the CFD implementation in OpenFOAM, such as the Numerical Wave Tank, the mesh, the solver, the boundary conditions, etc., refer to Davidson et al. (<xref ref-type="bibr" rid="CR14">2015a</xref>). A more detailed description of the boundary conditions is presented in the appendix. Due to the small characteristic length of the device, the Reynolds number is about <inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \cdot 10^4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq60.gif"/></alternatives></inline-formula> and the flow can be assumed as laminar. This assumption is in agreement with the experiments of Zurkinden et al. (<xref ref-type="bibr" rid="CR51">2014</xref>) and Bhinder et al. (<xref ref-type="bibr" rid="CR7">2011</xref>).</p><p id="Par59">Generally, the definition and meshing of the computational domain has the main consequences on the success and quality of the simulation. The most relevant issues related to a controlled floating object are analyzed. The risk of failure due to over-deformation of the cells is particularly important when control is applied, since the numerous big amplitudes of motion caused by the controller stress the whole mesh around the device. On the other hand, the accuracy of the generated waves depends both on the cell dimension at the free surface elevation and on the size of the generation and absorption zones. A rule of thumb is that the generation zone has to be between two and three times the wave length. In the present case study, the wave length is 1.95 m, which means at least 3.9 m for the generation zone. The resulting mesh is presented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. As described in detail by Davidson et al. (<xref ref-type="bibr" rid="CR14">2015a</xref>), the central region contains a high-density mesh, that horizontally stretches with distance away from the device. Furthermore, the free surface region presents a high-density mesh in the vertical direction. A boundary layer of finer mesh has been added around the floater in order to describe correctly the viscous effects. The thickness of the boundary layer has been determined using the Blasius solution, chapter 9 of Kundu et al. (<xref ref-type="bibr" rid="CR31">2011</xref>), resulting in a total thickness of 7.6 mm, divided with ten grid points.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Computational mesh of the numerical wave tank domain. Central region with high-density mesh; free surface region with high vertical density mesh</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig7_HTML.gif" id="MO21"/></fig></p><p id="Par60">Doubtless, the biggest impact on the computational load is made by the number of dimensions simulated, namely two or three, where the third dimension is horizontal and perpendicular to the incoming wave direction. The 2D-boundary conditions are such that all the equations are solved within the plane. As a consequence, the equivalent three-dimensional counterpart is a cylinder of infinite length along the third dimension.</p><p id="Par61">In the simulations performed for this paper, in equal hardware conditions, the simulation time required by a 3D simulation is approximately 500 times bigger than its homologous in 2D. In absolute terms, 60 s of 3D simulation typically requires the order of magnitude of several days or weeks of computation. Such a long time makes prohibitive to run a wide range of diverse simulations.</p><p id="Par62">Therefore, the main focus is on the 2D simulations, since the shorter computational time makes possible to change several parameters and analyze the behavior of the control algorithm. Section <xref rid="Sec14" ref-type="sec">4</xref> shows the performances of the constant and adaptive latching duration control applied to the two-dimensional case study. Anyway, one single 3D latching simulation, along with other 2D simulations, has been used in Sect. <xref rid="Sec15" ref-type="sec">5</xref> to draw a comparison against a linear model.</p></sec></sec><sec id="Sec14" sec-type="results"><title>Results</title><p id="Par63">The results of the 2D case study are presented. By means of the free decay analysis described in <xref rid="Sec11" ref-type="sec">3.3.2</xref>, the instantaneous natural period has been found to range between 0.827 and 0.783 s. A basic constant latching duration control is applied with a latching duration of 0.145 s, corresponding to the nonlinear natural period of 0.827 s. The resulting time series is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Constant latching duration control of a circle of radius 0.125 m using a 2D CFD simulation, with regular wave (height: 0.015 m, period: 1.118 s) and latching duration of 0.145 s</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig8_HTML.gif" id="MO22"/></fig></p><p id="Par64">The controller is activated after 6.5 s, in order to wait for the wave to arrive and excite steadily the body. When latching is applied, the amplitude increases, reaches a maximum and decreases toward a stable value. The improvement in amplitude achieved by the controller in this case is of the 38 %.</p><p id="Par65">In the steady unlatched condition, the period of motion is the same of the wave. When latching is applied, the period suddenly increases and then is forced to match the excitation period again. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the decay of the period against the number of peaks after the beginning of the latching.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Decay of the period of motion of the response in Fig. <xref rid="Fig8" ref-type="fig">8</xref> when latching control is applied. The <italic>horizontal axis</italic> represents the number of peaks from the beginning of latching</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig9_HTML.gif" id="MO23"/></fig></p><p id="Par66">The adaptive latching duration control calculation of Fig. <xref rid="Fig6" ref-type="fig">6</xref> has been applied, initialized with a latching duration of 0.145 s, corresponding to the nonlinear natural period of 0.827 s. After 9 modifications of the latching duration, the resulting optimum point has been identified at 0.1146 s, leading to an increment of amplitude of 49 %. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows the progression of the optimization: the vertical bars indicate the modification steps of the latching duration, while the line graph represents the corresponding stable amplitude achieved. The horizontal axis shows the simulation time when the stable amplitude is reached. Note that, in order to define the latching duration with a four-digit resolution, the simulation time step must be smaller or equal to 0.0005 s.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Iterations of the adaptive latching duration control algorithm: the <italic>horizontal axis</italic> represents the simulation time when the stable amplitude is reached and a modification to the latching duration is performed</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig10_HTML.gif" id="MO24"/></fig><fig id="Fig11"><label>Fig. 11</label><caption xml:lang="en"><p>Performance curve of latching control using a two-dimensional CFD simulation for a circle of radius 0.125 m</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig11_HTML.gif" id="MO25"/></fig></p><p id="Par67">As a first step, the latching duration is decreased, because the nonlinear natural period is longer than the linear. Then, as long as the stable amplitude increases the latching duration is decreased. Conversely, every time the stable amplitude decreases, the research of the optimal latching duration is inverted and refined. The graph in Fig. <xref rid="Fig10" ref-type="fig">10</xref> shows that the optimization algorithm effectively converges.</p><p id="Par68">The foundations of the adaptive algorithm are built on the hypothesis of convexity of the performance curve, assuming the full nonlinear CFD to behave similarly to the linear case shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. In order to validate such assumption, the performance curve has been reconstructed using several constant latching duration simulations at different latching periods. The results are shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>.</p><p id="Par69">As expected, the performance trend presents an unique peak, occurring for the very same latching period pointed by the adaptive algorithm. Moreover, the optimal latching duration for the CFD fully nonlinear model is smaller than the optimal latching duration for the linear model. The graph highlights the amplitude gained with the linear natural period of 0.783 s, i.e., latching duration of 0.168 s. Finally, the performance achieved with latching duration of 0.145 s is closer to the optimal than to the linear, validating the approach of the instantaneous natural period analysis. Table <xref rid="Tab1" ref-type="table">1</xref> summaries the amplitudes and percentage improvements obtained with the three choices of latching duration, namely linear natural period, nonlinear instantaneous natural period, optimized latching period with the adaptive algorithm. Table <xref rid="Tab1" ref-type="table">1</xref> shows that the controller efficiency is quite sensitive to the latching duration, making the physical implementation troublesome. For example, a 15 % relative difference of latching duration between 0.168 and 0.145 s causes a 30 % degradation in efficiency. Previous work has studied the sensitivity to latching duration (Babarit and Clement <xref ref-type="bibr" rid="CR3">2009</xref>), which is mainly due to the sharp edges and abrupt modification of the control force. Note that controllers other than latching may implement a similar force characteristic (Bacelli and Ringwood <xref ref-type="bibr" rid="CR5">2015</xref>). Implementing the exact latching duration in a real device can be quite difficult due to the delay between the instant when latching is commanded and the instant when the latching system actually locks the device. Various strategies have been tested in order to mitigate such difficulties: Henriques et al. (<xref ref-type="bibr" rid="CR25">2012</xref>) utilize the threshold unlatching criterion while Durand et al. (<xref ref-type="bibr" rid="CR16">2007</xref>) advance the latching/unlatching instants to cover the latching system response delay.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Latching control performances using a two-dimensional CFD simulation for a circle of radius 0.125 m</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Latching duration [s]</p></th><th align="left"><p>Amplitude [m]</p></th><th align="left"><p>Improvement (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0</p></td><td align="left"><p>0.083</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>0.168</p></td><td align="left"><p>0.089</p></td><td align="left"><p>8</p></td></tr><tr><td align="left"><p>0.145</p></td><td align="left"><p>0.026</p></td><td align="left"><p>38</p></td></tr><tr><td align="left"><p>0.1146</p></td><td align="left"><p>0.028</p></td><td align="left"><p>49</p></td></tr></tbody></table><table-wrap-foot><p>The percentage improvements refer to the unlatched case</p></table-wrap-foot></table-wrap></p><p id="Par70"><fig id="Fig12"><label>Fig. 12</label><caption xml:lang="en"><p>Figure <xref rid="Fig11" ref-type="fig">11</xref> constant latching duration control of a sphere of radius 0.125 m using a linear simulation, with regular wave (height: 0.015 m, period: 0.118 s) and latching duration of 0.205 s</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig12_HTML.gif" id="MO26"/></fig><fig id="Fig13"><label>Fig. 13</label><caption xml:lang="en"><p>Figure <xref rid="Fig12" ref-type="fig">12</xref> constant latching duration control of a sphere of radius 0.125 m using a 3D CFD simulation, with regular wave (height: 0.015 m, period: 0.118 s) and latching duration of 0.205 s</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig13_HTML.gif" id="MO27"/></fig></p></sec><sec id="Sec15" sec-type="discussion"><title>Discussion</title><p id="Par71">The implementation of latching control in CFD is valuable for being able to include all the nonlinearities and reproduce results more realistic than the linear model ones. Nevertheless, the huge computational cost makes prohibitive an intensive application, especially in an early design stage. On the other side, a more suitable usage can be to provide a benchmark to validate and evaluate the results of linear or partially nonlinear simulation models, eventually defining a range of reliability in which the linear model is acceptable. Indeed, Sect. <xref rid="Sec16" ref-type="sec">5.1</xref> compares the results of a linear model with the outcome of CFD.</p><sec id="Sec16"><title>Comparison with linear model</title><p id="Par72">The 3D case study has been simulated in CFD in order to make a comparison with the linear simulation model. The latching duration has been chosen equal to 0.205 s, matching the linear optimal latching duration showed in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The resulting linear and CFD time series are shown, respectively, in Figs. <xref rid="Fig12" ref-type="fig">12</xref> and <xref rid="Fig13" ref-type="fig">13</xref>.</p><p id="Par73">The first evident difference is in the transient shape: while the linear simulation shows a monotonic growth towards the steady value, the CFD time series presents an oscillatory behavior with a visible maximum and minimum before stabilizing. When the dynamics elapses, the steady amplitude of motion in CFD is equal to 0.074 m, smaller than the 0.084 m of the linear model. Furthermore, the transient in CFD lasts in about 33 s, 3 times longer than in the linear simulation, which reaches the steady state in less than 11 s. The amplitude transient is linked to a significant period of motion transient, shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>.<fig id="Fig14"><label>Fig. 14</label><caption xml:lang="en"><p>Figure <xref rid="Fig13" ref-type="fig">13</xref> decay of the period of motion of the response in Fig. <xref rid="Fig13" ref-type="fig">13</xref> when latching control is applied. The horizontal axis represents the number of peaks from the beginning of latching</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig14_HTML.gif" id="MO28"/></fig><fig id="Fig15"><label>Fig. 15</label><caption xml:lang="en"><p>Figure <xref rid="Fig14" ref-type="fig">14</xref> response amplitude operators of horizontal cylinders with 0.125 m radius and length ranging from 0.25 to 2.5 m</p></caption><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/40722_2016_52_Fig15_HTML.gif" id="MO29"/></fig></p><p id="Par74">Section <xref rid="Sec14" ref-type="sec">4</xref> showed several two-dimensional results that need to be compared as well. Since the hydrodynamic matrices needed for the linear simulations are computable only for 3D geometries, a direct comparison requires the BEM software to simulate an infinite long cylinder. With a practical point of view, a cylinder is considered infinitely long when a variation of length doesn’t produce a variation of response. Indeed, Fig. <xref rid="Fig15" ref-type="fig">15</xref> shows the asymptotic trend of the response amplitude operator (RAO), which is the transfer function between the surface elevation and the displacement of the body.</p><p id="Par75">Therefore, control has been applied to a long horizontal cylinder of 2.5 m. The relative improvements achieved with respect to the unlatched motion are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>. As in Sect. <xref rid="Sec12" ref-type="sec">3.4</xref> for the sphere, the actual optimal latching duration is smaller than the linear approximation, respectively 0.132 and 0.168 s. The relative difference in latching duration is about 21.3 %, considerably bigger than the 3.8 % of the sphere. The bigger discrepancy is coherent with the higher damping that an infinite long cylinder provides to the system.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Comparison between latching performances in linear and CFD simulations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Latching duration [s]</p></th><th align="left"><p>Linear improvement (%)</p></th><th align="left"><p>CFD improvement (%)</p></th></tr></thead><tbody><tr><td align="left"><p>0.168</p></td><td align="left"><p>30</p></td><td align="left"><p>8</p></td></tr><tr><td align="left"><p>0.145</p></td><td align="left"><p>57</p></td><td align="left"><p>38</p></td></tr><tr><td align="left"><p>0.132</p></td><td align="left"><p>62</p></td><td align="left"><p>40</p></td></tr><tr><td align="left"><p>0.1146</p></td><td align="left"><p>56</p></td><td align="left"><p>49</p></td></tr></tbody></table><table-wrap-foot><p>The percentage improvements refer to the unlatched case</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Boundary conditions for the 3D numerical wave tank using OpenFOAM 2.3</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><p><inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:mi mathvariant="italic">α</mml:mi></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq61.gif"/></alternatives></inline-formula></p></th><th align="left"><p><italic>U</italic></p></th><th align="left"><p><inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_d$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq62.gif"/></alternatives></inline-formula></p></th><th align="left"><p>pointDisplacement</p></th></tr></thead><tbody><tr><td align="center"><p>Front</p></td><td align="left"><p>symmetryPlane</p></td><td align="left"><p>symmetryPlane</p></td><td align="left"><p>symmetryPlane</p></td><td align="left"><p>symmetryPlane</p></td></tr><tr><td align="center"><p>Back</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td></tr><tr><td align="center"><p>Inlet</p></td><td align="left"><p>waveAlpha</p></td><td align="left"><p>waveVelocity</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td></tr><tr><td align="center"><p>Outlet</p></td><td align="left"><p>waveAlpha</p></td><td align="left"><p>waveVelocity</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td></tr><tr><td align="center"><p>Bottom</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>fixedValue (0)</p></td></tr><tr><td align="center"><p>Atmosphere</p></td><td align="left"><p>inletOutlet</p></td><td align="left"><p>pressureInletOuletVelocity</p></td><td align="left"><p>totalPressure</p></td><td align="left"><p>fixedValue (0)</p></td></tr><tr><td align="center"><p>Sphere</p></td><td align="left"><p>zeroGradient</p></td><td align="left"><p>movingWallVelocity</p></td><td align="left"><p>fixedFluxPressure</p></td><td align="left"><p>calculated</p></td></tr></tbody></table></table-wrap></p><p id="Par76">The presence of viscous losses and nonlinearities causes the CFD improvements to be considerably lower than the linear for every latching duration. The overestimation of the amplitude in the linear model leads to a too optimistic prediction of the power caption under control. Notwithstanding the importance of an accurate prediction of the motion, the key feature to highlight is the different optimal latching duration. While the best linear performance happens at 0.132 s with an improvement of 62 %, the CFD simulation shows a lower improvement of 49 % at a smaller latching duration of 0.1146 s.</p><p id="Par77">As far as the controller is concerned, the main purpose of the simulation model is to reveal the optimal latching duration for the real device. An inaccurate simulation model is not only unable to effectively predict the response, but also points to a latching duration which, even though is optimal for the simulation model, is suboptimal for the real device. Since the CFD model is more accurate than the linear model, the main advantage of having the latching control algorithm implemented in CFD is to indicate a latching duration that suits better the real device.</p></sec></sec><sec id="Sec17" sec-type="conclusions"><title>Conclusions</title><p id="Par78">The controller performances and parameters are strictly related to the simulation model and its accuracy. The reliability, as well as the complexity of a model depend on the ability of describing nonlinear behavior. The simplest and computational lightest model is linear, while CFD is able to include all the nonlinearities, at the prize of a huge computational load. The matter of fact is that nonlinearities are magnified by the control, which exaggerates the amplitude of motion and applies abrupt forces directly on the device. While linearization can be acceptable with the uncontrolled device, it becomes an oversimplification when control is applied. Nevertheless, control has never been applied in a CFD environment. In this paper, latching control has been implemented in the CFD open source software OpenFOAM.</p><p id="Par79">The results confirm that founding the latching control on a linear model is misleading and not optimal. Primarily, the amplitudes calculated by the linear model are too optimistic, leading to an overestimation of the power extraction. Moreover, the optimal latching duration pointed out by the linear model is inadequate to maximize the performances of the real device. As a matter of fact, the optimal latching duration depends on the natural period, which is not constant and unique as in the linear approximation. On the contrary, the nonlinear natural period is enlarged by the damping of the system and varies along with the displacement of the device. An optimization tool has been coded in CFD in order to find the actual optimal latching duration, which is smaller than the linear due to the bigger natural period.</p></sec></body><back><ack><title>Acknowledgments</title><p>This paper is based upon work supported by Science Foundation Ireland under Grant No. 13/IA/1886.</p></ack><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><mixed-citation publication-type="other">Afshar MA (2010) Numerical wave generation in openFOAM. Master’s thesis, Chalmers University of Technology</mixed-citation></ref><ref id="CR2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Babarit</surname><given-names>A</given-names></name><name><surname>Clément</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Optimal latching control of a wave energy device in regular and irregular waves</article-title><source>Appl Ocean Res</source><year>2006</year><volume>28</volume><fpage>77</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1016/j.apor.2006.05.002</pub-id></mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="other">Babarit A, Clement AH (2009) Application of the optimal command method to the control of the searev wave energy converter: a study on the influence of time constants on the efficiency of the latching control. In: Control Conference (ECC), 2009 European, IEEE, pp 3737–3742</mixed-citation></ref><ref id="CR4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Babarit</surname><given-names>A</given-names></name><name><surname>Duclos</surname><given-names>G</given-names></name><name><surname>Clément</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Comparison of latching control strategies for a heaving wave energy device in random sea</article-title><source>Appl Ocean Res</source><year>2004</year><volume>26</volume><issue>5</issue><fpage>227</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1016/j.apor.2005.05.003</pub-id></mixed-citation></ref><ref id="CR5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacelli</surname><given-names>G</given-names></name><name><surname>Ringwood</surname><given-names>JV</given-names></name></person-group><article-title xml:lang="en">Numerical optimal control of wave energy converters</article-title><source>Sustain Energy IEEE Trans</source><year>2015</year><volume>6</volume><issue>2</issue><fpage>294</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2014.2371536</pub-id></mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="other">Bacelli G, Gilloteaux JC, Ringwood JV (2009) A predictive controller for a heaving buoy producing potable water. In: Proceedings of the European Control Conference, August 23-26, Budapest</mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="other">Bhinder MA, Babarit A, Gentaz L, Ferrant P (2011) Assessment of viscous damping via 3d-cfd modelling of a floating wave energy device. In: Proceedings of the 9th European wave and tidal energy conference, Southampton</mixed-citation></ref><ref id="CR8"><mixed-citation publication-type="other">Bhinder MA, Babarit A, Gentaz L, Ferrant P (2012) Effect of viscous forces on the performance of a surging wave energy converter. In: Proceedings of the 22nd international and polar engineering conference. Rhodes, pp 545–549</mixed-citation></ref><ref id="CR9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjarte-Larsson</surname><given-names>T</given-names></name><name><surname>Falnes</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Laboratory experiment on heaving body with hydraulic power take-off and latching control</article-title><source>Ocean Eng</source><year>2006</year><volume>33</volume><issue>2006</issue><fpage>847</fpage><lpage>877</lpage><pub-id pub-id-type="doi">10.1016/j.oceaneng.2005.07.007</pub-id></mixed-citation></ref><ref id="CR10"><mixed-citation publication-type="other">Budal K, Falnes J, Kyllingstad A, Oltedal G (1979) Experiments with point absorbers. Proceedings of first symposium on wave energy utilization. Gothenburg, Sweeden, pp 253–282</mixed-citation></ref><ref id="CR11"><mixed-citation publication-type="other">Cathelain M (2013) Modeling of a floating object in heave motion using a numerical wave tank in openfoam. Master’s thesis, Ecole Centrale de Nantes</mixed-citation></ref><ref id="CR12"><mixed-citation publication-type="other">Clauss GF, Schmittner CE, Stuck R (2005) Numerical wave tank - simulation of extreme waves for the investigation of structural responses. In: Proceedings of the ASME 24th international conference on offshore mechanics and artic engineering, Halkidiki, vol 3, pp 785–792</mixed-citation></ref><ref id="CR13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cummins</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">The impulse response function and ship motion</article-title><source>Schiffstechnik</source><year>1962</year><volume>9</volume><fpage>101</fpage><lpage>109</lpage></mixed-citation></ref><ref id="CR14"><mixed-citation publication-type="other">Davidson J, Cathelain M, Guillemet L, Le Huec T, Ringwood JV (2015a) Implementation of an openfoam numerical wave tank for wave energy experiments. In: Proceedings of the 11th European wave and tidal energy conference</mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname><given-names>J</given-names></name><name><surname>Giorgi</surname><given-names>S</given-names></name><name><surname>Ringwood</surname><given-names>JV</given-names></name></person-group><article-title xml:lang="en">Linear parametric models for ocean wave energy converters identified from numerical wave tank experiments</article-title><source>Ocean Eng</source><year>2015</year><volume>103</volume><fpage>31</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.oceaneng.2015.04.056</pub-id></mixed-citation></ref><ref id="CR16"><mixed-citation publication-type="other">Durand M, Babarit A, Pettinotti B, Quillard O, Toularastel J, Clément A (2007) Experimental validation of the performances of the SEAREV wave energy converter with real time latching control. In: Proceedings of the 7th European wave and tidal energy conference, Porto, Portugal</mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="other">Falnes J (2002) Ocean waves and oscillating systems. Cambridge University Press, Cambridge</mixed-citation></ref><ref id="CR18"><mixed-citation publication-type="other">Falnes J, Lillebekken PM (2003) Budals latching-controlled-buoy type wave-power plant. In: Proceedings of the 5th European wave energy conference, vol 1720, Cork, pp 233–244</mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="other">Fusco F, Ringwood JV (2011) Suboptimal casual reactive control of wave energy converters using a second order system model. In: Proceedings of the 21st (2011) International offshore and polar engineering conference, Maui</mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusco</surname><given-names>F</given-names></name><name><surname>Nolan</surname><given-names>G</given-names></name><name><surname>Ringowood</surname><given-names>JV</given-names></name></person-group><article-title xml:lang="en">Variability reduction through optimal combination of wind/wave resources - an irish case study</article-title><source>Energy</source><year>2010</year><volume>35</volume><issue>2010</issue><fpage>314</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2009.09.023</pub-id></mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="other">Giorgi G, Ringwood JV (2015) NWT latching control algorithm and user manual. <ext-link xlink:href="http://www.eeng.nuim.ie/coer/view_project.php?id=PR008" ext-link-type="uri">http://www.eeng.nuim.ie/coer/view_project.php?id=PR008</ext-link></mixed-citation></ref><ref id="CR22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenhow</surname><given-names>M</given-names></name><name><surname>Rosen</surname><given-names>JH</given-names></name><name><surname>Reed</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Control strategies for the clam wave energy device</article-title><source>Appl Ocean Res</source><year>1984</year><volume>6</volume><issue>4</issue><fpage>197</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1016/0141-1187(84)90058-0</pub-id></mixed-citation></ref><ref id="CR23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halamay</surname><given-names>D</given-names></name><name><surname>Simmons</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Reserve requirement impacts of large-scale integration of wind, solar and ocean wave power generation</article-title><source>IEEE Trans Sustain Energy</source><year>2011</year><volume>2</volume><issue>3</issue><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2011.2114902</pub-id></mixed-citation></ref><ref id="CR24"><mixed-citation publication-type="other">Hals J, Bjarte-Larsson T, Falnes J (2002) Optimum reactive control and control by latching of a wave-absorbing semisubmerged heaving sphere. In: Proceedings of ASME 21th international conference on offshore mechanics and artic engineering, vol 4, Oslo, pp 415–423</mixed-citation></ref><ref id="CR25"><mixed-citation publication-type="other">Henriques J, Lopes M, Gomes R, Gato L, Falco A (2012) On the annual wave energy absorption by two-body heaving WECs with latching control. Renew Energy 45:31–40. doi:<ext-link xlink:href="10.1016/j.renene.2012.01.102" ext-link-type="doi">10.1016/j.renene.2012.01.102</ext-link>. <ext-link xlink:href="http://www.sciencedirect.com/science/article/pii/S0960148112001322" ext-link-type="uri">http://www.sciencedirect.com/science/article/pii/S0960148112001322</ext-link></mixed-citation></ref><ref id="CR26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirt</surname><given-names>C</given-names></name><name><surname>Nicholis</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Volume of fluid (vof) method for the dynamics of free boundaries</article-title><source>J Comput Phys</source><year>1979</year><volume>39</volume><fpage>201</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1016/0021-9991(81)90145-5</pub-id></mixed-citation></ref><ref id="CR27"><mixed-citation publication-type="other">Hoskin RE, Nichols N (1986) Latching control of a point absorber. In: n.k.nichols, pp 317–330. <ext-link xlink:href="http://centaur.reading.ac.uk/27626/" ext-link-type="uri">http://centaur.reading.ac.uk/27626/</ext-link></mixed-citation></ref><ref id="CR28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacobsen</surname><given-names>NG</given-names></name><name><surname>Fuhrman</surname><given-names>DR</given-names></name><name><surname>Fredsoe</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">A wave generation toolbox for the open-source cfd ligrary: Openfoam</article-title><source>Int J Numer Methods Fluids</source><year>2012</year><volume>70</volume><fpage>1073</fpage><lpage>1088</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">2983323</pub-id><pub-id pub-id-type="doi">10.1002/fld.2726</pub-id></mixed-citation></ref><ref id="CR29"><mixed-citation publication-type="other">Jefferys E (1980) Device characterisation, Power from sea waves. Academic Press, London</mixed-citation></ref><ref id="CR30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kara</surname><given-names>F</given-names></name></person-group><article-title xml:lang="en">Time domain prediciton of power absorption from ocean waves with latching control</article-title><source>Renew Energy</source><year>2010</year><volume>35</volume><issue>2010</issue><fpage>423</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/j.renene.2009.06.003</pub-id></mixed-citation></ref><ref id="CR31"><mixed-citation publication-type="other">Kundu PK, Cohen IM, Dowling DR (2011) Fluid mechanics. 5th edn, Academic Press, London</mixed-citation></ref><ref id="CR32"><mixed-citation publication-type="other">Mehaute BL (1976) An introduction to hydrodynamics and water waves. Springer, New York</mixed-citation></ref><ref id="CR33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nebel</surname><given-names>P</given-names></name></person-group><article-title xml:lang="en">Maximizing the efficiency of wave-energy plant using complex-conjugate control</article-title><source>Proc Inst Mech Eng Part I J Syst Control Eng</source><year>1992</year><volume>206</volume><issue>4</issue><fpage>225</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1243/PIME_PROC_1992_206_338_02</pub-id></mixed-citation></ref><ref id="CR34"><mixed-citation publication-type="other">Newman J (1977) Marine hydrodynamics. MIT Press, USA</mixed-citation></ref><ref id="CR35"><mixed-citation publication-type="other">Ogilvie T (1964) Recent progress towards the understanding and prediction of ship motions. Proceedings of the fifth symposium on naval hydrodynamics. Bergen, pp 3–128</mixed-citation></ref><ref id="CR36"><mixed-citation publication-type="other">OpenFOAM (2015) OpenFOAM The Open Source CFD Toolbox User Guide Version 3.0.1</mixed-citation></ref><ref id="CR37"><mixed-citation publication-type="other">Palm J, Eskilsson C, Paredes GM, Bergdahl L (2013) Cfd simulation of a moored floating wave energy converter. In: EWTEC, Aalborg</mixed-citation></ref><ref id="CR38"><mixed-citation publication-type="other">Peñalba M, Merigaud A, Gilloteaux JC, Ringwood JV (2015) Nonlinear Froude-Krylov force modelling for two heaving wave energy point absorbers. In: Proceedings of European Wave and Tidal Energy Conference, Nantes, France</mixed-citation></ref><ref id="CR39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perez</surname><given-names>T</given-names></name><name><surname>Fossen</surname><given-names>TI</given-names></name></person-group><article-title xml:lang="en">A Matlab toolbox for paramteric identification of radiation-force models of ships and offshore structures</article-title><source>Modell Identif Control</source><year>2009</year><volume>30</volume><issue>1</issue><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.4173/mic.2009.1.1</pub-id></mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="other">Ringwood JV, Butler S (2004) Optimisation of a wave energy converter. In: Proceedings of IFAC Conf. on Control Applications in Marine Systems, Ancona</mixed-citation></ref><ref id="CR41"><mixed-citation publication-type="other">Ringwood JV, Davidson J, Giorgi S (2015) Optimising numerical wave tank tests for the parametric identification of wave energy device models. In: Proceedings of the ASME 2015 34th international conference on ocean, offshore and arctic engineering OMAE, St. John’s, Newfoundland</mixed-citation></ref><ref id="CR42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Safonov</surname><given-names>M</given-names></name><name><surname>Chiang</surname><given-names>R</given-names></name><name><surname>Limebeer</surname><given-names>D</given-names></name></person-group><article-title xml:lang="en">Optimal hankel model reduction for nonminimal systems</article-title><source>Autom Control IEEE Trans</source><year>1990</year><volume>35</volume><issue>4</issue><fpage>496</fpage><lpage>502</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">1048008</pub-id><pub-id pub-id-type="doi">10.1109/9.52314</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">0704.93012</pub-id></mixed-citation></ref><ref id="CR43"><mixed-citation publication-type="other">Salter SH (1979) Power conversion systems for ducks. In: Proceedings of the International Conference on Future Energy Concepts, Publication 171. Institution of Electrical Engineers, London, pp 100–108</mixed-citation></ref><ref id="CR44"><mixed-citation publication-type="other">Schmitt P, Bourdier S, Whittaker T, Sarkar D, Renzi E, Dias F, Doherty K, van’t Hoff J (2012) Hydrodynamic loading of a bottom hinged oscillating wave surge converter. In: Proceedings of the twenty-second international offshore and polar engineering conference, Rhodes</mixed-citation></ref><ref id="CR45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taghipour</surname><given-names>R</given-names></name><name><surname>Perez</surname><given-names>T</given-names></name><name><surname>Moan</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Hybrid frequency-time domain models for dynamic response analysis of marine structures</article-title><source>Ocean Eng</source><year>2007</year><volume>35</volume><issue>7</issue><fpage>685</fpage><lpage>705 </lpage><pub-id pub-id-type="doi">10.1016/j.oceaneng.2007.11.002</pub-id></mixed-citation></ref><ref id="CR46"><mixed-citation publication-type="other">Tanizawa K (2000) The state of the art on numercial wave tank. In: Proceedings of 4th Osaka colloqium on seakeeping performance of ships. Osaka, pp 95–114</mixed-citation></ref><ref id="CR47"><mixed-citation publication-type="other">Teillant B, Gilloteaux J, Ringwood JV (2010) Optimal damping profile for a heaving buoy wave energy converter. In: Proceedings IFAC conference on control applications in marine systems (CAMS). Rostock, Germany, pp 393–398</mixed-citation></ref><ref id="CR48"><mixed-citation publication-type="other">Temam R (2001) Navier–Stokes equations: theory and numerical analysis, vol 343. American Mathematical Soc, USA</mixed-citation></ref><ref id="CR49"><mixed-citation publication-type="other">Vyzikas T, Ransley E, Hann M, Magagna D, Greaves D, Simmonds D, Magar V, Conley D (2013) Integrated numerical modeling system for extreme wave events at the wave hub site. In: Proceedings of ICE conference on coasts, marine structures and breakwaters, Edinburgh</mixed-citation></ref><ref id="CR50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>X</given-names></name><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">A comprehensive review on the development of sustainable energy strategy and implementation in China</article-title><source>IEEE Trans Sustain Energy</source><year>2010</year><volume>1</volume><issue>2</issue><fpage>57</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1109/TSTE.2010.2051464</pub-id></mixed-citation></ref><ref id="CR51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zurkinden</surname><given-names>AS</given-names></name><name><surname>Ferri</surname><given-names>F</given-names></name><name><surname>Beatty</surname><given-names>S</given-names></name><name><surname>Kofoed</surname><given-names>JP</given-names></name><name><surname>Kramer</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">Non-linear numerical modeling and experimental testing of a point absorber wave energy converter</article-title><source>Ocean Eng</source><year>2014</year><volume>78</volume><fpage>11</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/j.oceaneng.2013.12.009</pub-id></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1"><sec id="Sec18"><title>Appendix</title><p id="Par80">The boundary conditions of the 3D numerical wave tank are summarized in Table <xref rid="Tab3" ref-type="table">3</xref>. Taking advantage of the symmetry of the problem, only half of the tank is simulated.The names of the boundaries are self-explanatory while the four fields that need to be defined are the phase fraction (<inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mi mathvariant="italic">α</mml:mi></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq63.gif"/></alternatives></inline-formula>), the velocity <italic>U</italic>, the dynamic pressure (<inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi mathvariant="italic">ρ</mml:mi><mml:msup><mml:mfenced close="|" open="|"><mml:mi>U</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_d=\frac{1}{2} \rho \left| U\right| ^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq64.gif"/></alternatives></inline-formula>) and the displacement of the cells (pointDisplacement). The phase fraction <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mi mathvariant="italic">α</mml:mi></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq65.gif"/></alternatives></inline-formula> ranges from 0 (only air) to 1 (only water).</p><p id="Par81">The names of the boundaries refer to version 2.3 of OpenFOAM (OpenFOAM <xref ref-type="bibr" rid="CR36">2015</xref>). Calling <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq66.gif"/></alternatives></inline-formula> the general field (either <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mi mathvariant="italic">α</mml:mi></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq67.gif"/></alternatives></inline-formula>, <italic>U</italic>, <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_d$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq68.gif"/></alternatives></inline-formula> or pointDisplacement), the boundary conditions are the following:<list list-type="bullet"><list-item><p id="Par82">symmetryPlane: it defines the boundary as a symmetry plane.</p></list-item><list-item><p id="Par83">fixedValue (0): it sets <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq69.gif"/></alternatives></inline-formula> to zero.</p></list-item><list-item><p id="Par84">zeroGradient: normal gradient of <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq70.gif"/></alternatives></inline-formula> is zero.</p></list-item><list-item><p id="Par85">waveAlpha: input wave surface elevation determined by waves2Foam (Jacobsen et al. <xref ref-type="bibr" rid="CR28">2012</xref>).</p></list-item><list-item><p id="Par86">waveVelocity: input wave velocity determined by waves2Foam (Jacobsen et al. <xref ref-type="bibr" rid="CR28">2012</xref>).</p></list-item><list-item><p id="Par87">inletOutlet: zeroGradient in case of outflow, fixedValue (0) in case of inflow.</p></list-item><list-item><p id="Par88">pressureInletOutletVelocity: a zeroGradient condition is applied for outflow while for inflow <italic>U</italic> is evaluated from the flux.</p></list-item><list-item><p id="Par89">totalPressure: total pressure <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi mathvariant="italic">ρ</mml:mi><mml:msup><mml:mfenced close="|" open="|"><mml:mi>U</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_\mathrm{T} = p_0 + \frac{1}{2} \rho \left| U\right| ^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq71.gif"/></alternatives></inline-formula> is fixed, where <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq72.gif"/></alternatives></inline-formula> is the reference pressure and <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mi mathvariant="italic">ρ</mml:mi></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq73.gif"/></alternatives></inline-formula> is the density; when <italic>U</italic> changes, <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="40722_2016_52_Article_IEq74.gif"/></alternatives></inline-formula> is adjusted accordingly.</p></list-item><list-item><p id="Par90">movingWallVelocity: the normal of the patch value is replaced so that the flux across the patch is zero.</p></list-item><list-item><p id="Par91">fixedFluxPressure: the pressure gradient is adjusted such that the flux on the boundary is that specified by the velocity boundary condition.</p></list-item><list-item><p id="Par92">calculated: the displacement of the cell is calculated according to the Newton’s second law of dynamics.</p></list-item></list>In the case of a 2D simulation, which is a one-cell-thick 3D simulation, the boundary condition for every field of the boundary front and back is called empty. As a result, the third dimension will be neglected during the calculations.</p></sec></app></app-group></back></article></records><facets><facet name="subject"><facet-value count="1">Coastal Sciences</facet-value><facet-value count="1">Engineering</facet-value><facet-value count="1">Engineering Fluid Dynamics</facet-value><facet-value count="1">Geoengineering, Foundations, Hydraulics</facet-value><facet-value count="1">Oceanography</facet-value><facet-value count="1">Offshore Engineering</facet-value><facet-value count="1">Renewable and Green Energy</facet-value></facet><facet name="keyword"><facet-value count="1">CFD</facet-value><facet-value count="1">Latching control</facet-value><facet-value count="1">Nonlinear</facet-value><facet-value count="1">NWT</facet-value><facet-value count="1">OpenFOAM</facet-value><facet-value count="1">Optimal latching duration</facet-value></facet><facet name="pub"><facet-value count="1">Journal of Ocean Engineering and Marine Energy</facet-value></facet><facet name="year"><facet-value count="1">2016</facet-value></facet><facet name="country"><facet-value count="1">Ireland</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
