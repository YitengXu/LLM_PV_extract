<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="/resources/spdi-openaccess-jats.xsl"?>
<!DOCTYPE response [
	
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<!ENTITY % book-part-wrapper SYSTEM "http://jats.nlm.nih.gov/extensions/bits/2.0/BITS-book2.dtd">
	]><response><apiMessage>This XML was provided by Springer Nature</apiMessage><query>doi:10.1038/s41598-022-26312-w</query><apiKey>87ba7cb21f89ce78154df796840621f4</apiKey><result><total>1</total><start>1</start><pageLength>2</pageLength><recordsDisplayed>1</recordsDisplayed></result><records><article dtd-version="1.2" article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="publisher-id">41598</journal-id><journal-id journal-id-type="doi">10.1038/41598.2045-2322</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title><abbrev-journal-title abbrev-type="publisher">Sci Rep</abbrev-journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">s41598-022-26312-w</article-id><article-id pub-id-type="manuscript">26312</article-id><article-id pub-id-type="doi">10.1038/s41598-022-26312-w</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/357/1015</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/1019</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/357</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301/1034/1037</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/705/794</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/925/357</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/301</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/925</subject></subj-group><subj-group subj-group-type="SubjectPath"><subject>/639/624/399</subject></subj-group><subj-group subj-group-type="NatureArticleTypeID"><subject>article</subject></subj-group></article-categories><title-group><article-title xml:lang="en">Neural Inverse Design of Nanostructures (NIDN)</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="Au1"><name><surname>Gómez</surname><given-names>Pablo</given-names></name><address><email>pablo.gomez@esa.int</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="corresp" rid="IDs4159802226312w_cor1">a</xref></contrib><contrib contrib-type="author" id="Au2"><name><surname>Toftevaag</surname><given-names>Håvard Hem</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au3"><name><surname>Bogen-Storø</surname><given-names>Torbjørn</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au4"><name><surname>Aranguren van Egmond</surname><given-names>Derek</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" id="Au5"><name><surname>Llorens</surname><given-names>José M.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.424669.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 969X</institution-id><institution content-type="org-name">European Space Agency, Advanced Concepts Team</institution></institution-wrap><addr-line content-type="postcode">2201AZ</addr-line><addr-line content-type="city">Noordwijk</addr-line><country country="NL">The Netherlands</country></aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.473348.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 0626 0516</institution-id><institution content-type="org-name">Instituto de Micro y Nanotecnología, IMN-CNM, CSIC (CEI UAM+CSIC)</institution></institution-wrap><addr-line content-type="street">Isaac Newton, 8</addr-line><addr-line content-type="postcode">28760</addr-line><addr-line content-type="city">Tres Cantos</addr-line><addr-line content-type="state">Madrid</addr-line><country country="ES">Spain</country></aff></contrib-group><author-notes><corresp id="IDs4159802226312w_cor1"><label>a</label><email>pablo.gomez@esa.int</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>22</day><month>12</month><year>2022</year></pub-date><pub-date date-type="collection" publication-format="electronic"><month>12</month><year>2022</year></pub-date><volume>12</volume><issue seq="22160">1</issue><elocation-id>22160</elocation-id><history><date date-type="registration"><day>13</day><month>12</month><year>2022</year></date><date date-type="received"><day>5</day><month>8</month><year>2022</year></date><date date-type="accepted"><day>13</day><month>12</month><year>2022</year></date><date date-type="online"><day>22</day><month>12</month><year>2022</year></date></history><permissions><copyright-statement content-type="compact">© The Author(s) 2022</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>The Author(s)</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract xml:lang="en" id="Abs1"><title>Abstract</title><p id="Par1">In the recent decade, computational tools have become central in material design, allowing rapid development cycles at reduced costs. Machine learning tools are especially on the rise in photonics. However, the inversion of the Maxwell equations needed for the design is particularly challenging from an optimization standpoint, requiring sophisticated software. We present an innovative, open-source software tool called <italic>Neural Inverse Design of Nanostructures</italic> (NIDN) that allows designing complex, stacked material nanostructures using a physics-based deep learning approach. Instead of a derivative-free or data-driven optimization or learning method, we perform a gradient-based neural network training where we directly optimize the material and its structure based on its spectral characteristics. NIDN supports two different solvers, rigorous coupled-wave analysis and a finite-difference time-domain method. The utility and validity of NIDN are demonstrated on several synthetic examples as well as the design of a 1550 nm filter and anti-reflection coating. Results match experimental baselines, other simulation tools, and the desired spectral characteristics. Given its full modularity in regard to network architectures and Maxwell solvers as well as open-source, permissive availability, NIDN will be able to support computational material design processes in a broad range of applications.</p></abstract><custom-meta-group><custom-meta><meta-name>publisher-imprint-name</meta-name><meta-value>Nature Portfolio</meta-value></custom-meta><custom-meta><meta-name>volume-issue-count</meta-name><meta-value>1</meta-value></custom-meta><custom-meta><meta-name>issue-article-count</meta-name><meta-value>22159</meta-value></custom-meta><custom-meta><meta-name>issue-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>issue-pricelist-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-holder</meta-name><meta-value>The Author(s)</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-contains-esm</meta-name><meta-value>Yes</meta-value></custom-meta><custom-meta><meta-name>article-numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-year</meta-name><meta-value>2022</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-month</meta-name><meta-value>12</meta-value></custom-meta><custom-meta><meta-name>article-registration-date-day</meta-name><meta-value>13</meta-value></custom-meta><custom-meta><meta-name>article-toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>toc-levels</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>volume-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>journal-product</meta-name><meta-value>NonStandardArchiveJournal</meta-value></custom-meta><custom-meta><meta-name>numbering-style</meta-name><meta-value>Unnumbered</meta-value></custom-meta><custom-meta><meta-name>article-grants-type</meta-name><meta-value>OpenChoice</meta-value></custom-meta><custom-meta><meta-name>metadata-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>abstract-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodypdf-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bodyhtml-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>bibliography-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>esm-grant</meta-name><meta-value>OpenAccess</meta-value></custom-meta><custom-meta><meta-name>online-first</meta-name><meta-value>false</meta-value></custom-meta><custom-meta><meta-name>pdf-file-reference</meta-name><meta-value>BodyRef/PDF/41598_2022_Article_26312.pdf</meta-value></custom-meta><custom-meta><meta-name>pdf-type</meta-name><meta-value>Typeset</meta-value></custom-meta><custom-meta><meta-name>target-type</meta-name><meta-value>OnlinePDF</meta-value></custom-meta><custom-meta><meta-name>issue-type</meta-name><meta-value>Regular</meta-value></custom-meta><custom-meta><meta-name>article-type</meta-name><meta-value>OriginalPaper</meta-value></custom-meta><custom-meta><meta-name>journal-subject-primary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, Humanities and Social Sciences, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-secondary</meta-name><meta-value>Science, multidisciplinary</meta-value></custom-meta><custom-meta><meta-name>journal-subject-collection</meta-name><meta-value>Science (multidisciplinary)</meta-value></custom-meta><custom-meta><meta-name>open-access</meta-name><meta-value>true</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Computational tools have been playing an increasingly central role in material design in recent decades. With lower costs and rapid development cycles they are an efficient starting point in the material design process that can later be complemented with experimental validation and refinement<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Especially machine learning techniques have recently seen widespread adoption in applications ranging from predicting material properties to designing nanostructures<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup> and this work aims to advance and support these efforts.</p><p id="Par3">Brute-force parameter sweeps are increasingly being replaced by more sophisticated optimization methods in the design of metamaterials and nanophotonic devices<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR10">10</xref></sup>. Indeed, many recent works rely especially on neural network-based approaches for this<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>. And, instead of letting human intuition and analytically derived parameters determine the architecture, nanostructured devices can now be autonomously designed for high performance, made possible by the exhaustive exploration of the design space that such algorithms perform<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In this context, this process of determining the physical characteristics from certain properties<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, e.g., finding the geometry of a structure for a given optical response, is called inverse design. Recently, there have been a lot of works on inverse design for nanophotonics using different techniques, such as generative adversarial networks<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, variational auto-encoders<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and other machine learning and optimization methods<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>.</p><p id="Par4">One area where this has received a lot of attention is the space sector, where reducing the size, weight, power, and cost of objects put into orbit is not only a high priority, but can in many cases also determine the feasibility of the project. One example are photon sails, which must have sail thicknesses on the order of only a few micrometers (the IKAROS solar sail was only 7.5 μm thick<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>) in order to avoid an unsuitable weight. Recently, there has been research on using metasurfaces for solar sails, made with both conventional design<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> and inverse design<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> methods. These metasurfaces might offer, for instance, attitude control<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> and mass reduction<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> while maintaining a high efficiency.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p>Training setup for NIDN; regression and classification as well as RCWA and FDTD are described in detail in Methods.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig1_HTML.png" id="MO1"/></fig></p><p id="Par5">Recent works have also applied metamaterial knowledge to the optical solar reflector (OSR), a structure placed on the external surface of a spacecraft that simultaneously reflects incoming sunlight and emit infrared radiation. Instead of using the conventional design of planar structures, Sun <italic>et al</italic>. showed that a simple metasurface can reduce the thickness<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. The terrestrial cousin of the OSR, radiative cooling structures, have followed a similar trend recently<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>.</p><p id="Par6">Overall, these methods rely on sophisticated software tools and datasets which has inspired efforts to make those available openly as, e.g., in the work of Jiang <italic>et al.</italic><sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. In a similar vain, in this work, we present an open-source software package called <italic>Neural Inverse Design of Nanostructures</italic> (NIDN) that allows designing nanostructures with neural networks using two different, fully differentiable implementations of Maxwell equations solvers based on the finite-difference time-domain (FDTD) method<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and rigorous coupled-wave analysis (RCWA)<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. RCWA is a natural and efficient choice for stacked materials designed with NIDN. The relevance of this is also evident as another group has also concurrently undertaken the effort of implementing RCWA with PyTorch<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. FDTD complements it by supporting design in the visible light range of the spectrum and—depending on geometry—providing higher accuracy<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Both, RCWA and FDTD, enable the machine-learning-based design of multilayer materials with patterned nanoscale grids to achieve a desired spectrum of reflectance, transmittance and absorptance. Thus, NIDN has the potential to support a wide range of the aforementioned applications. In comparison to previous similar efforts such as those by Jiang <italic>et al.</italic><sup><xref ref-type="bibr" rid="CR26">26</xref></sup> we utilize a fundamentally different technique relying on directly encoding the material inside a neural network.</p><p id="Par7">Building on advances in physics-based deep learning<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, in NIDN, we directly optimize the nanostructure described by the neural network to achieve one specific spectrum using gradient information from the physical simulation via a loss. In this approach, no prior knowledge or training datasets are required as gradients are backpropagated through a (differentiable) numerical solver. Also, as the neural network does not need to solve the problem of fully describing the relationship between any material and spectral characteristics the task is more tractable. In many previous approaches<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, neural networks effectively need to invert the Maxwell equations to match material and spectral characteristics to each other. In NIDN, by solving for a specific reflectance, transmittance and absorptance spectrum, we—from a mathematical perspective—constrain the inversion to a specific solution of the Maxwell equations. This furthermore avoids being limited to only a few degrees of freedom, such as placing a specific structure on top of another, in the material design<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>; instead we can fully explore the entire search space of structures. Several nanosurface modification strategies have been employed to tune spectral response in optical devices. NIDN specifically excels in the parametric optimization of heterogeneous, multi-layer devices, which use local composition to tune electromagnetic properties. This is in contrast to the geometric structuring of a single material surface, which has limited local spectral tunability.</p><p id="Par8">There is overall a larger trend in the related research field of topology optimization to use inverse design approaches based on neural networks, where various works have explored this for problems in related domains of material design<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR33">33</xref></sup>. However, to the authors knowledge, these works have not explored a similar setup for inverse design in photonics which is challenging as a Maxwell solver requires full support of complex numbers.</p><p id="Par9">With NIDN, the neural network learns to produce a spatially continuous function describing the material permittivity. We demonstrate the validity and versatility of the approach by comparing to existing implementations that we built on. We showcase several examples ranging from simple uniform layers to practical applications related to photonic filter design and perfect anti-reflection. NIDN is also capable of running on graphics cards (GPUs) and is available open-source online (<ext-link xlink:href="https://github.com/esa/NIDN" ext-link-type="uri">https://github.com/esa/NIDN</ext-link> Accessed: 2022-04-21). The authors hope to build a community around the software, extending its capabilities and fidelity even further in the future.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><p id="Par10">In the following, we showcase results demonstrating NIDN’s capabilities. In particular, we first validate the numerical Maxwell solvers in NIDN against baselines, then show the efficacy of the inverse design on some simple materials, and, finally, investigate two common design scenarios from the literature and perform a comparison with related approaches.</p><sec id="Sec3"><title>Material design setup</title><p id="Par11">The following results were obtained using NIDN and its Maxwell solvers derived from the RCWA implementations by Jin <italic>et al.</italic><sup><xref ref-type="bibr" rid="CR17">17</xref></sup> and an adaption of an open-source implementation of FDTD in PyTorch 1.9. Both are described in more detail in the Section Methods. NIDN utilizes PyTorch 1.9 to enable automatic differentiation and neural network training to design materials of stacked layers such as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Details on neural network architectures and training as well as the detailed training setup are given in the Section Methods. Data on material permittivity are obtained from an online database.(<ext-link xlink:href="https://refractiveindex.info" ext-link-type="uri">https://refractiveindex.info</ext-link> Accessed: 2022-04-21) More detailed info on specific references for each material are provided in the integrated database of materials in NIDN (<ext-link xlink:href="https://github.com/esa/NIDN/tree/main/nidn/materials/data" ext-link-type="uri">https://github.com/esa/NIDN/tree/main/nidn/materials/data</ext-link>.</p><p id="Par12">Permittivity between provided measurement points is interpolated linearly. Layer thickness if not specified otherwise is 1 μm. Grid dimensions if not specified are <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${1}\,{\upmu }\text{m}\times {1}\,{\upmu }\text{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq3.gif"/></alternatives></inline-formula>. In general, NIDN supports two modes of inverse design which are described in more detail in the Section Methods: The first one is referred to as regression, where the permittivity of the material is predicted within some value range to investigate hypothetical materials achieving the target spectral characteristics. If not specified otherwise, the range for relative permittivity <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq4.gif"/></alternatives></inline-formula> considered by the network is <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0.01 , 20 + 3i]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq5.gif"/></alternatives></inline-formula>. All references to permittivity refer to relative permittivity. The second approach is called classification and the permittivity in this case is chosen as a linear combination of reported permittivity of real materials. All considered materials are listed in the codebase. At present, only normal incidence is considered. Figure <xref rid="Fig1" ref-type="fig">1</xref> gives a high-level overview of the training process.</p><p id="Par13">The number of training iterations depended on the task and solver; for RCWA between 1000 and 5000 training iterations were used, for FDTD not more than 150 iterations due to the higher computation time. No dispersion model is used and frequencies are computed independently. For a single uniform layer, a single training iteration with FDTD requires about 8 s per frequency, with RCWA it takes six milliseconds per frequency per iteration. L1 errors reported in the figures refer to the mean absolute error between the target and obtained spectrum. Inversion with FDTD used a coarser grid in the numerical discretization than for validation to keep the computational cost manageable (32 instead of 100).<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p>Comparison of the transmittance of a 380 nm thick layer of <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq7.gif"/></alternatives></inline-formula> in NIDN and experimentally measured.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig2_HTML.png" id="MO2"/></fig><fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p>Inversion results for a single-layer <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq8.gif"/></alternatives></inline-formula> material using FDTD and regression; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity; differences to Fig. <xref rid="Fig2" ref-type="fig">2</xref> are due to smaller number of discretization grid points.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig3_HTML.png" id="MO3"/></fig></p></sec><sec id="Sec4"><title>Validation and numerical stability</title><p id="Par14">NIDN contains a fully differentiable RCWA implementation that is derived from the Python module GRCWA<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. For RCWA, a full re-implementation of the GRCWA code to use PyTorch was undertaken replacing many components with adequate alternatives in PyTorch. Extensive tests are performed to validate both, RCWA and FDTD, implementations against the original implementations and results of these can be found in the Supplementary Information.</p><p id="Par15">NIDN adapts the FDTD implementation from the Python module with the same name (<ext-link xlink:href="https://github.com/flaport/fdtd" ext-link-type="uri">https://github.com/flaport/fdtd</ext-link> Accessed: 2022-04-21) but adds support for gradient flow through it and performs post processing. A comparison with an experimental baseline is given to validate the implemented post processing. Further, we directly compare results with the original Python module to validate our changes to it. Overall, these implementations are major contributions of this paper as previously no Maxwell solver in PyTorch was available that allowed backpropagation through the entire simulation. This is also particularly challenging given the dependence on using complex numbers for permittivities and the simualtion as, at the start of this research work, there was a lack of support for complex numbers in PyTorch.</p><p id="Par16">A comparison with an experimental measurement of the transmission spectrum of <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq9.gif"/></alternatives></inline-formula> is performed for both. The <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq10.gif"/></alternatives></inline-formula> layer in the experiment by Wojcieszak <italic>et al.</italic><sup><xref ref-type="bibr" rid="CR34">34</xref></sup> was 380 nm thick and transmission of wavelengths between 300 and 900 nm were measured using a spectrophotometer. Figure <xref rid="Fig2" ref-type="fig">2</xref> displays transmittance obtained with NIDN RCWA and FDTD using continuous waves with wavelengths from 300 to 900 nm as well as the experimental result. Overall, it can be seen that the transmittance in NIDN resembles the one observed in the experiment. Point clustering in the FDTD version is a discretization effect due to the number of grid points used in the simulation.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p>Inversion results for a single-layer <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq11.gif"/></alternatives></inline-formula> material using FDTD and classification; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity; differences to Fig. <xref rid="Fig2" ref-type="fig">2</xref> are due to smaller number of discretization grid points.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig4_HTML.png" id="MO4"/></fig></p></sec><sec id="Sec5"><title>Material and structure inference</title><p id="Par17">As a first demonstration of NIDN’s capabilities, we present results on some rudimentary examples. These examples aim to reconstruct a material for which the spectral characteristics were computed with RCWA / FDTD, thus the inversion is certain to have a solution obtainable by the network. In particular, these results show that, depending on the complexity of the spectral characteristics, almost perfect results can be obtained. Furthermore, we can investigate how unique solutions are by studying the similarity of designed materials with the ground-truth baseline.</p><sec id="Sec6"><title>Uniform <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq12.gif"/></alternatives></inline-formula> layer inversion</title><p id="Par18">First, we show that NIDN is capable of recreating the permittivity of a single layer of <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq13.gif"/></alternatives></inline-formula>, with FDTD in the visible range of the spectrum (for RCWA a more complex three-layer example is tested).</p><p id="Par19">Figure <xref rid="Fig3" ref-type="fig">3</xref> showcases these results. Note that to save computational time, a limited number of frequency points, i.e. 20, were investigated. A clear convergence towards the ground truth is visible with a detailed replication of the desired reflectance spectrum and slightly higher than targeted transmittance. Peaks in the transmittance are at the targeted wavelengths. Overall, the replication of the spectral characteristics is not perfect but strongly resembles the target. However, the predicted permittivity clearly differs from the real one of <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq14.gif"/></alternatives></inline-formula> with a higher real permittivity in the learnt material. Thus, the network seems to have found a solution leading to similar spectral characteristics with a different material.</p><p id="Par20">Even though the inversion with the regression approach—in terms of reproducing the target spectrum—was successful, it was not constrained to realistic materials. In Fig. <xref rid="Fig4" ref-type="fig">4</xref> we show results for the classification approach for this single-layer material where we constrain the network further in terms of allowed permittivities. Overall, the inversion is successful and the obtained spectral characteristics are even closer to the target. Furthermore, as seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, the used epsilon value now corresponds well to the experimental permittivity of <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq15.gif"/></alternatives></inline-formula> and thus the network was able to identify the exact material required for this spectrum.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p>Inversion results for a three-layer material using RCWA and regression; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity for each layer.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig5_HTML.png" id="MO5"/></fig><fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p>Inversion results for a three-layer material using RCWA and classification; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity for each layer.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig6_HTML.png" id="MO6"/></fig></p></sec><sec id="Sec7"><title>Three-layer uniform material</title><p id="Par21">The second example is the design of a three-layer material consisting of <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq16.gif"/></alternatives></inline-formula>, Germanium (<inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mtext>Ge</mml:mtext></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Ge}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq17.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:msub><mml:mtext>Ta</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mtext>O</mml:mtext><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Ta}_{2}\text{O}_{5}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq18.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig5" ref-type="fig">5</xref> displays the regression results with RCWA for this material. The design of the spectral properties is successful and the reflectance is achieved flawlessly. A small difference is noticeable at the lower end of the spectrum for the transmittance. Similar as for the previous inversion with FDTD, however, permittivities of the different layers are notably further from real materials. The obtained permittivity is not resemblant of the materials to generate the target spectrum. This again demonstrates the ill-posed nature of this inversion task where there are non-unique solutions that lead to the desired spectral characteristics.</p><p id="Par22">Similar to FDTD, with the classification and RCWA approach, the restriction for the permittivity actually leads to a virtually flawless reconstruction of the spectral characteristics and to the network learning the permittivity of the utilized materials in the ground truth for each layer, as can be seen in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Furthermore, the achieved spectral characteristics also almost perfectly match the design goal of the ground truth. Thus, the classification was successfully used to constrain the network to realistic material choices.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p>Inversion results for a two-layer patterned material using RCWA and regression; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) each line shows the utilized permittivity for a grid cell.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig7_HTML.png" id="MO7"/></fig><fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p>Inversion results for a two-layer patterned material using RCWA and classification; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) each line shows the utilized permittivity for a grid cell.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig8_HTML.png" id="MO8"/></fig></p></sec><sec id="Sec8"><title>Two-layer patterned material</title><p id="Par23">The last case based on a ground truth from the forward models (i.e., the RCWA and FDTD implementations) is a two-layer patterned material consisting of <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mtext>Ge</mml:mtext></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Ge}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq20.gif"/></alternatives></inline-formula> with a square pattern in the center similar to those shown in the Supplementary Information. In the upper layer the square is made of <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq21.gif"/></alternatives></inline-formula> and surroundings of <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mtext>Ge</mml:mtext></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Ge}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq22.gif"/></alternatives></inline-formula> and vice versa for the bottom layer. This test case is only studied with RCWA as support for patterned layers is currently still in development for FDTD.</p><p id="Par24">Figure <xref rid="Fig7" ref-type="fig">7</xref> displays the obtained spectral characteristics with regression and RCWA. The desired spectrum is reproduced very well as can be seen in Fig. <xref rid="Fig7" ref-type="fig">7</xref>a with both, reflectance and transmittance, matching the target spectral characteristics precisely. However, the utilized permittivity is not close to any material available in NIDN as Fig. <xref rid="Fig7" ref-type="fig">7</xref>b shows and the reconstructed pattern is not resemblant of the ground truth. Again, the regression finds a solution that leads to an excellent reconstruction of the desired spectral properties with different material properties than used for the ground truth. Interestingly, the utilized permittivities are somewhat less erratic than in the previous cases (compare Figs. <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig3" ref-type="fig">3</xref>). And, it seems that there are two distinct materials (i.e. permittivity) that the network was converging to. These did not match the ones in NIDN’s dataset though.</p><p id="Par25">For the classification approach and RCWA, shown in Figure. <xref rid="Fig8" ref-type="fig">8</xref>, comparable errors in terms of reproducing the spectral characteristics are obtained. In this case—as can be seen in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b—the permittivity chosen by the network is close to those of used in the ground truth, i.e., <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mtext>Ge</mml:mtext></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Ge}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq24.gif"/></alternatives></inline-formula>. The pattern of the ground truth was not reconstructed implying that the network found a good solution without it.<fig id="Fig9"><label>Figure 9</label><caption xml:lang="en"><p>Inversion results for designing a bandpass filter with a ten layer stack using RCWA and regression; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity for each layer and closest material in NIDN (dashed).</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig9_HTML.png" id="MO9"/></fig></p></sec></sec><sec id="Sec9"><title>Filter design</title><p id="Par26">The first test case closer to a potential application is the design of a bandpass filter. In this case, the target spectral properties are defined manually. Hence, the spectral characteristics may actually not be obtainable with the material properties the network is allowed to utilize. A stack of ten uniform layers is used to design the material. Due to the larger computational cost of FDTD, only RCWA was studied in this case. Also, the classification for this test case did not converge—likely because the available materials in database did not suffice to find a solution for this problem.</p><sec id="Sec10"><title>Regression</title><p id="Par27">With the regression, the chosen range for the relative permittivity is <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r \in [0 , 20 + 1i]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq25.gif"/></alternatives></inline-formula>. The achieved spectral characteristics with regression and RCWA of the designed filter are shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>. The designed material captures the gap at the chosen wavelength around 1550 nm very well with a transmittance around 0.98 at those frequencies and a reflectance over 0.98 for the other wavelengths. Notably, the utilized permittivity is not similar to those of existing materials with erratic peaks in the real component of the permittivity for some of the layers, especially for lower wavelengths. Interestingly for higher wavelengths, the networks seems to converge to three distinct permittivities in the real part near 0, 20 and about 12.5.</p></sec></sec><sec id="Sec11"><title>Perfect anti-reflection coating</title><p id="Par28">This second test case related to an application explores the scenario of building a perfect anti-reflection on top of a substrate with relative permittivity <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r = 16$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq26.gif"/></alternatives></inline-formula>. This is closely related to the research described by Kim &amp; Park<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. Thus, we use a stack of eight <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mrow><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${0.1}\,{\upmu }\textrm{m}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq27.gif"/></alternatives></inline-formula> thick layers on top of the higher permittivity substrate to achieve an anti-reflection coating (ARC).<fig id="Fig10"><label>Figure 10</label><caption xml:lang="en"><p>Inversion results for designing an anti-reflection coating with an eight layer stack using RCWA and regression; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity for each layer and closest material in NIDN (dashed).</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig10_HTML.png" id="MO10"/></fig></p><sec id="Sec12"><title>Regression</title><p id="Par29">For the regression with RCWA, Fig. <xref rid="Fig10" ref-type="fig">10</xref> displays the achieved spectral characteristics. The obtained transmittance is above 0.9975 for the entire range between 400 and 700 nm, a peak transmittance of 0.9990 is achieved, the average is 0.9985. Thus, in summary the network is able to design a highly effective solution for these spectral characteristics. However, once again we can observe—as seen in Fig. <xref rid="Fig10" ref-type="fig">10</xref>b—that the chosen permittivity does not resemble real material properties. In this case, they are particularly erratic in the real part of the permittivity and especially in the lower wavelengths.<fig id="Fig11"><label>Figure 11</label><caption xml:lang="en"><p>Inversion results for designing an anti-reflection coating with an eight layer stack using RCWA and classification; (<bold>a</bold>) displays target and produced spectra, (<bold>b</bold>) shows the utilized permittivity for each layer and closest material in NIDN (dashed).</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig11_HTML.png" id="MO11"/></fig></p></sec><sec id="Sec13"><title>Classification</title><p id="Par30">With the classification approach, the material design is still successful as can be seen in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. On average, the transmittance is 0.9011 with all values being over 0.7822 and a peak at 0.9756, thus inferior to the regression. As discernible in Fig. <xref rid="Fig11" ref-type="fig">11</xref>b, the chosen materials for the layers in this approach are similar to existing ones such as Silicon Nitride and <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mtext>TiO</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{TiO}_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq30.gif"/></alternatives></inline-formula> and the permittivities are not erratic as for the regression. Hence, with the limited materials currently included in NIDN, this is a better trade-off of obtaining an ARC with realistic materials.<fig id="Fig12"><label>Figure 12</label><caption xml:lang="en"><p>(<bold>a</bold>) L1 loss versus model evaluations of the three approaches. (<bold>b</bold>) Permittivities produced with a neural network in NIDN. (<bold>c</bold>) Permittivities produced with a voxelized grid representation. (<bold>d</bold>) Permittivities produced with GRCWA and NLopt.</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/41598_2022_26312_Fig12_HTML.png" id="MO12"/></fig></p></sec></sec><sec id="Sec14"><title>Comparison with previous works and ablation</title><p id="Par31">To study the capabilities of NIDN in detail, we performed two comparisons: First, with the already feasible autograd approach in GRCWA<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> as demonstrated in online provided examples (Example 3) using the Python optimization module <italic>NLopt</italic>. Secondly, to study the role of having a continuous representation, we compared with directly encoding the permittivities in a voxelized grid. Detailed results are shown in Fig. <xref rid="Fig12" ref-type="fig">12</xref>. The test case is the optimization of a five-layer uniform material to maximize reflection. With GRCWA and NLopt, the optimization converged (within changes of <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-16}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq31.gif"/></alternatives></inline-formula>) after 363 model evaluations to an optimum L1 error of 0.07045. The voxelized grid approach with NIDN achieved the best loss after 2 000 model evaluations at 0.04994. With the neural network approach with NIDN we obtained a loss of 0.06745 after 2 000 model evaluations.</p><p id="Par32">As can be seen in Fig. <xref rid="Fig12" ref-type="fig">12</xref>a convergence was most stable with the voxelized grid and quickest with NLopt. From a convergence standpoint, the voxelized grid approach outperforms the other two. In Fig. <xref rid="Fig12" ref-type="fig">12</xref>b–d the permittivities produced by each approach are shown. Notably, in the voxelized grid and GRCWA approach in Fig. <xref rid="Fig12" ref-type="fig">12</xref>c,d, respectively, produced more erratic results. This is expected, as each permittivity ( in terms of location, layer and wavelength) is fully independent and this is a fully discrete representation. Thus, the neural network approach achieved similar performance while producing a continuous and differentiable representation.</p></sec></sec><sec id="Sec15" sec-type="discussion"><title>Discussion</title><p id="Par33">Overall, the results presented in this work clearly highlight the capabilities and potential of NIDN. We have shown it is able to correctly reproduce the material properties of several synthetic examples, which demonstrates that the inversion and training is successful for both, RCWA and FDTD. Similarly, the creation of both a 1550 nm filter and a perfect ARC are achieved. However, especially the regression approach is susceptible to finding solutions which are not plausible for real materials. This is a current limitation of the regression approach as the designed permittivities do not resemble existing materials. The main reason for this is the lack of constraints on the chosen permittivity. A future improvement here may be to have the network predict the parameters of a function that produces realistic permittivities. For the moment, the constraints on physical plausibility in NIDN are implicitly given through the numerical simulations for determining the spectral characteristics. An additional component that checks if the predicted permittivity matches a realistic permittivity may be needed. The classification approach is able to partially remedy this, but for the real-world examples of filter design and ARC it is less effective at matching desired spectral characteristics. This is likely due to the limited number (12) of materials currently available in NIDN. The number can be increased, however, this also creates a harder classification problem which may in turn require finding an optimal trade-off of the number and diversity of available materials vs. the design limitations induced by fewer available materials. In the future, an alternative may be approaches from the topology optimization community where different projections are used to clamp materials<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup> or utilizing a gumbel-softmax<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>.</p><p id="Par34">One aspect where NIDN is more versatile than previous approaches<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> is that no imposition of shape or form is required or performed. In fact, even the discretization into a grid is not a constraint as it is only required by the solver (RCWA or FDTD); the neural network output is spatially continuous. One thing that has been observed is, however, that the simpler case of having uniform layers benefits training convergence when utilizing RCWA. The reason for this is likely the need to iteratively solve an eigenvalue problem if non-uniform layers are present which may deteriorate gradients. This may be remedied, e.g., by returning to a stochastic setting where gradients are averaged over several tested materials to make the training more robust. This does come at an increased computational cost but may be parallelized.</p><p id="Par35">In summary, NIDN demonstrates the flexibility of physics-based deep learning methods. The range of applications for the software goes well beyond the shown test cases of filters and ARC as it conceivably can be used for a broad range applications such as radiative materials<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup> or solar sails<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. With RCWA and FDTD, two complementary solvers are integrated, RCWA being fast and well-suited for higher wavelength and FDTD being more potent and capable to investigate nanostructures in the visible and infrared spectrum. In the future, optimization and parallelization of the solvers will be critical to improve performance as especially training with FDTD for complex materials becomes prohibitively computationally expensive. Further, FDTD can also be used for the design of non-periodic structures which is a feature not yet implemented in NIDN.</p></sec><sec id="Sec16" sec-type="methods"><title>Methods</title><sec id="Sec17"><title>Rigorous coupled-wave analysis (RCWA)</title><p id="Par36">The RCWA method is a well-established tool for modeling scattering of stacked structures<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. In the NIDN implementation, single material as well as patterned layers can be stacked. A detailed overview of the capabilities can be found in the documentation of the Python module <italic>GRCWA</italic><sup><xref ref-type="bibr" rid="CR17">17</xref></sup> which NIDN’s implementation is derived from. Note that the numerical stability of RCWA is dependent on the ratio of the size of the material grid to the investigated wavelength, i.e., for ratios above one RCWA may produce non-physical results.</p><p id="Par37">The implementation in NIDN supports specifying a top or bottom layer in addition to the material; by default a vacuum layer is placed at both. The grid dimensions, number of layers and thicknesses of all layers can be specified manually. The default truncation order for simulations is 11 to keep computational costs low but it is configurable. The implementation employs a relaxation by adding a fictitious material absorption loss<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. For now, we only investigated inversion with perpendicular light incidence angles and polarized light, however, both are also configurable in the RCWA implementation.</p></sec><sec id="Sec18"><title>Finite-difference time-domain (FDTD)</title><p id="Par38">FDTD is a simulation method that models the electric and magnetic field using a regular grid as a spatial discretization with a finite difference method<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. The electric and magnetic fields at each grid point are calculated with numerical approximations of Maxwell’s equations; more specifically the electric field at each point is calculated using the curl of the magnetic field surrounding the point, and the magnetic field is calculated using the curl of the electric field surrounding the point.</p><p id="Par39">The grid size is set to one tenth of the smallest wavelength used in the simulations, based on recommendations from the fdtd module’s documentation. The time step is set according to the Courant-Friedrichs-Lewy Condition<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, to ensure numerical stability:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta t = \frac{S_c\cdot \Delta x}{u} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_Equ1.gif"/></alternatives></disp-formula>where <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq33.gif"/></alternatives></inline-formula> is the time step, <italic>u</italic> is the wave velocity, <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq34.gif"/></alternatives></inline-formula> is the spatial resolution and <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi mathvariant="italic">dim</mml:mi></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_c = \sqrt{dim} = \sqrt{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq35.gif"/></alternatives></inline-formula> is the Courant number.</p><p id="Par40">In this work, the FDTD simulations were setup with periodic boundaries in the directions orthogonal to the wave-propagation to simulate an infinite plane. In the direction of propagation, Perfectly Matching Layers (PML) were used. PMLs aim to absorb as much of the electromagnetic-wave as possible to avoid reflections at the boundaries of the grid. In the propagation direction, the grid is built up by a PML layer of 1.5 µm, a vacuum layer of 1.0 µm, the material(s) chosen with the specified thicknesses, a vacuum layer of 1.0 µm and finally another PML layer of 1.5 µm. The source is a line across the width of the grid, radiating a continuous wave, placed at the interface between the first PML-layer and the free-space layer.</p><p id="Par41">We measure the electromagnetic wave at placed detectors in the FDTD simulations such that the signal is independent of the direction of the incoming wave. Due to this, a correction of the reflected signal is necessary as the raw signal contains both the forward-going wave before reflection and the reflected wave. For the correction, we use an identical simulation setup without a material, the so-called free-space case, and subtract the measured signal from this simulation from the one with a material.</p><p id="Par42">The transmission and reflection coefficients are calculated by comparing the energy of the wave after the transmission and a free-space case where there is no loss from a material such that<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} T = \frac{P_i}{P_t} = \frac{E_{0i}^2}{E_{0t}^2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_Equ2.gif"/></alternatives></disp-formula>where the subscripts <italic>i</italic>,<italic>t</italic> and 0 refer to incident wave, transmitted wave and amplitude of the wave, respectively. Since the mean squared value of an integer number of periods of a sine wave equals <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mfrac><mml:msubsup><mml:mi>E</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{E_0^2}{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq36.gif"/></alternatives></inline-formula>, the mean squared value is used to calculate the transmission coefficients. The same is the case for the corrected reflection signal. No dispersion model has been implemented as frequencies are computed independently. By running the simulation for all desired wavelengths, the coefficients from each simulation were accumulated to obtain a transmission and reflection spectrum. The absorption spectrum is calculated by <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = 1-T-R$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq37.gif"/></alternatives></inline-formula>.</p><p id="Par43">The number of time steps were chosen such that both the reflected signal and transmitted signal have at least two peaks, such that the mean square can be calculated over at least one period. The loss from a material in FDTD comes from the conductivity parameter. This is included in the <italic>AbsorbingObject</italic> from the fdtd module, which is the only object/material type currently implemented in NIDN. The conductivity <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mi>σ</mml:mi></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq38.gif"/></alternatives></inline-formula> is set to <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma = \epsilon '' \cdot \epsilon _0\cdot \omega$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq39.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec19"><title>Model inversion approach</title><p id="Par44">The inversion process in NIDN is inspired by recent research related to physics-based deep learning<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> and in directly optimizing physical properties using differentiable simulations<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. The main advantage of these approaches is that gradients in training neural networks are propagated directly through a numerical simulation (also referred to as forward model in the context of inverse problems). Thus, there is no need to build a dataset of any kind. In particular, the process in NIDN consists of the following steps which are also depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>: <list list-type="order"><list-item><p id="Par45">Specify target spectral characteristics (reflectance, transmittance, absorptance) and material properties (size, allowed permittivity, simulation parameters)</p></list-item><list-item><p id="Par46">Randomly initialize a neural network that prompted with a position returns the material’s permittivity at that position</p></list-item><list-item><p id="Par47">Perform an evaluation of the numerical model for all target frequencies, i.e., compute the spectral characteristics for the materials as described by the network</p></list-item><list-item><p id="Par48">Compute the loss, i.e., the difference in the target spectral characteristics and those obtained through the network’s material</p></list-item><list-item><p id="Par49">Backpropagate the gradients and update the network parameters to iteratively minimize the difference between target and obtained spectral characteristics</p></list-item><list-item><p id="Par50">Until results are satisfactory, return to Step 3</p></list-item></list>After this process, the network is directly encoding the designed material by providing a permittivity for each position in the material. Herein, the conversion from a position to a permittivity is a particularly critical aspect to allow successful inverse design which will now be described in more detail.</p></sec><sec id="Sec20"><title>Direct permittivity inference</title><p id="Par51">NIDN implements two different ways to determine the relative permittivity <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi><mml:mi>P</mml:mi></mml:msubsup></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r^P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq40.gif"/></alternatives></inline-formula> at a point <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P = (x,y,z,f)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq41.gif"/></alternatives></inline-formula> where <italic>x</italic> and <italic>y</italic> are the point’s location in a layer, <italic>z</italic> is the index of the layer it is on and <italic>f</italic> is the frequency at which we are evaluating. The first way is referred to as regression because the network herein directly infers a permittivity mapping <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>↦</mml:mo><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P \mapsto \epsilon _r^P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq42.gif"/></alternatives></inline-formula>. The values are then clipped at some specified range to restrict it to physically plausible permittivity values. However, as can be seen in the results section, the frequency-dependent permittivity is still fairly unconstrained, allowing for materials that are not plausible as they, e.g., do not necessarily satisfy the Kramers-Kronig relationship<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. But, the advantage of this approach is the direct optimization of the material permittivity to obtain a solution that—at least with regard to the Maxwell solver—is plausible and can give a first idea of the hypothetical feasibility of some spectral characteristic assuming few constraints on permittivity. Permittivity values close to 0 are clipped to <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mo>±</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 0.01$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq43.gif"/></alternatives></inline-formula> to avoid singularities in the Maxwell solvers.</p></sec><sec id="Sec21"><title>Material classification</title><p id="Par52">In order to obtain materials of higher physical fidelity, NIDN implements a second way of encoding material permittivity in the neural network. Naively, one may assume that it would be easiest to have the network perform a classification by assigning one specific material (and hence its permittivity) to each grid cell. Unfortunately, this is infeasible as the necessary <italic>argmax</italic> operation in a classification (to select the most probable material) is not differentiable and thus would break the gradient flow. As an alternative, NIDN features a collection of <italic>N</italic>—at time of writing twelve—materials from which we determine the relative permittivity <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq44.gif"/></alternatives></inline-formula> at a point <italic>P</italic> through a linear combination such that<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi><mml:mi>P</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mi>y</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon _r^P = \sum _{i=1}^N y^P \epsilon _r^i, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_Equ3.gif"/></alternatives></disp-formula>where <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>P</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y^P \in [0,1]^N$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq45.gif"/></alternatives></inline-formula> is the neural network output for point <italic>P</italic> and its <italic>i</italic>-th entry describes the probability of the <italic>i</italic>-th material at the point <italic>P</italic> and <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _r^i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq46.gif"/></alternatives></inline-formula> is the relative permittivity of the <italic>i</italic>-th material in NIDN, respectively. Thus, the produced permittivity is strongly resemblant of real experimental permittivity as can be seen in the results for the classification approach. Furthermore, to push the network towards picking one material without breaking gradient flow, the output <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:msup><mml:mi>y</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y^P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq47.gif"/></alternatives></inline-formula> is passed through a softmax function <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma (y)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq48.gif"/></alternatives></inline-formula> with <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta =16$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq49.gif"/></alternatives></inline-formula>, i.e.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \sigma (y)_i = \frac{e^{\beta y_i}}{\sum _{j=1}^N e^{\beta y_j}} . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_Equ4.gif"/></alternatives></disp-formula></p></sec><sec id="Sec22"><title>Neural network training</title><p id="Par53">The neural network training in NIDN is inspired by several previous works in the field of differentiable models<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR44">44</xref>–<xref ref-type="bibr" rid="CR46">46</xref></sup>. Thus, dense neural networks, namely the NeRF<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> and Siren<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> architecture are employed. Their parameters are optimized based on the gradient information obtained from running the simulation with the material encoded by the network. Thus, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the gradient of the model parameters, i.e. the permittivities, is computed by backpropagation from the loss through the computational graph formulated by the forward model (be it RCWA or FDTD) to the model. NIDN allows a variety of losses, such as absolute mean error or L2 error. For the classification, an additional regularization loss is used penalizing probabilities for their distance from the values 0 and 1. Training uses the Adam optimizer, a default learning rate of <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mrow><mml:mn>8</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$8\cdot 10^{-5}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq50.gif"/></alternatives></inline-formula> and a learning rate scheduler to reduce the learning rate upon encountering a plateauing loss.</p></sec><sec id="Sec23"><title>Software structure</title><p id="Par54">In general, NIDN enables users with two potential use cases: The first is to run forward model simulations using either RCWA or FDTD to obtain the spectral characteristics of a material. The second is the inverse design using neural network models to describe a material structure that produces certain spectral characteristics. NIDN’s software repository has <italic>Jupyter</italic> notebooks describing both processes in detail for RCWA and FDTD to enable users to run their own experiments. The project is open to contributions and under a permissive GPL-3 open-source license to allow customization.</p><p id="Par55">NIDN is designed with modularity in mind, allowing for arbitrary neural network models and Maxwell solvers to be plugged in. It uses a continuous integration methodology with automated unit tests to ensure the correctness of the implementation. Several plotting utilities, such as those used for the figures in this work are available. It is the authors’ hope that the described steps and features will allow others to build and improve upon it.</p></sec></sec></body><back><sec sec-type="author-contribution"><title>Author contributions</title><p>P.G. and H.H.T. conceived of the presented idea, P.G., H.H.T and T.B.S. developed the computational framework and performed computations, P.G. and T.B.S. conducted the simulations, H.H.T, T.B.S., D.A.E. and J.M.L. contributed to the interpretation of results. J.M.L. provided supporting software and calculations. P.G. took the lead in writing the manuscript. All authors provided critical feedback and helped shape the research, analysis and manuscript.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>All code and results presented in this paper are available open-source and open-access in the associated GitHub repository under <ext-link xlink:href="https://github.com/esa/NIDN" ext-link-type="uri">https://github.com/esa/NIDN</ext-link>. <italic>Jupyter</italic> notebooks in the repository contain all data shown in this article.</p></sec><sec sec-type="ethics-statement"><sec id="FPar1" sec-type="COI-statement"><title>Competing interests</title><p id="Par56">The authors declare no competing interests.</p></sec></sec><ref-list id="Bib1"><title>References</title><ref-list><ref id="CR1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Machine learning in materials science</article-title><source>InfoMat</source><year>2019</year><volume>1</volume><fpage>338</fpage><lpage>358</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXhsVKnt7jK</pub-id><pub-id pub-id-type="doi">10.1002/inf2.12028</pub-id></mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Ju</surname><given-names>W</given-names></name><name><surname>Shi</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Materials discovery and design using machine learning</article-title><source>J. Materiomics</source><year>2017</year><volume>3</volume><fpage>159</fpage><lpage>177</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2017AcMat.124..159L</pub-id><pub-id pub-id-type="doi">10.1016/j.jmat.2017.08.002</pub-id></mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Fan</surname><given-names>JA</given-names></name></person-group><article-title xml:lang="en">Deep neural networks for the evaluation and design of photonic devices</article-title><source>Nat. Rev. Mater.</source><year>2021</year><volume>6</volume><fpage>679</fpage><lpage>700</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2021NatRM...6..679J</pub-id><pub-id pub-id-type="doi">10.1038/s41578-020-00260-1</pub-id></mixed-citation></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>D</given-names></name><name><surname>Rodrigues</surname><given-names>SP</given-names></name><name><surname>Lee</surname><given-names>K-T</given-names></name><name><surname>Cai</surname><given-names>W</given-names></name></person-group><article-title xml:lang="en">Generative model for the inverse design of metasurfaces</article-title><source>Nano Lett.</source><year>2018</year><volume>18</volume><fpage>6570</fpage><lpage>6576</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018NanoL..18.6570L</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhslSlt77J</pub-id><pub-id pub-id-type="doi">10.1021/acs.nanolett.8b03171</pub-id></mixed-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>W</given-names></name><name><surname>Cheng</surname><given-names>F</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Wen</surname><given-names>Q</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">Probabilistic representation and inverse design of metamaterials based on a deep generative model with semi-supervised learning strategy</article-title><source>Adv. Mater.</source><year>2019</year><volume>31</volume><fpage>1901111</fpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhtlaqs7zK</pub-id><pub-id pub-id-type="doi">10.1002/adma.201901111</pub-id></mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tahersima</surname><given-names>MH</given-names></name><etal/></person-group><article-title xml:lang="en">Deep neural network inverse design of integrated photonic power splitters</article-title><source>Sci. Rep.</source><year>2019</year><pub-id pub-id-type="doi">10.1038/s41598-018-37952-2</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piggott</surname><given-names>AY</given-names></name><name><surname>Petykiewicz</surname><given-names>J</given-names></name><name><surname>Su</surname><given-names>L</given-names></name><name><surname>Vučković</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Fabrication-constrained nanophotonic inverse design</article-title><source>Sci. Rep.</source><year>2017</year><pub-id pub-id-type="doi">10.1038/s41598-017-01939-2</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodríguez</surname><given-names>JA</given-names></name><etal/></person-group><article-title xml:lang="en">Inverse design of plasma metamaterial devices for optical computing</article-title><source>Phys. Rev. Appl.</source><year>2021</year><pub-id pub-id-type="doi">10.1103/physrevapplied.16.014023</pub-id></mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Sajedian, I., Badloe, T. &amp; Rho, J. Finding the best design parameters for optical nanostructures using reinforcement learning. <italic>arXiv preprint</italic><ext-link xlink:href="http://arxiv.org/abs/1810.10964" ext-link-type="uri">arXiv:1810.10964</ext-link> (2018).</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sajedian</surname><given-names>I</given-names></name><name><surname>Badloe</surname><given-names>T</given-names></name><name><surname>Rho</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Optimisation of colour generation from dielectric nanostructures using reinforcement learning</article-title><source>Opt. Express</source><year>2019</year><volume>27</volume><fpage>5874</fpage><lpage>5883</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019OExpr..27.5874S</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhs1OnsbrK</pub-id><pub-id pub-id-type="doi">10.1364/OE.27.005874</pub-id></mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>So</surname><given-names>S</given-names></name><name><surname>Mun</surname><given-names>J</given-names></name><name><surname>Rho</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Simultaneous inverse design of materials and structures via deep learning: Demonstration of dipole resonance engineering using core-shell nanoparticles</article-title><source>ACS Appl. Mater. Interfaces</source><year>2019</year><volume>11</volume><fpage>24264</fpage><lpage>24268</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhtFyjs7rE</pub-id><pub-id pub-id-type="doi">10.1021/acsami.9b05857</pub-id></mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>So</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Lee</surname><given-names>T</given-names></name><name><surname>Rho</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">On-demand design of spectrally sensitive multiband absorbers using an artificial neural network</article-title><source>Photon. Res.</source><year>2021</year><volume>9</volume><fpage>B153</fpage><lpage>B158</lpage><pub-id pub-id-type="doi">10.1364/PRJ.415789</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>So</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Badloe</surname><given-names>T</given-names></name><name><surname>Rho</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Inverse design of ultra-narrowband selective thermal emitters designed by artificial neural networks</article-title><source>Opt. Mater. Express</source><year>2021</year><volume>11</volume><fpage>1863</fpage><lpage>1873</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2021OMExp..11.1863S</pub-id><pub-id pub-id-type="doi">10.1364/OME.430306</pub-id></mixed-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molesky</surname><given-names>S</given-names></name><etal/></person-group><article-title xml:lang="en">Inverse design in nanophotonics</article-title><source>Nat. Photon.</source><year>2018</year><volume>12</volume><fpage>659</fpage><lpage>670</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2018NaPho..12..659M</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXitVent7zI</pub-id><pub-id pub-id-type="doi">10.1038/s41566-018-0246-9</pub-id></mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mori</surname><given-names>O</given-names></name><etal/></person-group><article-title xml:lang="en">First solar power sail demonstration by IKAROS</article-title><source>Trans. Jpn. Soc. Aeronaut. Space Sci. Aerosp. Technol. Jpn.</source><year>2010</year><volume>8</volume><fpage>To\_4\_25</fpage><lpage>To\_4\_31</lpage><pub-id pub-id-type="doi">10.2322/tastj.8.to_4_25</pub-id></mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ullery</surname><given-names>DC</given-names></name><etal/></person-group><article-title xml:lang="en">Strong solar radiation forces from anomalously reflecting metasurfaces for solar sail attitude control</article-title><source>Sci. Rep.</source><year>2018</year><pub-id pub-id-type="doi">10.1038/s41598-018-28133-2</pub-id></mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Orenstein</surname><given-names>M</given-names></name><name><surname>Fan</surname><given-names>S</given-names></name></person-group><article-title xml:lang="en">Inverse design of lightweight broadband reflector for relativistic lightsail propulsion</article-title><source>ACS Photon.</source><year>2020</year><volume>7</volume><fpage>2350</fpage><lpage>2355</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXhsVOjtrbJ</pub-id><pub-id pub-id-type="doi">10.1021/acsphotonics.0c00768</pub-id></mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>K</given-names></name><etal/></person-group><article-title xml:lang="en">Metasurface optical solar reflectors using AZO transparent conducting oxides for radiative cooling of spacecraft</article-title><source>ACS Photon.</source><year>2017</year><volume>5</volume><fpage>495</fpage><lpage>501</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhvVOktb3F</pub-id><pub-id pub-id-type="doi">10.1021/acsphotonics.7b00991</pub-id></mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>K</given-names></name><etal/></person-group><article-title xml:lang="en">VO<inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="41598_2022_26312_Article_IEq52.gif"/></alternatives></inline-formula> thermochromic metamaterial-based smart optical solar reflector</article-title><source>ACS Photon.</source><year>2018</year><volume>5</volume><fpage>2280</fpage><lpage>2286</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXnsF2qsLg%3D</pub-id><pub-id pub-id-type="doi">10.1021/acsphotonics.8b00119</pub-id></mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hossain</surname><given-names>MM</given-names></name><name><surname>Jia</surname><given-names>B</given-names></name><name><surname>Gu</surname><given-names>M</given-names></name></person-group><article-title xml:lang="en">A metamaterial emitter for highly efficient radiative cooling</article-title><source>Adv. Opt. Mater.</source><year>2015</year><volume>3</volume><fpage>1047</fpage><lpage>1051</lpage><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXlvVelsbo%3D</pub-id><pub-id pub-id-type="doi">10.1002/adom.201500119</pub-id></mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>J</given-names></name><etal/></person-group><article-title xml:lang="en">Metanet: A new paradigm for data sharing in photonics research</article-title><source>Opt. Express</source><year>2020</year><volume>28</volume><fpage>13670</fpage><lpage>13681</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2020OExpr..2813670J</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXitlWjsLnJ</pub-id><pub-id pub-id-type="doi">10.1364/OE.388378</pub-id></mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sullivan</surname><given-names>DM</given-names></name></person-group><source>Electromagnetic Simulation Using the FDTD Method</source><year>2013</year><publisher-name>Wiley</publisher-name><pub-id pub-id-type="doi">10.1002/9781118646700</pub-id></mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moharam</surname><given-names>M</given-names></name><name><surname>Gaylord</surname><given-names>T</given-names></name></person-group><article-title xml:lang="en">Rigorous coupled-wave analysis of planar-grating diffraction</article-title><source>JOSA</source><year>1981</year><volume>71</volume><fpage>811</fpage><lpage>818</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">1981JOSA...71..811M</pub-id><pub-id pub-id-type="doi">10.1364/JOSA.71.000811</pub-id></mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>B</given-names></name></person-group><article-title xml:lang="en">Torcwa: Gpu-accelerated Fourier modal method and gradient-based optimization for metasurface design</article-title><source>Comput. Phys. Commun.</source><year>2023</year><volume>282</volume><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB38XisFSrurrM</pub-id><pub-id pub-id-type="doi">10.1016/j.cpc.2022.108552</pub-id></mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>K</given-names></name><name><surname>Chang</surname><given-names>C-H</given-names></name></person-group><article-title xml:lang="en">Numerical modeling of sub-wavelength anti-reflective structures for solar module applications</article-title><source>Nanomaterials</source><year>2014</year><volume>4</volume><fpage>87</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.3390/nano4010087</pub-id></mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>X</given-names></name><etal/></person-group><article-title xml:lang="en">Implementation of radiative cooling with an inverse-designed selective emitter</article-title><source>Opt. Commun.</source><year>2021</year><volume>497</volume><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3MXhtlOlur7K</pub-id><pub-id pub-id-type="doi">10.1016/j.optcom.2021.127209</pub-id></mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Thuerey, N. <italic>et al.</italic> Physics-based deep learning. <italic>arXiv preprint</italic><ext-link xlink:href="http://arxiv.org/abs/2109.05237" ext-link-type="uri">arXiv:2109.05237</ext-link> (2021).</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name></person-group><article-title xml:lang="en">A data-efficient self-supervised deep learning model for design and characterization of nanophotonic structures</article-title><source>Sci. China Phys. Mech. Astron.</source><year>2020</year><pub-id pub-id-type="doi">10.1007/s11433-020-1575-2</pub-id></mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname><given-names>CC</given-names></name><name><surname>Huang</surname><given-names>B</given-names></name><name><surname>Malof</surname><given-names>JM</given-names></name><name><surname>Padilla</surname><given-names>WJ</given-names></name></person-group><article-title xml:lang="en">Deep learning for accelerated all-dielectric metasurface design</article-title><source>Opt. Express</source><year>2019</year><volume>27</volume><fpage>27523</fpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2019OExpr..2727523N</pub-id><pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BB3cXhtFyiurzF</pub-id><pub-id pub-id-type="doi">10.1364/oe.27.027523</pub-id></mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colburn</surname><given-names>S</given-names></name><name><surname>Majumdar</surname><given-names>A</given-names></name></person-group><article-title xml:lang="en">Inverse design and flexible parameterization of meta-optics using algorithmic differentiation</article-title><source>Commun. Phys.</source><year>2021</year><pub-id pub-id-type="doi">10.1038/s42005-021-00568-6</pub-id></mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chandrasekhar</surname><given-names>A</given-names></name><name><surname>Suresh</surname><given-names>K</given-names></name></person-group><article-title xml:lang="en">Tounn: Topology optimization using neural networks</article-title><source>Struct. Multidiscip. Optim.</source><year>2021</year><volume>63</volume><fpage>1135</fpage><lpage>1149</lpage><pub-id pub-id-type="other" assigning-authority="American Mathematical Society">4233674</pub-id><pub-id pub-id-type="doi">10.1007/s00158-020-02748-4</pub-id></mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="other">Shin, S., Shin, D., Kim, M., Ryu, H. &amp; Kang, N. Machine learning-based topology optimization: A review. In <italic>The 2021 world congress on advances in structural engineering and mechanics (ASEM21)</italic> (IASEM, KAIST, KTA, SNU DAAE, 2021).</mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woldseth</surname><given-names>RV</given-names></name><name><surname>Aage</surname><given-names>N</given-names></name><name><surname>Bærentzen</surname><given-names>JA</given-names></name><name><surname>Sigmund</surname><given-names>O</given-names></name></person-group><article-title xml:lang="en">On the use of artificial neural networks in topology optimisation</article-title><source>Struct. Multidiscip. Optim.</source><year>2022</year><volume>65</volume><fpage>1</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1007/s00158-022-03347-1</pub-id></mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wojcieszak</surname><given-names>D</given-names></name><name><surname>Kaczmarek</surname><given-names>D</given-names></name><name><surname>Domaradzki</surname><given-names>J</given-names></name></person-group><article-title xml:lang="en">Analysis of surface properties of semiconducting (ti, pd, eu)ox thin films</article-title><source>Opto-Electron. Rev.</source><year>2016</year><volume>24</volume><fpage>15</fpage><lpage>19</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2016OERv...24...15W</pub-id><pub-id pub-id-type="doi">10.1515/oere-2016-0003</pub-id></mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>K-H</given-names></name><name><surname>Park</surname><given-names>Q-H</given-names></name></person-group><article-title xml:lang="en">Perfect anti-reflection from first principles</article-title><source>Sci. Rep.</source><year>2013</year><volume>3</volume><fpage>1</fpage><lpage>5</lpage></mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Gaynor, A. T., Meisel, N. A., Williams, C. B. &amp; Guest, J. K. Topology optimization for additive manufacturing: Considering maximum overhang constraint. In <italic>15th AIAA/ISSMO multidisciplinary analysis and optimization conference</italic>, 2036 (2014).</mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawamoto</surname><given-names>A</given-names></name><etal/></person-group><article-title xml:lang="en">Heaviside projection based topology optimization by a pde-filtered scalar function</article-title><source>Struct. Multidiscip. Optim.</source><year>2011</year><volume>44</volume><fpage>19</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1007/s00158-010-0562-2</pub-id><pub-id pub-id-type="other" assigning-authority="Zentralblatt MATH">1274.74349</pub-id></mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="other">Jang, E., Gu, S. &amp; Poole, B. Categorical reparameterization with gumbel-softmax. <italic>arXiv preprint</italic><ext-link xlink:href="http://arxiv.org/abs/1611.01144" ext-link-type="uri">arXiv:1611.01144</ext-link> (2016).</mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>X</given-names></name><name><surname>Johnson</surname><given-names>SG</given-names></name></person-group><article-title xml:lang="en">Formulation for scalable optimization of microcavities via the frequency-averaged local density of states</article-title><source>Opt. Express</source><year>2013</year><volume>21</volume><fpage>30812</fpage><lpage>30841</lpage><pub-id pub-id-type="other" assigning-authority="NASA Astrophysics Data System">2013OExpr..2130812L</pub-id><pub-id pub-id-type="doi">10.1364/OE.21.030812</pub-id></mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other">Schneider, J. B. Understanding the finite-difference time-domain method (2010).</mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">De Moura, C. A. &amp; Kubrusly, C. S. The Courant–Friedrichs–Lewy (cfl) condition. <italic>AMC</italic><bold>10</bold> (2013).</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Izzo, D. &amp; Gómez, P. Geodesy of irregular small bodies via neural density fields: Geodesynets. <italic>arXiv preprint</italic><ext-link xlink:href="http://arxiv.org/abs/2105.13031" ext-link-type="uri">arXiv:2105.13031</ext-link> (2021).</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lucarini</surname><given-names>V</given-names></name><name><surname>Saarinen</surname><given-names>JJ</given-names></name><name><surname>Peiponen</surname><given-names>K-E</given-names></name><name><surname>Vartiainen</surname><given-names>EM</given-names></name></person-group><source>Kramers–Kronig relations in optical materials research</source><year>2005</year><publisher-name>Springer</publisher-name></mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">von Looz, M., Gomez, P. &amp; Izzo, D. Study of the asteroid bennu using geodesyanns and osiris-rex data. <italic>arXiv preprint</italic><ext-link xlink:href="http://arxiv.org/abs/2109.14427" ext-link-type="uri">arXiv:2109.14427</ext-link> (2021).</mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="other">Mildenhall, B. <italic>et al.</italic> Nerf: Representing scenes as neural radiance fields for view synthesis. In <italic>European conference on computer vision</italic>, 405–421 (Springer, 2020).</mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sitzmann</surname><given-names>V</given-names></name><name><surname>Martel</surname><given-names>J</given-names></name><name><surname>Bergman</surname><given-names>A</given-names></name><name><surname>Lindell</surname><given-names>D</given-names></name><name><surname>Wetzstein</surname><given-names>G</given-names></name></person-group><article-title xml:lang="en">Implicit neural representations with periodic activation functions</article-title><source>Adv. Neural Inf. Process. Syst.</source><year>2020</year><volume>33</volume><fpage>7462</fpage><lpage>7473</lpage></mixed-citation></ref></ref-list></ref-list><app-group><app id="App1" specific-use="web-only"><sec id="Sec24"><title>Supplementary Information</title><p id="Par57"><supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary Information"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/41598_2022_26312_MOESM1_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Supplementary Information.</p></caption></media></supplementary-material></p></sec></app></app-group><notes notes-type="ESMHint"><title>Supplementary Information</title><p>The online version contains supplementary material available at <ext-link xlink:href="10.1038/s41598-022-26312-w" ext-link-type="doi">https://doi.org/10.1038/s41598-022-26312-w</ext-link>.</p></notes><notes notes-type="Misc"><title>Publisher's note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></notes></back></article></records><facets><facet name="subject"><facet-value count="1">Science, Humanities and Social Sciences, multidisciplinary</facet-value><facet-value count="1">Science, multidisciplinary</facet-value></facet><facet name="keyword"/><facet name="pub"><facet-value count="1">Scientific Reports</facet-value></facet><facet name="year"><facet-value count="1">2022</facet-value></facet><facet name="country"><facet-value count="1">Netherlands</facet-value><facet-value count="1">Spain</facet-value></facet><facet name="type"><facet-value count="1">Journal</facet-value></facet></facets></response>
